/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/axios/index.js":
/*!*************************************!*\
  !*** ./node_modules/axios/index.js ***!
  \*************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("module.exports = __webpack_require__(/*! ./lib/axios */ \"./node_modules/axios/lib/axios.js\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvaW5kZXguanM/YmMzYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw0RkFBdUMiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vbGliL2F4aW9zJyk7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/index.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/adapters/xhr.js":
/*!************************************************!*\
  !*** ./node_modules/axios/lib/adapters/xhr.js ***!
  \************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\nvar settle = __webpack_require__(/*! ./../core/settle */ \"./node_modules/axios/lib/core/settle.js\");\nvar cookies = __webpack_require__(/*! ./../helpers/cookies */ \"./node_modules/axios/lib/helpers/cookies.js\");\nvar buildURL = __webpack_require__(/*! ./../helpers/buildURL */ \"./node_modules/axios/lib/helpers/buildURL.js\");\nvar buildFullPath = __webpack_require__(/*! ../core/buildFullPath */ \"./node_modules/axios/lib/core/buildFullPath.js\");\nvar parseHeaders = __webpack_require__(/*! ./../helpers/parseHeaders */ \"./node_modules/axios/lib/helpers/parseHeaders.js\");\nvar isURLSameOrigin = __webpack_require__(/*! ./../helpers/isURLSameOrigin */ \"./node_modules/axios/lib/helpers/isURLSameOrigin.js\");\nvar createError = __webpack_require__(/*! ../core/createError */ \"./node_modules/axios/lib/core/createError.js\");\n\nmodule.exports = function xhrAdapter(config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    var requestData = config.data;\n    var requestHeaders = config.headers;\n\n    if (utils.isFormData(requestData)) {\n      delete requestHeaders['Content-Type']; // Let the browser set it\n    }\n\n    var request = new XMLHttpRequest();\n\n    // HTTP basic authentication\n    if (config.auth) {\n      var username = config.auth.username || '';\n      var password = config.auth.password ? unescape(encodeURIComponent(config.auth.password)) : '';\n      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n    }\n\n    var fullPath = buildFullPath(config.baseURL, config.url);\n    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);\n\n    // Set the request timeout in MS\n    request.timeout = config.timeout;\n\n    // Listen for ready state\n    request.onreadystatechange = function handleLoad() {\n      if (!request || request.readyState !== 4) {\n        return;\n      }\n\n      // The request errored out and we didn't get a response, this will be\n      // handled by onerror instead\n      // With one exception: request that using file: protocol, most browsers\n      // will return status as 0 even though it's a successful request\n      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n        return;\n      }\n\n      // Prepare the response\n      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n      var response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config: config,\n        request: request\n      };\n\n      settle(resolve, reject, response);\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(createError('Request aborted', config, 'ECONNABORTED', request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(createError('Network Error', config, null, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      var timeoutErrorMessage = 'timeout of ' + config.timeout + 'ms exceeded';\n      if (config.timeoutErrorMessage) {\n        timeoutErrorMessage = config.timeoutErrorMessage;\n      }\n      reject(createError(timeoutErrorMessage, config, 'ECONNABORTED',\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Add xsrf header\n    // This is only done if running in a standard browser environment.\n    // Specifically not if we're in a web worker, or react-native.\n    if (utils.isStandardBrowserEnv()) {\n      // Add xsrf header\n      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?\n        cookies.read(config.xsrfCookieName) :\n        undefined;\n\n      if (xsrfValue) {\n        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n      }\n    }\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n          // Remove Content-Type if data is undefined\n          delete requestHeaders[key];\n        } else {\n          // Otherwise add header to the request\n          request.setRequestHeader(key, val);\n        }\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(config.withCredentials)) {\n      request.withCredentials = !!config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (config.responseType) {\n      try {\n        request.responseType = config.responseType;\n      } catch (e) {\n        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n        if (config.responseType !== 'json') {\n          throw e;\n        }\n      }\n    }\n\n    // Handle progress if needed\n    if (typeof config.onDownloadProgress === 'function') {\n      request.addEventListener('progress', config.onDownloadProgress);\n    }\n\n    // Not all browsers support upload events\n    if (typeof config.onUploadProgress === 'function' && request.upload) {\n      request.upload.addEventListener('progress', config.onUploadProgress);\n    }\n\n    if (config.cancelToken) {\n      // Handle cancellation\n      config.cancelToken.promise.then(function onCanceled(cancel) {\n        if (!request) {\n          return;\n        }\n\n        request.abort();\n        reject(cancel);\n        // Clean up request\n        request = null;\n      });\n    }\n\n    if (!requestData) {\n      requestData = null;\n    }\n\n    // Send the request\n    request.send(requestData);\n  });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2FkYXB0ZXJzL3hoci5qcz9iNTBkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLFlBQVksbUJBQU8sQ0FBQyxxREFBWTtBQUNoQyxhQUFhLG1CQUFPLENBQUMsaUVBQWtCO0FBQ3ZDLGNBQWMsbUJBQU8sQ0FBQyx5RUFBc0I7QUFDNUMsZUFBZSxtQkFBTyxDQUFDLDJFQUF1QjtBQUM5QyxvQkFBb0IsbUJBQU8sQ0FBQyw2RUFBdUI7QUFDbkQsbUJBQW1CLG1CQUFPLENBQUMsbUZBQTJCO0FBQ3RELHNCQUFzQixtQkFBTyxDQUFDLHlGQUE4QjtBQUM1RCxrQkFBa0IsbUJBQU8sQ0FBQyx5RUFBcUI7O0FBRS9DO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsNENBQTRDO0FBQzVDOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9hZGFwdGVycy94aHIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciBzZXR0bGUgPSByZXF1aXJlKCcuLy4uL2NvcmUvc2V0dGxlJyk7XG52YXIgY29va2llcyA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9jb29raWVzJyk7XG52YXIgYnVpbGRVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnVpbGRVUkwnKTtcbnZhciBidWlsZEZ1bGxQYXRoID0gcmVxdWlyZSgnLi4vY29yZS9idWlsZEZ1bGxQYXRoJyk7XG52YXIgcGFyc2VIZWFkZXJzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL3BhcnNlSGVhZGVycycpO1xudmFyIGlzVVJMU2FtZU9yaWdpbiA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9pc1VSTFNhbWVPcmlnaW4nKTtcbnZhciBjcmVhdGVFcnJvciA9IHJlcXVpcmUoJy4uL2NvcmUvY3JlYXRlRXJyb3InKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB4aHJBZGFwdGVyKGNvbmZpZykge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gZGlzcGF0Y2hYaHJSZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciByZXF1ZXN0RGF0YSA9IGNvbmZpZy5kYXRhO1xuICAgIHZhciByZXF1ZXN0SGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xuXG4gICAgaWYgKHV0aWxzLmlzRm9ybURhdGEocmVxdWVzdERhdGEpKSB7XG4gICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddOyAvLyBMZXQgdGhlIGJyb3dzZXIgc2V0IGl0XG4gICAgfVxuXG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgIC8vIEhUVFAgYmFzaWMgYXV0aGVudGljYXRpb25cbiAgICBpZiAoY29uZmlnLmF1dGgpIHtcbiAgICAgIHZhciB1c2VybmFtZSA9IGNvbmZpZy5hdXRoLnVzZXJuYW1lIHx8ICcnO1xuICAgICAgdmFyIHBhc3N3b3JkID0gY29uZmlnLmF1dGgucGFzc3dvcmQgPyB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoY29uZmlnLmF1dGgucGFzc3dvcmQpKSA6ICcnO1xuICAgICAgcmVxdWVzdEhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCYXNpYyAnICsgYnRvYSh1c2VybmFtZSArICc6JyArIHBhc3N3b3JkKTtcbiAgICB9XG5cbiAgICB2YXIgZnVsbFBhdGggPSBidWlsZEZ1bGxQYXRoKGNvbmZpZy5iYXNlVVJMLCBjb25maWcudXJsKTtcbiAgICByZXF1ZXN0Lm9wZW4oY29uZmlnLm1ldGhvZC50b1VwcGVyQ2FzZSgpLCBidWlsZFVSTChmdWxsUGF0aCwgY29uZmlnLnBhcmFtcywgY29uZmlnLnBhcmFtc1NlcmlhbGl6ZXIpLCB0cnVlKTtcblxuICAgIC8vIFNldCB0aGUgcmVxdWVzdCB0aW1lb3V0IGluIE1TXG4gICAgcmVxdWVzdC50aW1lb3V0ID0gY29uZmlnLnRpbWVvdXQ7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIHJlYWR5IHN0YXRlXG4gICAgcmVxdWVzdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiBoYW5kbGVMb2FkKCkge1xuICAgICAgaWYgKCFyZXF1ZXN0IHx8IHJlcXVlc3QucmVhZHlTdGF0ZSAhPT0gNCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSByZXF1ZXN0IGVycm9yZWQgb3V0IGFuZCB3ZSBkaWRuJ3QgZ2V0IGEgcmVzcG9uc2UsIHRoaXMgd2lsbCBiZVxuICAgICAgLy8gaGFuZGxlZCBieSBvbmVycm9yIGluc3RlYWRcbiAgICAgIC8vIFdpdGggb25lIGV4Y2VwdGlvbjogcmVxdWVzdCB0aGF0IHVzaW5nIGZpbGU6IHByb3RvY29sLCBtb3N0IGJyb3dzZXJzXG4gICAgICAvLyB3aWxsIHJldHVybiBzdGF0dXMgYXMgMCBldmVuIHRob3VnaCBpdCdzIGEgc3VjY2Vzc2Z1bCByZXF1ZXN0XG4gICAgICBpZiAocmVxdWVzdC5zdGF0dXMgPT09IDAgJiYgIShyZXF1ZXN0LnJlc3BvbnNlVVJMICYmIHJlcXVlc3QucmVzcG9uc2VVUkwuaW5kZXhPZignZmlsZTonKSA9PT0gMCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBQcmVwYXJlIHRoZSByZXNwb25zZVxuICAgICAgdmFyIHJlc3BvbnNlSGVhZGVycyA9ICdnZXRBbGxSZXNwb25zZUhlYWRlcnMnIGluIHJlcXVlc3QgPyBwYXJzZUhlYWRlcnMocmVxdWVzdC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkgOiBudWxsO1xuICAgICAgdmFyIHJlc3BvbnNlRGF0YSA9ICFjb25maWcucmVzcG9uc2VUeXBlIHx8IGNvbmZpZy5yZXNwb25zZVR5cGUgPT09ICd0ZXh0JyA/IHJlcXVlc3QucmVzcG9uc2VUZXh0IDogcmVxdWVzdC5yZXNwb25zZTtcbiAgICAgIHZhciByZXNwb25zZSA9IHtcbiAgICAgICAgZGF0YTogcmVzcG9uc2VEYXRhLFxuICAgICAgICBzdGF0dXM6IHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0LnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgY29uZmlnOiBjb25maWcsXG4gICAgICAgIHJlcXVlc3Q6IHJlcXVlc3RcbiAgICAgIH07XG5cbiAgICAgIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKTtcblxuICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSBicm93c2VyIHJlcXVlc3QgY2FuY2VsbGF0aW9uIChhcyBvcHBvc2VkIHRvIGEgbWFudWFsIGNhbmNlbGxhdGlvbilcbiAgICByZXF1ZXN0Lm9uYWJvcnQgPSBmdW5jdGlvbiBoYW5kbGVBYm9ydCgpIHtcbiAgICAgIGlmICghcmVxdWVzdCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignUmVxdWVzdCBhYm9ydGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJywgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIGxvdyBsZXZlbCBuZXR3b3JrIGVycm9yc1xuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkge1xuICAgICAgLy8gUmVhbCBlcnJvcnMgYXJlIGhpZGRlbiBmcm9tIHVzIGJ5IHRoZSBicm93c2VyXG4gICAgICAvLyBvbmVycm9yIHNob3VsZCBvbmx5IGZpcmUgaWYgaXQncyBhIG5ldHdvcmsgZXJyb3JcbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignTmV0d29yayBFcnJvcicsIGNvbmZpZywgbnVsbCwgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRpbWVvdXRcbiAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7XG4gICAgICB2YXIgdGltZW91dEVycm9yTWVzc2FnZSA9ICd0aW1lb3V0IG9mICcgKyBjb25maWcudGltZW91dCArICdtcyBleGNlZWRlZCc7XG4gICAgICBpZiAoY29uZmlnLnRpbWVvdXRFcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgdGltZW91dEVycm9yTWVzc2FnZSA9IGNvbmZpZy50aW1lb3V0RXJyb3JNZXNzYWdlO1xuICAgICAgfVxuICAgICAgcmVqZWN0KGNyZWF0ZUVycm9yKHRpbWVvdXRFcnJvck1lc3NhZ2UsIGNvbmZpZywgJ0VDT05OQUJPUlRFRCcsXG4gICAgICAgIHJlcXVlc3QpKTtcblxuICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8vIEFkZCB4c3JmIGhlYWRlclxuICAgIC8vIFRoaXMgaXMgb25seSBkb25lIGlmIHJ1bm5pbmcgaW4gYSBzdGFuZGFyZCBicm93c2VyIGVudmlyb25tZW50LlxuICAgIC8vIFNwZWNpZmljYWxseSBub3QgaWYgd2UncmUgaW4gYSB3ZWIgd29ya2VyLCBvciByZWFjdC1uYXRpdmUuXG4gICAgaWYgKHV0aWxzLmlzU3RhbmRhcmRCcm93c2VyRW52KCkpIHtcbiAgICAgIC8vIEFkZCB4c3JmIGhlYWRlclxuICAgICAgdmFyIHhzcmZWYWx1ZSA9IChjb25maWcud2l0aENyZWRlbnRpYWxzIHx8IGlzVVJMU2FtZU9yaWdpbihmdWxsUGF0aCkpICYmIGNvbmZpZy54c3JmQ29va2llTmFtZSA/XG4gICAgICAgIGNvb2tpZXMucmVhZChjb25maWcueHNyZkNvb2tpZU5hbWUpIDpcbiAgICAgICAgdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoeHNyZlZhbHVlKSB7XG4gICAgICAgIHJlcXVlc3RIZWFkZXJzW2NvbmZpZy54c3JmSGVhZGVyTmFtZV0gPSB4c3JmVmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWRkIGhlYWRlcnMgdG8gdGhlIHJlcXVlc3RcbiAgICBpZiAoJ3NldFJlcXVlc3RIZWFkZXInIGluIHJlcXVlc3QpIHtcbiAgICAgIHV0aWxzLmZvckVhY2gocmVxdWVzdEhlYWRlcnMsIGZ1bmN0aW9uIHNldFJlcXVlc3RIZWFkZXIodmFsLCBrZXkpIHtcbiAgICAgICAgaWYgKHR5cGVvZiByZXF1ZXN0RGF0YSA9PT0gJ3VuZGVmaW5lZCcgJiYga2V5LnRvTG93ZXJDYXNlKCkgPT09ICdjb250ZW50LXR5cGUnKSB7XG4gICAgICAgICAgLy8gUmVtb3ZlIENvbnRlbnQtVHlwZSBpZiBkYXRhIGlzIHVuZGVmaW5lZFxuICAgICAgICAgIGRlbGV0ZSByZXF1ZXN0SGVhZGVyc1trZXldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE90aGVyd2lzZSBhZGQgaGVhZGVyIHRvIHRoZSByZXF1ZXN0XG4gICAgICAgICAgcmVxdWVzdC5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgdmFsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIHdpdGhDcmVkZW50aWFscyB0byByZXF1ZXN0IGlmIG5lZWRlZFxuICAgIGlmICghdXRpbHMuaXNVbmRlZmluZWQoY29uZmlnLndpdGhDcmVkZW50aWFscykpIHtcbiAgICAgIHJlcXVlc3Qud2l0aENyZWRlbnRpYWxzID0gISFjb25maWcud2l0aENyZWRlbnRpYWxzO1xuICAgIH1cblxuICAgIC8vIEFkZCByZXNwb25zZVR5cGUgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBjb25maWcucmVzcG9uc2VUeXBlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBFeHBlY3RlZCBET01FeGNlcHRpb24gdGhyb3duIGJ5IGJyb3dzZXJzIG5vdCBjb21wYXRpYmxlIFhNTEh0dHBSZXF1ZXN0IExldmVsIDIuXG4gICAgICAgIC8vIEJ1dCwgdGhpcyBjYW4gYmUgc3VwcHJlc3NlZCBmb3IgJ2pzb24nIHR5cGUgYXMgaXQgY2FuIGJlIHBhcnNlZCBieSBkZWZhdWx0ICd0cmFuc2Zvcm1SZXNwb25zZScgZnVuY3Rpb24uXG4gICAgICAgIGlmIChjb25maWcucmVzcG9uc2VUeXBlICE9PSAnanNvbicpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHByb2dyZXNzIGlmIG5lZWRlZFxuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uRG93bmxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIC8vIE5vdCBhbGwgYnJvd3NlcnMgc3VwcG9ydCB1cGxvYWQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiBjb25maWcub25VcGxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJyAmJiByZXF1ZXN0LnVwbG9hZCkge1xuICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25VcGxvYWRQcm9ncmVzcyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgICAgLy8gSGFuZGxlIGNhbmNlbGxhdGlvblxuICAgICAgY29uZmlnLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbiBvbkNhbmNlbGVkKGNhbmNlbCkge1xuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIHJlamVjdChjYW5jZWwpO1xuICAgICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFyZXF1ZXN0RGF0YSkge1xuICAgICAgcmVxdWVzdERhdGEgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIFNlbmQgdGhlIHJlcXVlc3RcbiAgICByZXF1ZXN0LnNlbmQocmVxdWVzdERhdGEpO1xuICB9KTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/adapters/xhr.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/axios.js":
/*!*****************************************!*\
  !*** ./node_modules/axios/lib/axios.js ***!
  \*****************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./utils */ \"./node_modules/axios/lib/utils.js\");\nvar bind = __webpack_require__(/*! ./helpers/bind */ \"./node_modules/axios/lib/helpers/bind.js\");\nvar Axios = __webpack_require__(/*! ./core/Axios */ \"./node_modules/axios/lib/core/Axios.js\");\nvar mergeConfig = __webpack_require__(/*! ./core/mergeConfig */ \"./node_modules/axios/lib/core/mergeConfig.js\");\nvar defaults = __webpack_require__(/*! ./defaults */ \"./node_modules/axios/lib/defaults.js\");\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n * @return {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  var context = new Axios(defaultConfig);\n  var instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context);\n\n  // Copy context to instance\n  utils.extend(instance, context);\n\n  return instance;\n}\n\n// Create the default instance to be exported\nvar axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Factory for creating new instances\naxios.create = function create(instanceConfig) {\n  return createInstance(mergeConfig(axios.defaults, instanceConfig));\n};\n\n// Expose Cancel & CancelToken\naxios.Cancel = __webpack_require__(/*! ./cancel/Cancel */ \"./node_modules/axios/lib/cancel/Cancel.js\");\naxios.CancelToken = __webpack_require__(/*! ./cancel/CancelToken */ \"./node_modules/axios/lib/cancel/CancelToken.js\");\naxios.isCancel = __webpack_require__(/*! ./cancel/isCancel */ \"./node_modules/axios/lib/cancel/isCancel.js\");\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\naxios.spread = __webpack_require__(/*! ./helpers/spread */ \"./node_modules/axios/lib/helpers/spread.js\");\n\n// Expose isAxiosError\naxios.isAxiosError = __webpack_require__(/*! ./helpers/isAxiosError */ \"./node_modules/axios/lib/helpers/isAxiosError.js\");\n\nmodule.exports = axios;\n\n// Allow use of default import syntax in TypeScript\nmodule.exports.default = axios;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2F4aW9zLmpzP2NlZTQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLGtEQUFTO0FBQzdCLFdBQVcsbUJBQU8sQ0FBQyxnRUFBZ0I7QUFDbkMsWUFBWSxtQkFBTyxDQUFDLDREQUFjO0FBQ2xDLGtCQUFrQixtQkFBTyxDQUFDLHdFQUFvQjtBQUM5QyxlQUFlLG1CQUFPLENBQUMsd0RBQVk7O0FBRW5DO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixZQUFZLE1BQU07QUFDbEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxtQkFBTyxDQUFDLGtFQUFpQjtBQUN4QyxvQkFBb0IsbUJBQU8sQ0FBQyw0RUFBc0I7QUFDbEQsaUJBQWlCLG1CQUFPLENBQUMsc0VBQW1COztBQUU1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQU8sQ0FBQyxvRUFBa0I7O0FBRXpDO0FBQ0EscUJBQXFCLG1CQUFPLENBQUMsZ0ZBQXdCOztBQUVyRDs7QUFFQTtBQUNBLHNCQUFzQiIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvYXhpb3MuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcbnZhciBBeGlvcyA9IHJlcXVpcmUoJy4vY29yZS9BeGlvcycpO1xudmFyIG1lcmdlQ29uZmlnID0gcmVxdWlyZSgnLi9jb3JlL21lcmdlQ29uZmlnJyk7XG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuL2RlZmF1bHRzJyk7XG5cbi8qKlxuICogQ3JlYXRlIGFuIGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRlZmF1bHRDb25maWcgVGhlIGRlZmF1bHQgY29uZmlnIGZvciB0aGUgaW5zdGFuY2VcbiAqIEByZXR1cm4ge0F4aW9zfSBBIG5ldyBpbnN0YW5jZSBvZiBBeGlvc1xuICovXG5mdW5jdGlvbiBjcmVhdGVJbnN0YW5jZShkZWZhdWx0Q29uZmlnKSB7XG4gIHZhciBjb250ZXh0ID0gbmV3IEF4aW9zKGRlZmF1bHRDb25maWcpO1xuICB2YXIgaW5zdGFuY2UgPSBiaW5kKEF4aW9zLnByb3RvdHlwZS5yZXF1ZXN0LCBjb250ZXh0KTtcblxuICAvLyBDb3B5IGF4aW9zLnByb3RvdHlwZSB0byBpbnN0YW5jZVxuICB1dGlscy5leHRlbmQoaW5zdGFuY2UsIEF4aW9zLnByb3RvdHlwZSwgY29udGV4dCk7XG5cbiAgLy8gQ29weSBjb250ZXh0IHRvIGluc3RhbmNlXG4gIHV0aWxzLmV4dGVuZChpbnN0YW5jZSwgY29udGV4dCk7XG5cbiAgcmV0dXJuIGluc3RhbmNlO1xufVxuXG4vLyBDcmVhdGUgdGhlIGRlZmF1bHQgaW5zdGFuY2UgdG8gYmUgZXhwb3J0ZWRcbnZhciBheGlvcyA9IGNyZWF0ZUluc3RhbmNlKGRlZmF1bHRzKTtcblxuLy8gRXhwb3NlIEF4aW9zIGNsYXNzIHRvIGFsbG93IGNsYXNzIGluaGVyaXRhbmNlXG5heGlvcy5BeGlvcyA9IEF4aW9zO1xuXG4vLyBGYWN0b3J5IGZvciBjcmVhdGluZyBuZXcgaW5zdGFuY2VzXG5heGlvcy5jcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaW5zdGFuY2VDb25maWcpIHtcbiAgcmV0dXJuIGNyZWF0ZUluc3RhbmNlKG1lcmdlQ29uZmlnKGF4aW9zLmRlZmF1bHRzLCBpbnN0YW5jZUNvbmZpZykpO1xufTtcblxuLy8gRXhwb3NlIENhbmNlbCAmIENhbmNlbFRva2VuXG5heGlvcy5DYW5jZWwgPSByZXF1aXJlKCcuL2NhbmNlbC9DYW5jZWwnKTtcbmF4aW9zLkNhbmNlbFRva2VuID0gcmVxdWlyZSgnLi9jYW5jZWwvQ2FuY2VsVG9rZW4nKTtcbmF4aW9zLmlzQ2FuY2VsID0gcmVxdWlyZSgnLi9jYW5jZWwvaXNDYW5jZWwnKTtcblxuLy8gRXhwb3NlIGFsbC9zcHJlYWRcbmF4aW9zLmFsbCA9IGZ1bmN0aW9uIGFsbChwcm9taXNlcykge1xuICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xufTtcbmF4aW9zLnNwcmVhZCA9IHJlcXVpcmUoJy4vaGVscGVycy9zcHJlYWQnKTtcblxuLy8gRXhwb3NlIGlzQXhpb3NFcnJvclxuYXhpb3MuaXNBeGlvc0Vycm9yID0gcmVxdWlyZSgnLi9oZWxwZXJzL2lzQXhpb3NFcnJvcicpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGF4aW9zO1xuXG4vLyBBbGxvdyB1c2Ugb2YgZGVmYXVsdCBpbXBvcnQgc3ludGF4IGluIFR5cGVTY3JpcHRcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBheGlvcztcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/axios.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/cancel/Cancel.js":
/*!*************************************************!*\
  !*** ./node_modules/axios/lib/cancel/Cancel.js ***!
  \*************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * A `Cancel` is an object that is thrown when an operation is canceled.\n *\n * @class\n * @param {string=} message The message.\n */\nfunction Cancel(message) {\n  this.message = message;\n}\n\nCancel.prototype.toString = function toString() {\n  return 'Cancel' + (this.message ? ': ' + this.message : '');\n};\n\nCancel.prototype.__CANCEL__ = true;\n\nmodule.exports = Cancel;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9DYW5jZWwuanM/N2E3NyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9DYW5jZWwuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQSBgQ2FuY2VsYCBpcyBhbiBvYmplY3QgdGhhdCBpcyB0aHJvd24gd2hlbiBhbiBvcGVyYXRpb24gaXMgY2FuY2VsZWQuXG4gKlxuICogQGNsYXNzXG4gKiBAcGFyYW0ge3N0cmluZz19IG1lc3NhZ2UgVGhlIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIENhbmNlbChtZXNzYWdlKSB7XG4gIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG59XG5cbkNhbmNlbC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgcmV0dXJuICdDYW5jZWwnICsgKHRoaXMubWVzc2FnZSA/ICc6ICcgKyB0aGlzLm1lc3NhZ2UgOiAnJyk7XG59O1xuXG5DYW5jZWwucHJvdG90eXBlLl9fQ0FOQ0VMX18gPSB0cnVlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhbmNlbDtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/cancel/Cancel.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/cancel/CancelToken.js":
/*!******************************************************!*\
  !*** ./node_modules/axios/lib/cancel/CancelToken.js ***!
  \******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar Cancel = __webpack_require__(/*! ./Cancel */ \"./node_modules/axios/lib/cancel/Cancel.js\");\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @class\n * @param {Function} executor The executor function.\n */\nfunction CancelToken(executor) {\n  if (typeof executor !== 'function') {\n    throw new TypeError('executor must be a function.');\n  }\n\n  var resolvePromise;\n  this.promise = new Promise(function promiseExecutor(resolve) {\n    resolvePromise = resolve;\n  });\n\n  var token = this;\n  executor(function cancel(message) {\n    if (token.reason) {\n      // Cancellation has already been requested\n      return;\n    }\n\n    token.reason = new Cancel(message);\n    resolvePromise(token.reason);\n  });\n}\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n  if (this.reason) {\n    throw this.reason;\n  }\n};\n\n/**\n * Returns an object that contains a new `CancelToken` and a function that, when called,\n * cancels the `CancelToken`.\n */\nCancelToken.source = function source() {\n  var cancel;\n  var token = new CancelToken(function executor(c) {\n    cancel = c;\n  });\n  return {\n    token: token,\n    cancel: cancel\n  };\n};\n\nmodule.exports = CancelToken;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9DYW5jZWxUb2tlbi5qcz84ZGY0Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLGFBQWEsbUJBQU8sQ0FBQywyREFBVTs7QUFFL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jYW5jZWwvQ2FuY2VsVG9rZW4uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBDYW5jZWwgPSByZXF1aXJlKCcuL0NhbmNlbCcpO1xuXG4vKipcbiAqIEEgYENhbmNlbFRva2VuYCBpcyBhbiBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCB0byByZXF1ZXN0IGNhbmNlbGxhdGlvbiBvZiBhbiBvcGVyYXRpb24uXG4gKlxuICogQGNsYXNzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBleGVjdXRvciBUaGUgZXhlY3V0b3IgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIENhbmNlbFRva2VuKGV4ZWN1dG9yKSB7XG4gIGlmICh0eXBlb2YgZXhlY3V0b3IgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdleGVjdXRvciBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7XG4gIH1cblxuICB2YXIgcmVzb2x2ZVByb21pc2U7XG4gIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIHByb21pc2VFeGVjdXRvcihyZXNvbHZlKSB7XG4gICAgcmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xuICB9KTtcblxuICB2YXIgdG9rZW4gPSB0aGlzO1xuICBleGVjdXRvcihmdW5jdGlvbiBjYW5jZWwobWVzc2FnZSkge1xuICAgIGlmICh0b2tlbi5yZWFzb24pIHtcbiAgICAgIC8vIENhbmNlbGxhdGlvbiBoYXMgYWxyZWFkeSBiZWVuIHJlcXVlc3RlZFxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRva2VuLnJlYXNvbiA9IG5ldyBDYW5jZWwobWVzc2FnZSk7XG4gICAgcmVzb2x2ZVByb21pc2UodG9rZW4ucmVhc29uKTtcbiAgfSk7XG59XG5cbi8qKlxuICogVGhyb3dzIGEgYENhbmNlbGAgaWYgY2FuY2VsbGF0aW9uIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAqL1xuQ2FuY2VsVG9rZW4ucHJvdG90eXBlLnRocm93SWZSZXF1ZXN0ZWQgPSBmdW5jdGlvbiB0aHJvd0lmUmVxdWVzdGVkKCkge1xuICBpZiAodGhpcy5yZWFzb24pIHtcbiAgICB0aHJvdyB0aGlzLnJlYXNvbjtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGEgbmV3IGBDYW5jZWxUb2tlbmAgYW5kIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsXG4gKiBjYW5jZWxzIHRoZSBgQ2FuY2VsVG9rZW5gLlxuICovXG5DYW5jZWxUb2tlbi5zb3VyY2UgPSBmdW5jdGlvbiBzb3VyY2UoKSB7XG4gIHZhciBjYW5jZWw7XG4gIHZhciB0b2tlbiA9IG5ldyBDYW5jZWxUb2tlbihmdW5jdGlvbiBleGVjdXRvcihjKSB7XG4gICAgY2FuY2VsID0gYztcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgdG9rZW46IHRva2VuLFxuICAgIGNhbmNlbDogY2FuY2VsXG4gIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhbmNlbFRva2VuO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/cancel/CancelToken.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/cancel/isCancel.js":
/*!***************************************************!*\
  !*** ./node_modules/axios/lib/cancel/isCancel.js ***!
  \***************************************************/
/***/ ((module) => {

"use strict";
eval("\n\nmodule.exports = function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NhbmNlbC9pc0NhbmNlbC5qcz8yZTY3Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViO0FBQ0E7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL2lzQ2FuY2VsLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQ2FuY2VsKHZhbHVlKSB7XG4gIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZS5fX0NBTkNFTF9fKTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/cancel/isCancel.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/Axios.js":
/*!**********************************************!*\
  !*** ./node_modules/axios/lib/core/Axios.js ***!
  \**********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\nvar buildURL = __webpack_require__(/*! ../helpers/buildURL */ \"./node_modules/axios/lib/helpers/buildURL.js\");\nvar InterceptorManager = __webpack_require__(/*! ./InterceptorManager */ \"./node_modules/axios/lib/core/InterceptorManager.js\");\nvar dispatchRequest = __webpack_require__(/*! ./dispatchRequest */ \"./node_modules/axios/lib/core/dispatchRequest.js\");\nvar mergeConfig = __webpack_require__(/*! ./mergeConfig */ \"./node_modules/axios/lib/core/mergeConfig.js\");\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n */\nfunction Axios(instanceConfig) {\n  this.defaults = instanceConfig;\n  this.interceptors = {\n    request: new InterceptorManager(),\n    response: new InterceptorManager()\n  };\n}\n\n/**\n * Dispatch a request\n *\n * @param {Object} config The config specific for this request (merged with this.defaults)\n */\nAxios.prototype.request = function request(config) {\n  /*eslint no-param-reassign:0*/\n  // Allow for axios('example/url'[, config]) a la fetch API\n  if (typeof config === 'string') {\n    config = arguments[1] || {};\n    config.url = arguments[0];\n  } else {\n    config = config || {};\n  }\n\n  config = mergeConfig(this.defaults, config);\n\n  // Set config.method\n  if (config.method) {\n    config.method = config.method.toLowerCase();\n  } else if (this.defaults.method) {\n    config.method = this.defaults.method.toLowerCase();\n  } else {\n    config.method = 'get';\n  }\n\n  // Hook up interceptors middleware\n  var chain = [dispatchRequest, undefined];\n  var promise = Promise.resolve(config);\n\n  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n    chain.push(interceptor.fulfilled, interceptor.rejected);\n  });\n\n  while (chain.length) {\n    promise = promise.then(chain.shift(), chain.shift());\n  }\n\n  return promise;\n};\n\nAxios.prototype.getUri = function getUri(config) {\n  config = mergeConfig(this.defaults, config);\n  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\\?/, '');\n};\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method: method,\n      url: url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, data, config) {\n    return this.request(mergeConfig(config || {}, {\n      method: method,\n      url: url,\n      data: data\n    }));\n  };\n});\n\nmodule.exports = Axios;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvQXhpb3MuanM/MGEwNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixZQUFZLG1CQUFPLENBQUMscURBQVk7QUFDaEMsZUFBZSxtQkFBTyxDQUFDLHlFQUFxQjtBQUM1Qyx5QkFBeUIsbUJBQU8sQ0FBQyxpRkFBc0I7QUFDdkQsc0JBQXNCLG1CQUFPLENBQUMsMkVBQW1CO0FBQ2pELGtCQUFrQixtQkFBTyxDQUFDLG1FQUFlOztBQUV6QztBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQ7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QixLQUFLO0FBQ0w7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRDtBQUNoRDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDOztBQUVEIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL0F4aW9zLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgYnVpbGRVUkwgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2J1aWxkVVJMJyk7XG52YXIgSW50ZXJjZXB0b3JNYW5hZ2VyID0gcmVxdWlyZSgnLi9JbnRlcmNlcHRvck1hbmFnZXInKTtcbnZhciBkaXNwYXRjaFJlcXVlc3QgPSByZXF1aXJlKCcuL2Rpc3BhdGNoUmVxdWVzdCcpO1xudmFyIG1lcmdlQ29uZmlnID0gcmVxdWlyZSgnLi9tZXJnZUNvbmZpZycpO1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBBeGlvc1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBpbnN0YW5jZUNvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBBeGlvcyhpbnN0YW5jZUNvbmZpZykge1xuICB0aGlzLmRlZmF1bHRzID0gaW5zdGFuY2VDb25maWc7XG4gIHRoaXMuaW50ZXJjZXB0b3JzID0ge1xuICAgIHJlcXVlc3Q6IG5ldyBJbnRlcmNlcHRvck1hbmFnZXIoKSxcbiAgICByZXNwb25zZTogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpXG4gIH07XG59XG5cbi8qKlxuICogRGlzcGF0Y2ggYSByZXF1ZXN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHNwZWNpZmljIGZvciB0aGlzIHJlcXVlc3QgKG1lcmdlZCB3aXRoIHRoaXMuZGVmYXVsdHMpXG4gKi9cbkF4aW9zLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdChjb25maWcpIHtcbiAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gIC8vIEFsbG93IGZvciBheGlvcygnZXhhbXBsZS91cmwnWywgY29uZmlnXSkgYSBsYSBmZXRjaCBBUElcbiAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uZmlnID0gYXJndW1lbnRzWzFdIHx8IHt9O1xuICAgIGNvbmZpZy51cmwgPSBhcmd1bWVudHNbMF07XG4gIH0gZWxzZSB7XG4gICAgY29uZmlnID0gY29uZmlnIHx8IHt9O1xuICB9XG5cbiAgY29uZmlnID0gbWVyZ2VDb25maWcodGhpcy5kZWZhdWx0cywgY29uZmlnKTtcblxuICAvLyBTZXQgY29uZmlnLm1ldGhvZFxuICBpZiAoY29uZmlnLm1ldGhvZCkge1xuICAgIGNvbmZpZy5tZXRob2QgPSBjb25maWcubWV0aG9kLnRvTG93ZXJDYXNlKCk7XG4gIH0gZWxzZSBpZiAodGhpcy5kZWZhdWx0cy5tZXRob2QpIHtcbiAgICBjb25maWcubWV0aG9kID0gdGhpcy5kZWZhdWx0cy5tZXRob2QudG9Mb3dlckNhc2UoKTtcbiAgfSBlbHNlIHtcbiAgICBjb25maWcubWV0aG9kID0gJ2dldCc7XG4gIH1cblxuICAvLyBIb29rIHVwIGludGVyY2VwdG9ycyBtaWRkbGV3YXJlXG4gIHZhciBjaGFpbiA9IFtkaXNwYXRjaFJlcXVlc3QsIHVuZGVmaW5lZF07XG4gIHZhciBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKGNvbmZpZyk7XG5cbiAgdGhpcy5pbnRlcmNlcHRvcnMucmVxdWVzdC5mb3JFYWNoKGZ1bmN0aW9uIHVuc2hpZnRSZXF1ZXN0SW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgY2hhaW4udW5zaGlmdChpbnRlcmNlcHRvci5mdWxmaWxsZWQsIGludGVyY2VwdG9yLnJlamVjdGVkKTtcbiAgfSk7XG5cbiAgdGhpcy5pbnRlcmNlcHRvcnMucmVzcG9uc2UuZm9yRWFjaChmdW5jdGlvbiBwdXNoUmVzcG9uc2VJbnRlcmNlcHRvcnMoaW50ZXJjZXB0b3IpIHtcbiAgICBjaGFpbi5wdXNoKGludGVyY2VwdG9yLmZ1bGZpbGxlZCwgaW50ZXJjZXB0b3IucmVqZWN0ZWQpO1xuICB9KTtcblxuICB3aGlsZSAoY2hhaW4ubGVuZ3RoKSB7XG4gICAgcHJvbWlzZSA9IHByb21pc2UudGhlbihjaGFpbi5zaGlmdCgpLCBjaGFpbi5zaGlmdCgpKTtcbiAgfVxuXG4gIHJldHVybiBwcm9taXNlO1xufTtcblxuQXhpb3MucHJvdG90eXBlLmdldFVyaSA9IGZ1bmN0aW9uIGdldFVyaShjb25maWcpIHtcbiAgY29uZmlnID0gbWVyZ2VDb25maWcodGhpcy5kZWZhdWx0cywgY29uZmlnKTtcbiAgcmV0dXJuIGJ1aWxkVVJMKGNvbmZpZy51cmwsIGNvbmZpZy5wYXJhbXMsIGNvbmZpZy5wYXJhbXNTZXJpYWxpemVyKS5yZXBsYWNlKC9eXFw/LywgJycpO1xufTtcblxuLy8gUHJvdmlkZSBhbGlhc2VzIGZvciBzdXBwb3J0ZWQgcmVxdWVzdCBtZXRob2RzXG51dGlscy5mb3JFYWNoKFsnZGVsZXRlJywgJ2dldCcsICdoZWFkJywgJ29wdGlvbnMnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZE5vRGF0YShtZXRob2QpIHtcbiAgLyplc2xpbnQgZnVuYy1uYW1lczowKi9cbiAgQXhpb3MucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbih1cmwsIGNvbmZpZykge1xuICAgIHJldHVybiB0aGlzLnJlcXVlc3QobWVyZ2VDb25maWcoY29uZmlnIHx8IHt9LCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIHVybDogdXJsLFxuICAgICAgZGF0YTogKGNvbmZpZyB8fCB7fSkuZGF0YVxuICAgIH0pKTtcbiAgfTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdChtZXJnZUNvbmZpZyhjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXhpb3M7XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/Axios.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/InterceptorManager.js":
/*!***********************************************************!*\
  !*** ./node_modules/axios/lib/core/InterceptorManager.js ***!
  \***********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\nfunction InterceptorManager() {\n  this.handlers = [];\n}\n\n/**\n * Add a new interceptor to the stack\n *\n * @param {Function} fulfilled The function to handle `then` for a `Promise`\n * @param {Function} rejected The function to handle `reject` for a `Promise`\n *\n * @return {Number} An ID used to remove interceptor later\n */\nInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n  this.handlers.push({\n    fulfilled: fulfilled,\n    rejected: rejected\n  });\n  return this.handlers.length - 1;\n};\n\n/**\n * Remove an interceptor from the stack\n *\n * @param {Number} id The ID that was returned by `use`\n */\nInterceptorManager.prototype.eject = function eject(id) {\n  if (this.handlers[id]) {\n    this.handlers[id] = null;\n  }\n};\n\n/**\n * Iterate over all the registered interceptors\n *\n * This method is particularly useful for skipping over any\n * interceptors that may have become `null` calling `eject`.\n *\n * @param {Function} fn The function to call for each interceptor\n */\nInterceptorManager.prototype.forEach = function forEach(fn) {\n  utils.forEach(this.handlers, function forEachHandler(h) {\n    if (h !== null) {\n      fn(h);\n    }\n  });\n};\n\nmodule.exports = InterceptorManager;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvSW50ZXJjZXB0b3JNYW5hZ2VyLmpzP2Y2YjQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLHFEQUFZOztBQUVoQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLFdBQVcsU0FBUztBQUNwQjtBQUNBLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL0ludGVyY2VwdG9yTWFuYWdlci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5mdW5jdGlvbiBJbnRlcmNlcHRvck1hbmFnZXIoKSB7XG4gIHRoaXMuaGFuZGxlcnMgPSBbXTtcbn1cblxuLyoqXG4gKiBBZGQgYSBuZXcgaW50ZXJjZXB0b3IgdG8gdGhlIHN0YWNrXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZnVsZmlsbGVkIFRoZSBmdW5jdGlvbiB0byBoYW5kbGUgYHRoZW5gIGZvciBhIGBQcm9taXNlYFxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0ZWQgVGhlIGZ1bmN0aW9uIHRvIGhhbmRsZSBgcmVqZWN0YCBmb3IgYSBgUHJvbWlzZWBcbiAqXG4gKiBAcmV0dXJuIHtOdW1iZXJ9IEFuIElEIHVzZWQgdG8gcmVtb3ZlIGludGVyY2VwdG9yIGxhdGVyXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUudXNlID0gZnVuY3Rpb24gdXNlKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpIHtcbiAgdGhpcy5oYW5kbGVycy5wdXNoKHtcbiAgICBmdWxmaWxsZWQ6IGZ1bGZpbGxlZCxcbiAgICByZWplY3RlZDogcmVqZWN0ZWRcbiAgfSk7XG4gIHJldHVybiB0aGlzLmhhbmRsZXJzLmxlbmd0aCAtIDE7XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbiBpbnRlcmNlcHRvciBmcm9tIHRoZSBzdGFja1xuICpcbiAqIEBwYXJhbSB7TnVtYmVyfSBpZCBUaGUgSUQgdGhhdCB3YXMgcmV0dXJuZWQgYnkgYHVzZWBcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS5lamVjdCA9IGZ1bmN0aW9uIGVqZWN0KGlkKSB7XG4gIGlmICh0aGlzLmhhbmRsZXJzW2lkXSkge1xuICAgIHRoaXMuaGFuZGxlcnNbaWRdID0gbnVsbDtcbiAgfVxufTtcblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYWxsIHRoZSByZWdpc3RlcmVkIGludGVyY2VwdG9yc1xuICpcbiAqIFRoaXMgbWV0aG9kIGlzIHBhcnRpY3VsYXJseSB1c2VmdWwgZm9yIHNraXBwaW5nIG92ZXIgYW55XG4gKiBpbnRlcmNlcHRvcnMgdGhhdCBtYXkgaGF2ZSBiZWNvbWUgYG51bGxgIGNhbGxpbmcgYGVqZWN0YC5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY2FsbCBmb3IgZWFjaCBpbnRlcmNlcHRvclxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbiBmb3JFYWNoKGZuKSB7XG4gIHV0aWxzLmZvckVhY2godGhpcy5oYW5kbGVycywgZnVuY3Rpb24gZm9yRWFjaEhhbmRsZXIoaCkge1xuICAgIGlmIChoICE9PSBudWxsKSB7XG4gICAgICBmbihoKTtcbiAgICB9XG4gIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbnRlcmNlcHRvck1hbmFnZXI7XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/InterceptorManager.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/buildFullPath.js":
/*!******************************************************!*\
  !*** ./node_modules/axios/lib/core/buildFullPath.js ***!
  \******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar isAbsoluteURL = __webpack_require__(/*! ../helpers/isAbsoluteURL */ \"./node_modules/axios/lib/helpers/isAbsoluteURL.js\");\nvar combineURLs = __webpack_require__(/*! ../helpers/combineURLs */ \"./node_modules/axios/lib/helpers/combineURLs.js\");\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n * @returns {string} The combined full path\n */\nmodule.exports = function buildFullPath(baseURL, requestedURL) {\n  if (baseURL && !isAbsoluteURL(requestedURL)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvYnVpbGRGdWxsUGF0aC5qcz84M2I5Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLG9CQUFvQixtQkFBTyxDQUFDLG1GQUEwQjtBQUN0RCxrQkFBa0IsbUJBQU8sQ0FBQywrRUFBd0I7O0FBRWxEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS9idWlsZEZ1bGxQYXRoLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgaXNBYnNvbHV0ZVVSTCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTCcpO1xudmFyIGNvbWJpbmVVUkxzID0gcmVxdWlyZSgnLi4vaGVscGVycy9jb21iaW5lVVJMcycpO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgVVJMIGJ5IGNvbWJpbmluZyB0aGUgYmFzZVVSTCB3aXRoIHRoZSByZXF1ZXN0ZWRVUkwsXG4gKiBvbmx5IHdoZW4gdGhlIHJlcXVlc3RlZFVSTCBpcyBub3QgYWxyZWFkeSBhbiBhYnNvbHV0ZSBVUkwuXG4gKiBJZiB0aGUgcmVxdWVzdFVSTCBpcyBhYnNvbHV0ZSwgdGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSByZXF1ZXN0ZWRVUkwgdW50b3VjaGVkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiYXNlVVJMIFRoZSBiYXNlIFVSTFxuICogQHBhcmFtIHtzdHJpbmd9IHJlcXVlc3RlZFVSTCBBYnNvbHV0ZSBvciByZWxhdGl2ZSBVUkwgdG8gY29tYmluZVxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNvbWJpbmVkIGZ1bGwgcGF0aFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJ1aWxkRnVsbFBhdGgoYmFzZVVSTCwgcmVxdWVzdGVkVVJMKSB7XG4gIGlmIChiYXNlVVJMICYmICFpc0Fic29sdXRlVVJMKHJlcXVlc3RlZFVSTCkpIHtcbiAgICByZXR1cm4gY29tYmluZVVSTHMoYmFzZVVSTCwgcmVxdWVzdGVkVVJMKTtcbiAgfVxuICByZXR1cm4gcmVxdWVzdGVkVVJMO1xufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/buildFullPath.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/createError.js":
/*!****************************************************!*\
  !*** ./node_modules/axios/lib/core/createError.js ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar enhanceError = __webpack_require__(/*! ./enhanceError */ \"./node_modules/axios/lib/core/enhanceError.js\");\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The created error.\n */\nmodule.exports = function createError(message, config, code, request, response) {\n  var error = new Error(message);\n  return enhanceError(error, config, code, request, response);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvY3JlYXRlRXJyb3IuanM/MmQ4MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixtQkFBbUIsbUJBQU8sQ0FBQyxxRUFBZ0I7O0FBRTNDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsYUFBYSxNQUFNO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvY3JlYXRlRXJyb3IuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBlbmhhbmNlRXJyb3IgPSByZXF1aXJlKCcuL2VuaGFuY2VFcnJvcicpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBFcnJvciB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZSwgY29uZmlnLCBlcnJvciBjb2RlLCByZXF1ZXN0IGFuZCByZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgZXJyb3IgbWVzc2FnZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBbY29kZV0gVGhlIGVycm9yIGNvZGUgKGZvciBleGFtcGxlLCAnRUNPTk5BQk9SVEVEJykuXG4gKiBAcGFyYW0ge09iamVjdH0gW3JlcXVlc3RdIFRoZSByZXF1ZXN0LlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXNwb25zZV0gVGhlIHJlc3BvbnNlLlxuICogQHJldHVybnMge0Vycm9yfSBUaGUgY3JlYXRlZCBlcnJvci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGVFcnJvcihtZXNzYWdlLCBjb25maWcsIGNvZGUsIHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gIHZhciBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgcmV0dXJuIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/createError.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/dispatchRequest.js":
/*!********************************************************!*\
  !*** ./node_modules/axios/lib/core/dispatchRequest.js ***!
  \********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\nvar transformData = __webpack_require__(/*! ./transformData */ \"./node_modules/axios/lib/core/transformData.js\");\nvar isCancel = __webpack_require__(/*! ../cancel/isCancel */ \"./node_modules/axios/lib/cancel/isCancel.js\");\nvar defaults = __webpack_require__(/*! ../defaults */ \"./node_modules/axios/lib/defaults.js\");\n\n/**\n * Throws a `Cancel` if cancellation has been requested.\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n * @returns {Promise} The Promise to be fulfilled\n */\nmodule.exports = function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  // Ensure headers exist\n  config.headers = config.headers || {};\n\n  // Transform request data\n  config.data = transformData(\n    config.data,\n    config.headers,\n    config.transformRequest\n  );\n\n  // Flatten headers\n  config.headers = utils.merge(\n    config.headers.common || {},\n    config.headers[config.method] || {},\n    config.headers\n  );\n\n  utils.forEach(\n    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n    function cleanHeaderConfig(method) {\n      delete config.headers[method];\n    }\n  );\n\n  var adapter = config.adapter || defaults.adapter;\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData(\n      response.data,\n      response.headers,\n      config.transformResponse\n    );\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData(\n          reason.response.data,\n          reason.response.headers,\n          config.transformResponse\n        );\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvZGlzcGF0Y2hSZXF1ZXN0LmpzPzUyNzAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLHFEQUFZO0FBQ2hDLG9CQUFvQixtQkFBTyxDQUFDLHVFQUFpQjtBQUM3QyxlQUFlLG1CQUFPLENBQUMsdUVBQW9CO0FBQzNDLGVBQWUsbUJBQU8sQ0FBQyx5REFBYTs7QUFFcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CLHVDQUF1QztBQUN2QztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSCIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS9kaXNwYXRjaFJlcXVlc3QuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciB0cmFuc2Zvcm1EYXRhID0gcmVxdWlyZSgnLi90cmFuc2Zvcm1EYXRhJyk7XG52YXIgaXNDYW5jZWwgPSByZXF1aXJlKCcuLi9jYW5jZWwvaXNDYW5jZWwnKTtcbnZhciBkZWZhdWx0cyA9IHJlcXVpcmUoJy4uL2RlZmF1bHRzJyk7XG5cbi8qKlxuICogVGhyb3dzIGEgYENhbmNlbGAgaWYgY2FuY2VsbGF0aW9uIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAqL1xuZnVuY3Rpb24gdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgIGNvbmZpZy5jYW5jZWxUb2tlbi50aHJvd0lmUmVxdWVzdGVkKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB1c2luZyB0aGUgY29uZmlndXJlZCBhZGFwdGVyLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZyB0aGF0IGlzIHRvIGJlIHVzZWQgZm9yIHRoZSByZXF1ZXN0XG4gKiBAcmV0dXJucyB7UHJvbWlzZX0gVGhlIFByb21pc2UgdG8gYmUgZnVsZmlsbGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGlzcGF0Y2hSZXF1ZXN0KGNvbmZpZykge1xuICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgLy8gRW5zdXJlIGhlYWRlcnMgZXhpc3RcbiAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcblxuICAvLyBUcmFuc2Zvcm0gcmVxdWVzdCBkYXRhXG4gIGNvbmZpZy5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICBjb25maWcuZGF0YSxcbiAgICBjb25maWcuaGVhZGVycyxcbiAgICBjb25maWcudHJhbnNmb3JtUmVxdWVzdFxuICApO1xuXG4gIC8vIEZsYXR0ZW4gaGVhZGVyc1xuICBjb25maWcuaGVhZGVycyA9IHV0aWxzLm1lcmdlKFxuICAgIGNvbmZpZy5oZWFkZXJzLmNvbW1vbiB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVyc1tjb25maWcubWV0aG9kXSB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVyc1xuICApO1xuXG4gIHV0aWxzLmZvckVhY2goXG4gICAgWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAncG9zdCcsICdwdXQnLCAncGF0Y2gnLCAnY29tbW9uJ10sXG4gICAgZnVuY3Rpb24gY2xlYW5IZWFkZXJDb25maWcobWV0aG9kKSB7XG4gICAgICBkZWxldGUgY29uZmlnLmhlYWRlcnNbbWV0aG9kXTtcbiAgICB9XG4gICk7XG5cbiAgdmFyIGFkYXB0ZXIgPSBjb25maWcuYWRhcHRlciB8fCBkZWZhdWx0cy5hZGFwdGVyO1xuXG4gIHJldHVybiBhZGFwdGVyKGNvbmZpZykudGhlbihmdW5jdGlvbiBvbkFkYXB0ZXJSZXNvbHV0aW9uKHJlc3BvbnNlKSB7XG4gICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgLy8gVHJhbnNmb3JtIHJlc3BvbnNlIGRhdGFcbiAgICByZXNwb25zZS5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICAgIHJlc3BvbnNlLmRhdGEsXG4gICAgICByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgKTtcblxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSwgZnVuY3Rpb24gb25BZGFwdGVyUmVqZWN0aW9uKHJlYXNvbikge1xuICAgIGlmICghaXNDYW5jZWwocmVhc29uKSkge1xuICAgICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgICAgaWYgKHJlYXNvbiAmJiByZWFzb24ucmVzcG9uc2UpIHtcbiAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5kYXRhLFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgIGNvbmZpZy50cmFuc2Zvcm1SZXNwb25zZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZWFzb24pO1xuICB9KTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/dispatchRequest.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/enhanceError.js":
/*!*****************************************************!*\
  !*** ./node_modules/axios/lib/core/enhanceError.js ***!
  \*****************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Update an Error with the specified config, error code, and response.\n *\n * @param {Error} error The error to update.\n * @param {Object} config The config.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n * @returns {Error} The error.\n */\nmodule.exports = function enhanceError(error, config, code, request, response) {\n  error.config = config;\n  if (code) {\n    error.code = code;\n  }\n\n  error.request = request;\n  error.response = response;\n  error.isAxiosError = true;\n\n  error.toJSON = function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: this.config,\n      code: this.code\n    };\n  };\n  return error;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvZW5oYW5jZUVycm9yLmpzPzM4N2YiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsV0FBVyxNQUFNO0FBQ2pCLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2VuaGFuY2VFcnJvci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVcGRhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIGNvbmZpZywgZXJyb3IgY29kZSwgYW5kIHJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIFRoZSBlcnJvciB0byB1cGRhdGUuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGVycm9yLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICBlcnJvci5jb25maWcgPSBjb25maWc7XG4gIGlmIChjb2RlKSB7XG4gICAgZXJyb3IuY29kZSA9IGNvZGU7XG4gIH1cblxuICBlcnJvci5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgZXJyb3IucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgZXJyb3IuaXNBeGlvc0Vycm9yID0gdHJ1ZTtcblxuICBlcnJvci50b0pTT04gPSBmdW5jdGlvbiB0b0pTT04oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC8vIFN0YW5kYXJkXG4gICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2UsXG4gICAgICBuYW1lOiB0aGlzLm5hbWUsXG4gICAgICAvLyBNaWNyb3NvZnRcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLFxuICAgICAgbnVtYmVyOiB0aGlzLm51bWJlcixcbiAgICAgIC8vIE1vemlsbGFcbiAgICAgIGZpbGVOYW1lOiB0aGlzLmZpbGVOYW1lLFxuICAgICAgbGluZU51bWJlcjogdGhpcy5saW5lTnVtYmVyLFxuICAgICAgY29sdW1uTnVtYmVyOiB0aGlzLmNvbHVtbk51bWJlcixcbiAgICAgIHN0YWNrOiB0aGlzLnN0YWNrLFxuICAgICAgLy8gQXhpb3NcbiAgICAgIGNvbmZpZzogdGhpcy5jb25maWcsXG4gICAgICBjb2RlOiB0aGlzLmNvZGVcbiAgICB9O1xuICB9O1xuICByZXR1cm4gZXJyb3I7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/enhanceError.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/mergeConfig.js":
/*!****************************************************!*\
  !*** ./node_modules/axios/lib/core/mergeConfig.js ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ../utils */ \"./node_modules/axios/lib/utils.js\");\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n * @returns {Object} New object resulting from merging config2 to config1\n */\nmodule.exports = function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  var config = {};\n\n  var valueFromConfig2Keys = ['url', 'method', 'data'];\n  var mergeDeepPropertiesKeys = ['headers', 'auth', 'proxy', 'params'];\n  var defaultToConfig2Keys = [\n    'baseURL', 'transformRequest', 'transformResponse', 'paramsSerializer',\n    'timeout', 'timeoutMessage', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',\n    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress', 'decompress',\n    'maxContentLength', 'maxBodyLength', 'maxRedirects', 'transport', 'httpAgent',\n    'httpsAgent', 'cancelToken', 'socketPath', 'responseEncoding'\n  ];\n  var directMergeKeys = ['validateStatus'];\n\n  function getMergedValue(target, source) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge(target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  function mergeDeepProperties(prop) {\n    if (!utils.isUndefined(config2[prop])) {\n      config[prop] = getMergedValue(config1[prop], config2[prop]);\n    } else if (!utils.isUndefined(config1[prop])) {\n      config[prop] = getMergedValue(undefined, config1[prop]);\n    }\n  }\n\n  utils.forEach(valueFromConfig2Keys, function valueFromConfig2(prop) {\n    if (!utils.isUndefined(config2[prop])) {\n      config[prop] = getMergedValue(undefined, config2[prop]);\n    }\n  });\n\n  utils.forEach(mergeDeepPropertiesKeys, mergeDeepProperties);\n\n  utils.forEach(defaultToConfig2Keys, function defaultToConfig2(prop) {\n    if (!utils.isUndefined(config2[prop])) {\n      config[prop] = getMergedValue(undefined, config2[prop]);\n    } else if (!utils.isUndefined(config1[prop])) {\n      config[prop] = getMergedValue(undefined, config1[prop]);\n    }\n  });\n\n  utils.forEach(directMergeKeys, function merge(prop) {\n    if (prop in config2) {\n      config[prop] = getMergedValue(config1[prop], config2[prop]);\n    } else if (prop in config1) {\n      config[prop] = getMergedValue(undefined, config1[prop]);\n    }\n  });\n\n  var axiosKeys = valueFromConfig2Keys\n    .concat(mergeDeepPropertiesKeys)\n    .concat(defaultToConfig2Keys)\n    .concat(directMergeKeys);\n\n  var otherKeys = Object\n    .keys(config1)\n    .concat(Object.keys(config2))\n    .filter(function filterAxiosKeys(key) {\n      return axiosKeys.indexOf(key) === -1;\n    });\n\n  utils.forEach(otherKeys, mergeDeepProperties);\n\n  return config;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvbWVyZ2VDb25maWcuanM/NGE3YiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixZQUFZLG1CQUFPLENBQUMsbURBQVU7O0FBRTlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixhQUFhLE9BQU87QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsMkJBQTJCO0FBQzNCLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvbWVyZ2VDb25maWcuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbi8qKlxuICogQ29uZmlnLXNwZWNpZmljIG1lcmdlLWZ1bmN0aW9uIHdoaWNoIGNyZWF0ZXMgYSBuZXcgY29uZmlnLW9iamVjdFxuICogYnkgbWVyZ2luZyB0d28gY29uZmlndXJhdGlvbiBvYmplY3RzIHRvZ2V0aGVyLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcxXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnMlxuICogQHJldHVybnMge09iamVjdH0gTmV3IG9iamVjdCByZXN1bHRpbmcgZnJvbSBtZXJnaW5nIGNvbmZpZzIgdG8gY29uZmlnMVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG1lcmdlQ29uZmlnKGNvbmZpZzEsIGNvbmZpZzIpIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gIGNvbmZpZzIgPSBjb25maWcyIHx8IHt9O1xuICB2YXIgY29uZmlnID0ge307XG5cbiAgdmFyIHZhbHVlRnJvbUNvbmZpZzJLZXlzID0gWyd1cmwnLCAnbWV0aG9kJywgJ2RhdGEnXTtcbiAgdmFyIG1lcmdlRGVlcFByb3BlcnRpZXNLZXlzID0gWydoZWFkZXJzJywgJ2F1dGgnLCAncHJveHknLCAncGFyYW1zJ107XG4gIHZhciBkZWZhdWx0VG9Db25maWcyS2V5cyA9IFtcbiAgICAnYmFzZVVSTCcsICd0cmFuc2Zvcm1SZXF1ZXN0JywgJ3RyYW5zZm9ybVJlc3BvbnNlJywgJ3BhcmFtc1NlcmlhbGl6ZXInLFxuICAgICd0aW1lb3V0JywgJ3RpbWVvdXRNZXNzYWdlJywgJ3dpdGhDcmVkZW50aWFscycsICdhZGFwdGVyJywgJ3Jlc3BvbnNlVHlwZScsICd4c3JmQ29va2llTmFtZScsXG4gICAgJ3hzcmZIZWFkZXJOYW1lJywgJ29uVXBsb2FkUHJvZ3Jlc3MnLCAnb25Eb3dubG9hZFByb2dyZXNzJywgJ2RlY29tcHJlc3MnLFxuICAgICdtYXhDb250ZW50TGVuZ3RoJywgJ21heEJvZHlMZW5ndGgnLCAnbWF4UmVkaXJlY3RzJywgJ3RyYW5zcG9ydCcsICdodHRwQWdlbnQnLFxuICAgICdodHRwc0FnZW50JywgJ2NhbmNlbFRva2VuJywgJ3NvY2tldFBhdGgnLCAncmVzcG9uc2VFbmNvZGluZydcbiAgXTtcbiAgdmFyIGRpcmVjdE1lcmdlS2V5cyA9IFsndmFsaWRhdGVTdGF0dXMnXTtcblxuICBmdW5jdGlvbiBnZXRNZXJnZWRWYWx1ZSh0YXJnZXQsIHNvdXJjZSkge1xuICAgIGlmICh1dGlscy5pc1BsYWluT2JqZWN0KHRhcmdldCkgJiYgdXRpbHMuaXNQbGFpbk9iamVjdChzb3VyY2UpKSB7XG4gICAgICByZXR1cm4gdXRpbHMubWVyZ2UodGFyZ2V0LCBzb3VyY2UpO1xuICAgIH0gZWxzZSBpZiAodXRpbHMuaXNQbGFpbk9iamVjdChzb3VyY2UpKSB7XG4gICAgICByZXR1cm4gdXRpbHMubWVyZ2Uoe30sIHNvdXJjZSk7XG4gICAgfSBlbHNlIGlmICh1dGlscy5pc0FycmF5KHNvdXJjZSkpIHtcbiAgICAgIHJldHVybiBzb3VyY2Uuc2xpY2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG1lcmdlRGVlcFByb3BlcnRpZXMocHJvcCkge1xuICAgIGlmICghdXRpbHMuaXNVbmRlZmluZWQoY29uZmlnMltwcm9wXSkpIHtcbiAgICAgIGNvbmZpZ1twcm9wXSA9IGdldE1lcmdlZFZhbHVlKGNvbmZpZzFbcHJvcF0sIGNvbmZpZzJbcHJvcF0pO1xuICAgIH0gZWxzZSBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGNvbmZpZzFbcHJvcF0pKSB7XG4gICAgICBjb25maWdbcHJvcF0gPSBnZXRNZXJnZWRWYWx1ZSh1bmRlZmluZWQsIGNvbmZpZzFbcHJvcF0pO1xuICAgIH1cbiAgfVxuXG4gIHV0aWxzLmZvckVhY2godmFsdWVGcm9tQ29uZmlnMktleXMsIGZ1bmN0aW9uIHZhbHVlRnJvbUNvbmZpZzIocHJvcCkge1xuICAgIGlmICghdXRpbHMuaXNVbmRlZmluZWQoY29uZmlnMltwcm9wXSkpIHtcbiAgICAgIGNvbmZpZ1twcm9wXSA9IGdldE1lcmdlZFZhbHVlKHVuZGVmaW5lZCwgY29uZmlnMltwcm9wXSk7XG4gICAgfVxuICB9KTtcblxuICB1dGlscy5mb3JFYWNoKG1lcmdlRGVlcFByb3BlcnRpZXNLZXlzLCBtZXJnZURlZXBQcm9wZXJ0aWVzKTtcblxuICB1dGlscy5mb3JFYWNoKGRlZmF1bHRUb0NvbmZpZzJLZXlzLCBmdW5jdGlvbiBkZWZhdWx0VG9Db25maWcyKHByb3ApIHtcbiAgICBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGNvbmZpZzJbcHJvcF0pKSB7XG4gICAgICBjb25maWdbcHJvcF0gPSBnZXRNZXJnZWRWYWx1ZSh1bmRlZmluZWQsIGNvbmZpZzJbcHJvcF0pO1xuICAgIH0gZWxzZSBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGNvbmZpZzFbcHJvcF0pKSB7XG4gICAgICBjb25maWdbcHJvcF0gPSBnZXRNZXJnZWRWYWx1ZSh1bmRlZmluZWQsIGNvbmZpZzFbcHJvcF0pO1xuICAgIH1cbiAgfSk7XG5cbiAgdXRpbHMuZm9yRWFjaChkaXJlY3RNZXJnZUtleXMsIGZ1bmN0aW9uIG1lcmdlKHByb3ApIHtcbiAgICBpZiAocHJvcCBpbiBjb25maWcyKSB7XG4gICAgICBjb25maWdbcHJvcF0gPSBnZXRNZXJnZWRWYWx1ZShjb25maWcxW3Byb3BdLCBjb25maWcyW3Byb3BdKTtcbiAgICB9IGVsc2UgaWYgKHByb3AgaW4gY29uZmlnMSkge1xuICAgICAgY29uZmlnW3Byb3BdID0gZ2V0TWVyZ2VkVmFsdWUodW5kZWZpbmVkLCBjb25maWcxW3Byb3BdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBheGlvc0tleXMgPSB2YWx1ZUZyb21Db25maWcyS2V5c1xuICAgIC5jb25jYXQobWVyZ2VEZWVwUHJvcGVydGllc0tleXMpXG4gICAgLmNvbmNhdChkZWZhdWx0VG9Db25maWcyS2V5cylcbiAgICAuY29uY2F0KGRpcmVjdE1lcmdlS2V5cyk7XG5cbiAgdmFyIG90aGVyS2V5cyA9IE9iamVjdFxuICAgIC5rZXlzKGNvbmZpZzEpXG4gICAgLmNvbmNhdChPYmplY3Qua2V5cyhjb25maWcyKSlcbiAgICAuZmlsdGVyKGZ1bmN0aW9uIGZpbHRlckF4aW9zS2V5cyhrZXkpIHtcbiAgICAgIHJldHVybiBheGlvc0tleXMuaW5kZXhPZihrZXkpID09PSAtMTtcbiAgICB9KTtcblxuICB1dGlscy5mb3JFYWNoKG90aGVyS2V5cywgbWVyZ2VEZWVwUHJvcGVydGllcyk7XG5cbiAgcmV0dXJuIGNvbmZpZztcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/mergeConfig.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/settle.js":
/*!***********************************************!*\
  !*** ./node_modules/axios/lib/core/settle.js ***!
  \***********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar createError = __webpack_require__(/*! ./createError */ \"./node_modules/axios/lib/core/createError.js\");\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n */\nmodule.exports = function settle(resolve, reject, response) {\n  var validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(createError(\n      'Request failed with status code ' + response.status,\n      response.config,\n      null,\n      response.request,\n      response\n    ));\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvc2V0dGxlLmpzPzQ2N2YiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsa0JBQWtCLG1CQUFPLENBQUMsbUVBQWU7O0FBRXpDO0FBQ0E7QUFDQTtBQUNBLFdBQVcsU0FBUztBQUNwQixXQUFXLFNBQVM7QUFDcEIsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL3NldHRsZS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnLi9jcmVhdGVFcnJvcicpO1xuXG4vKipcbiAqIFJlc29sdmUgb3IgcmVqZWN0IGEgUHJvbWlzZSBiYXNlZCBvbiByZXNwb25zZSBzdGF0dXMuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZSBBIGZ1bmN0aW9uIHRoYXQgcmVzb2x2ZXMgdGhlIHByb21pc2UuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWplY3QgQSBmdW5jdGlvbiB0aGF0IHJlamVjdHMgdGhlIHByb21pc2UuXG4gKiBAcGFyYW0ge29iamVjdH0gcmVzcG9uc2UgVGhlIHJlc3BvbnNlLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKSB7XG4gIHZhciB2YWxpZGF0ZVN0YXR1cyA9IHJlc3BvbnNlLmNvbmZpZy52YWxpZGF0ZVN0YXR1cztcbiAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgIXZhbGlkYXRlU3RhdHVzIHx8IHZhbGlkYXRlU3RhdHVzKHJlc3BvbnNlLnN0YXR1cykpIHtcbiAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgfSBlbHNlIHtcbiAgICByZWplY3QoY3JlYXRlRXJyb3IoXG4gICAgICAnUmVxdWVzdCBmYWlsZWQgd2l0aCBzdGF0dXMgY29kZSAnICsgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgcmVzcG9uc2UuY29uZmlnLFxuICAgICAgbnVsbCxcbiAgICAgIHJlc3BvbnNlLnJlcXVlc3QsXG4gICAgICByZXNwb25zZVxuICAgICkpO1xuICB9XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/settle.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/core/transformData.js":
/*!******************************************************!*\
  !*** ./node_modules/axios/lib/core/transformData.js ***!
  \******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Object|String} data The data to be transformed\n * @param {Array} headers The headers for the request or response\n * @param {Array|Function} fns A single function or Array of functions\n * @returns {*} The resulting transformed data\n */\nmodule.exports = function transformData(data, headers, fns) {\n  /*eslint no-param-reassign:0*/\n  utils.forEach(fns, function transform(fn) {\n    data = fn(data, headers);\n  });\n\n  return data;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvdHJhbnNmb3JtRGF0YS5qcz9jNDAxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLFlBQVksbUJBQU8sQ0FBQyxxREFBWTs7QUFFaEM7QUFDQTtBQUNBO0FBQ0EsV0FBVyxjQUFjO0FBQ3pCLFdBQVcsTUFBTTtBQUNqQixXQUFXLGVBQWU7QUFDMUIsYUFBYSxFQUFFO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS90cmFuc2Zvcm1EYXRhLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbi8qKlxuICogVHJhbnNmb3JtIHRoZSBkYXRhIGZvciBhIHJlcXVlc3Qgb3IgYSByZXNwb25zZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gZGF0YSBUaGUgZGF0YSB0byBiZSB0cmFuc2Zvcm1lZFxuICogQHBhcmFtIHtBcnJheX0gaGVhZGVycyBUaGUgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3Qgb3IgcmVzcG9uc2VcbiAqIEBwYXJhbSB7QXJyYXl8RnVuY3Rpb259IGZucyBBIHNpbmdsZSBmdW5jdGlvbiBvciBBcnJheSBvZiBmdW5jdGlvbnNcbiAqIEByZXR1cm5zIHsqfSBUaGUgcmVzdWx0aW5nIHRyYW5zZm9ybWVkIGRhdGFcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmFuc2Zvcm1EYXRhKGRhdGEsIGhlYWRlcnMsIGZucykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgdXRpbHMuZm9yRWFjaChmbnMsIGZ1bmN0aW9uIHRyYW5zZm9ybShmbikge1xuICAgIGRhdGEgPSBmbihkYXRhLCBoZWFkZXJzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRhdGE7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/core/transformData.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/defaults.js":
/*!********************************************!*\
  !*** ./node_modules/axios/lib/defaults.js ***!
  \********************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("/* provided dependency */ var process = __webpack_require__(/*! process/browser */ \"./node_modules/process/browser.js\");\n\n\nvar utils = __webpack_require__(/*! ./utils */ \"./node_modules/axios/lib/utils.js\");\nvar normalizeHeaderName = __webpack_require__(/*! ./helpers/normalizeHeaderName */ \"./node_modules/axios/lib/helpers/normalizeHeaderName.js\");\n\nvar DEFAULT_CONTENT_TYPE = {\n  'Content-Type': 'application/x-www-form-urlencoded'\n};\n\nfunction setContentTypeIfUnset(headers, value) {\n  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n    headers['Content-Type'] = value;\n  }\n}\n\nfunction getDefaultAdapter() {\n  var adapter;\n  if (typeof XMLHttpRequest !== 'undefined') {\n    // For browsers use XHR adapter\n    adapter = __webpack_require__(/*! ./adapters/xhr */ \"./node_modules/axios/lib/adapters/xhr.js\");\n  } else if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {\n    // For node use HTTP adapter\n    adapter = __webpack_require__(/*! ./adapters/http */ \"./node_modules/axios/lib/adapters/xhr.js\");\n  }\n  return adapter;\n}\n\nvar defaults = {\n  adapter: getDefaultAdapter(),\n\n  transformRequest: [function transformRequest(data, headers) {\n    normalizeHeaderName(headers, 'Accept');\n    normalizeHeaderName(headers, 'Content-Type');\n    if (utils.isFormData(data) ||\n      utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n      return data.toString();\n    }\n    if (utils.isObject(data)) {\n      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n      return JSON.stringify(data);\n    }\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    /*eslint no-param-reassign:0*/\n    if (typeof data === 'string') {\n      try {\n        data = JSON.parse(data);\n      } catch (e) { /* Ignore */ }\n    }\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  }\n};\n\ndefaults.headers = {\n  common: {\n    'Accept': 'application/json, text/plain, */*'\n  }\n};\n\nutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n  defaults.headers[method] = {};\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n});\n\nmodule.exports = defaults;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2RlZmF1bHRzLmpzPzI0NDQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFhOztBQUViLFlBQVksbUJBQU8sQ0FBQyxrREFBUztBQUM3QiwwQkFBMEIsbUJBQU8sQ0FBQyw4RkFBK0I7O0FBRWpFO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxtQkFBTyxDQUFDLGdFQUFnQjtBQUN0QyxHQUFHLGlCQUFpQixPQUFPLG1EQUFtRCxPQUFPO0FBQ3JGO0FBQ0EsY0FBYyxtQkFBTyxDQUFDLGlFQUFpQjtBQUN2QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF3RTtBQUN4RTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQ7QUFDdkQ7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxZQUFZO0FBQ25CO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBLENBQUM7O0FBRUQiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2RlZmF1bHRzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgbm9ybWFsaXplSGVhZGVyTmFtZSA9IHJlcXVpcmUoJy4vaGVscGVycy9ub3JtYWxpemVIZWFkZXJOYW1lJyk7XG5cbnZhciBERUZBVUxUX0NPTlRFTlRfVFlQRSA9IHtcbiAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXG59O1xuXG5mdW5jdGlvbiBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgdmFsdWUpIHtcbiAgaWYgKCF1dGlscy5pc1VuZGVmaW5lZChoZWFkZXJzKSAmJiB1dGlscy5pc1VuZGVmaW5lZChoZWFkZXJzWydDb250ZW50LVR5cGUnXSkpIHtcbiAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9IHZhbHVlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldERlZmF1bHRBZGFwdGVyKCkge1xuICB2YXIgYWRhcHRlcjtcbiAgaWYgKHR5cGVvZiBYTUxIdHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBGb3IgYnJvd3NlcnMgdXNlIFhIUiBhZGFwdGVyXG4gICAgYWRhcHRlciA9IHJlcXVpcmUoJy4vYWRhcHRlcnMveGhyJyk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKSB7XG4gICAgLy8gRm9yIG5vZGUgdXNlIEhUVFAgYWRhcHRlclxuICAgIGFkYXB0ZXIgPSByZXF1aXJlKCcuL2FkYXB0ZXJzL2h0dHAnKTtcbiAgfVxuICByZXR1cm4gYWRhcHRlcjtcbn1cblxudmFyIGRlZmF1bHRzID0ge1xuICBhZGFwdGVyOiBnZXREZWZhdWx0QWRhcHRlcigpLFxuXG4gIHRyYW5zZm9ybVJlcXVlc3Q6IFtmdW5jdGlvbiB0cmFuc2Zvcm1SZXF1ZXN0KGRhdGEsIGhlYWRlcnMpIHtcbiAgICBub3JtYWxpemVIZWFkZXJOYW1lKGhlYWRlcnMsICdBY2NlcHQnKTtcbiAgICBub3JtYWxpemVIZWFkZXJOYW1lKGhlYWRlcnMsICdDb250ZW50LVR5cGUnKTtcbiAgICBpZiAodXRpbHMuaXNGb3JtRGF0YShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNBcnJheUJ1ZmZlcihkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNCdWZmZXIoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzU3RyZWFtKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0ZpbGUoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzQmxvYihkYXRhKVxuICAgICkge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc0FycmF5QnVmZmVyVmlldyhkYXRhKSkge1xuICAgICAgcmV0dXJuIGRhdGEuYnVmZmVyO1xuICAgIH1cbiAgICBpZiAodXRpbHMuaXNVUkxTZWFyY2hQYXJhbXMoZGF0YSkpIHtcbiAgICAgIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9dXRmLTgnKTtcbiAgICAgIHJldHVybiBkYXRhLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc09iamVjdChkYXRhKSkge1xuICAgICAgc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnKTtcbiAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1dLFxuXG4gIHRyYW5zZm9ybVJlc3BvbnNlOiBbZnVuY3Rpb24gdHJhbnNmb3JtUmVzcG9uc2UoZGF0YSkge1xuICAgIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgfSBjYXRjaCAoZSkgeyAvKiBJZ25vcmUgKi8gfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfV0sXG5cbiAgLyoqXG4gICAqIEEgdGltZW91dCBpbiBtaWxsaXNlY29uZHMgdG8gYWJvcnQgYSByZXF1ZXN0LiBJZiBzZXQgdG8gMCAoZGVmYXVsdCkgYVxuICAgKiB0aW1lb3V0IGlzIG5vdCBjcmVhdGVkLlxuICAgKi9cbiAgdGltZW91dDogMCxcblxuICB4c3JmQ29va2llTmFtZTogJ1hTUkYtVE9LRU4nLFxuICB4c3JmSGVhZGVyTmFtZTogJ1gtWFNSRi1UT0tFTicsXG5cbiAgbWF4Q29udGVudExlbmd0aDogLTEsXG4gIG1heEJvZHlMZW5ndGg6IC0xLFxuXG4gIHZhbGlkYXRlU3RhdHVzOiBmdW5jdGlvbiB2YWxpZGF0ZVN0YXR1cyhzdGF0dXMpIHtcbiAgICByZXR1cm4gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDA7XG4gIH1cbn07XG5cbmRlZmF1bHRzLmhlYWRlcnMgPSB7XG4gIGNvbW1vbjoge1xuICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJ1xuICB9XG59O1xuXG51dGlscy5mb3JFYWNoKFsnZGVsZXRlJywgJ2dldCcsICdoZWFkJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2ROb0RhdGEobWV0aG9kKSB7XG4gIGRlZmF1bHRzLmhlYWRlcnNbbWV0aG9kXSA9IHt9O1xufSk7XG5cbnV0aWxzLmZvckVhY2goWydwb3N0JywgJ3B1dCcsICdwYXRjaCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kV2l0aERhdGEobWV0aG9kKSB7XG4gIGRlZmF1bHRzLmhlYWRlcnNbbWV0aG9kXSA9IHV0aWxzLm1lcmdlKERFRkFVTFRfQ09OVEVOVF9UWVBFKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRlZmF1bHRzO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/defaults.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/bind.js":
/*!************************************************!*\
  !*** ./node_modules/axios/lib/helpers/bind.js ***!
  \************************************************/
/***/ ((module) => {

"use strict";
eval("\n\nmodule.exports = function bind(fn, thisArg) {\n  return function wrap() {\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n    return fn.apply(thisArg, args);\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYmluZC5qcz8xZDJiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixpQkFBaUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9iaW5kLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJpbmQoZm4sIHRoaXNBcmcpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHdyYXAoKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2ldO1xuICAgIH1cbiAgICByZXR1cm4gZm4uYXBwbHkodGhpc0FyZywgYXJncyk7XG4gIH07XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/bind.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/buildURL.js":
/*!****************************************************!*\
  !*** ./node_modules/axios/lib/helpers/buildURL.js ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @returns {string} The formatted url\n */\nmodule.exports = function buildURL(url, params, paramsSerializer) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n\n  var serializedParams;\n  if (paramsSerializer) {\n    serializedParams = paramsSerializer(params);\n  } else if (utils.isURLSearchParams(params)) {\n    serializedParams = params.toString();\n  } else {\n    var parts = [];\n\n    utils.forEach(params, function serialize(val, key) {\n      if (val === null || typeof val === 'undefined') {\n        return;\n      }\n\n      if (utils.isArray(val)) {\n        key = key + '[]';\n      } else {\n        val = [val];\n      }\n\n      utils.forEach(val, function parseValue(v) {\n        if (utils.isDate(v)) {\n          v = v.toISOString();\n        } else if (utils.isObject(v)) {\n          v = JSON.stringify(v);\n        }\n        parts.push(encode(key) + '=' + encode(v));\n      });\n    });\n\n    serializedParams = parts.join('&');\n  }\n\n  if (serializedParams) {\n    var hashmarkIndex = url.indexOf('#');\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYnVpbGRVUkwuanM/MzBiNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYixZQUFZLG1CQUFPLENBQUMscURBQVk7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9idWlsZFVSTC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5mdW5jdGlvbiBlbmNvZGUodmFsKSB7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQodmFsKS5cbiAgICByZXBsYWNlKC8lM0EvZ2ksICc6JykuXG4gICAgcmVwbGFjZSgvJTI0L2csICckJykuXG4gICAgcmVwbGFjZSgvJTJDL2dpLCAnLCcpLlxuICAgIHJlcGxhY2UoLyUyMC9nLCAnKycpLlxuICAgIHJlcGxhY2UoLyU1Qi9naSwgJ1snKS5cbiAgICByZXBsYWNlKC8lNUQvZ2ksICddJyk7XG59XG5cbi8qKlxuICogQnVpbGQgYSBVUkwgYnkgYXBwZW5kaW5nIHBhcmFtcyB0byB0aGUgZW5kXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgYmFzZSBvZiB0aGUgdXJsIChlLmcuLCBodHRwOi8vd3d3Lmdvb2dsZS5jb20pXG4gKiBAcGFyYW0ge29iamVjdH0gW3BhcmFtc10gVGhlIHBhcmFtcyB0byBiZSBhcHBlbmRlZFxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGZvcm1hdHRlZCB1cmxcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBidWlsZFVSTCh1cmwsIHBhcmFtcywgcGFyYW1zU2VyaWFsaXplcikge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgaWYgKCFwYXJhbXMpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG5cbiAgdmFyIHNlcmlhbGl6ZWRQYXJhbXM7XG4gIGlmIChwYXJhbXNTZXJpYWxpemVyKSB7XG4gICAgc2VyaWFsaXplZFBhcmFtcyA9IHBhcmFtc1NlcmlhbGl6ZXIocGFyYW1zKTtcbiAgfSBlbHNlIGlmICh1dGlscy5pc1VSTFNlYXJjaFBhcmFtcyhwYXJhbXMpKSB7XG4gICAgc2VyaWFsaXplZFBhcmFtcyA9IHBhcmFtcy50b1N0cmluZygpO1xuICB9IGVsc2Uge1xuICAgIHZhciBwYXJ0cyA9IFtdO1xuXG4gICAgdXRpbHMuZm9yRWFjaChwYXJhbXMsIGZ1bmN0aW9uIHNlcmlhbGl6ZSh2YWwsIGtleSkge1xuICAgICAgaWYgKHZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh1dGlscy5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAga2V5ID0ga2V5ICsgJ1tdJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbCA9IFt2YWxdO1xuICAgICAgfVxuXG4gICAgICB1dGlscy5mb3JFYWNoKHZhbCwgZnVuY3Rpb24gcGFyc2VWYWx1ZSh2KSB7XG4gICAgICAgIGlmICh1dGlscy5pc0RhdGUodikpIHtcbiAgICAgICAgICB2ID0gdi50b0lTT1N0cmluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWxzLmlzT2JqZWN0KHYpKSB7XG4gICAgICAgICAgdiA9IEpTT04uc3RyaW5naWZ5KHYpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnRzLnB1c2goZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUodikpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFydHMuam9pbignJicpO1xuICB9XG5cbiAgaWYgKHNlcmlhbGl6ZWRQYXJhbXMpIHtcbiAgICB2YXIgaGFzaG1hcmtJbmRleCA9IHVybC5pbmRleE9mKCcjJyk7XG4gICAgaWYgKGhhc2htYXJrSW5kZXggIT09IC0xKSB7XG4gICAgICB1cmwgPSB1cmwuc2xpY2UoMCwgaGFzaG1hcmtJbmRleCk7XG4gICAgfVxuXG4gICAgdXJsICs9ICh1cmwuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJykgKyBzZXJpYWxpemVkUGFyYW1zO1xuICB9XG5cbiAgcmV0dXJuIHVybDtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/buildURL.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/combineURLs.js":
/*!*******************************************************!*\
  !*** ./node_modules/axios/lib/helpers/combineURLs.js ***!
  \*******************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n * @returns {string} The combined URL\n */\nmodule.exports = function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvY29tYmluZVVSTHMuanM/ZTY4MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvY29tYmluZVVSTHMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBVUkwgYnkgY29tYmluaW5nIHRoZSBzcGVjaWZpZWQgVVJMc1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBiYXNlVVJMIFRoZSBiYXNlIFVSTFxuICogQHBhcmFtIHtzdHJpbmd9IHJlbGF0aXZlVVJMIFRoZSByZWxhdGl2ZSBVUkxcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBjb21iaW5lZCBVUkxcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjb21iaW5lVVJMcyhiYXNlVVJMLCByZWxhdGl2ZVVSTCkge1xuICByZXR1cm4gcmVsYXRpdmVVUkxcbiAgICA/IGJhc2VVUkwucmVwbGFjZSgvXFwvKyQvLCAnJykgKyAnLycgKyByZWxhdGl2ZVVSTC5yZXBsYWNlKC9eXFwvKy8sICcnKVxuICAgIDogYmFzZVVSTDtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/combineURLs.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/cookies.js":
/*!***************************************************!*\
  !*** ./node_modules/axios/lib/helpers/cookies.js ***!
  \***************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs support document.cookie\n    (function standardBrowserEnv() {\n      return {\n        write: function write(name, value, expires, path, domain, secure) {\n          var cookie = [];\n          cookie.push(name + '=' + encodeURIComponent(value));\n\n          if (utils.isNumber(expires)) {\n            cookie.push('expires=' + new Date(expires).toGMTString());\n          }\n\n          if (utils.isString(path)) {\n            cookie.push('path=' + path);\n          }\n\n          if (utils.isString(domain)) {\n            cookie.push('domain=' + domain);\n          }\n\n          if (secure === true) {\n            cookie.push('secure');\n          }\n\n          document.cookie = cookie.join('; ');\n        },\n\n        read: function read(name) {\n          var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n          return (match ? decodeURIComponent(match[3]) : null);\n        },\n\n        remove: function remove(name) {\n          this.write(name, '', Date.now() - 86400000);\n        }\n      };\n    })() :\n\n  // Non standard browser env (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return {\n        write: function write() {},\n        read: function read() { return null; },\n        remove: function remove() {}\n      };\n    })()\n);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvY29va2llcy5qcz83YWFjIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLFlBQVksbUJBQU8sQ0FBQyxxREFBWTs7QUFFaEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDBDQUEwQztBQUMxQyxTQUFTOztBQUVUO0FBQ0EsNERBQTRELHdCQUF3QjtBQUNwRjtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQywrQkFBK0IsYUFBYSxFQUFFO0FBQzlDO0FBQ0E7QUFDQSxLQUFLO0FBQ0wiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvY29va2llcy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgdXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSA/XG5cbiAgLy8gU3RhbmRhcmQgYnJvd3NlciBlbnZzIHN1cHBvcnQgZG9jdW1lbnQuY29va2llXG4gICAgKGZ1bmN0aW9uIHN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShuYW1lLCB2YWx1ZSwgZXhwaXJlcywgcGF0aCwgZG9tYWluLCBzZWN1cmUpIHtcbiAgICAgICAgICB2YXIgY29va2llID0gW107XG4gICAgICAgICAgY29va2llLnB1c2gobmFtZSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuXG4gICAgICAgICAgaWYgKHV0aWxzLmlzTnVtYmVyKGV4cGlyZXMpKSB7XG4gICAgICAgICAgICBjb29raWUucHVzaCgnZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJlcykudG9HTVRTdHJpbmcoKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKHBhdGgpKSB7XG4gICAgICAgICAgICBjb29raWUucHVzaCgncGF0aD0nICsgcGF0aCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKGRvbWFpbikpIHtcbiAgICAgICAgICAgIGNvb2tpZS5wdXNoKCdkb21haW49JyArIGRvbWFpbik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHNlY3VyZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgY29va2llLnB1c2goJ3NlY3VyZScpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZS5qb2luKCc7ICcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQobmFtZSkge1xuICAgICAgICAgIHZhciBtYXRjaCA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaChuZXcgUmVnRXhwKCcoXnw7XFxcXHMqKSgnICsgbmFtZSArICcpPShbXjtdKiknKSk7XG4gICAgICAgICAgcmV0dXJuIChtYXRjaCA/IGRlY29kZVVSSUNvbXBvbmVudChtYXRjaFszXSkgOiBudWxsKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShuYW1lKSB7XG4gICAgICAgICAgdGhpcy53cml0ZShuYW1lLCAnJywgRGF0ZS5ub3coKSAtIDg2NDAwMDAwKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KSgpIDpcblxuICAvLyBOb24gc3RhbmRhcmQgYnJvd3NlciBlbnYgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gICAgKGZ1bmN0aW9uIG5vblN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZSgpIHt9LFxuICAgICAgICByZWFkOiBmdW5jdGlvbiByZWFkKCkgeyByZXR1cm4gbnVsbDsgfSxcbiAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7fVxuICAgICAgfTtcbiAgICB9KSgpXG4pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/cookies.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/isAbsoluteURL.js":
/*!*********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/isAbsoluteURL.js ***!
  \*********************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nmodule.exports = function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTC5qcz9kOTI1Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGVcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBVUkwgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQWJzb2x1dGVVUkwodXJsKSB7XG4gIC8vIEEgVVJMIGlzIGNvbnNpZGVyZWQgYWJzb2x1dGUgaWYgaXQgYmVnaW5zIHdpdGggXCI8c2NoZW1lPjovL1wiIG9yIFwiLy9cIiAocHJvdG9jb2wtcmVsYXRpdmUgVVJMKS5cbiAgLy8gUkZDIDM5ODYgZGVmaW5lcyBzY2hlbWUgbmFtZSBhcyBhIHNlcXVlbmNlIG9mIGNoYXJhY3RlcnMgYmVnaW5uaW5nIHdpdGggYSBsZXR0ZXIgYW5kIGZvbGxvd2VkXG4gIC8vIGJ5IGFueSBjb21iaW5hdGlvbiBvZiBsZXR0ZXJzLCBkaWdpdHMsIHBsdXMsIHBlcmlvZCwgb3IgaHlwaGVuLlxuICByZXR1cm4gL14oW2Etel1bYS16XFxkXFwrXFwtXFwuXSo6KT9cXC9cXC8vaS50ZXN0KHVybCk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/isAbsoluteURL.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/isAxiosError.js":
/*!********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/isAxiosError.js ***!
  \********************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nmodule.exports = function isAxiosError(payload) {\n  return (typeof payload === 'object') && (payload.isAxiosError === true);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNBeGlvc0Vycm9yLmpzPzVmMDIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0EsV0FBVyxFQUFFO0FBQ2IsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2lzQXhpb3NFcnJvci5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHBheWxvYWQgaXMgYW4gZXJyb3IgdGhyb3duIGJ5IEF4aW9zXG4gKlxuICogQHBhcmFtIHsqfSBwYXlsb2FkIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgcGF5bG9hZCBpcyBhbiBlcnJvciB0aHJvd24gYnkgQXhpb3MsIG90aGVyd2lzZSBmYWxzZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQXhpb3NFcnJvcihwYXlsb2FkKSB7XG4gIHJldHVybiAodHlwZW9mIHBheWxvYWQgPT09ICdvYmplY3QnKSAmJiAocGF5bG9hZC5pc0F4aW9zRXJyb3IgPT09IHRydWUpO1xufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/isAxiosError.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/isURLSameOrigin.js":
/*!***********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/isURLSameOrigin.js ***!
  \***********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\nmodule.exports = (\n  utils.isStandardBrowserEnv() ?\n\n  // Standard browser envs have full support of the APIs needed to test\n  // whether the request URL is of the same origin as current location.\n    (function standardBrowserEnv() {\n      var msie = /(msie|trident)/i.test(navigator.userAgent);\n      var urlParsingNode = document.createElement('a');\n      var originURL;\n\n      /**\n    * Parse a URL to discover it's components\n    *\n    * @param {String} url The URL to be parsed\n    * @returns {Object}\n    */\n      function resolveURL(url) {\n        var href = url;\n\n        if (msie) {\n        // IE needs attribute set twice to normalize properties\n          urlParsingNode.setAttribute('href', href);\n          href = urlParsingNode.href;\n        }\n\n        urlParsingNode.setAttribute('href', href);\n\n        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n        return {\n          href: urlParsingNode.href,\n          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n          host: urlParsingNode.host,\n          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n          hostname: urlParsingNode.hostname,\n          port: urlParsingNode.port,\n          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n            urlParsingNode.pathname :\n            '/' + urlParsingNode.pathname\n        };\n      }\n\n      originURL = resolveURL(window.location.href);\n\n      /**\n    * Determine if a URL shares the same origin as the current location\n    *\n    * @param {String} requestURL The URL to test\n    * @returns {boolean} True if URL shares the same origin, otherwise false\n    */\n      return function isURLSameOrigin(requestURL) {\n        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n        return (parsed.protocol === originURL.protocol &&\n            parsed.host === originURL.host);\n      };\n    })() :\n\n  // Non standard browser envs (web workers, react-native) lack needed support.\n    (function nonStandardBrowserEnv() {\n      return function isURLSameOrigin() {\n        return true;\n      };\n    })()\n);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luLmpzPzM5MzQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLHFEQUFZOztBQUVoQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckIsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9pc1VSTFNhbWVPcmlnaW4uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoXG4gIHV0aWxzLmlzU3RhbmRhcmRCcm93c2VyRW52KCkgP1xuXG4gIC8vIFN0YW5kYXJkIGJyb3dzZXIgZW52cyBoYXZlIGZ1bGwgc3VwcG9ydCBvZiB0aGUgQVBJcyBuZWVkZWQgdG8gdGVzdFxuICAvLyB3aGV0aGVyIHRoZSByZXF1ZXN0IFVSTCBpcyBvZiB0aGUgc2FtZSBvcmlnaW4gYXMgY3VycmVudCBsb2NhdGlvbi5cbiAgICAoZnVuY3Rpb24gc3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgICAgdmFyIG1zaWUgPSAvKG1zaWV8dHJpZGVudCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgICAgdmFyIHVybFBhcnNpbmdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgdmFyIG9yaWdpblVSTDtcblxuICAgICAgLyoqXG4gICAgKiBQYXJzZSBhIFVSTCB0byBkaXNjb3ZlciBpdCdzIGNvbXBvbmVudHNcbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSBVUkwgdG8gYmUgcGFyc2VkXG4gICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICovXG4gICAgICBmdW5jdGlvbiByZXNvbHZlVVJMKHVybCkge1xuICAgICAgICB2YXIgaHJlZiA9IHVybDtcblxuICAgICAgICBpZiAobXNpZSkge1xuICAgICAgICAvLyBJRSBuZWVkcyBhdHRyaWJ1dGUgc2V0IHR3aWNlIHRvIG5vcm1hbGl6ZSBwcm9wZXJ0aWVzXG4gICAgICAgICAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgaHJlZik7XG4gICAgICAgICAgaHJlZiA9IHVybFBhcnNpbmdOb2RlLmhyZWY7XG4gICAgICAgIH1cblxuICAgICAgICB1cmxQYXJzaW5nTm9kZS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcblxuICAgICAgICAvLyB1cmxQYXJzaW5nTm9kZSBwcm92aWRlcyB0aGUgVXJsVXRpbHMgaW50ZXJmYWNlIC0gaHR0cDovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybHV0aWxzXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaHJlZjogdXJsUGFyc2luZ05vZGUuaHJlZixcbiAgICAgICAgICBwcm90b2NvbDogdXJsUGFyc2luZ05vZGUucHJvdG9jb2wgPyB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbC5yZXBsYWNlKC86JC8sICcnKSA6ICcnLFxuICAgICAgICAgIGhvc3Q6IHVybFBhcnNpbmdOb2RlLmhvc3QsXG4gICAgICAgICAgc2VhcmNoOiB1cmxQYXJzaW5nTm9kZS5zZWFyY2ggPyB1cmxQYXJzaW5nTm9kZS5zZWFyY2gucmVwbGFjZSgvXlxcPy8sICcnKSA6ICcnLFxuICAgICAgICAgIGhhc2g6IHVybFBhcnNpbmdOb2RlLmhhc2ggPyB1cmxQYXJzaW5nTm9kZS5oYXNoLnJlcGxhY2UoL14jLywgJycpIDogJycsXG4gICAgICAgICAgaG9zdG5hbWU6IHVybFBhcnNpbmdOb2RlLmhvc3RuYW1lLFxuICAgICAgICAgIHBvcnQ6IHVybFBhcnNpbmdOb2RlLnBvcnQsXG4gICAgICAgICAgcGF0aG5hbWU6ICh1cmxQYXJzaW5nTm9kZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJykgP1xuICAgICAgICAgICAgdXJsUGFyc2luZ05vZGUucGF0aG5hbWUgOlxuICAgICAgICAgICAgJy8nICsgdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgb3JpZ2luVVJMID0gcmVzb2x2ZVVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgICAgIC8qKlxuICAgICogRGV0ZXJtaW5lIGlmIGEgVVJMIHNoYXJlcyB0aGUgc2FtZSBvcmlnaW4gYXMgdGhlIGN1cnJlbnQgbG9jYXRpb25cbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gcmVxdWVzdFVSTCBUaGUgVVJMIHRvIHRlc3RcbiAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIFVSTCBzaGFyZXMgdGhlIHNhbWUgb3JpZ2luLCBvdGhlcndpc2UgZmFsc2VcbiAgICAqL1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGlzVVJMU2FtZU9yaWdpbihyZXF1ZXN0VVJMKSB7XG4gICAgICAgIHZhciBwYXJzZWQgPSAodXRpbHMuaXNTdHJpbmcocmVxdWVzdFVSTCkpID8gcmVzb2x2ZVVSTChyZXF1ZXN0VVJMKSA6IHJlcXVlc3RVUkw7XG4gICAgICAgIHJldHVybiAocGFyc2VkLnByb3RvY29sID09PSBvcmlnaW5VUkwucHJvdG9jb2wgJiZcbiAgICAgICAgICAgIHBhcnNlZC5ob3N0ID09PSBvcmlnaW5VUkwuaG9zdCk7XG4gICAgICB9O1xuICAgIH0pKCkgOlxuXG4gIC8vIE5vbiBzdGFuZGFyZCBicm93c2VyIGVudnMgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gICAgKGZ1bmN0aW9uIG5vblN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiBpc1VSTFNhbWVPcmlnaW4oKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfTtcbiAgICB9KSgpXG4pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/isURLSameOrigin.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/normalizeHeaderName.js":
/*!***************************************************************!*\
  !*** ./node_modules/axios/lib/helpers/normalizeHeaderName.js ***!
  \***************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ../utils */ \"./node_modules/axios/lib/utils.js\");\n\nmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n  utils.forEach(headers, function processHeader(value, name) {\n    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n      headers[normalizedName] = value;\n      delete headers[name];\n    }\n  });\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvbm9ybWFsaXplSGVhZGVyTmFtZS5qcz9jOGFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFhOztBQUViLFlBQVksbUJBQU8sQ0FBQyxtREFBVTs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbm9ybWFsaXplSGVhZGVyTmFtZShoZWFkZXJzLCBub3JtYWxpemVkTmFtZSkge1xuICB1dGlscy5mb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIHByb2Nlc3NIZWFkZXIodmFsdWUsIG5hbWUpIHtcbiAgICBpZiAobmFtZSAhPT0gbm9ybWFsaXplZE5hbWUgJiYgbmFtZS50b1VwcGVyQ2FzZSgpID09PSBub3JtYWxpemVkTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICBoZWFkZXJzW25vcm1hbGl6ZWROYW1lXSA9IHZhbHVlO1xuICAgICAgZGVsZXRlIGhlYWRlcnNbbmFtZV07XG4gICAgfVxuICB9KTtcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/normalizeHeaderName.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/parseHeaders.js":
/*!********************************************************!*\
  !*** ./node_modules/axios/lib/helpers/parseHeaders.js ***!
  \********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar utils = __webpack_require__(/*! ./../utils */ \"./node_modules/axios/lib/utils.js\");\n\n// Headers whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nvar ignoreDuplicateOf = [\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n];\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} headers Headers needing to be parsed\n * @returns {Object} Headers parsed into an object\n */\nmodule.exports = function parseHeaders(headers) {\n  var parsed = {};\n  var key;\n  var val;\n  var i;\n\n  if (!headers) { return parsed; }\n\n  utils.forEach(headers.split('\\n'), function parser(line) {\n    i = line.indexOf(':');\n    key = utils.trim(line.substr(0, i)).toLowerCase();\n    val = utils.trim(line.substr(i + 1));\n\n    if (key) {\n      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n        return;\n      }\n      if (key === 'set-cookie') {\n        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n      } else {\n        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n      }\n    }\n  });\n\n  return parsed;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvcGFyc2VIZWFkZXJzLmpzP2MzNDUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsWUFBWSxtQkFBTyxDQUFDLHFEQUFZOztBQUVoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCLGVBQWU7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvcGFyc2VIZWFkZXJzLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbi8vIEhlYWRlcnMgd2hvc2UgZHVwbGljYXRlcyBhcmUgaWdub3JlZCBieSBub2RlXG4vLyBjLmYuIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfbWVzc2FnZV9oZWFkZXJzXG52YXIgaWdub3JlRHVwbGljYXRlT2YgPSBbXG4gICdhZ2UnLCAnYXV0aG9yaXphdGlvbicsICdjb250ZW50LWxlbmd0aCcsICdjb250ZW50LXR5cGUnLCAnZXRhZycsXG4gICdleHBpcmVzJywgJ2Zyb20nLCAnaG9zdCcsICdpZi1tb2RpZmllZC1zaW5jZScsICdpZi11bm1vZGlmaWVkLXNpbmNlJyxcbiAgJ2xhc3QtbW9kaWZpZWQnLCAnbG9jYXRpb24nLCAnbWF4LWZvcndhcmRzJywgJ3Byb3h5LWF1dGhvcml6YXRpb24nLFxuICAncmVmZXJlcicsICdyZXRyeS1hZnRlcicsICd1c2VyLWFnZW50J1xuXTtcblxuLyoqXG4gKiBQYXJzZSBoZWFkZXJzIGludG8gYW4gb2JqZWN0XG4gKlxuICogYGBgXG4gKiBEYXRlOiBXZWQsIDI3IEF1ZyAyMDE0IDA4OjU4OjQ5IEdNVFxuICogQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uXG4gKiBDb25uZWN0aW9uOiBrZWVwLWFsaXZlXG4gKiBUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZFxuICogYGBgXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGhlYWRlcnMgSGVhZGVycyBuZWVkaW5nIHRvIGJlIHBhcnNlZFxuICogQHJldHVybnMge09iamVjdH0gSGVhZGVycyBwYXJzZWQgaW50byBhbiBvYmplY3RcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYXJzZUhlYWRlcnMoaGVhZGVycykge1xuICB2YXIgcGFyc2VkID0ge307XG4gIHZhciBrZXk7XG4gIHZhciB2YWw7XG4gIHZhciBpO1xuXG4gIGlmICghaGVhZGVycykgeyByZXR1cm4gcGFyc2VkOyB9XG5cbiAgdXRpbHMuZm9yRWFjaChoZWFkZXJzLnNwbGl0KCdcXG4nKSwgZnVuY3Rpb24gcGFyc2VyKGxpbmUpIHtcbiAgICBpID0gbGluZS5pbmRleE9mKCc6Jyk7XG4gICAga2V5ID0gdXRpbHMudHJpbShsaW5lLnN1YnN0cigwLCBpKSkudG9Mb3dlckNhc2UoKTtcbiAgICB2YWwgPSB1dGlscy50cmltKGxpbmUuc3Vic3RyKGkgKyAxKSk7XG5cbiAgICBpZiAoa2V5KSB7XG4gICAgICBpZiAocGFyc2VkW2tleV0gJiYgaWdub3JlRHVwbGljYXRlT2YuaW5kZXhPZihrZXkpID49IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGtleSA9PT0gJ3NldC1jb29raWUnKSB7XG4gICAgICAgIHBhcnNlZFtrZXldID0gKHBhcnNlZFtrZXldID8gcGFyc2VkW2tleV0gOiBbXSkuY29uY2F0KFt2YWxdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBhcnNlZFtrZXldID0gcGFyc2VkW2tleV0gPyBwYXJzZWRba2V5XSArICcsICcgKyB2YWwgOiB2YWw7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcGFyc2VkO1xufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/parseHeaders.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/helpers/spread.js":
/*!**************************************************!*\
  !*** ./node_modules/axios/lib/helpers/spread.js ***!
  \**************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n * @returns {Function}\n */\nmodule.exports = function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvc3ByZWFkLmpzPzBkZjYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvc3ByZWFkLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIFN5bnRhY3RpYyBzdWdhciBmb3IgaW52b2tpbmcgYSBmdW5jdGlvbiBhbmQgZXhwYW5kaW5nIGFuIGFycmF5IGZvciBhcmd1bWVudHMuXG4gKlxuICogQ29tbW9uIHVzZSBjYXNlIHdvdWxkIGJlIHRvIHVzZSBgRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5YC5cbiAqXG4gKiAgYGBganNcbiAqICBmdW5jdGlvbiBmKHgsIHksIHopIHt9XG4gKiAgdmFyIGFyZ3MgPSBbMSwgMiwgM107XG4gKiAgZi5hcHBseShudWxsLCBhcmdzKTtcbiAqICBgYGBcbiAqXG4gKiBXaXRoIGBzcHJlYWRgIHRoaXMgZXhhbXBsZSBjYW4gYmUgcmUtd3JpdHRlbi5cbiAqXG4gKiAgYGBganNcbiAqICBzcHJlYWQoZnVuY3Rpb24oeCwgeSwgeikge30pKFsxLCAyLCAzXSk7XG4gKiAgYGBgXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAqIEByZXR1cm5zIHtGdW5jdGlvbn1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzcHJlYWQoY2FsbGJhY2spIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHdyYXAoYXJyKSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrLmFwcGx5KG51bGwsIGFycik7XG4gIH07XG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/helpers/spread.js\n");

/***/ }),

/***/ "./node_modules/axios/lib/utils.js":
/*!*****************************************!*\
  !*** ./node_modules/axios/lib/utils.js ***!
  \*****************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("\n\nvar bind = __webpack_require__(/*! ./helpers/bind */ \"./node_modules/axios/lib/helpers/bind.js\");\n\n/*global toString:true*/\n\n// utils is a library of generic helper functions non-specific to axios\n\nvar toString = Object.prototype.toString;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Array, otherwise false\n */\nfunction isArray(val) {\n  return toString.call(val) === '[object Array]';\n}\n\n/**\n * Determine if a value is undefined\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nfunction isUndefined(val) {\n  return typeof val === 'undefined';\n}\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && typeof val.constructor.isBuffer === 'function' && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nfunction isArrayBuffer(val) {\n  return toString.call(val) === '[object ArrayBuffer]';\n}\n\n/**\n * Determine if a value is a FormData\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nfunction isFormData(val) {\n  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n}\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  var result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a String, otherwise false\n */\nfunction isString(val) {\n  return typeof val === 'string';\n}\n\n/**\n * Determine if a value is a Number\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Number, otherwise false\n */\nfunction isNumber(val) {\n  return typeof val === 'number';\n}\n\n/**\n * Determine if a value is an Object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is an Object, otherwise false\n */\nfunction isObject(val) {\n  return val !== null && typeof val === 'object';\n}\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {Object} val The value to test\n * @return {boolean} True if value is a plain Object, otherwise false\n */\nfunction isPlainObject(val) {\n  if (toString.call(val) !== '[object Object]') {\n    return false;\n  }\n\n  var prototype = Object.getPrototypeOf(val);\n  return prototype === null || prototype === Object.prototype;\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Date, otherwise false\n */\nfunction isDate(val) {\n  return toString.call(val) === '[object Date]';\n}\n\n/**\n * Determine if a value is a File\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a File, otherwise false\n */\nfunction isFile(val) {\n  return toString.call(val) === '[object File]';\n}\n\n/**\n * Determine if a value is a Blob\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nfunction isBlob(val) {\n  return toString.call(val) === '[object Blob]';\n}\n\n/**\n * Determine if a value is a Function\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nfunction isFunction(val) {\n  return toString.call(val) === '[object Function]';\n}\n\n/**\n * Determine if a value is a Stream\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nfunction isStream(val) {\n  return isObject(val) && isFunction(val.pipe);\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {Object} val The value to test\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nfunction isURLSearchParams(val) {\n  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n}\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n * @returns {String} The String freed of excess whitespace\n */\nfunction trim(str) {\n  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n}\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n */\nfunction isStandardBrowserEnv() {\n  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||\n                                           navigator.product === 'NativeScript' ||\n                                           navigator.product === 'NS')) {\n    return false;\n  }\n  return (\n    typeof window !== 'undefined' &&\n    typeof document !== 'undefined'\n  );\n}\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n */\nfunction forEach(obj, fn) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (var i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        fn.call(null, obj[key], key, obj);\n      }\n    }\n  }\n}\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  var result = {};\n  function assignValue(val, key) {\n    if (isPlainObject(result[key]) && isPlainObject(val)) {\n      result[key] = merge(result[key], val);\n    } else if (isPlainObject(val)) {\n      result[key] = merge({}, val);\n    } else if (isArray(val)) {\n      result[key] = val.slice();\n    } else {\n      result[key] = val;\n    }\n  }\n\n  for (var i = 0, l = arguments.length; i < l; i++) {\n    forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n * @return {Object} The resulting value of object a\n */\nfunction extend(a, b, thisArg) {\n  forEach(b, function assignValue(val, key) {\n    if (thisArg && typeof val === 'function') {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  });\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n * @return {string} content value without BOM\n */\nfunction stripBOM(content) {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\nmodule.exports = {\n  isArray: isArray,\n  isArrayBuffer: isArrayBuffer,\n  isBuffer: isBuffer,\n  isFormData: isFormData,\n  isArrayBufferView: isArrayBufferView,\n  isString: isString,\n  isNumber: isNumber,\n  isObject: isObject,\n  isPlainObject: isPlainObject,\n  isUndefined: isUndefined,\n  isDate: isDate,\n  isFile: isFile,\n  isBlob: isBlob,\n  isFunction: isFunction,\n  isStream: isStream,\n  isURLSearchParams: isURLSearchParams,\n  isStandardBrowserEnv: isStandardBrowserEnv,\n  forEach: forEach,\n  merge: merge,\n  extend: extend,\n  trim: trim,\n  stripBOM: stripBOM\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvYXhpb3MvbGliL3V0aWxzLmpzP2M1MzIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsV0FBVyxtQkFBTyxDQUFDLGdFQUFnQjs7QUFFbkM7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixZQUFZLFFBQVE7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLFFBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWEsT0FBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsYUFBYTtBQUN4QixXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1DQUFtQyxPQUFPO0FBQzFDO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixTQUFTLEdBQUcsU0FBUztBQUM1QywyQkFBMkI7QUFDM0I7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhLE9BQU87QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLDRCQUE0QjtBQUM1QixLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBLHVDQUF1QyxPQUFPO0FBQzlDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLFlBQVksT0FBTztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsWUFBWSxPQUFPO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9heGlvcy9saWIvdXRpbHMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcblxuLypnbG9iYWwgdG9TdHJpbmc6dHJ1ZSovXG5cbi8vIHV0aWxzIGlzIGEgbGlicmFyeSBvZiBnZW5lcmljIGhlbHBlciBmdW5jdGlvbnMgbm9uLXNwZWNpZmljIHRvIGF4aW9zXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gQXJyYXlcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBBcnJheSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXkodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgdW5kZWZpbmVkXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHZhbHVlIGlzIHVuZGVmaW5lZCwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ3VuZGVmaW5lZCc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBCdWZmZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEJ1ZmZlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQnVmZmVyKHZhbCkge1xuICByZXR1cm4gdmFsICE9PSBudWxsICYmICFpc1VuZGVmaW5lZCh2YWwpICYmIHZhbC5jb25zdHJ1Y3RvciAhPT0gbnVsbCAmJiAhaXNVbmRlZmluZWQodmFsLmNvbnN0cnVjdG9yKVxuICAgICYmIHR5cGVvZiB2YWwuY29uc3RydWN0b3IuaXNCdWZmZXIgPT09ICdmdW5jdGlvbicgJiYgdmFsLmNvbnN0cnVjdG9yLmlzQnVmZmVyKHZhbCk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gQXJyYXlCdWZmZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBBcnJheUJ1ZmZlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEFycmF5QnVmZmVyXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBGb3JtRGF0YVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEZvcm1EYXRhLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGb3JtRGF0YSh2YWwpIHtcbiAgcmV0dXJuICh0eXBlb2YgRm9ybURhdGEgIT09ICd1bmRlZmluZWQnKSAmJiAodmFsIGluc3RhbmNlb2YgRm9ybURhdGEpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgdmlldyBvbiBhbiBBcnJheUJ1ZmZlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgdmlldyBvbiBhbiBBcnJheUJ1ZmZlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXJWaWV3KHZhbCkge1xuICB2YXIgcmVzdWx0O1xuICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcpICYmIChBcnJheUJ1ZmZlci5pc1ZpZXcpKSB7XG4gICAgcmVzdWx0ID0gQXJyYXlCdWZmZXIuaXNWaWV3KHZhbCk7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gKHZhbCkgJiYgKHZhbC5idWZmZXIpICYmICh2YWwuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBTdHJpbmdcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFN0cmluZywgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZyc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBOdW1iZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIE51bWJlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcic7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gT2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gT2JqZWN0LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNPYmplY3QodmFsKSB7XG4gIHJldHVybiB2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBwbGFpbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgcGxhaW4gT2JqZWN0LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWwpIHtcbiAgaWYgKHRvU3RyaW5nLmNhbGwodmFsKSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB2YXIgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHZhbCk7XG4gIHJldHVybiBwcm90b3R5cGUgPT09IG51bGwgfHwgcHJvdG90eXBlID09PSBPYmplY3QucHJvdG90eXBlO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRGF0ZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgRGF0ZSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRGF0ZSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRGF0ZV0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRmlsZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgRmlsZSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRmlsZSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRmlsZV0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgQmxvYlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgQmxvYiwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQmxvYih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQmxvYl0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRnVuY3Rpb25cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEZ1bmN0aW9uLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFN0cmVhbVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgU3RyZWFtLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTdHJlYW0odmFsKSB7XG4gIHJldHVybiBpc09iamVjdCh2YWwpICYmIGlzRnVuY3Rpb24odmFsLnBpcGUpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgVVJMU2VhcmNoUGFyYW1zIG9iamVjdFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgVVJMU2VhcmNoUGFyYW1zIG9iamVjdCwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzVVJMU2VhcmNoUGFyYW1zKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIFVSTFNlYXJjaFBhcmFtcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsIGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zO1xufVxuXG4vKipcbiAqIFRyaW0gZXhjZXNzIHdoaXRlc3BhY2Ugb2ZmIHRoZSBiZWdpbm5pbmcgYW5kIGVuZCBvZiBhIHN0cmluZ1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIFN0cmluZyB0byB0cmltXG4gKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgU3RyaW5nIGZyZWVkIG9mIGV4Y2VzcyB3aGl0ZXNwYWNlXG4gKi9cbmZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyovLCAnJykucmVwbGFjZSgvXFxzKiQvLCAnJyk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBzdGFuZGFyZCBicm93c2VyIGVudmlyb25tZW50XG4gKlxuICogVGhpcyBhbGxvd3MgYXhpb3MgdG8gcnVuIGluIGEgd2ViIHdvcmtlciwgYW5kIHJlYWN0LW5hdGl2ZS5cbiAqIEJvdGggZW52aXJvbm1lbnRzIHN1cHBvcnQgWE1MSHR0cFJlcXVlc3QsIGJ1dCBub3QgZnVsbHkgc3RhbmRhcmQgZ2xvYmFscy5cbiAqXG4gKiB3ZWIgd29ya2VyczpcbiAqICB0eXBlb2Ygd2luZG93IC0+IHVuZGVmaW5lZFxuICogIHR5cGVvZiBkb2N1bWVudCAtPiB1bmRlZmluZWRcbiAqXG4gKiByZWFjdC1uYXRpdmU6XG4gKiAgbmF2aWdhdG9yLnByb2R1Y3QgLT4gJ1JlYWN0TmF0aXZlJ1xuICogbmF0aXZlc2NyaXB0XG4gKiAgbmF2aWdhdG9yLnByb2R1Y3QgLT4gJ05hdGl2ZVNjcmlwdCcgb3IgJ05TJ1xuICovXG5mdW5jdGlvbiBpc1N0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIChuYXZpZ2F0b3IucHJvZHVjdCA9PT0gJ1JlYWN0TmF0aXZlJyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5wcm9kdWN0ID09PSAnTmF0aXZlU2NyaXB0JyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5wcm9kdWN0ID09PSAnTlMnKSkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gKFxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJ1xuICApO1xufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBBcnJheSBvciBhbiBPYmplY3QgaW52b2tpbmcgYSBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmIGBvYmpgIGlzIGFuIEFycmF5IGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIHBhc3NpbmdcbiAqIHRoZSB2YWx1ZSwgaW5kZXgsIGFuZCBjb21wbGV0ZSBhcnJheSBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmICdvYmonIGlzIGFuIE9iamVjdCBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBwYXNzaW5nXG4gKiB0aGUgdmFsdWUsIGtleSwgYW5kIGNvbXBsZXRlIG9iamVjdCBmb3IgZWFjaCBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdHxBcnJheX0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGNhbGxiYWNrIHRvIGludm9rZSBmb3IgZWFjaCBpdGVtXG4gKi9cbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmbikge1xuICAvLyBEb24ndCBib3RoZXIgaWYgbm8gdmFsdWUgcHJvdmlkZWRcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEZvcmNlIGFuIGFycmF5IGlmIG5vdCBhbHJlYWR5IHNvbWV0aGluZyBpdGVyYWJsZVxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcpIHtcbiAgICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgICBvYmogPSBbb2JqXTtcbiAgfVxuXG4gIGlmIChpc0FycmF5KG9iaikpIHtcbiAgICAvLyBJdGVyYXRlIG92ZXIgYXJyYXkgdmFsdWVzXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBmbi5jYWxsKG51bGwsIG9ialtpXSwgaSwgb2JqKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gSXRlcmF0ZSBvdmVyIG9iamVjdCBrZXlzXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgZm4uY2FsbChudWxsLCBvYmpba2V5XSwga2V5LCBvYmopO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEFjY2VwdHMgdmFyYXJncyBleHBlY3RpbmcgZWFjaCBhcmd1bWVudCB0byBiZSBhbiBvYmplY3QsIHRoZW5cbiAqIGltbXV0YWJseSBtZXJnZXMgdGhlIHByb3BlcnRpZXMgb2YgZWFjaCBvYmplY3QgYW5kIHJldHVybnMgcmVzdWx0LlxuICpcbiAqIFdoZW4gbXVsdGlwbGUgb2JqZWN0cyBjb250YWluIHRoZSBzYW1lIGtleSB0aGUgbGF0ZXIgb2JqZWN0IGluXG4gKiB0aGUgYXJndW1lbnRzIGxpc3Qgd2lsbCB0YWtlIHByZWNlZGVuY2UuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBqc1xuICogdmFyIHJlc3VsdCA9IG1lcmdlKHtmb286IDEyM30sIHtmb286IDQ1Nn0pO1xuICogY29uc29sZS5sb2cocmVzdWx0LmZvbyk7IC8vIG91dHB1dHMgNDU2XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqMSBPYmplY3QgdG8gbWVyZ2VcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJlc3VsdCBvZiBhbGwgbWVyZ2UgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiBtZXJnZSgvKiBvYmoxLCBvYmoyLCBvYmozLCAuLi4gKi8pIHtcbiAgdmFyIHJlc3VsdCA9IHt9O1xuICBmdW5jdGlvbiBhc3NpZ25WYWx1ZSh2YWwsIGtleSkge1xuICAgIGlmIChpc1BsYWluT2JqZWN0KHJlc3VsdFtrZXldKSAmJiBpc1BsYWluT2JqZWN0KHZhbCkpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gbWVyZ2UocmVzdWx0W2tleV0sIHZhbCk7XG4gICAgfSBlbHNlIGlmIChpc1BsYWluT2JqZWN0KHZhbCkpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gbWVyZ2Uoe30sIHZhbCk7XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHZhbCkpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsLnNsaWNlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsO1xuICAgIH1cbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwLCBsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgIGZvckVhY2goYXJndW1lbnRzW2ldLCBhc3NpZ25WYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBFeHRlbmRzIG9iamVjdCBhIGJ5IG11dGFibHkgYWRkaW5nIHRvIGl0IHRoZSBwcm9wZXJ0aWVzIG9mIG9iamVjdCBiLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBhIFRoZSBvYmplY3QgdG8gYmUgZXh0ZW5kZWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBiIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7T2JqZWN0fSB0aGlzQXJnIFRoZSBvYmplY3QgdG8gYmluZCBmdW5jdGlvbiB0b1xuICogQHJldHVybiB7T2JqZWN0fSBUaGUgcmVzdWx0aW5nIHZhbHVlIG9mIG9iamVjdCBhXG4gKi9cbmZ1bmN0aW9uIGV4dGVuZChhLCBiLCB0aGlzQXJnKSB7XG4gIGZvckVhY2goYiwgZnVuY3Rpb24gYXNzaWduVmFsdWUodmFsLCBrZXkpIHtcbiAgICBpZiAodGhpc0FyZyAmJiB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBhW2tleV0gPSBiaW5kKHZhbCwgdGhpc0FyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFba2V5XSA9IHZhbDtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gYTtcbn1cblxuLyoqXG4gKiBSZW1vdmUgYnl0ZSBvcmRlciBtYXJrZXIuIFRoaXMgY2F0Y2hlcyBFRiBCQiBCRiAodGhlIFVURi04IEJPTSlcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29udGVudCB3aXRoIEJPTVxuICogQHJldHVybiB7c3RyaW5nfSBjb250ZW50IHZhbHVlIHdpdGhvdXQgQk9NXG4gKi9cbmZ1bmN0aW9uIHN0cmlwQk9NKGNvbnRlbnQpIHtcbiAgaWYgKGNvbnRlbnQuY2hhckNvZGVBdCgwKSA9PT0gMHhGRUZGKSB7XG4gICAgY29udGVudCA9IGNvbnRlbnQuc2xpY2UoMSk7XG4gIH1cbiAgcmV0dXJuIGNvbnRlbnQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc0FycmF5OiBpc0FycmF5LFxuICBpc0FycmF5QnVmZmVyOiBpc0FycmF5QnVmZmVyLFxuICBpc0J1ZmZlcjogaXNCdWZmZXIsXG4gIGlzRm9ybURhdGE6IGlzRm9ybURhdGEsXG4gIGlzQXJyYXlCdWZmZXJWaWV3OiBpc0FycmF5QnVmZmVyVmlldyxcbiAgaXNTdHJpbmc6IGlzU3RyaW5nLFxuICBpc051bWJlcjogaXNOdW1iZXIsXG4gIGlzT2JqZWN0OiBpc09iamVjdCxcbiAgaXNQbGFpbk9iamVjdDogaXNQbGFpbk9iamVjdCxcbiAgaXNVbmRlZmluZWQ6IGlzVW5kZWZpbmVkLFxuICBpc0RhdGU6IGlzRGF0ZSxcbiAgaXNGaWxlOiBpc0ZpbGUsXG4gIGlzQmxvYjogaXNCbG9iLFxuICBpc0Z1bmN0aW9uOiBpc0Z1bmN0aW9uLFxuICBpc1N0cmVhbTogaXNTdHJlYW0sXG4gIGlzVVJMU2VhcmNoUGFyYW1zOiBpc1VSTFNlYXJjaFBhcmFtcyxcbiAgaXNTdGFuZGFyZEJyb3dzZXJFbnY6IGlzU3RhbmRhcmRCcm93c2VyRW52LFxuICBmb3JFYWNoOiBmb3JFYWNoLFxuICBtZXJnZTogbWVyZ2UsXG4gIGV4dGVuZDogZXh0ZW5kLFxuICB0cmltOiB0cmltLFxuICBzdHJpcEJPTTogc3RyaXBCT01cbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/axios/lib/utils.js\n");

/***/ }),

/***/ "./vendor/feiron/fe_roles/src/resources/js/abilityList.js":
/*!****************************************************************!*\
  !*** ./vendor/feiron/fe_roles/src/resources/js/abilityList.js ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var choices_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! choices.js */ \"./node_modules/choices.js/public/assets/scripts/choices.js\");\n/* harmony import */ var choices_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(choices_js__WEBPACK_IMPORTED_MODULE_0__);\n/* provided dependency */ var axios = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n\n\nfunction InitPrevList(target, url) {\n  var initType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'abilities';\n  this.abAjaxURL = url;\n  this.list = new (choices_js__WEBPACK_IMPORTED_MODULE_0___default())(target, {\n    removeItemButton: true,\n    duplicateItemsAllowed: false,\n    paste: false,\n    placeholderValue: 'Available abilities...',\n    classNames: {\n      containerInner: 'choices__inner form-select'\n    }\n  });\n  if (initType == 'abilities') this.fetchAbilities();else this.fetchRoles();\n  return this.list;\n}\n\nfunction fetchRoles() {\n  var _this = this;\n\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  axios.post((url || this.abAjaxURL) + '/roles').then(function (resp) {\n    if (resp.data) {\n      _this.list.clearStore().clearChoices().setChoices(resp.data.results || [], 'id', 'text', true);\n\n      if (typeof callback == \"function\") callback();\n    }\n  })[\"catch\"](function (error) {\n    if (window.frameUtil) window.frameUtil.Notify(error);else console.log(error);\n  });\n}\n\nfunction fetchAbilities() {\n  var _this2 = this;\n\n  var url = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n  var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  axios.post((url || this.abAjaxURL) + '/abilities').then(function (resp) {\n    if (resp.data) {\n      _this2.list.clearStore().clearChoices().setChoices(resp.data.results || [], 'id', 'text', true);\n\n      if (typeof callback == \"function\") callback();\n    }\n  })[\"catch\"](function (error) {\n    if (window.frameUtil) window.frameUtil.Notify(error);else console.log(error);\n  });\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  InitPrevList: InitPrevList,\n  fetchAbilities: fetchAbilities,\n  fetchRoles: fetchRoles\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi92ZW5kb3IvZmVpcm9uL2ZlX3JvbGVzL3NyYy9yZXNvdXJjZXMvanMvYWJpbGl0eUxpc3QuanM/MjBiNCJdLCJuYW1lcyI6WyJJbml0UHJldkxpc3QiLCJ0YXJnZXQiLCJ1cmwiLCJpbml0VHlwZSIsImFiQWpheFVSTCIsImxpc3QiLCJDaG9pY2VzIiwicmVtb3ZlSXRlbUJ1dHRvbiIsImR1cGxpY2F0ZUl0ZW1zQWxsb3dlZCIsInBhc3RlIiwicGxhY2Vob2xkZXJWYWx1ZSIsImNsYXNzTmFtZXMiLCJjb250YWluZXJJbm5lciIsImZldGNoQWJpbGl0aWVzIiwiZmV0Y2hSb2xlcyIsImNhbGxiYWNrIiwiYXhpb3MiLCJwb3N0IiwidGhlbiIsInJlc3AiLCJkYXRhIiwiY2xlYXJTdG9yZSIsImNsZWFyQ2hvaWNlcyIsInNldENob2ljZXMiLCJyZXN1bHRzIiwiZXJyb3IiLCJ3aW5kb3ciLCJmcmFtZVV0aWwiLCJOb3RpZnkiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0EsU0FBU0EsWUFBVCxDQUFzQkMsTUFBdEIsRUFBNkJDLEdBQTdCLEVBQXNEO0FBQUEsTUFBckJDLFFBQXFCLHVFQUFaLFdBQVk7QUFDbEQsT0FBS0MsU0FBTCxHQUFlRixHQUFmO0FBQ0EsT0FBS0csSUFBTCxHQUFVLElBQUlDLG1EQUFKLENBQVlMLE1BQVosRUFBbUI7QUFDekJNLG9CQUFnQixFQUFDLElBRFE7QUFFekJDLHlCQUFxQixFQUFDLEtBRkc7QUFHekJDLFNBQUssRUFBQyxLQUhtQjtBQUl6QkMsb0JBQWdCLEVBQUMsd0JBSlE7QUFLekJDLGNBQVUsRUFBRTtBQUFDQyxvQkFBYyxFQUFDO0FBQWhCO0FBTGEsR0FBbkIsQ0FBVjtBQU9BLE1BQUdULFFBQVEsSUFBRSxXQUFiLEVBQTBCLEtBQUtVLGNBQUwsR0FBMUIsS0FDSyxLQUFLQyxVQUFMO0FBQ0wsU0FBTyxLQUFLVCxJQUFaO0FBQ0g7O0FBRUQsU0FBU1MsVUFBVCxHQUEyQztBQUFBOztBQUFBLE1BQXZCWixHQUF1Qix1RUFBbkIsSUFBbUI7QUFBQSxNQUFkYSxRQUFjLHVFQUFMLElBQUs7QUFDdkNDLE9BQUssQ0FBQ0MsSUFBTixDQUFXLENBQUNmLEdBQUcsSUFBRSxLQUFLRSxTQUFYLElBQXNCLFFBQWpDLEVBQ0NjLElBREQsQ0FDTSxVQUFDQyxJQUFELEVBQVE7QUFDVixRQUFHQSxJQUFJLENBQUNDLElBQVIsRUFBYTtBQUNULFdBQUksQ0FBQ2YsSUFBTCxDQUFVZ0IsVUFBVixHQUF1QkMsWUFBdkIsR0FBc0NDLFVBQXRDLENBQ0tKLElBQUksQ0FBQ0MsSUFBTCxDQUFVSSxPQUFWLElBQW1CLEVBRHhCLEVBRUksSUFGSixFQUdJLE1BSEosRUFJSSxJQUpKOztBQU1BLFVBQUksT0FBUVQsUUFBUixJQUFxQixVQUF6QixFQUFxQ0EsUUFBUTtBQUNoRDtBQUNKLEdBWEQsV0FZTyxVQUFDVSxLQUFELEVBQVM7QUFDWixRQUFHQyxNQUFNLENBQUNDLFNBQVYsRUFBcUJELE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0JILEtBQXhCLEVBQXJCLEtBQ0tJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZTCxLQUFaO0FBQ1IsR0FmRDtBQWdCSDs7QUFFRCxTQUFTWixjQUFULEdBQStDO0FBQUE7O0FBQUEsTUFBdkJYLEdBQXVCLHVFQUFuQixJQUFtQjtBQUFBLE1BQWRhLFFBQWMsdUVBQUwsSUFBSztBQUMzQ0MsT0FBSyxDQUFDQyxJQUFOLENBQVcsQ0FBQ2YsR0FBRyxJQUFFLEtBQUtFLFNBQVgsSUFBc0IsWUFBakMsRUFDQ2MsSUFERCxDQUNNLFVBQUNDLElBQUQsRUFBUTtBQUNWLFFBQUdBLElBQUksQ0FBQ0MsSUFBUixFQUFhO0FBQ1QsWUFBSSxDQUFDZixJQUFMLENBQVVnQixVQUFWLEdBQXVCQyxZQUF2QixHQUFzQ0MsVUFBdEMsQ0FDS0osSUFBSSxDQUFDQyxJQUFMLENBQVVJLE9BQVYsSUFBbUIsRUFEeEIsRUFFSSxJQUZKLEVBR0ksTUFISixFQUlJLElBSko7O0FBTUEsVUFBSSxPQUFRVCxRQUFSLElBQXFCLFVBQXpCLEVBQXFDQSxRQUFRO0FBQ2hEO0FBQ0osR0FYRCxXQVlPLFVBQUNVLEtBQUQsRUFBUztBQUNaLFFBQUdDLE1BQU0sQ0FBQ0MsU0FBVixFQUFxQkQsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QkgsS0FBeEIsRUFBckIsS0FDS0ksT0FBTyxDQUFDQyxHQUFSLENBQVlMLEtBQVo7QUFDUixHQWZEO0FBZ0JIOztBQUVELGlFQUFjO0FBQ1Z6QixjQUFZLEVBQVpBLFlBRFU7QUFFVmEsZ0JBQWMsRUFBZEEsY0FGVTtBQUdWQyxZQUFVLEVBQVZBO0FBSFUsQ0FBZCIsImZpbGUiOiIuL3ZlbmRvci9mZWlyb24vZmVfcm9sZXMvc3JjL3Jlc291cmNlcy9qcy9hYmlsaXR5TGlzdC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDaG9pY2VzIGZyb20gJ2Nob2ljZXMuanMnO1xyXG5mdW5jdGlvbiBJbml0UHJldkxpc3QodGFyZ2V0LHVybCxpbml0VHlwZT0nYWJpbGl0aWVzJyl7XHJcbiAgICB0aGlzLmFiQWpheFVSTD11cmw7XHJcbiAgICB0aGlzLmxpc3Q9bmV3IENob2ljZXModGFyZ2V0LHtcclxuICAgICAgICByZW1vdmVJdGVtQnV0dG9uOnRydWUsXHJcbiAgICAgICAgZHVwbGljYXRlSXRlbXNBbGxvd2VkOmZhbHNlLFxyXG4gICAgICAgIHBhc3RlOmZhbHNlLFxyXG4gICAgICAgIHBsYWNlaG9sZGVyVmFsdWU6J0F2YWlsYWJsZSBhYmlsaXRpZXMuLi4nLFxyXG4gICAgICAgIGNsYXNzTmFtZXM6IHtjb250YWluZXJJbm5lcjonY2hvaWNlc19faW5uZXIgZm9ybS1zZWxlY3QnfVxyXG4gICAgfSk7XHJcbiAgICBpZihpbml0VHlwZT09J2FiaWxpdGllcycpIHRoaXMuZmV0Y2hBYmlsaXRpZXMoKTtcclxuICAgIGVsc2UgdGhpcy5mZXRjaFJvbGVzKCk7XHJcbiAgICByZXR1cm4gdGhpcy5saXN0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBmZXRjaFJvbGVzKHVybD1udWxsLGNhbGxiYWNrPW51bGwpe1xyXG4gICAgYXhpb3MucG9zdCgodXJsfHx0aGlzLmFiQWpheFVSTCkrJy9yb2xlcycpXHJcbiAgICAudGhlbigocmVzcCk9PntcclxuICAgICAgICBpZihyZXNwLmRhdGEpe1xyXG4gICAgICAgICAgICB0aGlzLmxpc3QuY2xlYXJTdG9yZSgpLmNsZWFyQ2hvaWNlcygpLnNldENob2ljZXMoXHJcbiAgICAgICAgICAgICAgICAocmVzcC5kYXRhLnJlc3VsdHN8fFtdKSxcclxuICAgICAgICAgICAgICAgICdpZCcsXHJcbiAgICAgICAgICAgICAgICAndGV4dCcsXHJcbiAgICAgICAgICAgICAgICB0cnVlLFxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgKGNhbGxiYWNrKSA9PSBcImZ1bmN0aW9uXCIpIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyb3IpPT57XHJcbiAgICAgICAgaWYod2luZG93LmZyYW1lVXRpbCkgd2luZG93LmZyYW1lVXRpbC5Ob3RpZnkoZXJyb3IpO1xyXG4gICAgICAgIGVsc2UgY29uc29sZS5sb2coZXJyb3IpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZldGNoQWJpbGl0aWVzKHVybD1udWxsLGNhbGxiYWNrPW51bGwpe1xyXG4gICAgYXhpb3MucG9zdCgodXJsfHx0aGlzLmFiQWpheFVSTCkrJy9hYmlsaXRpZXMnKVxyXG4gICAgLnRoZW4oKHJlc3ApPT57XHJcbiAgICAgICAgaWYocmVzcC5kYXRhKXtcclxuICAgICAgICAgICAgdGhpcy5saXN0LmNsZWFyU3RvcmUoKS5jbGVhckNob2ljZXMoKS5zZXRDaG9pY2VzKFxyXG4gICAgICAgICAgICAgICAgKHJlc3AuZGF0YS5yZXN1bHRzfHxbXSksXHJcbiAgICAgICAgICAgICAgICAnaWQnLFxyXG4gICAgICAgICAgICAgICAgJ3RleHQnLFxyXG4gICAgICAgICAgICAgICAgdHJ1ZSxcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiAoY2FsbGJhY2spID09IFwiZnVuY3Rpb25cIikgY2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcik9PntcclxuICAgICAgICBpZih3aW5kb3cuZnJhbWVVdGlsKSB3aW5kb3cuZnJhbWVVdGlsLk5vdGlmeShlcnJvcik7XHJcbiAgICAgICAgZWxzZSBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHR7XHJcbiAgICBJbml0UHJldkxpc3QsXHJcbiAgICBmZXRjaEFiaWxpdGllcyxcclxuICAgIGZldGNoUm9sZXNcclxufSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./vendor/feiron/fe_roles/src/resources/js/abilityList.js\n");

/***/ }),

/***/ "./vendor/feiron/fe_roles/src/resources/js/roleManagementControl.js":
/*!**************************************************************************!*\
  !*** ./vendor/feiron/fe_roles/src/resources/js/roleManagementControl.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var tabulator_tables__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tabulator-tables */ \"./node_modules/tabulator-tables/dist/js/tabulator.es2015.js\");\n\n\n\nvar abilityCtrl = __webpack_require__(/*! ./abilityList */ \"./vendor/feiron/fe_roles/src/resources/js/abilityList.js\").default;\n\nvar UsrRoleTable;\nvar abilityList;\nvar ajaxTarget;\n\nfunction InitUsrRoleDtable(target) {\n  this.UsrRoleTable = new tabulator_tables__WEBPACK_IMPORTED_MODULE_1__.default('#' + target, {\n    ajaxURL: document.getElementById(target).getAttribute('data_target'),\n    autoColumns: true,\n    autoColumnsDefinitions: [{\n      title: \"id\",\n      field: \"id\",\n      visible: false\n    }, {\n      title: \"role_abilities\",\n      field: \"role_abilities\",\n      visible: false\n    }, {\n      title: \"Name\",\n      field: \"name\",\n      sorter: \"string\",\n      width: 200,\n      headerFilter: \"input\"\n    }, {\n      title: \"Description\",\n      field: \"description\",\n      sorter: \"string\",\n      headerFilter: \"input\"\n    }, {\n      title: \"Rank\",\n      field: \"rank\",\n      sorter: \"number\",\n      width: 100,\n      headerFilter: \"input\"\n    }, {\n      title: \"Actions\",\n      field: \"actions\",\n      width: 180,\n      cssClass: 'options',\n      headerSort: false,\n      formatter: function formatter(cell, formatterParams, onRendered) {\n        var id = cell.getRow().getCell(\"id\").getValue();\n        return '<div class=\"container-fluid\"><div class=\"row m-l-0 m-r-0\"><div class=\"col-md-6 col-sm-12 px-1\"><button class=\"btn btn-sm btn-primary btn-edit\" data-source=' + id + '>View/Edit</button></div><div class=\"col-md-6 col-sm-12 px-1\"><button class=\"btn btn-sm btn-danger btn-remove\" data-source=' + id + '>Remove</button></div></div></div>';\n      }\n    }, {\n      title: \"Disabled\",\n      field: \"disabled\",\n      sorter: \"string\",\n      width: 100,\n      headerFilter: true,\n      editor: \"tickCross\",\n      editorParams: {\n        tristate: true,\n        indeterminateValue: \"n/a\",\n        elementAttributes: {\n          maxlength: \"10\" //set the maximum character length of the input element to 10 characters\n\n        }\n      }\n    }],\n    responsiveLayout: true,\n    resizableColumns: false,\n    layout: \"fitColumns\",\n    ajaxFiltering: true,\n    ajaxSorting: true,\n    pagination: \"remote\",\n    paginationSize: 15,\n    paginationSizeSelector: [30, 50, 100, true],\n    ajaxRequesting: function ajaxRequesting(url, params) {\n      params.ByType = document.querySelector('#pr_management input[type=\"radio\"][name=\"ListType\"]:checked').value || 'Role';\n    },\n    ajaxResponse: function ajaxResponse(url, params, response) {\n      (response.data || []).forEach(function (elm) {\n        elm.actions = '';\n      });\n      return response;\n    },\n    ajaxConfig: {\n      method: \"POST\",\n      headers: {\n        'X-CSRF-TOKEN': document.querySelector('meta[name=\"csrf-token\"]').getAttribute('content')\n      }\n    },\n    ajaxError: function ajaxError(error) {\n      window.frameUtil.Notify(error, 'error');\n    }\n  });\n  this.ajaxTarget = this.UsrRoleTable.element.getAttribute('data_target');\n}\n\nfunction clearWorkingArea(target) {\n  target.querySelectorAll('input:not([type=\"radio\"],[type=\"checkbox\"]), textarea, select').forEach(function (elm) {\n    elm.value = \"\";\n  });\n  target.querySelectorAll('input[type=\"radio\"],input[type=\"checkbox\"]').forEach(function (elm) {\n    elm.classList.remove('checked');\n    elm.checked = false;\n  });\n  target.querySelectorAll('input[type=\"radio\"].default,input[type=\"checkbox\"].default').forEach(function (elm) {\n    elm.checked = true;\n  });\n  target.querySelectorAll('select').forEach(function (elm) {\n    elm.value = (elm.querySelector('option[default]') || {\n      value: \"\"\n    }).value;\n  });\n}\n\nfunction InitUsrAbilityList(target, url) {\n  this.abilityList = abilityCtrl.InitPrevList(target, url);\n}\n\nfunction fetchAbilities() {\n  abilityCtrl.fetchAbilities();\n}\n\nfunction pr_remove(target, type) {\n  var _this = this;\n\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  axios__WEBPACK_IMPORTED_MODULE_0___default().post(this.ajaxTarget + '/delete/' + target, {\n    ByType: type\n  }).then(function (resp) {\n    _this.dispatchUpdateEvent(type);\n\n    if (typeof callback == \"function\") callback(resp.data);\n  })[\"catch\"](function (err) {\n    if (window.frameUtil) window.frameUtil.Notify(err);else console.log(err);\n  });\n}\n\nfunction pr_saveChange(type) {\n  var _this2 = this;\n\n  var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  axios__WEBPACK_IMPORTED_MODULE_0___default().post(this.ajaxTarget + '/save', data).then(function (resp) {\n    _this2.dispatchUpdateEvent(type);\n\n    if (typeof callback == \"function\") callback(resp.data);\n  })[\"catch\"](function (err) {\n    if (window.frameUtil) window.frameUtil.Notify(err);else console.log(err);\n  });\n}\n\nfunction pr_load(target, type, callback) {\n  var _this3 = this;\n\n  this.abilityList.removeActiveItems();\n  axios__WEBPACK_IMPORTED_MODULE_0___default().post(this.ajaxTarget + '/' + target, {\n    ByType: type\n  }).then(function (resp) {\n    resp = resp.data;\n\n    if (resp.type && resp.type == 'Role') {\n      _this3.abilityList.setChoiceByValue((resp.role_abilities || []).map(function (ab) {\n        return ab.id;\n      }));\n    }\n\n    if (typeof callback == \"function\") {\n      callback(resp);\n    }\n  })[\"catch\"](function (err) {\n    if (window.frameUtil) window.frameUtil.Notify(err);else console.log(err);\n  });\n}\n\nfunction dispatchUpdateEvent(type) {\n  document.querySelectorAll('.prev-list').forEach(function (elm) {\n    elm.dispatchEvent(new CustomEvent('list-updated', {\n      detail: {\n        prevType: type\n      }\n    }));\n  });\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  InitUsrRoleDtable: InitUsrRoleDtable,\n  InitUsrAbilityList: InitUsrAbilityList,\n  UsrRoleTable: UsrRoleTable,\n  abilityList: abilityList,\n  clearWorkingArea: clearWorkingArea,\n  fetchAbilities: fetchAbilities,\n  pr_remove: pr_remove,\n  pr_saveChange: pr_saveChange,\n  pr_load: pr_load,\n  dispatchUpdateEvent: dispatchUpdateEvent\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi92ZW5kb3IvZmVpcm9uL2ZlX3JvbGVzL3NyYy9yZXNvdXJjZXMvanMvcm9sZU1hbmFnZW1lbnRDb250cm9sLmpzPzI0MTMiXSwibmFtZXMiOlsiYWJpbGl0eUN0cmwiLCJyZXF1aXJlIiwiVXNyUm9sZVRhYmxlIiwiYWJpbGl0eUxpc3QiLCJhamF4VGFyZ2V0IiwiSW5pdFVzclJvbGVEdGFibGUiLCJ0YXJnZXQiLCJUYWJ1bGF0b3IiLCJhamF4VVJMIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldEF0dHJpYnV0ZSIsImF1dG9Db2x1bW5zIiwiYXV0b0NvbHVtbnNEZWZpbml0aW9ucyIsInRpdGxlIiwiZmllbGQiLCJ2aXNpYmxlIiwic29ydGVyIiwid2lkdGgiLCJoZWFkZXJGaWx0ZXIiLCJjc3NDbGFzcyIsImhlYWRlclNvcnQiLCJmb3JtYXR0ZXIiLCJjZWxsIiwiZm9ybWF0dGVyUGFyYW1zIiwib25SZW5kZXJlZCIsImlkIiwiZ2V0Um93IiwiZ2V0Q2VsbCIsImdldFZhbHVlIiwiZWRpdG9yIiwiZWRpdG9yUGFyYW1zIiwidHJpc3RhdGUiLCJpbmRldGVybWluYXRlVmFsdWUiLCJlbGVtZW50QXR0cmlidXRlcyIsIm1heGxlbmd0aCIsInJlc3BvbnNpdmVMYXlvdXQiLCJyZXNpemFibGVDb2x1bW5zIiwibGF5b3V0IiwiYWpheEZpbHRlcmluZyIsImFqYXhTb3J0aW5nIiwicGFnaW5hdGlvbiIsInBhZ2luYXRpb25TaXplIiwicGFnaW5hdGlvblNpemVTZWxlY3RvciIsImFqYXhSZXF1ZXN0aW5nIiwidXJsIiwicGFyYW1zIiwiQnlUeXBlIiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwiYWpheFJlc3BvbnNlIiwicmVzcG9uc2UiLCJkYXRhIiwiZm9yRWFjaCIsImVsbSIsImFjdGlvbnMiLCJhamF4Q29uZmlnIiwibWV0aG9kIiwiaGVhZGVycyIsImFqYXhFcnJvciIsImVycm9yIiwid2luZG93IiwiZnJhbWVVdGlsIiwiTm90aWZ5IiwiZWxlbWVudCIsImNsZWFyV29ya2luZ0FyZWEiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiY2hlY2tlZCIsIkluaXRVc3JBYmlsaXR5TGlzdCIsIkluaXRQcmV2TGlzdCIsImZldGNoQWJpbGl0aWVzIiwicHJfcmVtb3ZlIiwidHlwZSIsImNhbGxiYWNrIiwiYXhpb3MiLCJ0aGVuIiwicmVzcCIsImRpc3BhdGNoVXBkYXRlRXZlbnQiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwicHJfc2F2ZUNoYW5nZSIsInByX2xvYWQiLCJyZW1vdmVBY3RpdmVJdGVtcyIsInNldENob2ljZUJ5VmFsdWUiLCJyb2xlX2FiaWxpdGllcyIsIm1hcCIsImFiIiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwicHJldlR5cGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBOztBQUNBLElBQUlBLFdBQVcsR0FBQ0MsNEdBQWhCOztBQUNBLElBQUlDLFlBQUo7QUFDQSxJQUFJQyxXQUFKO0FBQ0EsSUFBSUMsVUFBSjs7QUFFQSxTQUFTQyxpQkFBVCxDQUEyQkMsTUFBM0IsRUFBbUM7QUFDL0IsT0FBS0osWUFBTCxHQUFvQixJQUFJSyxxREFBSixDQUFjLE1BQUlELE1BQWxCLEVBQTBCO0FBQzFDRSxXQUFPLEVBQUNDLFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QkosTUFBeEIsRUFBZ0NLLFlBQWhDLENBQTZDLGFBQTdDLENBRGtDO0FBRTFDQyxlQUFXLEVBQUMsSUFGOEI7QUFHMUNDLDBCQUFzQixFQUFDLENBQ25CO0FBQUNDLFdBQUssRUFBQyxJQUFQO0FBQWFDLFdBQUssRUFBQyxJQUFuQjtBQUF5QkMsYUFBTyxFQUFDO0FBQWpDLEtBRG1CLEVBRW5CO0FBQUNGLFdBQUssRUFBQyxnQkFBUDtBQUF5QkMsV0FBSyxFQUFDLGdCQUEvQjtBQUFpREMsYUFBTyxFQUFDO0FBQXpELEtBRm1CLEVBR25CO0FBQUNGLFdBQUssRUFBQyxNQUFQO0FBQWVDLFdBQUssRUFBQyxNQUFyQjtBQUE2QkUsWUFBTSxFQUFDLFFBQXBDO0FBQThDQyxXQUFLLEVBQUMsR0FBcEQ7QUFBeURDLGtCQUFZLEVBQUM7QUFBdEUsS0FIbUIsRUFJbkI7QUFBQ0wsV0FBSyxFQUFDLGFBQVA7QUFBc0JDLFdBQUssRUFBQyxhQUE1QjtBQUEyQ0UsWUFBTSxFQUFDLFFBQWxEO0FBQTJERSxrQkFBWSxFQUFDO0FBQXhFLEtBSm1CLEVBS25CO0FBQUNMLFdBQUssRUFBQyxNQUFQO0FBQWVDLFdBQUssRUFBQyxNQUFyQjtBQUE2QkUsWUFBTSxFQUFDLFFBQXBDO0FBQThDQyxXQUFLLEVBQUMsR0FBcEQ7QUFBd0RDLGtCQUFZLEVBQUM7QUFBckUsS0FMbUIsRUFNbkI7QUFBQ0wsV0FBSyxFQUFDLFNBQVA7QUFBa0JDLFdBQUssRUFBQyxTQUF4QjtBQUFtQ0csV0FBSyxFQUFDLEdBQXpDO0FBQThDRSxjQUFRLEVBQUMsU0FBdkQ7QUFBa0VDLGdCQUFVLEVBQUMsS0FBN0U7QUFBb0ZDLGVBQVMsRUFBQyxtQkFBQ0MsSUFBRCxFQUFPQyxlQUFQLEVBQXdCQyxVQUF4QixFQUFxQztBQUMvSCxZQUFJQyxFQUFFLEdBQUdILElBQUksQ0FBQ0ksTUFBTCxHQUFjQyxPQUFkLENBQXNCLElBQXRCLEVBQTRCQyxRQUE1QixFQUFUO0FBQ0EsZUFBTyxnS0FBZ0tILEVBQWhLLEdBQXFLLDZIQUFySyxHQUFxU0EsRUFBclMsR0FBMFMsb0NBQWpUO0FBQ0g7QUFIRCxLQU5tQixFQVVuQjtBQUFDWixXQUFLLEVBQUMsVUFBUDtBQUFtQkMsV0FBSyxFQUFDLFVBQXpCO0FBQXFDRSxZQUFNLEVBQUMsUUFBNUM7QUFBc0RDLFdBQUssRUFBQyxHQUE1RDtBQUFnRUMsa0JBQVksRUFBQyxJQUE3RTtBQUFrRlcsWUFBTSxFQUFDLFdBQXpGO0FBQXNHQyxrQkFBWSxFQUFDO0FBQy9HQyxnQkFBUSxFQUFDLElBRHNHO0FBRS9HQywwQkFBa0IsRUFBQyxLQUY0RjtBQUcvR0MseUJBQWlCLEVBQUM7QUFDZEMsbUJBQVMsRUFBQyxJQURJLENBQ0U7O0FBREY7QUFINkY7QUFBbkgsS0FWbUIsQ0FIbUI7QUFxQjFDQyxvQkFBZ0IsRUFBQyxJQXJCeUI7QUFzQjFDQyxvQkFBZ0IsRUFBQyxLQXRCeUI7QUF1QjFDQyxVQUFNLEVBQUMsWUF2Qm1DO0FBd0IxQ0MsaUJBQWEsRUFBQyxJQXhCNEI7QUF5QjFDQyxlQUFXLEVBQUMsSUF6QjhCO0FBMEIxQ0MsY0FBVSxFQUFDLFFBMUIrQjtBQTJCMUNDLGtCQUFjLEVBQUMsRUEzQjJCO0FBNEIxQ0MsMEJBQXNCLEVBQUMsQ0FBQyxFQUFELEVBQUssRUFBTCxFQUFTLEdBQVQsRUFBYyxJQUFkLENBNUJtQjtBQTZCMUNDLGtCQUFjLEVBQUMsd0JBQVNDLEdBQVQsRUFBY0MsTUFBZCxFQUFxQjtBQUNoQ0EsWUFBTSxDQUFDQyxNQUFQLEdBQWN0QyxRQUFRLENBQUN1QyxhQUFULENBQXVCLDZEQUF2QixFQUFzRkMsS0FBdEYsSUFBNkYsTUFBM0c7QUFDSCxLQS9CeUM7QUFnQzFDQyxnQkFBWSxFQUFDLHNCQUFTTCxHQUFULEVBQWNDLE1BQWQsRUFBc0JLLFFBQXRCLEVBQStCO0FBQ3hDLE9BQUNBLFFBQVEsQ0FBQ0MsSUFBVCxJQUFlLEVBQWhCLEVBQW9CQyxPQUFwQixDQUE0QixVQUFDQyxHQUFELEVBQU87QUFDL0JBLFdBQUcsQ0FBQ0MsT0FBSixHQUFZLEVBQVo7QUFDSCxPQUZEO0FBR0EsYUFBT0osUUFBUDtBQUNILEtBckN5QztBQXNDMUNLLGNBQVUsRUFBQztBQUNQQyxZQUFNLEVBQUMsTUFEQTtBQUVQQyxhQUFPLEVBQUU7QUFDTCx3QkFBZ0JqRCxRQUFRLENBQUN1QyxhQUFULENBQXVCLHlCQUF2QixFQUFrRHJDLFlBQWxELENBQStELFNBQS9EO0FBRFg7QUFGRixLQXRDK0I7QUE0QzFDZ0QsYUFBUyxFQUFDLG1CQUFTQyxLQUFULEVBQWU7QUFDckJDLFlBQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0JILEtBQXhCLEVBQStCLE9BQS9CO0FBQ0g7QUE5Q3lDLEdBQTFCLENBQXBCO0FBZ0RBLE9BQUt4RCxVQUFMLEdBQWdCLEtBQUtGLFlBQUwsQ0FBa0I4RCxPQUFsQixDQUEwQnJELFlBQTFCLENBQXVDLGFBQXZDLENBQWhCO0FBQ0g7O0FBQ0QsU0FBU3NELGdCQUFULENBQTBCM0QsTUFBMUIsRUFBaUM7QUFDN0JBLFFBQU0sQ0FBQzRELGdCQUFQLENBQXdCLCtEQUF4QixFQUF5RmIsT0FBekYsQ0FBaUcsVUFBQ0MsR0FBRCxFQUFPO0FBQ3BHQSxPQUFHLENBQUNMLEtBQUosR0FBVSxFQUFWO0FBQ0gsR0FGRDtBQUdBM0MsUUFBTSxDQUFDNEQsZ0JBQVAsQ0FBd0IsNENBQXhCLEVBQXNFYixPQUF0RSxDQUE4RSxVQUFDQyxHQUFELEVBQU87QUFDakZBLE9BQUcsQ0FBQ2EsU0FBSixDQUFjQyxNQUFkLENBQXFCLFNBQXJCO0FBQ0FkLE9BQUcsQ0FBQ2UsT0FBSixHQUFZLEtBQVo7QUFDSCxHQUhEO0FBS0EvRCxRQUFNLENBQUM0RCxnQkFBUCxDQUF3Qiw0REFBeEIsRUFBc0ZiLE9BQXRGLENBQThGLFVBQUNDLEdBQUQsRUFBTztBQUNqR0EsT0FBRyxDQUFDZSxPQUFKLEdBQVksSUFBWjtBQUNILEdBRkQ7QUFJQS9ELFFBQU0sQ0FBQzRELGdCQUFQLENBQXdCLFFBQXhCLEVBQWtDYixPQUFsQyxDQUEwQyxVQUFDQyxHQUFELEVBQU87QUFDN0NBLE9BQUcsQ0FBQ0wsS0FBSixHQUFVLENBQUNLLEdBQUcsQ0FBQ04sYUFBSixDQUFrQixpQkFBbEIsS0FBc0M7QUFBQ0MsV0FBSyxFQUFDO0FBQVAsS0FBdkMsRUFBbURBLEtBQTdEO0FBQ0gsR0FGRDtBQUdIOztBQUNELFNBQVNxQixrQkFBVCxDQUE0QmhFLE1BQTVCLEVBQW1DdUMsR0FBbkMsRUFBdUM7QUFDbkMsT0FBSzFDLFdBQUwsR0FBaUJILFdBQVcsQ0FBQ3VFLFlBQVosQ0FBeUJqRSxNQUF6QixFQUFnQ3VDLEdBQWhDLENBQWpCO0FBQ0g7O0FBRUQsU0FBUzJCLGNBQVQsR0FBeUI7QUFDckJ4RSxhQUFXLENBQUN3RSxjQUFaO0FBQ0g7O0FBRUQsU0FBU0MsU0FBVCxDQUFtQm5FLE1BQW5CLEVBQTBCb0UsSUFBMUIsRUFBK0M7QUFBQTs7QUFBQSxNQUFmQyxRQUFlLHVFQUFOLElBQU07QUFDM0NDLG1EQUFBLENBQVcsS0FBS3hFLFVBQUwsR0FBZ0IsVUFBaEIsR0FBNkJFLE1BQXhDLEVBQStDO0FBQUN5QyxVQUFNLEVBQUMyQjtBQUFSLEdBQS9DLEVBQ0NHLElBREQsQ0FDTSxVQUFDQyxJQUFELEVBQVE7QUFDVixTQUFJLENBQUNDLG1CQUFMLENBQXlCTCxJQUF6Qjs7QUFDQSxRQUFJLE9BQVFDLFFBQVIsSUFBcUIsVUFBekIsRUFBcUNBLFFBQVEsQ0FBQ0csSUFBSSxDQUFDMUIsSUFBTixDQUFSO0FBQ3hDLEdBSkQsV0FJUyxVQUFDNEIsR0FBRCxFQUFPO0FBQ1osUUFBR25CLE1BQU0sQ0FBQ0MsU0FBVixFQUFxQkQsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QmlCLEdBQXhCLEVBQXJCLEtBQ0tDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixHQUFaO0FBQ1IsR0FQRDtBQVFIOztBQUVELFNBQVNHLGFBQVQsQ0FBdUJULElBQXZCLEVBQXFEO0FBQUE7O0FBQUEsTUFBeEJ0QixJQUF3Qix1RUFBbkIsRUFBbUI7QUFBQSxNQUFmdUIsUUFBZSx1RUFBTixJQUFNO0FBQ2pEQyxtREFBQSxDQUFXLEtBQUt4RSxVQUFMLEdBQWdCLE9BQTNCLEVBQW1DZ0QsSUFBbkMsRUFDQ3lCLElBREQsQ0FDTSxVQUFDQyxJQUFELEVBQVE7QUFDWCxVQUFJLENBQUNDLG1CQUFMLENBQXlCTCxJQUF6Qjs7QUFDQyxRQUFJLE9BQVFDLFFBQVIsSUFBcUIsVUFBekIsRUFBcUNBLFFBQVEsQ0FBQ0csSUFBSSxDQUFDMUIsSUFBTixDQUFSO0FBQ3hDLEdBSkQsV0FJUyxVQUFDNEIsR0FBRCxFQUFPO0FBQ1osUUFBR25CLE1BQU0sQ0FBQ0MsU0FBVixFQUFxQkQsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QmlCLEdBQXhCLEVBQXJCLEtBQ0tDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixHQUFaO0FBQ1IsR0FQRDtBQVFIOztBQUVELFNBQVNJLE9BQVQsQ0FBaUI5RSxNQUFqQixFQUF3Qm9FLElBQXhCLEVBQThCQyxRQUE5QixFQUF3QztBQUFBOztBQUNwQyxPQUFLeEUsV0FBTCxDQUFpQmtGLGlCQUFqQjtBQUNBVCxtREFBQSxDQUFXLEtBQUt4RSxVQUFMLEdBQWdCLEdBQWhCLEdBQW9CRSxNQUEvQixFQUFzQztBQUFDeUMsVUFBTSxFQUFDMkI7QUFBUixHQUF0QyxFQUNDRyxJQURELENBQ00sVUFBQ0MsSUFBRCxFQUFRO0FBQ1ZBLFFBQUksR0FBQ0EsSUFBSSxDQUFDMUIsSUFBVjs7QUFDQSxRQUFHMEIsSUFBSSxDQUFDSixJQUFMLElBQWFJLElBQUksQ0FBQ0osSUFBTCxJQUFhLE1BQTdCLEVBQW9DO0FBQ2hDLFlBQUksQ0FBQ3ZFLFdBQUwsQ0FBaUJtRixnQkFBakIsQ0FBa0MsQ0FBQ1IsSUFBSSxDQUFDUyxjQUFMLElBQXFCLEVBQXRCLEVBQTBCQyxHQUExQixDQUE4QixVQUFDQyxFQUFELEVBQU07QUFBQyxlQUFPQSxFQUFFLENBQUMvRCxFQUFWO0FBQWEsT0FBbEQsQ0FBbEM7QUFDSDs7QUFDRCxRQUFJLE9BQVFpRCxRQUFSLElBQXFCLFVBQXpCLEVBQXFDO0FBQ2pDQSxjQUFRLENBQUNHLElBQUQsQ0FBUjtBQUNIO0FBQ0osR0FURCxXQVNTLFVBQUNFLEdBQUQsRUFBTztBQUNaLFFBQUduQixNQUFNLENBQUNDLFNBQVYsRUFBcUJELE1BQU0sQ0FBQ0MsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0JpQixHQUF4QixFQUFyQixLQUNLQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsR0FBWjtBQUNSLEdBWkQ7QUFhSDs7QUFFRCxTQUFTRCxtQkFBVCxDQUE2QkwsSUFBN0IsRUFBa0M7QUFDOUJqRSxVQUFRLENBQUN5RCxnQkFBVCxDQUEwQixZQUExQixFQUF3Q2IsT0FBeEMsQ0FBZ0QsVUFBQ0MsR0FBRCxFQUFPO0FBQ25EQSxPQUFHLENBQUNvQyxhQUFKLENBQWtCLElBQUlDLFdBQUosQ0FBZ0IsY0FBaEIsRUFBK0I7QUFBQ0MsWUFBTSxFQUFDO0FBQUNDLGdCQUFRLEVBQUNuQjtBQUFWO0FBQVIsS0FBL0IsQ0FBbEI7QUFDSCxHQUZEO0FBR0g7O0FBRUQsaUVBQWM7QUFDVnJFLG1CQUFpQixFQUFqQkEsaUJBRFU7QUFFVmlFLG9CQUFrQixFQUFsQkEsa0JBRlU7QUFHVnBFLGNBQVksRUFBWkEsWUFIVTtBQUlWQyxhQUFXLEVBQVhBLFdBSlU7QUFLVjhELGtCQUFnQixFQUFoQkEsZ0JBTFU7QUFNVk8sZ0JBQWMsRUFBZEEsY0FOVTtBQU9WQyxXQUFTLEVBQVRBLFNBUFU7QUFRVlUsZUFBYSxFQUFiQSxhQVJVO0FBU1ZDLFNBQU8sRUFBUEEsT0FUVTtBQVVWTCxxQkFBbUIsRUFBbkJBO0FBVlUsQ0FBZCIsImZpbGUiOiIuL3ZlbmRvci9mZWlyb24vZmVfcm9sZXMvc3JjL3Jlc291cmNlcy9qcy9yb2xlTWFuYWdlbWVudENvbnRyb2wuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xyXG5pbXBvcnQgVGFidWxhdG9yIGZyb20gJ3RhYnVsYXRvci10YWJsZXMnO1xyXG52YXIgYWJpbGl0eUN0cmw9cmVxdWlyZSgnLi9hYmlsaXR5TGlzdCcpLmRlZmF1bHQ7XHJcbnZhciBVc3JSb2xlVGFibGU7XHJcbnZhciBhYmlsaXR5TGlzdDtcclxudmFyIGFqYXhUYXJnZXQ7XHJcblxyXG5mdW5jdGlvbiBJbml0VXNyUm9sZUR0YWJsZSh0YXJnZXQpIHtcclxuICAgIHRoaXMuVXNyUm9sZVRhYmxlID0gbmV3IFRhYnVsYXRvcignIycrdGFyZ2V0LCB7XHJcbiAgICAgICAgYWpheFVSTDpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQpLmdldEF0dHJpYnV0ZSgnZGF0YV90YXJnZXQnKSxcclxuICAgICAgICBhdXRvQ29sdW1uczp0cnVlLFxyXG4gICAgICAgIGF1dG9Db2x1bW5zRGVmaW5pdGlvbnM6W1xyXG4gICAgICAgICAgICB7dGl0bGU6XCJpZFwiLCBmaWVsZDpcImlkXCIsIHZpc2libGU6ZmFsc2V9LCBcclxuICAgICAgICAgICAge3RpdGxlOlwicm9sZV9hYmlsaXRpZXNcIiwgZmllbGQ6XCJyb2xlX2FiaWxpdGllc1wiLCB2aXNpYmxlOmZhbHNlfSwgXHJcbiAgICAgICAgICAgIHt0aXRsZTpcIk5hbWVcIiwgZmllbGQ6XCJuYW1lXCIsIHNvcnRlcjpcInN0cmluZ1wiLCB3aWR0aDoyMDAsIGhlYWRlckZpbHRlcjpcImlucHV0XCJ9LCBcclxuICAgICAgICAgICAge3RpdGxlOlwiRGVzY3JpcHRpb25cIiwgZmllbGQ6XCJkZXNjcmlwdGlvblwiLCBzb3J0ZXI6XCJzdHJpbmdcIixoZWFkZXJGaWx0ZXI6XCJpbnB1dFwifSxcclxuICAgICAgICAgICAge3RpdGxlOlwiUmFua1wiLCBmaWVsZDpcInJhbmtcIiwgc29ydGVyOlwibnVtYmVyXCIsIHdpZHRoOjEwMCxoZWFkZXJGaWx0ZXI6XCJpbnB1dFwifSxcclxuICAgICAgICAgICAge3RpdGxlOlwiQWN0aW9uc1wiLCBmaWVsZDpcImFjdGlvbnNcIiwgd2lkdGg6MTgwLCBjc3NDbGFzczonb3B0aW9ucycsIGhlYWRlclNvcnQ6ZmFsc2UsIGZvcm1hdHRlcjooY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKT0+e1xyXG4gICAgICAgICAgICAgICAgbGV0IGlkID0gY2VsbC5nZXRSb3coKS5nZXRDZWxsKFwiaWRcIikuZ2V0VmFsdWUoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cImNvbnRhaW5lci1mbHVpZFwiPjxkaXYgY2xhc3M9XCJyb3cgbS1sLTAgbS1yLTBcIj48ZGl2IGNsYXNzPVwiY29sLW1kLTYgY29sLXNtLTEyIHB4LTFcIj48YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi1zbSBidG4tcHJpbWFyeSBidG4tZWRpdFwiIGRhdGEtc291cmNlPScgKyBpZCArICc+Vmlldy9FZGl0PC9idXR0b24+PC9kaXY+PGRpdiBjbGFzcz1cImNvbC1tZC02IGNvbC1zbS0xMiBweC0xXCI+PGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc20gYnRuLWRhbmdlciBidG4tcmVtb3ZlXCIgZGF0YS1zb3VyY2U9JyArIGlkICsgJz5SZW1vdmU8L2J1dHRvbj48L2Rpdj48L2Rpdj48L2Rpdj4nXHJcbiAgICAgICAgICAgIH19LFxyXG4gICAgICAgICAgICB7dGl0bGU6XCJEaXNhYmxlZFwiLCBmaWVsZDpcImRpc2FibGVkXCIsIHNvcnRlcjpcInN0cmluZ1wiLCB3aWR0aDoxMDAsaGVhZGVyRmlsdGVyOnRydWUsZWRpdG9yOlwidGlja0Nyb3NzXCIsIGVkaXRvclBhcmFtczp7XHJcbiAgICAgICAgICAgICAgICB0cmlzdGF0ZTp0cnVlLFxyXG4gICAgICAgICAgICAgICAgaW5kZXRlcm1pbmF0ZVZhbHVlOlwibi9hXCIsXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50QXR0cmlidXRlczp7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF4bGVuZ3RoOlwiMTBcIiwgLy9zZXQgdGhlIG1heGltdW0gY2hhcmFjdGVyIGxlbmd0aCBvZiB0aGUgaW5wdXQgZWxlbWVudCB0byAxMCBjaGFyYWN0ZXJzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH19XHJcbiAgICAgICAgXSxcclxuICAgICAgICByZXNwb25zaXZlTGF5b3V0OnRydWUsXHJcbiAgICAgICAgcmVzaXphYmxlQ29sdW1uczpmYWxzZSxcclxuICAgICAgICBsYXlvdXQ6XCJmaXRDb2x1bW5zXCIsXHJcbiAgICAgICAgYWpheEZpbHRlcmluZzp0cnVlLFxyXG4gICAgICAgIGFqYXhTb3J0aW5nOnRydWUsXHJcbiAgICAgICAgcGFnaW5hdGlvbjpcInJlbW90ZVwiLFxyXG4gICAgICAgIHBhZ2luYXRpb25TaXplOjE1LFxyXG4gICAgICAgIHBhZ2luYXRpb25TaXplU2VsZWN0b3I6WzMwLCA1MCwgMTAwLCB0cnVlXSxcclxuICAgICAgICBhamF4UmVxdWVzdGluZzpmdW5jdGlvbih1cmwsIHBhcmFtcyl7XHJcbiAgICAgICAgICAgIHBhcmFtcy5CeVR5cGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3ByX21hbmFnZW1lbnQgaW5wdXRbdHlwZT1cInJhZGlvXCJdW25hbWU9XCJMaXN0VHlwZVwiXTpjaGVja2VkJykudmFsdWV8fCdSb2xlJztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFqYXhSZXNwb25zZTpmdW5jdGlvbih1cmwsIHBhcmFtcywgcmVzcG9uc2Upe1xyXG4gICAgICAgICAgICAocmVzcG9uc2UuZGF0YXx8W10pLmZvckVhY2goKGVsbSk9PntcclxuICAgICAgICAgICAgICAgIGVsbS5hY3Rpb25zPScnO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWpheENvbmZpZzp7XHJcbiAgICAgICAgICAgIG1ldGhvZDpcIlBPU1RcIixcclxuICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgJ1gtQ1NSRi1UT0tFTic6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21ldGFbbmFtZT1cImNzcmYtdG9rZW5cIl0nKS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhamF4RXJyb3I6ZnVuY3Rpb24oZXJyb3Ipe1xyXG4gICAgICAgICAgICB3aW5kb3cuZnJhbWVVdGlsLk5vdGlmeShlcnJvciwgJ2Vycm9yJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLmFqYXhUYXJnZXQ9dGhpcy5Vc3JSb2xlVGFibGUuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGFfdGFyZ2V0Jyk7XHJcbn1cclxuZnVuY3Rpb24gY2xlYXJXb3JraW5nQXJlYSh0YXJnZXQpe1xyXG4gICAgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Om5vdChbdHlwZT1cInJhZGlvXCJdLFt0eXBlPVwiY2hlY2tib3hcIl0pLCB0ZXh0YXJlYSwgc2VsZWN0JykuZm9yRWFjaCgoZWxtKT0+e1xyXG4gICAgICAgIGVsbS52YWx1ZT1cIlwiO1xyXG4gICAgfSk7XHJcbiAgICB0YXJnZXQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1cInJhZGlvXCJdLGlucHV0W3R5cGU9XCJjaGVja2JveFwiXScpLmZvckVhY2goKGVsbSk9PntcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xyXG4gICAgICAgIGVsbS5jaGVja2VkPWZhbHNlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXS5kZWZhdWx0LGlucHV0W3R5cGU9XCJjaGVja2JveFwiXS5kZWZhdWx0JykuZm9yRWFjaCgoZWxtKT0+e1xyXG4gICAgICAgIGVsbS5jaGVja2VkPXRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0YXJnZXQucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0JykuZm9yRWFjaCgoZWxtKT0+e1xyXG4gICAgICAgIGVsbS52YWx1ZT0oZWxtLnF1ZXJ5U2VsZWN0b3IoJ29wdGlvbltkZWZhdWx0XScpfHx7dmFsdWU6XCJcIn0pLnZhbHVlO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gSW5pdFVzckFiaWxpdHlMaXN0KHRhcmdldCx1cmwpe1xyXG4gICAgdGhpcy5hYmlsaXR5TGlzdD1hYmlsaXR5Q3RybC5Jbml0UHJldkxpc3QodGFyZ2V0LHVybCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZldGNoQWJpbGl0aWVzKCl7XHJcbiAgICBhYmlsaXR5Q3RybC5mZXRjaEFiaWxpdGllcygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcl9yZW1vdmUodGFyZ2V0LHR5cGUsIGNhbGxiYWNrPW51bGwpIHtcclxuICAgIGF4aW9zLnBvc3QodGhpcy5hamF4VGFyZ2V0KycvZGVsZXRlLycgKyB0YXJnZXQse0J5VHlwZTp0eXBlfSlcclxuICAgIC50aGVuKChyZXNwKT0+e1xyXG4gICAgICAgIHRoaXMuZGlzcGF0Y2hVcGRhdGVFdmVudCh0eXBlKTtcclxuICAgICAgICBpZiAodHlwZW9mIChjYWxsYmFjaykgPT0gXCJmdW5jdGlvblwiKSBjYWxsYmFjayhyZXNwLmRhdGEpO1xyXG4gICAgfSkuY2F0Y2goKGVycik9PntcclxuICAgICAgICBpZih3aW5kb3cuZnJhbWVVdGlsKSB3aW5kb3cuZnJhbWVVdGlsLk5vdGlmeShlcnIpO1xyXG4gICAgICAgIGVsc2UgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwcl9zYXZlQ2hhbmdlKHR5cGUsIGRhdGE9e30sIGNhbGxiYWNrPW51bGwpIHtcclxuICAgIGF4aW9zLnBvc3QodGhpcy5hamF4VGFyZ2V0Kycvc2F2ZScsZGF0YSlcclxuICAgIC50aGVuKChyZXNwKT0+e1xyXG4gICAgICAgdGhpcy5kaXNwYXRjaFVwZGF0ZUV2ZW50KHR5cGUpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgKGNhbGxiYWNrKSA9PSBcImZ1bmN0aW9uXCIpIGNhbGxiYWNrKHJlc3AuZGF0YSk7XHJcbiAgICB9KS5jYXRjaCgoZXJyKT0+e1xyXG4gICAgICAgIGlmKHdpbmRvdy5mcmFtZVV0aWwpIHdpbmRvdy5mcmFtZVV0aWwuTm90aWZ5KGVycik7XHJcbiAgICAgICAgZWxzZSBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHByX2xvYWQodGFyZ2V0LHR5cGUsIGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLmFiaWxpdHlMaXN0LnJlbW92ZUFjdGl2ZUl0ZW1zKCk7XHJcbiAgICBheGlvcy5wb3N0KHRoaXMuYWpheFRhcmdldCsnLycrdGFyZ2V0LHtCeVR5cGU6dHlwZX0pXHJcbiAgICAudGhlbigocmVzcCk9PntcclxuICAgICAgICByZXNwPXJlc3AuZGF0YTtcclxuICAgICAgICBpZihyZXNwLnR5cGUgJiYgcmVzcC50eXBlID09ICdSb2xlJyl7XHJcbiAgICAgICAgICAgIHRoaXMuYWJpbGl0eUxpc3Quc2V0Q2hvaWNlQnlWYWx1ZSgocmVzcC5yb2xlX2FiaWxpdGllc3x8W10pLm1hcCgoYWIpPT57cmV0dXJuIGFiLmlkfSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIChjYWxsYmFjaykgPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKHJlc3ApO1xyXG4gICAgICAgIH1cclxuICAgIH0pLmNhdGNoKChlcnIpPT57XHJcbiAgICAgICAgaWYod2luZG93LmZyYW1lVXRpbCkgd2luZG93LmZyYW1lVXRpbC5Ob3RpZnkoZXJyKTtcclxuICAgICAgICBlbHNlIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGF0Y2hVcGRhdGVFdmVudCh0eXBlKXtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcmV2LWxpc3QnKS5mb3JFYWNoKChlbG0pPT57XHJcbiAgICAgICAgZWxtLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdsaXN0LXVwZGF0ZWQnLHtkZXRhaWw6e3ByZXZUeXBlOnR5cGV9fSkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0e1xyXG4gICAgSW5pdFVzclJvbGVEdGFibGUsXHJcbiAgICBJbml0VXNyQWJpbGl0eUxpc3QsXHJcbiAgICBVc3JSb2xlVGFibGUsXHJcbiAgICBhYmlsaXR5TGlzdCxcclxuICAgIGNsZWFyV29ya2luZ0FyZWEsXHJcbiAgICBmZXRjaEFiaWxpdGllcyxcclxuICAgIHByX3JlbW92ZSxcclxuICAgIHByX3NhdmVDaGFuZ2UsXHJcbiAgICBwcl9sb2FkLFxyXG4gICAgZGlzcGF0Y2hVcGRhdGVFdmVudFxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./vendor/feiron/fe_roles/src/resources/js/roleManagementControl.js\n");

/***/ }),

/***/ "./node_modules/choices.js/public/assets/scripts/choices.js":
/*!******************************************************************!*\
  !*** ./node_modules/choices.js/public/assets/scripts/choices.js ***!
  \******************************************************************/
/***/ ((module) => {

eval("/*! choices.js v9.0.1 |  2019 Josh Johnson | https://github.com/jshjohnson/Choices#readme */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory();\n\telse {}\n})(window, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __nested_webpack_require_633__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __nested_webpack_require_633__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__nested_webpack_require_633__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__nested_webpack_require_633__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__nested_webpack_require_633__.d = function(exports, name, getter) {\n/******/ \t\tif(!__nested_webpack_require_633__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__nested_webpack_require_633__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__nested_webpack_require_633__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __nested_webpack_require_633__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__nested_webpack_require_633__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __nested_webpack_require_633__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__nested_webpack_require_633__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__nested_webpack_require_633__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__nested_webpack_require_633__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__nested_webpack_require_633__.p = \"/public/assets/scripts/\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __nested_webpack_require_633__(__nested_webpack_require_633__.s = 4);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n\treturn Array.isArray(val) ? [] : {}\n}\n\nfunction cloneUnlessOtherwiseSpecified(value, options) {\n\treturn (options.clone !== false && options.isMergeableObject(value))\n\t\t? deepmerge(emptyTarget(value), value, options)\n\t\t: value\n}\n\nfunction defaultArrayMerge(target, source, options) {\n\treturn target.concat(source).map(function(element) {\n\t\treturn cloneUnlessOtherwiseSpecified(element, options)\n\t})\n}\n\nfunction getMergeFunction(key, options) {\n\tif (!options.customMerge) {\n\t\treturn deepmerge\n\t}\n\tvar customMerge = options.customMerge(key);\n\treturn typeof customMerge === 'function' ? customMerge : deepmerge\n}\n\nfunction getEnumerableOwnPropertySymbols(target) {\n\treturn Object.getOwnPropertySymbols\n\t\t? Object.getOwnPropertySymbols(target).filter(function(symbol) {\n\t\t\treturn target.propertyIsEnumerable(symbol)\n\t\t})\n\t\t: []\n}\n\nfunction getKeys(target) {\n\treturn Object.keys(target).concat(getEnumerableOwnPropertySymbols(target))\n}\n\n// Protects from prototype poisoning and unexpected merging up the prototype chain.\nfunction propertyIsUnsafe(target, key) {\n\ttry {\n\t\treturn (key in target) // Properties are safe to merge if they don't exist in the target yet,\n\t\t\t&& !(Object.hasOwnProperty.call(target, key) // unsafe if they exist up the prototype chain,\n\t\t\t\t&& Object.propertyIsEnumerable.call(target, key)) // and also unsafe if they're nonenumerable.\n\t} catch (unused) {\n\t\t// Counterintuitively, it's safe to merge any property on a target that causes the `in` operator to throw.\n\t\t// This happens when trying to copy an object in the source over a plain string in the target.\n\t\treturn false\n\t}\n}\n\nfunction mergeObject(target, source, options) {\n\tvar destination = {};\n\tif (options.isMergeableObject(target)) {\n\t\tgetKeys(target).forEach(function(key) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(target[key], options);\n\t\t});\n\t}\n\tgetKeys(source).forEach(function(key) {\n\t\tif (propertyIsUnsafe(target, key)) {\n\t\t\treturn\n\t\t}\n\n\t\tif (!options.isMergeableObject(source[key]) || !target[key]) {\n\t\t\tdestination[key] = cloneUnlessOtherwiseSpecified(source[key], options);\n\t\t} else {\n\t\t\tdestination[key] = getMergeFunction(key, options)(target[key], source[key], options);\n\t\t}\n\t});\n\treturn destination\n}\n\nfunction deepmerge(target, source, options) {\n\toptions = options || {};\n\toptions.arrayMerge = options.arrayMerge || defaultArrayMerge;\n\toptions.isMergeableObject = options.isMergeableObject || isMergeableObject;\n\t// cloneUnlessOtherwiseSpecified is added to `options` so that custom arrayMerge()\n\t// implementations can use it. The caller may not replace it.\n\toptions.cloneUnlessOtherwiseSpecified = cloneUnlessOtherwiseSpecified;\n\n\tvar sourceIsArray = Array.isArray(source);\n\tvar targetIsArray = Array.isArray(target);\n\tvar sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n\tif (!sourceAndTargetTypesMatch) {\n\t\treturn cloneUnlessOtherwiseSpecified(source, options)\n\t} else if (sourceIsArray) {\n\t\treturn options.arrayMerge(target, source, options)\n\t} else {\n\t\treturn mergeObject(target, source, options)\n\t}\n}\n\ndeepmerge.all = function deepmergeAll(array, options) {\n\tif (!Array.isArray(array)) {\n\t\tthrow new Error('first argument should be an array')\n\t}\n\n\treturn array.reduce(function(prev, next) {\n\t\treturn deepmerge(prev, next, options)\n\t}, {})\n};\n\nvar deepmerge_1 = deepmerge;\n\nmodule.exports = deepmerge_1;\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __nested_webpack_require_8347__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global, module) {/* harmony import */ var _ponyfill_js__WEBPACK_IMPORTED_MODULE_0__ = __nested_webpack_require_8347__(3);\n/* global window */\n\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (true) {\n  root = module;\n} else {}\n\nvar result = Object(_ponyfill_js__WEBPACK_IMPORTED_MODULE_0__[/* default */ \"a\"])(root);\n/* harmony default export */ __webpack_exports__[\"a\"] = (result);\n\n/* WEBPACK VAR INJECTION */}.call(this, __nested_webpack_require_8347__(5), __nested_webpack_require_8347__(6)(module)))\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n * Fuse.js v3.4.5 - Lightweight fuzzy-search (http://fusejs.io)\n * \n * Copyright (c) 2012-2017 Kirollos Risk (http://kiro.me)\n * All Rights Reserved. Apache Software License 2.0\n * \n * http://www.apache.org/licenses/LICENSE-2.0\n */\n!function(e,t){  true?module.exports=t():0}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=1)}([function(e,t){e.exports=function(e){return Array.isArray?Array.isArray(e):\"[object Array]\"===Object.prototype.toString.call(e)}},function(e,t,n){function r(e){return(r=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(2),a=n(8),s=n(0),c=function(){function e(t,n){var r=n.location,o=void 0===r?0:r,i=n.distance,s=void 0===i?100:i,c=n.threshold,h=void 0===c?.6:c,l=n.maxPatternLength,u=void 0===l?32:l,f=n.caseSensitive,d=void 0!==f&&f,v=n.tokenSeparator,p=void 0===v?/ +/g:v,g=n.findAllMatches,y=void 0!==g&&g,m=n.minMatchCharLength,k=void 0===m?1:m,S=n.id,x=void 0===S?null:S,b=n.keys,M=void 0===b?[]:b,_=n.shouldSort,L=void 0===_||_,w=n.getFn,A=void 0===w?a:w,C=n.sortFn,I=void 0===C?function(e,t){return e.score-t.score}:C,O=n.tokenize,j=void 0!==O&&O,P=n.matchAllTokens,F=void 0!==P&&P,T=n.includeMatches,z=void 0!==T&&T,E=n.includeScore,K=void 0!==E&&E,$=n.verbose,J=void 0!==$&&$;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:d,tokenSeparator:p,findAllMatches:y,minMatchCharLength:k,id:x,keys:M,includeMatches:z,includeScore:K,shouldSort:L,getFn:A,sortFn:I,verbose:J,tokenize:j,matchAllTokens:F},this.setCollection(t)}var t,n,c;return t=e,(n=[{key:\"setCollection\",value:function(e){return this.list=e,e}},{key:\"search\",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{limit:!1};this._log('---------\\nSearch pattern: \"'.concat(e,'\"'));var n=this._prepareSearchers(e),r=n.tokenSearchers,o=n.fullSearcher,i=this._search(r,o),a=i.weights,s=i.results;return this._computeScore(a,s),this.options.shouldSort&&this._sort(s),t.limit&&\"number\"==typeof t.limit&&(s=s.slice(0,t.limit)),this._format(s)}},{key:\"_prepareSearchers\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",t=[];if(this.options.tokenize)for(var n=e.split(this.options.tokenSeparator),r=0,o=n.length;r<o;r+=1)t.push(new i(n[r],this.options));return{tokenSearchers:t,fullSearcher:new i(e,this.options)}}},{key:\"_search\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=this.list,r={},o=[];if(\"string\"==typeof n[0]){for(var i=0,a=n.length;i<a;i+=1)this._analyze({key:\"\",value:n[i],record:i,index:i},{resultMap:r,results:o,tokenSearchers:e,fullSearcher:t});return{weights:null,results:o}}for(var s={},c=0,h=n.length;c<h;c+=1)for(var l=n[c],u=0,f=this.options.keys.length;u<f;u+=1){var d=this.options.keys[u];if(\"string\"!=typeof d){if(s[d.name]={weight:1-d.weight||1},d.weight<=0||d.weight>1)throw new Error(\"Key weight has to be > 0 and <= 1\");d=d.name}else s[d]={weight:1};this._analyze({key:d,value:this.options.getFn(l,d),record:l,index:c},{resultMap:r,results:o,tokenSearchers:e,fullSearcher:t})}return{weights:s,results:o}}},{key:\"_analyze\",value:function(e,t){var n=e.key,r=e.arrayIndex,o=void 0===r?-1:r,i=e.value,a=e.record,c=e.index,h=t.tokenSearchers,l=void 0===h?[]:h,u=t.fullSearcher,f=void 0===u?[]:u,d=t.resultMap,v=void 0===d?{}:d,p=t.results,g=void 0===p?[]:p;if(null!=i){var y=!1,m=-1,k=0;if(\"string\"==typeof i){this._log(\"\\nKey: \".concat(\"\"===n?\"-\":n));var S=f.search(i);if(this._log('Full text: \"'.concat(i,'\", score: ').concat(S.score)),this.options.tokenize){for(var x=i.split(this.options.tokenSeparator),b=[],M=0;M<l.length;M+=1){var _=l[M];this._log('\\nPattern: \"'.concat(_.pattern,'\"'));for(var L=!1,w=0;w<x.length;w+=1){var A=x[w],C=_.search(A),I={};C.isMatch?(I[A]=C.score,y=!0,L=!0,b.push(C.score)):(I[A]=1,this.options.matchAllTokens||b.push(1)),this._log('Token: \"'.concat(A,'\", score: ').concat(I[A]))}L&&(k+=1)}m=b[0];for(var O=b.length,j=1;j<O;j+=1)m+=b[j];m/=O,this._log(\"Token score average:\",m)}var P=S.score;m>-1&&(P=(P+m)/2),this._log(\"Score average:\",P);var F=!this.options.tokenize||!this.options.matchAllTokens||k>=l.length;if(this._log(\"\\nCheck Matches: \".concat(F)),(y||S.isMatch)&&F){var T=v[c];T?T.output.push({key:n,arrayIndex:o,value:i,score:P,matchedIndices:S.matchedIndices}):(v[c]={item:a,output:[{key:n,arrayIndex:o,value:i,score:P,matchedIndices:S.matchedIndices}]},g.push(v[c]))}}else if(s(i))for(var z=0,E=i.length;z<E;z+=1)this._analyze({key:n,arrayIndex:z,value:i[z],record:a,index:c},{resultMap:v,results:g,tokenSearchers:l,fullSearcher:f})}}},{key:\"_computeScore\",value:function(e,t){this._log(\"\\n\\nComputing score:\\n\");for(var n=0,r=t.length;n<r;n+=1){for(var o=t[n].output,i=o.length,a=1,s=1,c=0;c<i;c+=1){var h=e?e[o[c].key].weight:1,l=(1===h?o[c].score:o[c].score||.001)*h;1!==h?s=Math.min(s,l):(o[c].nScore=l,a*=l)}t[n].score=1===s?a:s,this._log(t[n])}}},{key:\"_sort\",value:function(e){this._log(\"\\n\\nSorting....\"),e.sort(this.options.sortFn)}},{key:\"_format\",value:function(e){var t=[];if(this.options.verbose){var n=[];this._log(\"\\n\\nOutput:\\n\\n\",JSON.stringify(e,function(e,t){if(\"object\"===r(t)&&null!==t){if(-1!==n.indexOf(t))return;n.push(t)}return t})),n=null}var o=[];this.options.includeMatches&&o.push(function(e,t){var n=e.output;t.matches=[];for(var r=0,o=n.length;r<o;r+=1){var i=n[r];if(0!==i.matchedIndices.length){var a={indices:i.matchedIndices,value:i.value};i.key&&(a.key=i.key),i.hasOwnProperty(\"arrayIndex\")&&i.arrayIndex>-1&&(a.arrayIndex=i.arrayIndex),t.matches.push(a)}}}),this.options.includeScore&&o.push(function(e,t){t.score=e.score});for(var i=0,a=e.length;i<a;i+=1){var s=e[i];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),o.length){for(var c={item:s.item},h=0,l=o.length;h<l;h+=1)o[h](s,c);t.push(c)}else t.push(s.item)}return t}},{key:\"_log\",value:function(){var e;this.options.verbose&&(e=console).log.apply(e,arguments)}}])&&o(t.prototype,n),c&&o(t,c),e}();e.exports=c},function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=n(3),i=n(4),a=n(7),s=function(){function e(t,n){var r=n.location,o=void 0===r?0:r,i=n.distance,s=void 0===i?100:i,c=n.threshold,h=void 0===c?.6:c,l=n.maxPatternLength,u=void 0===l?32:l,f=n.isCaseSensitive,d=void 0!==f&&f,v=n.tokenSeparator,p=void 0===v?/ +/g:v,g=n.findAllMatches,y=void 0!==g&&g,m=n.minMatchCharLength,k=void 0===m?1:m;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.options={location:o,distance:s,threshold:h,maxPatternLength:u,isCaseSensitive:d,tokenSeparator:p,findAllMatches:y,minMatchCharLength:k},this.pattern=this.options.isCaseSensitive?t:t.toLowerCase(),this.pattern.length<=u&&(this.patternAlphabet=a(this.pattern))}var t,n,s;return t=e,(n=[{key:\"search\",value:function(e){if(this.options.isCaseSensitive||(e=e.toLowerCase()),this.pattern===e)return{isMatch:!0,score:0,matchedIndices:[[0,e.length-1]]};var t=this.options,n=t.maxPatternLength,r=t.tokenSeparator;if(this.pattern.length>n)return o(e,this.pattern,r);var a=this.options,s=a.location,c=a.distance,h=a.threshold,l=a.findAllMatches,u=a.minMatchCharLength;return i(e,this.pattern,this.patternAlphabet,{location:s,distance:c,threshold:h,findAllMatches:l,minMatchCharLength:u})}}])&&r(t.prototype,n),s&&r(t,s),e}();e.exports=s},function(e,t){var n=/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g;e.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/ +/g,o=new RegExp(t.replace(n,\"\\\\$&\").replace(r,\"|\")),i=e.match(o),a=!!i,s=[];if(a)for(var c=0,h=i.length;c<h;c+=1){var l=i[c];s.push([e.indexOf(l),l.length-1])}return{score:a?.5:1,isMatch:a,matchedIndices:s}}},function(e,t,n){var r=n(5),o=n(6);e.exports=function(e,t,n,i){for(var a=i.location,s=void 0===a?0:a,c=i.distance,h=void 0===c?100:c,l=i.threshold,u=void 0===l?.6:l,f=i.findAllMatches,d=void 0!==f&&f,v=i.minMatchCharLength,p=void 0===v?1:v,g=s,y=e.length,m=u,k=e.indexOf(t,g),S=t.length,x=[],b=0;b<y;b+=1)x[b]=0;if(-1!==k){var M=r(t,{errors:0,currentLocation:k,expectedLocation:g,distance:h});if(m=Math.min(M,m),-1!==(k=e.lastIndexOf(t,g+S))){var _=r(t,{errors:0,currentLocation:k,expectedLocation:g,distance:h});m=Math.min(_,m)}}k=-1;for(var L=[],w=1,A=S+y,C=1<<S-1,I=0;I<S;I+=1){for(var O=0,j=A;O<j;){r(t,{errors:I,currentLocation:g+j,expectedLocation:g,distance:h})<=m?O=j:A=j,j=Math.floor((A-O)/2+O)}A=j;var P=Math.max(1,g-j+1),F=d?y:Math.min(g+j,y)+S,T=Array(F+2);T[F+1]=(1<<I)-1;for(var z=F;z>=P;z-=1){var E=z-1,K=n[e.charAt(E)];if(K&&(x[E]=1),T[z]=(T[z+1]<<1|1)&K,0!==I&&(T[z]|=(L[z+1]|L[z])<<1|1|L[z+1]),T[z]&C&&(w=r(t,{errors:I,currentLocation:E,expectedLocation:g,distance:h}))<=m){if(m=w,(k=E)<=g)break;P=Math.max(1,2*g-k)}}if(r(t,{errors:I+1,currentLocation:g,expectedLocation:g,distance:h})>m)break;L=T}return{isMatch:k>=0,score:0===w?.001:w,matchedIndices:o(x,p)}}},function(e,t){e.exports=function(e,t){var n=t.errors,r=void 0===n?0:n,o=t.currentLocation,i=void 0===o?0:o,a=t.expectedLocation,s=void 0===a?0:a,c=t.distance,h=void 0===c?100:c,l=r/e.length,u=Math.abs(s-i);return h?l+u/h:u?1:l}},function(e,t){e.exports=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],r=-1,o=-1,i=0,a=e.length;i<a;i+=1){var s=e[i];s&&-1===r?r=i:s||-1===r||((o=i-1)-r+1>=t&&n.push([r,o]),r=-1)}return e[i-1]&&i-r>=t&&n.push([r,i-1]),n}},function(e,t){e.exports=function(e){for(var t={},n=e.length,r=0;r<n;r+=1)t[e.charAt(r)]=0;for(var o=0;o<n;o+=1)t[e.charAt(o)]|=1<<n-o-1;return t}},function(e,t,n){var r=n(0);e.exports=function(e,t){return function e(t,n,o){if(n){var i=n.indexOf(\".\"),a=n,s=null;-1!==i&&(a=n.slice(0,i),s=n.slice(i+1));var c=t[a];if(null!=c)if(s||\"string\"!=typeof c&&\"number\"!=typeof c)if(r(c))for(var h=0,l=c.length;h<l;h+=1)e(c[h],s,o);else s&&e(c,s,o);else o.push(c.toString())}else o.push(t);return o}(e,t,[])}}])});\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __nested_webpack_require_20511__) {\n\n\"use strict\";\n/* harmony export (binding) */ __nested_webpack_require_20511__.d(__webpack_exports__, \"a\", function() { return symbolObservablePonyfill; });\nfunction symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __nested_webpack_require_21049__) {\n\nmodule.exports = __nested_webpack_require_21049__(7);\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\nvar g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\nmodule.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __nested_webpack_require_22336__) {\n\n\"use strict\";\n__nested_webpack_require_22336__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/fuse.js/dist/fuse.js\nvar dist_fuse = __nested_webpack_require_22336__(2);\nvar fuse_default = /*#__PURE__*/__nested_webpack_require_22336__.n(dist_fuse);\n\n// EXTERNAL MODULE: ./node_modules/deepmerge/dist/cjs.js\nvar cjs = __nested_webpack_require_22336__(0);\nvar cjs_default = /*#__PURE__*/__nested_webpack_require_22336__.n(cjs);\n\n// EXTERNAL MODULE: ./node_modules/symbol-observable/es/index.js\nvar es = __nested_webpack_require_22336__(1);\n\n// CONCATENATED MODULE: ./node_modules/redux/es/redux.js\n\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n}\n\n/**\n * Creates a Redux store that holds the state tree.\n * The only way to change the data in the store is to call `dispatch()` on it.\n *\n * There should only be a single store in your app. To specify how different\n * parts of the state tree respond to actions, you may combine several reducers\n * into a single reducer function by using `combineReducers`.\n *\n * @param {Function} reducer A function that returns the next state tree, given\n * the current state tree and the action to handle.\n *\n * @param {any} [preloadedState] The initial state. You may optionally specify it\n * to hydrate the state from the server in universal apps, or to restore a\n * previously serialized user session.\n * If you use `combineReducers` to produce the root reducer function, this must be\n * an object with the same shape as `combineReducers` keys.\n *\n * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n * to enhance the store with third-party capabilities such as middleware,\n * time travel, persistence, etc. The only store enhancer that ships with Redux\n * is `applyMiddleware()`.\n *\n * @returns {Store} A Redux store that lets you read the state, dispatch actions\n * and subscribe to changes.\n */\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error('It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error('You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected the listener to be a function.');\n    }\n\n    if (isDispatching) {\n      throw new Error('You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error('You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api-reference/store#subscribe(listener) for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[es[\"a\" /* default */]] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[es[\"a\" /* default */]] = observable, _ref2;\n}\n\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionDescription = actionType && \"action \\\"\" + String(actionType) + \"\\\"\" || 'an action';\n  return \"Given \" + actionDescription + \", reducer \\\"\" + key + \"\\\" returned undefined. \" + \"To ignore an action, you must explicitly return the previous state. \" + \"If you want this reducer to hold no value, you can return null instead of undefined.\";\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return \"The \" + argumentName + \" has unexpected type of \\\"\" + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + \"\\\". Expected argument to be an object with the following \" + (\"keys: \\\"\" + reducerKeys.join('\", \"') + \"\\\"\");\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n  if (action && action.type === ActionTypes.REPLACE) return;\n\n  if (unexpectedKeys.length > 0) {\n    return \"Unexpected \" + (unexpectedKeys.length > 1 ? 'keys' : 'key') + \" \" + (\"\\\"\" + unexpectedKeys.join('\", \"') + \"\\\" found in \" + argumentName + \". \") + \"Expected to find one of the known reducer keys instead: \" + (\"\\\"\" + reducerKeys.join('\", \"') + \"\\\". Unexpected keys will be ignored.\");\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, {\n      type: ActionTypes.INIT\n    });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined during initialization. \" + \"If the state passed to the reducer is undefined, you must \" + \"explicitly return the initial state. The initial state may \" + \"not be undefined. If you don't want to set a value for this reducer, \" + \"you can use null instead of undefined.\");\n    }\n\n    if (typeof reducer(undefined, {\n      type: ActionTypes.PROBE_UNKNOWN_ACTION()\n    }) === 'undefined') {\n      throw new Error(\"Reducer \\\"\" + key + \"\\\" returned undefined when probed with a random type. \" + (\"Don't try to handle \" + ActionTypes.INIT + \" or other actions in \\\"redux/*\\\" \") + \"namespace. They are considered private. Instead, you must return the \" + \"current state for any unknown actions, unless it is undefined, \" + \"in which case you must return the initial state, regardless of the \" + \"action type. The initial state may not be undefined, but can be null.\");\n    }\n  });\n}\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\n\n\nfunction combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (false) {}\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n\n  var finalReducerKeys = Object.keys(finalReducers); // This is used to make sure we don't warn about the same\n  // keys multiple times.\n\n  var unexpectedKeyCache;\n\n  if (false) {}\n\n  var shapeAssertionError;\n\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination(state, action) {\n    if (state === void 0) {\n      state = {};\n    }\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (false) { var warningMessage; }\n\n    var hasChanged = false;\n    var nextState = {};\n\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n\n    return hasChanged ? nextState : state;\n  };\n}\n\nfunction bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(this, arguments));\n  };\n}\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass an action creator as the first argument,\n * and get a dispatch wrapped function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\n\n\nfunction bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error(\"bindActionCreators expected an object or a function, instead received \" + (actionCreators === null ? 'null' : typeof actionCreators) + \". \" + \"Did you write \\\"import ActionCreators from\\\" instead of \\\"import * as ActionCreators from\\\"?\");\n  }\n\n  var boundActionCreators = {};\n\n  for (var key in actionCreators) {\n    var actionCreator = actionCreators[key];\n\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n\n  return boundActionCreators;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    keys.push.apply(keys, Object.getOwnPropertySymbols(object));\n  }\n\n  if (enumerableOnly) keys = keys.filter(function (sym) {\n    return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n  });\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(source, true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(source).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\n/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\nfunction compose() {\n  for (var _len = arguments.length, funcs = new Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(void 0, arguments));\n    };\n  });\n}\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\n\nfunction applyMiddleware() {\n  for (var _len = arguments.length, middlewares = new Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function () {\n      var store = createStore.apply(void 0, arguments);\n\n      var _dispatch = function dispatch() {\n        throw new Error('Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.');\n      };\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch() {\n          return _dispatch.apply(void 0, arguments);\n        }\n      };\n      var chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(void 0, chain)(store.dispatch);\n      return _objectSpread2({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}\n\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\nfunction isCrushed() {}\n\nif (false) {}\n\n\n\n// CONCATENATED MODULE: ./src/scripts/reducers/items.js\nvar defaultState = [];\nfunction items_items(state, action) {\n  if (state === void 0) {\n    state = defaultState;\n  }\n\n  switch (action.type) {\n    case 'ADD_ITEM':\n      {\n        // Add object to items array\n        var newState = [].concat(state, [{\n          id: action.id,\n          choiceId: action.choiceId,\n          groupId: action.groupId,\n          value: action.value,\n          label: action.label,\n          active: true,\n          highlighted: false,\n          customProperties: action.customProperties,\n          placeholder: action.placeholder || false,\n          keyCode: null\n        }]);\n        return newState.map(function (obj) {\n          var item = obj;\n          item.highlighted = false;\n          return item;\n        });\n      }\n\n    case 'REMOVE_ITEM':\n      {\n        // Set item to inactive\n        return state.map(function (obj) {\n          var item = obj;\n\n          if (item.id === action.id) {\n            item.active = false;\n          }\n\n          return item;\n        });\n      }\n\n    case 'HIGHLIGHT_ITEM':\n      {\n        return state.map(function (obj) {\n          var item = obj;\n\n          if (item.id === action.id) {\n            item.highlighted = action.highlighted;\n          }\n\n          return item;\n        });\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n}\n// CONCATENATED MODULE: ./src/scripts/reducers/groups.js\nvar groups_defaultState = [];\nfunction groups(state, action) {\n  if (state === void 0) {\n    state = groups_defaultState;\n  }\n\n  switch (action.type) {\n    case 'ADD_GROUP':\n      {\n        return [].concat(state, [{\n          id: action.id,\n          value: action.value,\n          active: action.active,\n          disabled: action.disabled\n        }]);\n      }\n\n    case 'CLEAR_CHOICES':\n      {\n        return [];\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n}\n// CONCATENATED MODULE: ./src/scripts/reducers/choices.js\nvar choices_defaultState = [];\nfunction choices_choices(state, action) {\n  if (state === void 0) {\n    state = choices_defaultState;\n  }\n\n  switch (action.type) {\n    case 'ADD_CHOICE':\n      {\n        /*\n            A disabled choice appears in the choice dropdown but cannot be selected\n            A selected choice has been added to the passed input's value (added as an item)\n            An active choice appears within the choice dropdown\n         */\n        return [].concat(state, [{\n          id: action.id,\n          elementId: action.elementId,\n          groupId: action.groupId,\n          value: action.value,\n          label: action.label || action.value,\n          disabled: action.disabled || false,\n          selected: false,\n          active: true,\n          score: 9999,\n          customProperties: action.customProperties,\n          placeholder: action.placeholder || false,\n          keyCode: null\n        }]);\n      }\n\n    case 'ADD_ITEM':\n      {\n        // If all choices need to be activated\n        if (action.activateOptions) {\n          return state.map(function (obj) {\n            var choice = obj;\n            choice.active = action.active;\n            return choice;\n          });\n        } // When an item is added and it has an associated choice,\n        // we want to disable it so it can't be chosen again\n\n\n        if (action.choiceId > -1) {\n          return state.map(function (obj) {\n            var choice = obj;\n\n            if (choice.id === parseInt(action.choiceId, 10)) {\n              choice.selected = true;\n            }\n\n            return choice;\n          });\n        }\n\n        return state;\n      }\n\n    case 'REMOVE_ITEM':\n      {\n        // When an item is removed and it has an associated choice,\n        // we want to re-enable it so it can be chosen again\n        if (action.choiceId > -1) {\n          return state.map(function (obj) {\n            var choice = obj;\n\n            if (choice.id === parseInt(action.choiceId, 10)) {\n              choice.selected = false;\n            }\n\n            return choice;\n          });\n        }\n\n        return state;\n      }\n\n    case 'FILTER_CHOICES':\n      {\n        return state.map(function (obj) {\n          var choice = obj; // Set active state based on whether choice is\n          // within filtered results\n\n          choice.active = action.results.some(function (_ref) {\n            var item = _ref.item,\n                score = _ref.score;\n\n            if (item.id === choice.id) {\n              choice.score = score;\n              return true;\n            }\n\n            return false;\n          });\n          return choice;\n        });\n      }\n\n    case 'ACTIVATE_CHOICES':\n      {\n        return state.map(function (obj) {\n          var choice = obj;\n          choice.active = action.active;\n          return choice;\n        });\n      }\n\n    case 'CLEAR_CHOICES':\n      {\n        return choices_defaultState;\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n}\n// CONCATENATED MODULE: ./src/scripts/reducers/general.js\nvar general_defaultState = {\n  loading: false\n};\n\nvar general = function general(state, action) {\n  if (state === void 0) {\n    state = general_defaultState;\n  }\n\n  switch (action.type) {\n    case 'SET_IS_LOADING':\n      {\n        return {\n          loading: action.isLoading\n        };\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n};\n\n/* harmony default export */ var reducers_general = (general);\n// CONCATENATED MODULE: ./src/scripts/lib/utils.js\n/**\n * @param {number} min\n * @param {number} max\n * @returns {number}\n */\nvar getRandomNumber = function getRandomNumber(min, max) {\n  return Math.floor(Math.random() * (max - min) + min);\n};\n/**\n * @param {number} length\n * @returns {string}\n */\n\nvar generateChars = function generateChars(length) {\n  return Array.from({\n    length: length\n  }, function () {\n    return getRandomNumber(0, 36).toString(36);\n  }).join('');\n};\n/**\n * @param {HTMLInputElement | HTMLSelectElement} element\n * @param {string} prefix\n * @returns {string}\n */\n\nvar generateId = function generateId(element, prefix) {\n  var id = element.id || element.name && element.name + \"-\" + generateChars(2) || generateChars(4);\n  id = id.replace(/(:|\\.|\\[|\\]|,)/g, '');\n  id = prefix + \"-\" + id;\n  return id;\n};\n/**\n * @param {any} obj\n * @returns {string}\n */\n\nvar getType = function getType(obj) {\n  return Object.prototype.toString.call(obj).slice(8, -1);\n};\n/**\n * @param {string} type\n * @param {any} obj\n * @returns {boolean}\n */\n\nvar isType = function isType(type, obj) {\n  return obj !== undefined && obj !== null && getType(obj) === type;\n};\n/**\n * @param {HTMLElement} element\n * @param {HTMLElement} [wrapper={HTMLDivElement}]\n * @returns {HTMLElement}\n */\n\nvar utils_wrap = function wrap(element, wrapper) {\n  if (wrapper === void 0) {\n    wrapper = document.createElement('div');\n  }\n\n  if (element.nextSibling) {\n    element.parentNode.insertBefore(wrapper, element.nextSibling);\n  } else {\n    element.parentNode.appendChild(wrapper);\n  }\n\n  return wrapper.appendChild(element);\n};\n/**\n * @param {Element} startEl\n * @param {string} selector\n * @param {1 | -1} direction\n * @returns {Element | undefined}\n */\n\nvar getAdjacentEl = function getAdjacentEl(startEl, selector, direction) {\n  if (direction === void 0) {\n    direction = 1;\n  }\n\n  if (!(startEl instanceof Element) || typeof selector !== 'string') {\n    return undefined;\n  }\n\n  var prop = (direction > 0 ? 'next' : 'previous') + \"ElementSibling\";\n  var sibling = startEl[prop];\n\n  while (sibling) {\n    if (sibling.matches(selector)) {\n      return sibling;\n    }\n\n    sibling = sibling[prop];\n  }\n\n  return sibling;\n};\n/**\n * @param {Element} element\n * @param {Element} parent\n * @param {-1 | 1} direction\n * @returns {boolean}\n */\n\nvar isScrolledIntoView = function isScrolledIntoView(element, parent, direction) {\n  if (direction === void 0) {\n    direction = 1;\n  }\n\n  if (!element) {\n    return false;\n  }\n\n  var isVisible;\n\n  if (direction > 0) {\n    // In view from bottom\n    isVisible = parent.scrollTop + parent.offsetHeight >= element.offsetTop + element.offsetHeight;\n  } else {\n    // In view from top\n    isVisible = element.offsetTop >= parent.scrollTop;\n  }\n\n  return isVisible;\n};\n/**\n * @param {any} value\n * @returns {any}\n */\n\nvar sanitise = function sanitise(value) {\n  if (typeof value !== 'string') {\n    return value;\n  }\n\n  return value.replace(/&/g, '&amp;').replace(/>/g, '&rt;').replace(/</g, '&lt;').replace(/\"/g, '&quot;');\n};\n/**\n * @returns {() => (str: string) => Element}\n */\n\nvar strToEl = function () {\n  var tmpEl = document.createElement('div');\n  return function (str) {\n    var cleanedInput = str.trim();\n    tmpEl.innerHTML = cleanedInput;\n    var firldChild = tmpEl.children[0];\n\n    while (tmpEl.firstChild) {\n      tmpEl.removeChild(tmpEl.firstChild);\n    }\n\n    return firldChild;\n  };\n}();\n/**\n * @param {{ label?: string, value: string }} a\n * @param {{ label?: string, value: string }} b\n * @returns {number}\n */\n\nvar sortByAlpha = function sortByAlpha(_ref, _ref2) {\n  var value = _ref.value,\n      _ref$label = _ref.label,\n      label = _ref$label === void 0 ? value : _ref$label;\n  var value2 = _ref2.value,\n      _ref2$label = _ref2.label,\n      label2 = _ref2$label === void 0 ? value2 : _ref2$label;\n  return label.localeCompare(label2, [], {\n    sensitivity: 'base',\n    ignorePunctuation: true,\n    numeric: true\n  });\n};\n/**\n * @param {{ score: number }} a\n * @param {{ score: number }} b\n */\n\nvar sortByScore = function sortByScore(a, b) {\n  return a.score - b.score;\n};\n/**\n * @param {HTMLElement} element\n * @param {string} type\n * @param {object} customArgs\n */\n\nvar dispatchEvent = function dispatchEvent(element, type, customArgs) {\n  if (customArgs === void 0) {\n    customArgs = null;\n  }\n\n  var event = new CustomEvent(type, {\n    detail: customArgs,\n    bubbles: true,\n    cancelable: true\n  });\n  return element.dispatchEvent(event);\n};\n/**\n * @param {array} array\n * @param {any} value\n * @param {string} [key=\"value\"]\n * @returns {boolean}\n */\n\nvar existsInArray = function existsInArray(array, value, key) {\n  if (key === void 0) {\n    key = 'value';\n  }\n\n  return array.some(function (item) {\n    if (typeof value === 'string') {\n      return item[key] === value.trim();\n    }\n\n    return item[key] === value;\n  });\n};\n/**\n * @param {any} obj\n * @returns {any}\n */\n\nvar cloneObject = function cloneObject(obj) {\n  return JSON.parse(JSON.stringify(obj));\n};\n/**\n * Returns an array of keys present on the first but missing on the second object\n * @param {object} a\n * @param {object} b\n * @returns {string[]}\n */\n\nvar diff = function diff(a, b) {\n  var aKeys = Object.keys(a).sort();\n  var bKeys = Object.keys(b).sort();\n  return aKeys.filter(function (i) {\n    return bKeys.indexOf(i) < 0;\n  });\n};\n// CONCATENATED MODULE: ./src/scripts/reducers/index.js\n\n\n\n\n\n\nvar appReducer = combineReducers({\n  items: items_items,\n  groups: groups,\n  choices: choices_choices,\n  general: reducers_general\n});\n\nvar reducers_rootReducer = function rootReducer(passedState, action) {\n  var state = passedState; // If we are clearing all items, groups and options we reassign\n  // state and then pass that state to our proper reducer. This isn't\n  // mutating our actual state\n  // See: http://stackoverflow.com/a/35641992\n\n  if (action.type === 'CLEAR_ALL') {\n    state = undefined;\n  } else if (action.type === 'RESET_TO') {\n    return cloneObject(action.state);\n  }\n\n  return appReducer(state, action);\n};\n\n/* harmony default export */ var reducers = (reducers_rootReducer);\n// CONCATENATED MODULE: ./src/scripts/store/store.js\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n/**\n * @typedef {import('../../../types/index').Choices.Choice} Choice\n * @typedef {import('../../../types/index').Choices.Group} Group\n * @typedef {import('../../../types/index').Choices.Item} Item\n */\n\nvar store_Store =\n/*#__PURE__*/\nfunction () {\n  function Store() {\n    this._store = createStore(reducers, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__());\n  }\n  /**\n   * Subscribe store to function call (wrapped Redux method)\n   * @param  {Function} onChange Function to trigger when state changes\n   * @return\n   */\n\n\n  var _proto = Store.prototype;\n\n  _proto.subscribe = function subscribe(onChange) {\n    this._store.subscribe(onChange);\n  }\n  /**\n   * Dispatch event to store (wrapped Redux method)\n   * @param  {{ type: string, [x: string]: any }} action Action to trigger\n   * @return\n   */\n  ;\n\n  _proto.dispatch = function dispatch(action) {\n    this._store.dispatch(action);\n  }\n  /**\n   * Get store object (wrapping Redux method)\n   * @returns {object} State\n   */\n  ;\n\n  /**\n   * Get loading state from store\n   * @returns {boolean} Loading State\n   */\n  _proto.isLoading = function isLoading() {\n    return this.state.general.loading;\n  }\n  /**\n   * Get single choice by it's ID\n   * @param {string} id\n   * @returns {Choice | undefined} Found choice\n   */\n  ;\n\n  _proto.getChoiceById = function getChoiceById(id) {\n    return this.activeChoices.find(function (choice) {\n      return choice.id === parseInt(id, 10);\n    });\n  }\n  /**\n   * Get group by group id\n   * @param  {number} id Group ID\n   * @returns {Group | undefined} Group data\n   */\n  ;\n\n  _proto.getGroupById = function getGroupById(id) {\n    return this.groups.find(function (group) {\n      return group.id === id;\n    });\n  };\n\n  _createClass(Store, [{\n    key: \"state\",\n    get: function get() {\n      return this._store.getState();\n    }\n    /**\n     * Get items from store\n     * @returns {Item[]} Item objects\n     */\n\n  }, {\n    key: \"items\",\n    get: function get() {\n      return this.state.items;\n    }\n    /**\n     * Get active items from store\n     * @returns {Item[]} Item objects\n     */\n\n  }, {\n    key: \"activeItems\",\n    get: function get() {\n      return this.items.filter(function (item) {\n        return item.active === true;\n      });\n    }\n    /**\n     * Get highlighted items from store\n     * @returns {Item[]} Item objects\n     */\n\n  }, {\n    key: \"highlightedActiveItems\",\n    get: function get() {\n      return this.items.filter(function (item) {\n        return item.active && item.highlighted;\n      });\n    }\n    /**\n     * Get choices from store\n     * @returns {Choice[]} Option objects\n     */\n\n  }, {\n    key: \"choices\",\n    get: function get() {\n      return this.state.choices;\n    }\n    /**\n     * Get active choices from store\n     * @returns {Choice[]} Option objects\n     */\n\n  }, {\n    key: \"activeChoices\",\n    get: function get() {\n      return this.choices.filter(function (choice) {\n        return choice.active === true;\n      });\n    }\n    /**\n     * Get selectable choices from store\n     * @returns {Choice[]} Option objects\n     */\n\n  }, {\n    key: \"selectableChoices\",\n    get: function get() {\n      return this.choices.filter(function (choice) {\n        return choice.disabled !== true;\n      });\n    }\n    /**\n     * Get choices that can be searched (excluding placeholders)\n     * @returns {Choice[]} Option objects\n     */\n\n  }, {\n    key: \"searchableChoices\",\n    get: function get() {\n      return this.selectableChoices.filter(function (choice) {\n        return choice.placeholder !== true;\n      });\n    }\n    /**\n     * Get placeholder choice from store\n     * @returns {Choice | undefined} Found placeholder\n     */\n\n  }, {\n    key: \"placeholderChoice\",\n    get: function get() {\n      return [].concat(this.choices).reverse().find(function (choice) {\n        return choice.placeholder === true;\n      });\n    }\n    /**\n     * Get groups from store\n     * @returns {Group[]} Group objects\n     */\n\n  }, {\n    key: \"groups\",\n    get: function get() {\n      return this.state.groups;\n    }\n    /**\n     * Get active groups from store\n     * @returns {Group[]} Group objects\n     */\n\n  }, {\n    key: \"activeGroups\",\n    get: function get() {\n      var groups = this.groups,\n          choices = this.choices;\n      return groups.filter(function (group) {\n        var isActive = group.active === true && group.disabled === false;\n        var hasActiveOptions = choices.some(function (choice) {\n          return choice.active === true && choice.disabled === false;\n        });\n        return isActive && hasActiveOptions;\n      }, []);\n    }\n  }]);\n\n  return Store;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/components/dropdown.js\nfunction dropdown_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction dropdown_createClass(Constructor, protoProps, staticProps) { if (protoProps) dropdown_defineProperties(Constructor.prototype, protoProps); if (staticProps) dropdown_defineProperties(Constructor, staticProps); return Constructor; }\n\n/**\n * @typedef {import('../../../types/index').Choices.passedElement} passedElement\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n */\nvar Dropdown =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {{\n   *  element: HTMLElement,\n   *  type: passedElement['type'],\n   *  classNames: ClassNames,\n   * }} args\n   */\n  function Dropdown(_ref) {\n    var element = _ref.element,\n        type = _ref.type,\n        classNames = _ref.classNames;\n    this.element = element;\n    this.classNames = classNames;\n    this.type = type;\n    this.isActive = false;\n  }\n  /**\n   * Bottom position of dropdown in viewport coordinates\n   * @returns {number} Vertical position\n   */\n\n\n  var _proto = Dropdown.prototype;\n\n  /**\n   * Find element that matches passed selector\n   * @param {string} selector\n   * @returns {HTMLElement | null}\n   */\n  _proto.getChild = function getChild(selector) {\n    return this.element.querySelector(selector);\n  }\n  /**\n   * Show dropdown to user by adding active state class\n   * @returns {this}\n   */\n  ;\n\n  _proto.show = function show() {\n    this.element.classList.add(this.classNames.activeState);\n    this.element.setAttribute('aria-expanded', 'true');\n    this.isActive = true;\n    return this;\n  }\n  /**\n   * Hide dropdown from user\n   * @returns {this}\n   */\n  ;\n\n  _proto.hide = function hide() {\n    this.element.classList.remove(this.classNames.activeState);\n    this.element.setAttribute('aria-expanded', 'false');\n    this.isActive = false;\n    return this;\n  };\n\n  dropdown_createClass(Dropdown, [{\n    key: \"distanceFromTopWindow\",\n    get: function get() {\n      return this.element.getBoundingClientRect().bottom;\n    }\n  }]);\n\n  return Dropdown;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/constants.js\n\n/**\n * @typedef {import('../../types/index').Choices.ClassNames} ClassNames\n * @typedef {import('../../types/index').Choices.Options} Options\n */\n\n/** @type {ClassNames} */\n\nvar DEFAULT_CLASSNAMES = {\n  containerOuter: 'choices',\n  containerInner: 'choices__inner',\n  input: 'choices__input',\n  inputCloned: 'choices__input--cloned',\n  list: 'choices__list',\n  listItems: 'choices__list--multiple',\n  listSingle: 'choices__list--single',\n  listDropdown: 'choices__list--dropdown',\n  item: 'choices__item',\n  itemSelectable: 'choices__item--selectable',\n  itemDisabled: 'choices__item--disabled',\n  itemChoice: 'choices__item--choice',\n  placeholder: 'choices__placeholder',\n  group: 'choices__group',\n  groupHeading: 'choices__heading',\n  button: 'choices__button',\n  activeState: 'is-active',\n  focusState: 'is-focused',\n  openState: 'is-open',\n  disabledState: 'is-disabled',\n  highlightedState: 'is-highlighted',\n  selectedState: 'is-selected',\n  flippedState: 'is-flipped',\n  loadingState: 'is-loading',\n  noResults: 'has-no-results',\n  noChoices: 'has-no-choices'\n};\n/** @type {Options} */\n\nvar DEFAULT_CONFIG = {\n  items: [],\n  choices: [],\n  silent: false,\n  renderChoiceLimit: -1,\n  maxItemCount: -1,\n  addItems: true,\n  addItemFilter: null,\n  removeItems: true,\n  removeItemButton: false,\n  editItems: false,\n  duplicateItemsAllowed: true,\n  delimiter: ',',\n  paste: true,\n  searchEnabled: true,\n  searchChoices: true,\n  searchFloor: 1,\n  searchResultLimit: 4,\n  searchFields: ['label', 'value'],\n  position: 'auto',\n  resetScrollPosition: true,\n  shouldSort: true,\n  shouldSortItems: false,\n  sorter: sortByAlpha,\n  placeholder: true,\n  placeholderValue: null,\n  searchPlaceholderValue: null,\n  prependValue: null,\n  appendValue: null,\n  renderSelectedChoices: 'auto',\n  loadingText: 'Loading...',\n  noResultsText: 'No results found',\n  noChoicesText: 'No choices to choose from',\n  itemSelectText: 'Press to select',\n  uniqueItemText: 'Only unique values can be added',\n  customAddItemText: 'Only values matching specific conditions can be added',\n  addItemText: function addItemText(value) {\n    return \"Press Enter to add <b>\\\"\" + sanitise(value) + \"\\\"</b>\";\n  },\n  maxItemText: function maxItemText(maxItemCount) {\n    return \"Only \" + maxItemCount + \" values can be added\";\n  },\n  valueComparer: function valueComparer(value1, value2) {\n    return value1 === value2;\n  },\n  fuseOptions: {\n    includeScore: true\n  },\n  callbackOnInit: null,\n  callbackOnCreateTemplates: null,\n  classNames: DEFAULT_CLASSNAMES\n};\nvar EVENTS = {\n  showDropdown: 'showDropdown',\n  hideDropdown: 'hideDropdown',\n  change: 'change',\n  choice: 'choice',\n  search: 'search',\n  addItem: 'addItem',\n  removeItem: 'removeItem',\n  highlightItem: 'highlightItem',\n  highlightChoice: 'highlightChoice'\n};\nvar ACTION_TYPES = {\n  ADD_CHOICE: 'ADD_CHOICE',\n  FILTER_CHOICES: 'FILTER_CHOICES',\n  ACTIVATE_CHOICES: 'ACTIVATE_CHOICES',\n  CLEAR_CHOICES: 'CLEAR_CHOICES',\n  ADD_GROUP: 'ADD_GROUP',\n  ADD_ITEM: 'ADD_ITEM',\n  REMOVE_ITEM: 'REMOVE_ITEM',\n  HIGHLIGHT_ITEM: 'HIGHLIGHT_ITEM',\n  CLEAR_ALL: 'CLEAR_ALL'\n};\nvar KEY_CODES = {\n  BACK_KEY: 46,\n  DELETE_KEY: 8,\n  ENTER_KEY: 13,\n  A_KEY: 65,\n  ESC_KEY: 27,\n  UP_KEY: 38,\n  DOWN_KEY: 40,\n  PAGE_UP_KEY: 33,\n  PAGE_DOWN_KEY: 34\n};\nvar TEXT_TYPE = 'text';\nvar SELECT_ONE_TYPE = 'select-one';\nvar SELECT_MULTIPLE_TYPE = 'select-multiple';\nvar SCROLLING_SPEED = 4;\n// CONCATENATED MODULE: ./src/scripts/components/container.js\n\n\n/**\n * @typedef {import('../../../types/index').Choices.passedElement} passedElement\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n */\n\nvar container_Container =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {{\n   *  element: HTMLElement,\n   *  type: passedElement['type'],\n   *  classNames: ClassNames,\n   *  position\n   * }} args\n   */\n  function Container(_ref) {\n    var element = _ref.element,\n        type = _ref.type,\n        classNames = _ref.classNames,\n        position = _ref.position;\n    this.element = element;\n    this.classNames = classNames;\n    this.type = type;\n    this.position = position;\n    this.isOpen = false;\n    this.isFlipped = false;\n    this.isFocussed = false;\n    this.isDisabled = false;\n    this.isLoading = false;\n    this._onFocus = this._onFocus.bind(this);\n    this._onBlur = this._onBlur.bind(this);\n  }\n\n  var _proto = Container.prototype;\n\n  _proto.addEventListeners = function addEventListeners() {\n    this.element.addEventListener('focus', this._onFocus);\n    this.element.addEventListener('blur', this._onBlur);\n  };\n\n  _proto.removeEventListeners = function removeEventListeners() {\n    this.element.removeEventListener('focus', this._onFocus);\n    this.element.removeEventListener('blur', this._onBlur);\n  }\n  /**\n   * Determine whether container should be flipped based on passed\n   * dropdown position\n   * @param {number} dropdownPos\n   * @returns {boolean}\n   */\n  ;\n\n  _proto.shouldFlip = function shouldFlip(dropdownPos) {\n    if (typeof dropdownPos !== 'number') {\n      return false;\n    } // If flip is enabled and the dropdown bottom position is\n    // greater than the window height flip the dropdown.\n\n\n    var shouldFlip = false;\n\n    if (this.position === 'auto') {\n      shouldFlip = !window.matchMedia(\"(min-height: \" + (dropdownPos + 1) + \"px)\").matches;\n    } else if (this.position === 'top') {\n      shouldFlip = true;\n    }\n\n    return shouldFlip;\n  }\n  /**\n   * @param {string} activeDescendantID\n   */\n  ;\n\n  _proto.setActiveDescendant = function setActiveDescendant(activeDescendantID) {\n    this.element.setAttribute('aria-activedescendant', activeDescendantID);\n  };\n\n  _proto.removeActiveDescendant = function removeActiveDescendant() {\n    this.element.removeAttribute('aria-activedescendant');\n  }\n  /**\n   * @param {number} dropdownPos\n   */\n  ;\n\n  _proto.open = function open(dropdownPos) {\n    this.element.classList.add(this.classNames.openState);\n    this.element.setAttribute('aria-expanded', 'true');\n    this.isOpen = true;\n\n    if (this.shouldFlip(dropdownPos)) {\n      this.element.classList.add(this.classNames.flippedState);\n      this.isFlipped = true;\n    }\n  };\n\n  _proto.close = function close() {\n    this.element.classList.remove(this.classNames.openState);\n    this.element.setAttribute('aria-expanded', 'false');\n    this.removeActiveDescendant();\n    this.isOpen = false; // A dropdown flips if it does not have space within the page\n\n    if (this.isFlipped) {\n      this.element.classList.remove(this.classNames.flippedState);\n      this.isFlipped = false;\n    }\n  };\n\n  _proto.focus = function focus() {\n    if (!this.isFocussed) {\n      this.element.focus();\n    }\n  };\n\n  _proto.addFocusState = function addFocusState() {\n    this.element.classList.add(this.classNames.focusState);\n  };\n\n  _proto.removeFocusState = function removeFocusState() {\n    this.element.classList.remove(this.classNames.focusState);\n  };\n\n  _proto.enable = function enable() {\n    this.element.classList.remove(this.classNames.disabledState);\n    this.element.removeAttribute('aria-disabled');\n\n    if (this.type === SELECT_ONE_TYPE) {\n      this.element.setAttribute('tabindex', '0');\n    }\n\n    this.isDisabled = false;\n  };\n\n  _proto.disable = function disable() {\n    this.element.classList.add(this.classNames.disabledState);\n    this.element.setAttribute('aria-disabled', 'true');\n\n    if (this.type === SELECT_ONE_TYPE) {\n      this.element.setAttribute('tabindex', '-1');\n    }\n\n    this.isDisabled = true;\n  }\n  /**\n   * @param {HTMLElement} element\n   */\n  ;\n\n  _proto.wrap = function wrap(element) {\n    utils_wrap(element, this.element);\n  }\n  /**\n   * @param {Element} element\n   */\n  ;\n\n  _proto.unwrap = function unwrap(element) {\n    // Move passed element outside this element\n    this.element.parentNode.insertBefore(element, this.element); // Remove this element\n\n    this.element.parentNode.removeChild(this.element);\n  };\n\n  _proto.addLoadingState = function addLoadingState() {\n    this.element.classList.add(this.classNames.loadingState);\n    this.element.setAttribute('aria-busy', 'true');\n    this.isLoading = true;\n  };\n\n  _proto.removeLoadingState = function removeLoadingState() {\n    this.element.classList.remove(this.classNames.loadingState);\n    this.element.removeAttribute('aria-busy');\n    this.isLoading = false;\n  };\n\n  _proto._onFocus = function _onFocus() {\n    this.isFocussed = true;\n  };\n\n  _proto._onBlur = function _onBlur() {\n    this.isFocussed = false;\n  };\n\n  return Container;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/components/input.js\nfunction input_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction input_createClass(Constructor, protoProps, staticProps) { if (protoProps) input_defineProperties(Constructor.prototype, protoProps); if (staticProps) input_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n/**\n * @typedef {import('../../../types/index').Choices.passedElement} passedElement\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n */\n\nvar input_Input =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {{\n   *  element: HTMLInputElement,\n   *  type: passedElement['type'],\n   *  classNames: ClassNames,\n   *  preventPaste: boolean\n   * }} args\n   */\n  function Input(_ref) {\n    var element = _ref.element,\n        type = _ref.type,\n        classNames = _ref.classNames,\n        preventPaste = _ref.preventPaste;\n    this.element = element;\n    this.type = type;\n    this.classNames = classNames;\n    this.preventPaste = preventPaste;\n    this.isFocussed = this.element === document.activeElement;\n    this.isDisabled = element.disabled;\n    this._onPaste = this._onPaste.bind(this);\n    this._onInput = this._onInput.bind(this);\n    this._onFocus = this._onFocus.bind(this);\n    this._onBlur = this._onBlur.bind(this);\n  }\n  /**\n   * @param {string} placeholder\n   */\n\n\n  var _proto = Input.prototype;\n\n  _proto.addEventListeners = function addEventListeners() {\n    this.element.addEventListener('paste', this._onPaste);\n    this.element.addEventListener('input', this._onInput, {\n      passive: true\n    });\n    this.element.addEventListener('focus', this._onFocus, {\n      passive: true\n    });\n    this.element.addEventListener('blur', this._onBlur, {\n      passive: true\n    });\n  };\n\n  _proto.removeEventListeners = function removeEventListeners() {\n    this.element.removeEventListener('input', this._onInput, {\n      passive: true\n    });\n    this.element.removeEventListener('paste', this._onPaste);\n    this.element.removeEventListener('focus', this._onFocus, {\n      passive: true\n    });\n    this.element.removeEventListener('blur', this._onBlur, {\n      passive: true\n    });\n  };\n\n  _proto.enable = function enable() {\n    this.element.removeAttribute('disabled');\n    this.isDisabled = false;\n  };\n\n  _proto.disable = function disable() {\n    this.element.setAttribute('disabled', '');\n    this.isDisabled = true;\n  };\n\n  _proto.focus = function focus() {\n    if (!this.isFocussed) {\n      this.element.focus();\n    }\n  };\n\n  _proto.blur = function blur() {\n    if (this.isFocussed) {\n      this.element.blur();\n    }\n  }\n  /**\n   * Set value of input to blank\n   * @param {boolean} setWidth\n   * @returns {this}\n   */\n  ;\n\n  _proto.clear = function clear(setWidth) {\n    if (setWidth === void 0) {\n      setWidth = true;\n    }\n\n    if (this.element.value) {\n      this.element.value = '';\n    }\n\n    if (setWidth) {\n      this.setWidth();\n    }\n\n    return this;\n  }\n  /**\n   * Set the correct input width based on placeholder\n   * value or input value\n   */\n  ;\n\n  _proto.setWidth = function setWidth() {\n    // Resize input to contents or placeholder\n    var _this$element = this.element,\n        style = _this$element.style,\n        value = _this$element.value,\n        placeholder = _this$element.placeholder;\n    style.minWidth = placeholder.length + 1 + \"ch\";\n    style.width = value.length + 1 + \"ch\";\n  }\n  /**\n   * @param {string} activeDescendantID\n   */\n  ;\n\n  _proto.setActiveDescendant = function setActiveDescendant(activeDescendantID) {\n    this.element.setAttribute('aria-activedescendant', activeDescendantID);\n  };\n\n  _proto.removeActiveDescendant = function removeActiveDescendant() {\n    this.element.removeAttribute('aria-activedescendant');\n  };\n\n  _proto._onInput = function _onInput() {\n    if (this.type !== SELECT_ONE_TYPE) {\n      this.setWidth();\n    }\n  }\n  /**\n   * @param {Event} event\n   */\n  ;\n\n  _proto._onPaste = function _onPaste(event) {\n    if (this.preventPaste) {\n      event.preventDefault();\n    }\n  };\n\n  _proto._onFocus = function _onFocus() {\n    this.isFocussed = true;\n  };\n\n  _proto._onBlur = function _onBlur() {\n    this.isFocussed = false;\n  };\n\n  input_createClass(Input, [{\n    key: \"placeholder\",\n    set: function set(placeholder) {\n      this.element.placeholder = placeholder;\n    }\n    /**\n     * @returns {string}\n     */\n\n  }, {\n    key: \"value\",\n    get: function get() {\n      return sanitise(this.element.value);\n    }\n    /**\n     * @param {string} value\n     */\n    ,\n    set: function set(value) {\n      this.element.value = value;\n    }\n  }]);\n\n  return Input;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/components/list.js\n\n/**\n * @typedef {import('../../../types/index').Choices.Choice} Choice\n */\n\nvar list_List =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {{ element: HTMLElement }} args\n   */\n  function List(_ref) {\n    var element = _ref.element;\n    this.element = element;\n    this.scrollPos = this.element.scrollTop;\n    this.height = this.element.offsetHeight;\n  }\n\n  var _proto = List.prototype;\n\n  _proto.clear = function clear() {\n    this.element.innerHTML = '';\n  }\n  /**\n   * @param {Element | DocumentFragment} node\n   */\n  ;\n\n  _proto.append = function append(node) {\n    this.element.appendChild(node);\n  }\n  /**\n   * @param {string} selector\n   * @returns {Element | null}\n   */\n  ;\n\n  _proto.getChild = function getChild(selector) {\n    return this.element.querySelector(selector);\n  }\n  /**\n   * @returns {boolean}\n   */\n  ;\n\n  _proto.hasChildren = function hasChildren() {\n    return this.element.hasChildNodes();\n  };\n\n  _proto.scrollToTop = function scrollToTop() {\n    this.element.scrollTop = 0;\n  }\n  /**\n   * @param {Element} element\n   * @param {1 | -1} direction\n   */\n  ;\n\n  _proto.scrollToChildElement = function scrollToChildElement(element, direction) {\n    var _this = this;\n\n    if (!element) {\n      return;\n    }\n\n    var listHeight = this.element.offsetHeight; // Scroll position of dropdown\n\n    var listScrollPosition = this.element.scrollTop + listHeight;\n    var elementHeight = element.offsetHeight; // Distance from bottom of element to top of parent\n\n    var elementPos = element.offsetTop + elementHeight; // Difference between the element and scroll position\n\n    var destination = direction > 0 ? this.element.scrollTop + elementPos - listScrollPosition : element.offsetTop;\n    requestAnimationFrame(function () {\n      _this._animateScroll(destination, direction);\n    });\n  }\n  /**\n   * @param {number} scrollPos\n   * @param {number} strength\n   * @param {number} destination\n   */\n  ;\n\n  _proto._scrollDown = function _scrollDown(scrollPos, strength, destination) {\n    var easing = (destination - scrollPos) / strength;\n    var distance = easing > 1 ? easing : 1;\n    this.element.scrollTop = scrollPos + distance;\n  }\n  /**\n   * @param {number} scrollPos\n   * @param {number} strength\n   * @param {number} destination\n   */\n  ;\n\n  _proto._scrollUp = function _scrollUp(scrollPos, strength, destination) {\n    var easing = (scrollPos - destination) / strength;\n    var distance = easing > 1 ? easing : 1;\n    this.element.scrollTop = scrollPos - distance;\n  }\n  /**\n   * @param {*} destination\n   * @param {*} direction\n   */\n  ;\n\n  _proto._animateScroll = function _animateScroll(destination, direction) {\n    var _this2 = this;\n\n    var strength = SCROLLING_SPEED;\n    var choiceListScrollTop = this.element.scrollTop;\n    var continueAnimation = false;\n\n    if (direction > 0) {\n      this._scrollDown(choiceListScrollTop, strength, destination);\n\n      if (choiceListScrollTop < destination) {\n        continueAnimation = true;\n      }\n    } else {\n      this._scrollUp(choiceListScrollTop, strength, destination);\n\n      if (choiceListScrollTop > destination) {\n        continueAnimation = true;\n      }\n    }\n\n    if (continueAnimation) {\n      requestAnimationFrame(function () {\n        _this2._animateScroll(destination, direction);\n      });\n    }\n  };\n\n  return List;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/components/wrapped-element.js\nfunction wrapped_element_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction wrapped_element_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_element_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_element_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n/**\n * @typedef {import('../../../types/index').Choices.passedElement} passedElement\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n */\n\nvar wrapped_element_WrappedElement =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param {{\n   *  element: HTMLInputElement | HTMLSelectElement,\n   *  classNames: ClassNames,\n   * }} args\n   */\n  function WrappedElement(_ref) {\n    var element = _ref.element,\n        classNames = _ref.classNames;\n    this.element = element;\n    this.classNames = classNames;\n\n    if (!(element instanceof HTMLInputElement) && !(element instanceof HTMLSelectElement)) {\n      throw new TypeError('Invalid element passed');\n    }\n\n    this.isDisabled = false;\n  }\n\n  var _proto = WrappedElement.prototype;\n\n  _proto.conceal = function conceal() {\n    // Hide passed input\n    this.element.classList.add(this.classNames.input);\n    this.element.hidden = true; // Remove element from tab index\n\n    this.element.tabIndex = -1; // Backup original styles if any\n\n    var origStyle = this.element.getAttribute('style');\n\n    if (origStyle) {\n      this.element.setAttribute('data-choice-orig-style', origStyle);\n    }\n\n    this.element.setAttribute('data-choice', 'active');\n  };\n\n  _proto.reveal = function reveal() {\n    // Reinstate passed element\n    this.element.classList.remove(this.classNames.input);\n    this.element.hidden = false;\n    this.element.removeAttribute('tabindex'); // Recover original styles if any\n\n    var origStyle = this.element.getAttribute('data-choice-orig-style');\n\n    if (origStyle) {\n      this.element.removeAttribute('data-choice-orig-style');\n      this.element.setAttribute('style', origStyle);\n    } else {\n      this.element.removeAttribute('style');\n    }\n\n    this.element.removeAttribute('data-choice'); // Re-assign values - this is weird, I know\n    // @todo Figure out why we need to do this\n\n    this.element.value = this.element.value; // eslint-disable-line no-self-assign\n  };\n\n  _proto.enable = function enable() {\n    this.element.removeAttribute('disabled');\n    this.element.disabled = false;\n    this.isDisabled = false;\n  };\n\n  _proto.disable = function disable() {\n    this.element.setAttribute('disabled', '');\n    this.element.disabled = true;\n    this.isDisabled = true;\n  };\n\n  _proto.triggerEvent = function triggerEvent(eventType, data) {\n    dispatchEvent(this.element, eventType, data);\n  };\n\n  wrapped_element_createClass(WrappedElement, [{\n    key: \"isActive\",\n    get: function get() {\n      return this.element.dataset.choice === 'active';\n    }\n  }, {\n    key: \"dir\",\n    get: function get() {\n      return this.element.dir;\n    }\n  }, {\n    key: \"value\",\n    get: function get() {\n      return this.element.value;\n    },\n    set: function set(value) {\n      // you must define setter here otherwise it will be readonly property\n      this.element.value = value;\n    }\n  }]);\n\n  return WrappedElement;\n}();\n\n\n// CONCATENATED MODULE: ./src/scripts/components/wrapped-input.js\nfunction wrapped_input_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction wrapped_input_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_input_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_input_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\n\n/**\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n * @typedef {import('../../../types/index').Choices.Item} Item\n */\n\nvar WrappedInput =\n/*#__PURE__*/\nfunction (_WrappedElement) {\n  _inheritsLoose(WrappedInput, _WrappedElement);\n\n  /**\n   * @param {{\n   *  element: HTMLInputElement,\n   *  classNames: ClassNames,\n   *  delimiter: string\n   * }} args\n   */\n  function WrappedInput(_ref) {\n    var _this;\n\n    var element = _ref.element,\n        classNames = _ref.classNames,\n        delimiter = _ref.delimiter;\n    _this = _WrappedElement.call(this, {\n      element: element,\n      classNames: classNames\n    }) || this;\n    _this.delimiter = delimiter;\n    return _this;\n  }\n  /**\n   * @returns {string}\n   */\n\n\n  wrapped_input_createClass(WrappedInput, [{\n    key: \"value\",\n    get: function get() {\n      return this.element.value;\n    }\n    /**\n     * @param {Item[]} items\n     */\n    ,\n    set: function set(items) {\n      var itemValues = items.map(function (_ref2) {\n        var value = _ref2.value;\n        return value;\n      });\n      var joinedValues = itemValues.join(this.delimiter);\n      this.element.setAttribute('value', joinedValues);\n      this.element.value = joinedValues;\n    }\n  }]);\n\n  return WrappedInput;\n}(wrapped_element_WrappedElement);\n\n\n// CONCATENATED MODULE: ./src/scripts/components/wrapped-select.js\nfunction wrapped_select_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction wrapped_select_createClass(Constructor, protoProps, staticProps) { if (protoProps) wrapped_select_defineProperties(Constructor.prototype, protoProps); if (staticProps) wrapped_select_defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction wrapped_select_inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\n\n/**\n * @typedef {import('../../../types/index').Choices.ClassNames} ClassNames\n * @typedef {import('../../../types/index').Choices.Item} Item\n * @typedef {import('../../../types/index').Choices.Choice} Choice\n */\n\nvar WrappedSelect =\n/*#__PURE__*/\nfunction (_WrappedElement) {\n  wrapped_select_inheritsLoose(WrappedSelect, _WrappedElement);\n\n  /**\n   * @param {{\n   *  element: HTMLSelectElement,\n   *  classNames: ClassNames,\n   *  delimiter: string\n   *  template: function\n   * }} args\n   */\n  function WrappedSelect(_ref) {\n    var _this;\n\n    var element = _ref.element,\n        classNames = _ref.classNames,\n        template = _ref.template;\n    _this = _WrappedElement.call(this, {\n      element: element,\n      classNames: classNames\n    }) || this;\n    _this.template = template;\n    return _this;\n  }\n\n  var _proto = WrappedSelect.prototype;\n\n  /**\n   * @param {DocumentFragment} fragment\n   */\n  _proto.appendDocFragment = function appendDocFragment(fragment) {\n    this.element.innerHTML = '';\n    this.element.appendChild(fragment);\n  };\n\n  wrapped_select_createClass(WrappedSelect, [{\n    key: \"placeholderOption\",\n    get: function get() {\n      return this.element.querySelector('option[value=\"\"]') || // Backward compatibility layer for the non-standard placeholder attribute supported in older versions.\n      this.element.querySelector('option[placeholder]');\n    }\n    /**\n     * @returns {Element[]}\n     */\n\n  }, {\n    key: \"optionGroups\",\n    get: function get() {\n      return Array.from(this.element.getElementsByTagName('OPTGROUP'));\n    }\n    /**\n     * @returns {Item[] | Choice[]}\n     */\n\n  }, {\n    key: \"options\",\n    get: function get() {\n      return Array.from(this.element.options);\n    }\n    /**\n     * @param {Item[] | Choice[]} options\n     */\n    ,\n    set: function set(options) {\n      var _this2 = this;\n\n      var fragment = document.createDocumentFragment();\n\n      var addOptionToFragment = function addOptionToFragment(data) {\n        // Create a standard select option\n        var option = _this2.template(data); // Append it to fragment\n\n\n        fragment.appendChild(option);\n      }; // Add each list item to list\n\n\n      options.forEach(function (optionData) {\n        return addOptionToFragment(optionData);\n      });\n      this.appendDocFragment(fragment);\n    }\n  }]);\n\n  return WrappedSelect;\n}(wrapped_element_WrappedElement);\n\n\n// CONCATENATED MODULE: ./src/scripts/components/index.js\n\n\n\n\n\n\n\n// CONCATENATED MODULE: ./src/scripts/templates.js\n/**\n * Helpers to create HTML elements used by Choices\n * Can be overridden by providing `callbackOnCreateTemplates` option\n * @typedef {import('../../types/index').Choices.Templates} Templates\n * @typedef {import('../../types/index').Choices.ClassNames} ClassNames\n * @typedef {import('../../types/index').Choices.Options} Options\n * @typedef {import('../../types/index').Choices.Item} Item\n * @typedef {import('../../types/index').Choices.Choice} Choice\n * @typedef {import('../../types/index').Choices.Group} Group\n */\nvar TEMPLATES =\n/** @type {Templates} */\n{\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {\"ltr\" | \"rtl\" | \"auto\"} dir\n   * @param {boolean} isSelectElement\n   * @param {boolean} isSelectOneElement\n   * @param {boolean} searchEnabled\n   * @param {\"select-one\" | \"select-multiple\" | \"text\"} passedElementType\n   */\n  containerOuter: function containerOuter(_ref, dir, isSelectElement, isSelectOneElement, searchEnabled, passedElementType) {\n    var _containerOuter = _ref.containerOuter;\n    var div = Object.assign(document.createElement('div'), {\n      className: _containerOuter\n    });\n    div.dataset.type = passedElementType;\n\n    if (dir) {\n      div.dir = dir;\n    }\n\n    if (isSelectOneElement) {\n      div.tabIndex = 0;\n    }\n\n    if (isSelectElement) {\n      div.setAttribute('role', searchEnabled ? 'combobox' : 'listbox');\n\n      if (searchEnabled) {\n        div.setAttribute('aria-autocomplete', 'list');\n      }\n    }\n\n    div.setAttribute('aria-haspopup', 'true');\n    div.setAttribute('aria-expanded', 'false');\n    return div;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   */\n  containerInner: function containerInner(_ref2) {\n    var _containerInner = _ref2.containerInner;\n    return Object.assign(document.createElement('div'), {\n      className: _containerInner\n    });\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {boolean} isSelectOneElement\n   */\n  itemList: function itemList(_ref3, isSelectOneElement) {\n    var list = _ref3.list,\n        listSingle = _ref3.listSingle,\n        listItems = _ref3.listItems;\n    return Object.assign(document.createElement('div'), {\n      className: list + \" \" + (isSelectOneElement ? listSingle : listItems)\n    });\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {string} value\n   */\n  placeholder: function placeholder(_ref4, value) {\n    var _placeholder = _ref4.placeholder;\n    return Object.assign(document.createElement('div'), {\n      className: _placeholder,\n      innerHTML: value\n    });\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {Item} item\n   * @param {boolean} removeItemButton\n   */\n  item: function item(_ref5, _ref6, removeItemButton) {\n    var _item = _ref5.item,\n        button = _ref5.button,\n        highlightedState = _ref5.highlightedState,\n        itemSelectable = _ref5.itemSelectable,\n        placeholder = _ref5.placeholder;\n    var id = _ref6.id,\n        value = _ref6.value,\n        label = _ref6.label,\n        customProperties = _ref6.customProperties,\n        active = _ref6.active,\n        disabled = _ref6.disabled,\n        highlighted = _ref6.highlighted,\n        isPlaceholder = _ref6.placeholder;\n    var div = Object.assign(document.createElement('div'), {\n      className: _item,\n      innerHTML: label\n    });\n    Object.assign(div.dataset, {\n      item: '',\n      id: id,\n      value: value,\n      customProperties: customProperties\n    });\n\n    if (active) {\n      div.setAttribute('aria-selected', 'true');\n    }\n\n    if (disabled) {\n      div.setAttribute('aria-disabled', 'true');\n    }\n\n    if (isPlaceholder) {\n      div.classList.add(placeholder);\n    }\n\n    div.classList.add(highlighted ? highlightedState : itemSelectable);\n\n    if (removeItemButton) {\n      if (disabled) {\n        div.classList.remove(itemSelectable);\n      }\n\n      div.dataset.deletable = '';\n      /** @todo This MUST be localizable, not hardcoded! */\n\n      var REMOVE_ITEM_TEXT = 'Remove item';\n      var removeButton = Object.assign(document.createElement('button'), {\n        type: 'button',\n        className: button,\n        innerHTML: REMOVE_ITEM_TEXT\n      });\n      removeButton.setAttribute('aria-label', REMOVE_ITEM_TEXT + \": '\" + value + \"'\");\n      removeButton.dataset.button = '';\n      div.appendChild(removeButton);\n    }\n\n    return div;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {boolean} isSelectOneElement\n   */\n  choiceList: function choiceList(_ref7, isSelectOneElement) {\n    var list = _ref7.list;\n    var div = Object.assign(document.createElement('div'), {\n      className: list\n    });\n\n    if (!isSelectOneElement) {\n      div.setAttribute('aria-multiselectable', 'true');\n    }\n\n    div.setAttribute('role', 'listbox');\n    return div;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {Group} group\n   */\n  choiceGroup: function choiceGroup(_ref8, _ref9) {\n    var group = _ref8.group,\n        groupHeading = _ref8.groupHeading,\n        itemDisabled = _ref8.itemDisabled;\n    var id = _ref9.id,\n        value = _ref9.value,\n        disabled = _ref9.disabled;\n    var div = Object.assign(document.createElement('div'), {\n      className: group + \" \" + (disabled ? itemDisabled : '')\n    });\n    div.setAttribute('role', 'group');\n    Object.assign(div.dataset, {\n      group: '',\n      id: id,\n      value: value\n    });\n\n    if (disabled) {\n      div.setAttribute('aria-disabled', 'true');\n    }\n\n    div.appendChild(Object.assign(document.createElement('div'), {\n      className: groupHeading,\n      innerHTML: value\n    }));\n    return div;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {Choice} choice\n   * @param {Options['itemSelectText']} selectText\n   */\n  choice: function choice(_ref10, _ref11, selectText) {\n    var item = _ref10.item,\n        itemChoice = _ref10.itemChoice,\n        itemSelectable = _ref10.itemSelectable,\n        selectedState = _ref10.selectedState,\n        itemDisabled = _ref10.itemDisabled,\n        placeholder = _ref10.placeholder;\n    var id = _ref11.id,\n        value = _ref11.value,\n        label = _ref11.label,\n        groupId = _ref11.groupId,\n        elementId = _ref11.elementId,\n        isDisabled = _ref11.disabled,\n        isSelected = _ref11.selected,\n        isPlaceholder = _ref11.placeholder;\n    var div = Object.assign(document.createElement('div'), {\n      id: elementId,\n      innerHTML: label,\n      className: item + \" \" + itemChoice\n    });\n\n    if (isSelected) {\n      div.classList.add(selectedState);\n    }\n\n    if (isPlaceholder) {\n      div.classList.add(placeholder);\n    }\n\n    div.setAttribute('role', groupId > 0 ? 'treeitem' : 'option');\n    Object.assign(div.dataset, {\n      choice: '',\n      id: id,\n      value: value,\n      selectText: selectText\n    });\n\n    if (isDisabled) {\n      div.classList.add(itemDisabled);\n      div.dataset.choiceDisabled = '';\n      div.setAttribute('aria-disabled', 'true');\n    } else {\n      div.classList.add(itemSelectable);\n      div.dataset.choiceSelectable = '';\n    }\n\n    return div;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   * @param {string} placeholderValue\n   */\n  input: function input(_ref12, placeholderValue) {\n    var _input = _ref12.input,\n        inputCloned = _ref12.inputCloned;\n    var inp = Object.assign(document.createElement('input'), {\n      type: 'text',\n      className: _input + \" \" + inputCloned,\n      autocomplete: 'off',\n      autocapitalize: 'off',\n      spellcheck: false\n    });\n    inp.setAttribute('role', 'textbox');\n    inp.setAttribute('aria-autocomplete', 'list');\n    inp.setAttribute('aria-label', placeholderValue);\n    return inp;\n  },\n\n  /**\n   * @param {Partial<ClassNames>} classNames\n   */\n  dropdown: function dropdown(_ref13) {\n    var list = _ref13.list,\n        listDropdown = _ref13.listDropdown;\n    var div = document.createElement('div');\n    div.classList.add(list, listDropdown);\n    div.setAttribute('aria-expanded', 'false');\n    return div;\n  },\n\n  /**\n   *\n   * @param {Partial<ClassNames>} classNames\n   * @param {string} innerHTML\n   * @param {\"no-choices\" | \"no-results\" | \"\"} type\n   */\n  notice: function notice(_ref14, innerHTML, type) {\n    var item = _ref14.item,\n        itemChoice = _ref14.itemChoice,\n        noResults = _ref14.noResults,\n        noChoices = _ref14.noChoices;\n\n    if (type === void 0) {\n      type = '';\n    }\n\n    var classes = [item, itemChoice];\n\n    if (type === 'no-choices') {\n      classes.push(noChoices);\n    } else if (type === 'no-results') {\n      classes.push(noResults);\n    }\n\n    return Object.assign(document.createElement('div'), {\n      innerHTML: innerHTML,\n      className: classes.join(' ')\n    });\n  },\n\n  /**\n   * @param {Item} option\n   */\n  option: function option(_ref15) {\n    var label = _ref15.label,\n        value = _ref15.value,\n        customProperties = _ref15.customProperties,\n        active = _ref15.active,\n        disabled = _ref15.disabled;\n    var opt = new Option(label, value, false, active);\n\n    if (customProperties) {\n      opt.dataset.customProperties = customProperties;\n    }\n\n    opt.disabled = disabled;\n    return opt;\n  }\n};\n/* harmony default export */ var templates = (TEMPLATES);\n// CONCATENATED MODULE: ./src/scripts/actions/choices.js\n/**\n * @typedef {import('redux').Action} Action\n * @typedef {import('../../../types/index').Choices.Choice} Choice\n */\n\n/**\n * @argument {Choice} choice\n * @returns {Action & Choice}\n */\n\nvar choices_addChoice = function addChoice(_ref) {\n  var value = _ref.value,\n      label = _ref.label,\n      id = _ref.id,\n      groupId = _ref.groupId,\n      disabled = _ref.disabled,\n      elementId = _ref.elementId,\n      customProperties = _ref.customProperties,\n      placeholder = _ref.placeholder,\n      keyCode = _ref.keyCode;\n  return {\n    type: ACTION_TYPES.ADD_CHOICE,\n    value: value,\n    label: label,\n    id: id,\n    groupId: groupId,\n    disabled: disabled,\n    elementId: elementId,\n    customProperties: customProperties,\n    placeholder: placeholder,\n    keyCode: keyCode\n  };\n};\n/**\n * @argument {Choice[]} results\n * @returns {Action & { results: Choice[] }}\n */\n\nvar choices_filterChoices = function filterChoices(results) {\n  return {\n    type: ACTION_TYPES.FILTER_CHOICES,\n    results: results\n  };\n};\n/**\n * @argument {boolean} active\n * @returns {Action & { active: boolean }}\n */\n\nvar choices_activateChoices = function activateChoices(active) {\n  if (active === void 0) {\n    active = true;\n  }\n\n  return {\n    type: ACTION_TYPES.ACTIVATE_CHOICES,\n    active: active\n  };\n};\n/**\n * @returns {Action}\n */\n\nvar choices_clearChoices = function clearChoices() {\n  return {\n    type: ACTION_TYPES.CLEAR_CHOICES\n  };\n};\n// CONCATENATED MODULE: ./src/scripts/actions/items.js\n\n/**\n * @typedef {import('redux').Action} Action\n * @typedef {import('../../../types/index').Choices.Item} Item\n */\n\n/**\n * @param {Item} item\n * @returns {Action & Item}\n */\n\nvar items_addItem = function addItem(_ref) {\n  var value = _ref.value,\n      label = _ref.label,\n      id = _ref.id,\n      choiceId = _ref.choiceId,\n      groupId = _ref.groupId,\n      customProperties = _ref.customProperties,\n      placeholder = _ref.placeholder,\n      keyCode = _ref.keyCode;\n  return {\n    type: ACTION_TYPES.ADD_ITEM,\n    value: value,\n    label: label,\n    id: id,\n    choiceId: choiceId,\n    groupId: groupId,\n    customProperties: customProperties,\n    placeholder: placeholder,\n    keyCode: keyCode\n  };\n};\n/**\n * @param {string} id\n * @param {string} choiceId\n * @returns {Action & { id: string, choiceId: string }}\n */\n\nvar items_removeItem = function removeItem(id, choiceId) {\n  return {\n    type: ACTION_TYPES.REMOVE_ITEM,\n    id: id,\n    choiceId: choiceId\n  };\n};\n/**\n * @param {string} id\n * @param {boolean} highlighted\n * @returns {Action & { id: string, highlighted: boolean }}\n */\n\nvar items_highlightItem = function highlightItem(id, highlighted) {\n  return {\n    type: ACTION_TYPES.HIGHLIGHT_ITEM,\n    id: id,\n    highlighted: highlighted\n  };\n};\n// CONCATENATED MODULE: ./src/scripts/actions/groups.js\n\n/**\n * @typedef {import('redux').Action} Action\n * @typedef {import('../../../types/index').Choices.Group} Group\n */\n\n/**\n * @param {Group} group\n * @returns {Action & Group}\n */\n\nvar groups_addGroup = function addGroup(_ref) {\n  var value = _ref.value,\n      id = _ref.id,\n      active = _ref.active,\n      disabled = _ref.disabled;\n  return {\n    type: ACTION_TYPES.ADD_GROUP,\n    value: value,\n    id: id,\n    active: active,\n    disabled: disabled\n  };\n};\n// CONCATENATED MODULE: ./src/scripts/actions/misc.js\n/**\n * @typedef {import('redux').Action} Action\n */\n\n/**\n * @returns {Action}\n */\nvar clearAll = function clearAll() {\n  return {\n    type: 'CLEAR_ALL'\n  };\n};\n/**\n * @param {any} state\n * @returns {Action & { state: object }}\n */\n\nvar resetTo = function resetTo(state) {\n  return {\n    type: 'RESET_TO',\n    state: state\n  };\n};\n/**\n * @param {boolean} isLoading\n * @returns {Action & { isLoading: boolean }}\n */\n\nvar setIsLoading = function setIsLoading(isLoading) {\n  return {\n    type: 'SET_IS_LOADING',\n    isLoading: isLoading\n  };\n};\n// CONCATENATED MODULE: ./src/scripts/choices.js\nfunction choices_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction choices_createClass(Constructor, protoProps, staticProps) { if (protoProps) choices_defineProperties(Constructor.prototype, protoProps); if (staticProps) choices_defineProperties(Constructor, staticProps); return Constructor; }\n\n\n\n\n\n\n\n\n\n\n\n\n/** @see {@link http://browserhacks.com/#hack-acea075d0ac6954f275a70023906050c} */\n\nvar IS_IE11 = '-ms-scroll-limit' in document.documentElement.style && '-ms-ime-align' in document.documentElement.style;\n/**\n * @typedef {import('../../types/index').Choices.Choice} Choice\n * @typedef {import('../../types/index').Choices.Item} Item\n * @typedef {import('../../types/index').Choices.Group} Group\n * @typedef {import('../../types/index').Choices.Options} Options\n */\n\n/** @type {Partial<Options>} */\n\nvar USER_DEFAULTS = {};\n/**\n * Choices\n * @author Josh Johnson<josh@joshuajohnson.co.uk>\n */\n\nvar choices_Choices =\n/*#__PURE__*/\nfunction () {\n  choices_createClass(Choices, null, [{\n    key: \"defaults\",\n    get: function get() {\n      return Object.preventExtensions({\n        get options() {\n          return USER_DEFAULTS;\n        },\n\n        get templates() {\n          return TEMPLATES;\n        }\n\n      });\n    }\n    /**\n     * @param {string | HTMLInputElement | HTMLSelectElement} element\n     * @param {Partial<Options>} userConfig\n     */\n\n  }]);\n\n  function Choices(element, userConfig) {\n    var _this = this;\n\n    if (element === void 0) {\n      element = '[data-choice]';\n    }\n\n    if (userConfig === void 0) {\n      userConfig = {};\n    }\n\n    /** @type {Partial<Options>} */\n    this.config = cjs_default.a.all([DEFAULT_CONFIG, Choices.defaults.options, userConfig], // When merging array configs, replace with a copy of the userConfig array,\n    // instead of concatenating with the default array\n    {\n      arrayMerge: function arrayMerge(_, sourceArray) {\n        return [].concat(sourceArray);\n      }\n    });\n    var invalidConfigOptions = diff(this.config, DEFAULT_CONFIG);\n\n    if (invalidConfigOptions.length) {\n      console.warn('Unknown config option(s) passed', invalidConfigOptions.join(', '));\n    }\n\n    var passedElement = typeof element === 'string' ? document.querySelector(element) : element;\n\n    if (!(passedElement instanceof HTMLInputElement || passedElement instanceof HTMLSelectElement)) {\n      throw TypeError('Expected one of the following types text|select-one|select-multiple');\n    }\n\n    this._isTextElement = passedElement.type === TEXT_TYPE;\n    this._isSelectOneElement = passedElement.type === SELECT_ONE_TYPE;\n    this._isSelectMultipleElement = passedElement.type === SELECT_MULTIPLE_TYPE;\n    this._isSelectElement = this._isSelectOneElement || this._isSelectMultipleElement;\n    this.config.searchEnabled = this._isSelectMultipleElement || this.config.searchEnabled;\n\n    if (!['auto', 'always'].includes(this.config.renderSelectedChoices)) {\n      this.config.renderSelectedChoices = 'auto';\n    }\n\n    if (userConfig.addItemFilter && typeof userConfig.addItemFilter !== 'function') {\n      var re = userConfig.addItemFilter instanceof RegExp ? userConfig.addItemFilter : new RegExp(userConfig.addItemFilter);\n      this.config.addItemFilter = re.test.bind(re);\n    }\n\n    if (this._isTextElement) {\n      this.passedElement = new WrappedInput({\n        element: passedElement,\n        classNames: this.config.classNames,\n        delimiter: this.config.delimiter\n      });\n    } else {\n      this.passedElement = new WrappedSelect({\n        element: passedElement,\n        classNames: this.config.classNames,\n        template: function template(data) {\n          return _this._templates.option(data);\n        }\n      });\n    }\n\n    this.initialised = false;\n    this._store = new store_Store();\n    this._initialState = {};\n    this._currentState = {};\n    this._prevState = {};\n    this._currentValue = '';\n    this._canSearch = this.config.searchEnabled;\n    this._isScrollingOnIe = false;\n    this._highlightPosition = 0;\n    this._wasTap = true;\n    this._placeholderValue = this._generatePlaceholderValue();\n    this._baseId = generateId(this.passedElement.element, 'choices-');\n    /**\n     * setting direction in cases where it's explicitly set on passedElement\n     * or when calculated direction is different from the document\n     * @type {HTMLElement['dir']}\n     */\n\n    this._direction = this.passedElement.dir;\n\n    if (!this._direction) {\n      var _window$getComputedSt = window.getComputedStyle(this.passedElement.element),\n          elementDirection = _window$getComputedSt.direction;\n\n      var _window$getComputedSt2 = window.getComputedStyle(document.documentElement),\n          documentDirection = _window$getComputedSt2.direction;\n\n      if (elementDirection !== documentDirection) {\n        this._direction = elementDirection;\n      }\n    }\n\n    this._idNames = {\n      itemChoice: 'item-choice'\n    }; // Assign preset groups from passed element\n\n    this._presetGroups = this.passedElement.optionGroups; // Assign preset options from passed element\n\n    this._presetOptions = this.passedElement.options; // Assign preset choices from passed object\n\n    this._presetChoices = this.config.choices; // Assign preset items from passed object first\n\n    this._presetItems = this.config.items; // Add any values passed from attribute\n\n    if (this.passedElement.value) {\n      this._presetItems = this._presetItems.concat(this.passedElement.value.split(this.config.delimiter));\n    } // Create array of choices from option elements\n\n\n    if (this.passedElement.options) {\n      this.passedElement.options.forEach(function (o) {\n        _this._presetChoices.push({\n          value: o.value,\n          label: o.innerHTML,\n          selected: o.selected,\n          disabled: o.disabled || o.parentNode.disabled,\n          placeholder: o.value === '' || o.hasAttribute('placeholder'),\n          customProperties: o.getAttribute('data-custom-properties')\n        });\n      });\n    }\n\n    this._render = this._render.bind(this);\n    this._onFocus = this._onFocus.bind(this);\n    this._onBlur = this._onBlur.bind(this);\n    this._onKeyUp = this._onKeyUp.bind(this);\n    this._onKeyDown = this._onKeyDown.bind(this);\n    this._onClick = this._onClick.bind(this);\n    this._onTouchMove = this._onTouchMove.bind(this);\n    this._onTouchEnd = this._onTouchEnd.bind(this);\n    this._onMouseDown = this._onMouseDown.bind(this);\n    this._onMouseOver = this._onMouseOver.bind(this);\n    this._onFormReset = this._onFormReset.bind(this);\n    this._onAKey = this._onAKey.bind(this);\n    this._onEnterKey = this._onEnterKey.bind(this);\n    this._onEscapeKey = this._onEscapeKey.bind(this);\n    this._onDirectionKey = this._onDirectionKey.bind(this);\n    this._onDeleteKey = this._onDeleteKey.bind(this); // If element has already been initialised with Choices, fail silently\n\n    if (this.passedElement.isActive) {\n      if (!this.config.silent) {\n        console.warn('Trying to initialise Choices on element already initialised');\n      }\n\n      this.initialised = true;\n      return;\n    } // Let's go\n\n\n    this.init();\n  }\n\n  var _proto = Choices.prototype;\n\n  _proto.init = function init() {\n    if (this.initialised) {\n      return;\n    }\n\n    this._createTemplates();\n\n    this._createElements();\n\n    this._createStructure(); // Set initial state (We need to clone the state because some reducers\n    // modify the inner objects properties in the state) \n\n\n    this._initialState = cloneObject(this._store.state);\n\n    this._store.subscribe(this._render);\n\n    this._render();\n\n    this._addEventListeners();\n\n    var shouldDisable = !this.config.addItems || this.passedElement.element.hasAttribute('disabled');\n\n    if (shouldDisable) {\n      this.disable();\n    }\n\n    this.initialised = true;\n    var callbackOnInit = this.config.callbackOnInit; // Run callback if it is a function\n\n    if (callbackOnInit && typeof callbackOnInit === 'function') {\n      callbackOnInit.call(this);\n    }\n  };\n\n  _proto.destroy = function destroy() {\n    if (!this.initialised) {\n      return;\n    }\n\n    this._removeEventListeners();\n\n    this.passedElement.reveal();\n    this.containerOuter.unwrap(this.passedElement.element);\n    this.clearStore();\n\n    if (this._isSelectElement) {\n      this.passedElement.options = this._presetOptions;\n    }\n\n    this._templates = null;\n    this.initialised = false;\n  };\n\n  _proto.enable = function enable() {\n    if (this.passedElement.isDisabled) {\n      this.passedElement.enable();\n    }\n\n    if (this.containerOuter.isDisabled) {\n      this._addEventListeners();\n\n      this.input.enable();\n      this.containerOuter.enable();\n    }\n\n    return this;\n  };\n\n  _proto.disable = function disable() {\n    if (!this.passedElement.isDisabled) {\n      this.passedElement.disable();\n    }\n\n    if (!this.containerOuter.isDisabled) {\n      this._removeEventListeners();\n\n      this.input.disable();\n      this.containerOuter.disable();\n    }\n\n    return this;\n  };\n\n  _proto.highlightItem = function highlightItem(item, runEvent) {\n    if (runEvent === void 0) {\n      runEvent = true;\n    }\n\n    if (!item) {\n      return this;\n    }\n\n    var id = item.id,\n        _item$groupId = item.groupId,\n        groupId = _item$groupId === void 0 ? -1 : _item$groupId,\n        _item$value = item.value,\n        value = _item$value === void 0 ? '' : _item$value,\n        _item$label = item.label,\n        label = _item$label === void 0 ? '' : _item$label;\n    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n\n    this._store.dispatch(items_highlightItem(id, true));\n\n    if (runEvent) {\n      this.passedElement.triggerEvent(EVENTS.highlightItem, {\n        id: id,\n        value: value,\n        label: label,\n        groupValue: group && group.value ? group.value : null\n      });\n    }\n\n    return this;\n  };\n\n  _proto.unhighlightItem = function unhighlightItem(item) {\n    if (!item) {\n      return this;\n    }\n\n    var id = item.id,\n        _item$groupId2 = item.groupId,\n        groupId = _item$groupId2 === void 0 ? -1 : _item$groupId2,\n        _item$value2 = item.value,\n        value = _item$value2 === void 0 ? '' : _item$value2,\n        _item$label2 = item.label,\n        label = _item$label2 === void 0 ? '' : _item$label2;\n    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n\n    this._store.dispatch(items_highlightItem(id, false));\n\n    this.passedElement.triggerEvent(EVENTS.highlightItem, {\n      id: id,\n      value: value,\n      label: label,\n      groupValue: group && group.value ? group.value : null\n    });\n    return this;\n  };\n\n  _proto.highlightAll = function highlightAll() {\n    var _this2 = this;\n\n    this._store.items.forEach(function (item) {\n      return _this2.highlightItem(item);\n    });\n\n    return this;\n  };\n\n  _proto.unhighlightAll = function unhighlightAll() {\n    var _this3 = this;\n\n    this._store.items.forEach(function (item) {\n      return _this3.unhighlightItem(item);\n    });\n\n    return this;\n  };\n\n  _proto.removeActiveItemsByValue = function removeActiveItemsByValue(value) {\n    var _this4 = this;\n\n    this._store.activeItems.filter(function (item) {\n      return item.value === value;\n    }).forEach(function (item) {\n      return _this4._removeItem(item);\n    });\n\n    return this;\n  };\n\n  _proto.removeActiveItems = function removeActiveItems(excludedId) {\n    var _this5 = this;\n\n    this._store.activeItems.filter(function (_ref) {\n      var id = _ref.id;\n      return id !== excludedId;\n    }).forEach(function (item) {\n      return _this5._removeItem(item);\n    });\n\n    return this;\n  };\n\n  _proto.removeHighlightedItems = function removeHighlightedItems(runEvent) {\n    var _this6 = this;\n\n    if (runEvent === void 0) {\n      runEvent = false;\n    }\n\n    this._store.highlightedActiveItems.forEach(function (item) {\n      _this6._removeItem(item); // If this action was performed by the user\n      // trigger the event\n\n\n      if (runEvent) {\n        _this6._triggerChange(item.value);\n      }\n    });\n\n    return this;\n  };\n\n  _proto.showDropdown = function showDropdown(preventInputFocus) {\n    var _this7 = this;\n\n    if (this.dropdown.isActive) {\n      return this;\n    }\n\n    requestAnimationFrame(function () {\n      _this7.dropdown.show();\n\n      _this7.containerOuter.open(_this7.dropdown.distanceFromTopWindow);\n\n      if (!preventInputFocus && _this7._canSearch) {\n        _this7.input.focus();\n      }\n\n      _this7.passedElement.triggerEvent(EVENTS.showDropdown, {});\n    });\n    return this;\n  };\n\n  _proto.hideDropdown = function hideDropdown(preventInputBlur) {\n    var _this8 = this;\n\n    if (!this.dropdown.isActive) {\n      return this;\n    }\n\n    requestAnimationFrame(function () {\n      _this8.dropdown.hide();\n\n      _this8.containerOuter.close();\n\n      if (!preventInputBlur && _this8._canSearch) {\n        _this8.input.removeActiveDescendant();\n\n        _this8.input.blur();\n      }\n\n      _this8.passedElement.triggerEvent(EVENTS.hideDropdown, {});\n    });\n    return this;\n  };\n\n  _proto.getValue = function getValue(valueOnly) {\n    if (valueOnly === void 0) {\n      valueOnly = false;\n    }\n\n    var values = this._store.activeItems.reduce(function (selectedItems, item) {\n      var itemValue = valueOnly ? item.value : item;\n      selectedItems.push(itemValue);\n      return selectedItems;\n    }, []);\n\n    return this._isSelectOneElement ? values[0] : values;\n  }\n  /**\n   * @param {string[] | import('../../types/index').Choices.Item[]} items\n   */\n  ;\n\n  _proto.setValue = function setValue(items) {\n    var _this9 = this;\n\n    if (!this.initialised) {\n      return this;\n    }\n\n    items.forEach(function (value) {\n      return _this9._setChoiceOrItem(value);\n    });\n    return this;\n  };\n\n  _proto.setChoiceByValue = function setChoiceByValue(value) {\n    var _this10 = this;\n\n    if (!this.initialised || this._isTextElement) {\n      return this;\n    } // If only one value has been passed, convert to array\n\n\n    var choiceValue = Array.isArray(value) ? value : [value]; // Loop through each value and\n\n    choiceValue.forEach(function (val) {\n      return _this10._findAndSelectChoiceByValue(val);\n    });\n    return this;\n  }\n  /**\n   * Set choices of select input via an array of objects (or function that returns array of object or promise of it),\n   * a value field name and a label field name.\n   * This behaves the same as passing items via the choices option but can be called after initialising Choices.\n   * This can also be used to add groups of choices (see example 2); Optionally pass a true `replaceChoices` value to remove any existing choices.\n   * Optionally pass a `customProperties` object to add additional data to your choices (useful when searching/filtering etc).\n   *\n   * **Input types affected:** select-one, select-multiple\n   *\n   * @template {Choice[] | ((instance: Choices) => object[] | Promise<object[]>)} T\n   * @param {T} [choicesArrayOrFetcher]\n   * @param {string} [value = 'value'] - name of `value` field\n   * @param {string} [label = 'label'] - name of 'label' field\n   * @param {boolean} [replaceChoices = false] - whether to replace of add choices\n   * @returns {this | Promise<this>}\n   *\n   * @example\n   * ```js\n   * const example = new Choices(element);\n   *\n   * example.setChoices([\n   *   {value: 'One', label: 'Label One', disabled: true},\n   *   {value: 'Two', label: 'Label Two', selected: true},\n   *   {value: 'Three', label: 'Label Three'},\n   * ], 'value', 'label', false);\n   * ```\n   *\n   * @example\n   * ```js\n   * const example = new Choices(element);\n   *\n   * example.setChoices(async () => {\n   *   try {\n   *      const items = await fetch('/items');\n   *      return items.json()\n   *   } catch(err) {\n   *      console.error(err)\n   *   }\n   * });\n   * ```\n   *\n   * @example\n   * ```js\n   * const example = new Choices(element);\n   *\n   * example.setChoices([{\n   *   label: 'Group one',\n   *   id: 1,\n   *   disabled: false,\n   *   choices: [\n   *     {value: 'Child One', label: 'Child One', selected: true},\n   *     {value: 'Child Two', label: 'Child Two',  disabled: true},\n   *     {value: 'Child Three', label: 'Child Three'},\n   *   ]\n   * },\n   * {\n   *   label: 'Group two',\n   *   id: 2,\n   *   disabled: false,\n   *   choices: [\n   *     {value: 'Child Four', label: 'Child Four', disabled: true},\n   *     {value: 'Child Five', label: 'Child Five'},\n   *     {value: 'Child Six', label: 'Child Six', customProperties: {\n   *       description: 'Custom description about child six',\n   *       random: 'Another random custom property'\n   *     }},\n   *   ]\n   * }], 'value', 'label', false);\n   * ```\n   */\n  ;\n\n  _proto.setChoices = function setChoices(choicesArrayOrFetcher, value, label, replaceChoices) {\n    var _this11 = this;\n\n    if (choicesArrayOrFetcher === void 0) {\n      choicesArrayOrFetcher = [];\n    }\n\n    if (value === void 0) {\n      value = 'value';\n    }\n\n    if (label === void 0) {\n      label = 'label';\n    }\n\n    if (replaceChoices === void 0) {\n      replaceChoices = false;\n    }\n\n    if (!this.initialised) {\n      throw new ReferenceError(\"setChoices was called on a non-initialized instance of Choices\");\n    }\n\n    if (!this._isSelectElement) {\n      throw new TypeError(\"setChoices can't be used with INPUT based Choices\");\n    }\n\n    if (typeof value !== 'string' || !value) {\n      throw new TypeError(\"value parameter must be a name of 'value' field in passed objects\");\n    } // Clear choices if needed\n\n\n    if (replaceChoices) {\n      this.clearChoices();\n    }\n\n    if (typeof choicesArrayOrFetcher === 'function') {\n      // it's a choices fetcher function\n      var fetcher = choicesArrayOrFetcher(this);\n\n      if (typeof Promise === 'function' && fetcher instanceof Promise) {\n        // that's a promise\n        // eslint-disable-next-line compat/compat\n        return new Promise(function (resolve) {\n          return requestAnimationFrame(resolve);\n        }).then(function () {\n          return _this11._handleLoadingState(true);\n        }).then(function () {\n          return fetcher;\n        }).then(function (data) {\n          return _this11.setChoices(data, value, label, replaceChoices);\n        }).catch(function (err) {\n          if (!_this11.config.silent) {\n            console.error(err);\n          }\n        }).then(function () {\n          return _this11._handleLoadingState(false);\n        }).then(function () {\n          return _this11;\n        });\n      } // function returned something else than promise, let's check if it's an array of choices\n\n\n      if (!Array.isArray(fetcher)) {\n        throw new TypeError(\".setChoices first argument function must return either array of choices or Promise, got: \" + typeof fetcher);\n      } // recursion with results, it's sync and choices were cleared already\n\n\n      return this.setChoices(fetcher, value, label, false);\n    }\n\n    if (!Array.isArray(choicesArrayOrFetcher)) {\n      throw new TypeError(\".setChoices must be called either with array of choices with a function resulting into Promise of array of choices\");\n    }\n\n    this.containerOuter.removeLoadingState();\n\n    this._startLoading();\n\n    choicesArrayOrFetcher.forEach(function (groupOrChoice) {\n      if (groupOrChoice.choices) {\n        _this11._addGroup({\n          id: parseInt(groupOrChoice.id, 10) || null,\n          group: groupOrChoice,\n          valueKey: value,\n          labelKey: label\n        });\n      } else {\n        _this11._addChoice({\n          value: groupOrChoice[value],\n          label: groupOrChoice[label],\n          isSelected: groupOrChoice.selected,\n          isDisabled: groupOrChoice.disabled,\n          customProperties: groupOrChoice.customProperties,\n          placeholder: groupOrChoice.placeholder\n        });\n      }\n    });\n\n    this._stopLoading();\n\n    return this;\n  };\n\n  _proto.clearChoices = function clearChoices() {\n    this._store.dispatch(choices_clearChoices());\n\n    return this;\n  };\n\n  _proto.clearStore = function clearStore() {\n    this._store.dispatch(clearAll());\n\n    return this;\n  };\n\n  _proto.clearInput = function clearInput() {\n    var shouldSetInputWidth = !this._isSelectOneElement;\n    this.input.clear(shouldSetInputWidth);\n\n    if (!this._isTextElement && this._canSearch) {\n      this._isSearching = false;\n\n      this._store.dispatch(choices_activateChoices(true));\n    }\n\n    return this;\n  };\n\n  _proto._render = function _render() {\n    if (this._store.isLoading()) {\n      return;\n    }\n\n    this._currentState = this._store.state;\n    var stateChanged = this._currentState.choices !== this._prevState.choices || this._currentState.groups !== this._prevState.groups || this._currentState.items !== this._prevState.items;\n    var shouldRenderChoices = this._isSelectElement;\n    var shouldRenderItems = this._currentState.items !== this._prevState.items;\n\n    if (!stateChanged) {\n      return;\n    }\n\n    if (shouldRenderChoices) {\n      this._renderChoices();\n    }\n\n    if (shouldRenderItems) {\n      this._renderItems();\n    }\n\n    this._prevState = this._currentState;\n  };\n\n  _proto._renderChoices = function _renderChoices() {\n    var _this12 = this;\n\n    var _this$_store = this._store,\n        activeGroups = _this$_store.activeGroups,\n        activeChoices = _this$_store.activeChoices;\n    var choiceListFragment = document.createDocumentFragment();\n    this.choiceList.clear();\n\n    if (this.config.resetScrollPosition) {\n      requestAnimationFrame(function () {\n        return _this12.choiceList.scrollToTop();\n      });\n    } // If we have grouped options\n\n\n    if (activeGroups.length >= 1 && !this._isSearching) {\n      // If we have a placeholder choice along with groups\n      var activePlaceholders = activeChoices.filter(function (activeChoice) {\n        return activeChoice.placeholder === true && activeChoice.groupId === -1;\n      });\n\n      if (activePlaceholders.length >= 1) {\n        choiceListFragment = this._createChoicesFragment(activePlaceholders, choiceListFragment);\n      }\n\n      choiceListFragment = this._createGroupsFragment(activeGroups, activeChoices, choiceListFragment);\n    } else if (activeChoices.length >= 1) {\n      choiceListFragment = this._createChoicesFragment(activeChoices, choiceListFragment);\n    } // If we have choices to show\n\n\n    if (choiceListFragment.childNodes && choiceListFragment.childNodes.length > 0) {\n      var activeItems = this._store.activeItems;\n\n      var canAddItem = this._canAddItem(activeItems, this.input.value); // ...and we can select them\n\n\n      if (canAddItem.response) {\n        // ...append them and highlight the first choice\n        this.choiceList.append(choiceListFragment);\n\n        this._highlightChoice();\n      } else {\n        // ...otherwise show a notice\n        this.choiceList.append(this._getTemplate('notice', canAddItem.notice));\n      }\n    } else {\n      // Otherwise show a notice\n      var dropdownItem;\n      var notice;\n\n      if (this._isSearching) {\n        notice = typeof this.config.noResultsText === 'function' ? this.config.noResultsText() : this.config.noResultsText;\n        dropdownItem = this._getTemplate('notice', notice, 'no-results');\n      } else {\n        notice = typeof this.config.noChoicesText === 'function' ? this.config.noChoicesText() : this.config.noChoicesText;\n        dropdownItem = this._getTemplate('notice', notice, 'no-choices');\n      }\n\n      this.choiceList.append(dropdownItem);\n    }\n  };\n\n  _proto._renderItems = function _renderItems() {\n    var activeItems = this._store.activeItems || [];\n    this.itemList.clear(); // Create a fragment to store our list items\n    // (so we don't have to update the DOM for each item)\n\n    var itemListFragment = this._createItemsFragment(activeItems); // If we have items to add, append them\n\n\n    if (itemListFragment.childNodes) {\n      this.itemList.append(itemListFragment);\n    }\n  };\n\n  _proto._createGroupsFragment = function _createGroupsFragment(groups, choices, fragment) {\n    var _this13 = this;\n\n    if (fragment === void 0) {\n      fragment = document.createDocumentFragment();\n    }\n\n    var getGroupChoices = function getGroupChoices(group) {\n      return choices.filter(function (choice) {\n        if (_this13._isSelectOneElement) {\n          return choice.groupId === group.id;\n        }\n\n        return choice.groupId === group.id && (_this13.config.renderSelectedChoices === 'always' || !choice.selected);\n      });\n    }; // If sorting is enabled, filter groups\n\n\n    if (this.config.shouldSort) {\n      groups.sort(this.config.sorter);\n    }\n\n    groups.forEach(function (group) {\n      var groupChoices = getGroupChoices(group);\n\n      if (groupChoices.length >= 1) {\n        var dropdownGroup = _this13._getTemplate('choiceGroup', group);\n\n        fragment.appendChild(dropdownGroup);\n\n        _this13._createChoicesFragment(groupChoices, fragment, true);\n      }\n    });\n    return fragment;\n  };\n\n  _proto._createChoicesFragment = function _createChoicesFragment(choices, fragment, withinGroup) {\n    var _this14 = this;\n\n    if (fragment === void 0) {\n      fragment = document.createDocumentFragment();\n    }\n\n    if (withinGroup === void 0) {\n      withinGroup = false;\n    }\n\n    // Create a fragment to store our list items (so we don't have to update the DOM for each item)\n    var _this$config = this.config,\n        renderSelectedChoices = _this$config.renderSelectedChoices,\n        searchResultLimit = _this$config.searchResultLimit,\n        renderChoiceLimit = _this$config.renderChoiceLimit;\n    var filter = this._isSearching ? sortByScore : this.config.sorter;\n\n    var appendChoice = function appendChoice(choice) {\n      var shouldRender = renderSelectedChoices === 'auto' ? _this14._isSelectOneElement || !choice.selected : true;\n\n      if (shouldRender) {\n        var dropdownItem = _this14._getTemplate('choice', choice, _this14.config.itemSelectText);\n\n        fragment.appendChild(dropdownItem);\n      }\n    };\n\n    var rendererableChoices = choices;\n\n    if (renderSelectedChoices === 'auto' && !this._isSelectOneElement) {\n      rendererableChoices = choices.filter(function (choice) {\n        return !choice.selected;\n      });\n    } // Split array into placeholders and \"normal\" choices\n\n\n    var _rendererableChoices$ = rendererableChoices.reduce(function (acc, choice) {\n      if (choice.placeholder) {\n        acc.placeholderChoices.push(choice);\n      } else {\n        acc.normalChoices.push(choice);\n      }\n\n      return acc;\n    }, {\n      placeholderChoices: [],\n      normalChoices: []\n    }),\n        placeholderChoices = _rendererableChoices$.placeholderChoices,\n        normalChoices = _rendererableChoices$.normalChoices; // If sorting is enabled or the user is searching, filter choices\n\n\n    if (this.config.shouldSort || this._isSearching) {\n      normalChoices.sort(filter);\n    }\n\n    var choiceLimit = rendererableChoices.length; // Prepend placeholeder\n\n    var sortedChoices = this._isSelectOneElement ? [].concat(placeholderChoices, normalChoices) : normalChoices;\n\n    if (this._isSearching) {\n      choiceLimit = searchResultLimit;\n    } else if (renderChoiceLimit && renderChoiceLimit > 0 && !withinGroup) {\n      choiceLimit = renderChoiceLimit;\n    } // Add each choice to dropdown within range\n\n\n    for (var i = 0; i < choiceLimit; i += 1) {\n      if (sortedChoices[i]) {\n        appendChoice(sortedChoices[i]);\n      }\n    }\n\n    return fragment;\n  };\n\n  _proto._createItemsFragment = function _createItemsFragment(items, fragment) {\n    var _this15 = this;\n\n    if (fragment === void 0) {\n      fragment = document.createDocumentFragment();\n    }\n\n    // Create fragment to add elements to\n    var _this$config2 = this.config,\n        shouldSortItems = _this$config2.shouldSortItems,\n        sorter = _this$config2.sorter,\n        removeItemButton = _this$config2.removeItemButton; // If sorting is enabled, filter items\n\n    if (shouldSortItems && !this._isSelectOneElement) {\n      items.sort(sorter);\n    }\n\n    if (this._isTextElement) {\n      // Update the value of the hidden input\n      this.passedElement.value = items;\n    } else {\n      // Update the options of the hidden input\n      this.passedElement.options = items;\n    }\n\n    var addItemToFragment = function addItemToFragment(item) {\n      // Create new list element\n      var listItem = _this15._getTemplate('item', item, removeItemButton); // Append it to list\n\n\n      fragment.appendChild(listItem);\n    }; // Add each list item to list\n\n\n    items.forEach(addItemToFragment);\n    return fragment;\n  };\n\n  _proto._triggerChange = function _triggerChange(value) {\n    if (value === undefined || value === null) {\n      return;\n    }\n\n    this.passedElement.triggerEvent(EVENTS.change, {\n      value: value\n    });\n  };\n\n  _proto._selectPlaceholderChoice = function _selectPlaceholderChoice() {\n    var placeholderChoice = this._store.placeholderChoice;\n\n    if (placeholderChoice) {\n      this._addItem({\n        value: placeholderChoice.value,\n        label: placeholderChoice.label,\n        choiceId: placeholderChoice.id,\n        groupId: placeholderChoice.groupId,\n        placeholder: placeholderChoice.placeholder\n      });\n\n      this._triggerChange(placeholderChoice.value);\n    }\n  };\n\n  _proto._handleButtonAction = function _handleButtonAction(activeItems, element) {\n    if (!activeItems || !element || !this.config.removeItems || !this.config.removeItemButton) {\n      return;\n    }\n\n    var itemId = element.parentNode.getAttribute('data-id');\n    var itemToRemove = activeItems.find(function (item) {\n      return item.id === parseInt(itemId, 10);\n    }); // Remove item associated with button\n\n    this._removeItem(itemToRemove);\n\n    this._triggerChange(itemToRemove.value);\n\n    if (this._isSelectOneElement) {\n      this._selectPlaceholderChoice();\n    }\n  };\n\n  _proto._handleItemAction = function _handleItemAction(activeItems, element, hasShiftKey) {\n    var _this16 = this;\n\n    if (hasShiftKey === void 0) {\n      hasShiftKey = false;\n    }\n\n    if (!activeItems || !element || !this.config.removeItems || this._isSelectOneElement) {\n      return;\n    }\n\n    var passedId = element.getAttribute('data-id'); // We only want to select one item with a click\n    // so we deselect any items that aren't the target\n    // unless shift is being pressed\n\n    activeItems.forEach(function (item) {\n      if (item.id === parseInt(passedId, 10) && !item.highlighted) {\n        _this16.highlightItem(item);\n      } else if (!hasShiftKey && item.highlighted) {\n        _this16.unhighlightItem(item);\n      }\n    }); // Focus input as without focus, a user cannot do anything with a\n    // highlighted item\n\n    this.input.focus();\n  };\n\n  _proto._handleChoiceAction = function _handleChoiceAction(activeItems, element) {\n    if (!activeItems || !element) {\n      return;\n    } // If we are clicking on an option\n\n\n    var id = element.dataset.id;\n\n    var choice = this._store.getChoiceById(id);\n\n    if (!choice) {\n      return;\n    }\n\n    var passedKeyCode = activeItems[0] && activeItems[0].keyCode ? activeItems[0].keyCode : null;\n    var hasActiveDropdown = this.dropdown.isActive; // Update choice keyCode\n\n    choice.keyCode = passedKeyCode;\n    this.passedElement.triggerEvent(EVENTS.choice, {\n      choice: choice\n    });\n\n    if (!choice.selected && !choice.disabled) {\n      var canAddItem = this._canAddItem(activeItems, choice.value);\n\n      if (canAddItem.response) {\n        this._addItem({\n          value: choice.value,\n          label: choice.label,\n          choiceId: choice.id,\n          groupId: choice.groupId,\n          customProperties: choice.customProperties,\n          placeholder: choice.placeholder,\n          keyCode: choice.keyCode\n        });\n\n        this._triggerChange(choice.value);\n      }\n    }\n\n    this.clearInput(); // We want to close the dropdown if we are dealing with a single select box\n\n    if (hasActiveDropdown && this._isSelectOneElement) {\n      this.hideDropdown(true);\n      this.containerOuter.focus();\n    }\n  };\n\n  _proto._handleBackspace = function _handleBackspace(activeItems) {\n    if (!this.config.removeItems || !activeItems) {\n      return;\n    }\n\n    var lastItem = activeItems[activeItems.length - 1];\n    var hasHighlightedItems = activeItems.some(function (item) {\n      return item.highlighted;\n    }); // If editing the last item is allowed and there are not other selected items,\n    // we can edit the item value. Otherwise if we can remove items, remove all selected items\n\n    if (this.config.editItems && !hasHighlightedItems && lastItem) {\n      this.input.value = lastItem.value;\n      this.input.setWidth();\n\n      this._removeItem(lastItem);\n\n      this._triggerChange(lastItem.value);\n    } else {\n      if (!hasHighlightedItems) {\n        // Highlight last item if none already highlighted\n        this.highlightItem(lastItem, false);\n      }\n\n      this.removeHighlightedItems(true);\n    }\n  };\n\n  _proto._startLoading = function _startLoading() {\n    this._store.dispatch(setIsLoading(true));\n  };\n\n  _proto._stopLoading = function _stopLoading() {\n    this._store.dispatch(setIsLoading(false));\n  };\n\n  _proto._handleLoadingState = function _handleLoadingState(setLoading) {\n    if (setLoading === void 0) {\n      setLoading = true;\n    }\n\n    var placeholderItem = this.itemList.getChild(\".\" + this.config.classNames.placeholder);\n\n    if (setLoading) {\n      this.disable();\n      this.containerOuter.addLoadingState();\n\n      if (this._isSelectOneElement) {\n        if (!placeholderItem) {\n          placeholderItem = this._getTemplate('placeholder', this.config.loadingText);\n          this.itemList.append(placeholderItem);\n        } else {\n          placeholderItem.innerHTML = this.config.loadingText;\n        }\n      } else {\n        this.input.placeholder = this.config.loadingText;\n      }\n    } else {\n      this.enable();\n      this.containerOuter.removeLoadingState();\n\n      if (this._isSelectOneElement) {\n        placeholderItem.innerHTML = this._placeholderValue || '';\n      } else {\n        this.input.placeholder = this._placeholderValue || '';\n      }\n    }\n  };\n\n  _proto._handleSearch = function _handleSearch(value) {\n    if (!value || !this.input.isFocussed) {\n      return;\n    }\n\n    var choices = this._store.choices;\n    var _this$config3 = this.config,\n        searchFloor = _this$config3.searchFloor,\n        searchChoices = _this$config3.searchChoices;\n    var hasUnactiveChoices = choices.some(function (option) {\n      return !option.active;\n    }); // Check that we have a value to search and the input was an alphanumeric character\n\n    if (value && value.length >= searchFloor) {\n      var resultCount = searchChoices ? this._searchChoices(value) : 0; // Trigger search event\n\n      this.passedElement.triggerEvent(EVENTS.search, {\n        value: value,\n        resultCount: resultCount\n      });\n    } else if (hasUnactiveChoices) {\n      // Otherwise reset choices to active\n      this._isSearching = false;\n\n      this._store.dispatch(choices_activateChoices(true));\n    }\n  };\n\n  _proto._canAddItem = function _canAddItem(activeItems, value) {\n    var canAddItem = true;\n    var notice = typeof this.config.addItemText === 'function' ? this.config.addItemText(value) : this.config.addItemText;\n\n    if (!this._isSelectOneElement) {\n      var isDuplicateValue = existsInArray(activeItems, value);\n\n      if (this.config.maxItemCount > 0 && this.config.maxItemCount <= activeItems.length) {\n        // If there is a max entry limit and we have reached that limit\n        // don't update\n        canAddItem = false;\n        notice = typeof this.config.maxItemText === 'function' ? this.config.maxItemText(this.config.maxItemCount) : this.config.maxItemText;\n      }\n\n      if (!this.config.duplicateItemsAllowed && isDuplicateValue && canAddItem) {\n        canAddItem = false;\n        notice = typeof this.config.uniqueItemText === 'function' ? this.config.uniqueItemText(value) : this.config.uniqueItemText;\n      }\n\n      if (this._isTextElement && this.config.addItems && canAddItem && typeof this.config.addItemFilter === 'function' && !this.config.addItemFilter(value)) {\n        canAddItem = false;\n        notice = typeof this.config.customAddItemText === 'function' ? this.config.customAddItemText(value) : this.config.customAddItemText;\n      }\n    }\n\n    return {\n      response: canAddItem,\n      notice: notice\n    };\n  };\n\n  _proto._searchChoices = function _searchChoices(value) {\n    var newValue = typeof value === 'string' ? value.trim() : value;\n    var currentValue = typeof this._currentValue === 'string' ? this._currentValue.trim() : this._currentValue;\n\n    if (newValue.length < 1 && newValue === currentValue + \" \") {\n      return 0;\n    } // If new value matches the desired length and is not the same as the current value with a space\n\n\n    var haystack = this._store.searchableChoices;\n    var needle = newValue;\n    var keys = [].concat(this.config.searchFields);\n    var options = Object.assign(this.config.fuseOptions, {\n      keys: keys\n    });\n    var fuse = new fuse_default.a(haystack, options);\n    var results = fuse.search(needle);\n    this._currentValue = newValue;\n    this._highlightPosition = 0;\n    this._isSearching = true;\n\n    this._store.dispatch(choices_filterChoices(results));\n\n    return results.length;\n  };\n\n  _proto._addEventListeners = function _addEventListeners() {\n    var _document = document,\n        documentElement = _document.documentElement; // capture events - can cancel event processing or propagation\n\n    documentElement.addEventListener('touchend', this._onTouchEnd, true);\n    this.containerOuter.element.addEventListener('keydown', this._onKeyDown, true);\n    this.containerOuter.element.addEventListener('mousedown', this._onMouseDown, true); // passive events - doesn't call `preventDefault` or `stopPropagation`\n\n    documentElement.addEventListener('click', this._onClick, {\n      passive: true\n    });\n    documentElement.addEventListener('touchmove', this._onTouchMove, {\n      passive: true\n    });\n    this.dropdown.element.addEventListener('mouseover', this._onMouseOver, {\n      passive: true\n    });\n\n    if (this._isSelectOneElement) {\n      this.containerOuter.element.addEventListener('focus', this._onFocus, {\n        passive: true\n      });\n      this.containerOuter.element.addEventListener('blur', this._onBlur, {\n        passive: true\n      });\n    }\n\n    this.input.element.addEventListener('keyup', this._onKeyUp, {\n      passive: true\n    });\n    this.input.element.addEventListener('focus', this._onFocus, {\n      passive: true\n    });\n    this.input.element.addEventListener('blur', this._onBlur, {\n      passive: true\n    });\n\n    if (this.input.element.form) {\n      this.input.element.form.addEventListener('reset', this._onFormReset, {\n        passive: true\n      });\n    }\n\n    this.input.addEventListeners();\n  };\n\n  _proto._removeEventListeners = function _removeEventListeners() {\n    var _document2 = document,\n        documentElement = _document2.documentElement;\n    documentElement.removeEventListener('touchend', this._onTouchEnd, true);\n    this.containerOuter.element.removeEventListener('keydown', this._onKeyDown, true);\n    this.containerOuter.element.removeEventListener('mousedown', this._onMouseDown, true);\n    documentElement.removeEventListener('click', this._onClick);\n    documentElement.removeEventListener('touchmove', this._onTouchMove);\n    this.dropdown.element.removeEventListener('mouseover', this._onMouseOver);\n\n    if (this._isSelectOneElement) {\n      this.containerOuter.element.removeEventListener('focus', this._onFocus);\n      this.containerOuter.element.removeEventListener('blur', this._onBlur);\n    }\n\n    this.input.element.removeEventListener('keyup', this._onKeyUp);\n    this.input.element.removeEventListener('focus', this._onFocus);\n    this.input.element.removeEventListener('blur', this._onBlur);\n\n    if (this.input.element.form) {\n      this.input.element.form.removeEventListener('reset', this._onFormReset);\n    }\n\n    this.input.removeEventListeners();\n  }\n  /**\n   * @param {KeyboardEvent} event\n   */\n  ;\n\n  _proto._onKeyDown = function _onKeyDown(event) {\n    var _keyDownActions;\n\n    var target = event.target,\n        keyCode = event.keyCode,\n        ctrlKey = event.ctrlKey,\n        metaKey = event.metaKey;\n    var activeItems = this._store.activeItems;\n    var hasFocusedInput = this.input.isFocussed;\n    var hasActiveDropdown = this.dropdown.isActive;\n    var hasItems = this.itemList.hasChildren();\n    var keyString = String.fromCharCode(keyCode);\n    var BACK_KEY = KEY_CODES.BACK_KEY,\n        DELETE_KEY = KEY_CODES.DELETE_KEY,\n        ENTER_KEY = KEY_CODES.ENTER_KEY,\n        A_KEY = KEY_CODES.A_KEY,\n        ESC_KEY = KEY_CODES.ESC_KEY,\n        UP_KEY = KEY_CODES.UP_KEY,\n        DOWN_KEY = KEY_CODES.DOWN_KEY,\n        PAGE_UP_KEY = KEY_CODES.PAGE_UP_KEY,\n        PAGE_DOWN_KEY = KEY_CODES.PAGE_DOWN_KEY;\n    var hasCtrlDownKeyPressed = ctrlKey || metaKey; // If a user is typing and the dropdown is not active\n\n    if (!this._isTextElement && /[a-zA-Z0-9-_ ]/.test(keyString)) {\n      this.showDropdown();\n    } // Map keys to key actions\n\n\n    var keyDownActions = (_keyDownActions = {}, _keyDownActions[A_KEY] = this._onAKey, _keyDownActions[ENTER_KEY] = this._onEnterKey, _keyDownActions[ESC_KEY] = this._onEscapeKey, _keyDownActions[UP_KEY] = this._onDirectionKey, _keyDownActions[PAGE_UP_KEY] = this._onDirectionKey, _keyDownActions[DOWN_KEY] = this._onDirectionKey, _keyDownActions[PAGE_DOWN_KEY] = this._onDirectionKey, _keyDownActions[DELETE_KEY] = this._onDeleteKey, _keyDownActions[BACK_KEY] = this._onDeleteKey, _keyDownActions); // If keycode has a function, run it\n\n    if (keyDownActions[keyCode]) {\n      keyDownActions[keyCode]({\n        event: event,\n        target: target,\n        keyCode: keyCode,\n        metaKey: metaKey,\n        activeItems: activeItems,\n        hasFocusedInput: hasFocusedInput,\n        hasActiveDropdown: hasActiveDropdown,\n        hasItems: hasItems,\n        hasCtrlDownKeyPressed: hasCtrlDownKeyPressed\n      });\n    }\n  };\n\n  _proto._onKeyUp = function _onKeyUp(_ref2) {\n    var target = _ref2.target,\n        keyCode = _ref2.keyCode;\n    var value = this.input.value;\n    var activeItems = this._store.activeItems;\n\n    var canAddItem = this._canAddItem(activeItems, value);\n\n    var backKey = KEY_CODES.BACK_KEY,\n        deleteKey = KEY_CODES.DELETE_KEY; // We are typing into a text input and have a value, we want to show a dropdown\n    // notice. Otherwise hide the dropdown\n\n    if (this._isTextElement) {\n      var canShowDropdownNotice = canAddItem.notice && value;\n\n      if (canShowDropdownNotice) {\n        var dropdownItem = this._getTemplate('notice', canAddItem.notice);\n\n        this.dropdown.element.innerHTML = dropdownItem.outerHTML;\n        this.showDropdown(true);\n      } else {\n        this.hideDropdown(true);\n      }\n    } else {\n      var userHasRemovedValue = (keyCode === backKey || keyCode === deleteKey) && !target.value;\n      var canReactivateChoices = !this._isTextElement && this._isSearching;\n      var canSearch = this._canSearch && canAddItem.response;\n\n      if (userHasRemovedValue && canReactivateChoices) {\n        this._isSearching = false;\n\n        this._store.dispatch(choices_activateChoices(true));\n      } else if (canSearch) {\n        this._handleSearch(this.input.value);\n      }\n    }\n\n    this._canSearch = this.config.searchEnabled;\n  };\n\n  _proto._onAKey = function _onAKey(_ref3) {\n    var hasItems = _ref3.hasItems,\n        hasCtrlDownKeyPressed = _ref3.hasCtrlDownKeyPressed;\n\n    // If CTRL + A or CMD + A have been pressed and there are items to select\n    if (hasCtrlDownKeyPressed && hasItems) {\n      this._canSearch = false;\n      var shouldHightlightAll = this.config.removeItems && !this.input.value && this.input.element === document.activeElement;\n\n      if (shouldHightlightAll) {\n        this.highlightAll();\n      }\n    }\n  };\n\n  _proto._onEnterKey = function _onEnterKey(_ref4) {\n    var event = _ref4.event,\n        target = _ref4.target,\n        activeItems = _ref4.activeItems,\n        hasActiveDropdown = _ref4.hasActiveDropdown;\n    var enterKey = KEY_CODES.ENTER_KEY;\n    var targetWasButton = target.hasAttribute('data-button');\n\n    if (this._isTextElement && target.value) {\n      var value = this.input.value;\n\n      var canAddItem = this._canAddItem(activeItems, value);\n\n      if (canAddItem.response) {\n        this.hideDropdown(true);\n\n        this._addItem({\n          value: value\n        });\n\n        this._triggerChange(value);\n\n        this.clearInput();\n      }\n    }\n\n    if (targetWasButton) {\n      this._handleButtonAction(activeItems, target);\n\n      event.preventDefault();\n    }\n\n    if (hasActiveDropdown) {\n      var highlightedChoice = this.dropdown.getChild(\".\" + this.config.classNames.highlightedState);\n\n      if (highlightedChoice) {\n        // add enter keyCode value\n        if (activeItems[0]) {\n          activeItems[0].keyCode = enterKey; // eslint-disable-line no-param-reassign\n        }\n\n        this._handleChoiceAction(activeItems, highlightedChoice);\n      }\n\n      event.preventDefault();\n    } else if (this._isSelectOneElement) {\n      this.showDropdown();\n      event.preventDefault();\n    }\n  };\n\n  _proto._onEscapeKey = function _onEscapeKey(_ref5) {\n    var hasActiveDropdown = _ref5.hasActiveDropdown;\n\n    if (hasActiveDropdown) {\n      this.hideDropdown(true);\n      this.containerOuter.focus();\n    }\n  };\n\n  _proto._onDirectionKey = function _onDirectionKey(_ref6) {\n    var event = _ref6.event,\n        hasActiveDropdown = _ref6.hasActiveDropdown,\n        keyCode = _ref6.keyCode,\n        metaKey = _ref6.metaKey;\n    var downKey = KEY_CODES.DOWN_KEY,\n        pageUpKey = KEY_CODES.PAGE_UP_KEY,\n        pageDownKey = KEY_CODES.PAGE_DOWN_KEY; // If up or down key is pressed, traverse through options\n\n    if (hasActiveDropdown || this._isSelectOneElement) {\n      this.showDropdown();\n      this._canSearch = false;\n      var directionInt = keyCode === downKey || keyCode === pageDownKey ? 1 : -1;\n      var skipKey = metaKey || keyCode === pageDownKey || keyCode === pageUpKey;\n      var selectableChoiceIdentifier = '[data-choice-selectable]';\n      var nextEl;\n\n      if (skipKey) {\n        if (directionInt > 0) {\n          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier + \":last-of-type\");\n        } else {\n          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);\n        }\n      } else {\n        var currentEl = this.dropdown.element.querySelector(\".\" + this.config.classNames.highlightedState);\n\n        if (currentEl) {\n          nextEl = getAdjacentEl(currentEl, selectableChoiceIdentifier, directionInt);\n        } else {\n          nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);\n        }\n      }\n\n      if (nextEl) {\n        // We prevent default to stop the cursor moving\n        // when pressing the arrow\n        if (!isScrolledIntoView(nextEl, this.choiceList.element, directionInt)) {\n          this.choiceList.scrollToChildElement(nextEl, directionInt);\n        }\n\n        this._highlightChoice(nextEl);\n      } // Prevent default to maintain cursor position whilst\n      // traversing dropdown options\n\n\n      event.preventDefault();\n    }\n  };\n\n  _proto._onDeleteKey = function _onDeleteKey(_ref7) {\n    var event = _ref7.event,\n        target = _ref7.target,\n        hasFocusedInput = _ref7.hasFocusedInput,\n        activeItems = _ref7.activeItems;\n\n    // If backspace or delete key is pressed and the input has no value\n    if (hasFocusedInput && !target.value && !this._isSelectOneElement) {\n      this._handleBackspace(activeItems);\n\n      event.preventDefault();\n    }\n  };\n\n  _proto._onTouchMove = function _onTouchMove() {\n    if (this._wasTap) {\n      this._wasTap = false;\n    }\n  };\n\n  _proto._onTouchEnd = function _onTouchEnd(event) {\n    var _ref8 = event || event.touches[0],\n        target = _ref8.target;\n\n    var touchWasWithinContainer = this._wasTap && this.containerOuter.element.contains(target);\n\n    if (touchWasWithinContainer) {\n      var containerWasExactTarget = target === this.containerOuter.element || target === this.containerInner.element;\n\n      if (containerWasExactTarget) {\n        if (this._isTextElement) {\n          this.input.focus();\n        } else if (this._isSelectMultipleElement) {\n          this.showDropdown();\n        }\n      } // Prevents focus event firing\n\n\n      event.stopPropagation();\n    }\n\n    this._wasTap = true;\n  }\n  /**\n   * Handles mousedown event in capture mode for containetOuter.element\n   * @param {MouseEvent} event\n   */\n  ;\n\n  _proto._onMouseDown = function _onMouseDown(event) {\n    var target = event.target;\n\n    if (!(target instanceof HTMLElement)) {\n      return;\n    } // If we have our mouse down on the scrollbar and are on IE11...\n\n\n    if (IS_IE11 && this.choiceList.element.contains(target)) {\n      // check if click was on a scrollbar area\n      var firstChoice =\n      /** @type {HTMLElement} */\n      this.choiceList.element.firstElementChild;\n      var isOnScrollbar = this._direction === 'ltr' ? event.offsetX >= firstChoice.offsetWidth : event.offsetX < firstChoice.offsetLeft;\n      this._isScrollingOnIe = isOnScrollbar;\n    }\n\n    if (target === this.input.element) {\n      return;\n    }\n\n    var item = target.closest('[data-button],[data-item],[data-choice]');\n\n    if (item instanceof HTMLElement) {\n      var hasShiftKey = event.shiftKey;\n      var activeItems = this._store.activeItems;\n      var dataset = item.dataset;\n\n      if ('button' in dataset) {\n        this._handleButtonAction(activeItems, item);\n      } else if ('item' in dataset) {\n        this._handleItemAction(activeItems, item, hasShiftKey);\n      } else if ('choice' in dataset) {\n        this._handleChoiceAction(activeItems, item);\n      }\n    }\n\n    event.preventDefault();\n  }\n  /**\n   * Handles mouseover event over this.dropdown\n   * @param {MouseEvent} event\n   */\n  ;\n\n  _proto._onMouseOver = function _onMouseOver(_ref9) {\n    var target = _ref9.target;\n\n    if (target instanceof HTMLElement && 'choice' in target.dataset) {\n      this._highlightChoice(target);\n    }\n  };\n\n  _proto._onClick = function _onClick(_ref10) {\n    var target = _ref10.target;\n    var clickWasWithinContainer = this.containerOuter.element.contains(target);\n\n    if (clickWasWithinContainer) {\n      if (!this.dropdown.isActive && !this.containerOuter.isDisabled) {\n        if (this._isTextElement) {\n          if (document.activeElement !== this.input.element) {\n            this.input.focus();\n          }\n        } else {\n          this.showDropdown();\n          this.containerOuter.focus();\n        }\n      } else if (this._isSelectOneElement && target !== this.input.element && !this.dropdown.element.contains(target)) {\n        this.hideDropdown();\n      }\n    } else {\n      var hasHighlightedItems = this._store.highlightedActiveItems.length > 0;\n\n      if (hasHighlightedItems) {\n        this.unhighlightAll();\n      }\n\n      this.containerOuter.removeFocusState();\n      this.hideDropdown(true);\n    }\n  };\n\n  _proto._onFocus = function _onFocus(_ref11) {\n    var _this17 = this,\n        _focusActions;\n\n    var target = _ref11.target;\n    var focusWasWithinContainer = this.containerOuter.element.contains(target);\n\n    if (!focusWasWithinContainer) {\n      return;\n    }\n\n    var focusActions = (_focusActions = {}, _focusActions[TEXT_TYPE] = function () {\n      if (target === _this17.input.element) {\n        _this17.containerOuter.addFocusState();\n      }\n    }, _focusActions[SELECT_ONE_TYPE] = function () {\n      _this17.containerOuter.addFocusState();\n\n      if (target === _this17.input.element) {\n        _this17.showDropdown(true);\n      }\n    }, _focusActions[SELECT_MULTIPLE_TYPE] = function () {\n      if (target === _this17.input.element) {\n        _this17.showDropdown(true); // If element is a select box, the focused element is the container and the dropdown\n        // isn't already open, focus and show dropdown\n\n\n        _this17.containerOuter.addFocusState();\n      }\n    }, _focusActions);\n    focusActions[this.passedElement.element.type]();\n  };\n\n  _proto._onBlur = function _onBlur(_ref12) {\n    var _this18 = this;\n\n    var target = _ref12.target;\n    var blurWasWithinContainer = this.containerOuter.element.contains(target);\n\n    if (blurWasWithinContainer && !this._isScrollingOnIe) {\n      var _blurActions;\n\n      var activeItems = this._store.activeItems;\n      var hasHighlightedItems = activeItems.some(function (item) {\n        return item.highlighted;\n      });\n      var blurActions = (_blurActions = {}, _blurActions[TEXT_TYPE] = function () {\n        if (target === _this18.input.element) {\n          _this18.containerOuter.removeFocusState();\n\n          if (hasHighlightedItems) {\n            _this18.unhighlightAll();\n          }\n\n          _this18.hideDropdown(true);\n        }\n      }, _blurActions[SELECT_ONE_TYPE] = function () {\n        _this18.containerOuter.removeFocusState();\n\n        if (target === _this18.input.element || target === _this18.containerOuter.element && !_this18._canSearch) {\n          _this18.hideDropdown(true);\n        }\n      }, _blurActions[SELECT_MULTIPLE_TYPE] = function () {\n        if (target === _this18.input.element) {\n          _this18.containerOuter.removeFocusState();\n\n          _this18.hideDropdown(true);\n\n          if (hasHighlightedItems) {\n            _this18.unhighlightAll();\n          }\n        }\n      }, _blurActions);\n      blurActions[this.passedElement.element.type]();\n    } else {\n      // On IE11, clicking the scollbar blurs our input and thus\n      // closes the dropdown. To stop this, we refocus our input\n      // if we know we are on IE *and* are scrolling.\n      this._isScrollingOnIe = false;\n      this.input.element.focus();\n    }\n  };\n\n  _proto._onFormReset = function _onFormReset() {\n    this._store.dispatch(resetTo(this._initialState));\n  };\n\n  _proto._highlightChoice = function _highlightChoice(el) {\n    var _this19 = this;\n\n    if (el === void 0) {\n      el = null;\n    }\n\n    var choices = Array.from(this.dropdown.element.querySelectorAll('[data-choice-selectable]'));\n\n    if (!choices.length) {\n      return;\n    }\n\n    var passedEl = el;\n    var highlightedChoices = Array.from(this.dropdown.element.querySelectorAll(\".\" + this.config.classNames.highlightedState)); // Remove any highlighted choices\n\n    highlightedChoices.forEach(function (choice) {\n      choice.classList.remove(_this19.config.classNames.highlightedState);\n      choice.setAttribute('aria-selected', 'false');\n    });\n\n    if (passedEl) {\n      this._highlightPosition = choices.indexOf(passedEl);\n    } else {\n      // Highlight choice based on last known highlight location\n      if (choices.length > this._highlightPosition) {\n        // If we have an option to highlight\n        passedEl = choices[this._highlightPosition];\n      } else {\n        // Otherwise highlight the option before\n        passedEl = choices[choices.length - 1];\n      }\n\n      if (!passedEl) {\n        passedEl = choices[0];\n      }\n    }\n\n    passedEl.classList.add(this.config.classNames.highlightedState);\n    passedEl.setAttribute('aria-selected', 'true');\n    this.passedElement.triggerEvent(EVENTS.highlightChoice, {\n      el: passedEl\n    });\n\n    if (this.dropdown.isActive) {\n      // IE11 ignores aria-label and blocks virtual keyboard\n      // if aria-activedescendant is set without a dropdown\n      this.input.setActiveDescendant(passedEl.id);\n      this.containerOuter.setActiveDescendant(passedEl.id);\n    }\n  };\n\n  _proto._addItem = function _addItem(_ref13) {\n    var value = _ref13.value,\n        _ref13$label = _ref13.label,\n        label = _ref13$label === void 0 ? null : _ref13$label,\n        _ref13$choiceId = _ref13.choiceId,\n        choiceId = _ref13$choiceId === void 0 ? -1 : _ref13$choiceId,\n        _ref13$groupId = _ref13.groupId,\n        groupId = _ref13$groupId === void 0 ? -1 : _ref13$groupId,\n        _ref13$customProperti = _ref13.customProperties,\n        customProperties = _ref13$customProperti === void 0 ? null : _ref13$customProperti,\n        _ref13$placeholder = _ref13.placeholder,\n        placeholder = _ref13$placeholder === void 0 ? false : _ref13$placeholder,\n        _ref13$keyCode = _ref13.keyCode,\n        keyCode = _ref13$keyCode === void 0 ? null : _ref13$keyCode;\n    var passedValue = typeof value === 'string' ? value.trim() : value;\n    var passedKeyCode = keyCode;\n    var passedCustomProperties = customProperties;\n    var items = this._store.items;\n    var passedLabel = label || passedValue;\n    var passedOptionId = choiceId || -1;\n    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n    var id = items ? items.length + 1 : 1; // If a prepended value has been passed, prepend it\n\n    if (this.config.prependValue) {\n      passedValue = this.config.prependValue + passedValue.toString();\n    } // If an appended value has been passed, append it\n\n\n    if (this.config.appendValue) {\n      passedValue += this.config.appendValue.toString();\n    }\n\n    this._store.dispatch(items_addItem({\n      value: passedValue,\n      label: passedLabel,\n      id: id,\n      choiceId: passedOptionId,\n      groupId: groupId,\n      customProperties: customProperties,\n      placeholder: placeholder,\n      keyCode: passedKeyCode\n    }));\n\n    if (this._isSelectOneElement) {\n      this.removeActiveItems(id);\n    } // Trigger change event\n\n\n    this.passedElement.triggerEvent(EVENTS.addItem, {\n      id: id,\n      value: passedValue,\n      label: passedLabel,\n      customProperties: passedCustomProperties,\n      groupValue: group && group.value ? group.value : undefined,\n      keyCode: passedKeyCode\n    });\n    return this;\n  };\n\n  _proto._removeItem = function _removeItem(item) {\n    if (!item || !isType('Object', item)) {\n      return this;\n    }\n\n    var id = item.id,\n        value = item.value,\n        label = item.label,\n        choiceId = item.choiceId,\n        groupId = item.groupId;\n    var group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n\n    this._store.dispatch(items_removeItem(id, choiceId));\n\n    if (group && group.value) {\n      this.passedElement.triggerEvent(EVENTS.removeItem, {\n        id: id,\n        value: value,\n        label: label,\n        groupValue: group.value\n      });\n    } else {\n      this.passedElement.triggerEvent(EVENTS.removeItem, {\n        id: id,\n        value: value,\n        label: label\n      });\n    }\n\n    return this;\n  };\n\n  _proto._addChoice = function _addChoice(_ref14) {\n    var value = _ref14.value,\n        _ref14$label = _ref14.label,\n        label = _ref14$label === void 0 ? null : _ref14$label,\n        _ref14$isSelected = _ref14.isSelected,\n        isSelected = _ref14$isSelected === void 0 ? false : _ref14$isSelected,\n        _ref14$isDisabled = _ref14.isDisabled,\n        isDisabled = _ref14$isDisabled === void 0 ? false : _ref14$isDisabled,\n        _ref14$groupId = _ref14.groupId,\n        groupId = _ref14$groupId === void 0 ? -1 : _ref14$groupId,\n        _ref14$customProperti = _ref14.customProperties,\n        customProperties = _ref14$customProperti === void 0 ? null : _ref14$customProperti,\n        _ref14$placeholder = _ref14.placeholder,\n        placeholder = _ref14$placeholder === void 0 ? false : _ref14$placeholder,\n        _ref14$keyCode = _ref14.keyCode,\n        keyCode = _ref14$keyCode === void 0 ? null : _ref14$keyCode;\n\n    if (typeof value === 'undefined' || value === null) {\n      return;\n    } // Generate unique id\n\n\n    var choices = this._store.choices;\n    var choiceLabel = label || value;\n    var choiceId = choices ? choices.length + 1 : 1;\n    var choiceElementId = this._baseId + \"-\" + this._idNames.itemChoice + \"-\" + choiceId;\n\n    this._store.dispatch(choices_addChoice({\n      id: choiceId,\n      groupId: groupId,\n      elementId: choiceElementId,\n      value: value,\n      label: choiceLabel,\n      disabled: isDisabled,\n      customProperties: customProperties,\n      placeholder: placeholder,\n      keyCode: keyCode\n    }));\n\n    if (isSelected) {\n      this._addItem({\n        value: value,\n        label: choiceLabel,\n        choiceId: choiceId,\n        customProperties: customProperties,\n        placeholder: placeholder,\n        keyCode: keyCode\n      });\n    }\n  };\n\n  _proto._addGroup = function _addGroup(_ref15) {\n    var _this20 = this;\n\n    var group = _ref15.group,\n        id = _ref15.id,\n        _ref15$valueKey = _ref15.valueKey,\n        valueKey = _ref15$valueKey === void 0 ? 'value' : _ref15$valueKey,\n        _ref15$labelKey = _ref15.labelKey,\n        labelKey = _ref15$labelKey === void 0 ? 'label' : _ref15$labelKey;\n    var groupChoices = isType('Object', group) ? group.choices : Array.from(group.getElementsByTagName('OPTION'));\n    var groupId = id || Math.floor(new Date().valueOf() * Math.random());\n    var isDisabled = group.disabled ? group.disabled : false;\n\n    if (groupChoices) {\n      this._store.dispatch(groups_addGroup({\n        value: group.label,\n        id: groupId,\n        active: true,\n        disabled: isDisabled\n      }));\n\n      var addGroupChoices = function addGroupChoices(choice) {\n        var isOptDisabled = choice.disabled || choice.parentNode && choice.parentNode.disabled;\n\n        _this20._addChoice({\n          value: choice[valueKey],\n          label: isType('Object', choice) ? choice[labelKey] : choice.innerHTML,\n          isSelected: choice.selected,\n          isDisabled: isOptDisabled,\n          groupId: groupId,\n          customProperties: choice.customProperties,\n          placeholder: choice.placeholder\n        });\n      };\n\n      groupChoices.forEach(addGroupChoices);\n    } else {\n      this._store.dispatch(groups_addGroup({\n        value: group.label,\n        id: group.id,\n        active: false,\n        disabled: group.disabled\n      }));\n    }\n  };\n\n  _proto._getTemplate = function _getTemplate(template) {\n    var _this$_templates$temp;\n\n    if (!template) {\n      return null;\n    }\n\n    var classNames = this.config.classNames;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return (_this$_templates$temp = this._templates[template]).call.apply(_this$_templates$temp, [this, classNames].concat(args));\n  };\n\n  _proto._createTemplates = function _createTemplates() {\n    var callbackOnCreateTemplates = this.config.callbackOnCreateTemplates;\n    var userTemplates = {};\n\n    if (callbackOnCreateTemplates && typeof callbackOnCreateTemplates === 'function') {\n      userTemplates = callbackOnCreateTemplates.call(this, strToEl);\n    }\n\n    this._templates = cjs_default()(TEMPLATES, userTemplates);\n  };\n\n  _proto._createElements = function _createElements() {\n    this.containerOuter = new container_Container({\n      element: this._getTemplate('containerOuter', this._direction, this._isSelectElement, this._isSelectOneElement, this.config.searchEnabled, this.passedElement.element.type),\n      classNames: this.config.classNames,\n      type: this.passedElement.element.type,\n      position: this.config.position\n    });\n    this.containerInner = new container_Container({\n      element: this._getTemplate('containerInner'),\n      classNames: this.config.classNames,\n      type: this.passedElement.element.type,\n      position: this.config.position\n    });\n    this.input = new input_Input({\n      element: this._getTemplate('input', this._placeholderValue),\n      classNames: this.config.classNames,\n      type: this.passedElement.element.type,\n      preventPaste: !this.config.paste\n    });\n    this.choiceList = new list_List({\n      element: this._getTemplate('choiceList', this._isSelectOneElement)\n    });\n    this.itemList = new list_List({\n      element: this._getTemplate('itemList', this._isSelectOneElement)\n    });\n    this.dropdown = new Dropdown({\n      element: this._getTemplate('dropdown'),\n      classNames: this.config.classNames,\n      type: this.passedElement.element.type\n    });\n  };\n\n  _proto._createStructure = function _createStructure() {\n    // Hide original element\n    this.passedElement.conceal(); // Wrap input in container preserving DOM ordering\n\n    this.containerInner.wrap(this.passedElement.element); // Wrapper inner container with outer container\n\n    this.containerOuter.wrap(this.containerInner.element);\n\n    if (this._isSelectOneElement) {\n      this.input.placeholder = this.config.searchPlaceholderValue || '';\n    } else if (this._placeholderValue) {\n      this.input.placeholder = this._placeholderValue;\n      this.input.setWidth();\n    }\n\n    this.containerOuter.element.appendChild(this.containerInner.element);\n    this.containerOuter.element.appendChild(this.dropdown.element);\n    this.containerInner.element.appendChild(this.itemList.element);\n\n    if (!this._isTextElement) {\n      this.dropdown.element.appendChild(this.choiceList.element);\n    }\n\n    if (!this._isSelectOneElement) {\n      this.containerInner.element.appendChild(this.input.element);\n    } else if (this.config.searchEnabled) {\n      this.dropdown.element.insertBefore(this.input.element, this.dropdown.element.firstChild);\n    }\n\n    if (this._isSelectElement) {\n      this._highlightPosition = 0;\n      this._isSearching = false;\n\n      this._startLoading();\n\n      if (this._presetGroups.length) {\n        this._addPredefinedGroups(this._presetGroups);\n      } else {\n        this._addPredefinedChoices(this._presetChoices);\n      }\n\n      this._stopLoading();\n    }\n\n    if (this._isTextElement) {\n      this._addPredefinedItems(this._presetItems);\n    }\n  };\n\n  _proto._addPredefinedGroups = function _addPredefinedGroups(groups) {\n    var _this21 = this;\n\n    // If we have a placeholder option\n    var placeholderChoice = this.passedElement.placeholderOption;\n\n    if (placeholderChoice && placeholderChoice.parentNode.tagName === 'SELECT') {\n      this._addChoice({\n        value: placeholderChoice.value,\n        label: placeholderChoice.innerHTML,\n        isSelected: placeholderChoice.selected,\n        isDisabled: placeholderChoice.disabled,\n        placeholder: true\n      });\n    }\n\n    groups.forEach(function (group) {\n      return _this21._addGroup({\n        group: group,\n        id: group.id || null\n      });\n    });\n  };\n\n  _proto._addPredefinedChoices = function _addPredefinedChoices(choices) {\n    var _this22 = this;\n\n    // If sorting is enabled or the user is searching, filter choices\n    if (this.config.shouldSort) {\n      choices.sort(this.config.sorter);\n    }\n\n    var hasSelectedChoice = choices.some(function (choice) {\n      return choice.selected;\n    });\n    var firstEnabledChoiceIndex = choices.findIndex(function (choice) {\n      return choice.disabled === undefined || !choice.disabled;\n    });\n    choices.forEach(function (choice, index) {\n      var value = choice.value,\n          label = choice.label,\n          customProperties = choice.customProperties,\n          placeholder = choice.placeholder;\n\n      if (_this22._isSelectElement) {\n        // If the choice is actually a group\n        if (choice.choices) {\n          _this22._addGroup({\n            group: choice,\n            id: choice.id || null\n          });\n        } else {\n          /**\n           * If there is a selected choice already or the choice is not the first in\n           * the array, add each choice normally.\n           *\n           * Otherwise we pre-select the first enabled choice in the array (\"select-one\" only)\n           */\n          var shouldPreselect = _this22._isSelectOneElement && !hasSelectedChoice && index === firstEnabledChoiceIndex;\n          var isSelected = shouldPreselect ? true : choice.selected;\n          var isDisabled = choice.disabled;\n\n          _this22._addChoice({\n            value: value,\n            label: label,\n            isSelected: isSelected,\n            isDisabled: isDisabled,\n            customProperties: customProperties,\n            placeholder: placeholder\n          });\n        }\n      } else {\n        _this22._addChoice({\n          value: value,\n          label: label,\n          isSelected: choice.selected,\n          isDisabled: choice.disabled,\n          customProperties: customProperties,\n          placeholder: placeholder\n        });\n      }\n    });\n  }\n  /**\n   * @param {Item[]} items\n   */\n  ;\n\n  _proto._addPredefinedItems = function _addPredefinedItems(items) {\n    var _this23 = this;\n\n    items.forEach(function (item) {\n      if (typeof item === 'object' && item.value) {\n        _this23._addItem({\n          value: item.value,\n          label: item.label,\n          choiceId: item.id,\n          customProperties: item.customProperties,\n          placeholder: item.placeholder\n        });\n      }\n\n      if (typeof item === 'string') {\n        _this23._addItem({\n          value: item\n        });\n      }\n    });\n  };\n\n  _proto._setChoiceOrItem = function _setChoiceOrItem(item) {\n    var _this24 = this;\n\n    var itemType = getType(item).toLowerCase();\n    var handleType = {\n      object: function object() {\n        if (!item.value) {\n          return;\n        } // If we are dealing with a select input, we need to create an option first\n        // that is then selected. For text inputs we can just add items normally.\n\n\n        if (!_this24._isTextElement) {\n          _this24._addChoice({\n            value: item.value,\n            label: item.label,\n            isSelected: true,\n            isDisabled: false,\n            customProperties: item.customProperties,\n            placeholder: item.placeholder\n          });\n        } else {\n          _this24._addItem({\n            value: item.value,\n            label: item.label,\n            choiceId: item.id,\n            customProperties: item.customProperties,\n            placeholder: item.placeholder\n          });\n        }\n      },\n      string: function string() {\n        if (!_this24._isTextElement) {\n          _this24._addChoice({\n            value: item,\n            label: item,\n            isSelected: true,\n            isDisabled: false\n          });\n        } else {\n          _this24._addItem({\n            value: item\n          });\n        }\n      }\n    };\n    handleType[itemType]();\n  };\n\n  _proto._findAndSelectChoiceByValue = function _findAndSelectChoiceByValue(val) {\n    var _this25 = this;\n\n    var choices = this._store.choices; // Check 'value' property exists and the choice isn't already selected\n\n    var foundChoice = choices.find(function (choice) {\n      return _this25.config.valueComparer(choice.value, val);\n    });\n\n    if (foundChoice && !foundChoice.selected) {\n      this._addItem({\n        value: foundChoice.value,\n        label: foundChoice.label,\n        choiceId: foundChoice.id,\n        groupId: foundChoice.groupId,\n        customProperties: foundChoice.customProperties,\n        placeholder: foundChoice.placeholder,\n        keyCode: foundChoice.keyCode\n      });\n    }\n  };\n\n  _proto._generatePlaceholderValue = function _generatePlaceholderValue() {\n    if (this._isSelectElement) {\n      var placeholderOption = this.passedElement.placeholderOption;\n      return placeholderOption ? placeholderOption.text : false;\n    }\n\n    var _this$config4 = this.config,\n        placeholder = _this$config4.placeholder,\n        placeholderValue = _this$config4.placeholderValue;\n    var dataset = this.passedElement.element.dataset;\n\n    if (placeholder) {\n      if (placeholderValue) {\n        return placeholderValue;\n      }\n\n      if (dataset.placeholder) {\n        return dataset.placeholder;\n      }\n    }\n\n    return false;\n  };\n\n  return Choices;\n}();\n\n/* harmony default export */ var scripts_choices = __webpack_exports__[\"default\"] = (choices_Choices);\n\n/***/ })\n/******/ ])[\"default\"];\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY2hvaWNlcy5qcy9wdWJsaWMvYXNzZXRzL3NjcmlwdHMvY2hvaWNlcy5qcz8wNmQ4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQSxJQUFJLElBQXlEO0FBQzdEO0FBQ0EsTUFBTSxFQUt3QjtBQUM5QixDQUFDO0FBQ0Qsb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhCQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSw4QkFBbUI7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDhCQUFtQjtBQUM3QjtBQUNBO0FBQ0EsVUFBVSw4QkFBbUI7QUFDN0I7QUFDQTtBQUNBLFVBQVUsOEJBQW1CO0FBQzdCLGVBQWUsOEJBQW1CO0FBQ2xDLGtEQUFrRCxnQ0FBZ0M7QUFDbEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDhCQUFtQjtBQUM3QjtBQUNBLGdFQUFnRSxrQkFBa0I7QUFDbEY7QUFDQSx5REFBeUQsY0FBYztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsOEJBQW1CO0FBQzdCLGdDQUFnQyw4QkFBbUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsV0FBVyw4QkFBbUI7QUFDOUIsaURBQWlELGlDQUFpQztBQUNsRiwwRUFBMEUsOEJBQW1CLDJCQUEyQixtQkFBbUIsRUFBRTtBQUM3STtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsOEJBQW1CO0FBQzdCO0FBQ0EsbUNBQW1DLDBCQUEwQixFQUFFO0FBQy9ELHlDQUF5QyxlQUFlO0FBQ3hELFdBQVcsOEJBQW1CO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSw4QkFBbUIsaUNBQWlDLCtEQUErRDtBQUM3SDtBQUNBO0FBQ0EsVUFBVSw4QkFBbUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLDhCQUFtQixDQUFDLDhCQUFtQjtBQUN4RCxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUUsSUFBSTtBQUNOOztBQUVBOztBQUVBOzs7QUFHQSxPQUFPO0FBQ1A7QUFDQSw2Q0FBNkMsK0JBQW1COztBQUVoRTtBQUNBLHNEQUFzRCxxRUFBcUUsK0JBQW1CO0FBQzlJOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsQ0FBQyxVQUFVLElBQUk7QUFDZjtBQUNBLENBQUMsTUFBTSxFQUFFOztBQUVUO0FBQ0E7O0FBRUEsNEJBQTRCLFlBQVksK0JBQW1CLEtBQUssK0JBQW1COztBQUVuRixPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxDQUFDLEtBQUksb0JBQW9CLENBQVMsQ0FBQyxpQkFBaUIsbUJBQW1CLFNBQVMsY0FBYyw0QkFBNEIsWUFBWSxxQkFBcUIsMkRBQTJELHVDQUF1QyxxQ0FBcUMsb0JBQW9CLEVBQUUsaUJBQWlCLDRGQUE0RixlQUFlLHdDQUF3QyxTQUFTLEVBQUUsbUJBQW1CLDhCQUE4QixxREFBcUQsMEJBQTBCLDZDQUE2QyxzQkFBc0IsNkRBQTZELFlBQVksZUFBZSxTQUFTLGlCQUFpQixpQ0FBaUMsaUJBQWlCLFlBQVksVUFBVSxzQkFBc0IsbUJBQW1CLGlEQUFpRCxpQkFBaUIsZ0JBQWdCLHNCQUFzQiw0RkFBNEYsaUJBQWlCLGNBQWMsaUZBQWlGLGdCQUFnQixhQUFhLG9HQUFvRyxLQUFLLGdCQUFnQixZQUFZLFdBQVcsS0FBSyxXQUFXLCtHQUErRyxzQ0FBc0MsZ0JBQWdCLG9iQUFvYix1QkFBdUIsbUtBQW1LLGVBQWUsOEVBQThFLHVCQUF1Qiw4T0FBOE8sdUJBQXVCLFVBQVUsZ0JBQWdCLHNDQUFzQyxzQkFBc0IsRUFBRSwrQkFBK0IsOERBQThELFVBQVUsd0RBQXdELGdIQUFnSCxpSkFBaUosRUFBRSx5Q0FBeUMscUVBQXFFLHVGQUF1RixJQUFJLHNDQUFzQyxPQUFPLHNEQUFzRCxFQUFFLCtCQUErQix5SEFBeUgsTUFBTSwwQkFBMEIsdUJBQXVCLElBQUksb0JBQW9CLG1DQUFtQyxFQUFFLHNEQUFzRCxFQUFFLE9BQU8sd0JBQXdCLFlBQVksZ0JBQWdCLElBQUksbURBQW1ELElBQUksTUFBTSwyQkFBMkIsdUJBQXVCLGNBQWMscUJBQXFCLDhFQUE4RSxTQUFTLFdBQVcsVUFBVSxlQUFlLHFEQUFxRCxFQUFFLHNEQUFzRCxFQUFFLE9BQU8sc0JBQXNCLEVBQUUsbUNBQW1DLGlMQUFpTCxpQ0FBaUMsWUFBWSxrQkFBa0IsdUJBQXVCLDBDQUEwQyxrQkFBa0IsMkZBQTJGLHdEQUF3RCxXQUFXLE1BQU0sV0FBVyxnREFBZ0QsaUJBQWlCLFdBQVcsTUFBTSw4QkFBOEIsNkpBQTZKLFVBQVUsT0FBTyx1QkFBdUIsSUFBSSxhQUFhLHlDQUF5QyxjQUFjLGdEQUFnRCx3RUFBd0UsK0RBQStELFdBQVcsaUJBQWlCLG1FQUFtRSxTQUFTLGdCQUFnQixtRUFBbUUsRUFBRSxnQkFBZ0Isb0NBQW9DLElBQUksb0JBQW9CLCtDQUErQyxFQUFFLHNEQUFzRCxJQUFJLEVBQUUsd0NBQXdDLG9DQUFvQyx1QkFBdUIsSUFBSSxNQUFNLDZDQUE2QyxJQUFJLE1BQU0scUVBQXFFLDJDQUEyQyx1Q0FBdUMsRUFBRSw4QkFBOEIsMERBQTBELEVBQUUsZ0NBQWdDLFNBQVMseUJBQXlCLFNBQVMsMkRBQTJELDhCQUE4Qiw0QkFBNEIsVUFBVSxTQUFTLFVBQVUsU0FBUyxrREFBa0QsZUFBZSxhQUFhLHVCQUF1QixJQUFJLE1BQU0sV0FBVyxnQ0FBZ0MsT0FBTyx3Q0FBd0Msc0hBQXNILGtEQUFrRCxnQkFBZ0IsRUFBRSx1QkFBdUIsSUFBSSxNQUFNLFdBQVcscUZBQXFGLFdBQVcsWUFBWSxnQkFBZ0IsSUFBSSxlQUFlLFVBQVUsb0JBQW9CLFVBQVUsRUFBRSw0QkFBNEIsTUFBTSwwREFBMEQsaUNBQWlDLEdBQUcsWUFBWSxpQkFBaUIsZ0JBQWdCLFlBQVksV0FBVyxLQUFLLFdBQVcsK0dBQStHLHNDQUFzQyxnQkFBZ0IsZ1NBQWdTLGVBQWUsOEVBQThFLHVCQUF1Qiw4SEFBOEgsNEhBQTRILFVBQVUsZ0JBQWdCLCtCQUErQiw2RUFBNkUsb0RBQW9ELDJEQUEyRCxvREFBb0QscUdBQXFHLDhDQUE4Qyx3RUFBd0UsR0FBRyxpQ0FBaUMsR0FBRyxZQUFZLGVBQWUsa0JBQWtCLEVBQUUsd0JBQXdCLHdCQUF3Qiw0SUFBNEksNEJBQTRCLElBQUksTUFBTSxXQUFXLGtDQUFrQyxPQUFPLDBDQUEwQyxpQkFBaUIsa0JBQWtCLDRCQUE0Qix5T0FBeU8sSUFBSSxZQUFZLFdBQVcsV0FBVyx5REFBeUQsRUFBRSxrREFBa0QsV0FBVyx5REFBeUQsRUFBRSxpQkFBaUIsS0FBSyxvQ0FBb0MsSUFBSSxNQUFNLGdCQUFnQixJQUFJLEVBQUUsS0FBSywyREFBMkQscUNBQXFDLElBQUksNkRBQTZELGdCQUFnQixZQUFZLEtBQUssTUFBTSwyQkFBMkIsNkZBQTZGLHlEQUF5RCxPQUFPLHNCQUFzQixxQkFBcUIsUUFBUSwyREFBMkQsVUFBVSxJQUFJLE9BQU8sd0RBQXdELGVBQWUsd0JBQXdCLHdLQUF3SyxzQkFBc0IsZUFBZSxxQkFBcUIsNkpBQTZKLElBQUksTUFBTSxXQUFXLDhEQUE4RCwwQ0FBMEMsZUFBZSxzQkFBc0IsWUFBWSxnQkFBZ0IsSUFBSSxzQkFBc0IsWUFBWSxJQUFJLDhCQUE4QixVQUFVLGlCQUFpQixXQUFXLHdCQUF3Qix5QkFBeUIsTUFBTSxnQ0FBZ0Msd0NBQXdDLFdBQVcsdUZBQXVGLElBQUksaUJBQWlCLGlCQUFpQiwwQkFBMEIsZUFBZSxTQUFTLFVBQVUsR0FBRzs7QUFFdjFWLE9BQU87QUFDUDtBQUNBLDZDQUE2QyxnQ0FBbUI7O0FBRWhFO0FBQ0EsK0JBQStCLGdDQUFtQix5Q0FBeUMsaUNBQWlDLEVBQUU7QUFDOUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQSxPQUFPO0FBQ1A7QUFDQSxpQ0FBaUMsZ0NBQW1COztBQUVwRCxpQkFBaUIsZ0NBQW1COzs7QUFHcEMsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw0Q0FBNEM7O0FBRTVDOzs7QUFHQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7OztBQUdBLE9BQU87QUFDUDtBQUNBLDZDQUE2QyxnQ0FBbUI7O0FBRWhFO0FBQ0EsZ0NBQW1COztBQUVuQjtBQUNBLGdCQUFnQixnQ0FBbUI7QUFDbkMsZ0NBQWdDLGdDQUFtQjs7QUFFbkQ7QUFDQSxVQUFVLGdDQUFtQjtBQUM3QiwrQkFBK0IsZ0NBQW1COztBQUVsRDtBQUNBLFNBQVMsZ0NBQW1COztBQUU1Qjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVyxJQUFJO0FBQ2YsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBLFdBQVcsSUFBSTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFNBQVM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkI7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsSUFBSTtBQUNuQjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFNBQVM7QUFDdEIsZUFBZSxTQUFTO0FBQ3hCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQSxtQkFBbUIsc0JBQXNCO0FBQ3pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLFNBQVM7QUFDdEIsZUFBZTtBQUNmOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsZUFBZSxXQUFXO0FBQzFCO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0EsbUJBQW1CLGFBQWE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxhQUFhOztBQUVoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvRUFBb0U7QUFDcEU7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxTQUFTO0FBQ3RCO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsd0JBQXdCO0FBQ3pDOztBQUVBLFFBQVEsS0FBSyxFQUFFLEVBQUU7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG9EQUFvRDtBQUNwRDs7QUFFQTs7QUFFQSxNQUFNLEtBQUssRUFBRSxFQUFFOztBQUVmOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsUUFBUSxLQUFLLEVBQUUsdUJBQXVCOztBQUV0QztBQUNBOztBQUVBLG9CQUFvQiw4QkFBOEI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxnQkFBZ0I7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsV0FBVyxTQUFTO0FBQ3BCO0FBQ0E7QUFDQSxhQUFhLGdCQUFnQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkM7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxZQUFZO0FBQ3ZCLGFBQWEsU0FBUztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSxhQUFhO0FBQ25GO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkIsYUFBYSxTQUFTO0FBQ3RCOztBQUVBO0FBQ0EsNEVBQTRFLGFBQWE7QUFDekY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLElBQUksS0FBSyxFQUFFLEVBQUU7Ozs7QUFJYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVztBQUNYOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEIsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLE9BQU87QUFDbEIsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsV0FBVyxxQ0FBcUM7QUFDaEQsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsSUFBSTtBQUNmLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLElBQUk7QUFDZixhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFlBQVk7QUFDdkIsV0FBVyxZQUFZLFdBQVcsZUFBZTtBQUNqRCxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLE9BQU87QUFDbEIsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsUUFBUTtBQUNuQixXQUFXLFFBQVE7QUFDbkIsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLElBQUk7QUFDZixhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsbUNBQW1DLHNCQUFzQixzQkFBc0Isd0JBQXdCO0FBQ3ZHO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsWUFBWSxpQ0FBaUM7QUFDN0MsWUFBWSxpQ0FBaUM7QUFDN0MsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFlBQVksaUJBQWlCO0FBQzdCLFlBQVksaUJBQWlCO0FBQzdCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxZQUFZO0FBQ3ZCLFdBQVcsT0FBTztBQUNsQixXQUFXLE9BQU87QUFDbEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsV0FBVyxNQUFNO0FBQ2pCLFdBQVcsSUFBSTtBQUNmLFdBQVcsT0FBTztBQUNsQixhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFdBQVcsSUFBSTtBQUNmLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSwyQ0FBMkMsZ0JBQWdCLGtCQUFrQixPQUFPLDJCQUEyQix3REFBd0QsZ0NBQWdDLHVEQUF1RCwyREFBMkQsRUFBRTs7QUFFM1QsNkRBQTZELHNFQUFzRSw4REFBOEQsb0JBQW9COzs7O0FBSXJOO0FBQ0EsYUFBYSw4Q0FBOEM7QUFDM0QsYUFBYSw2Q0FBNkM7QUFDMUQsYUFBYSw0Q0FBNEM7QUFDekQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsU0FBUztBQUN2QjtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxrQ0FBa0M7QUFDakQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLG1CQUFtQjtBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckIsZUFBZSxrQkFBa0I7QUFDakM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsT0FBTztBQUN4Qjs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLE9BQU87QUFDeEI7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFNBQVM7QUFDMUI7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixTQUFTO0FBQzFCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUztBQUMxQjs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLG1CQUFtQjtBQUNwQzs7QUFFQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFFBQVE7QUFDekI7O0FBRUEsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixRQUFRO0FBQ3pCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLENBQUM7OztBQUdEO0FBQ0EsbURBQW1ELGdCQUFnQixrQkFBa0IsT0FBTywyQkFBMkIsd0RBQXdELGdDQUFnQyx1REFBdUQsMkRBQTJELEVBQUU7O0FBRW5VLHFFQUFxRSw4RUFBOEUsc0VBQXNFLG9CQUFvQjs7QUFFN087QUFDQSxhQUFhLHFEQUFxRDtBQUNsRSxhQUFhLGtEQUFrRDtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsQ0FBQzs7O0FBR0Q7O0FBRUE7QUFDQSxhQUFhLCtDQUErQztBQUM1RCxhQUFhLDRDQUE0QztBQUN6RDs7QUFFQSxXQUFXLFdBQVc7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxRQUFROztBQUVuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQSxhQUFhLHFEQUFxRDtBQUNsRSxhQUFhLGtEQUFrRDtBQUMvRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7O0FBRXhCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsWUFBWTtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxRQUFRO0FBQ3JCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdFQUFnRTs7QUFFaEU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLENBQUM7OztBQUdEO0FBQ0EsZ0RBQWdELGdCQUFnQixrQkFBa0IsT0FBTywyQkFBMkIsd0RBQXdELGdDQUFnQyx1REFBdUQsMkRBQTJELEVBQUU7O0FBRWhVLGtFQUFrRSwyRUFBMkUsbUVBQW1FLG9CQUFvQjs7OztBQUlwTztBQUNBLGFBQWEscURBQXFEO0FBQ2xFLGFBQWEsa0RBQWtEO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEI7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQixlQUFlO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsQ0FBQzs7O0FBR0Q7O0FBRUE7QUFDQSxhQUFhLDhDQUE4QztBQUMzRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0JBQXdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwyQkFBMkI7QUFDeEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlO0FBQ2Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUTtBQUNyQixhQUFhLE9BQU87QUFDcEI7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSwrQ0FBK0M7O0FBRS9DO0FBQ0EsNkNBQTZDOztBQUU3Qyx1REFBdUQ7O0FBRXZEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsRUFBRTtBQUNmLGFBQWEsRUFBRTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQSxDQUFDOzs7QUFHRDtBQUNBLDBEQUEwRCxnQkFBZ0Isa0JBQWtCLE9BQU8sMkJBQTJCLHdEQUF3RCxnQ0FBZ0MsdURBQXVELDJEQUEyRCxFQUFFOztBQUUxVSw0RUFBNEUscUZBQXFGLDZFQUE2RSxvQkFBb0I7OztBQUdsUTtBQUNBLGFBQWEscURBQXFEO0FBQ2xFLGFBQWEsa0RBQWtEO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0I7O0FBRS9CLCtCQUErQjs7QUFFL0I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7O0FBRTdDOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBLGdEQUFnRDtBQUNoRDs7QUFFQSw0Q0FBNEM7QUFDNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxDQUFDOzs7QUFHRDtBQUNBLHdEQUF3RCxnQkFBZ0Isa0JBQWtCLE9BQU8sMkJBQTJCLHdEQUF3RCxnQ0FBZ0MsdURBQXVELDJEQUEyRCxFQUFFOztBQUV4VSwwRUFBMEUsbUZBQW1GLDJFQUEyRSxvQkFBb0I7O0FBRTVQLCtDQUErQywwREFBMEQsMkNBQTJDLGlDQUFpQzs7O0FBR3JMO0FBQ0EsYUFBYSxrREFBa0Q7QUFDL0QsYUFBYSw0Q0FBNEM7QUFDekQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLENBQUM7OztBQUdEO0FBQ0EseURBQXlELGdCQUFnQixrQkFBa0IsT0FBTywyQkFBMkIsd0RBQXdELGdDQUFnQyx1REFBdUQsMkRBQTJELEVBQUU7O0FBRXpVLDJFQUEyRSxvRkFBb0YsNEVBQTRFLG9CQUFvQjs7QUFFL1AsNkRBQTZELDBEQUEwRCwyQ0FBMkMsaUNBQWlDOzs7QUFHbk07QUFDQSxhQUFhLGtEQUFrRDtBQUMvRCxhQUFhLDRDQUE0QztBQUN6RCxhQUFhLDhDQUE4QztBQUMzRDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxhQUFhLGlCQUFpQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxrQkFBa0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLDJDQUEyQzs7O0FBRzNDO0FBQ0EsUUFBUTs7O0FBR1I7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLENBQUM7OztBQUdEOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw4Q0FBOEM7QUFDM0QsYUFBYSwrQ0FBK0M7QUFDNUQsYUFBYSw0Q0FBNEM7QUFDekQsYUFBYSx5Q0FBeUM7QUFDdEQsYUFBYSwyQ0FBMkM7QUFDeEQsYUFBYSwwQ0FBMEM7QUFDdkQ7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQjtBQUNBO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSxRQUFRO0FBQ3JCLGFBQWEsUUFBUTtBQUNyQixhQUFhLFFBQVE7QUFDckIsYUFBYSwwQ0FBMEM7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRzs7QUFFSDtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxPQUFPO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHOztBQUVIO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakMsYUFBYSxLQUFLO0FBQ2xCLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsUUFBUTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7O0FBRUg7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLE9BQU87QUFDcEIsYUFBYSwwQkFBMEI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxhQUFhLG9CQUFvQjtBQUNqQyxhQUFhLE9BQU87QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsYUFBYSxvQkFBb0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLGFBQWEsb0JBQW9CO0FBQ2pDLGFBQWEsT0FBTztBQUNwQixhQUFhLGlDQUFpQztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRzs7QUFFSDtBQUNBLGFBQWEsS0FBSztBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsdUJBQXVCO0FBQ3BDLGFBQWEsOENBQThDO0FBQzNEOztBQUVBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLFNBQVM7QUFDdkIsYUFBYSxVQUFVO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxRQUFRO0FBQ3RCLGFBQWEsVUFBVTtBQUN2Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsYUFBYSx1QkFBdUI7QUFDcEMsYUFBYSw0Q0FBNEM7QUFDekQ7O0FBRUE7QUFDQSxXQUFXLEtBQUs7QUFDaEIsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLFdBQVcsT0FBTztBQUNsQixhQUFhLFVBQVU7QUFDdkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixXQUFXLFFBQVE7QUFDbkIsYUFBYSxVQUFVO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxhQUFhLHVCQUF1QjtBQUNwQyxhQUFhLDZDQUE2QztBQUMxRDs7QUFFQTtBQUNBLFdBQVcsTUFBTTtBQUNqQixhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSx1QkFBdUI7QUFDcEM7O0FBRUE7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLElBQUk7QUFDZixhQUFhLFVBQVU7QUFDdkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLFFBQVE7QUFDbkIsYUFBYSxVQUFVO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELGdCQUFnQixrQkFBa0IsT0FBTywyQkFBMkIsd0RBQXdELGdDQUFnQyx1REFBdUQsMkRBQTJELEVBQUU7O0FBRWxVLG9FQUFvRSw2RUFBNkUscUVBQXFFLG9CQUFvQjs7Ozs7Ozs7Ozs7OztBQWExTyxVQUFVLHFFQUFxRTs7QUFFL0U7QUFDQTtBQUNBLGFBQWEsMkNBQTJDO0FBQ3hELGFBQWEseUNBQXlDO0FBQ3RELGFBQWEsMENBQTBDO0FBQ3ZELGFBQWEsNENBQTRDO0FBQ3pEOztBQUVBLFdBQVcsaUJBQWlCOztBQUU1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBLE9BQU87QUFDUDtBQUNBO0FBQ0EsZUFBZSw4Q0FBOEM7QUFDN0QsZUFBZSxpQkFBaUI7QUFDaEM7O0FBRUEsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsZUFBZSxpQkFBaUI7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTix5REFBeUQ7O0FBRXpELHFEQUFxRDs7QUFFckQsOENBQThDOztBQUU5QywwQ0FBMEM7O0FBRTFDO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRDs7QUFFckQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsNEJBQTRCO0FBQzVCOzs7QUFHQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvREFBb0Q7O0FBRXBEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7O0FBRUw7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtCQUErQjtBQUMvQjs7O0FBR0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBLCtEQUErRDtBQUMvRCxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSwrREFBK0Q7QUFDL0QsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLGFBQWEsc0RBQXNEO0FBQ25FO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7OztBQUdMLDZEQUE2RDs7QUFFN0Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsaUVBQWlFO0FBQ2pGLGFBQWEsRUFBRTtBQUNmLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsYUFBYSxRQUFRO0FBQ3JCLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlEQUFpRDtBQUN6RCxRQUFRLGlEQUFpRDtBQUN6RCxRQUFRLHFDQUFxQztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsdURBQXVEO0FBQ2pFLFVBQVUsd0RBQXdEO0FBQ2xFLFVBQVUsMkNBQTJDO0FBQ3JEO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHlEQUF5RDtBQUNuRSxVQUFVLHlDQUF5QztBQUNuRCxVQUFVO0FBQ1Y7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxPQUFPOzs7QUFHUDtBQUNBO0FBQ0EsT0FBTzs7O0FBR1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTs7QUFFQSx1RUFBdUU7OztBQUd2RTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCOztBQUVBLGtFQUFrRTs7O0FBR2xFO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxPQUFPO0FBQ1AsTUFBTTs7O0FBR047QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsNERBQTREOzs7QUFHNUQ7QUFDQTtBQUNBOztBQUVBLGlEQUFpRDs7QUFFakQ7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7OztBQUdMLG1CQUFtQixpQkFBaUI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRDs7QUFFMUQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBFQUEwRTs7O0FBRzFFO0FBQ0EsTUFBTTs7O0FBR047QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87O0FBRVA7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUssRUFBRTs7QUFFUDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsbURBQW1EO0FBQ25EO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxLQUFLLEVBQUU7QUFDUDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7OztBQUdMOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1EQUFtRDs7QUFFbkQ7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBLHNCQUFzQjs7QUFFdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLLEVBQUU7QUFDUDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxFQUFFOztBQUVQO0FBQ0EsdUVBQXVFOztBQUV2RTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLOzs7QUFHTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0RBQW9EOztBQUVwRDtBQUNBO0FBQ0EsdUZBQXVGOztBQUV2RjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsY0FBYztBQUMzQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1EOztBQUVuRDtBQUNBO0FBQ0EsS0FBSzs7O0FBR0wsOENBQThDLHFjQUFxYzs7QUFFbmY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSx5Q0FBeUM7QUFDekM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4Qzs7QUFFOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsT0FBTztBQUNQOzs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxPQUFPOzs7QUFHUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxXQUFXO0FBQ3hCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFlBQVk7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxXQUFXO0FBQ3hCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxtQ0FBbUM7QUFDbkM7OztBQUdBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsMENBQTBDO0FBQzFDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtIQUErSDs7QUFFL0g7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDOztBQUUxQztBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7OztBQUdMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7O0FBR0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPOztBQUVQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsMEZBQTBGLGFBQWE7QUFDdkc7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0EsaUNBQWlDOztBQUVqQyx5REFBeUQ7O0FBRXpEOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNUO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHNDQUFzQzs7QUFFdEM7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQSxPQUFPO0FBQ1A7QUFDQSxDQUFDIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL2Nob2ljZXMuanMvcHVibGljL2Fzc2V0cy9zY3JpcHRzL2Nob2ljZXMuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgY2hvaWNlcy5qcyB2OS4wLjEgfCDCqSAyMDE5IEpvc2ggSm9obnNvbiB8IGh0dHBzOi8vZ2l0aHViLmNvbS9qc2hqb2huc29uL0Nob2ljZXMjcmVhZG1lICovXG4oZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJDaG9pY2VzXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkNob2ljZXNcIl0gPSBmYWN0b3J5KCk7XG59KSh3aW5kb3csIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4vKioqKioqLyBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLyoqKioqKi8gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbi8qKioqKiovIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vKioqKioqLyBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLyoqKioqKi8gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbi8qKioqKiovIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuLyoqKioqKi8gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbi8qKioqKiovIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuLyoqKioqKi8gXHRcdHJldHVybiBucztcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvcHVibGljL2Fzc2V0cy9zY3JpcHRzL1wiO1xuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0KTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIGlzTWVyZ2VhYmxlT2JqZWN0ID0gZnVuY3Rpb24gaXNNZXJnZWFibGVPYmplY3QodmFsdWUpIHtcblx0cmV0dXJuIGlzTm9uTnVsbE9iamVjdCh2YWx1ZSlcblx0XHQmJiAhaXNTcGVjaWFsKHZhbHVlKVxufTtcblxuZnVuY3Rpb24gaXNOb25OdWxsT2JqZWN0KHZhbHVlKSB7XG5cdHJldHVybiAhIXZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCdcbn1cblxuZnVuY3Rpb24gaXNTcGVjaWFsKHZhbHVlKSB7XG5cdHZhciBzdHJpbmdWYWx1ZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG5cblx0cmV0dXJuIHN0cmluZ1ZhbHVlID09PSAnW29iamVjdCBSZWdFeHBdJ1xuXHRcdHx8IHN0cmluZ1ZhbHVlID09PSAnW29iamVjdCBEYXRlXSdcblx0XHR8fCBpc1JlYWN0RWxlbWVudCh2YWx1ZSlcbn1cblxuLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9mYWNlYm9vay9yZWFjdC9ibG9iL2I1YWM5NjNmYjc5MWQxMjk4ZTdmMzk2MjM2MzgzYmM5NTVmOTE2YzEvc3JjL2lzb21vcnBoaWMvY2xhc3NpYy9lbGVtZW50L1JlYWN0RWxlbWVudC5qcyNMMjEtTDI1XG52YXIgY2FuVXNlU3ltYm9sID0gdHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBTeW1ib2wuZm9yO1xudmFyIFJFQUNUX0VMRU1FTlRfVFlQRSA9IGNhblVzZVN5bWJvbCA/IFN5bWJvbC5mb3IoJ3JlYWN0LmVsZW1lbnQnKSA6IDB4ZWFjNztcblxuZnVuY3Rpb24gaXNSZWFjdEVsZW1lbnQodmFsdWUpIHtcblx0cmV0dXJuIHZhbHVlLiQkdHlwZW9mID09PSBSRUFDVF9FTEVNRU5UX1RZUEVcbn1cblxuZnVuY3Rpb24gZW1wdHlUYXJnZXQodmFsKSB7XG5cdHJldHVybiBBcnJheS5pc0FycmF5KHZhbCkgPyBbXSA6IHt9XG59XG5cbmZ1bmN0aW9uIGNsb25lVW5sZXNzT3RoZXJ3aXNlU3BlY2lmaWVkKHZhbHVlLCBvcHRpb25zKSB7XG5cdHJldHVybiAob3B0aW9ucy5jbG9uZSAhPT0gZmFsc2UgJiYgb3B0aW9ucy5pc01lcmdlYWJsZU9iamVjdCh2YWx1ZSkpXG5cdFx0PyBkZWVwbWVyZ2UoZW1wdHlUYXJnZXQodmFsdWUpLCB2YWx1ZSwgb3B0aW9ucylcblx0XHQ6IHZhbHVlXG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRBcnJheU1lcmdlKHRhcmdldCwgc291cmNlLCBvcHRpb25zKSB7XG5cdHJldHVybiB0YXJnZXQuY29uY2F0KHNvdXJjZSkubWFwKGZ1bmN0aW9uKGVsZW1lbnQpIHtcblx0XHRyZXR1cm4gY2xvbmVVbmxlc3NPdGhlcndpc2VTcGVjaWZpZWQoZWxlbWVudCwgb3B0aW9ucylcblx0fSlcbn1cblxuZnVuY3Rpb24gZ2V0TWVyZ2VGdW5jdGlvbihrZXksIG9wdGlvbnMpIHtcblx0aWYgKCFvcHRpb25zLmN1c3RvbU1lcmdlKSB7XG5cdFx0cmV0dXJuIGRlZXBtZXJnZVxuXHR9XG5cdHZhciBjdXN0b21NZXJnZSA9IG9wdGlvbnMuY3VzdG9tTWVyZ2Uoa2V5KTtcblx0cmV0dXJuIHR5cGVvZiBjdXN0b21NZXJnZSA9PT0gJ2Z1bmN0aW9uJyA/IGN1c3RvbU1lcmdlIDogZGVlcG1lcmdlXG59XG5cbmZ1bmN0aW9uIGdldEVudW1lcmFibGVPd25Qcm9wZXJ0eVN5bWJvbHModGFyZ2V0KSB7XG5cdHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzXG5cdFx0PyBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHRhcmdldCkuZmlsdGVyKGZ1bmN0aW9uKHN5bWJvbCkge1xuXHRcdFx0cmV0dXJuIHRhcmdldC5wcm9wZXJ0eUlzRW51bWVyYWJsZShzeW1ib2wpXG5cdFx0fSlcblx0XHQ6IFtdXG59XG5cbmZ1bmN0aW9uIGdldEtleXModGFyZ2V0KSB7XG5cdHJldHVybiBPYmplY3Qua2V5cyh0YXJnZXQpLmNvbmNhdChnZXRFbnVtZXJhYmxlT3duUHJvcGVydHlTeW1ib2xzKHRhcmdldCkpXG59XG5cbi8vIFByb3RlY3RzIGZyb20gcHJvdG90eXBlIHBvaXNvbmluZyBhbmQgdW5leHBlY3RlZCBtZXJnaW5nIHVwIHRoZSBwcm90b3R5cGUgY2hhaW4uXG5mdW5jdGlvbiBwcm9wZXJ0eUlzVW5zYWZlKHRhcmdldCwga2V5KSB7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIChrZXkgaW4gdGFyZ2V0KSAvLyBQcm9wZXJ0aWVzIGFyZSBzYWZlIHRvIG1lcmdlIGlmIHRoZXkgZG9uJ3QgZXhpc3QgaW4gdGhlIHRhcmdldCB5ZXQsXG5cdFx0XHQmJiAhKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRhcmdldCwga2V5KSAvLyB1bnNhZmUgaWYgdGhleSBleGlzdCB1cCB0aGUgcHJvdG90eXBlIGNoYWluLFxuXHRcdFx0XHQmJiBPYmplY3QucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbCh0YXJnZXQsIGtleSkpIC8vIGFuZCBhbHNvIHVuc2FmZSBpZiB0aGV5J3JlIG5vbmVudW1lcmFibGUuXG5cdH0gY2F0Y2ggKHVudXNlZCkge1xuXHRcdC8vIENvdW50ZXJpbnR1aXRpdmVseSwgaXQncyBzYWZlIHRvIG1lcmdlIGFueSBwcm9wZXJ0eSBvbiBhIHRhcmdldCB0aGF0IGNhdXNlcyB0aGUgYGluYCBvcGVyYXRvciB0byB0aHJvdy5cblx0XHQvLyBUaGlzIGhhcHBlbnMgd2hlbiB0cnlpbmcgdG8gY29weSBhbiBvYmplY3QgaW4gdGhlIHNvdXJjZSBvdmVyIGEgcGxhaW4gc3RyaW5nIGluIHRoZSB0YXJnZXQuXG5cdFx0cmV0dXJuIGZhbHNlXG5cdH1cbn1cblxuZnVuY3Rpb24gbWVyZ2VPYmplY3QodGFyZ2V0LCBzb3VyY2UsIG9wdGlvbnMpIHtcblx0dmFyIGRlc3RpbmF0aW9uID0ge307XG5cdGlmIChvcHRpb25zLmlzTWVyZ2VhYmxlT2JqZWN0KHRhcmdldCkpIHtcblx0XHRnZXRLZXlzKHRhcmdldCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHRcdGRlc3RpbmF0aW9uW2tleV0gPSBjbG9uZVVubGVzc090aGVyd2lzZVNwZWNpZmllZCh0YXJnZXRba2V5XSwgb3B0aW9ucyk7XG5cdFx0fSk7XG5cdH1cblx0Z2V0S2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG5cdFx0aWYgKHByb3BlcnR5SXNVbnNhZmUodGFyZ2V0LCBrZXkpKSB7XG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHRpZiAoIW9wdGlvbnMuaXNNZXJnZWFibGVPYmplY3Qoc291cmNlW2tleV0pIHx8ICF0YXJnZXRba2V5XSkge1xuXHRcdFx0ZGVzdGluYXRpb25ba2V5XSA9IGNsb25lVW5sZXNzT3RoZXJ3aXNlU3BlY2lmaWVkKHNvdXJjZVtrZXldLCBvcHRpb25zKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVzdGluYXRpb25ba2V5XSA9IGdldE1lcmdlRnVuY3Rpb24oa2V5LCBvcHRpb25zKSh0YXJnZXRba2V5XSwgc291cmNlW2tleV0sIG9wdGlvbnMpO1xuXHRcdH1cblx0fSk7XG5cdHJldHVybiBkZXN0aW5hdGlvblxufVxuXG5mdW5jdGlvbiBkZWVwbWVyZ2UodGFyZ2V0LCBzb3VyY2UsIG9wdGlvbnMpIHtcblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG5cdG9wdGlvbnMuYXJyYXlNZXJnZSA9IG9wdGlvbnMuYXJyYXlNZXJnZSB8fCBkZWZhdWx0QXJyYXlNZXJnZTtcblx0b3B0aW9ucy5pc01lcmdlYWJsZU9iamVjdCA9IG9wdGlvbnMuaXNNZXJnZWFibGVPYmplY3QgfHwgaXNNZXJnZWFibGVPYmplY3Q7XG5cdC8vIGNsb25lVW5sZXNzT3RoZXJ3aXNlU3BlY2lmaWVkIGlzIGFkZGVkIHRvIGBvcHRpb25zYCBzbyB0aGF0IGN1c3RvbSBhcnJheU1lcmdlKClcblx0Ly8gaW1wbGVtZW50YXRpb25zIGNhbiB1c2UgaXQuIFRoZSBjYWxsZXIgbWF5IG5vdCByZXBsYWNlIGl0LlxuXHRvcHRpb25zLmNsb25lVW5sZXNzT3RoZXJ3aXNlU3BlY2lmaWVkID0gY2xvbmVVbmxlc3NPdGhlcndpc2VTcGVjaWZpZWQ7XG5cblx0dmFyIHNvdXJjZUlzQXJyYXkgPSBBcnJheS5pc0FycmF5KHNvdXJjZSk7XG5cdHZhciB0YXJnZXRJc0FycmF5ID0gQXJyYXkuaXNBcnJheSh0YXJnZXQpO1xuXHR2YXIgc291cmNlQW5kVGFyZ2V0VHlwZXNNYXRjaCA9IHNvdXJjZUlzQXJyYXkgPT09IHRhcmdldElzQXJyYXk7XG5cblx0aWYgKCFzb3VyY2VBbmRUYXJnZXRUeXBlc01hdGNoKSB7XG5cdFx0cmV0dXJuIGNsb25lVW5sZXNzT3RoZXJ3aXNlU3BlY2lmaWVkKHNvdXJjZSwgb3B0aW9ucylcblx0fSBlbHNlIGlmIChzb3VyY2VJc0FycmF5KSB7XG5cdFx0cmV0dXJuIG9wdGlvbnMuYXJyYXlNZXJnZSh0YXJnZXQsIHNvdXJjZSwgb3B0aW9ucylcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gbWVyZ2VPYmplY3QodGFyZ2V0LCBzb3VyY2UsIG9wdGlvbnMpXG5cdH1cbn1cblxuZGVlcG1lcmdlLmFsbCA9IGZ1bmN0aW9uIGRlZXBtZXJnZUFsbChhcnJheSwgb3B0aW9ucykge1xuXHRpZiAoIUFycmF5LmlzQXJyYXkoYXJyYXkpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdmaXJzdCBhcmd1bWVudCBzaG91bGQgYmUgYW4gYXJyYXknKVxuXHR9XG5cblx0cmV0dXJuIGFycmF5LnJlZHVjZShmdW5jdGlvbihwcmV2LCBuZXh0KSB7XG5cdFx0cmV0dXJuIGRlZXBtZXJnZShwcmV2LCBuZXh0LCBvcHRpb25zKVxuXHR9LCB7fSlcbn07XG5cbnZhciBkZWVwbWVyZ2VfMSA9IGRlZXBtZXJnZTtcblxubW9kdWxlLmV4cG9ydHMgPSBkZWVwbWVyZ2VfMTtcblxuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsLCBtb2R1bGUpIHsvKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX3BvbnlmaWxsX2pzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuLyogZ2xvYmFsIHdpbmRvdyAqL1xuXG5cbnZhciByb290O1xuXG5pZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gIHJvb3QgPSBzZWxmO1xufSBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICByb290ID0gd2luZG93O1xufSBlbHNlIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICByb290ID0gZ2xvYmFsO1xufSBlbHNlIGlmICh0cnVlKSB7XG4gIHJvb3QgPSBtb2R1bGU7XG59IGVsc2Uge31cblxudmFyIHJlc3VsdCA9IE9iamVjdChfcG9ueWZpbGxfanNfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfX1svKiBkZWZhdWx0ICovIFwiYVwiXSkocm9vdCk7XG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJhXCJdID0gKHJlc3VsdCk7XG5cbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbCh0aGlzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpKG1vZHVsZSkpKVxuXG4vKioqLyB9KSxcbi8qIDIgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuLyohXG4gKiBGdXNlLmpzIHYzLjQuNSAtIExpZ2h0d2VpZ2h0IGZ1enp5LXNlYXJjaCAoaHR0cDovL2Z1c2Vqcy5pbylcbiAqIFxuICogQ29weXJpZ2h0IChjKSAyMDEyLTIwMTcgS2lyb2xsb3MgUmlzayAoaHR0cDovL2tpcm8ubWUpXG4gKiBBbGwgUmlnaHRzIFJlc2VydmVkLiBBcGFjaGUgU29mdHdhcmUgTGljZW5zZSAyLjBcbiAqIFxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKi9cbiFmdW5jdGlvbihlLHQpeyB0cnVlP21vZHVsZS5leHBvcnRzPXQoKTp1bmRlZmluZWR9KHRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQ9e307ZnVuY3Rpb24gbihyKXtpZih0W3JdKXJldHVybiB0W3JdLmV4cG9ydHM7dmFyIG89dFtyXT17aTpyLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIGVbcl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsbiksby5sPSEwLG8uZXhwb3J0c31yZXR1cm4gbi5tPWUsbi5jPXQsbi5kPWZ1bmN0aW9uKGUsdCxyKXtuLm8oZSx0KXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7ZW51bWVyYWJsZTohMCxnZXQ6cn0pfSxuLnI9ZnVuY3Rpb24oZSl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOlwiTW9kdWxlXCJ9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0sbi50PWZ1bmN0aW9uKGUsdCl7aWYoMSZ0JiYoZT1uKGUpKSw4JnQpcmV0dXJuIGU7aWYoNCZ0JiZcIm9iamVjdFwiPT10eXBlb2YgZSYmZSYmZS5fX2VzTW9kdWxlKXJldHVybiBlO3ZhciByPU9iamVjdC5jcmVhdGUobnVsbCk7aWYobi5yKHIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyLFwiZGVmYXVsdFwiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOmV9KSwyJnQmJlwic3RyaW5nXCIhPXR5cGVvZiBlKWZvcih2YXIgbyBpbiBlKW4uZChyLG8sZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19LmJpbmQobnVsbCxvKSk7cmV0dXJuIHJ9LG4ubj1mdW5jdGlvbihlKXt2YXIgdD1lJiZlLl9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gZS5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiBlfTtyZXR1cm4gbi5kKHQsXCJhXCIsdCksdH0sbi5vPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfSxuLnA9XCJcIixuKG4ucz0xKX0oW2Z1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBBcnJheS5pc0FycmF5P0FycmF5LmlzQXJyYXkoZSk6XCJbb2JqZWN0IEFycmF5XVwiPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfX0sZnVuY3Rpb24oZSx0LG4pe2Z1bmN0aW9uIHIoZSl7cmV0dXJuKHI9XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZcInN5bWJvbFwiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yP2Z1bmN0aW9uKGUpe3JldHVybiB0eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmZS5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmZSE9PVN5bWJvbC5wcm90b3R5cGU/XCJzeW1ib2xcIjp0eXBlb2YgZX0pKGUpfWZ1bmN0aW9uIG8oZSx0KXtmb3IodmFyIG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtyLmVudW1lcmFibGU9ci5lbnVtZXJhYmxlfHwhMSxyLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiByJiYoci53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsci5rZXkscil9fXZhciBpPW4oMiksYT1uKDgpLHM9bigwKSxjPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4pe3ZhciByPW4ubG9jYXRpb24sbz12b2lkIDA9PT1yPzA6cixpPW4uZGlzdGFuY2Uscz12b2lkIDA9PT1pPzEwMDppLGM9bi50aHJlc2hvbGQsaD12b2lkIDA9PT1jPy42OmMsbD1uLm1heFBhdHRlcm5MZW5ndGgsdT12b2lkIDA9PT1sPzMyOmwsZj1uLmNhc2VTZW5zaXRpdmUsZD12b2lkIDAhPT1mJiZmLHY9bi50b2tlblNlcGFyYXRvcixwPXZvaWQgMD09PXY/LyArL2c6dixnPW4uZmluZEFsbE1hdGNoZXMseT12b2lkIDAhPT1nJiZnLG09bi5taW5NYXRjaENoYXJMZW5ndGgsaz12b2lkIDA9PT1tPzE6bSxTPW4uaWQseD12b2lkIDA9PT1TP251bGw6UyxiPW4ua2V5cyxNPXZvaWQgMD09PWI/W106YixfPW4uc2hvdWxkU29ydCxMPXZvaWQgMD09PV98fF8sdz1uLmdldEZuLEE9dm9pZCAwPT09dz9hOncsQz1uLnNvcnRGbixJPXZvaWQgMD09PUM/ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5zY29yZS10LnNjb3JlfTpDLE89bi50b2tlbml6ZSxqPXZvaWQgMCE9PU8mJk8sUD1uLm1hdGNoQWxsVG9rZW5zLEY9dm9pZCAwIT09UCYmUCxUPW4uaW5jbHVkZU1hdGNoZXMsej12b2lkIDAhPT1UJiZULEU9bi5pbmNsdWRlU2NvcmUsSz12b2lkIDAhPT1FJiZFLCQ9bi52ZXJib3NlLEo9dm9pZCAwIT09JCYmJDshZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMub3B0aW9ucz17bG9jYXRpb246byxkaXN0YW5jZTpzLHRocmVzaG9sZDpoLG1heFBhdHRlcm5MZW5ndGg6dSxpc0Nhc2VTZW5zaXRpdmU6ZCx0b2tlblNlcGFyYXRvcjpwLGZpbmRBbGxNYXRjaGVzOnksbWluTWF0Y2hDaGFyTGVuZ3RoOmssaWQ6eCxrZXlzOk0saW5jbHVkZU1hdGNoZXM6eixpbmNsdWRlU2NvcmU6SyxzaG91bGRTb3J0OkwsZ2V0Rm46QSxzb3J0Rm46SSx2ZXJib3NlOkosdG9rZW5pemU6aixtYXRjaEFsbFRva2VuczpGfSx0aGlzLnNldENvbGxlY3Rpb24odCl9dmFyIHQsbixjO3JldHVybiB0PWUsKG49W3trZXk6XCJzZXRDb2xsZWN0aW9uXCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMubGlzdD1lLGV9fSx7a2V5Olwic2VhcmNoXCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOntsaW1pdDohMX07dGhpcy5fbG9nKCctLS0tLS0tLS1cXG5TZWFyY2ggcGF0dGVybjogXCInLmNvbmNhdChlLCdcIicpKTt2YXIgbj10aGlzLl9wcmVwYXJlU2VhcmNoZXJzKGUpLHI9bi50b2tlblNlYXJjaGVycyxvPW4uZnVsbFNlYXJjaGVyLGk9dGhpcy5fc2VhcmNoKHIsbyksYT1pLndlaWdodHMscz1pLnJlc3VsdHM7cmV0dXJuIHRoaXMuX2NvbXB1dGVTY29yZShhLHMpLHRoaXMub3B0aW9ucy5zaG91bGRTb3J0JiZ0aGlzLl9zb3J0KHMpLHQubGltaXQmJlwibnVtYmVyXCI9PXR5cGVvZiB0LmxpbWl0JiYocz1zLnNsaWNlKDAsdC5saW1pdCkpLHRoaXMuX2Zvcm1hdChzKX19LHtrZXk6XCJfcHJlcGFyZVNlYXJjaGVyc1wiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOlwiXCIsdD1bXTtpZih0aGlzLm9wdGlvbnMudG9rZW5pemUpZm9yKHZhciBuPWUuc3BsaXQodGhpcy5vcHRpb25zLnRva2VuU2VwYXJhdG9yKSxyPTAsbz1uLmxlbmd0aDtyPG87cis9MSl0LnB1c2gobmV3IGkobltyXSx0aGlzLm9wdGlvbnMpKTtyZXR1cm57dG9rZW5TZWFyY2hlcnM6dCxmdWxsU2VhcmNoZXI6bmV3IGkoZSx0aGlzLm9wdGlvbnMpfX19LHtrZXk6XCJfc2VhcmNoXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10sdD1hcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMCxuPXRoaXMubGlzdCxyPXt9LG89W107aWYoXCJzdHJpbmdcIj09dHlwZW9mIG5bMF0pe2Zvcih2YXIgaT0wLGE9bi5sZW5ndGg7aTxhO2krPTEpdGhpcy5fYW5hbHl6ZSh7a2V5OlwiXCIsdmFsdWU6bltpXSxyZWNvcmQ6aSxpbmRleDppfSx7cmVzdWx0TWFwOnIscmVzdWx0czpvLHRva2VuU2VhcmNoZXJzOmUsZnVsbFNlYXJjaGVyOnR9KTtyZXR1cm57d2VpZ2h0czpudWxsLHJlc3VsdHM6b319Zm9yKHZhciBzPXt9LGM9MCxoPW4ubGVuZ3RoO2M8aDtjKz0xKWZvcih2YXIgbD1uW2NdLHU9MCxmPXRoaXMub3B0aW9ucy5rZXlzLmxlbmd0aDt1PGY7dSs9MSl7dmFyIGQ9dGhpcy5vcHRpb25zLmtleXNbdV07aWYoXCJzdHJpbmdcIiE9dHlwZW9mIGQpe2lmKHNbZC5uYW1lXT17d2VpZ2h0OjEtZC53ZWlnaHR8fDF9LGQud2VpZ2h0PD0wfHxkLndlaWdodD4xKXRocm93IG5ldyBFcnJvcihcIktleSB3ZWlnaHQgaGFzIHRvIGJlID4gMCBhbmQgPD0gMVwiKTtkPWQubmFtZX1lbHNlIHNbZF09e3dlaWdodDoxfTt0aGlzLl9hbmFseXplKHtrZXk6ZCx2YWx1ZTp0aGlzLm9wdGlvbnMuZ2V0Rm4obCxkKSxyZWNvcmQ6bCxpbmRleDpjfSx7cmVzdWx0TWFwOnIscmVzdWx0czpvLHRva2VuU2VhcmNoZXJzOmUsZnVsbFNlYXJjaGVyOnR9KX1yZXR1cm57d2VpZ2h0czpzLHJlc3VsdHM6b319fSx7a2V5OlwiX2FuYWx5emVcIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciBuPWUua2V5LHI9ZS5hcnJheUluZGV4LG89dm9pZCAwPT09cj8tMTpyLGk9ZS52YWx1ZSxhPWUucmVjb3JkLGM9ZS5pbmRleCxoPXQudG9rZW5TZWFyY2hlcnMsbD12b2lkIDA9PT1oP1tdOmgsdT10LmZ1bGxTZWFyY2hlcixmPXZvaWQgMD09PXU/W106dSxkPXQucmVzdWx0TWFwLHY9dm9pZCAwPT09ZD97fTpkLHA9dC5yZXN1bHRzLGc9dm9pZCAwPT09cD9bXTpwO2lmKG51bGwhPWkpe3ZhciB5PSExLG09LTEsaz0wO2lmKFwic3RyaW5nXCI9PXR5cGVvZiBpKXt0aGlzLl9sb2coXCJcXG5LZXk6IFwiLmNvbmNhdChcIlwiPT09bj9cIi1cIjpuKSk7dmFyIFM9Zi5zZWFyY2goaSk7aWYodGhpcy5fbG9nKCdGdWxsIHRleHQ6IFwiJy5jb25jYXQoaSwnXCIsIHNjb3JlOiAnKS5jb25jYXQoUy5zY29yZSkpLHRoaXMub3B0aW9ucy50b2tlbml6ZSl7Zm9yKHZhciB4PWkuc3BsaXQodGhpcy5vcHRpb25zLnRva2VuU2VwYXJhdG9yKSxiPVtdLE09MDtNPGwubGVuZ3RoO00rPTEpe3ZhciBfPWxbTV07dGhpcy5fbG9nKCdcXG5QYXR0ZXJuOiBcIicuY29uY2F0KF8ucGF0dGVybiwnXCInKSk7Zm9yKHZhciBMPSExLHc9MDt3PHgubGVuZ3RoO3crPTEpe3ZhciBBPXhbd10sQz1fLnNlYXJjaChBKSxJPXt9O0MuaXNNYXRjaD8oSVtBXT1DLnNjb3JlLHk9ITAsTD0hMCxiLnB1c2goQy5zY29yZSkpOihJW0FdPTEsdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zfHxiLnB1c2goMSkpLHRoaXMuX2xvZygnVG9rZW46IFwiJy5jb25jYXQoQSwnXCIsIHNjb3JlOiAnKS5jb25jYXQoSVtBXSkpfUwmJihrKz0xKX1tPWJbMF07Zm9yKHZhciBPPWIubGVuZ3RoLGo9MTtqPE87ais9MSltKz1iW2pdO20vPU8sdGhpcy5fbG9nKFwiVG9rZW4gc2NvcmUgYXZlcmFnZTpcIixtKX12YXIgUD1TLnNjb3JlO20+LTEmJihQPShQK20pLzIpLHRoaXMuX2xvZyhcIlNjb3JlIGF2ZXJhZ2U6XCIsUCk7dmFyIEY9IXRoaXMub3B0aW9ucy50b2tlbml6ZXx8IXRoaXMub3B0aW9ucy5tYXRjaEFsbFRva2Vuc3x8az49bC5sZW5ndGg7aWYodGhpcy5fbG9nKFwiXFxuQ2hlY2sgTWF0Y2hlczogXCIuY29uY2F0KEYpKSwoeXx8Uy5pc01hdGNoKSYmRil7dmFyIFQ9dltjXTtUP1Qub3V0cHV0LnB1c2goe2tleTpuLGFycmF5SW5kZXg6byx2YWx1ZTppLHNjb3JlOlAsbWF0Y2hlZEluZGljZXM6Uy5tYXRjaGVkSW5kaWNlc30pOih2W2NdPXtpdGVtOmEsb3V0cHV0Olt7a2V5Om4sYXJyYXlJbmRleDpvLHZhbHVlOmksc2NvcmU6UCxtYXRjaGVkSW5kaWNlczpTLm1hdGNoZWRJbmRpY2VzfV19LGcucHVzaCh2W2NdKSl9fWVsc2UgaWYocyhpKSlmb3IodmFyIHo9MCxFPWkubGVuZ3RoO3o8RTt6Kz0xKXRoaXMuX2FuYWx5emUoe2tleTpuLGFycmF5SW5kZXg6eix2YWx1ZTppW3pdLHJlY29yZDphLGluZGV4OmN9LHtyZXN1bHRNYXA6dixyZXN1bHRzOmcsdG9rZW5TZWFyY2hlcnM6bCxmdWxsU2VhcmNoZXI6Zn0pfX19LHtrZXk6XCJfY29tcHV0ZVNjb3JlXCIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9sb2coXCJcXG5cXG5Db21wdXRpbmcgc2NvcmU6XFxuXCIpO2Zvcih2YXIgbj0wLHI9dC5sZW5ndGg7bjxyO24rPTEpe2Zvcih2YXIgbz10W25dLm91dHB1dCxpPW8ubGVuZ3RoLGE9MSxzPTEsYz0wO2M8aTtjKz0xKXt2YXIgaD1lP2Vbb1tjXS5rZXldLndlaWdodDoxLGw9KDE9PT1oP29bY10uc2NvcmU6b1tjXS5zY29yZXx8LjAwMSkqaDsxIT09aD9zPU1hdGgubWluKHMsbCk6KG9bY10ublNjb3JlPWwsYSo9bCl9dFtuXS5zY29yZT0xPT09cz9hOnMsdGhpcy5fbG9nKHRbbl0pfX19LHtrZXk6XCJfc29ydFwiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMuX2xvZyhcIlxcblxcblNvcnRpbmcuLi4uXCIpLGUuc29ydCh0aGlzLm9wdGlvbnMuc29ydEZuKX19LHtrZXk6XCJfZm9ybWF0XCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9W107aWYodGhpcy5vcHRpb25zLnZlcmJvc2Upe3ZhciBuPVtdO3RoaXMuX2xvZyhcIlxcblxcbk91dHB1dDpcXG5cXG5cIixKU09OLnN0cmluZ2lmeShlLGZ1bmN0aW9uKGUsdCl7aWYoXCJvYmplY3RcIj09PXIodCkmJm51bGwhPT10KXtpZigtMSE9PW4uaW5kZXhPZih0KSlyZXR1cm47bi5wdXNoKHQpfXJldHVybiB0fSkpLG49bnVsbH12YXIgbz1bXTt0aGlzLm9wdGlvbnMuaW5jbHVkZU1hdGNoZXMmJm8ucHVzaChmdW5jdGlvbihlLHQpe3ZhciBuPWUub3V0cHV0O3QubWF0Y2hlcz1bXTtmb3IodmFyIHI9MCxvPW4ubGVuZ3RoO3I8bztyKz0xKXt2YXIgaT1uW3JdO2lmKDAhPT1pLm1hdGNoZWRJbmRpY2VzLmxlbmd0aCl7dmFyIGE9e2luZGljZXM6aS5tYXRjaGVkSW5kaWNlcyx2YWx1ZTppLnZhbHVlfTtpLmtleSYmKGEua2V5PWkua2V5KSxpLmhhc093blByb3BlcnR5KFwiYXJyYXlJbmRleFwiKSYmaS5hcnJheUluZGV4Pi0xJiYoYS5hcnJheUluZGV4PWkuYXJyYXlJbmRleCksdC5tYXRjaGVzLnB1c2goYSl9fX0pLHRoaXMub3B0aW9ucy5pbmNsdWRlU2NvcmUmJm8ucHVzaChmdW5jdGlvbihlLHQpe3Quc2NvcmU9ZS5zY29yZX0pO2Zvcih2YXIgaT0wLGE9ZS5sZW5ndGg7aTxhO2krPTEpe3ZhciBzPWVbaV07aWYodGhpcy5vcHRpb25zLmlkJiYocy5pdGVtPXRoaXMub3B0aW9ucy5nZXRGbihzLml0ZW0sdGhpcy5vcHRpb25zLmlkKVswXSksby5sZW5ndGgpe2Zvcih2YXIgYz17aXRlbTpzLml0ZW19LGg9MCxsPW8ubGVuZ3RoO2g8bDtoKz0xKW9baF0ocyxjKTt0LnB1c2goYyl9ZWxzZSB0LnB1c2gocy5pdGVtKX1yZXR1cm4gdH19LHtrZXk6XCJfbG9nXCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTt0aGlzLm9wdGlvbnMudmVyYm9zZSYmKGU9Y29uc29sZSkubG9nLmFwcGx5KGUsYXJndW1lbnRzKX19XSkmJm8odC5wcm90b3R5cGUsbiksYyYmbyh0LGMpLGV9KCk7ZS5leHBvcnRzPWN9LGZ1bmN0aW9uKGUsdCxuKXtmdW5jdGlvbiByKGUsdCl7Zm9yKHZhciBuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07ci5lbnVtZXJhYmxlPXIuZW51bWVyYWJsZXx8ITEsci5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gciYmKHIud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHIua2V5LHIpfX12YXIgbz1uKDMpLGk9big0KSxhPW4oNykscz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxuKXt2YXIgcj1uLmxvY2F0aW9uLG89dm9pZCAwPT09cj8wOnIsaT1uLmRpc3RhbmNlLHM9dm9pZCAwPT09aT8xMDA6aSxjPW4udGhyZXNob2xkLGg9dm9pZCAwPT09Yz8uNjpjLGw9bi5tYXhQYXR0ZXJuTGVuZ3RoLHU9dm9pZCAwPT09bD8zMjpsLGY9bi5pc0Nhc2VTZW5zaXRpdmUsZD12b2lkIDAhPT1mJiZmLHY9bi50b2tlblNlcGFyYXRvcixwPXZvaWQgMD09PXY/LyArL2c6dixnPW4uZmluZEFsbE1hdGNoZXMseT12b2lkIDAhPT1nJiZnLG09bi5taW5NYXRjaENoYXJMZW5ndGgsaz12b2lkIDA9PT1tPzE6bTshZnVuY3Rpb24oZSx0KXtpZighKGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpfSh0aGlzLGUpLHRoaXMub3B0aW9ucz17bG9jYXRpb246byxkaXN0YW5jZTpzLHRocmVzaG9sZDpoLG1heFBhdHRlcm5MZW5ndGg6dSxpc0Nhc2VTZW5zaXRpdmU6ZCx0b2tlblNlcGFyYXRvcjpwLGZpbmRBbGxNYXRjaGVzOnksbWluTWF0Y2hDaGFyTGVuZ3RoOmt9LHRoaXMucGF0dGVybj10aGlzLm9wdGlvbnMuaXNDYXNlU2Vuc2l0aXZlP3Q6dC50b0xvd2VyQ2FzZSgpLHRoaXMucGF0dGVybi5sZW5ndGg8PXUmJih0aGlzLnBhdHRlcm5BbHBoYWJldD1hKHRoaXMucGF0dGVybikpfXZhciB0LG4scztyZXR1cm4gdD1lLChuPVt7a2V5Olwic2VhcmNoXCIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYodGhpcy5vcHRpb25zLmlzQ2FzZVNlbnNpdGl2ZXx8KGU9ZS50b0xvd2VyQ2FzZSgpKSx0aGlzLnBhdHRlcm49PT1lKXJldHVybntpc01hdGNoOiEwLHNjb3JlOjAsbWF0Y2hlZEluZGljZXM6W1swLGUubGVuZ3RoLTFdXX07dmFyIHQ9dGhpcy5vcHRpb25zLG49dC5tYXhQYXR0ZXJuTGVuZ3RoLHI9dC50b2tlblNlcGFyYXRvcjtpZih0aGlzLnBhdHRlcm4ubGVuZ3RoPm4pcmV0dXJuIG8oZSx0aGlzLnBhdHRlcm4scik7dmFyIGE9dGhpcy5vcHRpb25zLHM9YS5sb2NhdGlvbixjPWEuZGlzdGFuY2UsaD1hLnRocmVzaG9sZCxsPWEuZmluZEFsbE1hdGNoZXMsdT1hLm1pbk1hdGNoQ2hhckxlbmd0aDtyZXR1cm4gaShlLHRoaXMucGF0dGVybix0aGlzLnBhdHRlcm5BbHBoYWJldCx7bG9jYXRpb246cyxkaXN0YW5jZTpjLHRocmVzaG9sZDpoLGZpbmRBbGxNYXRjaGVzOmwsbWluTWF0Y2hDaGFyTGVuZ3RoOnV9KX19XSkmJnIodC5wcm90b3R5cGUsbikscyYmcih0LHMpLGV9KCk7ZS5leHBvcnRzPXN9LGZ1bmN0aW9uKGUsdCl7dmFyIG49L1tcXC1cXFtcXF1cXC9cXHtcXH1cXChcXClcXCpcXCtcXD9cXC5cXFxcXFxeXFwkXFx8XS9nO2UuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTovICsvZyxvPW5ldyBSZWdFeHAodC5yZXBsYWNlKG4sXCJcXFxcJCZcIikucmVwbGFjZShyLFwifFwiKSksaT1lLm1hdGNoKG8pLGE9ISFpLHM9W107aWYoYSlmb3IodmFyIGM9MCxoPWkubGVuZ3RoO2M8aDtjKz0xKXt2YXIgbD1pW2NdO3MucHVzaChbZS5pbmRleE9mKGwpLGwubGVuZ3RoLTFdKX1yZXR1cm57c2NvcmU6YT8uNToxLGlzTWF0Y2g6YSxtYXRjaGVkSW5kaWNlczpzfX19LGZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1uKDUpLG89big2KTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0LG4saSl7Zm9yKHZhciBhPWkubG9jYXRpb24scz12b2lkIDA9PT1hPzA6YSxjPWkuZGlzdGFuY2UsaD12b2lkIDA9PT1jPzEwMDpjLGw9aS50aHJlc2hvbGQsdT12b2lkIDA9PT1sPy42OmwsZj1pLmZpbmRBbGxNYXRjaGVzLGQ9dm9pZCAwIT09ZiYmZix2PWkubWluTWF0Y2hDaGFyTGVuZ3RoLHA9dm9pZCAwPT09dj8xOnYsZz1zLHk9ZS5sZW5ndGgsbT11LGs9ZS5pbmRleE9mKHQsZyksUz10Lmxlbmd0aCx4PVtdLGI9MDtiPHk7Yis9MSl4W2JdPTA7aWYoLTEhPT1rKXt2YXIgTT1yKHQse2Vycm9yczowLGN1cnJlbnRMb2NhdGlvbjprLGV4cGVjdGVkTG9jYXRpb246ZyxkaXN0YW5jZTpofSk7aWYobT1NYXRoLm1pbihNLG0pLC0xIT09KGs9ZS5sYXN0SW5kZXhPZih0LGcrUykpKXt2YXIgXz1yKHQse2Vycm9yczowLGN1cnJlbnRMb2NhdGlvbjprLGV4cGVjdGVkTG9jYXRpb246ZyxkaXN0YW5jZTpofSk7bT1NYXRoLm1pbihfLG0pfX1rPS0xO2Zvcih2YXIgTD1bXSx3PTEsQT1TK3ksQz0xPDxTLTEsST0wO0k8UztJKz0xKXtmb3IodmFyIE89MCxqPUE7TzxqOyl7cih0LHtlcnJvcnM6SSxjdXJyZW50TG9jYXRpb246ZytqLGV4cGVjdGVkTG9jYXRpb246ZyxkaXN0YW5jZTpofSk8PW0/Tz1qOkE9aixqPU1hdGguZmxvb3IoKEEtTykvMitPKX1BPWo7dmFyIFA9TWF0aC5tYXgoMSxnLWorMSksRj1kP3k6TWF0aC5taW4oZytqLHkpK1MsVD1BcnJheShGKzIpO1RbRisxXT0oMTw8SSktMTtmb3IodmFyIHo9Rjt6Pj1QO3otPTEpe3ZhciBFPXotMSxLPW5bZS5jaGFyQXQoRSldO2lmKEsmJih4W0VdPTEpLFRbel09KFRbeisxXTw8MXwxKSZLLDAhPT1JJiYoVFt6XXw9KExbeisxXXxMW3pdKTw8MXwxfExbeisxXSksVFt6XSZDJiYodz1yKHQse2Vycm9yczpJLGN1cnJlbnRMb2NhdGlvbjpFLGV4cGVjdGVkTG9jYXRpb246ZyxkaXN0YW5jZTpofSkpPD1tKXtpZihtPXcsKGs9RSk8PWcpYnJlYWs7UD1NYXRoLm1heCgxLDIqZy1rKX19aWYocih0LHtlcnJvcnM6SSsxLGN1cnJlbnRMb2NhdGlvbjpnLGV4cGVjdGVkTG9jYXRpb246ZyxkaXN0YW5jZTpofSk+bSlicmVhaztMPVR9cmV0dXJue2lzTWF0Y2g6az49MCxzY29yZTowPT09dz8uMDAxOncsbWF0Y2hlZEluZGljZXM6byh4LHApfX19LGZ1bmN0aW9uKGUsdCl7ZS5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7dmFyIG49dC5lcnJvcnMscj12b2lkIDA9PT1uPzA6bixvPXQuY3VycmVudExvY2F0aW9uLGk9dm9pZCAwPT09bz8wOm8sYT10LmV4cGVjdGVkTG9jYXRpb24scz12b2lkIDA9PT1hPzA6YSxjPXQuZGlzdGFuY2UsaD12b2lkIDA9PT1jPzEwMDpjLGw9ci9lLmxlbmd0aCx1PU1hdGguYWJzKHMtaSk7cmV0dXJuIGg/bCt1L2g6dT8xOmx9fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbigpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06W10sdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MSxuPVtdLHI9LTEsbz0tMSxpPTAsYT1lLmxlbmd0aDtpPGE7aSs9MSl7dmFyIHM9ZVtpXTtzJiYtMT09PXI/cj1pOnN8fC0xPT09cnx8KChvPWktMSktcisxPj10JiZuLnB1c2goW3Isb10pLHI9LTEpfXJldHVybiBlW2ktMV0mJmktcj49dCYmbi5wdXNoKFtyLGktMV0pLG59fSxmdW5jdGlvbihlLHQpe2UuZXhwb3J0cz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9e30sbj1lLmxlbmd0aCxyPTA7cjxuO3IrPTEpdFtlLmNoYXJBdChyKV09MDtmb3IodmFyIG89MDtvPG47bys9MSl0W2UuY2hhckF0KG8pXXw9MTw8bi1vLTE7cmV0dXJuIHR9fSxmdW5jdGlvbihlLHQsbil7dmFyIHI9bigwKTtlLmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZnVuY3Rpb24gZSh0LG4sbyl7aWYobil7dmFyIGk9bi5pbmRleE9mKFwiLlwiKSxhPW4scz1udWxsOy0xIT09aSYmKGE9bi5zbGljZSgwLGkpLHM9bi5zbGljZShpKzEpKTt2YXIgYz10W2FdO2lmKG51bGwhPWMpaWYoc3x8XCJzdHJpbmdcIiE9dHlwZW9mIGMmJlwibnVtYmVyXCIhPXR5cGVvZiBjKWlmKHIoYykpZm9yKHZhciBoPTAsbD1jLmxlbmd0aDtoPGw7aCs9MSllKGNbaF0scyxvKTtlbHNlIHMmJmUoYyxzLG8pO2Vsc2Ugby5wdXNoKGMudG9TdHJpbmcoKSl9ZWxzZSBvLnB1c2godCk7cmV0dXJuIG99KGUsdCxbXSl9fV0pfSk7XG5cbi8qKiovIH0pLFxuLyogMyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8qIGhhcm1vbnkgZXhwb3J0IChiaW5kaW5nKSAqLyBfX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJhXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gc3ltYm9sT2JzZXJ2YWJsZVBvbnlmaWxsOyB9KTtcbmZ1bmN0aW9uIHN5bWJvbE9ic2VydmFibGVQb255ZmlsbChyb290KSB7XG5cdHZhciByZXN1bHQ7XG5cdHZhciBTeW1ib2wgPSByb290LlN5bWJvbDtcblxuXHRpZiAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdGlmIChTeW1ib2wub2JzZXJ2YWJsZSkge1xuXHRcdFx0cmVzdWx0ID0gU3ltYm9sLm9ic2VydmFibGU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdCA9IFN5bWJvbCgnb2JzZXJ2YWJsZScpO1xuXHRcdFx0U3ltYm9sLm9ic2VydmFibGUgPSByZXN1bHQ7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHJlc3VsdCA9ICdAQG9ic2VydmFibGUnO1xuXHR9XG5cblx0cmV0dXJuIHJlc3VsdDtcbn07XG5cblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblxuXG4vKioqLyB9KSxcbi8qIDUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxudmFyIGc7XG5cbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXG5nID0gKGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcztcbn0pKCk7XG5cbnRyeSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxuXHRnID0gZyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xufSBjYXRjaCAoZSkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbn1cblxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3Ncbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cblxubW9kdWxlLmV4cG9ydHMgPSBnO1xuXG5cbi8qKiovIH0pLFxuLyogNiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9yaWdpbmFsTW9kdWxlKSB7XG5cdGlmICghb3JpZ2luYWxNb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XG5cdFx0dmFyIG1vZHVsZSA9IE9iamVjdC5jcmVhdGUob3JpZ2luYWxNb2R1bGUpO1xuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxuXHRcdGlmICghbW9kdWxlLmNoaWxkcmVuKSBtb2R1bGUuY2hpbGRyZW4gPSBbXTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImxvYWRlZFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIG1vZHVsZS5sO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShtb2R1bGUsIFwiaWRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBtb2R1bGUuaTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImV4cG9ydHNcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZVxuXHRcdH0pO1xuXHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xuXHR9XG5cdHJldHVybiBtb2R1bGU7XG59O1xuXG5cbi8qKiovIH0pLFxuLyogNyAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbl9fd2VicGFja19yZXF1aXJlX18ucihfX3dlYnBhY2tfZXhwb3J0c19fKTtcblxuLy8gRVhURVJOQUwgTU9EVUxFOiAuL25vZGVfbW9kdWxlcy9mdXNlLmpzL2Rpc3QvZnVzZS5qc1xudmFyIGRpc3RfZnVzZSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG52YXIgZnVzZV9kZWZhdWx0ID0gLyojX19QVVJFX18qL19fd2VicGFja19yZXF1aXJlX18ubihkaXN0X2Z1c2UpO1xuXG4vLyBFWFRFUk5BTCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL2RlZXBtZXJnZS9kaXN0L2Nqcy5qc1xudmFyIGNqcyA9IF9fd2VicGFja19yZXF1aXJlX18oMCk7XG52YXIgY2pzX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX193ZWJwYWNrX3JlcXVpcmVfXy5uKGNqcyk7XG5cbi8vIEVYVEVSTkFMIE1PRFVMRTogLi9ub2RlX21vZHVsZXMvc3ltYm9sLW9ic2VydmFibGUvZXMvaW5kZXguanNcbnZhciBlcyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vbm9kZV9tb2R1bGVzL3JlZHV4L2VzL3JlZHV4LmpzXG5cblxuLyoqXG4gKiBUaGVzZSBhcmUgcHJpdmF0ZSBhY3Rpb24gdHlwZXMgcmVzZXJ2ZWQgYnkgUmVkdXguXG4gKiBGb3IgYW55IHVua25vd24gYWN0aW9ucywgeW91IG11c3QgcmV0dXJuIHRoZSBjdXJyZW50IHN0YXRlLlxuICogSWYgdGhlIGN1cnJlbnQgc3RhdGUgaXMgdW5kZWZpbmVkLCB5b3UgbXVzdCByZXR1cm4gdGhlIGluaXRpYWwgc3RhdGUuXG4gKiBEbyBub3QgcmVmZXJlbmNlIHRoZXNlIGFjdGlvbiB0eXBlcyBkaXJlY3RseSBpbiB5b3VyIGNvZGUuXG4gKi9cbnZhciByYW5kb21TdHJpbmcgPSBmdW5jdGlvbiByYW5kb21TdHJpbmcoKSB7XG4gIHJldHVybiBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNykuc3BsaXQoJycpLmpvaW4oJy4nKTtcbn07XG5cbnZhciBBY3Rpb25UeXBlcyA9IHtcbiAgSU5JVDogXCJAQHJlZHV4L0lOSVRcIiArIHJhbmRvbVN0cmluZygpLFxuICBSRVBMQUNFOiBcIkBAcmVkdXgvUkVQTEFDRVwiICsgcmFuZG9tU3RyaW5nKCksXG4gIFBST0JFX1VOS05PV05fQUNUSU9OOiBmdW5jdGlvbiBQUk9CRV9VTktOT1dOX0FDVElPTigpIHtcbiAgICByZXR1cm4gXCJAQHJlZHV4L1BST0JFX1VOS05PV05fQUNUSU9OXCIgKyByYW5kb21TdHJpbmcoKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0ge2FueX0gb2JqIFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBhcmd1bWVudCBhcHBlYXJzIHRvIGJlIGEgcGxhaW4gb2JqZWN0LlxuICovXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KG9iaikge1xuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSByZXR1cm4gZmFsc2U7XG4gIHZhciBwcm90byA9IG9iajtcblxuICB3aGlsZSAoT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKSAhPT0gbnVsbCkge1xuICAgIHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvKTtcbiAgfVxuXG4gIHJldHVybiBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSA9PT0gcHJvdG87XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIFJlZHV4IHN0b3JlIHRoYXQgaG9sZHMgdGhlIHN0YXRlIHRyZWUuXG4gKiBUaGUgb25seSB3YXkgdG8gY2hhbmdlIHRoZSBkYXRhIGluIHRoZSBzdG9yZSBpcyB0byBjYWxsIGBkaXNwYXRjaCgpYCBvbiBpdC5cbiAqXG4gKiBUaGVyZSBzaG91bGQgb25seSBiZSBhIHNpbmdsZSBzdG9yZSBpbiB5b3VyIGFwcC4gVG8gc3BlY2lmeSBob3cgZGlmZmVyZW50XG4gKiBwYXJ0cyBvZiB0aGUgc3RhdGUgdHJlZSByZXNwb25kIHRvIGFjdGlvbnMsIHlvdSBtYXkgY29tYmluZSBzZXZlcmFsIHJlZHVjZXJzXG4gKiBpbnRvIGEgc2luZ2xlIHJlZHVjZXIgZnVuY3Rpb24gYnkgdXNpbmcgYGNvbWJpbmVSZWR1Y2Vyc2AuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVkdWNlciBBIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgbmV4dCBzdGF0ZSB0cmVlLCBnaXZlblxuICogdGhlIGN1cnJlbnQgc3RhdGUgdHJlZSBhbmQgdGhlIGFjdGlvbiB0byBoYW5kbGUuXG4gKlxuICogQHBhcmFtIHthbnl9IFtwcmVsb2FkZWRTdGF0ZV0gVGhlIGluaXRpYWwgc3RhdGUuIFlvdSBtYXkgb3B0aW9uYWxseSBzcGVjaWZ5IGl0XG4gKiB0byBoeWRyYXRlIHRoZSBzdGF0ZSBmcm9tIHRoZSBzZXJ2ZXIgaW4gdW5pdmVyc2FsIGFwcHMsIG9yIHRvIHJlc3RvcmUgYVxuICogcHJldmlvdXNseSBzZXJpYWxpemVkIHVzZXIgc2Vzc2lvbi5cbiAqIElmIHlvdSB1c2UgYGNvbWJpbmVSZWR1Y2Vyc2AgdG8gcHJvZHVjZSB0aGUgcm9vdCByZWR1Y2VyIGZ1bmN0aW9uLCB0aGlzIG11c3QgYmVcbiAqIGFuIG9iamVjdCB3aXRoIHRoZSBzYW1lIHNoYXBlIGFzIGBjb21iaW5lUmVkdWNlcnNgIGtleXMuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW2VuaGFuY2VyXSBUaGUgc3RvcmUgZW5oYW5jZXIuIFlvdSBtYXkgb3B0aW9uYWxseSBzcGVjaWZ5IGl0XG4gKiB0byBlbmhhbmNlIHRoZSBzdG9yZSB3aXRoIHRoaXJkLXBhcnR5IGNhcGFiaWxpdGllcyBzdWNoIGFzIG1pZGRsZXdhcmUsXG4gKiB0aW1lIHRyYXZlbCwgcGVyc2lzdGVuY2UsIGV0Yy4gVGhlIG9ubHkgc3RvcmUgZW5oYW5jZXIgdGhhdCBzaGlwcyB3aXRoIFJlZHV4XG4gKiBpcyBgYXBwbHlNaWRkbGV3YXJlKClgLlxuICpcbiAqIEByZXR1cm5zIHtTdG9yZX0gQSBSZWR1eCBzdG9yZSB0aGF0IGxldHMgeW91IHJlYWQgdGhlIHN0YXRlLCBkaXNwYXRjaCBhY3Rpb25zXG4gKiBhbmQgc3Vic2NyaWJlIHRvIGNoYW5nZXMuXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlU3RvcmUocmVkdWNlciwgcHJlbG9hZGVkU3RhdGUsIGVuaGFuY2VyKSB7XG4gIHZhciBfcmVmMjtcblxuICBpZiAodHlwZW9mIHByZWxvYWRlZFN0YXRlID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBlbmhhbmNlciA9PT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgZW5oYW5jZXIgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGFyZ3VtZW50c1szXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBFcnJvcignSXQgbG9va3MgbGlrZSB5b3UgYXJlIHBhc3Npbmcgc2V2ZXJhbCBzdG9yZSBlbmhhbmNlcnMgdG8gJyArICdjcmVhdGVTdG9yZSgpLiBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQuIEluc3RlYWQsIGNvbXBvc2UgdGhlbSAnICsgJ3RvZ2V0aGVyIHRvIGEgc2luZ2xlIGZ1bmN0aW9uLicpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBwcmVsb2FkZWRTdGF0ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZW5oYW5jZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgZW5oYW5jZXIgPSBwcmVsb2FkZWRTdGF0ZTtcbiAgICBwcmVsb2FkZWRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgZW5oYW5jZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKHR5cGVvZiBlbmhhbmNlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3RlZCB0aGUgZW5oYW5jZXIgdG8gYmUgYSBmdW5jdGlvbi4nKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZW5oYW5jZXIoY3JlYXRlU3RvcmUpKHJlZHVjZXIsIHByZWxvYWRlZFN0YXRlKTtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcmVkdWNlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdGhlIHJlZHVjZXIgdG8gYmUgYSBmdW5jdGlvbi4nKTtcbiAgfVxuXG4gIHZhciBjdXJyZW50UmVkdWNlciA9IHJlZHVjZXI7XG4gIHZhciBjdXJyZW50U3RhdGUgPSBwcmVsb2FkZWRTdGF0ZTtcbiAgdmFyIGN1cnJlbnRMaXN0ZW5lcnMgPSBbXTtcbiAgdmFyIG5leHRMaXN0ZW5lcnMgPSBjdXJyZW50TGlzdGVuZXJzO1xuICB2YXIgaXNEaXNwYXRjaGluZyA9IGZhbHNlO1xuICAvKipcbiAgICogVGhpcyBtYWtlcyBhIHNoYWxsb3cgY29weSBvZiBjdXJyZW50TGlzdGVuZXJzIHNvIHdlIGNhbiB1c2VcbiAgICogbmV4dExpc3RlbmVycyBhcyBhIHRlbXBvcmFyeSBsaXN0IHdoaWxlIGRpc3BhdGNoaW5nLlxuICAgKlxuICAgKiBUaGlzIHByZXZlbnRzIGFueSBidWdzIGFyb3VuZCBjb25zdW1lcnMgY2FsbGluZ1xuICAgKiBzdWJzY3JpYmUvdW5zdWJzY3JpYmUgaW4gdGhlIG1pZGRsZSBvZiBhIGRpc3BhdGNoLlxuICAgKi9cblxuICBmdW5jdGlvbiBlbnN1cmVDYW5NdXRhdGVOZXh0TGlzdGVuZXJzKCkge1xuICAgIGlmIChuZXh0TGlzdGVuZXJzID09PSBjdXJyZW50TGlzdGVuZXJzKSB7XG4gICAgICBuZXh0TGlzdGVuZXJzID0gY3VycmVudExpc3RlbmVycy5zbGljZSgpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogUmVhZHMgdGhlIHN0YXRlIHRyZWUgbWFuYWdlZCBieSB0aGUgc3RvcmUuXG4gICAqXG4gICAqIEByZXR1cm5zIHthbnl9IFRoZSBjdXJyZW50IHN0YXRlIHRyZWUgb2YgeW91ciBhcHBsaWNhdGlvbi5cbiAgICovXG5cblxuICBmdW5jdGlvbiBnZXRTdGF0ZSgpIHtcbiAgICBpZiAoaXNEaXNwYXRjaGluZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbWF5IG5vdCBjYWxsIHN0b3JlLmdldFN0YXRlKCkgd2hpbGUgdGhlIHJlZHVjZXIgaXMgZXhlY3V0aW5nLiAnICsgJ1RoZSByZWR1Y2VyIGhhcyBhbHJlYWR5IHJlY2VpdmVkIHRoZSBzdGF0ZSBhcyBhbiBhcmd1bWVudC4gJyArICdQYXNzIGl0IGRvd24gZnJvbSB0aGUgdG9wIHJlZHVjZXIgaW5zdGVhZCBvZiByZWFkaW5nIGl0IGZyb20gdGhlIHN0b3JlLicpO1xuICAgIH1cblxuICAgIHJldHVybiBjdXJyZW50U3RhdGU7XG4gIH1cbiAgLyoqXG4gICAqIEFkZHMgYSBjaGFuZ2UgbGlzdGVuZXIuIEl0IHdpbGwgYmUgY2FsbGVkIGFueSB0aW1lIGFuIGFjdGlvbiBpcyBkaXNwYXRjaGVkLFxuICAgKiBhbmQgc29tZSBwYXJ0IG9mIHRoZSBzdGF0ZSB0cmVlIG1heSBwb3RlbnRpYWxseSBoYXZlIGNoYW5nZWQuIFlvdSBtYXkgdGhlblxuICAgKiBjYWxsIGBnZXRTdGF0ZSgpYCB0byByZWFkIHRoZSBjdXJyZW50IHN0YXRlIHRyZWUgaW5zaWRlIHRoZSBjYWxsYmFjay5cbiAgICpcbiAgICogWW91IG1heSBjYWxsIGBkaXNwYXRjaCgpYCBmcm9tIGEgY2hhbmdlIGxpc3RlbmVyLCB3aXRoIHRoZSBmb2xsb3dpbmdcbiAgICogY2F2ZWF0czpcbiAgICpcbiAgICogMS4gVGhlIHN1YnNjcmlwdGlvbnMgYXJlIHNuYXBzaG90dGVkIGp1c3QgYmVmb3JlIGV2ZXJ5IGBkaXNwYXRjaCgpYCBjYWxsLlxuICAgKiBJZiB5b3Ugc3Vic2NyaWJlIG9yIHVuc3Vic2NyaWJlIHdoaWxlIHRoZSBsaXN0ZW5lcnMgYXJlIGJlaW5nIGludm9rZWQsIHRoaXNcbiAgICogd2lsbCBub3QgaGF2ZSBhbnkgZWZmZWN0IG9uIHRoZSBgZGlzcGF0Y2goKWAgdGhhdCBpcyBjdXJyZW50bHkgaW4gcHJvZ3Jlc3MuXG4gICAqIEhvd2V2ZXIsIHRoZSBuZXh0IGBkaXNwYXRjaCgpYCBjYWxsLCB3aGV0aGVyIG5lc3RlZCBvciBub3QsIHdpbGwgdXNlIGEgbW9yZVxuICAgKiByZWNlbnQgc25hcHNob3Qgb2YgdGhlIHN1YnNjcmlwdGlvbiBsaXN0LlxuICAgKlxuICAgKiAyLiBUaGUgbGlzdGVuZXIgc2hvdWxkIG5vdCBleHBlY3QgdG8gc2VlIGFsbCBzdGF0ZSBjaGFuZ2VzLCBhcyB0aGUgc3RhdGVcbiAgICogbWlnaHQgaGF2ZSBiZWVuIHVwZGF0ZWQgbXVsdGlwbGUgdGltZXMgZHVyaW5nIGEgbmVzdGVkIGBkaXNwYXRjaCgpYCBiZWZvcmVcbiAgICogdGhlIGxpc3RlbmVyIGlzIGNhbGxlZC4gSXQgaXMsIGhvd2V2ZXIsIGd1YXJhbnRlZWQgdGhhdCBhbGwgc3Vic2NyaWJlcnNcbiAgICogcmVnaXN0ZXJlZCBiZWZvcmUgdGhlIGBkaXNwYXRjaCgpYCBzdGFydGVkIHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlIGxhdGVzdFxuICAgKiBzdGF0ZSBieSB0aGUgdGltZSBpdCBleGl0cy5cbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgQSBjYWxsYmFjayB0byBiZSBpbnZva2VkIG9uIGV2ZXJ5IGRpc3BhdGNoLlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgZnVuY3Rpb24gdG8gcmVtb3ZlIHRoaXMgY2hhbmdlIGxpc3RlbmVyLlxuICAgKi9cblxuXG4gIGZ1bmN0aW9uIHN1YnNjcmliZShsaXN0ZW5lcikge1xuICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgdGhlIGxpc3RlbmVyIHRvIGJlIGEgZnVuY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgaWYgKGlzRGlzcGF0Y2hpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG1heSBub3QgY2FsbCBzdG9yZS5zdWJzY3JpYmUoKSB3aGlsZSB0aGUgcmVkdWNlciBpcyBleGVjdXRpbmcuICcgKyAnSWYgeW91IHdvdWxkIGxpa2UgdG8gYmUgbm90aWZpZWQgYWZ0ZXIgdGhlIHN0b3JlIGhhcyBiZWVuIHVwZGF0ZWQsIHN1YnNjcmliZSBmcm9tIGEgJyArICdjb21wb25lbnQgYW5kIGludm9rZSBzdG9yZS5nZXRTdGF0ZSgpIGluIHRoZSBjYWxsYmFjayB0byBhY2Nlc3MgdGhlIGxhdGVzdCBzdGF0ZS4gJyArICdTZWUgaHR0cHM6Ly9yZWR1eC5qcy5vcmcvYXBpLXJlZmVyZW5jZS9zdG9yZSNzdWJzY3JpYmUobGlzdGVuZXIpIGZvciBtb3JlIGRldGFpbHMuJyk7XG4gICAgfVxuXG4gICAgdmFyIGlzU3Vic2NyaWJlZCA9IHRydWU7XG4gICAgZW5zdXJlQ2FuTXV0YXRlTmV4dExpc3RlbmVycygpO1xuICAgIG5leHRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkge1xuICAgICAgaWYgKCFpc1N1YnNjcmliZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXNEaXNwYXRjaGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtYXkgbm90IHVuc3Vic2NyaWJlIGZyb20gYSBzdG9yZSBsaXN0ZW5lciB3aGlsZSB0aGUgcmVkdWNlciBpcyBleGVjdXRpbmcuICcgKyAnU2VlIGh0dHBzOi8vcmVkdXguanMub3JnL2FwaS1yZWZlcmVuY2Uvc3RvcmUjc3Vic2NyaWJlKGxpc3RlbmVyKSBmb3IgbW9yZSBkZXRhaWxzLicpO1xuICAgICAgfVxuXG4gICAgICBpc1N1YnNjcmliZWQgPSBmYWxzZTtcbiAgICAgIGVuc3VyZUNhbk11dGF0ZU5leHRMaXN0ZW5lcnMoKTtcbiAgICAgIHZhciBpbmRleCA9IG5leHRMaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICBuZXh0TGlzdGVuZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogRGlzcGF0Y2hlcyBhbiBhY3Rpb24uIEl0IGlzIHRoZSBvbmx5IHdheSB0byB0cmlnZ2VyIGEgc3RhdGUgY2hhbmdlLlxuICAgKlxuICAgKiBUaGUgYHJlZHVjZXJgIGZ1bmN0aW9uLCB1c2VkIHRvIGNyZWF0ZSB0aGUgc3RvcmUsIHdpbGwgYmUgY2FsbGVkIHdpdGggdGhlXG4gICAqIGN1cnJlbnQgc3RhdGUgdHJlZSBhbmQgdGhlIGdpdmVuIGBhY3Rpb25gLiBJdHMgcmV0dXJuIHZhbHVlIHdpbGxcbiAgICogYmUgY29uc2lkZXJlZCB0aGUgKipuZXh0Kiogc3RhdGUgb2YgdGhlIHRyZWUsIGFuZCB0aGUgY2hhbmdlIGxpc3RlbmVyc1xuICAgKiB3aWxsIGJlIG5vdGlmaWVkLlxuICAgKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvbmx5IHN1cHBvcnRzIHBsYWluIG9iamVjdCBhY3Rpb25zLiBJZiB5b3Ugd2FudCB0b1xuICAgKiBkaXNwYXRjaCBhIFByb21pc2UsIGFuIE9ic2VydmFibGUsIGEgdGh1bmssIG9yIHNvbWV0aGluZyBlbHNlLCB5b3UgbmVlZCB0b1xuICAgKiB3cmFwIHlvdXIgc3RvcmUgY3JlYXRpbmcgZnVuY3Rpb24gaW50byB0aGUgY29ycmVzcG9uZGluZyBtaWRkbGV3YXJlLiBGb3JcbiAgICogZXhhbXBsZSwgc2VlIHRoZSBkb2N1bWVudGF0aW9uIGZvciB0aGUgYHJlZHV4LXRodW5rYCBwYWNrYWdlLiBFdmVuIHRoZVxuICAgKiBtaWRkbGV3YXJlIHdpbGwgZXZlbnR1YWxseSBkaXNwYXRjaCBwbGFpbiBvYmplY3QgYWN0aW9ucyB1c2luZyB0aGlzIG1ldGhvZC5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IGFjdGlvbiBBIHBsYWluIG9iamVjdCByZXByZXNlbnRpbmcg4oCcd2hhdCBjaGFuZ2Vk4oCdLiBJdCBpc1xuICAgKiBhIGdvb2QgaWRlYSB0byBrZWVwIGFjdGlvbnMgc2VyaWFsaXphYmxlIHNvIHlvdSBjYW4gcmVjb3JkIGFuZCByZXBsYXkgdXNlclxuICAgKiBzZXNzaW9ucywgb3IgdXNlIHRoZSB0aW1lIHRyYXZlbGxpbmcgYHJlZHV4LWRldnRvb2xzYC4gQW4gYWN0aW9uIG11c3QgaGF2ZVxuICAgKiBhIGB0eXBlYCBwcm9wZXJ0eSB3aGljaCBtYXkgbm90IGJlIGB1bmRlZmluZWRgLiBJdCBpcyBhIGdvb2QgaWRlYSB0byB1c2VcbiAgICogc3RyaW5nIGNvbnN0YW50cyBmb3IgYWN0aW9uIHR5cGVzLlxuICAgKlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBGb3IgY29udmVuaWVuY2UsIHRoZSBzYW1lIGFjdGlvbiBvYmplY3QgeW91IGRpc3BhdGNoZWQuXG4gICAqXG4gICAqIE5vdGUgdGhhdCwgaWYgeW91IHVzZSBhIGN1c3RvbSBtaWRkbGV3YXJlLCBpdCBtYXkgd3JhcCBgZGlzcGF0Y2goKWAgdG9cbiAgICogcmV0dXJuIHNvbWV0aGluZyBlbHNlIChmb3IgZXhhbXBsZSwgYSBQcm9taXNlIHlvdSBjYW4gYXdhaXQpLlxuICAgKi9cblxuXG4gIGZ1bmN0aW9uIGRpc3BhdGNoKGFjdGlvbikge1xuICAgIGlmICghaXNQbGFpbk9iamVjdChhY3Rpb24pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdGlvbnMgbXVzdCBiZSBwbGFpbiBvYmplY3RzLiAnICsgJ1VzZSBjdXN0b20gbWlkZGxld2FyZSBmb3IgYXN5bmMgYWN0aW9ucy4nKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGFjdGlvbi50eXBlID09PSAndW5kZWZpbmVkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdBY3Rpb25zIG1heSBub3QgaGF2ZSBhbiB1bmRlZmluZWQgXCJ0eXBlXCIgcHJvcGVydHkuICcgKyAnSGF2ZSB5b3UgbWlzc3BlbGxlZCBhIGNvbnN0YW50PycpO1xuICAgIH1cblxuICAgIGlmIChpc0Rpc3BhdGNoaW5nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlZHVjZXJzIG1heSBub3QgZGlzcGF0Y2ggYWN0aW9ucy4nKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgaXNEaXNwYXRjaGluZyA9IHRydWU7XG4gICAgICBjdXJyZW50U3RhdGUgPSBjdXJyZW50UmVkdWNlcihjdXJyZW50U3RhdGUsIGFjdGlvbik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlzRGlzcGF0Y2hpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgbGlzdGVuZXJzID0gY3VycmVudExpc3RlbmVycyA9IG5leHRMaXN0ZW5lcnM7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xuICAgICAgbGlzdGVuZXIoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWN0aW9uO1xuICB9XG4gIC8qKlxuICAgKiBSZXBsYWNlcyB0aGUgcmVkdWNlciBjdXJyZW50bHkgdXNlZCBieSB0aGUgc3RvcmUgdG8gY2FsY3VsYXRlIHRoZSBzdGF0ZS5cbiAgICpcbiAgICogWW91IG1pZ2h0IG5lZWQgdGhpcyBpZiB5b3VyIGFwcCBpbXBsZW1lbnRzIGNvZGUgc3BsaXR0aW5nIGFuZCB5b3Ugd2FudCB0b1xuICAgKiBsb2FkIHNvbWUgb2YgdGhlIHJlZHVjZXJzIGR5bmFtaWNhbGx5LiBZb3UgbWlnaHQgYWxzbyBuZWVkIHRoaXMgaWYgeW91XG4gICAqIGltcGxlbWVudCBhIGhvdCByZWxvYWRpbmcgbWVjaGFuaXNtIGZvciBSZWR1eC5cbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gbmV4dFJlZHVjZXIgVGhlIHJlZHVjZXIgZm9yIHRoZSBzdG9yZSB0byB1c2UgaW5zdGVhZC5cbiAgICogQHJldHVybnMge3ZvaWR9XG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gcmVwbGFjZVJlZHVjZXIobmV4dFJlZHVjZXIpIHtcbiAgICBpZiAodHlwZW9mIG5leHRSZWR1Y2VyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdGVkIHRoZSBuZXh0UmVkdWNlciB0byBiZSBhIGZ1bmN0aW9uLicpO1xuICAgIH1cblxuICAgIGN1cnJlbnRSZWR1Y2VyID0gbmV4dFJlZHVjZXI7IC8vIFRoaXMgYWN0aW9uIGhhcyBhIHNpbWlsaWFyIGVmZmVjdCB0byBBY3Rpb25UeXBlcy5JTklULlxuICAgIC8vIEFueSByZWR1Y2VycyB0aGF0IGV4aXN0ZWQgaW4gYm90aCB0aGUgbmV3IGFuZCBvbGQgcm9vdFJlZHVjZXJcbiAgICAvLyB3aWxsIHJlY2VpdmUgdGhlIHByZXZpb3VzIHN0YXRlLiBUaGlzIGVmZmVjdGl2ZWx5IHBvcHVsYXRlc1xuICAgIC8vIHRoZSBuZXcgc3RhdGUgdHJlZSB3aXRoIGFueSByZWxldmFudCBkYXRhIGZyb20gdGhlIG9sZCBvbmUuXG5cbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiBBY3Rpb25UeXBlcy5SRVBMQUNFXG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEludGVyb3BlcmFiaWxpdHkgcG9pbnQgZm9yIG9ic2VydmFibGUvcmVhY3RpdmUgbGlicmFyaWVzLlxuICAgKiBAcmV0dXJucyB7b2JzZXJ2YWJsZX0gQSBtaW5pbWFsIG9ic2VydmFibGUgb2Ygc3RhdGUgY2hhbmdlcy5cbiAgICogRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZSB0aGUgb2JzZXJ2YWJsZSBwcm9wb3NhbDpcbiAgICogaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtb2JzZXJ2YWJsZVxuICAgKi9cblxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGUoKSB7XG4gICAgdmFyIF9yZWY7XG5cbiAgICB2YXIgb3V0ZXJTdWJzY3JpYmUgPSBzdWJzY3JpYmU7XG4gICAgcmV0dXJuIF9yZWYgPSB7XG4gICAgICAvKipcbiAgICAgICAqIFRoZSBtaW5pbWFsIG9ic2VydmFibGUgc3Vic2NyaXB0aW9uIG1ldGhvZC5cbiAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYnNlcnZlciBBbnkgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgYXMgYW4gb2JzZXJ2ZXIuXG4gICAgICAgKiBUaGUgb2JzZXJ2ZXIgb2JqZWN0IHNob3VsZCBoYXZlIGEgYG5leHRgIG1ldGhvZC5cbiAgICAgICAqIEByZXR1cm5zIHtzdWJzY3JpcHRpb259IEFuIG9iamVjdCB3aXRoIGFuIGB1bnN1YnNjcmliZWAgbWV0aG9kIHRoYXQgY2FuXG4gICAgICAgKiBiZSB1c2VkIHRvIHVuc3Vic2NyaWJlIHRoZSBvYnNlcnZhYmxlIGZyb20gdGhlIHN0b3JlLCBhbmQgcHJldmVudCBmdXJ0aGVyXG4gICAgICAgKiBlbWlzc2lvbiBvZiB2YWx1ZXMgZnJvbSB0aGUgb2JzZXJ2YWJsZS5cbiAgICAgICAqL1xuICAgICAgc3Vic2NyaWJlOiBmdW5jdGlvbiBzdWJzY3JpYmUob2JzZXJ2ZXIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBvYnNlcnZlciAhPT0gJ29iamVjdCcgfHwgb2JzZXJ2ZXIgPT09IG51bGwpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCB0aGUgb2JzZXJ2ZXIgdG8gYmUgYW4gb2JqZWN0LicpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb2JzZXJ2ZVN0YXRlKCkge1xuICAgICAgICAgIGlmIChvYnNlcnZlci5uZXh0KSB7XG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0KGdldFN0YXRlKCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG9ic2VydmVTdGF0ZSgpO1xuICAgICAgICB2YXIgdW5zdWJzY3JpYmUgPSBvdXRlclN1YnNjcmliZShvYnNlcnZlU3RhdGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVuc3Vic2NyaWJlOiB1bnN1YnNjcmliZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0sIF9yZWZbZXNbXCJhXCIgLyogZGVmYXVsdCAqL11dID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSwgX3JlZjtcbiAgfSAvLyBXaGVuIGEgc3RvcmUgaXMgY3JlYXRlZCwgYW4gXCJJTklUXCIgYWN0aW9uIGlzIGRpc3BhdGNoZWQgc28gdGhhdCBldmVyeVxuICAvLyByZWR1Y2VyIHJldHVybnMgdGhlaXIgaW5pdGlhbCBzdGF0ZS4gVGhpcyBlZmZlY3RpdmVseSBwb3B1bGF0ZXNcbiAgLy8gdGhlIGluaXRpYWwgc3RhdGUgdHJlZS5cblxuXG4gIGRpc3BhdGNoKHtcbiAgICB0eXBlOiBBY3Rpb25UeXBlcy5JTklUXG4gIH0pO1xuICByZXR1cm4gX3JlZjIgPSB7XG4gICAgZGlzcGF0Y2g6IGRpc3BhdGNoLFxuICAgIHN1YnNjcmliZTogc3Vic2NyaWJlLFxuICAgIGdldFN0YXRlOiBnZXRTdGF0ZSxcbiAgICByZXBsYWNlUmVkdWNlcjogcmVwbGFjZVJlZHVjZXJcbiAgfSwgX3JlZjJbZXNbXCJhXCIgLyogZGVmYXVsdCAqL11dID0gb2JzZXJ2YWJsZSwgX3JlZjI7XG59XG5cbi8qKlxuICogUHJpbnRzIGEgd2FybmluZyBpbiB0aGUgY29uc29sZSBpZiBpdCBleGlzdHMuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgVGhlIHdhcm5pbmcgbWVzc2FnZS5cbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiB3YXJuaW5nKG1lc3NhZ2UpIHtcbiAgLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqL1xuICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBjb25zb2xlLmVycm9yID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcbiAgfVxuICAvKiBlc2xpbnQtZW5hYmxlIG5vLWNvbnNvbGUgKi9cblxuXG4gIHRyeSB7XG4gICAgLy8gVGhpcyBlcnJvciB3YXMgdGhyb3duIGFzIGEgY29udmVuaWVuY2Ugc28gdGhhdCBpZiB5b3UgZW5hYmxlXG4gICAgLy8gXCJicmVhayBvbiBhbGwgZXhjZXB0aW9uc1wiIGluIHlvdXIgY29uc29sZSxcbiAgICAvLyBpdCB3b3VsZCBwYXVzZSB0aGUgZXhlY3V0aW9uIGF0IHRoaXMgbGluZS5cbiAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIH0gY2F0Y2ggKGUpIHt9IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tZW1wdHlcblxufVxuXG5mdW5jdGlvbiBnZXRVbmRlZmluZWRTdGF0ZUVycm9yTWVzc2FnZShrZXksIGFjdGlvbikge1xuICB2YXIgYWN0aW9uVHlwZSA9IGFjdGlvbiAmJiBhY3Rpb24udHlwZTtcbiAgdmFyIGFjdGlvbkRlc2NyaXB0aW9uID0gYWN0aW9uVHlwZSAmJiBcImFjdGlvbiBcXFwiXCIgKyBTdHJpbmcoYWN0aW9uVHlwZSkgKyBcIlxcXCJcIiB8fCAnYW4gYWN0aW9uJztcbiAgcmV0dXJuIFwiR2l2ZW4gXCIgKyBhY3Rpb25EZXNjcmlwdGlvbiArIFwiLCByZWR1Y2VyIFxcXCJcIiArIGtleSArIFwiXFxcIiByZXR1cm5lZCB1bmRlZmluZWQuIFwiICsgXCJUbyBpZ25vcmUgYW4gYWN0aW9uLCB5b3UgbXVzdCBleHBsaWNpdGx5IHJldHVybiB0aGUgcHJldmlvdXMgc3RhdGUuIFwiICsgXCJJZiB5b3Ugd2FudCB0aGlzIHJlZHVjZXIgdG8gaG9sZCBubyB2YWx1ZSwgeW91IGNhbiByZXR1cm4gbnVsbCBpbnN0ZWFkIG9mIHVuZGVmaW5lZC5cIjtcbn1cblxuZnVuY3Rpb24gZ2V0VW5leHBlY3RlZFN0YXRlU2hhcGVXYXJuaW5nTWVzc2FnZShpbnB1dFN0YXRlLCByZWR1Y2VycywgYWN0aW9uLCB1bmV4cGVjdGVkS2V5Q2FjaGUpIHtcbiAgdmFyIHJlZHVjZXJLZXlzID0gT2JqZWN0LmtleXMocmVkdWNlcnMpO1xuICB2YXIgYXJndW1lbnROYW1lID0gYWN0aW9uICYmIGFjdGlvbi50eXBlID09PSBBY3Rpb25UeXBlcy5JTklUID8gJ3ByZWxvYWRlZFN0YXRlIGFyZ3VtZW50IHBhc3NlZCB0byBjcmVhdGVTdG9yZScgOiAncHJldmlvdXMgc3RhdGUgcmVjZWl2ZWQgYnkgdGhlIHJlZHVjZXInO1xuXG4gIGlmIChyZWR1Y2VyS2V5cy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gJ1N0b3JlIGRvZXMgbm90IGhhdmUgYSB2YWxpZCByZWR1Y2VyLiBNYWtlIHN1cmUgdGhlIGFyZ3VtZW50IHBhc3NlZCAnICsgJ3RvIGNvbWJpbmVSZWR1Y2VycyBpcyBhbiBvYmplY3Qgd2hvc2UgdmFsdWVzIGFyZSByZWR1Y2Vycy4nO1xuICB9XG5cbiAgaWYgKCFpc1BsYWluT2JqZWN0KGlucHV0U3RhdGUpKSB7XG4gICAgcmV0dXJuIFwiVGhlIFwiICsgYXJndW1lbnROYW1lICsgXCIgaGFzIHVuZXhwZWN0ZWQgdHlwZSBvZiBcXFwiXCIgKyB7fS50b1N0cmluZy5jYWxsKGlucHV0U3RhdGUpLm1hdGNoKC9cXHMoW2EtenxBLVpdKykvKVsxXSArIFwiXFxcIi4gRXhwZWN0ZWQgYXJndW1lbnQgdG8gYmUgYW4gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBcIiArIChcImtleXM6IFxcXCJcIiArIHJlZHVjZXJLZXlzLmpvaW4oJ1wiLCBcIicpICsgXCJcXFwiXCIpO1xuICB9XG5cbiAgdmFyIHVuZXhwZWN0ZWRLZXlzID0gT2JqZWN0LmtleXMoaW5wdXRTdGF0ZSkuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gIXJlZHVjZXJzLmhhc093blByb3BlcnR5KGtleSkgJiYgIXVuZXhwZWN0ZWRLZXlDYWNoZVtrZXldO1xuICB9KTtcbiAgdW5leHBlY3RlZEtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgdW5leHBlY3RlZEtleUNhY2hlW2tleV0gPSB0cnVlO1xuICB9KTtcbiAgaWYgKGFjdGlvbiAmJiBhY3Rpb24udHlwZSA9PT0gQWN0aW9uVHlwZXMuUkVQTEFDRSkgcmV0dXJuO1xuXG4gIGlmICh1bmV4cGVjdGVkS2V5cy5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIFwiVW5leHBlY3RlZCBcIiArICh1bmV4cGVjdGVkS2V5cy5sZW5ndGggPiAxID8gJ2tleXMnIDogJ2tleScpICsgXCIgXCIgKyAoXCJcXFwiXCIgKyB1bmV4cGVjdGVkS2V5cy5qb2luKCdcIiwgXCInKSArIFwiXFxcIiBmb3VuZCBpbiBcIiArIGFyZ3VtZW50TmFtZSArIFwiLiBcIikgKyBcIkV4cGVjdGVkIHRvIGZpbmQgb25lIG9mIHRoZSBrbm93biByZWR1Y2VyIGtleXMgaW5zdGVhZDogXCIgKyAoXCJcXFwiXCIgKyByZWR1Y2VyS2V5cy5qb2luKCdcIiwgXCInKSArIFwiXFxcIi4gVW5leHBlY3RlZCBrZXlzIHdpbGwgYmUgaWdub3JlZC5cIik7XG4gIH1cbn1cblxuZnVuY3Rpb24gYXNzZXJ0UmVkdWNlclNoYXBlKHJlZHVjZXJzKSB7XG4gIE9iamVjdC5rZXlzKHJlZHVjZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICB2YXIgcmVkdWNlciA9IHJlZHVjZXJzW2tleV07XG4gICAgdmFyIGluaXRpYWxTdGF0ZSA9IHJlZHVjZXIodW5kZWZpbmVkLCB7XG4gICAgICB0eXBlOiBBY3Rpb25UeXBlcy5JTklUXG4gICAgfSk7XG5cbiAgICBpZiAodHlwZW9mIGluaXRpYWxTdGF0ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlZHVjZXIgXFxcIlwiICsga2V5ICsgXCJcXFwiIHJldHVybmVkIHVuZGVmaW5lZCBkdXJpbmcgaW5pdGlhbGl6YXRpb24uIFwiICsgXCJJZiB0aGUgc3RhdGUgcGFzc2VkIHRvIHRoZSByZWR1Y2VyIGlzIHVuZGVmaW5lZCwgeW91IG11c3QgXCIgKyBcImV4cGxpY2l0bHkgcmV0dXJuIHRoZSBpbml0aWFsIHN0YXRlLiBUaGUgaW5pdGlhbCBzdGF0ZSBtYXkgXCIgKyBcIm5vdCBiZSB1bmRlZmluZWQuIElmIHlvdSBkb24ndCB3YW50IHRvIHNldCBhIHZhbHVlIGZvciB0aGlzIHJlZHVjZXIsIFwiICsgXCJ5b3UgY2FuIHVzZSBudWxsIGluc3RlYWQgb2YgdW5kZWZpbmVkLlwiKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHJlZHVjZXIodW5kZWZpbmVkLCB7XG4gICAgICB0eXBlOiBBY3Rpb25UeXBlcy5QUk9CRV9VTktOT1dOX0FDVElPTigpXG4gICAgfSkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZWR1Y2VyIFxcXCJcIiArIGtleSArIFwiXFxcIiByZXR1cm5lZCB1bmRlZmluZWQgd2hlbiBwcm9iZWQgd2l0aCBhIHJhbmRvbSB0eXBlLiBcIiArIChcIkRvbid0IHRyeSB0byBoYW5kbGUgXCIgKyBBY3Rpb25UeXBlcy5JTklUICsgXCIgb3Igb3RoZXIgYWN0aW9ucyBpbiBcXFwicmVkdXgvKlxcXCIgXCIpICsgXCJuYW1lc3BhY2UuIFRoZXkgYXJlIGNvbnNpZGVyZWQgcHJpdmF0ZS4gSW5zdGVhZCwgeW91IG11c3QgcmV0dXJuIHRoZSBcIiArIFwiY3VycmVudCBzdGF0ZSBmb3IgYW55IHVua25vd24gYWN0aW9ucywgdW5sZXNzIGl0IGlzIHVuZGVmaW5lZCwgXCIgKyBcImluIHdoaWNoIGNhc2UgeW91IG11c3QgcmV0dXJuIHRoZSBpbml0aWFsIHN0YXRlLCByZWdhcmRsZXNzIG9mIHRoZSBcIiArIFwiYWN0aW9uIHR5cGUuIFRoZSBpbml0aWFsIHN0YXRlIG1heSBub3QgYmUgdW5kZWZpbmVkLCBidXQgY2FuIGJlIG51bGwuXCIpO1xuICAgIH1cbiAgfSk7XG59XG4vKipcbiAqIFR1cm5zIGFuIG9iamVjdCB3aG9zZSB2YWx1ZXMgYXJlIGRpZmZlcmVudCByZWR1Y2VyIGZ1bmN0aW9ucywgaW50byBhIHNpbmdsZVxuICogcmVkdWNlciBmdW5jdGlvbi4gSXQgd2lsbCBjYWxsIGV2ZXJ5IGNoaWxkIHJlZHVjZXIsIGFuZCBnYXRoZXIgdGhlaXIgcmVzdWx0c1xuICogaW50byBhIHNpbmdsZSBzdGF0ZSBvYmplY3QsIHdob3NlIGtleXMgY29ycmVzcG9uZCB0byB0aGUga2V5cyBvZiB0aGUgcGFzc2VkXG4gKiByZWR1Y2VyIGZ1bmN0aW9ucy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gcmVkdWNlcnMgQW4gb2JqZWN0IHdob3NlIHZhbHVlcyBjb3JyZXNwb25kIHRvIGRpZmZlcmVudFxuICogcmVkdWNlciBmdW5jdGlvbnMgdGhhdCBuZWVkIHRvIGJlIGNvbWJpbmVkIGludG8gb25lLiBPbmUgaGFuZHkgd2F5IHRvIG9idGFpblxuICogaXQgaXMgdG8gdXNlIEVTNiBgaW1wb3J0ICogYXMgcmVkdWNlcnNgIHN5bnRheC4gVGhlIHJlZHVjZXJzIG1heSBuZXZlciByZXR1cm5cbiAqIHVuZGVmaW5lZCBmb3IgYW55IGFjdGlvbi4gSW5zdGVhZCwgdGhleSBzaG91bGQgcmV0dXJuIHRoZWlyIGluaXRpYWwgc3RhdGVcbiAqIGlmIHRoZSBzdGF0ZSBwYXNzZWQgdG8gdGhlbSB3YXMgdW5kZWZpbmVkLCBhbmQgdGhlIGN1cnJlbnQgc3RhdGUgZm9yIGFueVxuICogdW5yZWNvZ25pemVkIGFjdGlvbi5cbiAqXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgcmVkdWNlciBmdW5jdGlvbiB0aGF0IGludm9rZXMgZXZlcnkgcmVkdWNlciBpbnNpZGUgdGhlXG4gKiBwYXNzZWQgb2JqZWN0LCBhbmQgYnVpbGRzIGEgc3RhdGUgb2JqZWN0IHdpdGggdGhlIHNhbWUgc2hhcGUuXG4gKi9cblxuXG5mdW5jdGlvbiBjb21iaW5lUmVkdWNlcnMocmVkdWNlcnMpIHtcbiAgdmFyIHJlZHVjZXJLZXlzID0gT2JqZWN0LmtleXMocmVkdWNlcnMpO1xuICB2YXIgZmluYWxSZWR1Y2VycyA9IHt9O1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcmVkdWNlcktleXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIga2V5ID0gcmVkdWNlcktleXNbaV07XG5cbiAgICBpZiAoZmFsc2UpIHt9XG5cbiAgICBpZiAodHlwZW9mIHJlZHVjZXJzW2tleV0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGZpbmFsUmVkdWNlcnNba2V5XSA9IHJlZHVjZXJzW2tleV07XG4gICAgfVxuICB9XG5cbiAgdmFyIGZpbmFsUmVkdWNlcktleXMgPSBPYmplY3Qua2V5cyhmaW5hbFJlZHVjZXJzKTsgLy8gVGhpcyBpcyB1c2VkIHRvIG1ha2Ugc3VyZSB3ZSBkb24ndCB3YXJuIGFib3V0IHRoZSBzYW1lXG4gIC8vIGtleXMgbXVsdGlwbGUgdGltZXMuXG5cbiAgdmFyIHVuZXhwZWN0ZWRLZXlDYWNoZTtcblxuICBpZiAoZmFsc2UpIHt9XG5cbiAgdmFyIHNoYXBlQXNzZXJ0aW9uRXJyb3I7XG5cbiAgdHJ5IHtcbiAgICBhc3NlcnRSZWR1Y2VyU2hhcGUoZmluYWxSZWR1Y2Vycyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBzaGFwZUFzc2VydGlvbkVycm9yID0gZTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiBjb21iaW5hdGlvbihzdGF0ZSwgYWN0aW9uKSB7XG4gICAgaWYgKHN0YXRlID09PSB2b2lkIDApIHtcbiAgICAgIHN0YXRlID0ge307XG4gICAgfVxuXG4gICAgaWYgKHNoYXBlQXNzZXJ0aW9uRXJyb3IpIHtcbiAgICAgIHRocm93IHNoYXBlQXNzZXJ0aW9uRXJyb3I7XG4gICAgfVxuXG4gICAgaWYgKGZhbHNlKSB7IHZhciB3YXJuaW5nTWVzc2FnZTsgfVxuXG4gICAgdmFyIGhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICB2YXIgbmV4dFN0YXRlID0ge307XG5cbiAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgZmluYWxSZWR1Y2VyS2V5cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBfa2V5ID0gZmluYWxSZWR1Y2VyS2V5c1tfaV07XG4gICAgICB2YXIgcmVkdWNlciA9IGZpbmFsUmVkdWNlcnNbX2tleV07XG4gICAgICB2YXIgcHJldmlvdXNTdGF0ZUZvcktleSA9IHN0YXRlW19rZXldO1xuICAgICAgdmFyIG5leHRTdGF0ZUZvcktleSA9IHJlZHVjZXIocHJldmlvdXNTdGF0ZUZvcktleSwgYWN0aW9uKTtcblxuICAgICAgaWYgKHR5cGVvZiBuZXh0U3RhdGVGb3JLZXkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBnZXRVbmRlZmluZWRTdGF0ZUVycm9yTWVzc2FnZShfa2V5LCBhY3Rpb24pO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICAgIH1cblxuICAgICAgbmV4dFN0YXRlW19rZXldID0gbmV4dFN0YXRlRm9yS2V5O1xuICAgICAgaGFzQ2hhbmdlZCA9IGhhc0NoYW5nZWQgfHwgbmV4dFN0YXRlRm9yS2V5ICE9PSBwcmV2aW91c1N0YXRlRm9yS2V5O1xuICAgIH1cblxuICAgIHJldHVybiBoYXNDaGFuZ2VkID8gbmV4dFN0YXRlIDogc3RhdGU7XG4gIH07XG59XG5cbmZ1bmN0aW9uIGJpbmRBY3Rpb25DcmVhdG9yKGFjdGlvbkNyZWF0b3IsIGRpc3BhdGNoKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRpc3BhdGNoKGFjdGlvbkNyZWF0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH07XG59XG4vKipcbiAqIFR1cm5zIGFuIG9iamVjdCB3aG9zZSB2YWx1ZXMgYXJlIGFjdGlvbiBjcmVhdG9ycywgaW50byBhbiBvYmplY3Qgd2l0aCB0aGVcbiAqIHNhbWUga2V5cywgYnV0IHdpdGggZXZlcnkgZnVuY3Rpb24gd3JhcHBlZCBpbnRvIGEgYGRpc3BhdGNoYCBjYWxsIHNvIHRoZXlcbiAqIG1heSBiZSBpbnZva2VkIGRpcmVjdGx5LiBUaGlzIGlzIGp1c3QgYSBjb252ZW5pZW5jZSBtZXRob2QsIGFzIHlvdSBjYW4gY2FsbFxuICogYHN0b3JlLmRpc3BhdGNoKE15QWN0aW9uQ3JlYXRvcnMuZG9Tb21ldGhpbmcoKSlgIHlvdXJzZWxmIGp1c3QgZmluZS5cbiAqXG4gKiBGb3IgY29udmVuaWVuY2UsIHlvdSBjYW4gYWxzbyBwYXNzIGFuIGFjdGlvbiBjcmVhdG9yIGFzIHRoZSBmaXJzdCBhcmd1bWVudCxcbiAqIGFuZCBnZXQgYSBkaXNwYXRjaCB3cmFwcGVkIGZ1bmN0aW9uIGluIHJldHVybi5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdH0gYWN0aW9uQ3JlYXRvcnMgQW4gb2JqZWN0IHdob3NlIHZhbHVlcyBhcmUgYWN0aW9uXG4gKiBjcmVhdG9yIGZ1bmN0aW9ucy4gT25lIGhhbmR5IHdheSB0byBvYnRhaW4gaXQgaXMgdG8gdXNlIEVTNiBgaW1wb3J0ICogYXNgXG4gKiBzeW50YXguIFlvdSBtYXkgYWxzbyBwYXNzIGEgc2luZ2xlIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGRpc3BhdGNoIFRoZSBgZGlzcGF0Y2hgIGZ1bmN0aW9uIGF2YWlsYWJsZSBvbiB5b3VyIFJlZHV4XG4gKiBzdG9yZS5cbiAqXG4gKiBAcmV0dXJucyB7RnVuY3Rpb258T2JqZWN0fSBUaGUgb2JqZWN0IG1pbWlja2luZyB0aGUgb3JpZ2luYWwgb2JqZWN0LCBidXQgd2l0aFxuICogZXZlcnkgYWN0aW9uIGNyZWF0b3Igd3JhcHBlZCBpbnRvIHRoZSBgZGlzcGF0Y2hgIGNhbGwuIElmIHlvdSBwYXNzZWQgYVxuICogZnVuY3Rpb24gYXMgYGFjdGlvbkNyZWF0b3JzYCwgdGhlIHJldHVybiB2YWx1ZSB3aWxsIGFsc28gYmUgYSBzaW5nbGVcbiAqIGZ1bmN0aW9uLlxuICovXG5cblxuZnVuY3Rpb24gYmluZEFjdGlvbkNyZWF0b3JzKGFjdGlvbkNyZWF0b3JzLCBkaXNwYXRjaCkge1xuICBpZiAodHlwZW9mIGFjdGlvbkNyZWF0b3JzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIGJpbmRBY3Rpb25DcmVhdG9yKGFjdGlvbkNyZWF0b3JzLCBkaXNwYXRjaCk7XG4gIH1cblxuICBpZiAodHlwZW9mIGFjdGlvbkNyZWF0b3JzICE9PSAnb2JqZWN0JyB8fCBhY3Rpb25DcmVhdG9ycyA9PT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcImJpbmRBY3Rpb25DcmVhdG9ycyBleHBlY3RlZCBhbiBvYmplY3Qgb3IgYSBmdW5jdGlvbiwgaW5zdGVhZCByZWNlaXZlZCBcIiArIChhY3Rpb25DcmVhdG9ycyA9PT0gbnVsbCA/ICdudWxsJyA6IHR5cGVvZiBhY3Rpb25DcmVhdG9ycykgKyBcIi4gXCIgKyBcIkRpZCB5b3Ugd3JpdGUgXFxcImltcG9ydCBBY3Rpb25DcmVhdG9ycyBmcm9tXFxcIiBpbnN0ZWFkIG9mIFxcXCJpbXBvcnQgKiBhcyBBY3Rpb25DcmVhdG9ycyBmcm9tXFxcIj9cIik7XG4gIH1cblxuICB2YXIgYm91bmRBY3Rpb25DcmVhdG9ycyA9IHt9O1xuXG4gIGZvciAodmFyIGtleSBpbiBhY3Rpb25DcmVhdG9ycykge1xuICAgIHZhciBhY3Rpb25DcmVhdG9yID0gYWN0aW9uQ3JlYXRvcnNba2V5XTtcblxuICAgIGlmICh0eXBlb2YgYWN0aW9uQ3JlYXRvciA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYm91bmRBY3Rpb25DcmVhdG9yc1trZXldID0gYmluZEFjdGlvbkNyZWF0b3IoYWN0aW9uQ3JlYXRvciwgZGlzcGF0Y2gpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBib3VuZEFjdGlvbkNyZWF0b3JzO1xufVxuXG5mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7XG4gIGlmIChrZXkgaW4gb2JqKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgd3JpdGFibGU6IHRydWVcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIG9iajtcbn1cblxuZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7XG4gIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTtcblxuICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykge1xuICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCkpO1xuICB9XG5cbiAgaWYgKGVudW1lcmFibGVPbmx5KSBrZXlzID0ga2V5cy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkge1xuICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlO1xuICB9KTtcbiAgcmV0dXJuIGtleXM7XG59XG5cbmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKHRhcmdldCkge1xuICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9O1xuXG4gICAgaWYgKGkgJSAyKSB7XG4gICAgICBvd25LZXlzKHNvdXJjZSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3duS2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0YXJnZXQ7XG59XG5cbi8qKlxuICogQ29tcG9zZXMgc2luZ2xlLWFyZ3VtZW50IGZ1bmN0aW9ucyBmcm9tIHJpZ2h0IHRvIGxlZnQuIFRoZSByaWdodG1vc3RcbiAqIGZ1bmN0aW9uIGNhbiB0YWtlIG11bHRpcGxlIGFyZ3VtZW50cyBhcyBpdCBwcm92aWRlcyB0aGUgc2lnbmF0dXJlIGZvclxuICogdGhlIHJlc3VsdGluZyBjb21wb3NpdGUgZnVuY3Rpb24uXG4gKlxuICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gZnVuY3MgVGhlIGZ1bmN0aW9ucyB0byBjb21wb3NlLlxuICogQHJldHVybnMge0Z1bmN0aW9ufSBBIGZ1bmN0aW9uIG9idGFpbmVkIGJ5IGNvbXBvc2luZyB0aGUgYXJndW1lbnQgZnVuY3Rpb25zXG4gKiBmcm9tIHJpZ2h0IHRvIGxlZnQuIEZvciBleGFtcGxlLCBjb21wb3NlKGYsIGcsIGgpIGlzIGlkZW50aWNhbCB0byBkb2luZ1xuICogKC4uLmFyZ3MpID0+IGYoZyhoKC4uLmFyZ3MpKSkuXG4gKi9cbmZ1bmN0aW9uIGNvbXBvc2UoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBmdW5jcyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBmdW5jc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIGlmIChmdW5jcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGFyZykge1xuICAgICAgcmV0dXJuIGFyZztcbiAgICB9O1xuICB9XG5cbiAgaWYgKGZ1bmNzLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBmdW5jc1swXTtcbiAgfVxuXG4gIHJldHVybiBmdW5jcy5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGEoYi5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cykpO1xuICAgIH07XG4gIH0pO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBzdG9yZSBlbmhhbmNlciB0aGF0IGFwcGxpZXMgbWlkZGxld2FyZSB0byB0aGUgZGlzcGF0Y2ggbWV0aG9kXG4gKiBvZiB0aGUgUmVkdXggc3RvcmUuIFRoaXMgaXMgaGFuZHkgZm9yIGEgdmFyaWV0eSBvZiB0YXNrcywgc3VjaCBhcyBleHByZXNzaW5nXG4gKiBhc3luY2hyb25vdXMgYWN0aW9ucyBpbiBhIGNvbmNpc2UgbWFubmVyLCBvciBsb2dnaW5nIGV2ZXJ5IGFjdGlvbiBwYXlsb2FkLlxuICpcbiAqIFNlZSBgcmVkdXgtdGh1bmtgIHBhY2thZ2UgYXMgYW4gZXhhbXBsZSBvZiB0aGUgUmVkdXggbWlkZGxld2FyZS5cbiAqXG4gKiBCZWNhdXNlIG1pZGRsZXdhcmUgaXMgcG90ZW50aWFsbHkgYXN5bmNocm9ub3VzLCB0aGlzIHNob3VsZCBiZSB0aGUgZmlyc3RcbiAqIHN0b3JlIGVuaGFuY2VyIGluIHRoZSBjb21wb3NpdGlvbiBjaGFpbi5cbiAqXG4gKiBOb3RlIHRoYXQgZWFjaCBtaWRkbGV3YXJlIHdpbGwgYmUgZ2l2ZW4gdGhlIGBkaXNwYXRjaGAgYW5kIGBnZXRTdGF0ZWAgZnVuY3Rpb25zXG4gKiBhcyBuYW1lZCBhcmd1bWVudHMuXG4gKlxuICogQHBhcmFtIHsuLi5GdW5jdGlvbn0gbWlkZGxld2FyZXMgVGhlIG1pZGRsZXdhcmUgY2hhaW4gdG8gYmUgYXBwbGllZC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQSBzdG9yZSBlbmhhbmNlciBhcHBseWluZyB0aGUgbWlkZGxld2FyZS5cbiAqL1xuXG5mdW5jdGlvbiBhcHBseU1pZGRsZXdhcmUoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBtaWRkbGV3YXJlcyA9IG5ldyBBcnJheShfbGVuKSwgX2tleSA9IDA7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICBtaWRkbGV3YXJlc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTtcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbiAoY3JlYXRlU3RvcmUpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHN0b3JlID0gY3JlYXRlU3RvcmUuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpO1xuXG4gICAgICB2YXIgX2Rpc3BhdGNoID0gZnVuY3Rpb24gZGlzcGF0Y2goKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRGlzcGF0Y2hpbmcgd2hpbGUgY29uc3RydWN0aW5nIHlvdXIgbWlkZGxld2FyZSBpcyBub3QgYWxsb3dlZC4gJyArICdPdGhlciBtaWRkbGV3YXJlIHdvdWxkIG5vdCBiZSBhcHBsaWVkIHRvIHRoaXMgZGlzcGF0Y2guJyk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgbWlkZGxld2FyZUFQSSA9IHtcbiAgICAgICAgZ2V0U3RhdGU6IHN0b3JlLmdldFN0YXRlLFxuICAgICAgICBkaXNwYXRjaDogZnVuY3Rpb24gZGlzcGF0Y2goKSB7XG4gICAgICAgICAgcmV0dXJuIF9kaXNwYXRjaC5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB2YXIgY2hhaW4gPSBtaWRkbGV3YXJlcy5tYXAoZnVuY3Rpb24gKG1pZGRsZXdhcmUpIHtcbiAgICAgICAgcmV0dXJuIG1pZGRsZXdhcmUobWlkZGxld2FyZUFQSSk7XG4gICAgICB9KTtcbiAgICAgIF9kaXNwYXRjaCA9IGNvbXBvc2UuYXBwbHkodm9pZCAwLCBjaGFpbikoc3RvcmUuZGlzcGF0Y2gpO1xuICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQyKHt9LCBzdG9yZSwge1xuICAgICAgICBkaXNwYXRjaDogX2Rpc3BhdGNoXG4gICAgICB9KTtcbiAgICB9O1xuICB9O1xufVxuXG4vKlxuICogVGhpcyBpcyBhIGR1bW15IGZ1bmN0aW9uIHRvIGNoZWNrIGlmIHRoZSBmdW5jdGlvbiBuYW1lIGhhcyBiZWVuIGFsdGVyZWQgYnkgbWluaWZpY2F0aW9uLlxuICogSWYgdGhlIGZ1bmN0aW9uIGhhcyBiZWVuIG1pbmlmaWVkIGFuZCBOT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nLCB3YXJuIHRoZSB1c2VyLlxuICovXG5cbmZ1bmN0aW9uIGlzQ3J1c2hlZCgpIHt9XG5cbmlmIChmYWxzZSkge31cblxuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvcmVkdWNlcnMvaXRlbXMuanNcbnZhciBkZWZhdWx0U3RhdGUgPSBbXTtcbmZ1bmN0aW9uIGl0ZW1zX2l0ZW1zKHN0YXRlLCBhY3Rpb24pIHtcbiAgaWYgKHN0YXRlID09PSB2b2lkIDApIHtcbiAgICBzdGF0ZSA9IGRlZmF1bHRTdGF0ZTtcbiAgfVxuXG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlICdBRERfSVRFTSc6XG4gICAgICB7XG4gICAgICAgIC8vIEFkZCBvYmplY3QgdG8gaXRlbXMgYXJyYXlcbiAgICAgICAgdmFyIG5ld1N0YXRlID0gW10uY29uY2F0KHN0YXRlLCBbe1xuICAgICAgICAgIGlkOiBhY3Rpb24uaWQsXG4gICAgICAgICAgY2hvaWNlSWQ6IGFjdGlvbi5jaG9pY2VJZCxcbiAgICAgICAgICBncm91cElkOiBhY3Rpb24uZ3JvdXBJZCxcbiAgICAgICAgICB2YWx1ZTogYWN0aW9uLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBhY3Rpb24ubGFiZWwsXG4gICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgIGhpZ2hsaWdodGVkOiBmYWxzZSxcbiAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBhY3Rpb24uY3VzdG9tUHJvcGVydGllcyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogYWN0aW9uLnBsYWNlaG9sZGVyIHx8IGZhbHNlLFxuICAgICAgICAgIGtleUNvZGU6IG51bGxcbiAgICAgICAgfV0pO1xuICAgICAgICByZXR1cm4gbmV3U3RhdGUubWFwKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IG9iajtcbiAgICAgICAgICBpdGVtLmhpZ2hsaWdodGVkID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgY2FzZSAnUkVNT1ZFX0lURU0nOlxuICAgICAge1xuICAgICAgICAvLyBTZXQgaXRlbSB0byBpbmFjdGl2ZVxuICAgICAgICByZXR1cm4gc3RhdGUubWFwKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IG9iajtcblxuICAgICAgICAgIGlmIChpdGVtLmlkID09PSBhY3Rpb24uaWQpIHtcbiAgICAgICAgICAgIGl0ZW0uYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgY2FzZSAnSElHSExJR0hUX0lURU0nOlxuICAgICAge1xuICAgICAgICByZXR1cm4gc3RhdGUubWFwKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IG9iajtcblxuICAgICAgICAgIGlmIChpdGVtLmlkID09PSBhY3Rpb24uaWQpIHtcbiAgICAgICAgICAgIGl0ZW0uaGlnaGxpZ2h0ZWQgPSBhY3Rpb24uaGlnaGxpZ2h0ZWQ7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgZGVmYXVsdDpcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuICB9XG59XG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL3JlZHVjZXJzL2dyb3Vwcy5qc1xudmFyIGdyb3Vwc19kZWZhdWx0U3RhdGUgPSBbXTtcbmZ1bmN0aW9uIGdyb3VwcyhzdGF0ZSwgYWN0aW9uKSB7XG4gIGlmIChzdGF0ZSA9PT0gdm9pZCAwKSB7XG4gICAgc3RhdGUgPSBncm91cHNfZGVmYXVsdFN0YXRlO1xuICB9XG5cbiAgc3dpdGNoIChhY3Rpb24udHlwZSkge1xuICAgIGNhc2UgJ0FERF9HUk9VUCc6XG4gICAgICB7XG4gICAgICAgIHJldHVybiBbXS5jb25jYXQoc3RhdGUsIFt7XG4gICAgICAgICAgaWQ6IGFjdGlvbi5pZCxcbiAgICAgICAgICB2YWx1ZTogYWN0aW9uLnZhbHVlLFxuICAgICAgICAgIGFjdGl2ZTogYWN0aW9uLmFjdGl2ZSxcbiAgICAgICAgICBkaXNhYmxlZDogYWN0aW9uLmRpc2FibGVkXG4gICAgICAgIH1dKTtcbiAgICAgIH1cblxuICAgIGNhc2UgJ0NMRUFSX0NIT0lDRVMnOlxuICAgICAge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG5cbiAgICBkZWZhdWx0OlxuICAgICAge1xuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICB9XG4gIH1cbn1cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvcmVkdWNlcnMvY2hvaWNlcy5qc1xudmFyIGNob2ljZXNfZGVmYXVsdFN0YXRlID0gW107XG5mdW5jdGlvbiBjaG9pY2VzX2Nob2ljZXMoc3RhdGUsIGFjdGlvbikge1xuICBpZiAoc3RhdGUgPT09IHZvaWQgMCkge1xuICAgIHN0YXRlID0gY2hvaWNlc19kZWZhdWx0U3RhdGU7XG4gIH1cblxuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgY2FzZSAnQUREX0NIT0lDRSc6XG4gICAgICB7XG4gICAgICAgIC8qXG4gICAgICAgICAgICBBIGRpc2FibGVkIGNob2ljZSBhcHBlYXJzIGluIHRoZSBjaG9pY2UgZHJvcGRvd24gYnV0IGNhbm5vdCBiZSBzZWxlY3RlZFxuICAgICAgICAgICAgQSBzZWxlY3RlZCBjaG9pY2UgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHBhc3NlZCBpbnB1dCdzIHZhbHVlIChhZGRlZCBhcyBhbiBpdGVtKVxuICAgICAgICAgICAgQW4gYWN0aXZlIGNob2ljZSBhcHBlYXJzIHdpdGhpbiB0aGUgY2hvaWNlIGRyb3Bkb3duXG4gICAgICAgICAqL1xuICAgICAgICByZXR1cm4gW10uY29uY2F0KHN0YXRlLCBbe1xuICAgICAgICAgIGlkOiBhY3Rpb24uaWQsXG4gICAgICAgICAgZWxlbWVudElkOiBhY3Rpb24uZWxlbWVudElkLFxuICAgICAgICAgIGdyb3VwSWQ6IGFjdGlvbi5ncm91cElkLFxuICAgICAgICAgIHZhbHVlOiBhY3Rpb24udmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGFjdGlvbi5sYWJlbCB8fCBhY3Rpb24udmFsdWUsXG4gICAgICAgICAgZGlzYWJsZWQ6IGFjdGlvbi5kaXNhYmxlZCB8fCBmYWxzZSxcbiAgICAgICAgICBzZWxlY3RlZDogZmFsc2UsXG4gICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgIHNjb3JlOiA5OTk5LFxuICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGFjdGlvbi5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgICAgIHBsYWNlaG9sZGVyOiBhY3Rpb24ucGxhY2Vob2xkZXIgfHwgZmFsc2UsXG4gICAgICAgICAga2V5Q29kZTogbnVsbFxuICAgICAgICB9XSk7XG4gICAgICB9XG5cbiAgICBjYXNlICdBRERfSVRFTSc6XG4gICAgICB7XG4gICAgICAgIC8vIElmIGFsbCBjaG9pY2VzIG5lZWQgdG8gYmUgYWN0aXZhdGVkXG4gICAgICAgIGlmIChhY3Rpb24uYWN0aXZhdGVPcHRpb25zKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlLm1hcChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICB2YXIgY2hvaWNlID0gb2JqO1xuICAgICAgICAgICAgY2hvaWNlLmFjdGl2ZSA9IGFjdGlvbi5hY3RpdmU7XG4gICAgICAgICAgICByZXR1cm4gY2hvaWNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IC8vIFdoZW4gYW4gaXRlbSBpcyBhZGRlZCBhbmQgaXQgaGFzIGFuIGFzc29jaWF0ZWQgY2hvaWNlLFxuICAgICAgICAvLyB3ZSB3YW50IHRvIGRpc2FibGUgaXQgc28gaXQgY2FuJ3QgYmUgY2hvc2VuIGFnYWluXG5cblxuICAgICAgICBpZiAoYWN0aW9uLmNob2ljZUlkID4gLTEpIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGUubWFwKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHZhciBjaG9pY2UgPSBvYmo7XG5cbiAgICAgICAgICAgIGlmIChjaG9pY2UuaWQgPT09IHBhcnNlSW50KGFjdGlvbi5jaG9pY2VJZCwgMTApKSB7XG4gICAgICAgICAgICAgIGNob2ljZS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjaG9pY2U7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICB9XG5cbiAgICBjYXNlICdSRU1PVkVfSVRFTSc6XG4gICAgICB7XG4gICAgICAgIC8vIFdoZW4gYW4gaXRlbSBpcyByZW1vdmVkIGFuZCBpdCBoYXMgYW4gYXNzb2NpYXRlZCBjaG9pY2UsXG4gICAgICAgIC8vIHdlIHdhbnQgdG8gcmUtZW5hYmxlIGl0IHNvIGl0IGNhbiBiZSBjaG9zZW4gYWdhaW5cbiAgICAgICAgaWYgKGFjdGlvbi5jaG9pY2VJZCA+IC0xKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlLm1hcChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICB2YXIgY2hvaWNlID0gb2JqO1xuXG4gICAgICAgICAgICBpZiAoY2hvaWNlLmlkID09PSBwYXJzZUludChhY3Rpb24uY2hvaWNlSWQsIDEwKSkge1xuICAgICAgICAgICAgICBjaG9pY2Uuc2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNob2ljZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICAgIH1cblxuICAgIGNhc2UgJ0ZJTFRFUl9DSE9JQ0VTJzpcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlLm1hcChmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgdmFyIGNob2ljZSA9IG9iajsgLy8gU2V0IGFjdGl2ZSBzdGF0ZSBiYXNlZCBvbiB3aGV0aGVyIGNob2ljZSBpc1xuICAgICAgICAgIC8vIHdpdGhpbiBmaWx0ZXJlZCByZXN1bHRzXG5cbiAgICAgICAgICBjaG9pY2UuYWN0aXZlID0gYWN0aW9uLnJlc3VsdHMuc29tZShmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBfcmVmLml0ZW0sXG4gICAgICAgICAgICAgICAgc2NvcmUgPSBfcmVmLnNjb3JlO1xuXG4gICAgICAgICAgICBpZiAoaXRlbS5pZCA9PT0gY2hvaWNlLmlkKSB7XG4gICAgICAgICAgICAgIGNob2ljZS5zY29yZSA9IHNjb3JlO1xuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjaG9pY2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgY2FzZSAnQUNUSVZBVEVfQ0hPSUNFUyc6XG4gICAgICB7XG4gICAgICAgIHJldHVybiBzdGF0ZS5tYXAoZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgIHZhciBjaG9pY2UgPSBvYmo7XG4gICAgICAgICAgY2hvaWNlLmFjdGl2ZSA9IGFjdGlvbi5hY3RpdmU7XG4gICAgICAgICAgcmV0dXJuIGNob2ljZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICBjYXNlICdDTEVBUl9DSE9JQ0VTJzpcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuIGNob2ljZXNfZGVmYXVsdFN0YXRlO1xuICAgICAgfVxuXG4gICAgZGVmYXVsdDpcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuICB9XG59XG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL3JlZHVjZXJzL2dlbmVyYWwuanNcbnZhciBnZW5lcmFsX2RlZmF1bHRTdGF0ZSA9IHtcbiAgbG9hZGluZzogZmFsc2Vcbn07XG5cbnZhciBnZW5lcmFsID0gZnVuY3Rpb24gZ2VuZXJhbChzdGF0ZSwgYWN0aW9uKSB7XG4gIGlmIChzdGF0ZSA9PT0gdm9pZCAwKSB7XG4gICAgc3RhdGUgPSBnZW5lcmFsX2RlZmF1bHRTdGF0ZTtcbiAgfVxuXG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlICdTRVRfSVNfTE9BRElORyc6XG4gICAgICB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbG9hZGluZzogYWN0aW9uLmlzTG9hZGluZ1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgZGVmYXVsdDpcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuICB9XG59O1xuXG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIHZhciByZWR1Y2Vyc19nZW5lcmFsID0gKGdlbmVyYWwpO1xuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9saWIvdXRpbHMuanNcbi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IG1pblxuICogQHBhcmFtIHtudW1iZXJ9IG1heFxuICogQHJldHVybnMge251bWJlcn1cbiAqL1xudmFyIGdldFJhbmRvbU51bWJlciA9IGZ1bmN0aW9uIGdldFJhbmRvbU51bWJlcihtaW4sIG1heCkge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW4pO1xufTtcbi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IGxlbmd0aFxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuXG52YXIgZ2VuZXJhdGVDaGFycyA9IGZ1bmN0aW9uIGdlbmVyYXRlQ2hhcnMobGVuZ3RoKSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHtcbiAgICBsZW5ndGg6IGxlbmd0aFxuICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGdldFJhbmRvbU51bWJlcigwLCAzNikudG9TdHJpbmcoMzYpO1xuICB9KS5qb2luKCcnKTtcbn07XG4vKipcbiAqIEBwYXJhbSB7SFRNTElucHV0RWxlbWVudCB8IEhUTUxTZWxlY3RFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4XG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5cbnZhciBnZW5lcmF0ZUlkID0gZnVuY3Rpb24gZ2VuZXJhdGVJZChlbGVtZW50LCBwcmVmaXgpIHtcbiAgdmFyIGlkID0gZWxlbWVudC5pZCB8fCBlbGVtZW50Lm5hbWUgJiYgZWxlbWVudC5uYW1lICsgXCItXCIgKyBnZW5lcmF0ZUNoYXJzKDIpIHx8IGdlbmVyYXRlQ2hhcnMoNCk7XG4gIGlkID0gaWQucmVwbGFjZSgvKDp8XFwufFxcW3xcXF18LCkvZywgJycpO1xuICBpZCA9IHByZWZpeCArIFwiLVwiICsgaWQ7XG4gIHJldHVybiBpZDtcbn07XG4vKipcbiAqIEBwYXJhbSB7YW55fSBvYmpcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cblxudmFyIGdldFR5cGUgPSBmdW5jdGlvbiBnZXRUeXBlKG9iaikge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikuc2xpY2UoOCwgLTEpO1xufTtcbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcbiAqIEBwYXJhbSB7YW55fSBvYmpcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5cbnZhciBpc1R5cGUgPSBmdW5jdGlvbiBpc1R5cGUodHlwZSwgb2JqKSB7XG4gIHJldHVybiBvYmogIT09IHVuZGVmaW5lZCAmJiBvYmogIT09IG51bGwgJiYgZ2V0VHlwZShvYmopID09PSB0eXBlO1xufTtcbi8qKlxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gZWxlbWVudFxuICogQHBhcmFtIHtIVE1MRWxlbWVudH0gW3dyYXBwZXI9e0hUTUxEaXZFbGVtZW50fV1cbiAqIEByZXR1cm5zIHtIVE1MRWxlbWVudH1cbiAqL1xuXG52YXIgdXRpbHNfd3JhcCA9IGZ1bmN0aW9uIHdyYXAoZWxlbWVudCwgd3JhcHBlcikge1xuICBpZiAod3JhcHBlciA9PT0gdm9pZCAwKSB7XG4gICAgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB9XG5cbiAgaWYgKGVsZW1lbnQubmV4dFNpYmxpbmcpIHtcbiAgICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXIsIGVsZW1lbnQubmV4dFNpYmxpbmcpO1xuICB9IGVsc2Uge1xuICAgIGVsZW1lbnQucGFyZW50Tm9kZS5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgfVxuXG4gIHJldHVybiB3cmFwcGVyLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xufTtcbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSBzdGFydEVsXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEBwYXJhbSB7MSB8IC0xfSBkaXJlY3Rpb25cbiAqIEByZXR1cm5zIHtFbGVtZW50IHwgdW5kZWZpbmVkfVxuICovXG5cbnZhciBnZXRBZGphY2VudEVsID0gZnVuY3Rpb24gZ2V0QWRqYWNlbnRFbChzdGFydEVsLCBzZWxlY3RvciwgZGlyZWN0aW9uKSB7XG4gIGlmIChkaXJlY3Rpb24gPT09IHZvaWQgMCkge1xuICAgIGRpcmVjdGlvbiA9IDE7XG4gIH1cblxuICBpZiAoIShzdGFydEVsIGluc3RhbmNlb2YgRWxlbWVudCkgfHwgdHlwZW9mIHNlbGVjdG9yICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICB2YXIgcHJvcCA9IChkaXJlY3Rpb24gPiAwID8gJ25leHQnIDogJ3ByZXZpb3VzJykgKyBcIkVsZW1lbnRTaWJsaW5nXCI7XG4gIHZhciBzaWJsaW5nID0gc3RhcnRFbFtwcm9wXTtcblxuICB3aGlsZSAoc2libGluZykge1xuICAgIGlmIChzaWJsaW5nLm1hdGNoZXMoc2VsZWN0b3IpKSB7XG4gICAgICByZXR1cm4gc2libGluZztcbiAgICB9XG5cbiAgICBzaWJsaW5nID0gc2libGluZ1twcm9wXTtcbiAgfVxuXG4gIHJldHVybiBzaWJsaW5nO1xufTtcbi8qKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudFxuICogQHBhcmFtIHstMSB8IDF9IGRpcmVjdGlvblxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cblxudmFyIGlzU2Nyb2xsZWRJbnRvVmlldyA9IGZ1bmN0aW9uIGlzU2Nyb2xsZWRJbnRvVmlldyhlbGVtZW50LCBwYXJlbnQsIGRpcmVjdGlvbikge1xuICBpZiAoZGlyZWN0aW9uID09PSB2b2lkIDApIHtcbiAgICBkaXJlY3Rpb24gPSAxO1xuICB9XG5cbiAgaWYgKCFlbGVtZW50KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgdmFyIGlzVmlzaWJsZTtcblxuICBpZiAoZGlyZWN0aW9uID4gMCkge1xuICAgIC8vIEluIHZpZXcgZnJvbSBib3R0b21cbiAgICBpc1Zpc2libGUgPSBwYXJlbnQuc2Nyb2xsVG9wICsgcGFyZW50Lm9mZnNldEhlaWdodCA+PSBlbGVtZW50Lm9mZnNldFRvcCArIGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICB9IGVsc2Uge1xuICAgIC8vIEluIHZpZXcgZnJvbSB0b3BcbiAgICBpc1Zpc2libGUgPSBlbGVtZW50Lm9mZnNldFRvcCA+PSBwYXJlbnQuc2Nyb2xsVG9wO1xuICB9XG5cbiAgcmV0dXJuIGlzVmlzaWJsZTtcbn07XG4vKipcbiAqIEBwYXJhbSB7YW55fSB2YWx1ZVxuICogQHJldHVybnMge2FueX1cbiAqL1xuXG52YXIgc2FuaXRpc2UgPSBmdW5jdGlvbiBzYW5pdGlzZSh2YWx1ZSkge1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIHJldHVybiB2YWx1ZS5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLz4vZywgJyZydDsnKS5yZXBsYWNlKC88L2csICcmbHQ7JykucmVwbGFjZSgvXCIvZywgJyZxdW90OycpO1xufTtcbi8qKlxuICogQHJldHVybnMgeygpID0+IChzdHI6IHN0cmluZykgPT4gRWxlbWVudH1cbiAqL1xuXG52YXIgc3RyVG9FbCA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRtcEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHJldHVybiBmdW5jdGlvbiAoc3RyKSB7XG4gICAgdmFyIGNsZWFuZWRJbnB1dCA9IHN0ci50cmltKCk7XG4gICAgdG1wRWwuaW5uZXJIVE1MID0gY2xlYW5lZElucHV0O1xuICAgIHZhciBmaXJsZENoaWxkID0gdG1wRWwuY2hpbGRyZW5bMF07XG5cbiAgICB3aGlsZSAodG1wRWwuZmlyc3RDaGlsZCkge1xuICAgICAgdG1wRWwucmVtb3ZlQ2hpbGQodG1wRWwuZmlyc3RDaGlsZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpcmxkQ2hpbGQ7XG4gIH07XG59KCk7XG4vKipcbiAqIEBwYXJhbSB7eyBsYWJlbD86IHN0cmluZywgdmFsdWU6IHN0cmluZyB9fSBhXG4gKiBAcGFyYW0ge3sgbGFiZWw/OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfX0gYlxuICogQHJldHVybnMge251bWJlcn1cbiAqL1xuXG52YXIgc29ydEJ5QWxwaGEgPSBmdW5jdGlvbiBzb3J0QnlBbHBoYShfcmVmLCBfcmVmMikge1xuICB2YXIgdmFsdWUgPSBfcmVmLnZhbHVlLFxuICAgICAgX3JlZiRsYWJlbCA9IF9yZWYubGFiZWwsXG4gICAgICBsYWJlbCA9IF9yZWYkbGFiZWwgPT09IHZvaWQgMCA/IHZhbHVlIDogX3JlZiRsYWJlbDtcbiAgdmFyIHZhbHVlMiA9IF9yZWYyLnZhbHVlLFxuICAgICAgX3JlZjIkbGFiZWwgPSBfcmVmMi5sYWJlbCxcbiAgICAgIGxhYmVsMiA9IF9yZWYyJGxhYmVsID09PSB2b2lkIDAgPyB2YWx1ZTIgOiBfcmVmMiRsYWJlbDtcbiAgcmV0dXJuIGxhYmVsLmxvY2FsZUNvbXBhcmUobGFiZWwyLCBbXSwge1xuICAgIHNlbnNpdGl2aXR5OiAnYmFzZScsXG4gICAgaWdub3JlUHVuY3R1YXRpb246IHRydWUsXG4gICAgbnVtZXJpYzogdHJ1ZVxuICB9KTtcbn07XG4vKipcbiAqIEBwYXJhbSB7eyBzY29yZTogbnVtYmVyIH19IGFcbiAqIEBwYXJhbSB7eyBzY29yZTogbnVtYmVyIH19IGJcbiAqL1xuXG52YXIgc29ydEJ5U2NvcmUgPSBmdW5jdGlvbiBzb3J0QnlTY29yZShhLCBiKSB7XG4gIHJldHVybiBhLnNjb3JlIC0gYi5zY29yZTtcbn07XG4vKipcbiAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlXG4gKiBAcGFyYW0ge29iamVjdH0gY3VzdG9tQXJnc1xuICovXG5cbnZhciBkaXNwYXRjaEV2ZW50ID0gZnVuY3Rpb24gZGlzcGF0Y2hFdmVudChlbGVtZW50LCB0eXBlLCBjdXN0b21BcmdzKSB7XG4gIGlmIChjdXN0b21BcmdzID09PSB2b2lkIDApIHtcbiAgICBjdXN0b21BcmdzID0gbnVsbDtcbiAgfVxuXG4gIHZhciBldmVudCA9IG5ldyBDdXN0b21FdmVudCh0eXBlLCB7XG4gICAgZGV0YWlsOiBjdXN0b21BcmdzLFxuICAgIGJ1YmJsZXM6IHRydWUsXG4gICAgY2FuY2VsYWJsZTogdHJ1ZVxuICB9KTtcbiAgcmV0dXJuIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG59O1xuLyoqXG4gKiBAcGFyYW0ge2FycmF5fSBhcnJheVxuICogQHBhcmFtIHthbnl9IHZhbHVlXG4gKiBAcGFyYW0ge3N0cmluZ30gW2tleT1cInZhbHVlXCJdXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAqL1xuXG52YXIgZXhpc3RzSW5BcnJheSA9IGZ1bmN0aW9uIGV4aXN0c0luQXJyYXkoYXJyYXksIHZhbHVlLCBrZXkpIHtcbiAgaWYgKGtleSA9PT0gdm9pZCAwKSB7XG4gICAga2V5ID0gJ3ZhbHVlJztcbiAgfVxuXG4gIHJldHVybiBhcnJheS5zb21lKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJldHVybiBpdGVtW2tleV0gPT09IHZhbHVlLnRyaW0oKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaXRlbVtrZXldID09PSB2YWx1ZTtcbiAgfSk7XG59O1xuLyoqXG4gKiBAcGFyYW0ge2FueX0gb2JqXG4gKiBAcmV0dXJucyB7YW55fVxuICovXG5cbnZhciBjbG9uZU9iamVjdCA9IGZ1bmN0aW9uIGNsb25lT2JqZWN0KG9iaikge1xuICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvYmopKTtcbn07XG4vKipcbiAqIFJldHVybnMgYW4gYXJyYXkgb2Yga2V5cyBwcmVzZW50IG9uIHRoZSBmaXJzdCBidXQgbWlzc2luZyBvbiB0aGUgc2Vjb25kIG9iamVjdFxuICogQHBhcmFtIHtvYmplY3R9IGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBiXG4gKiBAcmV0dXJucyB7c3RyaW5nW119XG4gKi9cblxudmFyIGRpZmYgPSBmdW5jdGlvbiBkaWZmKGEsIGIpIHtcbiAgdmFyIGFLZXlzID0gT2JqZWN0LmtleXMoYSkuc29ydCgpO1xuICB2YXIgYktleXMgPSBPYmplY3Qua2V5cyhiKS5zb3J0KCk7XG4gIHJldHVybiBhS2V5cy5maWx0ZXIoZnVuY3Rpb24gKGkpIHtcbiAgICByZXR1cm4gYktleXMuaW5kZXhPZihpKSA8IDA7XG4gIH0pO1xufTtcbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvcmVkdWNlcnMvaW5kZXguanNcblxuXG5cblxuXG5cbnZhciBhcHBSZWR1Y2VyID0gY29tYmluZVJlZHVjZXJzKHtcbiAgaXRlbXM6IGl0ZW1zX2l0ZW1zLFxuICBncm91cHM6IGdyb3VwcyxcbiAgY2hvaWNlczogY2hvaWNlc19jaG9pY2VzLFxuICBnZW5lcmFsOiByZWR1Y2Vyc19nZW5lcmFsXG59KTtcblxudmFyIHJlZHVjZXJzX3Jvb3RSZWR1Y2VyID0gZnVuY3Rpb24gcm9vdFJlZHVjZXIocGFzc2VkU3RhdGUsIGFjdGlvbikge1xuICB2YXIgc3RhdGUgPSBwYXNzZWRTdGF0ZTsgLy8gSWYgd2UgYXJlIGNsZWFyaW5nIGFsbCBpdGVtcywgZ3JvdXBzIGFuZCBvcHRpb25zIHdlIHJlYXNzaWduXG4gIC8vIHN0YXRlIGFuZCB0aGVuIHBhc3MgdGhhdCBzdGF0ZSB0byBvdXIgcHJvcGVyIHJlZHVjZXIuIFRoaXMgaXNuJ3RcbiAgLy8gbXV0YXRpbmcgb3VyIGFjdHVhbCBzdGF0ZVxuICAvLyBTZWU6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM1NjQxOTkyXG5cbiAgaWYgKGFjdGlvbi50eXBlID09PSAnQ0xFQVJfQUxMJykge1xuICAgIHN0YXRlID0gdW5kZWZpbmVkO1xuICB9IGVsc2UgaWYgKGFjdGlvbi50eXBlID09PSAnUkVTRVRfVE8nKSB7XG4gICAgcmV0dXJuIGNsb25lT2JqZWN0KGFjdGlvbi5zdGF0ZSk7XG4gIH1cblxuICByZXR1cm4gYXBwUmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbn07XG5cbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gdmFyIHJlZHVjZXJzID0gKHJlZHVjZXJzX3Jvb3RSZWR1Y2VyKTtcbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvc3RvcmUvc3RvcmUuanNcbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuXG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkNob2ljZX0gQ2hvaWNlXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuR3JvdXB9IEdyb3VwXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuSXRlbX0gSXRlbVxuICovXG5cbnZhciBzdG9yZV9TdG9yZSA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFN0b3JlKCkge1xuICAgIHRoaXMuX3N0b3JlID0gY3JlYXRlU3RvcmUocmVkdWNlcnMsIHdpbmRvdy5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fICYmIHdpbmRvdy5fX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9fKCkpO1xuICB9XG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgc3RvcmUgdG8gZnVuY3Rpb24gY2FsbCAod3JhcHBlZCBSZWR1eCBtZXRob2QpXG4gICAqIEBwYXJhbSAge0Z1bmN0aW9ufSBvbkNoYW5nZSBGdW5jdGlvbiB0byB0cmlnZ2VyIHdoZW4gc3RhdGUgY2hhbmdlc1xuICAgKiBAcmV0dXJuXG4gICAqL1xuXG5cbiAgdmFyIF9wcm90byA9IFN0b3JlLnByb3RvdHlwZTtcblxuICBfcHJvdG8uc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKG9uQ2hhbmdlKSB7XG4gICAgdGhpcy5fc3RvcmUuc3Vic2NyaWJlKG9uQ2hhbmdlKTtcbiAgfVxuICAvKipcbiAgICogRGlzcGF0Y2ggZXZlbnQgdG8gc3RvcmUgKHdyYXBwZWQgUmVkdXggbWV0aG9kKVxuICAgKiBAcGFyYW0gIHt7IHR5cGU6IHN0cmluZywgW3g6IHN0cmluZ106IGFueSB9fSBhY3Rpb24gQWN0aW9uIHRvIHRyaWdnZXJcbiAgICogQHJldHVyblxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5kaXNwYXRjaCA9IGZ1bmN0aW9uIGRpc3BhdGNoKGFjdGlvbikge1xuICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKGFjdGlvbik7XG4gIH1cbiAgLyoqXG4gICAqIEdldCBzdG9yZSBvYmplY3QgKHdyYXBwaW5nIFJlZHV4IG1ldGhvZClcbiAgICogQHJldHVybnMge29iamVjdH0gU3RhdGVcbiAgICovXG4gIDtcblxuICAvKipcbiAgICogR2V0IGxvYWRpbmcgc3RhdGUgZnJvbSBzdG9yZVxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gTG9hZGluZyBTdGF0ZVxuICAgKi9cbiAgX3Byb3RvLmlzTG9hZGluZyA9IGZ1bmN0aW9uIGlzTG9hZGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5nZW5lcmFsLmxvYWRpbmc7XG4gIH1cbiAgLyoqXG4gICAqIEdldCBzaW5nbGUgY2hvaWNlIGJ5IGl0J3MgSURcbiAgICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gICAqIEByZXR1cm5zIHtDaG9pY2UgfCB1bmRlZmluZWR9IEZvdW5kIGNob2ljZVxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5nZXRDaG9pY2VCeUlkID0gZnVuY3Rpb24gZ2V0Q2hvaWNlQnlJZChpZCkge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZUNob2ljZXMuZmluZChmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICByZXR1cm4gY2hvaWNlLmlkID09PSBwYXJzZUludChpZCwgMTApO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHZXQgZ3JvdXAgYnkgZ3JvdXAgaWRcbiAgICogQHBhcmFtICB7bnVtYmVyfSBpZCBHcm91cCBJRFxuICAgKiBAcmV0dXJucyB7R3JvdXAgfCB1bmRlZmluZWR9IEdyb3VwIGRhdGFcbiAgICovXG4gIDtcblxuICBfcHJvdG8uZ2V0R3JvdXBCeUlkID0gZnVuY3Rpb24gZ2V0R3JvdXBCeUlkKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZ3JvdXBzLmZpbmQoZnVuY3Rpb24gKGdyb3VwKSB7XG4gICAgICByZXR1cm4gZ3JvdXAuaWQgPT09IGlkO1xuICAgIH0pO1xuICB9O1xuXG4gIF9jcmVhdGVDbGFzcyhTdG9yZSwgW3tcbiAgICBrZXk6IFwic3RhdGVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdG9yZS5nZXRTdGF0ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgaXRlbXMgZnJvbSBzdG9yZVxuICAgICAqIEByZXR1cm5zIHtJdGVtW119IEl0ZW0gb2JqZWN0c1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiaXRlbXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLml0ZW1zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgYWN0aXZlIGl0ZW1zIGZyb20gc3RvcmVcbiAgICAgKiBAcmV0dXJucyB7SXRlbVtdfSBJdGVtIG9iamVjdHNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImFjdGl2ZUl0ZW1zXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYWN0aXZlID09PSB0cnVlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBoaWdobGlnaHRlZCBpdGVtcyBmcm9tIHN0b3JlXG4gICAgICogQHJldHVybnMge0l0ZW1bXX0gSXRlbSBvYmplY3RzXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJoaWdobGlnaHRlZEFjdGl2ZUl0ZW1zXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5pdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYWN0aXZlICYmIGl0ZW0uaGlnaGxpZ2h0ZWQ7XG4gICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGNob2ljZXMgZnJvbSBzdG9yZVxuICAgICAqIEByZXR1cm5zIHtDaG9pY2VbXX0gT3B0aW9uIG9iamVjdHNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcImNob2ljZXNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLmNob2ljZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhY3RpdmUgY2hvaWNlcyBmcm9tIHN0b3JlXG4gICAgICogQHJldHVybnMge0Nob2ljZVtdfSBPcHRpb24gb2JqZWN0c1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiYWN0aXZlQ2hvaWNlc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hvaWNlcy5maWx0ZXIoZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgICByZXR1cm4gY2hvaWNlLmFjdGl2ZSA9PT0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgc2VsZWN0YWJsZSBjaG9pY2VzIGZyb20gc3RvcmVcbiAgICAgKiBAcmV0dXJucyB7Q2hvaWNlW119IE9wdGlvbiBvYmplY3RzXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJzZWxlY3RhYmxlQ2hvaWNlc1wiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hvaWNlcy5maWx0ZXIoZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgICByZXR1cm4gY2hvaWNlLmRpc2FibGVkICE9PSB0cnVlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBjaG9pY2VzIHRoYXQgY2FuIGJlIHNlYXJjaGVkIChleGNsdWRpbmcgcGxhY2Vob2xkZXJzKVxuICAgICAqIEByZXR1cm5zIHtDaG9pY2VbXX0gT3B0aW9uIG9iamVjdHNcbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInNlYXJjaGFibGVDaG9pY2VzXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zZWxlY3RhYmxlQ2hvaWNlcy5maWx0ZXIoZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgICByZXR1cm4gY2hvaWNlLnBsYWNlaG9sZGVyICE9PSB0cnVlO1xuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBwbGFjZWhvbGRlciBjaG9pY2UgZnJvbSBzdG9yZVxuICAgICAqIEByZXR1cm5zIHtDaG9pY2UgfCB1bmRlZmluZWR9IEZvdW5kIHBsYWNlaG9sZGVyXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJwbGFjZWhvbGRlckNob2ljZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIFtdLmNvbmNhdCh0aGlzLmNob2ljZXMpLnJldmVyc2UoKS5maW5kKGZ1bmN0aW9uIChjaG9pY2UpIHtcbiAgICAgICAgcmV0dXJuIGNob2ljZS5wbGFjZWhvbGRlciA9PT0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgZ3JvdXBzIGZyb20gc3RvcmVcbiAgICAgKiBAcmV0dXJucyB7R3JvdXBbXX0gR3JvdXAgb2JqZWN0c1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiZ3JvdXBzXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGF0ZS5ncm91cHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCBhY3RpdmUgZ3JvdXBzIGZyb20gc3RvcmVcbiAgICAgKiBAcmV0dXJucyB7R3JvdXBbXX0gR3JvdXAgb2JqZWN0c1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwiYWN0aXZlR3JvdXBzXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICB2YXIgZ3JvdXBzID0gdGhpcy5ncm91cHMsXG4gICAgICAgICAgY2hvaWNlcyA9IHRoaXMuY2hvaWNlcztcbiAgICAgIHJldHVybiBncm91cHMuZmlsdGVyKGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgICB2YXIgaXNBY3RpdmUgPSBncm91cC5hY3RpdmUgPT09IHRydWUgJiYgZ3JvdXAuZGlzYWJsZWQgPT09IGZhbHNlO1xuICAgICAgICB2YXIgaGFzQWN0aXZlT3B0aW9ucyA9IGNob2ljZXMuc29tZShmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgICAgcmV0dXJuIGNob2ljZS5hY3RpdmUgPT09IHRydWUgJiYgY2hvaWNlLmRpc2FibGVkID09PSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBpc0FjdGl2ZSAmJiBoYXNBY3RpdmVPcHRpb25zO1xuICAgICAgfSwgW10pO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBTdG9yZTtcbn0oKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvZHJvcGRvd24uanNcbmZ1bmN0aW9uIGRyb3Bkb3duX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfVxuXG5mdW5jdGlvbiBkcm9wZG93bl9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRyb3Bkb3duX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkcm9wZG93bl9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfVxuXG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5wYXNzZWRFbGVtZW50fSBwYXNzZWRFbGVtZW50XG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuQ2xhc3NOYW1lc30gQ2xhc3NOYW1lc1xuICovXG52YXIgRHJvcGRvd24gPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKCkge1xuICAvKipcbiAgICogQHBhcmFtIHt7XG4gICAqICBlbGVtZW50OiBIVE1MRWxlbWVudCxcbiAgICogIHR5cGU6IHBhc3NlZEVsZW1lbnRbJ3R5cGUnXSxcbiAgICogIGNsYXNzTmFtZXM6IENsYXNzTmFtZXMsXG4gICAqIH19IGFyZ3NcbiAgICovXG4gIGZ1bmN0aW9uIERyb3Bkb3duKF9yZWYpIHtcbiAgICB2YXIgZWxlbWVudCA9IF9yZWYuZWxlbWVudCxcbiAgICAgICAgdHlwZSA9IF9yZWYudHlwZSxcbiAgICAgICAgY2xhc3NOYW1lcyA9IF9yZWYuY2xhc3NOYW1lcztcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuY2xhc3NOYW1lcyA9IGNsYXNzTmFtZXM7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7XG4gIH1cbiAgLyoqXG4gICAqIEJvdHRvbSBwb3NpdGlvbiBvZiBkcm9wZG93biBpbiB2aWV3cG9ydCBjb29yZGluYXRlc1xuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBWZXJ0aWNhbCBwb3NpdGlvblxuICAgKi9cblxuXG4gIHZhciBfcHJvdG8gPSBEcm9wZG93bi5wcm90b3R5cGU7XG5cbiAgLyoqXG4gICAqIEZpbmQgZWxlbWVudCB0aGF0IG1hdGNoZXMgcGFzc2VkIHNlbGVjdG9yXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxuICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnQgfCBudWxsfVxuICAgKi9cbiAgX3Byb3RvLmdldENoaWxkID0gZnVuY3Rpb24gZ2V0Q2hpbGQoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuICB9XG4gIC8qKlxuICAgKiBTaG93IGRyb3Bkb3duIHRvIHVzZXIgYnkgYWRkaW5nIGFjdGl2ZSBzdGF0ZSBjbGFzc1xuICAgKiBAcmV0dXJucyB7dGhpc31cbiAgICovXG4gIDtcblxuICBfcHJvdG8uc2hvdyA9IGZ1bmN0aW9uIHNob3coKSB7XG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jbGFzc05hbWVzLmFjdGl2ZVN0YXRlKTtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogSGlkZSBkcm9wZG93biBmcm9tIHVzZXJcbiAgICogQHJldHVybnMge3RoaXN9XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmhpZGUgPSBmdW5jdGlvbiBoaWRlKCkge1xuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY2xhc3NOYW1lcy5hY3RpdmVTdGF0ZSk7XG4gICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBkcm9wZG93bl9jcmVhdGVDbGFzcyhEcm9wZG93biwgW3tcbiAgICBrZXk6IFwiZGlzdGFuY2VGcm9tVG9wV2luZG93XCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gRHJvcGRvd247XG59KCk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9jb25zdGFudHMuanNcblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuQ2xhc3NOYW1lc30gQ2xhc3NOYW1lc1xuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLk9wdGlvbnN9IE9wdGlvbnNcbiAqL1xuXG4vKiogQHR5cGUge0NsYXNzTmFtZXN9ICovXG5cbnZhciBERUZBVUxUX0NMQVNTTkFNRVMgPSB7XG4gIGNvbnRhaW5lck91dGVyOiAnY2hvaWNlcycsXG4gIGNvbnRhaW5lcklubmVyOiAnY2hvaWNlc19faW5uZXInLFxuICBpbnB1dDogJ2Nob2ljZXNfX2lucHV0JyxcbiAgaW5wdXRDbG9uZWQ6ICdjaG9pY2VzX19pbnB1dC0tY2xvbmVkJyxcbiAgbGlzdDogJ2Nob2ljZXNfX2xpc3QnLFxuICBsaXN0SXRlbXM6ICdjaG9pY2VzX19saXN0LS1tdWx0aXBsZScsXG4gIGxpc3RTaW5nbGU6ICdjaG9pY2VzX19saXN0LS1zaW5nbGUnLFxuICBsaXN0RHJvcGRvd246ICdjaG9pY2VzX19saXN0LS1kcm9wZG93bicsXG4gIGl0ZW06ICdjaG9pY2VzX19pdGVtJyxcbiAgaXRlbVNlbGVjdGFibGU6ICdjaG9pY2VzX19pdGVtLS1zZWxlY3RhYmxlJyxcbiAgaXRlbURpc2FibGVkOiAnY2hvaWNlc19faXRlbS0tZGlzYWJsZWQnLFxuICBpdGVtQ2hvaWNlOiAnY2hvaWNlc19faXRlbS0tY2hvaWNlJyxcbiAgcGxhY2Vob2xkZXI6ICdjaG9pY2VzX19wbGFjZWhvbGRlcicsXG4gIGdyb3VwOiAnY2hvaWNlc19fZ3JvdXAnLFxuICBncm91cEhlYWRpbmc6ICdjaG9pY2VzX19oZWFkaW5nJyxcbiAgYnV0dG9uOiAnY2hvaWNlc19fYnV0dG9uJyxcbiAgYWN0aXZlU3RhdGU6ICdpcy1hY3RpdmUnLFxuICBmb2N1c1N0YXRlOiAnaXMtZm9jdXNlZCcsXG4gIG9wZW5TdGF0ZTogJ2lzLW9wZW4nLFxuICBkaXNhYmxlZFN0YXRlOiAnaXMtZGlzYWJsZWQnLFxuICBoaWdobGlnaHRlZFN0YXRlOiAnaXMtaGlnaGxpZ2h0ZWQnLFxuICBzZWxlY3RlZFN0YXRlOiAnaXMtc2VsZWN0ZWQnLFxuICBmbGlwcGVkU3RhdGU6ICdpcy1mbGlwcGVkJyxcbiAgbG9hZGluZ1N0YXRlOiAnaXMtbG9hZGluZycsXG4gIG5vUmVzdWx0czogJ2hhcy1uby1yZXN1bHRzJyxcbiAgbm9DaG9pY2VzOiAnaGFzLW5vLWNob2ljZXMnXG59O1xuLyoqIEB0eXBlIHtPcHRpb25zfSAqL1xuXG52YXIgREVGQVVMVF9DT05GSUcgPSB7XG4gIGl0ZW1zOiBbXSxcbiAgY2hvaWNlczogW10sXG4gIHNpbGVudDogZmFsc2UsXG4gIHJlbmRlckNob2ljZUxpbWl0OiAtMSxcbiAgbWF4SXRlbUNvdW50OiAtMSxcbiAgYWRkSXRlbXM6IHRydWUsXG4gIGFkZEl0ZW1GaWx0ZXI6IG51bGwsXG4gIHJlbW92ZUl0ZW1zOiB0cnVlLFxuICByZW1vdmVJdGVtQnV0dG9uOiBmYWxzZSxcbiAgZWRpdEl0ZW1zOiBmYWxzZSxcbiAgZHVwbGljYXRlSXRlbXNBbGxvd2VkOiB0cnVlLFxuICBkZWxpbWl0ZXI6ICcsJyxcbiAgcGFzdGU6IHRydWUsXG4gIHNlYXJjaEVuYWJsZWQ6IHRydWUsXG4gIHNlYXJjaENob2ljZXM6IHRydWUsXG4gIHNlYXJjaEZsb29yOiAxLFxuICBzZWFyY2hSZXN1bHRMaW1pdDogNCxcbiAgc2VhcmNoRmllbGRzOiBbJ2xhYmVsJywgJ3ZhbHVlJ10sXG4gIHBvc2l0aW9uOiAnYXV0bycsXG4gIHJlc2V0U2Nyb2xsUG9zaXRpb246IHRydWUsXG4gIHNob3VsZFNvcnQ6IHRydWUsXG4gIHNob3VsZFNvcnRJdGVtczogZmFsc2UsXG4gIHNvcnRlcjogc29ydEJ5QWxwaGEsXG4gIHBsYWNlaG9sZGVyOiB0cnVlLFxuICBwbGFjZWhvbGRlclZhbHVlOiBudWxsLFxuICBzZWFyY2hQbGFjZWhvbGRlclZhbHVlOiBudWxsLFxuICBwcmVwZW5kVmFsdWU6IG51bGwsXG4gIGFwcGVuZFZhbHVlOiBudWxsLFxuICByZW5kZXJTZWxlY3RlZENob2ljZXM6ICdhdXRvJyxcbiAgbG9hZGluZ1RleHQ6ICdMb2FkaW5nLi4uJyxcbiAgbm9SZXN1bHRzVGV4dDogJ05vIHJlc3VsdHMgZm91bmQnLFxuICBub0Nob2ljZXNUZXh0OiAnTm8gY2hvaWNlcyB0byBjaG9vc2UgZnJvbScsXG4gIGl0ZW1TZWxlY3RUZXh0OiAnUHJlc3MgdG8gc2VsZWN0JyxcbiAgdW5pcXVlSXRlbVRleHQ6ICdPbmx5IHVuaXF1ZSB2YWx1ZXMgY2FuIGJlIGFkZGVkJyxcbiAgY3VzdG9tQWRkSXRlbVRleHQ6ICdPbmx5IHZhbHVlcyBtYXRjaGluZyBzcGVjaWZpYyBjb25kaXRpb25zIGNhbiBiZSBhZGRlZCcsXG4gIGFkZEl0ZW1UZXh0OiBmdW5jdGlvbiBhZGRJdGVtVGV4dCh2YWx1ZSkge1xuICAgIHJldHVybiBcIlByZXNzIEVudGVyIHRvIGFkZCA8Yj5cXFwiXCIgKyBzYW5pdGlzZSh2YWx1ZSkgKyBcIlxcXCI8L2I+XCI7XG4gIH0sXG4gIG1heEl0ZW1UZXh0OiBmdW5jdGlvbiBtYXhJdGVtVGV4dChtYXhJdGVtQ291bnQpIHtcbiAgICByZXR1cm4gXCJPbmx5IFwiICsgbWF4SXRlbUNvdW50ICsgXCIgdmFsdWVzIGNhbiBiZSBhZGRlZFwiO1xuICB9LFxuICB2YWx1ZUNvbXBhcmVyOiBmdW5jdGlvbiB2YWx1ZUNvbXBhcmVyKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuIHZhbHVlMSA9PT0gdmFsdWUyO1xuICB9LFxuICBmdXNlT3B0aW9uczoge1xuICAgIGluY2x1ZGVTY29yZTogdHJ1ZVxuICB9LFxuICBjYWxsYmFja09uSW5pdDogbnVsbCxcbiAgY2FsbGJhY2tPbkNyZWF0ZVRlbXBsYXRlczogbnVsbCxcbiAgY2xhc3NOYW1lczogREVGQVVMVF9DTEFTU05BTUVTXG59O1xudmFyIEVWRU5UUyA9IHtcbiAgc2hvd0Ryb3Bkb3duOiAnc2hvd0Ryb3Bkb3duJyxcbiAgaGlkZURyb3Bkb3duOiAnaGlkZURyb3Bkb3duJyxcbiAgY2hhbmdlOiAnY2hhbmdlJyxcbiAgY2hvaWNlOiAnY2hvaWNlJyxcbiAgc2VhcmNoOiAnc2VhcmNoJyxcbiAgYWRkSXRlbTogJ2FkZEl0ZW0nLFxuICByZW1vdmVJdGVtOiAncmVtb3ZlSXRlbScsXG4gIGhpZ2hsaWdodEl0ZW06ICdoaWdobGlnaHRJdGVtJyxcbiAgaGlnaGxpZ2h0Q2hvaWNlOiAnaGlnaGxpZ2h0Q2hvaWNlJ1xufTtcbnZhciBBQ1RJT05fVFlQRVMgPSB7XG4gIEFERF9DSE9JQ0U6ICdBRERfQ0hPSUNFJyxcbiAgRklMVEVSX0NIT0lDRVM6ICdGSUxURVJfQ0hPSUNFUycsXG4gIEFDVElWQVRFX0NIT0lDRVM6ICdBQ1RJVkFURV9DSE9JQ0VTJyxcbiAgQ0xFQVJfQ0hPSUNFUzogJ0NMRUFSX0NIT0lDRVMnLFxuICBBRERfR1JPVVA6ICdBRERfR1JPVVAnLFxuICBBRERfSVRFTTogJ0FERF9JVEVNJyxcbiAgUkVNT1ZFX0lURU06ICdSRU1PVkVfSVRFTScsXG4gIEhJR0hMSUdIVF9JVEVNOiAnSElHSExJR0hUX0lURU0nLFxuICBDTEVBUl9BTEw6ICdDTEVBUl9BTEwnXG59O1xudmFyIEtFWV9DT0RFUyA9IHtcbiAgQkFDS19LRVk6IDQ2LFxuICBERUxFVEVfS0VZOiA4LFxuICBFTlRFUl9LRVk6IDEzLFxuICBBX0tFWTogNjUsXG4gIEVTQ19LRVk6IDI3LFxuICBVUF9LRVk6IDM4LFxuICBET1dOX0tFWTogNDAsXG4gIFBBR0VfVVBfS0VZOiAzMyxcbiAgUEFHRV9ET1dOX0tFWTogMzRcbn07XG52YXIgVEVYVF9UWVBFID0gJ3RleHQnO1xudmFyIFNFTEVDVF9PTkVfVFlQRSA9ICdzZWxlY3Qtb25lJztcbnZhciBTRUxFQ1RfTVVMVElQTEVfVFlQRSA9ICdzZWxlY3QtbXVsdGlwbGUnO1xudmFyIFNDUk9MTElOR19TUEVFRCA9IDQ7XG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvY29udGFpbmVyLmpzXG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMucGFzc2VkRWxlbWVudH0gcGFzc2VkRWxlbWVudFxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkNsYXNzTmFtZXN9IENsYXNzTmFtZXNcbiAqL1xuXG52YXIgY29udGFpbmVyX0NvbnRhaW5lciA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3tcbiAgICogIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgKiAgdHlwZTogcGFzc2VkRWxlbWVudFsndHlwZSddLFxuICAgKiAgY2xhc3NOYW1lczogQ2xhc3NOYW1lcyxcbiAgICogIHBvc2l0aW9uXG4gICAqIH19IGFyZ3NcbiAgICovXG4gIGZ1bmN0aW9uIENvbnRhaW5lcihfcmVmKSB7XG4gICAgdmFyIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQsXG4gICAgICAgIHR5cGUgPSBfcmVmLnR5cGUsXG4gICAgICAgIGNsYXNzTmFtZXMgPSBfcmVmLmNsYXNzTmFtZXMsXG4gICAgICAgIHBvc2l0aW9uID0gX3JlZi5wb3NpdGlvbjtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuY2xhc3NOYW1lcyA9IGNsYXNzTmFtZXM7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgdGhpcy5pc09wZW4gPSBmYWxzZTtcbiAgICB0aGlzLmlzRmxpcHBlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNGb2N1c3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNEaXNhYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgdGhpcy5fb25Gb2N1cyA9IHRoaXMuX29uRm9jdXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkJsdXIgPSB0aGlzLl9vbkJsdXIuYmluZCh0aGlzKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBDb250YWluZXIucHJvdG90eXBlO1xuXG4gIF9wcm90by5hZGRFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXMpO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyKTtcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiByZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbkZvY3VzKTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1cik7XG4gIH1cbiAgLyoqXG4gICAqIERldGVybWluZSB3aGV0aGVyIGNvbnRhaW5lciBzaG91bGQgYmUgZmxpcHBlZCBiYXNlZCBvbiBwYXNzZWRcbiAgICogZHJvcGRvd24gcG9zaXRpb25cbiAgICogQHBhcmFtIHtudW1iZXJ9IGRyb3Bkb3duUG9zXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5zaG91bGRGbGlwID0gZnVuY3Rpb24gc2hvdWxkRmxpcChkcm9wZG93blBvcykge1xuICAgIGlmICh0eXBlb2YgZHJvcGRvd25Qb3MgIT09ICdudW1iZXInKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSAvLyBJZiBmbGlwIGlzIGVuYWJsZWQgYW5kIHRoZSBkcm9wZG93biBib3R0b20gcG9zaXRpb24gaXNcbiAgICAvLyBncmVhdGVyIHRoYW4gdGhlIHdpbmRvdyBoZWlnaHQgZmxpcCB0aGUgZHJvcGRvd24uXG5cblxuICAgIHZhciBzaG91bGRGbGlwID0gZmFsc2U7XG5cbiAgICBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ2F1dG8nKSB7XG4gICAgICBzaG91bGRGbGlwID0gIXdpbmRvdy5tYXRjaE1lZGlhKFwiKG1pbi1oZWlnaHQ6IFwiICsgKGRyb3Bkb3duUG9zICsgMSkgKyBcInB4KVwiKS5tYXRjaGVzO1xuICAgIH0gZWxzZSBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ3RvcCcpIHtcbiAgICAgIHNob3VsZEZsaXAgPSB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBzaG91bGRGbGlwO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aXZlRGVzY2VuZGFudElEXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLnNldEFjdGl2ZURlc2NlbmRhbnQgPSBmdW5jdGlvbiBzZXRBY3RpdmVEZXNjZW5kYW50KGFjdGl2ZURlc2NlbmRhbnRJRCkge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIGFjdGl2ZURlc2NlbmRhbnRJRCk7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZUFjdGl2ZURlc2NlbmRhbnQgPSBmdW5jdGlvbiByZW1vdmVBY3RpdmVEZXNjZW5kYW50KCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gZHJvcGRvd25Qb3NcbiAgICovXG4gIDtcblxuICBfcHJvdG8ub3BlbiA9IGZ1bmN0aW9uIG9wZW4oZHJvcGRvd25Qb3MpIHtcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmNsYXNzTmFtZXMub3BlblN0YXRlKTtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ3RydWUnKTtcbiAgICB0aGlzLmlzT3BlbiA9IHRydWU7XG5cbiAgICBpZiAodGhpcy5zaG91bGRGbGlwKGRyb3Bkb3duUG9zKSkge1xuICAgICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jbGFzc05hbWVzLmZsaXBwZWRTdGF0ZSk7XG4gICAgICB0aGlzLmlzRmxpcHBlZCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5jbG9zZSA9IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY2xhc3NOYW1lcy5vcGVuU3RhdGUpO1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICB0aGlzLnJlbW92ZUFjdGl2ZURlc2NlbmRhbnQoKTtcbiAgICB0aGlzLmlzT3BlbiA9IGZhbHNlOyAvLyBBIGRyb3Bkb3duIGZsaXBzIGlmIGl0IGRvZXMgbm90IGhhdmUgc3BhY2Ugd2l0aGluIHRoZSBwYWdlXG5cbiAgICBpZiAodGhpcy5pc0ZsaXBwZWQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY2xhc3NOYW1lcy5mbGlwcGVkU3RhdGUpO1xuICAgICAgdGhpcy5pc0ZsaXBwZWQgPSBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLmZvY3VzID0gZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgaWYgKCF0aGlzLmlzRm9jdXNzZWQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uYWRkRm9jdXNTdGF0ZSA9IGZ1bmN0aW9uIGFkZEZvY3VzU3RhdGUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jbGFzc05hbWVzLmZvY3VzU3RhdGUpO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVGb2N1c1N0YXRlID0gZnVuY3Rpb24gcmVtb3ZlRm9jdXNTdGF0ZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmNsYXNzTmFtZXMuZm9jdXNTdGF0ZSk7XG4gIH07XG5cbiAgX3Byb3RvLmVuYWJsZSA9IGZ1bmN0aW9uIGVuYWJsZSgpIHtcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmNsYXNzTmFtZXMuZGlzYWJsZWRTdGF0ZSk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1kaXNhYmxlZCcpO1xuXG4gICAgaWYgKHRoaXMudHlwZSA9PT0gU0VMRUNUX09ORV9UWVBFKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XG4gICAgfVxuXG4gICAgdGhpcy5pc0Rpc2FibGVkID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY2xhc3NOYW1lcy5kaXNhYmxlZFN0YXRlKTtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWRpc2FibGVkJywgJ3RydWUnKTtcblxuICAgIGlmICh0aGlzLnR5cGUgPT09IFNFTEVDVF9PTkVfVFlQRSkge1xuICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzRGlzYWJsZWQgPSB0cnVlO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbGVtZW50XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLndyYXAgPSBmdW5jdGlvbiB3cmFwKGVsZW1lbnQpIHtcbiAgICB1dGlsc193cmFwKGVsZW1lbnQsIHRoaXMuZWxlbWVudCk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgKi9cbiAgO1xuXG4gIF9wcm90by51bndyYXAgPSBmdW5jdGlvbiB1bndyYXAoZWxlbWVudCkge1xuICAgIC8vIE1vdmUgcGFzc2VkIGVsZW1lbnQgb3V0c2lkZSB0aGlzIGVsZW1lbnRcbiAgICB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZWxlbWVudCwgdGhpcy5lbGVtZW50KTsgLy8gUmVtb3ZlIHRoaXMgZWxlbWVudFxuXG4gICAgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcbiAgfTtcblxuICBfcHJvdG8uYWRkTG9hZGluZ1N0YXRlID0gZnVuY3Rpb24gYWRkTG9hZGluZ1N0YXRlKCkge1xuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY2xhc3NOYW1lcy5sb2FkaW5nU3RhdGUpO1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtYnVzeScsICd0cnVlJyk7XG4gICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVMb2FkaW5nU3RhdGUgPSBmdW5jdGlvbiByZW1vdmVMb2FkaW5nU3RhdGUoKSB7XG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5jbGFzc05hbWVzLmxvYWRpbmdTdGF0ZSk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1idXN5Jyk7XG4gICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgfTtcblxuICBfcHJvdG8uX29uRm9jdXMgPSBmdW5jdGlvbiBfb25Gb2N1cygpIHtcbiAgICB0aGlzLmlzRm9jdXNzZWQgPSB0cnVlO1xuICB9O1xuXG4gIF9wcm90by5fb25CbHVyID0gZnVuY3Rpb24gX29uQmx1cigpIHtcbiAgICB0aGlzLmlzRm9jdXNzZWQgPSBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4gQ29udGFpbmVyO1xufSgpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9pbnB1dC5qc1xuZnVuY3Rpb24gaW5wdXRfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIGlucHV0X2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgaW5wdXRfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGlucHV0X2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cblxuXG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5wYXNzZWRFbGVtZW50fSBwYXNzZWRFbGVtZW50XG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuQ2xhc3NOYW1lc30gQ2xhc3NOYW1lc1xuICovXG5cbnZhciBpbnB1dF9JbnB1dCA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge3tcbiAgICogIGVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAqICB0eXBlOiBwYXNzZWRFbGVtZW50Wyd0eXBlJ10sXG4gICAqICBjbGFzc05hbWVzOiBDbGFzc05hbWVzLFxuICAgKiAgcHJldmVudFBhc3RlOiBib29sZWFuXG4gICAqIH19IGFyZ3NcbiAgICovXG4gIGZ1bmN0aW9uIElucHV0KF9yZWYpIHtcbiAgICB2YXIgZWxlbWVudCA9IF9yZWYuZWxlbWVudCxcbiAgICAgICAgdHlwZSA9IF9yZWYudHlwZSxcbiAgICAgICAgY2xhc3NOYW1lcyA9IF9yZWYuY2xhc3NOYW1lcyxcbiAgICAgICAgcHJldmVudFBhc3RlID0gX3JlZi5wcmV2ZW50UGFzdGU7XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIHRoaXMuY2xhc3NOYW1lcyA9IGNsYXNzTmFtZXM7XG4gICAgdGhpcy5wcmV2ZW50UGFzdGUgPSBwcmV2ZW50UGFzdGU7XG4gICAgdGhpcy5pc0ZvY3Vzc2VkID0gdGhpcy5lbGVtZW50ID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIHRoaXMuaXNEaXNhYmxlZCA9IGVsZW1lbnQuZGlzYWJsZWQ7XG4gICAgdGhpcy5fb25QYXN0ZSA9IHRoaXMuX29uUGFzdGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbklucHV0ID0gdGhpcy5fb25JbnB1dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uRm9jdXMgPSB0aGlzLl9vbkZvY3VzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25CbHVyID0gdGhpcy5fb25CbHVyLmJpbmQodGhpcyk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwbGFjZWhvbGRlclxuICAgKi9cblxuXG4gIHZhciBfcHJvdG8gPSBJbnB1dC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Bhc3RlJywgdGhpcy5fb25QYXN0ZSk7XG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgdGhpcy5fb25JbnB1dCwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXMsIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1ciwge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdpbnB1dCcsIHRoaXMuX29uSW5wdXQsIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncGFzdGUnLCB0aGlzLl9vblBhc3RlKTtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbkZvY3VzLCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXIsIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgdGhpcy5pc0Rpc2FibGVkID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIHRoaXMuaXNEaXNhYmxlZCA9IHRydWU7XG4gIH07XG5cbiAgX3Byb3RvLmZvY3VzID0gZnVuY3Rpb24gZm9jdXMoKSB7XG4gICAgaWYgKCF0aGlzLmlzRm9jdXNzZWQpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uYmx1ciA9IGZ1bmN0aW9uIGJsdXIoKSB7XG4gICAgaWYgKHRoaXMuaXNGb2N1c3NlZCkge1xuICAgICAgdGhpcy5lbGVtZW50LmJsdXIoKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIFNldCB2YWx1ZSBvZiBpbnB1dCB0byBibGFua1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNldFdpZHRoXG4gICAqIEByZXR1cm5zIHt0aGlzfVxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKHNldFdpZHRoKSB7XG4gICAgaWYgKHNldFdpZHRoID09PSB2b2lkIDApIHtcbiAgICAgIHNldFdpZHRoID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5lbGVtZW50LnZhbHVlKSB7XG4gICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSAnJztcbiAgICB9XG5cbiAgICBpZiAoc2V0V2lkdGgpIHtcbiAgICAgIHRoaXMuc2V0V2lkdGgoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICAvKipcbiAgICogU2V0IHRoZSBjb3JyZWN0IGlucHV0IHdpZHRoIGJhc2VkIG9uIHBsYWNlaG9sZGVyXG4gICAqIHZhbHVlIG9yIGlucHV0IHZhbHVlXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLnNldFdpZHRoID0gZnVuY3Rpb24gc2V0V2lkdGgoKSB7XG4gICAgLy8gUmVzaXplIGlucHV0IHRvIGNvbnRlbnRzIG9yIHBsYWNlaG9sZGVyXG4gICAgdmFyIF90aGlzJGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgIHN0eWxlID0gX3RoaXMkZWxlbWVudC5zdHlsZSxcbiAgICAgICAgdmFsdWUgPSBfdGhpcyRlbGVtZW50LnZhbHVlLFxuICAgICAgICBwbGFjZWhvbGRlciA9IF90aGlzJGVsZW1lbnQucGxhY2Vob2xkZXI7XG4gICAgc3R5bGUubWluV2lkdGggPSBwbGFjZWhvbGRlci5sZW5ndGggKyAxICsgXCJjaFwiO1xuICAgIHN0eWxlLndpZHRoID0gdmFsdWUubGVuZ3RoICsgMSArIFwiY2hcIjtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIHtzdHJpbmd9IGFjdGl2ZURlc2NlbmRhbnRJRFxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5zZXRBY3RpdmVEZXNjZW5kYW50ID0gZnVuY3Rpb24gc2V0QWN0aXZlRGVzY2VuZGFudChhY3RpdmVEZXNjZW5kYW50SUQpIHtcbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnLCBhY3RpdmVEZXNjZW5kYW50SUQpO1xuICB9O1xuXG4gIF9wcm90by5yZW1vdmVBY3RpdmVEZXNjZW5kYW50ID0gZnVuY3Rpb24gcmVtb3ZlQWN0aXZlRGVzY2VuZGFudCgpIHtcbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnKTtcbiAgfTtcblxuICBfcHJvdG8uX29uSW5wdXQgPSBmdW5jdGlvbiBfb25JbnB1dCgpIHtcbiAgICBpZiAodGhpcy50eXBlICE9PSBTRUxFQ1RfT05FX1RZUEUpIHtcbiAgICAgIHRoaXMuc2V0V2lkdGgoKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLl9vblBhc3RlID0gZnVuY3Rpb24gX29uUGFzdGUoZXZlbnQpIHtcbiAgICBpZiAodGhpcy5wcmV2ZW50UGFzdGUpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5fb25Gb2N1cyA9IGZ1bmN0aW9uIF9vbkZvY3VzKCkge1xuICAgIHRoaXMuaXNGb2N1c3NlZCA9IHRydWU7XG4gIH07XG5cbiAgX3Byb3RvLl9vbkJsdXIgPSBmdW5jdGlvbiBfb25CbHVyKCkge1xuICAgIHRoaXMuaXNGb2N1c3NlZCA9IGZhbHNlO1xuICB9O1xuXG4gIGlucHV0X2NyZWF0ZUNsYXNzKElucHV0LCBbe1xuICAgIGtleTogXCJwbGFjZWhvbGRlclwiLFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHBsYWNlaG9sZGVyKSB7XG4gICAgICB0aGlzLmVsZW1lbnQucGxhY2Vob2xkZXIgPSBwbGFjZWhvbGRlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcInZhbHVlXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gc2FuaXRpc2UodGhpcy5lbGVtZW50LnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlXG4gICAgICovXG4gICAgLFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gSW5wdXQ7XG59KCk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL2xpc3QuanNcblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuQ2hvaWNlfSBDaG9pY2VcbiAqL1xuXG52YXIgbGlzdF9MaXN0ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7eyBlbGVtZW50OiBIVE1MRWxlbWVudCB9fSBhcmdzXG4gICAqL1xuICBmdW5jdGlvbiBMaXN0KF9yZWYpIHtcbiAgICB2YXIgZWxlbWVudCA9IF9yZWYuZWxlbWVudDtcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuc2Nyb2xsUG9zID0gdGhpcy5lbGVtZW50LnNjcm9sbFRvcDtcbiAgICB0aGlzLmhlaWdodCA9IHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gTGlzdC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmNsZWFyID0gZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBEb2N1bWVudEZyYWdtZW50fSBub2RlXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmFwcGVuZCA9IGZ1bmN0aW9uIGFwcGVuZChub2RlKSB7XG4gICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKG5vZGUpO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAgICogQHJldHVybnMge0VsZW1lbnQgfCBudWxsfVxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5nZXRDaGlsZCA9IGZ1bmN0aW9uIGdldENoaWxkKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgfVxuICAvKipcbiAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLmhhc0NoaWxkcmVuID0gZnVuY3Rpb24gaGFzQ2hpbGRyZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudC5oYXNDaGlsZE5vZGVzKCk7XG4gIH07XG5cbiAgX3Byb3RvLnNjcm9sbFRvVG9wID0gZnVuY3Rpb24gc2Nyb2xsVG9Ub3AoKSB7XG4gICAgdGhpcy5lbGVtZW50LnNjcm9sbFRvcCA9IDA7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudFxuICAgKiBAcGFyYW0gezEgfCAtMX0gZGlyZWN0aW9uXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLnNjcm9sbFRvQ2hpbGRFbGVtZW50ID0gZnVuY3Rpb24gc2Nyb2xsVG9DaGlsZEVsZW1lbnQoZWxlbWVudCwgZGlyZWN0aW9uKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIGlmICghZWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBsaXN0SGVpZ2h0ID0gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDsgLy8gU2Nyb2xsIHBvc2l0aW9uIG9mIGRyb3Bkb3duXG5cbiAgICB2YXIgbGlzdFNjcm9sbFBvc2l0aW9uID0gdGhpcy5lbGVtZW50LnNjcm9sbFRvcCArIGxpc3RIZWlnaHQ7XG4gICAgdmFyIGVsZW1lbnRIZWlnaHQgPSBlbGVtZW50Lm9mZnNldEhlaWdodDsgLy8gRGlzdGFuY2UgZnJvbSBib3R0b20gb2YgZWxlbWVudCB0byB0b3Agb2YgcGFyZW50XG5cbiAgICB2YXIgZWxlbWVudFBvcyA9IGVsZW1lbnQub2Zmc2V0VG9wICsgZWxlbWVudEhlaWdodDsgLy8gRGlmZmVyZW5jZSBiZXR3ZWVuIHRoZSBlbGVtZW50IGFuZCBzY3JvbGwgcG9zaXRpb25cblxuICAgIHZhciBkZXN0aW5hdGlvbiA9IGRpcmVjdGlvbiA+IDAgPyB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wICsgZWxlbWVudFBvcyAtIGxpc3RTY3JvbGxQb3NpdGlvbiA6IGVsZW1lbnQub2Zmc2V0VG9wO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICBfdGhpcy5fYW5pbWF0ZVNjcm9sbChkZXN0aW5hdGlvbiwgZGlyZWN0aW9uKTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNjcm9sbFBvc1xuICAgKiBAcGFyYW0ge251bWJlcn0gc3RyZW5ndGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlc3RpbmF0aW9uXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLl9zY3JvbGxEb3duID0gZnVuY3Rpb24gX3Njcm9sbERvd24oc2Nyb2xsUG9zLCBzdHJlbmd0aCwgZGVzdGluYXRpb24pIHtcbiAgICB2YXIgZWFzaW5nID0gKGRlc3RpbmF0aW9uIC0gc2Nyb2xsUG9zKSAvIHN0cmVuZ3RoO1xuICAgIHZhciBkaXN0YW5jZSA9IGVhc2luZyA+IDEgPyBlYXNpbmcgOiAxO1xuICAgIHRoaXMuZWxlbWVudC5zY3JvbGxUb3AgPSBzY3JvbGxQb3MgKyBkaXN0YW5jZTtcbiAgfVxuICAvKipcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNjcm9sbFBvc1xuICAgKiBAcGFyYW0ge251bWJlcn0gc3RyZW5ndGhcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRlc3RpbmF0aW9uXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLl9zY3JvbGxVcCA9IGZ1bmN0aW9uIF9zY3JvbGxVcChzY3JvbGxQb3MsIHN0cmVuZ3RoLCBkZXN0aW5hdGlvbikge1xuICAgIHZhciBlYXNpbmcgPSAoc2Nyb2xsUG9zIC0gZGVzdGluYXRpb24pIC8gc3RyZW5ndGg7XG4gICAgdmFyIGRpc3RhbmNlID0gZWFzaW5nID4gMSA/IGVhc2luZyA6IDE7XG4gICAgdGhpcy5lbGVtZW50LnNjcm9sbFRvcCA9IHNjcm9sbFBvcyAtIGRpc3RhbmNlO1xuICB9XG4gIC8qKlxuICAgKiBAcGFyYW0geyp9IGRlc3RpbmF0aW9uXG4gICAqIEBwYXJhbSB7Kn0gZGlyZWN0aW9uXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLl9hbmltYXRlU2Nyb2xsID0gZnVuY3Rpb24gX2FuaW1hdGVTY3JvbGwoZGVzdGluYXRpb24sIGRpcmVjdGlvbikge1xuICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgdmFyIHN0cmVuZ3RoID0gU0NST0xMSU5HX1NQRUVEO1xuICAgIHZhciBjaG9pY2VMaXN0U2Nyb2xsVG9wID0gdGhpcy5lbGVtZW50LnNjcm9sbFRvcDtcbiAgICB2YXIgY29udGludWVBbmltYXRpb24gPSBmYWxzZTtcblxuICAgIGlmIChkaXJlY3Rpb24gPiAwKSB7XG4gICAgICB0aGlzLl9zY3JvbGxEb3duKGNob2ljZUxpc3RTY3JvbGxUb3AsIHN0cmVuZ3RoLCBkZXN0aW5hdGlvbik7XG5cbiAgICAgIGlmIChjaG9pY2VMaXN0U2Nyb2xsVG9wIDwgZGVzdGluYXRpb24pIHtcbiAgICAgICAgY29udGludWVBbmltYXRpb24gPSB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zY3JvbGxVcChjaG9pY2VMaXN0U2Nyb2xsVG9wLCBzdHJlbmd0aCwgZGVzdGluYXRpb24pO1xuXG4gICAgICBpZiAoY2hvaWNlTGlzdFNjcm9sbFRvcCA+IGRlc3RpbmF0aW9uKSB7XG4gICAgICAgIGNvbnRpbnVlQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoY29udGludWVBbmltYXRpb24pIHtcbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMi5fYW5pbWF0ZVNjcm9sbChkZXN0aW5hdGlvbiwgZGlyZWN0aW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gTGlzdDtcbn0oKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvd3JhcHBlZC1lbGVtZW50LmpzXG5mdW5jdGlvbiB3cmFwcGVkX2VsZW1lbnRfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9XG5cbmZ1bmN0aW9uIHdyYXBwZWRfZWxlbWVudF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIHdyYXBwZWRfZWxlbWVudF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgd3JhcHBlZF9lbGVtZW50X2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMucGFzc2VkRWxlbWVudH0gcGFzc2VkRWxlbWVudFxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkNsYXNzTmFtZXN9IENsYXNzTmFtZXNcbiAqL1xuXG52YXIgd3JhcHBlZF9lbGVtZW50X1dyYXBwZWRFbGVtZW50ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uICgpIHtcbiAgLyoqXG4gICAqIEBwYXJhbSB7e1xuICAgKiAgZWxlbWVudDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxTZWxlY3RFbGVtZW50LFxuICAgKiAgY2xhc3NOYW1lczogQ2xhc3NOYW1lcyxcbiAgICogfX0gYXJnc1xuICAgKi9cbiAgZnVuY3Rpb24gV3JhcHBlZEVsZW1lbnQoX3JlZikge1xuICAgIHZhciBlbGVtZW50ID0gX3JlZi5lbGVtZW50LFxuICAgICAgICBjbGFzc05hbWVzID0gX3JlZi5jbGFzc05hbWVzO1xuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5jbGFzc05hbWVzID0gY2xhc3NOYW1lcztcblxuICAgIGlmICghKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSAmJiAhKGVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MU2VsZWN0RWxlbWVudCkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgZWxlbWVudCBwYXNzZWQnKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzRGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBXcmFwcGVkRWxlbWVudC5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmNvbmNlYWwgPSBmdW5jdGlvbiBjb25jZWFsKCkge1xuICAgIC8vIEhpZGUgcGFzc2VkIGlucHV0XG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jbGFzc05hbWVzLmlucHV0KTtcbiAgICB0aGlzLmVsZW1lbnQuaGlkZGVuID0gdHJ1ZTsgLy8gUmVtb3ZlIGVsZW1lbnQgZnJvbSB0YWIgaW5kZXhcblxuICAgIHRoaXMuZWxlbWVudC50YWJJbmRleCA9IC0xOyAvLyBCYWNrdXAgb3JpZ2luYWwgc3R5bGVzIGlmIGFueVxuXG4gICAgdmFyIG9yaWdTdHlsZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3N0eWxlJyk7XG5cbiAgICBpZiAob3JpZ1N0eWxlKSB7XG4gICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWNob2ljZS1vcmlnLXN0eWxlJywgb3JpZ1N0eWxlKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLWNob2ljZScsICdhY3RpdmUnKTtcbiAgfTtcblxuICBfcHJvdG8ucmV2ZWFsID0gZnVuY3Rpb24gcmV2ZWFsKCkge1xuICAgIC8vIFJlaW5zdGF0ZSBwYXNzZWQgZWxlbWVudFxuICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY2xhc3NOYW1lcy5pbnB1dCk7XG4gICAgdGhpcy5lbGVtZW50LmhpZGRlbiA9IGZhbHNlO1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7IC8vIFJlY292ZXIgb3JpZ2luYWwgc3R5bGVzIGlmIGFueVxuXG4gICAgdmFyIG9yaWdTdHlsZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY2hvaWNlLW9yaWctc3R5bGUnKTtcblxuICAgIGlmIChvcmlnU3R5bGUpIHtcbiAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtY2hvaWNlLW9yaWctc3R5bGUnKTtcbiAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgb3JpZ1N0eWxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICB9XG5cbiAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWNob2ljZScpOyAvLyBSZS1hc3NpZ24gdmFsdWVzIC0gdGhpcyBpcyB3ZWlyZCwgSSBrbm93XG4gICAgLy8gQHRvZG8gRmlndXJlIG91dCB3aHkgd2UgbmVlZCB0byBkbyB0aGlzXG5cbiAgICB0aGlzLmVsZW1lbnQudmFsdWUgPSB0aGlzLmVsZW1lbnQudmFsdWU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2VsZi1hc3NpZ25cbiAgfTtcblxuICBfcHJvdG8uZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgdGhpcy5lbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgdGhpcy5pc0Rpc2FibGVkID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIHRoaXMuZWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgdGhpcy5pc0Rpc2FibGVkID0gdHJ1ZTtcbiAgfTtcblxuICBfcHJvdG8udHJpZ2dlckV2ZW50ID0gZnVuY3Rpb24gdHJpZ2dlckV2ZW50KGV2ZW50VHlwZSwgZGF0YSkge1xuICAgIGRpc3BhdGNoRXZlbnQodGhpcy5lbGVtZW50LCBldmVudFR5cGUsIGRhdGEpO1xuICB9O1xuXG4gIHdyYXBwZWRfZWxlbWVudF9jcmVhdGVDbGFzcyhXcmFwcGVkRWxlbWVudCwgW3tcbiAgICBrZXk6IFwiaXNBY3RpdmVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZGF0YXNldC5jaG9pY2UgPT09ICdhY3RpdmUnO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJkaXJcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQuZGlyO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogXCJ2YWx1ZVwiLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC52YWx1ZTtcbiAgICB9LFxuICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAvLyB5b3UgbXVzdCBkZWZpbmUgc2V0dGVyIGhlcmUgb3RoZXJ3aXNlIGl0IHdpbGwgYmUgcmVhZG9ubHkgcHJvcGVydHlcbiAgICAgIHRoaXMuZWxlbWVudC52YWx1ZSA9IHZhbHVlO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBXcmFwcGVkRWxlbWVudDtcbn0oKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvd3JhcHBlZC1pbnB1dC5qc1xuZnVuY3Rpb24gd3JhcHBlZF9pbnB1dF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gd3JhcHBlZF9pbnB1dF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIHdyYXBwZWRfaW5wdXRfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIHdyYXBwZWRfaW5wdXRfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzTG9vc2Uoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzLnByb3RvdHlwZSk7IHN1YkNsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IHN1YkNsYXNzOyBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cblxuLyoqXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuQ2xhc3NOYW1lc30gQ2xhc3NOYW1lc1xuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkl0ZW19IEl0ZW1cbiAqL1xuXG52YXIgV3JhcHBlZElucHV0ID1cbi8qI19fUFVSRV9fKi9cbmZ1bmN0aW9uIChfV3JhcHBlZEVsZW1lbnQpIHtcbiAgX2luaGVyaXRzTG9vc2UoV3JhcHBlZElucHV0LCBfV3JhcHBlZEVsZW1lbnQpO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge3tcbiAgICogIGVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXG4gICAqICBjbGFzc05hbWVzOiBDbGFzc05hbWVzLFxuICAgKiAgZGVsaW1pdGVyOiBzdHJpbmdcbiAgICogfX0gYXJnc1xuICAgKi9cbiAgZnVuY3Rpb24gV3JhcHBlZElucHV0KF9yZWYpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgZWxlbWVudCA9IF9yZWYuZWxlbWVudCxcbiAgICAgICAgY2xhc3NOYW1lcyA9IF9yZWYuY2xhc3NOYW1lcyxcbiAgICAgICAgZGVsaW1pdGVyID0gX3JlZi5kZWxpbWl0ZXI7XG4gICAgX3RoaXMgPSBfV3JhcHBlZEVsZW1lbnQuY2FsbCh0aGlzLCB7XG4gICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgY2xhc3NOYW1lczogY2xhc3NOYW1lc1xuICAgIH0pIHx8IHRoaXM7XG4gICAgX3RoaXMuZGVsaW1pdGVyID0gZGVsaW1pdGVyO1xuICAgIHJldHVybiBfdGhpcztcbiAgfVxuICAvKipcbiAgICogQHJldHVybnMge3N0cmluZ31cbiAgICovXG5cblxuICB3cmFwcGVkX2lucHV0X2NyZWF0ZUNsYXNzKFdyYXBwZWRJbnB1dCwgW3tcbiAgICBrZXk6IFwidmFsdWVcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiB0aGlzLmVsZW1lbnQudmFsdWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SXRlbVtdfSBpdGVtc1xuICAgICAqL1xuICAgICxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChpdGVtcykge1xuICAgICAgdmFyIGl0ZW1WYWx1ZXMgPSBpdGVtcy5tYXAoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IF9yZWYyLnZhbHVlO1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9KTtcbiAgICAgIHZhciBqb2luZWRWYWx1ZXMgPSBpdGVtVmFsdWVzLmpvaW4odGhpcy5kZWxpbWl0ZXIpO1xuICAgICAgdGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZSgndmFsdWUnLCBqb2luZWRWYWx1ZXMpO1xuICAgICAgdGhpcy5lbGVtZW50LnZhbHVlID0gam9pbmVkVmFsdWVzO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBXcmFwcGVkSW5wdXQ7XG59KHdyYXBwZWRfZWxlbWVudF9XcmFwcGVkRWxlbWVudCk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3dyYXBwZWQtc2VsZWN0LmpzXG5mdW5jdGlvbiB3cmFwcGVkX3NlbGVjdF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gd3JhcHBlZF9zZWxlY3RfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSB3cmFwcGVkX3NlbGVjdF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgd3JhcHBlZF9zZWxlY3RfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuZnVuY3Rpb24gd3JhcHBlZF9zZWxlY3RfaW5oZXJpdHNMb29zZShzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MucHJvdG90eXBlKTsgc3ViQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gc3ViQ2xhc3M7IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuXG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5DbGFzc05hbWVzfSBDbGFzc05hbWVzXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuSXRlbX0gSXRlbVxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkNob2ljZX0gQ2hvaWNlXG4gKi9cblxudmFyIFdyYXBwZWRTZWxlY3QgPVxuLyojX19QVVJFX18qL1xuZnVuY3Rpb24gKF9XcmFwcGVkRWxlbWVudCkge1xuICB3cmFwcGVkX3NlbGVjdF9pbmhlcml0c0xvb3NlKFdyYXBwZWRTZWxlY3QsIF9XcmFwcGVkRWxlbWVudCk7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7e1xuICAgKiAgZWxlbWVudDogSFRNTFNlbGVjdEVsZW1lbnQsXG4gICAqICBjbGFzc05hbWVzOiBDbGFzc05hbWVzLFxuICAgKiAgZGVsaW1pdGVyOiBzdHJpbmdcbiAgICogIHRlbXBsYXRlOiBmdW5jdGlvblxuICAgKiB9fSBhcmdzXG4gICAqL1xuICBmdW5jdGlvbiBXcmFwcGVkU2VsZWN0KF9yZWYpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgZWxlbWVudCA9IF9yZWYuZWxlbWVudCxcbiAgICAgICAgY2xhc3NOYW1lcyA9IF9yZWYuY2xhc3NOYW1lcyxcbiAgICAgICAgdGVtcGxhdGUgPSBfcmVmLnRlbXBsYXRlO1xuICAgIF90aGlzID0gX1dyYXBwZWRFbGVtZW50LmNhbGwodGhpcywge1xuICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgIGNsYXNzTmFtZXM6IGNsYXNzTmFtZXNcbiAgICB9KSB8fCB0aGlzO1xuICAgIF90aGlzLnRlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgdmFyIF9wcm90byA9IFdyYXBwZWRTZWxlY3QucHJvdG90eXBlO1xuXG4gIC8qKlxuICAgKiBAcGFyYW0ge0RvY3VtZW50RnJhZ21lbnR9IGZyYWdtZW50XG4gICAqL1xuICBfcHJvdG8uYXBwZW5kRG9jRnJhZ21lbnQgPSBmdW5jdGlvbiBhcHBlbmREb2NGcmFnbWVudChmcmFnbWVudCkge1xuICAgIHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xuICB9O1xuXG4gIHdyYXBwZWRfc2VsZWN0X2NyZWF0ZUNsYXNzKFdyYXBwZWRTZWxlY3QsIFt7XG4gICAga2V5OiBcInBsYWNlaG9sZGVyT3B0aW9uXCIsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ29wdGlvblt2YWx1ZT1cIlwiXScpIHx8IC8vIEJhY2t3YXJkIGNvbXBhdGliaWxpdHkgbGF5ZXIgZm9yIHRoZSBub24tc3RhbmRhcmQgcGxhY2Vob2xkZXIgYXR0cmlidXRlIHN1cHBvcnRlZCBpbiBvbGRlciB2ZXJzaW9ucy5cbiAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdvcHRpb25bcGxhY2Vob2xkZXJdJyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtFbGVtZW50W119XG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogXCJvcHRpb25Hcm91cHNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnT1BUR1JPVVAnKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtJdGVtW10gfCBDaG9pY2VbXX1cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiBcIm9wdGlvbnNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuZWxlbWVudC5vcHRpb25zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtJdGVtW10gfCBDaG9pY2VbXX0gb3B0aW9uc1xuICAgICAqL1xuICAgICxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChvcHRpb25zKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXG4gICAgICB2YXIgYWRkT3B0aW9uVG9GcmFnbWVudCA9IGZ1bmN0aW9uIGFkZE9wdGlvblRvRnJhZ21lbnQoZGF0YSkge1xuICAgICAgICAvLyBDcmVhdGUgYSBzdGFuZGFyZCBzZWxlY3Qgb3B0aW9uXG4gICAgICAgIHZhciBvcHRpb24gPSBfdGhpczIudGVtcGxhdGUoZGF0YSk7IC8vIEFwcGVuZCBpdCB0byBmcmFnbWVudFxuXG5cbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQob3B0aW9uKTtcbiAgICAgIH07IC8vIEFkZCBlYWNoIGxpc3QgaXRlbSB0byBsaXN0XG5cblxuICAgICAgb3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChvcHRpb25EYXRhKSB7XG4gICAgICAgIHJldHVybiBhZGRPcHRpb25Ub0ZyYWdtZW50KG9wdGlvbkRhdGEpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmFwcGVuZERvY0ZyYWdtZW50KGZyYWdtZW50KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gV3JhcHBlZFNlbGVjdDtcbn0od3JhcHBlZF9lbGVtZW50X1dyYXBwZWRFbGVtZW50KTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvaW5kZXguanNcblxuXG5cblxuXG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy90ZW1wbGF0ZXMuanNcbi8qKlxuICogSGVscGVycyB0byBjcmVhdGUgSFRNTCBlbGVtZW50cyB1c2VkIGJ5IENob2ljZXNcbiAqIENhbiBiZSBvdmVycmlkZGVuIGJ5IHByb3ZpZGluZyBgY2FsbGJhY2tPbkNyZWF0ZVRlbXBsYXRlc2Agb3B0aW9uXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuVGVtcGxhdGVzfSBUZW1wbGF0ZXNcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5DbGFzc05hbWVzfSBDbGFzc05hbWVzXG4gKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi90eXBlcy9pbmRleCcpLkNob2ljZXMuT3B0aW9uc30gT3B0aW9uc1xuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkl0ZW19IEl0ZW1cbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5DaG9pY2V9IENob2ljZVxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkdyb3VwfSBHcm91cFxuICovXG52YXIgVEVNUExBVEVTID1cbi8qKiBAdHlwZSB7VGVtcGxhdGVzfSAqL1xue1xuICAvKipcbiAgICogQHBhcmFtIHtQYXJ0aWFsPENsYXNzTmFtZXM+fSBjbGFzc05hbWVzXG4gICAqIEBwYXJhbSB7XCJsdHJcIiB8IFwicnRsXCIgfCBcImF1dG9cIn0gZGlyXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZWxlY3RFbGVtZW50XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNTZWxlY3RPbmVFbGVtZW50XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gc2VhcmNoRW5hYmxlZFxuICAgKiBAcGFyYW0ge1wic2VsZWN0LW9uZVwiIHwgXCJzZWxlY3QtbXVsdGlwbGVcIiB8IFwidGV4dFwifSBwYXNzZWRFbGVtZW50VHlwZVxuICAgKi9cbiAgY29udGFpbmVyT3V0ZXI6IGZ1bmN0aW9uIGNvbnRhaW5lck91dGVyKF9yZWYsIGRpciwgaXNTZWxlY3RFbGVtZW50LCBpc1NlbGVjdE9uZUVsZW1lbnQsIHNlYXJjaEVuYWJsZWQsIHBhc3NlZEVsZW1lbnRUeXBlKSB7XG4gICAgdmFyIF9jb250YWluZXJPdXRlciA9IF9yZWYuY29udGFpbmVyT3V0ZXI7XG4gICAgdmFyIGRpdiA9IE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHtcbiAgICAgIGNsYXNzTmFtZTogX2NvbnRhaW5lck91dGVyXG4gICAgfSk7XG4gICAgZGl2LmRhdGFzZXQudHlwZSA9IHBhc3NlZEVsZW1lbnRUeXBlO1xuXG4gICAgaWYgKGRpcikge1xuICAgICAgZGl2LmRpciA9IGRpcjtcbiAgICB9XG5cbiAgICBpZiAoaXNTZWxlY3RPbmVFbGVtZW50KSB7XG4gICAgICBkaXYudGFiSW5kZXggPSAwO1xuICAgIH1cblxuICAgIGlmIChpc1NlbGVjdEVsZW1lbnQpIHtcbiAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCBzZWFyY2hFbmFibGVkID8gJ2NvbWJvYm94JyA6ICdsaXN0Ym94Jyk7XG5cbiAgICAgIGlmIChzZWFyY2hFbmFibGVkKSB7XG4gICAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtYXV0b2NvbXBsZXRlJywgJ2xpc3QnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLWhhc3BvcHVwJywgJ3RydWUnKTtcbiAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJyk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfSxcblxuICAvKipcbiAgICogQHBhcmFtIHtQYXJ0aWFsPENsYXNzTmFtZXM+fSBjbGFzc05hbWVzXG4gICAqL1xuICBjb250YWluZXJJbm5lcjogZnVuY3Rpb24gY29udGFpbmVySW5uZXIoX3JlZjIpIHtcbiAgICB2YXIgX2NvbnRhaW5lcklubmVyID0gX3JlZjIuY29udGFpbmVySW5uZXI7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHtcbiAgICAgIGNsYXNzTmFtZTogX2NvbnRhaW5lcklubmVyXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7UGFydGlhbDxDbGFzc05hbWVzPn0gY2xhc3NOYW1lc1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzU2VsZWN0T25lRWxlbWVudFxuICAgKi9cbiAgaXRlbUxpc3Q6IGZ1bmN0aW9uIGl0ZW1MaXN0KF9yZWYzLCBpc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICB2YXIgbGlzdCA9IF9yZWYzLmxpc3QsXG4gICAgICAgIGxpc3RTaW5nbGUgPSBfcmVmMy5saXN0U2luZ2xlLFxuICAgICAgICBsaXN0SXRlbXMgPSBfcmVmMy5saXN0SXRlbXM7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHtcbiAgICAgIGNsYXNzTmFtZTogbGlzdCArIFwiIFwiICsgKGlzU2VsZWN0T25lRWxlbWVudCA/IGxpc3RTaW5nbGUgOiBsaXN0SXRlbXMpXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7UGFydGlhbDxDbGFzc05hbWVzPn0gY2xhc3NOYW1lc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsdWVcbiAgICovXG4gIHBsYWNlaG9sZGVyOiBmdW5jdGlvbiBwbGFjZWhvbGRlcihfcmVmNCwgdmFsdWUpIHtcbiAgICB2YXIgX3BsYWNlaG9sZGVyID0gX3JlZjQucGxhY2Vob2xkZXI7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHtcbiAgICAgIGNsYXNzTmFtZTogX3BsYWNlaG9sZGVyLFxuICAgICAgaW5uZXJIVE1MOiB2YWx1ZVxuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1BhcnRpYWw8Q2xhc3NOYW1lcz59IGNsYXNzTmFtZXNcbiAgICogQHBhcmFtIHtJdGVtfSBpdGVtXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gcmVtb3ZlSXRlbUJ1dHRvblxuICAgKi9cbiAgaXRlbTogZnVuY3Rpb24gaXRlbShfcmVmNSwgX3JlZjYsIHJlbW92ZUl0ZW1CdXR0b24pIHtcbiAgICB2YXIgX2l0ZW0gPSBfcmVmNS5pdGVtLFxuICAgICAgICBidXR0b24gPSBfcmVmNS5idXR0b24sXG4gICAgICAgIGhpZ2hsaWdodGVkU3RhdGUgPSBfcmVmNS5oaWdobGlnaHRlZFN0YXRlLFxuICAgICAgICBpdGVtU2VsZWN0YWJsZSA9IF9yZWY1Lml0ZW1TZWxlY3RhYmxlLFxuICAgICAgICBwbGFjZWhvbGRlciA9IF9yZWY1LnBsYWNlaG9sZGVyO1xuICAgIHZhciBpZCA9IF9yZWY2LmlkLFxuICAgICAgICB2YWx1ZSA9IF9yZWY2LnZhbHVlLFxuICAgICAgICBsYWJlbCA9IF9yZWY2LmxhYmVsLFxuICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzID0gX3JlZjYuY3VzdG9tUHJvcGVydGllcyxcbiAgICAgICAgYWN0aXZlID0gX3JlZjYuYWN0aXZlLFxuICAgICAgICBkaXNhYmxlZCA9IF9yZWY2LmRpc2FibGVkLFxuICAgICAgICBoaWdobGlnaHRlZCA9IF9yZWY2LmhpZ2hsaWdodGVkLFxuICAgICAgICBpc1BsYWNlaG9sZGVyID0gX3JlZjYucGxhY2Vob2xkZXI7XG4gICAgdmFyIGRpdiA9IE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JyksIHtcbiAgICAgIGNsYXNzTmFtZTogX2l0ZW0sXG4gICAgICBpbm5lckhUTUw6IGxhYmVsXG4gICAgfSk7XG4gICAgT2JqZWN0LmFzc2lnbihkaXYuZGF0YXNldCwge1xuICAgICAgaXRlbTogJycsXG4gICAgICBpZDogaWQsXG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBjdXN0b21Qcm9wZXJ0aWVzXG4gICAgfSk7XG5cbiAgICBpZiAoYWN0aXZlKSB7XG4gICAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICB9XG5cbiAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAndHJ1ZScpO1xuICAgIH1cblxuICAgIGlmIChpc1BsYWNlaG9sZGVyKSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZChwbGFjZWhvbGRlcik7XG4gICAgfVxuXG4gICAgZGl2LmNsYXNzTGlzdC5hZGQoaGlnaGxpZ2h0ZWQgPyBoaWdobGlnaHRlZFN0YXRlIDogaXRlbVNlbGVjdGFibGUpO1xuXG4gICAgaWYgKHJlbW92ZUl0ZW1CdXR0b24pIHtcbiAgICAgIGlmIChkaXNhYmxlZCkge1xuICAgICAgICBkaXYuY2xhc3NMaXN0LnJlbW92ZShpdGVtU2VsZWN0YWJsZSk7XG4gICAgICB9XG5cbiAgICAgIGRpdi5kYXRhc2V0LmRlbGV0YWJsZSA9ICcnO1xuICAgICAgLyoqIEB0b2RvIFRoaXMgTVVTVCBiZSBsb2NhbGl6YWJsZSwgbm90IGhhcmRjb2RlZCEgKi9cblxuICAgICAgdmFyIFJFTU9WRV9JVEVNX1RFWFQgPSAnUmVtb3ZlIGl0ZW0nO1xuICAgICAgdmFyIHJlbW92ZUJ1dHRvbiA9IE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyksIHtcbiAgICAgICAgdHlwZTogJ2J1dHRvbicsXG4gICAgICAgIGNsYXNzTmFtZTogYnV0dG9uLFxuICAgICAgICBpbm5lckhUTUw6IFJFTU9WRV9JVEVNX1RFWFRcbiAgICAgIH0pO1xuICAgICAgcmVtb3ZlQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIFJFTU9WRV9JVEVNX1RFWFQgKyBcIjogJ1wiICsgdmFsdWUgKyBcIidcIik7XG4gICAgICByZW1vdmVCdXR0b24uZGF0YXNldC5idXR0b24gPSAnJztcbiAgICAgIGRpdi5hcHBlbmRDaGlsZChyZW1vdmVCdXR0b24pO1xuICAgIH1cblxuICAgIHJldHVybiBkaXY7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7UGFydGlhbDxDbGFzc05hbWVzPn0gY2xhc3NOYW1lc1xuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzU2VsZWN0T25lRWxlbWVudFxuICAgKi9cbiAgY2hvaWNlTGlzdDogZnVuY3Rpb24gY2hvaWNlTGlzdChfcmVmNywgaXNTZWxlY3RPbmVFbGVtZW50KSB7XG4gICAgdmFyIGxpc3QgPSBfcmVmNy5saXN0O1xuICAgIHZhciBkaXYgPSBPYmplY3QuYXNzaWduKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCB7XG4gICAgICBjbGFzc05hbWU6IGxpc3RcbiAgICB9KTtcblxuICAgIGlmICghaXNTZWxlY3RPbmVFbGVtZW50KSB7XG4gICAgICBkaXYuc2V0QXR0cmlidXRlKCdhcmlhLW11bHRpc2VsZWN0YWJsZScsICd0cnVlJyk7XG4gICAgfVxuXG4gICAgZGl2LnNldEF0dHJpYnV0ZSgncm9sZScsICdsaXN0Ym94Jyk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfSxcblxuICAvKipcbiAgICogQHBhcmFtIHtQYXJ0aWFsPENsYXNzTmFtZXM+fSBjbGFzc05hbWVzXG4gICAqIEBwYXJhbSB7R3JvdXB9IGdyb3VwXG4gICAqL1xuICBjaG9pY2VHcm91cDogZnVuY3Rpb24gY2hvaWNlR3JvdXAoX3JlZjgsIF9yZWY5KSB7XG4gICAgdmFyIGdyb3VwID0gX3JlZjguZ3JvdXAsXG4gICAgICAgIGdyb3VwSGVhZGluZyA9IF9yZWY4Lmdyb3VwSGVhZGluZyxcbiAgICAgICAgaXRlbURpc2FibGVkID0gX3JlZjguaXRlbURpc2FibGVkO1xuICAgIHZhciBpZCA9IF9yZWY5LmlkLFxuICAgICAgICB2YWx1ZSA9IF9yZWY5LnZhbHVlLFxuICAgICAgICBkaXNhYmxlZCA9IF9yZWY5LmRpc2FibGVkO1xuICAgIHZhciBkaXYgPSBPYmplY3QuYXNzaWduKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCB7XG4gICAgICBjbGFzc05hbWU6IGdyb3VwICsgXCIgXCIgKyAoZGlzYWJsZWQgPyBpdGVtRGlzYWJsZWQgOiAnJylcbiAgICB9KTtcbiAgICBkaXYuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2dyb3VwJyk7XG4gICAgT2JqZWN0LmFzc2lnbihkaXYuZGF0YXNldCwge1xuICAgICAgZ3JvdXA6ICcnLFxuICAgICAgaWQ6IGlkLFxuICAgICAgdmFsdWU6IHZhbHVlXG4gICAgfSk7XG5cbiAgICBpZiAoZGlzYWJsZWQpIHtcbiAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAndHJ1ZScpO1xuICAgIH1cblxuICAgIGRpdi5hcHBlbmRDaGlsZChPYmplY3QuYXNzaWduKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCB7XG4gICAgICBjbGFzc05hbWU6IGdyb3VwSGVhZGluZyxcbiAgICAgIGlubmVySFRNTDogdmFsdWVcbiAgICB9KSk7XG4gICAgcmV0dXJuIGRpdjtcbiAgfSxcblxuICAvKipcbiAgICogQHBhcmFtIHtQYXJ0aWFsPENsYXNzTmFtZXM+fSBjbGFzc05hbWVzXG4gICAqIEBwYXJhbSB7Q2hvaWNlfSBjaG9pY2VcbiAgICogQHBhcmFtIHtPcHRpb25zWydpdGVtU2VsZWN0VGV4dCddfSBzZWxlY3RUZXh0XG4gICAqL1xuICBjaG9pY2U6IGZ1bmN0aW9uIGNob2ljZShfcmVmMTAsIF9yZWYxMSwgc2VsZWN0VGV4dCkge1xuICAgIHZhciBpdGVtID0gX3JlZjEwLml0ZW0sXG4gICAgICAgIGl0ZW1DaG9pY2UgPSBfcmVmMTAuaXRlbUNob2ljZSxcbiAgICAgICAgaXRlbVNlbGVjdGFibGUgPSBfcmVmMTAuaXRlbVNlbGVjdGFibGUsXG4gICAgICAgIHNlbGVjdGVkU3RhdGUgPSBfcmVmMTAuc2VsZWN0ZWRTdGF0ZSxcbiAgICAgICAgaXRlbURpc2FibGVkID0gX3JlZjEwLml0ZW1EaXNhYmxlZCxcbiAgICAgICAgcGxhY2Vob2xkZXIgPSBfcmVmMTAucGxhY2Vob2xkZXI7XG4gICAgdmFyIGlkID0gX3JlZjExLmlkLFxuICAgICAgICB2YWx1ZSA9IF9yZWYxMS52YWx1ZSxcbiAgICAgICAgbGFiZWwgPSBfcmVmMTEubGFiZWwsXG4gICAgICAgIGdyb3VwSWQgPSBfcmVmMTEuZ3JvdXBJZCxcbiAgICAgICAgZWxlbWVudElkID0gX3JlZjExLmVsZW1lbnRJZCxcbiAgICAgICAgaXNEaXNhYmxlZCA9IF9yZWYxMS5kaXNhYmxlZCxcbiAgICAgICAgaXNTZWxlY3RlZCA9IF9yZWYxMS5zZWxlY3RlZCxcbiAgICAgICAgaXNQbGFjZWhvbGRlciA9IF9yZWYxMS5wbGFjZWhvbGRlcjtcbiAgICB2YXIgZGl2ID0gT2JqZWN0LmFzc2lnbihkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwge1xuICAgICAgaWQ6IGVsZW1lbnRJZCxcbiAgICAgIGlubmVySFRNTDogbGFiZWwsXG4gICAgICBjbGFzc05hbWU6IGl0ZW0gKyBcIiBcIiArIGl0ZW1DaG9pY2VcbiAgICB9KTtcblxuICAgIGlmIChpc1NlbGVjdGVkKSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZChzZWxlY3RlZFN0YXRlKTtcbiAgICB9XG5cbiAgICBpZiAoaXNQbGFjZWhvbGRlcikge1xuICAgICAgZGl2LmNsYXNzTGlzdC5hZGQocGxhY2Vob2xkZXIpO1xuICAgIH1cblxuICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCBncm91cElkID4gMCA/ICd0cmVlaXRlbScgOiAnb3B0aW9uJyk7XG4gICAgT2JqZWN0LmFzc2lnbihkaXYuZGF0YXNldCwge1xuICAgICAgY2hvaWNlOiAnJyxcbiAgICAgIGlkOiBpZCxcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIHNlbGVjdFRleHQ6IHNlbGVjdFRleHRcbiAgICB9KTtcblxuICAgIGlmIChpc0Rpc2FibGVkKSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZChpdGVtRGlzYWJsZWQpO1xuICAgICAgZGl2LmRhdGFzZXQuY2hvaWNlRGlzYWJsZWQgPSAnJztcbiAgICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAndHJ1ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZChpdGVtU2VsZWN0YWJsZSk7XG4gICAgICBkaXYuZGF0YXNldC5jaG9pY2VTZWxlY3RhYmxlID0gJyc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpdjtcbiAgfSxcblxuICAvKipcbiAgICogQHBhcmFtIHtQYXJ0aWFsPENsYXNzTmFtZXM+fSBjbGFzc05hbWVzXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBwbGFjZWhvbGRlclZhbHVlXG4gICAqL1xuICBpbnB1dDogZnVuY3Rpb24gaW5wdXQoX3JlZjEyLCBwbGFjZWhvbGRlclZhbHVlKSB7XG4gICAgdmFyIF9pbnB1dCA9IF9yZWYxMi5pbnB1dCxcbiAgICAgICAgaW5wdXRDbG9uZWQgPSBfcmVmMTIuaW5wdXRDbG9uZWQ7XG4gICAgdmFyIGlucCA9IE9iamVjdC5hc3NpZ24oZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKSwge1xuICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgY2xhc3NOYW1lOiBfaW5wdXQgKyBcIiBcIiArIGlucHV0Q2xvbmVkLFxuICAgICAgYXV0b2NvbXBsZXRlOiAnb2ZmJyxcbiAgICAgIGF1dG9jYXBpdGFsaXplOiAnb2ZmJyxcbiAgICAgIHNwZWxsY2hlY2s6IGZhbHNlXG4gICAgfSk7XG4gICAgaW5wLnNldEF0dHJpYnV0ZSgncm9sZScsICd0ZXh0Ym94Jyk7XG4gICAgaW5wLnNldEF0dHJpYnV0ZSgnYXJpYS1hdXRvY29tcGxldGUnLCAnbGlzdCcpO1xuICAgIGlucC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBwbGFjZWhvbGRlclZhbHVlKTtcbiAgICByZXR1cm4gaW5wO1xuICB9LFxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge1BhcnRpYWw8Q2xhc3NOYW1lcz59IGNsYXNzTmFtZXNcbiAgICovXG4gIGRyb3Bkb3duOiBmdW5jdGlvbiBkcm9wZG93bihfcmVmMTMpIHtcbiAgICB2YXIgbGlzdCA9IF9yZWYxMy5saXN0LFxuICAgICAgICBsaXN0RHJvcGRvd24gPSBfcmVmMTMubGlzdERyb3Bkb3duO1xuICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkaXYuY2xhc3NMaXN0LmFkZChsaXN0LCBsaXN0RHJvcGRvd24pO1xuICAgIGRpdi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCAnZmFsc2UnKTtcbiAgICByZXR1cm4gZGl2O1xuICB9LFxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0ge1BhcnRpYWw8Q2xhc3NOYW1lcz59IGNsYXNzTmFtZXNcbiAgICogQHBhcmFtIHtzdHJpbmd9IGlubmVySFRNTFxuICAgKiBAcGFyYW0ge1wibm8tY2hvaWNlc1wiIHwgXCJuby1yZXN1bHRzXCIgfCBcIlwifSB0eXBlXG4gICAqL1xuICBub3RpY2U6IGZ1bmN0aW9uIG5vdGljZShfcmVmMTQsIGlubmVySFRNTCwgdHlwZSkge1xuICAgIHZhciBpdGVtID0gX3JlZjE0Lml0ZW0sXG4gICAgICAgIGl0ZW1DaG9pY2UgPSBfcmVmMTQuaXRlbUNob2ljZSxcbiAgICAgICAgbm9SZXN1bHRzID0gX3JlZjE0Lm5vUmVzdWx0cyxcbiAgICAgICAgbm9DaG9pY2VzID0gX3JlZjE0Lm5vQ2hvaWNlcztcblxuICAgIGlmICh0eXBlID09PSB2b2lkIDApIHtcbiAgICAgIHR5cGUgPSAnJztcbiAgICB9XG5cbiAgICB2YXIgY2xhc3NlcyA9IFtpdGVtLCBpdGVtQ2hvaWNlXTtcblxuICAgIGlmICh0eXBlID09PSAnbm8tY2hvaWNlcycpIHtcbiAgICAgIGNsYXNzZXMucHVzaChub0Nob2ljZXMpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ25vLXJlc3VsdHMnKSB7XG4gICAgICBjbGFzc2VzLnB1c2gobm9SZXN1bHRzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwge1xuICAgICAgaW5uZXJIVE1MOiBpbm5lckhUTUwsXG4gICAgICBjbGFzc05hbWU6IGNsYXNzZXMuam9pbignICcpXG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7SXRlbX0gb3B0aW9uXG4gICAqL1xuICBvcHRpb246IGZ1bmN0aW9uIG9wdGlvbihfcmVmMTUpIHtcbiAgICB2YXIgbGFiZWwgPSBfcmVmMTUubGFiZWwsXG4gICAgICAgIHZhbHVlID0gX3JlZjE1LnZhbHVlLFxuICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzID0gX3JlZjE1LmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgIGFjdGl2ZSA9IF9yZWYxNS5hY3RpdmUsXG4gICAgICAgIGRpc2FibGVkID0gX3JlZjE1LmRpc2FibGVkO1xuICAgIHZhciBvcHQgPSBuZXcgT3B0aW9uKGxhYmVsLCB2YWx1ZSwgZmFsc2UsIGFjdGl2ZSk7XG5cbiAgICBpZiAoY3VzdG9tUHJvcGVydGllcykge1xuICAgICAgb3B0LmRhdGFzZXQuY3VzdG9tUHJvcGVydGllcyA9IGN1c3RvbVByb3BlcnRpZXM7XG4gICAgfVxuXG4gICAgb3B0LmRpc2FibGVkID0gZGlzYWJsZWQ7XG4gICAgcmV0dXJuIG9wdDtcbiAgfVxufTtcbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gdmFyIHRlbXBsYXRlcyA9IChURU1QTEFURVMpO1xuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9hY3Rpb25zL2Nob2ljZXMuanNcbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydCgncmVkdXgnKS5BY3Rpb259IEFjdGlvblxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkNob2ljZX0gQ2hvaWNlXG4gKi9cblxuLyoqXG4gKiBAYXJndW1lbnQge0Nob2ljZX0gY2hvaWNlXG4gKiBAcmV0dXJucyB7QWN0aW9uICYgQ2hvaWNlfVxuICovXG5cbnZhciBjaG9pY2VzX2FkZENob2ljZSA9IGZ1bmN0aW9uIGFkZENob2ljZShfcmVmKSB7XG4gIHZhciB2YWx1ZSA9IF9yZWYudmFsdWUsXG4gICAgICBsYWJlbCA9IF9yZWYubGFiZWwsXG4gICAgICBpZCA9IF9yZWYuaWQsXG4gICAgICBncm91cElkID0gX3JlZi5ncm91cElkLFxuICAgICAgZGlzYWJsZWQgPSBfcmVmLmRpc2FibGVkLFxuICAgICAgZWxlbWVudElkID0gX3JlZi5lbGVtZW50SWQsXG4gICAgICBjdXN0b21Qcm9wZXJ0aWVzID0gX3JlZi5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgcGxhY2Vob2xkZXIgPSBfcmVmLnBsYWNlaG9sZGVyLFxuICAgICAga2V5Q29kZSA9IF9yZWYua2V5Q29kZTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBBQ1RJT05fVFlQRVMuQUREX0NIT0lDRSxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgbGFiZWw6IGxhYmVsLFxuICAgIGlkOiBpZCxcbiAgICBncm91cElkOiBncm91cElkLFxuICAgIGRpc2FibGVkOiBkaXNhYmxlZCxcbiAgICBlbGVtZW50SWQ6IGVsZW1lbnRJZCxcbiAgICBjdXN0b21Qcm9wZXJ0aWVzOiBjdXN0b21Qcm9wZXJ0aWVzLFxuICAgIHBsYWNlaG9sZGVyOiBwbGFjZWhvbGRlcixcbiAgICBrZXlDb2RlOiBrZXlDb2RlXG4gIH07XG59O1xuLyoqXG4gKiBAYXJndW1lbnQge0Nob2ljZVtdfSByZXN1bHRzXG4gKiBAcmV0dXJucyB7QWN0aW9uICYgeyByZXN1bHRzOiBDaG9pY2VbXSB9fVxuICovXG5cbnZhciBjaG9pY2VzX2ZpbHRlckNob2ljZXMgPSBmdW5jdGlvbiBmaWx0ZXJDaG9pY2VzKHJlc3VsdHMpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBBQ1RJT05fVFlQRVMuRklMVEVSX0NIT0lDRVMsXG4gICAgcmVzdWx0czogcmVzdWx0c1xuICB9O1xufTtcbi8qKlxuICogQGFyZ3VtZW50IHtib29sZWFufSBhY3RpdmVcbiAqIEByZXR1cm5zIHtBY3Rpb24gJiB7IGFjdGl2ZTogYm9vbGVhbiB9fVxuICovXG5cbnZhciBjaG9pY2VzX2FjdGl2YXRlQ2hvaWNlcyA9IGZ1bmN0aW9uIGFjdGl2YXRlQ2hvaWNlcyhhY3RpdmUpIHtcbiAgaWYgKGFjdGl2ZSA9PT0gdm9pZCAwKSB7XG4gICAgYWN0aXZlID0gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdHlwZTogQUNUSU9OX1RZUEVTLkFDVElWQVRFX0NIT0lDRVMsXG4gICAgYWN0aXZlOiBhY3RpdmVcbiAgfTtcbn07XG4vKipcbiAqIEByZXR1cm5zIHtBY3Rpb259XG4gKi9cblxudmFyIGNob2ljZXNfY2xlYXJDaG9pY2VzID0gZnVuY3Rpb24gY2xlYXJDaG9pY2VzKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IEFDVElPTl9UWVBFUy5DTEVBUl9DSE9JQ0VTXG4gIH07XG59O1xuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvc2NyaXB0cy9hY3Rpb25zL2l0ZW1zLmpzXG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydCgncmVkdXgnKS5BY3Rpb259IEFjdGlvblxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkl0ZW19IEl0ZW1cbiAqL1xuXG4vKipcbiAqIEBwYXJhbSB7SXRlbX0gaXRlbVxuICogQHJldHVybnMge0FjdGlvbiAmIEl0ZW19XG4gKi9cblxudmFyIGl0ZW1zX2FkZEl0ZW0gPSBmdW5jdGlvbiBhZGRJdGVtKF9yZWYpIHtcbiAgdmFyIHZhbHVlID0gX3JlZi52YWx1ZSxcbiAgICAgIGxhYmVsID0gX3JlZi5sYWJlbCxcbiAgICAgIGlkID0gX3JlZi5pZCxcbiAgICAgIGNob2ljZUlkID0gX3JlZi5jaG9pY2VJZCxcbiAgICAgIGdyb3VwSWQgPSBfcmVmLmdyb3VwSWQsXG4gICAgICBjdXN0b21Qcm9wZXJ0aWVzID0gX3JlZi5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgcGxhY2Vob2xkZXIgPSBfcmVmLnBsYWNlaG9sZGVyLFxuICAgICAga2V5Q29kZSA9IF9yZWYua2V5Q29kZTtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBBQ1RJT05fVFlQRVMuQUREX0lURU0sXG4gICAgdmFsdWU6IHZhbHVlLFxuICAgIGxhYmVsOiBsYWJlbCxcbiAgICBpZDogaWQsXG4gICAgY2hvaWNlSWQ6IGNob2ljZUlkLFxuICAgIGdyb3VwSWQ6IGdyb3VwSWQsXG4gICAgY3VzdG9tUHJvcGVydGllczogY3VzdG9tUHJvcGVydGllcyxcbiAgICBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIsXG4gICAga2V5Q29kZToga2V5Q29kZVxuICB9O1xufTtcbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gY2hvaWNlSWRcbiAqIEByZXR1cm5zIHtBY3Rpb24gJiB7IGlkOiBzdHJpbmcsIGNob2ljZUlkOiBzdHJpbmcgfX1cbiAqL1xuXG52YXIgaXRlbXNfcmVtb3ZlSXRlbSA9IGZ1bmN0aW9uIHJlbW92ZUl0ZW0oaWQsIGNob2ljZUlkKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQUNUSU9OX1RZUEVTLlJFTU9WRV9JVEVNLFxuICAgIGlkOiBpZCxcbiAgICBjaG9pY2VJZDogY2hvaWNlSWRcbiAgfTtcbn07XG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZFxuICogQHBhcmFtIHtib29sZWFufSBoaWdobGlnaHRlZFxuICogQHJldHVybnMge0FjdGlvbiAmIHsgaWQ6IHN0cmluZywgaGlnaGxpZ2h0ZWQ6IGJvb2xlYW4gfX1cbiAqL1xuXG52YXIgaXRlbXNfaGlnaGxpZ2h0SXRlbSA9IGZ1bmN0aW9uIGhpZ2hsaWdodEl0ZW0oaWQsIGhpZ2hsaWdodGVkKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQUNUSU9OX1RZUEVTLkhJR0hMSUdIVF9JVEVNLFxuICAgIGlkOiBpZCxcbiAgICBoaWdobGlnaHRlZDogaGlnaGxpZ2h0ZWRcbiAgfTtcbn07XG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3NyYy9zY3JpcHRzL2FjdGlvbnMvZ3JvdXBzLmpzXG5cbi8qKlxuICogQHR5cGVkZWYge2ltcG9ydCgncmVkdXgnKS5BY3Rpb259IEFjdGlvblxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkdyb3VwfSBHcm91cFxuICovXG5cbi8qKlxuICogQHBhcmFtIHtHcm91cH0gZ3JvdXBcbiAqIEByZXR1cm5zIHtBY3Rpb24gJiBHcm91cH1cbiAqL1xuXG52YXIgZ3JvdXBzX2FkZEdyb3VwID0gZnVuY3Rpb24gYWRkR3JvdXAoX3JlZikge1xuICB2YXIgdmFsdWUgPSBfcmVmLnZhbHVlLFxuICAgICAgaWQgPSBfcmVmLmlkLFxuICAgICAgYWN0aXZlID0gX3JlZi5hY3RpdmUsXG4gICAgICBkaXNhYmxlZCA9IF9yZWYuZGlzYWJsZWQ7XG4gIHJldHVybiB7XG4gICAgdHlwZTogQUNUSU9OX1RZUEVTLkFERF9HUk9VUCxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgaWQ6IGlkLFxuICAgIGFjdGl2ZTogYWN0aXZlLFxuICAgIGRpc2FibGVkOiBkaXNhYmxlZFxuICB9O1xufTtcbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvYWN0aW9ucy9taXNjLmpzXG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJ3JlZHV4JykuQWN0aW9ufSBBY3Rpb25cbiAqL1xuXG4vKipcbiAqIEByZXR1cm5zIHtBY3Rpb259XG4gKi9cbnZhciBjbGVhckFsbCA9IGZ1bmN0aW9uIGNsZWFyQWxsKCkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdDTEVBUl9BTEwnXG4gIH07XG59O1xuLyoqXG4gKiBAcGFyYW0ge2FueX0gc3RhdGVcbiAqIEByZXR1cm5zIHtBY3Rpb24gJiB7IHN0YXRlOiBvYmplY3QgfX1cbiAqL1xuXG52YXIgcmVzZXRUbyA9IGZ1bmN0aW9uIHJlc2V0VG8oc3RhdGUpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnUkVTRVRfVE8nLFxuICAgIHN0YXRlOiBzdGF0ZVxuICB9O1xufTtcbi8qKlxuICogQHBhcmFtIHtib29sZWFufSBpc0xvYWRpbmdcbiAqIEByZXR1cm5zIHtBY3Rpb24gJiB7IGlzTG9hZGluZzogYm9vbGVhbiB9fVxuICovXG5cbnZhciBzZXRJc0xvYWRpbmcgPSBmdW5jdGlvbiBzZXRJc0xvYWRpbmcoaXNMb2FkaW5nKSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ1NFVF9JU19MT0FESU5HJyxcbiAgICBpc0xvYWRpbmc6IGlzTG9hZGluZ1xuICB9O1xufTtcbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vc3JjL3NjcmlwdHMvY2hvaWNlcy5qc1xuZnVuY3Rpb24gY2hvaWNlc19kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH1cblxuZnVuY3Rpb24gY2hvaWNlc19jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGNob2ljZXNfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGNob2ljZXNfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH1cblxuXG5cblxuXG5cblxuXG5cblxuXG5cbi8qKiBAc2VlIHtAbGluayBodHRwOi8vYnJvd3NlcmhhY2tzLmNvbS8jaGFjay1hY2VhMDc1ZDBhYzY5NTRmMjc1YTcwMDIzOTA2MDUwY30gKi9cblxudmFyIElTX0lFMTEgPSAnLW1zLXNjcm9sbC1saW1pdCcgaW4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlICYmICctbXMtaW1lLWFsaWduJyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGU7XG4vKipcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5DaG9pY2V9IENob2ljZVxuICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vdHlwZXMvaW5kZXgnKS5DaG9pY2VzLkl0ZW19IEl0ZW1cbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5Hcm91cH0gR3JvdXBcbiAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5PcHRpb25zfSBPcHRpb25zXG4gKi9cblxuLyoqIEB0eXBlIHtQYXJ0aWFsPE9wdGlvbnM+fSAqL1xuXG52YXIgVVNFUl9ERUZBVUxUUyA9IHt9O1xuLyoqXG4gKiBDaG9pY2VzXG4gKiBAYXV0aG9yIEpvc2ggSm9obnNvbjxqb3NoQGpvc2h1YWpvaG5zb24uY28udWs+XG4gKi9cblxudmFyIGNob2ljZXNfQ2hvaWNlcyA9XG4vKiNfX1BVUkVfXyovXG5mdW5jdGlvbiAoKSB7XG4gIGNob2ljZXNfY3JlYXRlQ2xhc3MoQ2hvaWNlcywgbnVsbCwgW3tcbiAgICBrZXk6IFwiZGVmYXVsdHNcIixcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHJldHVybiBPYmplY3QucHJldmVudEV4dGVuc2lvbnMoe1xuICAgICAgICBnZXQgb3B0aW9ucygpIHtcbiAgICAgICAgICByZXR1cm4gVVNFUl9ERUZBVUxUUztcbiAgICAgICAgfSxcblxuICAgICAgICBnZXQgdGVtcGxhdGVzKCkge1xuICAgICAgICAgIHJldHVybiBURU1QTEFURVM7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nIHwgSFRNTElucHV0RWxlbWVudCB8IEhUTUxTZWxlY3RFbGVtZW50fSBlbGVtZW50XG4gICAgICogQHBhcmFtIHtQYXJ0aWFsPE9wdGlvbnM+fSB1c2VyQ29uZmlnXG4gICAgICovXG5cbiAgfV0pO1xuXG4gIGZ1bmN0aW9uIENob2ljZXMoZWxlbWVudCwgdXNlckNvbmZpZykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBpZiAoZWxlbWVudCA9PT0gdm9pZCAwKSB7XG4gICAgICBlbGVtZW50ID0gJ1tkYXRhLWNob2ljZV0nO1xuICAgIH1cblxuICAgIGlmICh1c2VyQ29uZmlnID09PSB2b2lkIDApIHtcbiAgICAgIHVzZXJDb25maWcgPSB7fTtcbiAgICB9XG5cbiAgICAvKiogQHR5cGUge1BhcnRpYWw8T3B0aW9ucz59ICovXG4gICAgdGhpcy5jb25maWcgPSBjanNfZGVmYXVsdC5hLmFsbChbREVGQVVMVF9DT05GSUcsIENob2ljZXMuZGVmYXVsdHMub3B0aW9ucywgdXNlckNvbmZpZ10sIC8vIFdoZW4gbWVyZ2luZyBhcnJheSBjb25maWdzLCByZXBsYWNlIHdpdGggYSBjb3B5IG9mIHRoZSB1c2VyQ29uZmlnIGFycmF5LFxuICAgIC8vIGluc3RlYWQgb2YgY29uY2F0ZW5hdGluZyB3aXRoIHRoZSBkZWZhdWx0IGFycmF5XG4gICAge1xuICAgICAgYXJyYXlNZXJnZTogZnVuY3Rpb24gYXJyYXlNZXJnZShfLCBzb3VyY2VBcnJheSkge1xuICAgICAgICByZXR1cm4gW10uY29uY2F0KHNvdXJjZUFycmF5KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB2YXIgaW52YWxpZENvbmZpZ09wdGlvbnMgPSBkaWZmKHRoaXMuY29uZmlnLCBERUZBVUxUX0NPTkZJRyk7XG5cbiAgICBpZiAoaW52YWxpZENvbmZpZ09wdGlvbnMubGVuZ3RoKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1Vua25vd24gY29uZmlnIG9wdGlvbihzKSBwYXNzZWQnLCBpbnZhbGlkQ29uZmlnT3B0aW9ucy5qb2luKCcsICcpKTtcbiAgICB9XG5cbiAgICB2YXIgcGFzc2VkRWxlbWVudCA9IHR5cGVvZiBlbGVtZW50ID09PSAnc3RyaW5nJyA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCkgOiBlbGVtZW50O1xuXG4gICAgaWYgKCEocGFzc2VkRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQgfHwgcGFzc2VkRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxTZWxlY3RFbGVtZW50KSkge1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCdFeHBlY3RlZCBvbmUgb2YgdGhlIGZvbGxvd2luZyB0eXBlcyB0ZXh0fHNlbGVjdC1vbmV8c2VsZWN0LW11bHRpcGxlJyk7XG4gICAgfVxuXG4gICAgdGhpcy5faXNUZXh0RWxlbWVudCA9IHBhc3NlZEVsZW1lbnQudHlwZSA9PT0gVEVYVF9UWVBFO1xuICAgIHRoaXMuX2lzU2VsZWN0T25lRWxlbWVudCA9IHBhc3NlZEVsZW1lbnQudHlwZSA9PT0gU0VMRUNUX09ORV9UWVBFO1xuICAgIHRoaXMuX2lzU2VsZWN0TXVsdGlwbGVFbGVtZW50ID0gcGFzc2VkRWxlbWVudC50eXBlID09PSBTRUxFQ1RfTVVMVElQTEVfVFlQRTtcbiAgICB0aGlzLl9pc1NlbGVjdEVsZW1lbnQgPSB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQgfHwgdGhpcy5faXNTZWxlY3RNdWx0aXBsZUVsZW1lbnQ7XG4gICAgdGhpcy5jb25maWcuc2VhcmNoRW5hYmxlZCA9IHRoaXMuX2lzU2VsZWN0TXVsdGlwbGVFbGVtZW50IHx8IHRoaXMuY29uZmlnLnNlYXJjaEVuYWJsZWQ7XG5cbiAgICBpZiAoIVsnYXV0bycsICdhbHdheXMnXS5pbmNsdWRlcyh0aGlzLmNvbmZpZy5yZW5kZXJTZWxlY3RlZENob2ljZXMpKSB7XG4gICAgICB0aGlzLmNvbmZpZy5yZW5kZXJTZWxlY3RlZENob2ljZXMgPSAnYXV0byc7XG4gICAgfVxuXG4gICAgaWYgKHVzZXJDb25maWcuYWRkSXRlbUZpbHRlciAmJiB0eXBlb2YgdXNlckNvbmZpZy5hZGRJdGVtRmlsdGVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YXIgcmUgPSB1c2VyQ29uZmlnLmFkZEl0ZW1GaWx0ZXIgaW5zdGFuY2VvZiBSZWdFeHAgPyB1c2VyQ29uZmlnLmFkZEl0ZW1GaWx0ZXIgOiBuZXcgUmVnRXhwKHVzZXJDb25maWcuYWRkSXRlbUZpbHRlcik7XG4gICAgICB0aGlzLmNvbmZpZy5hZGRJdGVtRmlsdGVyID0gcmUudGVzdC5iaW5kKHJlKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5faXNUZXh0RWxlbWVudCkge1xuICAgICAgdGhpcy5wYXNzZWRFbGVtZW50ID0gbmV3IFdyYXBwZWRJbnB1dCh7XG4gICAgICAgIGVsZW1lbnQ6IHBhc3NlZEVsZW1lbnQsXG4gICAgICAgIGNsYXNzTmFtZXM6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMsXG4gICAgICAgIGRlbGltaXRlcjogdGhpcy5jb25maWcuZGVsaW1pdGVyXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wYXNzZWRFbGVtZW50ID0gbmV3IFdyYXBwZWRTZWxlY3Qoe1xuICAgICAgICBlbGVtZW50OiBwYXNzZWRFbGVtZW50LFxuICAgICAgICBjbGFzc05hbWVzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLFxuICAgICAgICB0ZW1wbGF0ZTogZnVuY3Rpb24gdGVtcGxhdGUoZGF0YSkge1xuICAgICAgICAgIHJldHVybiBfdGhpcy5fdGVtcGxhdGVzLm9wdGlvbihkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5pbml0aWFsaXNlZCA9IGZhbHNlO1xuICAgIHRoaXMuX3N0b3JlID0gbmV3IHN0b3JlX1N0b3JlKCk7XG4gICAgdGhpcy5faW5pdGlhbFN0YXRlID0ge307XG4gICAgdGhpcy5fY3VycmVudFN0YXRlID0ge307XG4gICAgdGhpcy5fcHJldlN0YXRlID0ge307XG4gICAgdGhpcy5fY3VycmVudFZhbHVlID0gJyc7XG4gICAgdGhpcy5fY2FuU2VhcmNoID0gdGhpcy5jb25maWcuc2VhcmNoRW5hYmxlZDtcbiAgICB0aGlzLl9pc1Njcm9sbGluZ09uSWUgPSBmYWxzZTtcbiAgICB0aGlzLl9oaWdobGlnaHRQb3NpdGlvbiA9IDA7XG4gICAgdGhpcy5fd2FzVGFwID0gdHJ1ZTtcbiAgICB0aGlzLl9wbGFjZWhvbGRlclZhbHVlID0gdGhpcy5fZ2VuZXJhdGVQbGFjZWhvbGRlclZhbHVlKCk7XG4gICAgdGhpcy5fYmFzZUlkID0gZ2VuZXJhdGVJZCh0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudCwgJ2Nob2ljZXMtJyk7XG4gICAgLyoqXG4gICAgICogc2V0dGluZyBkaXJlY3Rpb24gaW4gY2FzZXMgd2hlcmUgaXQncyBleHBsaWNpdGx5IHNldCBvbiBwYXNzZWRFbGVtZW50XG4gICAgICogb3Igd2hlbiBjYWxjdWxhdGVkIGRpcmVjdGlvbiBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgZG9jdW1lbnRcbiAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnRbJ2RpciddfVxuICAgICAqL1xuXG4gICAgdGhpcy5fZGlyZWN0aW9uID0gdGhpcy5wYXNzZWRFbGVtZW50LmRpcjtcblxuICAgIGlmICghdGhpcy5fZGlyZWN0aW9uKSB7XG4gICAgICB2YXIgX3dpbmRvdyRnZXRDb21wdXRlZFN0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5wYXNzZWRFbGVtZW50LmVsZW1lbnQpLFxuICAgICAgICAgIGVsZW1lbnREaXJlY3Rpb24gPSBfd2luZG93JGdldENvbXB1dGVkU3QuZGlyZWN0aW9uO1xuXG4gICAgICB2YXIgX3dpbmRvdyRnZXRDb21wdXRlZFN0MiA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCksXG4gICAgICAgICAgZG9jdW1lbnREaXJlY3Rpb24gPSBfd2luZG93JGdldENvbXB1dGVkU3QyLmRpcmVjdGlvbjtcblxuICAgICAgaWYgKGVsZW1lbnREaXJlY3Rpb24gIT09IGRvY3VtZW50RGlyZWN0aW9uKSB7XG4gICAgICAgIHRoaXMuX2RpcmVjdGlvbiA9IGVsZW1lbnREaXJlY3Rpb247XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5faWROYW1lcyA9IHtcbiAgICAgIGl0ZW1DaG9pY2U6ICdpdGVtLWNob2ljZSdcbiAgICB9OyAvLyBBc3NpZ24gcHJlc2V0IGdyb3VwcyBmcm9tIHBhc3NlZCBlbGVtZW50XG5cbiAgICB0aGlzLl9wcmVzZXRHcm91cHMgPSB0aGlzLnBhc3NlZEVsZW1lbnQub3B0aW9uR3JvdXBzOyAvLyBBc3NpZ24gcHJlc2V0IG9wdGlvbnMgZnJvbSBwYXNzZWQgZWxlbWVudFxuXG4gICAgdGhpcy5fcHJlc2V0T3B0aW9ucyA9IHRoaXMucGFzc2VkRWxlbWVudC5vcHRpb25zOyAvLyBBc3NpZ24gcHJlc2V0IGNob2ljZXMgZnJvbSBwYXNzZWQgb2JqZWN0XG5cbiAgICB0aGlzLl9wcmVzZXRDaG9pY2VzID0gdGhpcy5jb25maWcuY2hvaWNlczsgLy8gQXNzaWduIHByZXNldCBpdGVtcyBmcm9tIHBhc3NlZCBvYmplY3QgZmlyc3RcblxuICAgIHRoaXMuX3ByZXNldEl0ZW1zID0gdGhpcy5jb25maWcuaXRlbXM7IC8vIEFkZCBhbnkgdmFsdWVzIHBhc3NlZCBmcm9tIGF0dHJpYnV0ZVxuXG4gICAgaWYgKHRoaXMucGFzc2VkRWxlbWVudC52YWx1ZSkge1xuICAgICAgdGhpcy5fcHJlc2V0SXRlbXMgPSB0aGlzLl9wcmVzZXRJdGVtcy5jb25jYXQodGhpcy5wYXNzZWRFbGVtZW50LnZhbHVlLnNwbGl0KHRoaXMuY29uZmlnLmRlbGltaXRlcikpO1xuICAgIH0gLy8gQ3JlYXRlIGFycmF5IG9mIGNob2ljZXMgZnJvbSBvcHRpb24gZWxlbWVudHNcblxuXG4gICAgaWYgKHRoaXMucGFzc2VkRWxlbWVudC5vcHRpb25zKSB7XG4gICAgICB0aGlzLnBhc3NlZEVsZW1lbnQub3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIF90aGlzLl9wcmVzZXRDaG9pY2VzLnB1c2goe1xuICAgICAgICAgIHZhbHVlOiBvLnZhbHVlLFxuICAgICAgICAgIGxhYmVsOiBvLmlubmVySFRNTCxcbiAgICAgICAgICBzZWxlY3RlZDogby5zZWxlY3RlZCxcbiAgICAgICAgICBkaXNhYmxlZDogby5kaXNhYmxlZCB8fCBvLnBhcmVudE5vZGUuZGlzYWJsZWQsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6IG8udmFsdWUgPT09ICcnIHx8IG8uaGFzQXR0cmlidXRlKCdwbGFjZWhvbGRlcicpLFxuICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IG8uZ2V0QXR0cmlidXRlKCdkYXRhLWN1c3RvbS1wcm9wZXJ0aWVzJylcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLl9yZW5kZXIgPSB0aGlzLl9yZW5kZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkZvY3VzID0gdGhpcy5fb25Gb2N1cy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uQmx1ciA9IHRoaXMuX29uQmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uS2V5VXAgPSB0aGlzLl9vbktleVVwLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25LZXlEb3duID0gdGhpcy5fb25LZXlEb3duLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25DbGljayA9IHRoaXMuX29uQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vblRvdWNoTW92ZSA9IHRoaXMuX29uVG91Y2hNb3ZlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25Ub3VjaEVuZCA9IHRoaXMuX29uVG91Y2hFbmQuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbk1vdXNlRG93biA9IHRoaXMuX29uTW91c2VEb3duLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25Nb3VzZU92ZXIgPSB0aGlzLl9vbk1vdXNlT3Zlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uRm9ybVJlc2V0ID0gdGhpcy5fb25Gb3JtUmVzZXQuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkFLZXkgPSB0aGlzLl9vbkFLZXkuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkVudGVyS2V5ID0gdGhpcy5fb25FbnRlcktleS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uRXNjYXBlS2V5ID0gdGhpcy5fb25Fc2NhcGVLZXkuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkRpcmVjdGlvbktleSA9IHRoaXMuX29uRGlyZWN0aW9uS2V5LmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25EZWxldGVLZXkgPSB0aGlzLl9vbkRlbGV0ZUtleS5iaW5kKHRoaXMpOyAvLyBJZiBlbGVtZW50IGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGlzZWQgd2l0aCBDaG9pY2VzLCBmYWlsIHNpbGVudGx5XG5cbiAgICBpZiAodGhpcy5wYXNzZWRFbGVtZW50LmlzQWN0aXZlKSB7XG4gICAgICBpZiAoIXRoaXMuY29uZmlnLnNpbGVudCkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ1RyeWluZyB0byBpbml0aWFsaXNlIENob2ljZXMgb24gZWxlbWVudCBhbHJlYWR5IGluaXRpYWxpc2VkJyk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaW5pdGlhbGlzZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuO1xuICAgIH0gLy8gTGV0J3MgZ29cblxuXG4gICAgdGhpcy5pbml0KCk7XG4gIH1cblxuICB2YXIgX3Byb3RvID0gQ2hvaWNlcy5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmluaXQgPSBmdW5jdGlvbiBpbml0KCkge1xuICAgIGlmICh0aGlzLmluaXRpYWxpc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fY3JlYXRlVGVtcGxhdGVzKCk7XG5cbiAgICB0aGlzLl9jcmVhdGVFbGVtZW50cygpO1xuXG4gICAgdGhpcy5fY3JlYXRlU3RydWN0dXJlKCk7IC8vIFNldCBpbml0aWFsIHN0YXRlIChXZSBuZWVkIHRvIGNsb25lIHRoZSBzdGF0ZSBiZWNhdXNlIHNvbWUgcmVkdWNlcnNcbiAgICAvLyBtb2RpZnkgdGhlIGlubmVyIG9iamVjdHMgcHJvcGVydGllcyBpbiB0aGUgc3RhdGUpIPCfpKJcblxuXG4gICAgdGhpcy5faW5pdGlhbFN0YXRlID0gY2xvbmVPYmplY3QodGhpcy5fc3RvcmUuc3RhdGUpO1xuXG4gICAgdGhpcy5fc3RvcmUuc3Vic2NyaWJlKHRoaXMuX3JlbmRlcik7XG5cbiAgICB0aGlzLl9yZW5kZXIoKTtcblxuICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB2YXIgc2hvdWxkRGlzYWJsZSA9ICF0aGlzLmNvbmZpZy5hZGRJdGVtcyB8fCB0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG5cbiAgICBpZiAoc2hvdWxkRGlzYWJsZSkge1xuICAgICAgdGhpcy5kaXNhYmxlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5pbml0aWFsaXNlZCA9IHRydWU7XG4gICAgdmFyIGNhbGxiYWNrT25Jbml0ID0gdGhpcy5jb25maWcuY2FsbGJhY2tPbkluaXQ7IC8vIFJ1biBjYWxsYmFjayBpZiBpdCBpcyBhIGZ1bmN0aW9uXG5cbiAgICBpZiAoY2FsbGJhY2tPbkluaXQgJiYgdHlwZW9mIGNhbGxiYWNrT25Jbml0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFja09uSW5pdC5jYWxsKHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uZGVzdHJveSA9IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgaWYgKCF0aGlzLmluaXRpYWxpc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMucGFzc2VkRWxlbWVudC5yZXZlYWwoKTtcbiAgICB0aGlzLmNvbnRhaW5lck91dGVyLnVud3JhcCh0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudCk7XG4gICAgdGhpcy5jbGVhclN0b3JlKCk7XG5cbiAgICBpZiAodGhpcy5faXNTZWxlY3RFbGVtZW50KSB7XG4gICAgICB0aGlzLnBhc3NlZEVsZW1lbnQub3B0aW9ucyA9IHRoaXMuX3ByZXNldE9wdGlvbnM7XG4gICAgfVxuXG4gICAgdGhpcy5fdGVtcGxhdGVzID0gbnVsbDtcbiAgICB0aGlzLmluaXRpYWxpc2VkID0gZmFsc2U7XG4gIH07XG5cbiAgX3Byb3RvLmVuYWJsZSA9IGZ1bmN0aW9uIGVuYWJsZSgpIHtcbiAgICBpZiAodGhpcy5wYXNzZWRFbGVtZW50LmlzRGlzYWJsZWQpIHtcbiAgICAgIHRoaXMucGFzc2VkRWxlbWVudC5lbmFibGUoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb250YWluZXJPdXRlci5pc0Rpc2FibGVkKSB7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICB0aGlzLmlucHV0LmVuYWJsZSgpO1xuICAgICAgdGhpcy5jb250YWluZXJPdXRlci5lbmFibGUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8uZGlzYWJsZSA9IGZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgaWYgKCF0aGlzLnBhc3NlZEVsZW1lbnQuaXNEaXNhYmxlZCkge1xuICAgICAgdGhpcy5wYXNzZWRFbGVtZW50LmRpc2FibGUoKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuY29udGFpbmVyT3V0ZXIuaXNEaXNhYmxlZCkge1xuICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgdGhpcy5pbnB1dC5kaXNhYmxlKCk7XG4gICAgICB0aGlzLmNvbnRhaW5lck91dGVyLmRpc2FibGUoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8uaGlnaGxpZ2h0SXRlbSA9IGZ1bmN0aW9uIGhpZ2hsaWdodEl0ZW0oaXRlbSwgcnVuRXZlbnQpIHtcbiAgICBpZiAocnVuRXZlbnQgPT09IHZvaWQgMCkge1xuICAgICAgcnVuRXZlbnQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmICghaXRlbSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdmFyIGlkID0gaXRlbS5pZCxcbiAgICAgICAgX2l0ZW0kZ3JvdXBJZCA9IGl0ZW0uZ3JvdXBJZCxcbiAgICAgICAgZ3JvdXBJZCA9IF9pdGVtJGdyb3VwSWQgPT09IHZvaWQgMCA/IC0xIDogX2l0ZW0kZ3JvdXBJZCxcbiAgICAgICAgX2l0ZW0kdmFsdWUgPSBpdGVtLnZhbHVlLFxuICAgICAgICB2YWx1ZSA9IF9pdGVtJHZhbHVlID09PSB2b2lkIDAgPyAnJyA6IF9pdGVtJHZhbHVlLFxuICAgICAgICBfaXRlbSRsYWJlbCA9IGl0ZW0ubGFiZWwsXG4gICAgICAgIGxhYmVsID0gX2l0ZW0kbGFiZWwgPT09IHZvaWQgMCA/ICcnIDogX2l0ZW0kbGFiZWw7XG4gICAgdmFyIGdyb3VwID0gZ3JvdXBJZCA+PSAwID8gdGhpcy5fc3RvcmUuZ2V0R3JvdXBCeUlkKGdyb3VwSWQpIDogbnVsbDtcblxuICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKGl0ZW1zX2hpZ2hsaWdodEl0ZW0oaWQsIHRydWUpKTtcblxuICAgIGlmIChydW5FdmVudCkge1xuICAgICAgdGhpcy5wYXNzZWRFbGVtZW50LnRyaWdnZXJFdmVudChFVkVOVFMuaGlnaGxpZ2h0SXRlbSwge1xuICAgICAgICBpZDogaWQsXG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBncm91cFZhbHVlOiBncm91cCAmJiBncm91cC52YWx1ZSA/IGdyb3VwLnZhbHVlIDogbnVsbFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnVuaGlnaGxpZ2h0SXRlbSA9IGZ1bmN0aW9uIHVuaGlnaGxpZ2h0SXRlbShpdGVtKSB7XG4gICAgaWYgKCFpdGVtKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICB2YXIgaWQgPSBpdGVtLmlkLFxuICAgICAgICBfaXRlbSRncm91cElkMiA9IGl0ZW0uZ3JvdXBJZCxcbiAgICAgICAgZ3JvdXBJZCA9IF9pdGVtJGdyb3VwSWQyID09PSB2b2lkIDAgPyAtMSA6IF9pdGVtJGdyb3VwSWQyLFxuICAgICAgICBfaXRlbSR2YWx1ZTIgPSBpdGVtLnZhbHVlLFxuICAgICAgICB2YWx1ZSA9IF9pdGVtJHZhbHVlMiA9PT0gdm9pZCAwID8gJycgOiBfaXRlbSR2YWx1ZTIsXG4gICAgICAgIF9pdGVtJGxhYmVsMiA9IGl0ZW0ubGFiZWwsXG4gICAgICAgIGxhYmVsID0gX2l0ZW0kbGFiZWwyID09PSB2b2lkIDAgPyAnJyA6IF9pdGVtJGxhYmVsMjtcbiAgICB2YXIgZ3JvdXAgPSBncm91cElkID49IDAgPyB0aGlzLl9zdG9yZS5nZXRHcm91cEJ5SWQoZ3JvdXBJZCkgOiBudWxsO1xuXG4gICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goaXRlbXNfaGlnaGxpZ2h0SXRlbShpZCwgZmFsc2UpKTtcblxuICAgIHRoaXMucGFzc2VkRWxlbWVudC50cmlnZ2VyRXZlbnQoRVZFTlRTLmhpZ2hsaWdodEl0ZW0sIHtcbiAgICAgIGlkOiBpZCxcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgIGdyb3VwVmFsdWU6IGdyb3VwICYmIGdyb3VwLnZhbHVlID8gZ3JvdXAudmFsdWUgOiBudWxsXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLmhpZ2hsaWdodEFsbCA9IGZ1bmN0aW9uIGhpZ2hsaWdodEFsbCgpIHtcbiAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgIHRoaXMuX3N0b3JlLml0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBfdGhpczIuaGlnaGxpZ2h0SXRlbShpdGVtKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by51bmhpZ2hsaWdodEFsbCA9IGZ1bmN0aW9uIHVuaGlnaGxpZ2h0QWxsKCkge1xuICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgdGhpcy5fc3RvcmUuaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIF90aGlzMy51bmhpZ2hsaWdodEl0ZW0oaXRlbSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlQWN0aXZlSXRlbXNCeVZhbHVlID0gZnVuY3Rpb24gcmVtb3ZlQWN0aXZlSXRlbXNCeVZhbHVlKHZhbHVlKSB7XG4gICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICB0aGlzLl9zdG9yZS5hY3RpdmVJdGVtcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLnZhbHVlID09PSB2YWx1ZTtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICByZXR1cm4gX3RoaXM0Ll9yZW1vdmVJdGVtKGl0ZW0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnJlbW92ZUFjdGl2ZUl0ZW1zID0gZnVuY3Rpb24gcmVtb3ZlQWN0aXZlSXRlbXMoZXhjbHVkZWRJZCkge1xuICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgdGhpcy5fc3RvcmUuYWN0aXZlSXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChfcmVmKSB7XG4gICAgICB2YXIgaWQgPSBfcmVmLmlkO1xuICAgICAgcmV0dXJuIGlkICE9PSBleGNsdWRlZElkO1xuICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHJldHVybiBfdGhpczUuX3JlbW92ZUl0ZW0oaXRlbSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8ucmVtb3ZlSGlnaGxpZ2h0ZWRJdGVtcyA9IGZ1bmN0aW9uIHJlbW92ZUhpZ2hsaWdodGVkSXRlbXMocnVuRXZlbnQpIHtcbiAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgIGlmIChydW5FdmVudCA9PT0gdm9pZCAwKSB7XG4gICAgICBydW5FdmVudCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHRoaXMuX3N0b3JlLmhpZ2hsaWdodGVkQWN0aXZlSXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgX3RoaXM2Ll9yZW1vdmVJdGVtKGl0ZW0pOyAvLyBJZiB0aGlzIGFjdGlvbiB3YXMgcGVyZm9ybWVkIGJ5IHRoZSB1c2VyXG4gICAgICAvLyB0cmlnZ2VyIHRoZSBldmVudFxuXG5cbiAgICAgIGlmIChydW5FdmVudCkge1xuICAgICAgICBfdGhpczYuX3RyaWdnZXJDaGFuZ2UoaXRlbS52YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8uc2hvd0Ryb3Bkb3duID0gZnVuY3Rpb24gc2hvd0Ryb3Bkb3duKHByZXZlbnRJbnB1dEZvY3VzKSB7XG4gICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICBpZiAodGhpcy5kcm9wZG93bi5pc0FjdGl2ZSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uICgpIHtcbiAgICAgIF90aGlzNy5kcm9wZG93bi5zaG93KCk7XG5cbiAgICAgIF90aGlzNy5jb250YWluZXJPdXRlci5vcGVuKF90aGlzNy5kcm9wZG93bi5kaXN0YW5jZUZyb21Ub3BXaW5kb3cpO1xuXG4gICAgICBpZiAoIXByZXZlbnRJbnB1dEZvY3VzICYmIF90aGlzNy5fY2FuU2VhcmNoKSB7XG4gICAgICAgIF90aGlzNy5pbnB1dC5mb2N1cygpO1xuICAgICAgfVxuXG4gICAgICBfdGhpczcucGFzc2VkRWxlbWVudC50cmlnZ2VyRXZlbnQoRVZFTlRTLnNob3dEcm9wZG93biwge30pO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by5oaWRlRHJvcGRvd24gPSBmdW5jdGlvbiBoaWRlRHJvcGRvd24ocHJldmVudElucHV0Qmx1cikge1xuICAgIHZhciBfdGhpczggPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLmRyb3Bkb3duLmlzQWN0aXZlKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXM4LmRyb3Bkb3duLmhpZGUoKTtcblxuICAgICAgX3RoaXM4LmNvbnRhaW5lck91dGVyLmNsb3NlKCk7XG5cbiAgICAgIGlmICghcHJldmVudElucHV0Qmx1ciAmJiBfdGhpczguX2NhblNlYXJjaCkge1xuICAgICAgICBfdGhpczguaW5wdXQucmVtb3ZlQWN0aXZlRGVzY2VuZGFudCgpO1xuXG4gICAgICAgIF90aGlzOC5pbnB1dC5ibHVyKCk7XG4gICAgICB9XG5cbiAgICAgIF90aGlzOC5wYXNzZWRFbGVtZW50LnRyaWdnZXJFdmVudChFVkVOVFMuaGlkZURyb3Bkb3duLCB7fSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUodmFsdWVPbmx5KSB7XG4gICAgaWYgKHZhbHVlT25seSA9PT0gdm9pZCAwKSB7XG4gICAgICB2YWx1ZU9ubHkgPSBmYWxzZTtcbiAgICB9XG5cbiAgICB2YXIgdmFsdWVzID0gdGhpcy5fc3RvcmUuYWN0aXZlSXRlbXMucmVkdWNlKGZ1bmN0aW9uIChzZWxlY3RlZEl0ZW1zLCBpdGVtKSB7XG4gICAgICB2YXIgaXRlbVZhbHVlID0gdmFsdWVPbmx5ID8gaXRlbS52YWx1ZSA6IGl0ZW07XG4gICAgICBzZWxlY3RlZEl0ZW1zLnB1c2goaXRlbVZhbHVlKTtcbiAgICAgIHJldHVybiBzZWxlY3RlZEl0ZW1zO1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQgPyB2YWx1ZXNbMF0gOiB2YWx1ZXM7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7c3RyaW5nW10gfCBpbXBvcnQoJy4uLy4uL3R5cGVzL2luZGV4JykuQ2hvaWNlcy5JdGVtW119IGl0ZW1zXG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLnNldFZhbHVlID0gZnVuY3Rpb24gc2V0VmFsdWUoaXRlbXMpIHtcbiAgICB2YXIgX3RoaXM5ID0gdGhpcztcblxuICAgIGlmICghdGhpcy5pbml0aWFsaXNlZCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBfdGhpczkuX3NldENob2ljZU9ySXRlbSh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLnNldENob2ljZUJ5VmFsdWUgPSBmdW5jdGlvbiBzZXRDaG9pY2VCeVZhbHVlKHZhbHVlKSB7XG4gICAgdmFyIF90aGlzMTAgPSB0aGlzO1xuXG4gICAgaWYgKCF0aGlzLmluaXRpYWxpc2VkIHx8IHRoaXMuX2lzVGV4dEVsZW1lbnQpIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gLy8gSWYgb25seSBvbmUgdmFsdWUgaGFzIGJlZW4gcGFzc2VkLCBjb252ZXJ0IHRvIGFycmF5XG5cblxuICAgIHZhciBjaG9pY2VWYWx1ZSA9IEFycmF5LmlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbdmFsdWVdOyAvLyBMb29wIHRocm91Z2ggZWFjaCB2YWx1ZSBhbmRcblxuICAgIGNob2ljZVZhbHVlLmZvckVhY2goZnVuY3Rpb24gKHZhbCkge1xuICAgICAgcmV0dXJuIF90aGlzMTAuX2ZpbmRBbmRTZWxlY3RDaG9pY2VCeVZhbHVlKHZhbCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cbiAgLyoqXG4gICAqIFNldCBjaG9pY2VzIG9mIHNlbGVjdCBpbnB1dCB2aWEgYW4gYXJyYXkgb2Ygb2JqZWN0cyAob3IgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFycmF5IG9mIG9iamVjdCBvciBwcm9taXNlIG9mIGl0KSxcbiAgICogYSB2YWx1ZSBmaWVsZCBuYW1lIGFuZCBhIGxhYmVsIGZpZWxkIG5hbWUuXG4gICAqIFRoaXMgYmVoYXZlcyB0aGUgc2FtZSBhcyBwYXNzaW5nIGl0ZW1zIHZpYSB0aGUgY2hvaWNlcyBvcHRpb24gYnV0IGNhbiBiZSBjYWxsZWQgYWZ0ZXIgaW5pdGlhbGlzaW5nIENob2ljZXMuXG4gICAqIFRoaXMgY2FuIGFsc28gYmUgdXNlZCB0byBhZGQgZ3JvdXBzIG9mIGNob2ljZXMgKHNlZSBleGFtcGxlIDIpOyBPcHRpb25hbGx5IHBhc3MgYSB0cnVlIGByZXBsYWNlQ2hvaWNlc2AgdmFsdWUgdG8gcmVtb3ZlIGFueSBleGlzdGluZyBjaG9pY2VzLlxuICAgKiBPcHRpb25hbGx5IHBhc3MgYSBgY3VzdG9tUHJvcGVydGllc2Agb2JqZWN0IHRvIGFkZCBhZGRpdGlvbmFsIGRhdGEgdG8geW91ciBjaG9pY2VzICh1c2VmdWwgd2hlbiBzZWFyY2hpbmcvZmlsdGVyaW5nIGV0YykuXG4gICAqXG4gICAqICoqSW5wdXQgdHlwZXMgYWZmZWN0ZWQ6Kiogc2VsZWN0LW9uZSwgc2VsZWN0LW11bHRpcGxlXG4gICAqXG4gICAqIEB0ZW1wbGF0ZSB7Q2hvaWNlW10gfCAoKGluc3RhbmNlOiBDaG9pY2VzKSA9PiBvYmplY3RbXSB8IFByb21pc2U8b2JqZWN0W10+KX0gVFxuICAgKiBAcGFyYW0ge1R9IFtjaG9pY2VzQXJyYXlPckZldGNoZXJdXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbdmFsdWUgPSAndmFsdWUnXSAtIG5hbWUgb2YgYHZhbHVlYCBmaWVsZFxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2xhYmVsID0gJ2xhYmVsJ10gLSBuYW1lIG9mICdsYWJlbCcgZmllbGRcbiAgICogQHBhcmFtIHtib29sZWFufSBbcmVwbGFjZUNob2ljZXMgPSBmYWxzZV0gLSB3aGV0aGVyIHRvIHJlcGxhY2Ugb2YgYWRkIGNob2ljZXNcbiAgICogQHJldHVybnMge3RoaXMgfCBQcm9taXNlPHRoaXM+fVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqc1xuICAgKiBjb25zdCBleGFtcGxlID0gbmV3IENob2ljZXMoZWxlbWVudCk7XG4gICAqXG4gICAqIGV4YW1wbGUuc2V0Q2hvaWNlcyhbXG4gICAqICAge3ZhbHVlOiAnT25lJywgbGFiZWw6ICdMYWJlbCBPbmUnLCBkaXNhYmxlZDogdHJ1ZX0sXG4gICAqICAge3ZhbHVlOiAnVHdvJywgbGFiZWw6ICdMYWJlbCBUd28nLCBzZWxlY3RlZDogdHJ1ZX0sXG4gICAqICAge3ZhbHVlOiAnVGhyZWUnLCBsYWJlbDogJ0xhYmVsIFRocmVlJ30sXG4gICAqIF0sICd2YWx1ZScsICdsYWJlbCcsIGZhbHNlKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGpzXG4gICAqIGNvbnN0IGV4YW1wbGUgPSBuZXcgQ2hvaWNlcyhlbGVtZW50KTtcbiAgICpcbiAgICogZXhhbXBsZS5zZXRDaG9pY2VzKGFzeW5jICgpID0+IHtcbiAgICogICB0cnkge1xuICAgKiAgICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgZmV0Y2goJy9pdGVtcycpO1xuICAgKiAgICAgIHJldHVybiBpdGVtcy5qc29uKClcbiAgICogICB9IGNhdGNoKGVycikge1xuICAgKiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKVxuICAgKiAgIH1cbiAgICogfSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqc1xuICAgKiBjb25zdCBleGFtcGxlID0gbmV3IENob2ljZXMoZWxlbWVudCk7XG4gICAqXG4gICAqIGV4YW1wbGUuc2V0Q2hvaWNlcyhbe1xuICAgKiAgIGxhYmVsOiAnR3JvdXAgb25lJyxcbiAgICogICBpZDogMSxcbiAgICogICBkaXNhYmxlZDogZmFsc2UsXG4gICAqICAgY2hvaWNlczogW1xuICAgKiAgICAge3ZhbHVlOiAnQ2hpbGQgT25lJywgbGFiZWw6ICdDaGlsZCBPbmUnLCBzZWxlY3RlZDogdHJ1ZX0sXG4gICAqICAgICB7dmFsdWU6ICdDaGlsZCBUd28nLCBsYWJlbDogJ0NoaWxkIFR3bycsICBkaXNhYmxlZDogdHJ1ZX0sXG4gICAqICAgICB7dmFsdWU6ICdDaGlsZCBUaHJlZScsIGxhYmVsOiAnQ2hpbGQgVGhyZWUnfSxcbiAgICogICBdXG4gICAqIH0sXG4gICAqIHtcbiAgICogICBsYWJlbDogJ0dyb3VwIHR3bycsXG4gICAqICAgaWQ6IDIsXG4gICAqICAgZGlzYWJsZWQ6IGZhbHNlLFxuICAgKiAgIGNob2ljZXM6IFtcbiAgICogICAgIHt2YWx1ZTogJ0NoaWxkIEZvdXInLCBsYWJlbDogJ0NoaWxkIEZvdXInLCBkaXNhYmxlZDogdHJ1ZX0sXG4gICAqICAgICB7dmFsdWU6ICdDaGlsZCBGaXZlJywgbGFiZWw6ICdDaGlsZCBGaXZlJ30sXG4gICAqICAgICB7dmFsdWU6ICdDaGlsZCBTaXgnLCBsYWJlbDogJ0NoaWxkIFNpeCcsIGN1c3RvbVByb3BlcnRpZXM6IHtcbiAgICogICAgICAgZGVzY3JpcHRpb246ICdDdXN0b20gZGVzY3JpcHRpb24gYWJvdXQgY2hpbGQgc2l4JyxcbiAgICogICAgICAgcmFuZG9tOiAnQW5vdGhlciByYW5kb20gY3VzdG9tIHByb3BlcnR5J1xuICAgKiAgICAgfX0sXG4gICAqICAgXVxuICAgKiB9XSwgJ3ZhbHVlJywgJ2xhYmVsJywgZmFsc2UpO1xuICAgKiBgYGBcbiAgICovXG4gIDtcblxuICBfcHJvdG8uc2V0Q2hvaWNlcyA9IGZ1bmN0aW9uIHNldENob2ljZXMoY2hvaWNlc0FycmF5T3JGZXRjaGVyLCB2YWx1ZSwgbGFiZWwsIHJlcGxhY2VDaG9pY2VzKSB7XG4gICAgdmFyIF90aGlzMTEgPSB0aGlzO1xuXG4gICAgaWYgKGNob2ljZXNBcnJheU9yRmV0Y2hlciA9PT0gdm9pZCAwKSB7XG4gICAgICBjaG9pY2VzQXJyYXlPckZldGNoZXIgPSBbXTtcbiAgICB9XG5cbiAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgdmFsdWUgPSAndmFsdWUnO1xuICAgIH1cblxuICAgIGlmIChsYWJlbCA9PT0gdm9pZCAwKSB7XG4gICAgICBsYWJlbCA9ICdsYWJlbCc7XG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VDaG9pY2VzID09PSB2b2lkIDApIHtcbiAgICAgIHJlcGxhY2VDaG9pY2VzID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmluaXRpYWxpc2VkKSB7XG4gICAgICB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJzZXRDaG9pY2VzIHdhcyBjYWxsZWQgb24gYSBub24taW5pdGlhbGl6ZWQgaW5zdGFuY2Ugb2YgQ2hvaWNlc1wiKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX2lzU2VsZWN0RWxlbWVudCkge1xuICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcInNldENob2ljZXMgY2FuJ3QgYmUgdXNlZCB3aXRoIElOUFVUIGJhc2VkIENob2ljZXNcIik7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycgfHwgIXZhbHVlKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwidmFsdWUgcGFyYW1ldGVyIG11c3QgYmUgYSBuYW1lIG9mICd2YWx1ZScgZmllbGQgaW4gcGFzc2VkIG9iamVjdHNcIik7XG4gICAgfSAvLyBDbGVhciBjaG9pY2VzIGlmIG5lZWRlZFxuXG5cbiAgICBpZiAocmVwbGFjZUNob2ljZXMpIHtcbiAgICAgIHRoaXMuY2xlYXJDaG9pY2VzKCk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBjaG9pY2VzQXJyYXlPckZldGNoZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIC8vIGl0J3MgYSBjaG9pY2VzIGZldGNoZXIgZnVuY3Rpb25cbiAgICAgIHZhciBmZXRjaGVyID0gY2hvaWNlc0FycmF5T3JGZXRjaGVyKHRoaXMpO1xuXG4gICAgICBpZiAodHlwZW9mIFByb21pc2UgPT09ICdmdW5jdGlvbicgJiYgZmV0Y2hlciBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgLy8gdGhhdCdzIGEgcHJvbWlzZVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGF0L2NvbXBhdFxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICByZXR1cm4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlc29sdmUpO1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMxMS5faGFuZGxlTG9hZGluZ1N0YXRlKHRydWUpO1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gZmV0Y2hlcjtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIHJldHVybiBfdGhpczExLnNldENob2ljZXMoZGF0YSwgdmFsdWUsIGxhYmVsLCByZXBsYWNlQ2hvaWNlcyk7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBpZiAoIV90aGlzMTEuY29uZmlnLnNpbGVudCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzMTEuX2hhbmRsZUxvYWRpbmdTdGF0ZShmYWxzZSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBfdGhpczExO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gZnVuY3Rpb24gcmV0dXJuZWQgc29tZXRoaW5nIGVsc2UgdGhhbiBwcm9taXNlLCBsZXQncyBjaGVjayBpZiBpdCdzIGFuIGFycmF5IG9mIGNob2ljZXNcblxuXG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZmV0Y2hlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIi5zZXRDaG9pY2VzIGZpcnN0IGFyZ3VtZW50IGZ1bmN0aW9uIG11c3QgcmV0dXJuIGVpdGhlciBhcnJheSBvZiBjaG9pY2VzIG9yIFByb21pc2UsIGdvdDogXCIgKyB0eXBlb2YgZmV0Y2hlcik7XG4gICAgICB9IC8vIHJlY3Vyc2lvbiB3aXRoIHJlc3VsdHMsIGl0J3Mgc3luYyBhbmQgY2hvaWNlcyB3ZXJlIGNsZWFyZWQgYWxyZWFkeVxuXG5cbiAgICAgIHJldHVybiB0aGlzLnNldENob2ljZXMoZmV0Y2hlciwgdmFsdWUsIGxhYmVsLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGNob2ljZXNBcnJheU9yRmV0Y2hlcikpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCIuc2V0Q2hvaWNlcyBtdXN0IGJlIGNhbGxlZCBlaXRoZXIgd2l0aCBhcnJheSBvZiBjaG9pY2VzIHdpdGggYSBmdW5jdGlvbiByZXN1bHRpbmcgaW50byBQcm9taXNlIG9mIGFycmF5IG9mIGNob2ljZXNcIik7XG4gICAgfVxuXG4gICAgdGhpcy5jb250YWluZXJPdXRlci5yZW1vdmVMb2FkaW5nU3RhdGUoKTtcblxuICAgIHRoaXMuX3N0YXJ0TG9hZGluZygpO1xuXG4gICAgY2hvaWNlc0FycmF5T3JGZXRjaGVyLmZvckVhY2goZnVuY3Rpb24gKGdyb3VwT3JDaG9pY2UpIHtcbiAgICAgIGlmIChncm91cE9yQ2hvaWNlLmNob2ljZXMpIHtcbiAgICAgICAgX3RoaXMxMS5fYWRkR3JvdXAoe1xuICAgICAgICAgIGlkOiBwYXJzZUludChncm91cE9yQ2hvaWNlLmlkLCAxMCkgfHwgbnVsbCxcbiAgICAgICAgICBncm91cDogZ3JvdXBPckNob2ljZSxcbiAgICAgICAgICB2YWx1ZUtleTogdmFsdWUsXG4gICAgICAgICAgbGFiZWxLZXk6IGxhYmVsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMxMS5fYWRkQ2hvaWNlKHtcbiAgICAgICAgICB2YWx1ZTogZ3JvdXBPckNob2ljZVt2YWx1ZV0sXG4gICAgICAgICAgbGFiZWw6IGdyb3VwT3JDaG9pY2VbbGFiZWxdLFxuICAgICAgICAgIGlzU2VsZWN0ZWQ6IGdyb3VwT3JDaG9pY2Uuc2VsZWN0ZWQsXG4gICAgICAgICAgaXNEaXNhYmxlZDogZ3JvdXBPckNob2ljZS5kaXNhYmxlZCxcbiAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBncm91cE9yQ2hvaWNlLmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6IGdyb3VwT3JDaG9pY2UucGxhY2Vob2xkZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zdG9wTG9hZGluZygpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLmNsZWFyQ2hvaWNlcyA9IGZ1bmN0aW9uIGNsZWFyQ2hvaWNlcygpIHtcbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChjaG9pY2VzX2NsZWFyQ2hvaWNlcygpKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by5jbGVhclN0b3JlID0gZnVuY3Rpb24gY2xlYXJTdG9yZSgpIHtcbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChjbGVhckFsbCgpKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIF9wcm90by5jbGVhcklucHV0ID0gZnVuY3Rpb24gY2xlYXJJbnB1dCgpIHtcbiAgICB2YXIgc2hvdWxkU2V0SW5wdXRXaWR0aCA9ICF0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQ7XG4gICAgdGhpcy5pbnB1dC5jbGVhcihzaG91bGRTZXRJbnB1dFdpZHRoKTtcblxuICAgIGlmICghdGhpcy5faXNUZXh0RWxlbWVudCAmJiB0aGlzLl9jYW5TZWFyY2gpIHtcbiAgICAgIHRoaXMuX2lzU2VhcmNoaW5nID0gZmFsc2U7XG5cbiAgICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKGNob2ljZXNfYWN0aXZhdGVDaG9pY2VzKHRydWUpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBfcHJvdG8uX3JlbmRlciA9IGZ1bmN0aW9uIF9yZW5kZXIoKSB7XG4gICAgaWYgKHRoaXMuX3N0b3JlLmlzTG9hZGluZygpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fY3VycmVudFN0YXRlID0gdGhpcy5fc3RvcmUuc3RhdGU7XG4gICAgdmFyIHN0YXRlQ2hhbmdlZCA9IHRoaXMuX2N1cnJlbnRTdGF0ZS5jaG9pY2VzICE9PSB0aGlzLl9wcmV2U3RhdGUuY2hvaWNlcyB8fCB0aGlzLl9jdXJyZW50U3RhdGUuZ3JvdXBzICE9PSB0aGlzLl9wcmV2U3RhdGUuZ3JvdXBzIHx8IHRoaXMuX2N1cnJlbnRTdGF0ZS5pdGVtcyAhPT0gdGhpcy5fcHJldlN0YXRlLml0ZW1zO1xuICAgIHZhciBzaG91bGRSZW5kZXJDaG9pY2VzID0gdGhpcy5faXNTZWxlY3RFbGVtZW50O1xuICAgIHZhciBzaG91bGRSZW5kZXJJdGVtcyA9IHRoaXMuX2N1cnJlbnRTdGF0ZS5pdGVtcyAhPT0gdGhpcy5fcHJldlN0YXRlLml0ZW1zO1xuXG4gICAgaWYgKCFzdGF0ZUNoYW5nZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoc2hvdWxkUmVuZGVyQ2hvaWNlcykge1xuICAgICAgdGhpcy5fcmVuZGVyQ2hvaWNlcygpO1xuICAgIH1cblxuICAgIGlmIChzaG91bGRSZW5kZXJJdGVtcykge1xuICAgICAgdGhpcy5fcmVuZGVySXRlbXMoKTtcbiAgICB9XG5cbiAgICB0aGlzLl9wcmV2U3RhdGUgPSB0aGlzLl9jdXJyZW50U3RhdGU7XG4gIH07XG5cbiAgX3Byb3RvLl9yZW5kZXJDaG9pY2VzID0gZnVuY3Rpb24gX3JlbmRlckNob2ljZXMoKSB7XG4gICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXG4gICAgdmFyIF90aGlzJF9zdG9yZSA9IHRoaXMuX3N0b3JlLFxuICAgICAgICBhY3RpdmVHcm91cHMgPSBfdGhpcyRfc3RvcmUuYWN0aXZlR3JvdXBzLFxuICAgICAgICBhY3RpdmVDaG9pY2VzID0gX3RoaXMkX3N0b3JlLmFjdGl2ZUNob2ljZXM7XG4gICAgdmFyIGNob2ljZUxpc3RGcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICB0aGlzLmNob2ljZUxpc3QuY2xlYXIoKTtcblxuICAgIGlmICh0aGlzLmNvbmZpZy5yZXNldFNjcm9sbFBvc2l0aW9uKSB7XG4gICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3RoaXMxMi5jaG9pY2VMaXN0LnNjcm9sbFRvVG9wKCk7XG4gICAgICB9KTtcbiAgICB9IC8vIElmIHdlIGhhdmUgZ3JvdXBlZCBvcHRpb25zXG5cblxuICAgIGlmIChhY3RpdmVHcm91cHMubGVuZ3RoID49IDEgJiYgIXRoaXMuX2lzU2VhcmNoaW5nKSB7XG4gICAgICAvLyBJZiB3ZSBoYXZlIGEgcGxhY2Vob2xkZXIgY2hvaWNlIGFsb25nIHdpdGggZ3JvdXBzXG4gICAgICB2YXIgYWN0aXZlUGxhY2Vob2xkZXJzID0gYWN0aXZlQ2hvaWNlcy5maWx0ZXIoZnVuY3Rpb24gKGFjdGl2ZUNob2ljZSkge1xuICAgICAgICByZXR1cm4gYWN0aXZlQ2hvaWNlLnBsYWNlaG9sZGVyID09PSB0cnVlICYmIGFjdGl2ZUNob2ljZS5ncm91cElkID09PSAtMTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoYWN0aXZlUGxhY2Vob2xkZXJzLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgIGNob2ljZUxpc3RGcmFnbWVudCA9IHRoaXMuX2NyZWF0ZUNob2ljZXNGcmFnbWVudChhY3RpdmVQbGFjZWhvbGRlcnMsIGNob2ljZUxpc3RGcmFnbWVudCk7XG4gICAgICB9XG5cbiAgICAgIGNob2ljZUxpc3RGcmFnbWVudCA9IHRoaXMuX2NyZWF0ZUdyb3Vwc0ZyYWdtZW50KGFjdGl2ZUdyb3VwcywgYWN0aXZlQ2hvaWNlcywgY2hvaWNlTGlzdEZyYWdtZW50KTtcbiAgICB9IGVsc2UgaWYgKGFjdGl2ZUNob2ljZXMubGVuZ3RoID49IDEpIHtcbiAgICAgIGNob2ljZUxpc3RGcmFnbWVudCA9IHRoaXMuX2NyZWF0ZUNob2ljZXNGcmFnbWVudChhY3RpdmVDaG9pY2VzLCBjaG9pY2VMaXN0RnJhZ21lbnQpO1xuICAgIH0gLy8gSWYgd2UgaGF2ZSBjaG9pY2VzIHRvIHNob3dcblxuXG4gICAgaWYgKGNob2ljZUxpc3RGcmFnbWVudC5jaGlsZE5vZGVzICYmIGNob2ljZUxpc3RGcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHZhciBhY3RpdmVJdGVtcyA9IHRoaXMuX3N0b3JlLmFjdGl2ZUl0ZW1zO1xuXG4gICAgICB2YXIgY2FuQWRkSXRlbSA9IHRoaXMuX2NhbkFkZEl0ZW0oYWN0aXZlSXRlbXMsIHRoaXMuaW5wdXQudmFsdWUpOyAvLyAuLi5hbmQgd2UgY2FuIHNlbGVjdCB0aGVtXG5cblxuICAgICAgaWYgKGNhbkFkZEl0ZW0ucmVzcG9uc2UpIHtcbiAgICAgICAgLy8gLi4uYXBwZW5kIHRoZW0gYW5kIGhpZ2hsaWdodCB0aGUgZmlyc3QgY2hvaWNlXG4gICAgICAgIHRoaXMuY2hvaWNlTGlzdC5hcHBlbmQoY2hvaWNlTGlzdEZyYWdtZW50KTtcblxuICAgICAgICB0aGlzLl9oaWdobGlnaHRDaG9pY2UoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIC4uLm90aGVyd2lzZSBzaG93IGEgbm90aWNlXG4gICAgICAgIHRoaXMuY2hvaWNlTGlzdC5hcHBlbmQodGhpcy5fZ2V0VGVtcGxhdGUoJ25vdGljZScsIGNhbkFkZEl0ZW0ubm90aWNlKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE90aGVyd2lzZSBzaG93IGEgbm90aWNlXG4gICAgICB2YXIgZHJvcGRvd25JdGVtO1xuICAgICAgdmFyIG5vdGljZTtcblxuICAgICAgaWYgKHRoaXMuX2lzU2VhcmNoaW5nKSB7XG4gICAgICAgIG5vdGljZSA9IHR5cGVvZiB0aGlzLmNvbmZpZy5ub1Jlc3VsdHNUZXh0ID09PSAnZnVuY3Rpb24nID8gdGhpcy5jb25maWcubm9SZXN1bHRzVGV4dCgpIDogdGhpcy5jb25maWcubm9SZXN1bHRzVGV4dDtcbiAgICAgICAgZHJvcGRvd25JdGVtID0gdGhpcy5fZ2V0VGVtcGxhdGUoJ25vdGljZScsIG5vdGljZSwgJ25vLXJlc3VsdHMnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5vdGljZSA9IHR5cGVvZiB0aGlzLmNvbmZpZy5ub0Nob2ljZXNUZXh0ID09PSAnZnVuY3Rpb24nID8gdGhpcy5jb25maWcubm9DaG9pY2VzVGV4dCgpIDogdGhpcy5jb25maWcubm9DaG9pY2VzVGV4dDtcbiAgICAgICAgZHJvcGRvd25JdGVtID0gdGhpcy5fZ2V0VGVtcGxhdGUoJ25vdGljZScsIG5vdGljZSwgJ25vLWNob2ljZXMnKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jaG9pY2VMaXN0LmFwcGVuZChkcm9wZG93bkl0ZW0pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX3JlbmRlckl0ZW1zID0gZnVuY3Rpb24gX3JlbmRlckl0ZW1zKCkge1xuICAgIHZhciBhY3RpdmVJdGVtcyA9IHRoaXMuX3N0b3JlLmFjdGl2ZUl0ZW1zIHx8IFtdO1xuICAgIHRoaXMuaXRlbUxpc3QuY2xlYXIoKTsgLy8gQ3JlYXRlIGEgZnJhZ21lbnQgdG8gc3RvcmUgb3VyIGxpc3QgaXRlbXNcbiAgICAvLyAoc28gd2UgZG9uJ3QgaGF2ZSB0byB1cGRhdGUgdGhlIERPTSBmb3IgZWFjaCBpdGVtKVxuXG4gICAgdmFyIGl0ZW1MaXN0RnJhZ21lbnQgPSB0aGlzLl9jcmVhdGVJdGVtc0ZyYWdtZW50KGFjdGl2ZUl0ZW1zKTsgLy8gSWYgd2UgaGF2ZSBpdGVtcyB0byBhZGQsIGFwcGVuZCB0aGVtXG5cblxuICAgIGlmIChpdGVtTGlzdEZyYWdtZW50LmNoaWxkTm9kZXMpIHtcbiAgICAgIHRoaXMuaXRlbUxpc3QuYXBwZW5kKGl0ZW1MaXN0RnJhZ21lbnQpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2NyZWF0ZUdyb3Vwc0ZyYWdtZW50ID0gZnVuY3Rpb24gX2NyZWF0ZUdyb3Vwc0ZyYWdtZW50KGdyb3VwcywgY2hvaWNlcywgZnJhZ21lbnQpIHtcbiAgICB2YXIgX3RoaXMxMyA9IHRoaXM7XG5cbiAgICBpZiAoZnJhZ21lbnQgPT09IHZvaWQgMCkge1xuICAgICAgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgfVxuXG4gICAgdmFyIGdldEdyb3VwQ2hvaWNlcyA9IGZ1bmN0aW9uIGdldEdyb3VwQ2hvaWNlcyhncm91cCkge1xuICAgICAgcmV0dXJuIGNob2ljZXMuZmlsdGVyKGZ1bmN0aW9uIChjaG9pY2UpIHtcbiAgICAgICAgaWYgKF90aGlzMTMuX2lzU2VsZWN0T25lRWxlbWVudCkge1xuICAgICAgICAgIHJldHVybiBjaG9pY2UuZ3JvdXBJZCA9PT0gZ3JvdXAuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY2hvaWNlLmdyb3VwSWQgPT09IGdyb3VwLmlkICYmIChfdGhpczEzLmNvbmZpZy5yZW5kZXJTZWxlY3RlZENob2ljZXMgPT09ICdhbHdheXMnIHx8ICFjaG9pY2Uuc2VsZWN0ZWQpO1xuICAgICAgfSk7XG4gICAgfTsgLy8gSWYgc29ydGluZyBpcyBlbmFibGVkLCBmaWx0ZXIgZ3JvdXBzXG5cblxuICAgIGlmICh0aGlzLmNvbmZpZy5zaG91bGRTb3J0KSB7XG4gICAgICBncm91cHMuc29ydCh0aGlzLmNvbmZpZy5zb3J0ZXIpO1xuICAgIH1cblxuICAgIGdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgdmFyIGdyb3VwQ2hvaWNlcyA9IGdldEdyb3VwQ2hvaWNlcyhncm91cCk7XG5cbiAgICAgIGlmIChncm91cENob2ljZXMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgdmFyIGRyb3Bkb3duR3JvdXAgPSBfdGhpczEzLl9nZXRUZW1wbGF0ZSgnY2hvaWNlR3JvdXAnLCBncm91cCk7XG5cbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZHJvcGRvd25Hcm91cCk7XG5cbiAgICAgICAgX3RoaXMxMy5fY3JlYXRlQ2hvaWNlc0ZyYWdtZW50KGdyb3VwQ2hvaWNlcywgZnJhZ21lbnQsIHRydWUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBmcmFnbWVudDtcbiAgfTtcblxuICBfcHJvdG8uX2NyZWF0ZUNob2ljZXNGcmFnbWVudCA9IGZ1bmN0aW9uIF9jcmVhdGVDaG9pY2VzRnJhZ21lbnQoY2hvaWNlcywgZnJhZ21lbnQsIHdpdGhpbkdyb3VwKSB7XG4gICAgdmFyIF90aGlzMTQgPSB0aGlzO1xuXG4gICAgaWYgKGZyYWdtZW50ID09PSB2b2lkIDApIHtcbiAgICAgIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIH1cblxuICAgIGlmICh3aXRoaW5Hcm91cCA9PT0gdm9pZCAwKSB7XG4gICAgICB3aXRoaW5Hcm91cCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIGZyYWdtZW50IHRvIHN0b3JlIG91ciBsaXN0IGl0ZW1zIChzbyB3ZSBkb24ndCBoYXZlIHRvIHVwZGF0ZSB0aGUgRE9NIGZvciBlYWNoIGl0ZW0pXG4gICAgdmFyIF90aGlzJGNvbmZpZyA9IHRoaXMuY29uZmlnLFxuICAgICAgICByZW5kZXJTZWxlY3RlZENob2ljZXMgPSBfdGhpcyRjb25maWcucmVuZGVyU2VsZWN0ZWRDaG9pY2VzLFxuICAgICAgICBzZWFyY2hSZXN1bHRMaW1pdCA9IF90aGlzJGNvbmZpZy5zZWFyY2hSZXN1bHRMaW1pdCxcbiAgICAgICAgcmVuZGVyQ2hvaWNlTGltaXQgPSBfdGhpcyRjb25maWcucmVuZGVyQ2hvaWNlTGltaXQ7XG4gICAgdmFyIGZpbHRlciA9IHRoaXMuX2lzU2VhcmNoaW5nID8gc29ydEJ5U2NvcmUgOiB0aGlzLmNvbmZpZy5zb3J0ZXI7XG5cbiAgICB2YXIgYXBwZW5kQ2hvaWNlID0gZnVuY3Rpb24gYXBwZW5kQ2hvaWNlKGNob2ljZSkge1xuICAgICAgdmFyIHNob3VsZFJlbmRlciA9IHJlbmRlclNlbGVjdGVkQ2hvaWNlcyA9PT0gJ2F1dG8nID8gX3RoaXMxNC5faXNTZWxlY3RPbmVFbGVtZW50IHx8ICFjaG9pY2Uuc2VsZWN0ZWQgOiB0cnVlO1xuXG4gICAgICBpZiAoc2hvdWxkUmVuZGVyKSB7XG4gICAgICAgIHZhciBkcm9wZG93bkl0ZW0gPSBfdGhpczE0Ll9nZXRUZW1wbGF0ZSgnY2hvaWNlJywgY2hvaWNlLCBfdGhpczE0LmNvbmZpZy5pdGVtU2VsZWN0VGV4dCk7XG5cbiAgICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoZHJvcGRvd25JdGVtKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIHJlbmRlcmVyYWJsZUNob2ljZXMgPSBjaG9pY2VzO1xuXG4gICAgaWYgKHJlbmRlclNlbGVjdGVkQ2hvaWNlcyA9PT0gJ2F1dG8nICYmICF0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHJlbmRlcmVyYWJsZUNob2ljZXMgPSBjaG9pY2VzLmZpbHRlcihmdW5jdGlvbiAoY2hvaWNlKSB7XG4gICAgICAgIHJldHVybiAhY2hvaWNlLnNlbGVjdGVkO1xuICAgICAgfSk7XG4gICAgfSAvLyBTcGxpdCBhcnJheSBpbnRvIHBsYWNlaG9sZGVycyBhbmQgXCJub3JtYWxcIiBjaG9pY2VzXG5cblxuICAgIHZhciBfcmVuZGVyZXJhYmxlQ2hvaWNlcyQgPSByZW5kZXJlcmFibGVDaG9pY2VzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBjaG9pY2UpIHtcbiAgICAgIGlmIChjaG9pY2UucGxhY2Vob2xkZXIpIHtcbiAgICAgICAgYWNjLnBsYWNlaG9sZGVyQ2hvaWNlcy5wdXNoKGNob2ljZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhY2Mubm9ybWFsQ2hvaWNlcy5wdXNoKGNob2ljZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge1xuICAgICAgcGxhY2Vob2xkZXJDaG9pY2VzOiBbXSxcbiAgICAgIG5vcm1hbENob2ljZXM6IFtdXG4gICAgfSksXG4gICAgICAgIHBsYWNlaG9sZGVyQ2hvaWNlcyA9IF9yZW5kZXJlcmFibGVDaG9pY2VzJC5wbGFjZWhvbGRlckNob2ljZXMsXG4gICAgICAgIG5vcm1hbENob2ljZXMgPSBfcmVuZGVyZXJhYmxlQ2hvaWNlcyQubm9ybWFsQ2hvaWNlczsgLy8gSWYgc29ydGluZyBpcyBlbmFibGVkIG9yIHRoZSB1c2VyIGlzIHNlYXJjaGluZywgZmlsdGVyIGNob2ljZXNcblxuXG4gICAgaWYgKHRoaXMuY29uZmlnLnNob3VsZFNvcnQgfHwgdGhpcy5faXNTZWFyY2hpbmcpIHtcbiAgICAgIG5vcm1hbENob2ljZXMuc29ydChmaWx0ZXIpO1xuICAgIH1cblxuICAgIHZhciBjaG9pY2VMaW1pdCA9IHJlbmRlcmVyYWJsZUNob2ljZXMubGVuZ3RoOyAvLyBQcmVwZW5kIHBsYWNlaG9sZWRlclxuXG4gICAgdmFyIHNvcnRlZENob2ljZXMgPSB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQgPyBbXS5jb25jYXQocGxhY2Vob2xkZXJDaG9pY2VzLCBub3JtYWxDaG9pY2VzKSA6IG5vcm1hbENob2ljZXM7XG5cbiAgICBpZiAodGhpcy5faXNTZWFyY2hpbmcpIHtcbiAgICAgIGNob2ljZUxpbWl0ID0gc2VhcmNoUmVzdWx0TGltaXQ7XG4gICAgfSBlbHNlIGlmIChyZW5kZXJDaG9pY2VMaW1pdCAmJiByZW5kZXJDaG9pY2VMaW1pdCA+IDAgJiYgIXdpdGhpbkdyb3VwKSB7XG4gICAgICBjaG9pY2VMaW1pdCA9IHJlbmRlckNob2ljZUxpbWl0O1xuICAgIH0gLy8gQWRkIGVhY2ggY2hvaWNlIHRvIGRyb3Bkb3duIHdpdGhpbiByYW5nZVxuXG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNob2ljZUxpbWl0OyBpICs9IDEpIHtcbiAgICAgIGlmIChzb3J0ZWRDaG9pY2VzW2ldKSB7XG4gICAgICAgIGFwcGVuZENob2ljZShzb3J0ZWRDaG9pY2VzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZnJhZ21lbnQ7XG4gIH07XG5cbiAgX3Byb3RvLl9jcmVhdGVJdGVtc0ZyYWdtZW50ID0gZnVuY3Rpb24gX2NyZWF0ZUl0ZW1zRnJhZ21lbnQoaXRlbXMsIGZyYWdtZW50KSB7XG4gICAgdmFyIF90aGlzMTUgPSB0aGlzO1xuXG4gICAgaWYgKGZyYWdtZW50ID09PSB2b2lkIDApIHtcbiAgICAgIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBmcmFnbWVudCB0byBhZGQgZWxlbWVudHMgdG9cbiAgICB2YXIgX3RoaXMkY29uZmlnMiA9IHRoaXMuY29uZmlnLFxuICAgICAgICBzaG91bGRTb3J0SXRlbXMgPSBfdGhpcyRjb25maWcyLnNob3VsZFNvcnRJdGVtcyxcbiAgICAgICAgc29ydGVyID0gX3RoaXMkY29uZmlnMi5zb3J0ZXIsXG4gICAgICAgIHJlbW92ZUl0ZW1CdXR0b24gPSBfdGhpcyRjb25maWcyLnJlbW92ZUl0ZW1CdXR0b247IC8vIElmIHNvcnRpbmcgaXMgZW5hYmxlZCwgZmlsdGVyIGl0ZW1zXG5cbiAgICBpZiAoc2hvdWxkU29ydEl0ZW1zICYmICF0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIGl0ZW1zLnNvcnQoc29ydGVyKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5faXNUZXh0RWxlbWVudCkge1xuICAgICAgLy8gVXBkYXRlIHRoZSB2YWx1ZSBvZiB0aGUgaGlkZGVuIGlucHV0XG4gICAgICB0aGlzLnBhc3NlZEVsZW1lbnQudmFsdWUgPSBpdGVtcztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVXBkYXRlIHRoZSBvcHRpb25zIG9mIHRoZSBoaWRkZW4gaW5wdXRcbiAgICAgIHRoaXMucGFzc2VkRWxlbWVudC5vcHRpb25zID0gaXRlbXM7XG4gICAgfVxuXG4gICAgdmFyIGFkZEl0ZW1Ub0ZyYWdtZW50ID0gZnVuY3Rpb24gYWRkSXRlbVRvRnJhZ21lbnQoaXRlbSkge1xuICAgICAgLy8gQ3JlYXRlIG5ldyBsaXN0IGVsZW1lbnRcbiAgICAgIHZhciBsaXN0SXRlbSA9IF90aGlzMTUuX2dldFRlbXBsYXRlKCdpdGVtJywgaXRlbSwgcmVtb3ZlSXRlbUJ1dHRvbik7IC8vIEFwcGVuZCBpdCB0byBsaXN0XG5cblxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQobGlzdEl0ZW0pO1xuICAgIH07IC8vIEFkZCBlYWNoIGxpc3QgaXRlbSB0byBsaXN0XG5cblxuICAgIGl0ZW1zLmZvckVhY2goYWRkSXRlbVRvRnJhZ21lbnQpO1xuICAgIHJldHVybiBmcmFnbWVudDtcbiAgfTtcblxuICBfcHJvdG8uX3RyaWdnZXJDaGFuZ2UgPSBmdW5jdGlvbiBfdHJpZ2dlckNoYW5nZSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5wYXNzZWRFbGVtZW50LnRyaWdnZXJFdmVudChFVkVOVFMuY2hhbmdlLCB7XG4gICAgICB2YWx1ZTogdmFsdWVcbiAgICB9KTtcbiAgfTtcblxuICBfcHJvdG8uX3NlbGVjdFBsYWNlaG9sZGVyQ2hvaWNlID0gZnVuY3Rpb24gX3NlbGVjdFBsYWNlaG9sZGVyQ2hvaWNlKCkge1xuICAgIHZhciBwbGFjZWhvbGRlckNob2ljZSA9IHRoaXMuX3N0b3JlLnBsYWNlaG9sZGVyQ2hvaWNlO1xuXG4gICAgaWYgKHBsYWNlaG9sZGVyQ2hvaWNlKSB7XG4gICAgICB0aGlzLl9hZGRJdGVtKHtcbiAgICAgICAgdmFsdWU6IHBsYWNlaG9sZGVyQ2hvaWNlLnZhbHVlLFxuICAgICAgICBsYWJlbDogcGxhY2Vob2xkZXJDaG9pY2UubGFiZWwsXG4gICAgICAgIGNob2ljZUlkOiBwbGFjZWhvbGRlckNob2ljZS5pZCxcbiAgICAgICAgZ3JvdXBJZDogcGxhY2Vob2xkZXJDaG9pY2UuZ3JvdXBJZCxcbiAgICAgICAgcGxhY2Vob2xkZXI6IHBsYWNlaG9sZGVyQ2hvaWNlLnBsYWNlaG9sZGVyXG4gICAgICB9KTtcblxuICAgICAgdGhpcy5fdHJpZ2dlckNoYW5nZShwbGFjZWhvbGRlckNob2ljZS52YWx1ZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5faGFuZGxlQnV0dG9uQWN0aW9uID0gZnVuY3Rpb24gX2hhbmRsZUJ1dHRvbkFjdGlvbihhY3RpdmVJdGVtcywgZWxlbWVudCkge1xuICAgIGlmICghYWN0aXZlSXRlbXMgfHwgIWVsZW1lbnQgfHwgIXRoaXMuY29uZmlnLnJlbW92ZUl0ZW1zIHx8ICF0aGlzLmNvbmZpZy5yZW1vdmVJdGVtQnV0dG9uKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGl0ZW1JZCA9IGVsZW1lbnQucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKTtcbiAgICB2YXIgaXRlbVRvUmVtb3ZlID0gYWN0aXZlSXRlbXMuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uaWQgPT09IHBhcnNlSW50KGl0ZW1JZCwgMTApO1xuICAgIH0pOyAvLyBSZW1vdmUgaXRlbSBhc3NvY2lhdGVkIHdpdGggYnV0dG9uXG5cbiAgICB0aGlzLl9yZW1vdmVJdGVtKGl0ZW1Ub1JlbW92ZSk7XG5cbiAgICB0aGlzLl90cmlnZ2VyQ2hhbmdlKGl0ZW1Ub1JlbW92ZS52YWx1ZSk7XG5cbiAgICBpZiAodGhpcy5faXNTZWxlY3RPbmVFbGVtZW50KSB7XG4gICAgICB0aGlzLl9zZWxlY3RQbGFjZWhvbGRlckNob2ljZSgpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2hhbmRsZUl0ZW1BY3Rpb24gPSBmdW5jdGlvbiBfaGFuZGxlSXRlbUFjdGlvbihhY3RpdmVJdGVtcywgZWxlbWVudCwgaGFzU2hpZnRLZXkpIHtcbiAgICB2YXIgX3RoaXMxNiA9IHRoaXM7XG5cbiAgICBpZiAoaGFzU2hpZnRLZXkgPT09IHZvaWQgMCkge1xuICAgICAgaGFzU2hpZnRLZXkgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoIWFjdGl2ZUl0ZW1zIHx8ICFlbGVtZW50IHx8ICF0aGlzLmNvbmZpZy5yZW1vdmVJdGVtcyB8fCB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgcGFzc2VkSWQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpOyAvLyBXZSBvbmx5IHdhbnQgdG8gc2VsZWN0IG9uZSBpdGVtIHdpdGggYSBjbGlja1xuICAgIC8vIHNvIHdlIGRlc2VsZWN0IGFueSBpdGVtcyB0aGF0IGFyZW4ndCB0aGUgdGFyZ2V0XG4gICAgLy8gdW5sZXNzIHNoaWZ0IGlzIGJlaW5nIHByZXNzZWRcblxuICAgIGFjdGl2ZUl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGlmIChpdGVtLmlkID09PSBwYXJzZUludChwYXNzZWRJZCwgMTApICYmICFpdGVtLmhpZ2hsaWdodGVkKSB7XG4gICAgICAgIF90aGlzMTYuaGlnaGxpZ2h0SXRlbShpdGVtKTtcbiAgICAgIH0gZWxzZSBpZiAoIWhhc1NoaWZ0S2V5ICYmIGl0ZW0uaGlnaGxpZ2h0ZWQpIHtcbiAgICAgICAgX3RoaXMxNi51bmhpZ2hsaWdodEl0ZW0oaXRlbSk7XG4gICAgICB9XG4gICAgfSk7IC8vIEZvY3VzIGlucHV0IGFzIHdpdGhvdXQgZm9jdXMsIGEgdXNlciBjYW5ub3QgZG8gYW55dGhpbmcgd2l0aCBhXG4gICAgLy8gaGlnaGxpZ2h0ZWQgaXRlbVxuXG4gICAgdGhpcy5pbnB1dC5mb2N1cygpO1xuICB9O1xuXG4gIF9wcm90by5faGFuZGxlQ2hvaWNlQWN0aW9uID0gZnVuY3Rpb24gX2hhbmRsZUNob2ljZUFjdGlvbihhY3RpdmVJdGVtcywgZWxlbWVudCkge1xuICAgIGlmICghYWN0aXZlSXRlbXMgfHwgIWVsZW1lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIElmIHdlIGFyZSBjbGlja2luZyBvbiBhbiBvcHRpb25cblxuXG4gICAgdmFyIGlkID0gZWxlbWVudC5kYXRhc2V0LmlkO1xuXG4gICAgdmFyIGNob2ljZSA9IHRoaXMuX3N0b3JlLmdldENob2ljZUJ5SWQoaWQpO1xuXG4gICAgaWYgKCFjaG9pY2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgcGFzc2VkS2V5Q29kZSA9IGFjdGl2ZUl0ZW1zWzBdICYmIGFjdGl2ZUl0ZW1zWzBdLmtleUNvZGUgPyBhY3RpdmVJdGVtc1swXS5rZXlDb2RlIDogbnVsbDtcbiAgICB2YXIgaGFzQWN0aXZlRHJvcGRvd24gPSB0aGlzLmRyb3Bkb3duLmlzQWN0aXZlOyAvLyBVcGRhdGUgY2hvaWNlIGtleUNvZGVcblxuICAgIGNob2ljZS5rZXlDb2RlID0gcGFzc2VkS2V5Q29kZTtcbiAgICB0aGlzLnBhc3NlZEVsZW1lbnQudHJpZ2dlckV2ZW50KEVWRU5UUy5jaG9pY2UsIHtcbiAgICAgIGNob2ljZTogY2hvaWNlXG4gICAgfSk7XG5cbiAgICBpZiAoIWNob2ljZS5zZWxlY3RlZCAmJiAhY2hvaWNlLmRpc2FibGVkKSB7XG4gICAgICB2YXIgY2FuQWRkSXRlbSA9IHRoaXMuX2NhbkFkZEl0ZW0oYWN0aXZlSXRlbXMsIGNob2ljZS52YWx1ZSk7XG5cbiAgICAgIGlmIChjYW5BZGRJdGVtLnJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuX2FkZEl0ZW0oe1xuICAgICAgICAgIHZhbHVlOiBjaG9pY2UudmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGNob2ljZS5sYWJlbCxcbiAgICAgICAgICBjaG9pY2VJZDogY2hvaWNlLmlkLFxuICAgICAgICAgIGdyb3VwSWQ6IGNob2ljZS5ncm91cElkLFxuICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGNob2ljZS5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgICAgIHBsYWNlaG9sZGVyOiBjaG9pY2UucGxhY2Vob2xkZXIsXG4gICAgICAgICAga2V5Q29kZTogY2hvaWNlLmtleUNvZGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fdHJpZ2dlckNoYW5nZShjaG9pY2UudmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY2xlYXJJbnB1dCgpOyAvLyBXZSB3YW50IHRvIGNsb3NlIHRoZSBkcm9wZG93biBpZiB3ZSBhcmUgZGVhbGluZyB3aXRoIGEgc2luZ2xlIHNlbGVjdCBib3hcblxuICAgIGlmIChoYXNBY3RpdmVEcm9wZG93biAmJiB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuaGlkZURyb3Bkb3duKHRydWUpO1xuICAgICAgdGhpcy5jb250YWluZXJPdXRlci5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2hhbmRsZUJhY2tzcGFjZSA9IGZ1bmN0aW9uIF9oYW5kbGVCYWNrc3BhY2UoYWN0aXZlSXRlbXMpIHtcbiAgICBpZiAoIXRoaXMuY29uZmlnLnJlbW92ZUl0ZW1zIHx8ICFhY3RpdmVJdGVtcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBsYXN0SXRlbSA9IGFjdGl2ZUl0ZW1zW2FjdGl2ZUl0ZW1zLmxlbmd0aCAtIDFdO1xuICAgIHZhciBoYXNIaWdobGlnaHRlZEl0ZW1zID0gYWN0aXZlSXRlbXMuc29tZShmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgcmV0dXJuIGl0ZW0uaGlnaGxpZ2h0ZWQ7XG4gICAgfSk7IC8vIElmIGVkaXRpbmcgdGhlIGxhc3QgaXRlbSBpcyBhbGxvd2VkIGFuZCB0aGVyZSBhcmUgbm90IG90aGVyIHNlbGVjdGVkIGl0ZW1zLFxuICAgIC8vIHdlIGNhbiBlZGl0IHRoZSBpdGVtIHZhbHVlLiBPdGhlcndpc2UgaWYgd2UgY2FuIHJlbW92ZSBpdGVtcywgcmVtb3ZlIGFsbCBzZWxlY3RlZCBpdGVtc1xuXG4gICAgaWYgKHRoaXMuY29uZmlnLmVkaXRJdGVtcyAmJiAhaGFzSGlnaGxpZ2h0ZWRJdGVtcyAmJiBsYXN0SXRlbSkge1xuICAgICAgdGhpcy5pbnB1dC52YWx1ZSA9IGxhc3RJdGVtLnZhbHVlO1xuICAgICAgdGhpcy5pbnB1dC5zZXRXaWR0aCgpO1xuXG4gICAgICB0aGlzLl9yZW1vdmVJdGVtKGxhc3RJdGVtKTtcblxuICAgICAgdGhpcy5fdHJpZ2dlckNoYW5nZShsYXN0SXRlbS52YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghaGFzSGlnaGxpZ2h0ZWRJdGVtcykge1xuICAgICAgICAvLyBIaWdobGlnaHQgbGFzdCBpdGVtIGlmIG5vbmUgYWxyZWFkeSBoaWdobGlnaHRlZFxuICAgICAgICB0aGlzLmhpZ2hsaWdodEl0ZW0obGFzdEl0ZW0sIGZhbHNlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5yZW1vdmVIaWdobGlnaHRlZEl0ZW1zKHRydWUpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX3N0YXJ0TG9hZGluZyA9IGZ1bmN0aW9uIF9zdGFydExvYWRpbmcoKSB7XG4gICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goc2V0SXNMb2FkaW5nKHRydWUpKTtcbiAgfTtcblxuICBfcHJvdG8uX3N0b3BMb2FkaW5nID0gZnVuY3Rpb24gX3N0b3BMb2FkaW5nKCkge1xuICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKHNldElzTG9hZGluZyhmYWxzZSkpO1xuICB9O1xuXG4gIF9wcm90by5faGFuZGxlTG9hZGluZ1N0YXRlID0gZnVuY3Rpb24gX2hhbmRsZUxvYWRpbmdTdGF0ZShzZXRMb2FkaW5nKSB7XG4gICAgaWYgKHNldExvYWRpbmcgPT09IHZvaWQgMCkge1xuICAgICAgc2V0TG9hZGluZyA9IHRydWU7XG4gICAgfVxuXG4gICAgdmFyIHBsYWNlaG9sZGVySXRlbSA9IHRoaXMuaXRlbUxpc3QuZ2V0Q2hpbGQoXCIuXCIgKyB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLnBsYWNlaG9sZGVyKTtcblxuICAgIGlmIChzZXRMb2FkaW5nKSB7XG4gICAgICB0aGlzLmRpc2FibGUoKTtcbiAgICAgIHRoaXMuY29udGFpbmVyT3V0ZXIuYWRkTG9hZGluZ1N0YXRlKCk7XG5cbiAgICAgIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFwbGFjZWhvbGRlckl0ZW0pIHtcbiAgICAgICAgICBwbGFjZWhvbGRlckl0ZW0gPSB0aGlzLl9nZXRUZW1wbGF0ZSgncGxhY2Vob2xkZXInLCB0aGlzLmNvbmZpZy5sb2FkaW5nVGV4dCk7XG4gICAgICAgICAgdGhpcy5pdGVtTGlzdC5hcHBlbmQocGxhY2Vob2xkZXJJdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBwbGFjZWhvbGRlckl0ZW0uaW5uZXJIVE1MID0gdGhpcy5jb25maWcubG9hZGluZ1RleHQ7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaW5wdXQucGxhY2Vob2xkZXIgPSB0aGlzLmNvbmZpZy5sb2FkaW5nVGV4dDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmFibGUoKTtcbiAgICAgIHRoaXMuY29udGFpbmVyT3V0ZXIucmVtb3ZlTG9hZGluZ1N0YXRlKCk7XG5cbiAgICAgIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgICAgcGxhY2Vob2xkZXJJdGVtLmlubmVySFRNTCA9IHRoaXMuX3BsYWNlaG9sZGVyVmFsdWUgfHwgJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmlucHV0LnBsYWNlaG9sZGVyID0gdGhpcy5fcGxhY2Vob2xkZXJWYWx1ZSB8fCAnJztcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9oYW5kbGVTZWFyY2ggPSBmdW5jdGlvbiBfaGFuZGxlU2VhcmNoKHZhbHVlKSB7XG4gICAgaWYgKCF2YWx1ZSB8fCAhdGhpcy5pbnB1dC5pc0ZvY3Vzc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGNob2ljZXMgPSB0aGlzLl9zdG9yZS5jaG9pY2VzO1xuICAgIHZhciBfdGhpcyRjb25maWczID0gdGhpcy5jb25maWcsXG4gICAgICAgIHNlYXJjaEZsb29yID0gX3RoaXMkY29uZmlnMy5zZWFyY2hGbG9vcixcbiAgICAgICAgc2VhcmNoQ2hvaWNlcyA9IF90aGlzJGNvbmZpZzMuc2VhcmNoQ2hvaWNlcztcbiAgICB2YXIgaGFzVW5hY3RpdmVDaG9pY2VzID0gY2hvaWNlcy5zb21lKGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgIHJldHVybiAhb3B0aW9uLmFjdGl2ZTtcbiAgICB9KTsgLy8gQ2hlY2sgdGhhdCB3ZSBoYXZlIGEgdmFsdWUgdG8gc2VhcmNoIGFuZCB0aGUgaW5wdXQgd2FzIGFuIGFscGhhbnVtZXJpYyBjaGFyYWN0ZXJcblxuICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPj0gc2VhcmNoRmxvb3IpIHtcbiAgICAgIHZhciByZXN1bHRDb3VudCA9IHNlYXJjaENob2ljZXMgPyB0aGlzLl9zZWFyY2hDaG9pY2VzKHZhbHVlKSA6IDA7IC8vIFRyaWdnZXIgc2VhcmNoIGV2ZW50XG5cbiAgICAgIHRoaXMucGFzc2VkRWxlbWVudC50cmlnZ2VyRXZlbnQoRVZFTlRTLnNlYXJjaCwge1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIHJlc3VsdENvdW50OiByZXN1bHRDb3VudFxuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChoYXNVbmFjdGl2ZUNob2ljZXMpIHtcbiAgICAgIC8vIE90aGVyd2lzZSByZXNldCBjaG9pY2VzIHRvIGFjdGl2ZVxuICAgICAgdGhpcy5faXNTZWFyY2hpbmcgPSBmYWxzZTtcblxuICAgICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goY2hvaWNlc19hY3RpdmF0ZUNob2ljZXModHJ1ZSkpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2NhbkFkZEl0ZW0gPSBmdW5jdGlvbiBfY2FuQWRkSXRlbShhY3RpdmVJdGVtcywgdmFsdWUpIHtcbiAgICB2YXIgY2FuQWRkSXRlbSA9IHRydWU7XG4gICAgdmFyIG5vdGljZSA9IHR5cGVvZiB0aGlzLmNvbmZpZy5hZGRJdGVtVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMuY29uZmlnLmFkZEl0ZW1UZXh0KHZhbHVlKSA6IHRoaXMuY29uZmlnLmFkZEl0ZW1UZXh0O1xuXG4gICAgaWYgKCF0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHZhciBpc0R1cGxpY2F0ZVZhbHVlID0gZXhpc3RzSW5BcnJheShhY3RpdmVJdGVtcywgdmFsdWUpO1xuXG4gICAgICBpZiAodGhpcy5jb25maWcubWF4SXRlbUNvdW50ID4gMCAmJiB0aGlzLmNvbmZpZy5tYXhJdGVtQ291bnQgPD0gYWN0aXZlSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGEgbWF4IGVudHJ5IGxpbWl0IGFuZCB3ZSBoYXZlIHJlYWNoZWQgdGhhdCBsaW1pdFxuICAgICAgICAvLyBkb24ndCB1cGRhdGVcbiAgICAgICAgY2FuQWRkSXRlbSA9IGZhbHNlO1xuICAgICAgICBub3RpY2UgPSB0eXBlb2YgdGhpcy5jb25maWcubWF4SXRlbVRleHQgPT09ICdmdW5jdGlvbicgPyB0aGlzLmNvbmZpZy5tYXhJdGVtVGV4dCh0aGlzLmNvbmZpZy5tYXhJdGVtQ291bnQpIDogdGhpcy5jb25maWcubWF4SXRlbVRleHQ7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5jb25maWcuZHVwbGljYXRlSXRlbXNBbGxvd2VkICYmIGlzRHVwbGljYXRlVmFsdWUgJiYgY2FuQWRkSXRlbSkge1xuICAgICAgICBjYW5BZGRJdGVtID0gZmFsc2U7XG4gICAgICAgIG5vdGljZSA9IHR5cGVvZiB0aGlzLmNvbmZpZy51bmlxdWVJdGVtVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMuY29uZmlnLnVuaXF1ZUl0ZW1UZXh0KHZhbHVlKSA6IHRoaXMuY29uZmlnLnVuaXF1ZUl0ZW1UZXh0O1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5faXNUZXh0RWxlbWVudCAmJiB0aGlzLmNvbmZpZy5hZGRJdGVtcyAmJiBjYW5BZGRJdGVtICYmIHR5cGVvZiB0aGlzLmNvbmZpZy5hZGRJdGVtRmlsdGVyID09PSAnZnVuY3Rpb24nICYmICF0aGlzLmNvbmZpZy5hZGRJdGVtRmlsdGVyKHZhbHVlKSkge1xuICAgICAgICBjYW5BZGRJdGVtID0gZmFsc2U7XG4gICAgICAgIG5vdGljZSA9IHR5cGVvZiB0aGlzLmNvbmZpZy5jdXN0b21BZGRJdGVtVGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMuY29uZmlnLmN1c3RvbUFkZEl0ZW1UZXh0KHZhbHVlKSA6IHRoaXMuY29uZmlnLmN1c3RvbUFkZEl0ZW1UZXh0O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICByZXNwb25zZTogY2FuQWRkSXRlbSxcbiAgICAgIG5vdGljZTogbm90aWNlXG4gICAgfTtcbiAgfTtcblxuICBfcHJvdG8uX3NlYXJjaENob2ljZXMgPSBmdW5jdGlvbiBfc2VhcmNoQ2hvaWNlcyh2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgPyB2YWx1ZS50cmltKCkgOiB2YWx1ZTtcbiAgICB2YXIgY3VycmVudFZhbHVlID0gdHlwZW9mIHRoaXMuX2N1cnJlbnRWYWx1ZSA9PT0gJ3N0cmluZycgPyB0aGlzLl9jdXJyZW50VmFsdWUudHJpbSgpIDogdGhpcy5fY3VycmVudFZhbHVlO1xuXG4gICAgaWYgKG5ld1ZhbHVlLmxlbmd0aCA8IDEgJiYgbmV3VmFsdWUgPT09IGN1cnJlbnRWYWx1ZSArIFwiIFwiKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9IC8vIElmIG5ldyB2YWx1ZSBtYXRjaGVzIHRoZSBkZXNpcmVkIGxlbmd0aCBhbmQgaXMgbm90IHRoZSBzYW1lIGFzIHRoZSBjdXJyZW50IHZhbHVlIHdpdGggYSBzcGFjZVxuXG5cbiAgICB2YXIgaGF5c3RhY2sgPSB0aGlzLl9zdG9yZS5zZWFyY2hhYmxlQ2hvaWNlcztcbiAgICB2YXIgbmVlZGxlID0gbmV3VmFsdWU7XG4gICAgdmFyIGtleXMgPSBbXS5jb25jYXQodGhpcy5jb25maWcuc2VhcmNoRmllbGRzKTtcbiAgICB2YXIgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24odGhpcy5jb25maWcuZnVzZU9wdGlvbnMsIHtcbiAgICAgIGtleXM6IGtleXNcbiAgICB9KTtcbiAgICB2YXIgZnVzZSA9IG5ldyBmdXNlX2RlZmF1bHQuYShoYXlzdGFjaywgb3B0aW9ucyk7XG4gICAgdmFyIHJlc3VsdHMgPSBmdXNlLnNlYXJjaChuZWVkbGUpO1xuICAgIHRoaXMuX2N1cnJlbnRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgIHRoaXMuX2hpZ2hsaWdodFBvc2l0aW9uID0gMDtcbiAgICB0aGlzLl9pc1NlYXJjaGluZyA9IHRydWU7XG5cbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChjaG9pY2VzX2ZpbHRlckNob2ljZXMocmVzdWx0cykpO1xuXG4gICAgcmV0dXJuIHJlc3VsdHMubGVuZ3RoO1xuICB9O1xuXG4gIF9wcm90by5fYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdmFyIF9kb2N1bWVudCA9IGRvY3VtZW50LFxuICAgICAgICBkb2N1bWVudEVsZW1lbnQgPSBfZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50OyAvLyBjYXB0dXJlIGV2ZW50cyAtIGNhbiBjYW5jZWwgZXZlbnQgcHJvY2Vzc2luZyBvciBwcm9wYWdhdGlvblxuXG4gICAgZG9jdW1lbnRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5fb25Ub3VjaEVuZCwgdHJ1ZSk7XG4gICAgdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIHRydWUpO1xuICAgIHRoaXMuY29udGFpbmVyT3V0ZXIuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9vbk1vdXNlRG93biwgdHJ1ZSk7IC8vIHBhc3NpdmUgZXZlbnRzIC0gZG9lc24ndCBjYWxsIGBwcmV2ZW50RGVmYXVsdGAgb3IgYHN0b3BQcm9wYWdhdGlvbmBcblxuICAgIGRvY3VtZW50RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uQ2xpY2ssIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICBkb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5fb25Ub3VjaE1vdmUsIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcbiAgICB0aGlzLmRyb3Bkb3duLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5fb25Nb3VzZU92ZXIsIHtcbiAgICAgIHBhc3NpdmU6IHRydWVcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyT3V0ZXIuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXMsIHtcbiAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgICB0aGlzLmNvbnRhaW5lck91dGVyLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1ciwge1xuICAgICAgICBwYXNzaXZlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICB0aGlzLmlucHV0LmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9vbktleVVwLCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG4gICAgdGhpcy5pbnB1dC5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cywge1xuICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuaW5wdXQuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyLCB7XG4gICAgICBwYXNzaXZlOiB0cnVlXG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5pbnB1dC5lbGVtZW50LmZvcm0pIHtcbiAgICAgIHRoaXMuaW5wdXQuZWxlbWVudC5mb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2V0JywgdGhpcy5fb25Gb3JtUmVzZXQsIHtcbiAgICAgICAgcGFzc2l2ZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5pbnB1dC5hZGRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIF9wcm90by5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdmFyIF9kb2N1bWVudDIgPSBkb2N1bWVudCxcbiAgICAgICAgZG9jdW1lbnRFbGVtZW50ID0gX2RvY3VtZW50Mi5kb2N1bWVudEVsZW1lbnQ7XG4gICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5fb25Ub3VjaEVuZCwgdHJ1ZSk7XG4gICAgdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleURvd24sIHRydWUpO1xuICAgIHRoaXMuY29udGFpbmVyT3V0ZXIuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9vbk1vdXNlRG93biwgdHJ1ZSk7XG4gICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGljayk7XG4gICAgZG9jdW1lbnRFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHRoaXMuX29uVG91Y2hNb3ZlKTtcbiAgICB0aGlzLmRyb3Bkb3duLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VvdmVyJywgdGhpcy5fb25Nb3VzZU92ZXIpO1xuXG4gICAgaWYgKHRoaXMuX2lzU2VsZWN0T25lRWxlbWVudCkge1xuICAgICAgdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cyk7XG4gICAgICB0aGlzLmNvbnRhaW5lck91dGVyLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1cik7XG4gICAgfVxuXG4gICAgdGhpcy5pbnB1dC5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5fb25LZXlVcCk7XG4gICAgdGhpcy5pbnB1dC5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5fb25Gb2N1cyk7XG4gICAgdGhpcy5pbnB1dC5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXIpO1xuXG4gICAgaWYgKHRoaXMuaW5wdXQuZWxlbWVudC5mb3JtKSB7XG4gICAgICB0aGlzLmlucHV0LmVsZW1lbnQuZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNldCcsIHRoaXMuX29uRm9ybVJlc2V0KTtcbiAgICB9XG5cbiAgICB0aGlzLmlucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZlbnRcbiAgICovXG4gIDtcblxuICBfcHJvdG8uX29uS2V5RG93biA9IGZ1bmN0aW9uIF9vbktleURvd24oZXZlbnQpIHtcbiAgICB2YXIgX2tleURvd25BY3Rpb25zO1xuXG4gICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCxcbiAgICAgICAga2V5Q29kZSA9IGV2ZW50LmtleUNvZGUsXG4gICAgICAgIGN0cmxLZXkgPSBldmVudC5jdHJsS2V5LFxuICAgICAgICBtZXRhS2V5ID0gZXZlbnQubWV0YUtleTtcbiAgICB2YXIgYWN0aXZlSXRlbXMgPSB0aGlzLl9zdG9yZS5hY3RpdmVJdGVtcztcbiAgICB2YXIgaGFzRm9jdXNlZElucHV0ID0gdGhpcy5pbnB1dC5pc0ZvY3Vzc2VkO1xuICAgIHZhciBoYXNBY3RpdmVEcm9wZG93biA9IHRoaXMuZHJvcGRvd24uaXNBY3RpdmU7XG4gICAgdmFyIGhhc0l0ZW1zID0gdGhpcy5pdGVtTGlzdC5oYXNDaGlsZHJlbigpO1xuICAgIHZhciBrZXlTdHJpbmcgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGtleUNvZGUpO1xuICAgIHZhciBCQUNLX0tFWSA9IEtFWV9DT0RFUy5CQUNLX0tFWSxcbiAgICAgICAgREVMRVRFX0tFWSA9IEtFWV9DT0RFUy5ERUxFVEVfS0VZLFxuICAgICAgICBFTlRFUl9LRVkgPSBLRVlfQ09ERVMuRU5URVJfS0VZLFxuICAgICAgICBBX0tFWSA9IEtFWV9DT0RFUy5BX0tFWSxcbiAgICAgICAgRVNDX0tFWSA9IEtFWV9DT0RFUy5FU0NfS0VZLFxuICAgICAgICBVUF9LRVkgPSBLRVlfQ09ERVMuVVBfS0VZLFxuICAgICAgICBET1dOX0tFWSA9IEtFWV9DT0RFUy5ET1dOX0tFWSxcbiAgICAgICAgUEFHRV9VUF9LRVkgPSBLRVlfQ09ERVMuUEFHRV9VUF9LRVksXG4gICAgICAgIFBBR0VfRE9XTl9LRVkgPSBLRVlfQ09ERVMuUEFHRV9ET1dOX0tFWTtcbiAgICB2YXIgaGFzQ3RybERvd25LZXlQcmVzc2VkID0gY3RybEtleSB8fCBtZXRhS2V5OyAvLyBJZiBhIHVzZXIgaXMgdHlwaW5nIGFuZCB0aGUgZHJvcGRvd24gaXMgbm90IGFjdGl2ZVxuXG4gICAgaWYgKCF0aGlzLl9pc1RleHRFbGVtZW50ICYmIC9bYS16QS1aMC05LV8gXS8udGVzdChrZXlTdHJpbmcpKSB7XG4gICAgICB0aGlzLnNob3dEcm9wZG93bigpO1xuICAgIH0gLy8gTWFwIGtleXMgdG8ga2V5IGFjdGlvbnNcblxuXG4gICAgdmFyIGtleURvd25BY3Rpb25zID0gKF9rZXlEb3duQWN0aW9ucyA9IHt9LCBfa2V5RG93bkFjdGlvbnNbQV9LRVldID0gdGhpcy5fb25BS2V5LCBfa2V5RG93bkFjdGlvbnNbRU5URVJfS0VZXSA9IHRoaXMuX29uRW50ZXJLZXksIF9rZXlEb3duQWN0aW9uc1tFU0NfS0VZXSA9IHRoaXMuX29uRXNjYXBlS2V5LCBfa2V5RG93bkFjdGlvbnNbVVBfS0VZXSA9IHRoaXMuX29uRGlyZWN0aW9uS2V5LCBfa2V5RG93bkFjdGlvbnNbUEFHRV9VUF9LRVldID0gdGhpcy5fb25EaXJlY3Rpb25LZXksIF9rZXlEb3duQWN0aW9uc1tET1dOX0tFWV0gPSB0aGlzLl9vbkRpcmVjdGlvbktleSwgX2tleURvd25BY3Rpb25zW1BBR0VfRE9XTl9LRVldID0gdGhpcy5fb25EaXJlY3Rpb25LZXksIF9rZXlEb3duQWN0aW9uc1tERUxFVEVfS0VZXSA9IHRoaXMuX29uRGVsZXRlS2V5LCBfa2V5RG93bkFjdGlvbnNbQkFDS19LRVldID0gdGhpcy5fb25EZWxldGVLZXksIF9rZXlEb3duQWN0aW9ucyk7IC8vIElmIGtleWNvZGUgaGFzIGEgZnVuY3Rpb24sIHJ1biBpdFxuXG4gICAgaWYgKGtleURvd25BY3Rpb25zW2tleUNvZGVdKSB7XG4gICAgICBrZXlEb3duQWN0aW9uc1trZXlDb2RlXSh7XG4gICAgICAgIGV2ZW50OiBldmVudCxcbiAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG4gICAgICAgIGtleUNvZGU6IGtleUNvZGUsXG4gICAgICAgIG1ldGFLZXk6IG1ldGFLZXksXG4gICAgICAgIGFjdGl2ZUl0ZW1zOiBhY3RpdmVJdGVtcyxcbiAgICAgICAgaGFzRm9jdXNlZElucHV0OiBoYXNGb2N1c2VkSW5wdXQsXG4gICAgICAgIGhhc0FjdGl2ZURyb3Bkb3duOiBoYXNBY3RpdmVEcm9wZG93bixcbiAgICAgICAgaGFzSXRlbXM6IGhhc0l0ZW1zLFxuICAgICAgICBoYXNDdHJsRG93bktleVByZXNzZWQ6IGhhc0N0cmxEb3duS2V5UHJlc3NlZFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5fb25LZXlVcCA9IGZ1bmN0aW9uIF9vbktleVVwKF9yZWYyKSB7XG4gICAgdmFyIHRhcmdldCA9IF9yZWYyLnRhcmdldCxcbiAgICAgICAga2V5Q29kZSA9IF9yZWYyLmtleUNvZGU7XG4gICAgdmFyIHZhbHVlID0gdGhpcy5pbnB1dC52YWx1ZTtcbiAgICB2YXIgYWN0aXZlSXRlbXMgPSB0aGlzLl9zdG9yZS5hY3RpdmVJdGVtcztcblxuICAgIHZhciBjYW5BZGRJdGVtID0gdGhpcy5fY2FuQWRkSXRlbShhY3RpdmVJdGVtcywgdmFsdWUpO1xuXG4gICAgdmFyIGJhY2tLZXkgPSBLRVlfQ09ERVMuQkFDS19LRVksXG4gICAgICAgIGRlbGV0ZUtleSA9IEtFWV9DT0RFUy5ERUxFVEVfS0VZOyAvLyBXZSBhcmUgdHlwaW5nIGludG8gYSB0ZXh0IGlucHV0IGFuZCBoYXZlIGEgdmFsdWUsIHdlIHdhbnQgdG8gc2hvdyBhIGRyb3Bkb3duXG4gICAgLy8gbm90aWNlLiBPdGhlcndpc2UgaGlkZSB0aGUgZHJvcGRvd25cblxuICAgIGlmICh0aGlzLl9pc1RleHRFbGVtZW50KSB7XG4gICAgICB2YXIgY2FuU2hvd0Ryb3Bkb3duTm90aWNlID0gY2FuQWRkSXRlbS5ub3RpY2UgJiYgdmFsdWU7XG5cbiAgICAgIGlmIChjYW5TaG93RHJvcGRvd25Ob3RpY2UpIHtcbiAgICAgICAgdmFyIGRyb3Bkb3duSXRlbSA9IHRoaXMuX2dldFRlbXBsYXRlKCdub3RpY2UnLCBjYW5BZGRJdGVtLm5vdGljZSk7XG5cbiAgICAgICAgdGhpcy5kcm9wZG93bi5lbGVtZW50LmlubmVySFRNTCA9IGRyb3Bkb3duSXRlbS5vdXRlckhUTUw7XG4gICAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oaWRlRHJvcGRvd24odHJ1ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciB1c2VySGFzUmVtb3ZlZFZhbHVlID0gKGtleUNvZGUgPT09IGJhY2tLZXkgfHwga2V5Q29kZSA9PT0gZGVsZXRlS2V5KSAmJiAhdGFyZ2V0LnZhbHVlO1xuICAgICAgdmFyIGNhblJlYWN0aXZhdGVDaG9pY2VzID0gIXRoaXMuX2lzVGV4dEVsZW1lbnQgJiYgdGhpcy5faXNTZWFyY2hpbmc7XG4gICAgICB2YXIgY2FuU2VhcmNoID0gdGhpcy5fY2FuU2VhcmNoICYmIGNhbkFkZEl0ZW0ucmVzcG9uc2U7XG5cbiAgICAgIGlmICh1c2VySGFzUmVtb3ZlZFZhbHVlICYmIGNhblJlYWN0aXZhdGVDaG9pY2VzKSB7XG4gICAgICAgIHRoaXMuX2lzU2VhcmNoaW5nID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goY2hvaWNlc19hY3RpdmF0ZUNob2ljZXModHJ1ZSkpO1xuICAgICAgfSBlbHNlIGlmIChjYW5TZWFyY2gpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlU2VhcmNoKHRoaXMuaW5wdXQudmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX2NhblNlYXJjaCA9IHRoaXMuY29uZmlnLnNlYXJjaEVuYWJsZWQ7XG4gIH07XG5cbiAgX3Byb3RvLl9vbkFLZXkgPSBmdW5jdGlvbiBfb25BS2V5KF9yZWYzKSB7XG4gICAgdmFyIGhhc0l0ZW1zID0gX3JlZjMuaGFzSXRlbXMsXG4gICAgICAgIGhhc0N0cmxEb3duS2V5UHJlc3NlZCA9IF9yZWYzLmhhc0N0cmxEb3duS2V5UHJlc3NlZDtcblxuICAgIC8vIElmIENUUkwgKyBBIG9yIENNRCArIEEgaGF2ZSBiZWVuIHByZXNzZWQgYW5kIHRoZXJlIGFyZSBpdGVtcyB0byBzZWxlY3RcbiAgICBpZiAoaGFzQ3RybERvd25LZXlQcmVzc2VkICYmIGhhc0l0ZW1zKSB7XG4gICAgICB0aGlzLl9jYW5TZWFyY2ggPSBmYWxzZTtcbiAgICAgIHZhciBzaG91bGRIaWdodGxpZ2h0QWxsID0gdGhpcy5jb25maWcucmVtb3ZlSXRlbXMgJiYgIXRoaXMuaW5wdXQudmFsdWUgJiYgdGhpcy5pbnB1dC5lbGVtZW50ID09PSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuXG4gICAgICBpZiAoc2hvdWxkSGlnaHRsaWdodEFsbCkge1xuICAgICAgICB0aGlzLmhpZ2hsaWdodEFsbCgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX29uRW50ZXJLZXkgPSBmdW5jdGlvbiBfb25FbnRlcktleShfcmVmNCkge1xuICAgIHZhciBldmVudCA9IF9yZWY0LmV2ZW50LFxuICAgICAgICB0YXJnZXQgPSBfcmVmNC50YXJnZXQsXG4gICAgICAgIGFjdGl2ZUl0ZW1zID0gX3JlZjQuYWN0aXZlSXRlbXMsXG4gICAgICAgIGhhc0FjdGl2ZURyb3Bkb3duID0gX3JlZjQuaGFzQWN0aXZlRHJvcGRvd247XG4gICAgdmFyIGVudGVyS2V5ID0gS0VZX0NPREVTLkVOVEVSX0tFWTtcbiAgICB2YXIgdGFyZ2V0V2FzQnV0dG9uID0gdGFyZ2V0Lmhhc0F0dHJpYnV0ZSgnZGF0YS1idXR0b24nKTtcblxuICAgIGlmICh0aGlzLl9pc1RleHRFbGVtZW50ICYmIHRhcmdldC52YWx1ZSkge1xuICAgICAgdmFyIHZhbHVlID0gdGhpcy5pbnB1dC52YWx1ZTtcblxuICAgICAgdmFyIGNhbkFkZEl0ZW0gPSB0aGlzLl9jYW5BZGRJdGVtKGFjdGl2ZUl0ZW1zLCB2YWx1ZSk7XG5cbiAgICAgIGlmIChjYW5BZGRJdGVtLnJlc3BvbnNlKSB7XG4gICAgICAgIHRoaXMuaGlkZURyb3Bkb3duKHRydWUpO1xuXG4gICAgICAgIHRoaXMuX2FkZEl0ZW0oe1xuICAgICAgICAgIHZhbHVlOiB2YWx1ZVxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl90cmlnZ2VyQ2hhbmdlKHZhbHVlKTtcblxuICAgICAgICB0aGlzLmNsZWFySW5wdXQoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGFyZ2V0V2FzQnV0dG9uKSB7XG4gICAgICB0aGlzLl9oYW5kbGVCdXR0b25BY3Rpb24oYWN0aXZlSXRlbXMsIHRhcmdldCk7XG5cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgaWYgKGhhc0FjdGl2ZURyb3Bkb3duKSB7XG4gICAgICB2YXIgaGlnaGxpZ2h0ZWRDaG9pY2UgPSB0aGlzLmRyb3Bkb3duLmdldENoaWxkKFwiLlwiICsgdGhpcy5jb25maWcuY2xhc3NOYW1lcy5oaWdobGlnaHRlZFN0YXRlKTtcblxuICAgICAgaWYgKGhpZ2hsaWdodGVkQ2hvaWNlKSB7XG4gICAgICAgIC8vIGFkZCBlbnRlciBrZXlDb2RlIHZhbHVlXG4gICAgICAgIGlmIChhY3RpdmVJdGVtc1swXSkge1xuICAgICAgICAgIGFjdGl2ZUl0ZW1zWzBdLmtleUNvZGUgPSBlbnRlcktleTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faGFuZGxlQ2hvaWNlQWN0aW9uKGFjdGl2ZUl0ZW1zLCBoaWdobGlnaHRlZENob2ljZSk7XG4gICAgICB9XG5cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX29uRXNjYXBlS2V5ID0gZnVuY3Rpb24gX29uRXNjYXBlS2V5KF9yZWY1KSB7XG4gICAgdmFyIGhhc0FjdGl2ZURyb3Bkb3duID0gX3JlZjUuaGFzQWN0aXZlRHJvcGRvd247XG5cbiAgICBpZiAoaGFzQWN0aXZlRHJvcGRvd24pIHtcbiAgICAgIHRoaXMuaGlkZURyb3Bkb3duKHRydWUpO1xuICAgICAgdGhpcy5jb250YWluZXJPdXRlci5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX29uRGlyZWN0aW9uS2V5ID0gZnVuY3Rpb24gX29uRGlyZWN0aW9uS2V5KF9yZWY2KSB7XG4gICAgdmFyIGV2ZW50ID0gX3JlZjYuZXZlbnQsXG4gICAgICAgIGhhc0FjdGl2ZURyb3Bkb3duID0gX3JlZjYuaGFzQWN0aXZlRHJvcGRvd24sXG4gICAgICAgIGtleUNvZGUgPSBfcmVmNi5rZXlDb2RlLFxuICAgICAgICBtZXRhS2V5ID0gX3JlZjYubWV0YUtleTtcbiAgICB2YXIgZG93bktleSA9IEtFWV9DT0RFUy5ET1dOX0tFWSxcbiAgICAgICAgcGFnZVVwS2V5ID0gS0VZX0NPREVTLlBBR0VfVVBfS0VZLFxuICAgICAgICBwYWdlRG93bktleSA9IEtFWV9DT0RFUy5QQUdFX0RPV05fS0VZOyAvLyBJZiB1cCBvciBkb3duIGtleSBpcyBwcmVzc2VkLCB0cmF2ZXJzZSB0aHJvdWdoIG9wdGlvbnNcblxuICAgIGlmIChoYXNBY3RpdmVEcm9wZG93biB8fCB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duKCk7XG4gICAgICB0aGlzLl9jYW5TZWFyY2ggPSBmYWxzZTtcbiAgICAgIHZhciBkaXJlY3Rpb25JbnQgPSBrZXlDb2RlID09PSBkb3duS2V5IHx8IGtleUNvZGUgPT09IHBhZ2VEb3duS2V5ID8gMSA6IC0xO1xuICAgICAgdmFyIHNraXBLZXkgPSBtZXRhS2V5IHx8IGtleUNvZGUgPT09IHBhZ2VEb3duS2V5IHx8IGtleUNvZGUgPT09IHBhZ2VVcEtleTtcbiAgICAgIHZhciBzZWxlY3RhYmxlQ2hvaWNlSWRlbnRpZmllciA9ICdbZGF0YS1jaG9pY2Utc2VsZWN0YWJsZV0nO1xuICAgICAgdmFyIG5leHRFbDtcblxuICAgICAgaWYgKHNraXBLZXkpIHtcbiAgICAgICAgaWYgKGRpcmVjdGlvbkludCA+IDApIHtcbiAgICAgICAgICBuZXh0RWwgPSB0aGlzLmRyb3Bkb3duLmVsZW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RhYmxlQ2hvaWNlSWRlbnRpZmllciArIFwiOmxhc3Qtb2YtdHlwZVwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXh0RWwgPSB0aGlzLmRyb3Bkb3duLmVsZW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RhYmxlQ2hvaWNlSWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjdXJyZW50RWwgPSB0aGlzLmRyb3Bkb3duLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5cIiArIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlnaGxpZ2h0ZWRTdGF0ZSk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRFbCkge1xuICAgICAgICAgIG5leHRFbCA9IGdldEFkamFjZW50RWwoY3VycmVudEVsLCBzZWxlY3RhYmxlQ2hvaWNlSWRlbnRpZmllciwgZGlyZWN0aW9uSW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXh0RWwgPSB0aGlzLmRyb3Bkb3duLmVsZW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RhYmxlQ2hvaWNlSWRlbnRpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG5leHRFbCkge1xuICAgICAgICAvLyBXZSBwcmV2ZW50IGRlZmF1bHQgdG8gc3RvcCB0aGUgY3Vyc29yIG1vdmluZ1xuICAgICAgICAvLyB3aGVuIHByZXNzaW5nIHRoZSBhcnJvd1xuICAgICAgICBpZiAoIWlzU2Nyb2xsZWRJbnRvVmlldyhuZXh0RWwsIHRoaXMuY2hvaWNlTGlzdC5lbGVtZW50LCBkaXJlY3Rpb25JbnQpKSB7XG4gICAgICAgICAgdGhpcy5jaG9pY2VMaXN0LnNjcm9sbFRvQ2hpbGRFbGVtZW50KG5leHRFbCwgZGlyZWN0aW9uSW50KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2hpZ2hsaWdodENob2ljZShuZXh0RWwpO1xuICAgICAgfSAvLyBQcmV2ZW50IGRlZmF1bHQgdG8gbWFpbnRhaW4gY3Vyc29yIHBvc2l0aW9uIHdoaWxzdFxuICAgICAgLy8gdHJhdmVyc2luZyBkcm9wZG93biBvcHRpb25zXG5cblxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9vbkRlbGV0ZUtleSA9IGZ1bmN0aW9uIF9vbkRlbGV0ZUtleShfcmVmNykge1xuICAgIHZhciBldmVudCA9IF9yZWY3LmV2ZW50LFxuICAgICAgICB0YXJnZXQgPSBfcmVmNy50YXJnZXQsXG4gICAgICAgIGhhc0ZvY3VzZWRJbnB1dCA9IF9yZWY3Lmhhc0ZvY3VzZWRJbnB1dCxcbiAgICAgICAgYWN0aXZlSXRlbXMgPSBfcmVmNy5hY3RpdmVJdGVtcztcblxuICAgIC8vIElmIGJhY2tzcGFjZSBvciBkZWxldGUga2V5IGlzIHByZXNzZWQgYW5kIHRoZSBpbnB1dCBoYXMgbm8gdmFsdWVcbiAgICBpZiAoaGFzRm9jdXNlZElucHV0ICYmICF0YXJnZXQudmFsdWUgJiYgIXRoaXMuX2lzU2VsZWN0T25lRWxlbWVudCkge1xuICAgICAgdGhpcy5faGFuZGxlQmFja3NwYWNlKGFjdGl2ZUl0ZW1zKTtcblxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9vblRvdWNoTW92ZSA9IGZ1bmN0aW9uIF9vblRvdWNoTW92ZSgpIHtcbiAgICBpZiAodGhpcy5fd2FzVGFwKSB7XG4gICAgICB0aGlzLl93YXNUYXAgPSBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9vblRvdWNoRW5kID0gZnVuY3Rpb24gX29uVG91Y2hFbmQoZXZlbnQpIHtcbiAgICB2YXIgX3JlZjggPSBldmVudCB8fCBldmVudC50b3VjaGVzWzBdLFxuICAgICAgICB0YXJnZXQgPSBfcmVmOC50YXJnZXQ7XG5cbiAgICB2YXIgdG91Y2hXYXNXaXRoaW5Db250YWluZXIgPSB0aGlzLl93YXNUYXAgJiYgdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50LmNvbnRhaW5zKHRhcmdldCk7XG5cbiAgICBpZiAodG91Y2hXYXNXaXRoaW5Db250YWluZXIpIHtcbiAgICAgIHZhciBjb250YWluZXJXYXNFeGFjdFRhcmdldCA9IHRhcmdldCA9PT0gdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50IHx8IHRhcmdldCA9PT0gdGhpcy5jb250YWluZXJJbm5lci5lbGVtZW50O1xuXG4gICAgICBpZiAoY29udGFpbmVyV2FzRXhhY3RUYXJnZXQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzVGV4dEVsZW1lbnQpIHtcbiAgICAgICAgICB0aGlzLmlucHV0LmZvY3VzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNTZWxlY3RNdWx0aXBsZUVsZW1lbnQpIHtcbiAgICAgICAgICB0aGlzLnNob3dEcm9wZG93bigpO1xuICAgICAgICB9XG4gICAgICB9IC8vIFByZXZlbnRzIGZvY3VzIGV2ZW50IGZpcmluZ1xuXG5cbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxuICAgIHRoaXMuX3dhc1RhcCA9IHRydWU7XG4gIH1cbiAgLyoqXG4gICAqIEhhbmRsZXMgbW91c2Vkb3duIGV2ZW50IGluIGNhcHR1cmUgbW9kZSBmb3IgY29udGFpbmV0T3V0ZXIuZWxlbWVudFxuICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50XG4gICAqL1xuICA7XG5cbiAgX3Byb3RvLl9vbk1vdXNlRG93biA9IGZ1bmN0aW9uIF9vbk1vdXNlRG93bihldmVudCkge1xuICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cbiAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9IC8vIElmIHdlIGhhdmUgb3VyIG1vdXNlIGRvd24gb24gdGhlIHNjcm9sbGJhciBhbmQgYXJlIG9uIElFMTEuLi5cblxuXG4gICAgaWYgKElTX0lFMTEgJiYgdGhpcy5jaG9pY2VMaXN0LmVsZW1lbnQuY29udGFpbnModGFyZ2V0KSkge1xuICAgICAgLy8gY2hlY2sgaWYgY2xpY2sgd2FzIG9uIGEgc2Nyb2xsYmFyIGFyZWFcbiAgICAgIHZhciBmaXJzdENob2ljZSA9XG4gICAgICAvKiogQHR5cGUge0hUTUxFbGVtZW50fSAqL1xuICAgICAgdGhpcy5jaG9pY2VMaXN0LmVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICB2YXIgaXNPblNjcm9sbGJhciA9IHRoaXMuX2RpcmVjdGlvbiA9PT0gJ2x0cicgPyBldmVudC5vZmZzZXRYID49IGZpcnN0Q2hvaWNlLm9mZnNldFdpZHRoIDogZXZlbnQub2Zmc2V0WCA8IGZpcnN0Q2hvaWNlLm9mZnNldExlZnQ7XG4gICAgICB0aGlzLl9pc1Njcm9sbGluZ09uSWUgPSBpc09uU2Nyb2xsYmFyO1xuICAgIH1cblxuICAgIGlmICh0YXJnZXQgPT09IHRoaXMuaW5wdXQuZWxlbWVudCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpdGVtID0gdGFyZ2V0LmNsb3Nlc3QoJ1tkYXRhLWJ1dHRvbl0sW2RhdGEtaXRlbV0sW2RhdGEtY2hvaWNlXScpO1xuXG4gICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgdmFyIGhhc1NoaWZ0S2V5ID0gZXZlbnQuc2hpZnRLZXk7XG4gICAgICB2YXIgYWN0aXZlSXRlbXMgPSB0aGlzLl9zdG9yZS5hY3RpdmVJdGVtcztcbiAgICAgIHZhciBkYXRhc2V0ID0gaXRlbS5kYXRhc2V0O1xuXG4gICAgICBpZiAoJ2J1dHRvbicgaW4gZGF0YXNldCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVCdXR0b25BY3Rpb24oYWN0aXZlSXRlbXMsIGl0ZW0pO1xuICAgICAgfSBlbHNlIGlmICgnaXRlbScgaW4gZGF0YXNldCkge1xuICAgICAgICB0aGlzLl9oYW5kbGVJdGVtQWN0aW9uKGFjdGl2ZUl0ZW1zLCBpdGVtLCBoYXNTaGlmdEtleSk7XG4gICAgICB9IGVsc2UgaWYgKCdjaG9pY2UnIGluIGRhdGFzZXQpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2hvaWNlQWN0aW9uKGFjdGl2ZUl0ZW1zLCBpdGVtKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG4gIC8qKlxuICAgKiBIYW5kbGVzIG1vdXNlb3ZlciBldmVudCBvdmVyIHRoaXMuZHJvcGRvd25cbiAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudFxuICAgKi9cbiAgO1xuXG4gIF9wcm90by5fb25Nb3VzZU92ZXIgPSBmdW5jdGlvbiBfb25Nb3VzZU92ZXIoX3JlZjkpIHtcbiAgICB2YXIgdGFyZ2V0ID0gX3JlZjkudGFyZ2V0O1xuXG4gICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmICdjaG9pY2UnIGluIHRhcmdldC5kYXRhc2V0KSB7XG4gICAgICB0aGlzLl9oaWdobGlnaHRDaG9pY2UodGFyZ2V0KTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9vbkNsaWNrID0gZnVuY3Rpb24gX29uQ2xpY2soX3JlZjEwKSB7XG4gICAgdmFyIHRhcmdldCA9IF9yZWYxMC50YXJnZXQ7XG4gICAgdmFyIGNsaWNrV2FzV2l0aGluQ29udGFpbmVyID0gdGhpcy5jb250YWluZXJPdXRlci5lbGVtZW50LmNvbnRhaW5zKHRhcmdldCk7XG5cbiAgICBpZiAoY2xpY2tXYXNXaXRoaW5Db250YWluZXIpIHtcbiAgICAgIGlmICghdGhpcy5kcm9wZG93bi5pc0FjdGl2ZSAmJiAhdGhpcy5jb250YWluZXJPdXRlci5pc0Rpc2FibGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1RleHRFbGVtZW50KSB7XG4gICAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgIT09IHRoaXMuaW5wdXQuZWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dC5mb2N1cygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNob3dEcm9wZG93bigpO1xuICAgICAgICAgIHRoaXMuY29udGFpbmVyT3V0ZXIuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQgJiYgdGFyZ2V0ICE9PSB0aGlzLmlucHV0LmVsZW1lbnQgJiYgIXRoaXMuZHJvcGRvd24uZWxlbWVudC5jb250YWlucyh0YXJnZXQpKSB7XG4gICAgICAgIHRoaXMuaGlkZURyb3Bkb3duKCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBoYXNIaWdobGlnaHRlZEl0ZW1zID0gdGhpcy5fc3RvcmUuaGlnaGxpZ2h0ZWRBY3RpdmVJdGVtcy5sZW5ndGggPiAwO1xuXG4gICAgICBpZiAoaGFzSGlnaGxpZ2h0ZWRJdGVtcykge1xuICAgICAgICB0aGlzLnVuaGlnaGxpZ2h0QWxsKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuY29udGFpbmVyT3V0ZXIucmVtb3ZlRm9jdXNTdGF0ZSgpO1xuICAgICAgdGhpcy5oaWRlRHJvcGRvd24odHJ1ZSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5fb25Gb2N1cyA9IGZ1bmN0aW9uIF9vbkZvY3VzKF9yZWYxMSkge1xuICAgIHZhciBfdGhpczE3ID0gdGhpcyxcbiAgICAgICAgX2ZvY3VzQWN0aW9ucztcblxuICAgIHZhciB0YXJnZXQgPSBfcmVmMTEudGFyZ2V0O1xuICAgIHZhciBmb2N1c1dhc1dpdGhpbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyT3V0ZXIuZWxlbWVudC5jb250YWlucyh0YXJnZXQpO1xuXG4gICAgaWYgKCFmb2N1c1dhc1dpdGhpbkNvbnRhaW5lcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBmb2N1c0FjdGlvbnMgPSAoX2ZvY3VzQWN0aW9ucyA9IHt9LCBfZm9jdXNBY3Rpb25zW1RFWFRfVFlQRV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGFyZ2V0ID09PSBfdGhpczE3LmlucHV0LmVsZW1lbnQpIHtcbiAgICAgICAgX3RoaXMxNy5jb250YWluZXJPdXRlci5hZGRGb2N1c1N0YXRlKCk7XG4gICAgICB9XG4gICAgfSwgX2ZvY3VzQWN0aW9uc1tTRUxFQ1RfT05FX1RZUEVdID0gZnVuY3Rpb24gKCkge1xuICAgICAgX3RoaXMxNy5jb250YWluZXJPdXRlci5hZGRGb2N1c1N0YXRlKCk7XG5cbiAgICAgIGlmICh0YXJnZXQgPT09IF90aGlzMTcuaW5wdXQuZWxlbWVudCkge1xuICAgICAgICBfdGhpczE3LnNob3dEcm9wZG93bih0cnVlKTtcbiAgICAgIH1cbiAgICB9LCBfZm9jdXNBY3Rpb25zW1NFTEVDVF9NVUxUSVBMRV9UWVBFXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICh0YXJnZXQgPT09IF90aGlzMTcuaW5wdXQuZWxlbWVudCkge1xuICAgICAgICBfdGhpczE3LnNob3dEcm9wZG93bih0cnVlKTsgLy8gSWYgZWxlbWVudCBpcyBhIHNlbGVjdCBib3gsIHRoZSBmb2N1c2VkIGVsZW1lbnQgaXMgdGhlIGNvbnRhaW5lciBhbmQgdGhlIGRyb3Bkb3duXG4gICAgICAgIC8vIGlzbid0IGFscmVhZHkgb3BlbiwgZm9jdXMgYW5kIHNob3cgZHJvcGRvd25cblxuXG4gICAgICAgIF90aGlzMTcuY29udGFpbmVyT3V0ZXIuYWRkRm9jdXNTdGF0ZSgpO1xuICAgICAgfVxuICAgIH0sIF9mb2N1c0FjdGlvbnMpO1xuICAgIGZvY3VzQWN0aW9uc1t0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudC50eXBlXSgpO1xuICB9O1xuXG4gIF9wcm90by5fb25CbHVyID0gZnVuY3Rpb24gX29uQmx1cihfcmVmMTIpIHtcbiAgICB2YXIgX3RoaXMxOCA9IHRoaXM7XG5cbiAgICB2YXIgdGFyZ2V0ID0gX3JlZjEyLnRhcmdldDtcbiAgICB2YXIgYmx1cldhc1dpdGhpbkNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyT3V0ZXIuZWxlbWVudC5jb250YWlucyh0YXJnZXQpO1xuXG4gICAgaWYgKGJsdXJXYXNXaXRoaW5Db250YWluZXIgJiYgIXRoaXMuX2lzU2Nyb2xsaW5nT25JZSkge1xuICAgICAgdmFyIF9ibHVyQWN0aW9ucztcblxuICAgICAgdmFyIGFjdGl2ZUl0ZW1zID0gdGhpcy5fc3RvcmUuYWN0aXZlSXRlbXM7XG4gICAgICB2YXIgaGFzSGlnaGxpZ2h0ZWRJdGVtcyA9IGFjdGl2ZUl0ZW1zLnNvbWUoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uaGlnaGxpZ2h0ZWQ7XG4gICAgICB9KTtcbiAgICAgIHZhciBibHVyQWN0aW9ucyA9IChfYmx1ckFjdGlvbnMgPSB7fSwgX2JsdXJBY3Rpb25zW1RFWFRfVFlQRV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0YXJnZXQgPT09IF90aGlzMTguaW5wdXQuZWxlbWVudCkge1xuICAgICAgICAgIF90aGlzMTguY29udGFpbmVyT3V0ZXIucmVtb3ZlRm9jdXNTdGF0ZSgpO1xuXG4gICAgICAgICAgaWYgKGhhc0hpZ2hsaWdodGVkSXRlbXMpIHtcbiAgICAgICAgICAgIF90aGlzMTgudW5oaWdobGlnaHRBbGwoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpczE4LmhpZGVEcm9wZG93bih0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSwgX2JsdXJBY3Rpb25zW1NFTEVDVF9PTkVfVFlQRV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzMTguY29udGFpbmVyT3V0ZXIucmVtb3ZlRm9jdXNTdGF0ZSgpO1xuXG4gICAgICAgIGlmICh0YXJnZXQgPT09IF90aGlzMTguaW5wdXQuZWxlbWVudCB8fCB0YXJnZXQgPT09IF90aGlzMTguY29udGFpbmVyT3V0ZXIuZWxlbWVudCAmJiAhX3RoaXMxOC5fY2FuU2VhcmNoKSB7XG4gICAgICAgICAgX3RoaXMxOC5oaWRlRHJvcGRvd24odHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIF9ibHVyQWN0aW9uc1tTRUxFQ1RfTVVMVElQTEVfVFlQRV0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0YXJnZXQgPT09IF90aGlzMTguaW5wdXQuZWxlbWVudCkge1xuICAgICAgICAgIF90aGlzMTguY29udGFpbmVyT3V0ZXIucmVtb3ZlRm9jdXNTdGF0ZSgpO1xuXG4gICAgICAgICAgX3RoaXMxOC5oaWRlRHJvcGRvd24odHJ1ZSk7XG5cbiAgICAgICAgICBpZiAoaGFzSGlnaGxpZ2h0ZWRJdGVtcykge1xuICAgICAgICAgICAgX3RoaXMxOC51bmhpZ2hsaWdodEFsbCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgX2JsdXJBY3Rpb25zKTtcbiAgICAgIGJsdXJBY3Rpb25zW3RoaXMucGFzc2VkRWxlbWVudC5lbGVtZW50LnR5cGVdKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE9uIElFMTEsIGNsaWNraW5nIHRoZSBzY29sbGJhciBibHVycyBvdXIgaW5wdXQgYW5kIHRodXNcbiAgICAgIC8vIGNsb3NlcyB0aGUgZHJvcGRvd24uIFRvIHN0b3AgdGhpcywgd2UgcmVmb2N1cyBvdXIgaW5wdXRcbiAgICAgIC8vIGlmIHdlIGtub3cgd2UgYXJlIG9uIElFICphbmQqIGFyZSBzY3JvbGxpbmcuXG4gICAgICB0aGlzLl9pc1Njcm9sbGluZ09uSWUgPSBmYWxzZTtcbiAgICAgIHRoaXMuaW5wdXQuZWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX29uRm9ybVJlc2V0ID0gZnVuY3Rpb24gX29uRm9ybVJlc2V0KCkge1xuICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKHJlc2V0VG8odGhpcy5faW5pdGlhbFN0YXRlKSk7XG4gIH07XG5cbiAgX3Byb3RvLl9oaWdobGlnaHRDaG9pY2UgPSBmdW5jdGlvbiBfaGlnaGxpZ2h0Q2hvaWNlKGVsKSB7XG4gICAgdmFyIF90aGlzMTkgPSB0aGlzO1xuXG4gICAgaWYgKGVsID09PSB2b2lkIDApIHtcbiAgICAgIGVsID0gbnVsbDtcbiAgICB9XG5cbiAgICB2YXIgY2hvaWNlcyA9IEFycmF5LmZyb20odGhpcy5kcm9wZG93bi5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWNob2ljZS1zZWxlY3RhYmxlXScpKTtcblxuICAgIGlmICghY2hvaWNlcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgcGFzc2VkRWwgPSBlbDtcbiAgICB2YXIgaGlnaGxpZ2h0ZWRDaG9pY2VzID0gQXJyYXkuZnJvbSh0aGlzLmRyb3Bkb3duLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5cIiArIHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlnaGxpZ2h0ZWRTdGF0ZSkpOyAvLyBSZW1vdmUgYW55IGhpZ2hsaWdodGVkIGNob2ljZXNcblxuICAgIGhpZ2hsaWdodGVkQ2hvaWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaG9pY2UpIHtcbiAgICAgIGNob2ljZS5jbGFzc0xpc3QucmVtb3ZlKF90aGlzMTkuY29uZmlnLmNsYXNzTmFtZXMuaGlnaGxpZ2h0ZWRTdGF0ZSk7XG4gICAgICBjaG9pY2Uuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgfSk7XG5cbiAgICBpZiAocGFzc2VkRWwpIHtcbiAgICAgIHRoaXMuX2hpZ2hsaWdodFBvc2l0aW9uID0gY2hvaWNlcy5pbmRleE9mKHBhc3NlZEVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSGlnaGxpZ2h0IGNob2ljZSBiYXNlZCBvbiBsYXN0IGtub3duIGhpZ2hsaWdodCBsb2NhdGlvblxuICAgICAgaWYgKGNob2ljZXMubGVuZ3RoID4gdGhpcy5faGlnaGxpZ2h0UG9zaXRpb24pIHtcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBhbiBvcHRpb24gdG8gaGlnaGxpZ2h0XG4gICAgICAgIHBhc3NlZEVsID0gY2hvaWNlc1t0aGlzLl9oaWdobGlnaHRQb3NpdGlvbl07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgaGlnaGxpZ2h0IHRoZSBvcHRpb24gYmVmb3JlXG4gICAgICAgIHBhc3NlZEVsID0gY2hvaWNlc1tjaG9pY2VzLmxlbmd0aCAtIDFdO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXBhc3NlZEVsKSB7XG4gICAgICAgIHBhc3NlZEVsID0gY2hvaWNlc1swXTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBwYXNzZWRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuY29uZmlnLmNsYXNzTmFtZXMuaGlnaGxpZ2h0ZWRTdGF0ZSk7XG4gICAgcGFzc2VkRWwuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICB0aGlzLnBhc3NlZEVsZW1lbnQudHJpZ2dlckV2ZW50KEVWRU5UUy5oaWdobGlnaHRDaG9pY2UsIHtcbiAgICAgIGVsOiBwYXNzZWRFbFxuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuZHJvcGRvd24uaXNBY3RpdmUpIHtcbiAgICAgIC8vIElFMTEgaWdub3JlcyBhcmlhLWxhYmVsIGFuZCBibG9ja3MgdmlydHVhbCBrZXlib2FyZFxuICAgICAgLy8gaWYgYXJpYS1hY3RpdmVkZXNjZW5kYW50IGlzIHNldCB3aXRob3V0IGEgZHJvcGRvd25cbiAgICAgIHRoaXMuaW5wdXQuc2V0QWN0aXZlRGVzY2VuZGFudChwYXNzZWRFbC5pZCk7XG4gICAgICB0aGlzLmNvbnRhaW5lck91dGVyLnNldEFjdGl2ZURlc2NlbmRhbnQocGFzc2VkRWwuaWQpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2FkZEl0ZW0gPSBmdW5jdGlvbiBfYWRkSXRlbShfcmVmMTMpIHtcbiAgICB2YXIgdmFsdWUgPSBfcmVmMTMudmFsdWUsXG4gICAgICAgIF9yZWYxMyRsYWJlbCA9IF9yZWYxMy5sYWJlbCxcbiAgICAgICAgbGFiZWwgPSBfcmVmMTMkbGFiZWwgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmMTMkbGFiZWwsXG4gICAgICAgIF9yZWYxMyRjaG9pY2VJZCA9IF9yZWYxMy5jaG9pY2VJZCxcbiAgICAgICAgY2hvaWNlSWQgPSBfcmVmMTMkY2hvaWNlSWQgPT09IHZvaWQgMCA/IC0xIDogX3JlZjEzJGNob2ljZUlkLFxuICAgICAgICBfcmVmMTMkZ3JvdXBJZCA9IF9yZWYxMy5ncm91cElkLFxuICAgICAgICBncm91cElkID0gX3JlZjEzJGdyb3VwSWQgPT09IHZvaWQgMCA/IC0xIDogX3JlZjEzJGdyb3VwSWQsXG4gICAgICAgIF9yZWYxMyRjdXN0b21Qcm9wZXJ0aSA9IF9yZWYxMy5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzID0gX3JlZjEzJGN1c3RvbVByb3BlcnRpID09PSB2b2lkIDAgPyBudWxsIDogX3JlZjEzJGN1c3RvbVByb3BlcnRpLFxuICAgICAgICBfcmVmMTMkcGxhY2Vob2xkZXIgPSBfcmVmMTMucGxhY2Vob2xkZXIsXG4gICAgICAgIHBsYWNlaG9sZGVyID0gX3JlZjEzJHBsYWNlaG9sZGVyID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYxMyRwbGFjZWhvbGRlcixcbiAgICAgICAgX3JlZjEzJGtleUNvZGUgPSBfcmVmMTMua2V5Q29kZSxcbiAgICAgICAga2V5Q29kZSA9IF9yZWYxMyRrZXlDb2RlID09PSB2b2lkIDAgPyBudWxsIDogX3JlZjEzJGtleUNvZGU7XG4gICAgdmFyIHBhc3NlZFZhbHVlID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlLnRyaW0oKSA6IHZhbHVlO1xuICAgIHZhciBwYXNzZWRLZXlDb2RlID0ga2V5Q29kZTtcbiAgICB2YXIgcGFzc2VkQ3VzdG9tUHJvcGVydGllcyA9IGN1c3RvbVByb3BlcnRpZXM7XG4gICAgdmFyIGl0ZW1zID0gdGhpcy5fc3RvcmUuaXRlbXM7XG4gICAgdmFyIHBhc3NlZExhYmVsID0gbGFiZWwgfHwgcGFzc2VkVmFsdWU7XG4gICAgdmFyIHBhc3NlZE9wdGlvbklkID0gY2hvaWNlSWQgfHwgLTE7XG4gICAgdmFyIGdyb3VwID0gZ3JvdXBJZCA+PSAwID8gdGhpcy5fc3RvcmUuZ2V0R3JvdXBCeUlkKGdyb3VwSWQpIDogbnVsbDtcbiAgICB2YXIgaWQgPSBpdGVtcyA/IGl0ZW1zLmxlbmd0aCArIDEgOiAxOyAvLyBJZiBhIHByZXBlbmRlZCB2YWx1ZSBoYXMgYmVlbiBwYXNzZWQsIHByZXBlbmQgaXRcblxuICAgIGlmICh0aGlzLmNvbmZpZy5wcmVwZW5kVmFsdWUpIHtcbiAgICAgIHBhc3NlZFZhbHVlID0gdGhpcy5jb25maWcucHJlcGVuZFZhbHVlICsgcGFzc2VkVmFsdWUudG9TdHJpbmcoKTtcbiAgICB9IC8vIElmIGFuIGFwcGVuZGVkIHZhbHVlIGhhcyBiZWVuIHBhc3NlZCwgYXBwZW5kIGl0XG5cblxuICAgIGlmICh0aGlzLmNvbmZpZy5hcHBlbmRWYWx1ZSkge1xuICAgICAgcGFzc2VkVmFsdWUgKz0gdGhpcy5jb25maWcuYXBwZW5kVmFsdWUudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChpdGVtc19hZGRJdGVtKHtcbiAgICAgIHZhbHVlOiBwYXNzZWRWYWx1ZSxcbiAgICAgIGxhYmVsOiBwYXNzZWRMYWJlbCxcbiAgICAgIGlkOiBpZCxcbiAgICAgIGNob2ljZUlkOiBwYXNzZWRPcHRpb25JZCxcbiAgICAgIGdyb3VwSWQ6IGdyb3VwSWQsXG4gICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBjdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgcGxhY2Vob2xkZXI6IHBsYWNlaG9sZGVyLFxuICAgICAga2V5Q29kZTogcGFzc2VkS2V5Q29kZVxuICAgIH0pKTtcblxuICAgIGlmICh0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpIHtcbiAgICAgIHRoaXMucmVtb3ZlQWN0aXZlSXRlbXMoaWQpO1xuICAgIH0gLy8gVHJpZ2dlciBjaGFuZ2UgZXZlbnRcblxuXG4gICAgdGhpcy5wYXNzZWRFbGVtZW50LnRyaWdnZXJFdmVudChFVkVOVFMuYWRkSXRlbSwge1xuICAgICAgaWQ6IGlkLFxuICAgICAgdmFsdWU6IHBhc3NlZFZhbHVlLFxuICAgICAgbGFiZWw6IHBhc3NlZExhYmVsLFxuICAgICAgY3VzdG9tUHJvcGVydGllczogcGFzc2VkQ3VzdG9tUHJvcGVydGllcyxcbiAgICAgIGdyb3VwVmFsdWU6IGdyb3VwICYmIGdyb3VwLnZhbHVlID8gZ3JvdXAudmFsdWUgOiB1bmRlZmluZWQsXG4gICAgICBrZXlDb2RlOiBwYXNzZWRLZXlDb2RlXG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLl9yZW1vdmVJdGVtID0gZnVuY3Rpb24gX3JlbW92ZUl0ZW0oaXRlbSkge1xuICAgIGlmICghaXRlbSB8fCAhaXNUeXBlKCdPYmplY3QnLCBpdGVtKSkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdmFyIGlkID0gaXRlbS5pZCxcbiAgICAgICAgdmFsdWUgPSBpdGVtLnZhbHVlLFxuICAgICAgICBsYWJlbCA9IGl0ZW0ubGFiZWwsXG4gICAgICAgIGNob2ljZUlkID0gaXRlbS5jaG9pY2VJZCxcbiAgICAgICAgZ3JvdXBJZCA9IGl0ZW0uZ3JvdXBJZDtcbiAgICB2YXIgZ3JvdXAgPSBncm91cElkID49IDAgPyB0aGlzLl9zdG9yZS5nZXRHcm91cEJ5SWQoZ3JvdXBJZCkgOiBudWxsO1xuXG4gICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goaXRlbXNfcmVtb3ZlSXRlbShpZCwgY2hvaWNlSWQpKTtcblxuICAgIGlmIChncm91cCAmJiBncm91cC52YWx1ZSkge1xuICAgICAgdGhpcy5wYXNzZWRFbGVtZW50LnRyaWdnZXJFdmVudChFVkVOVFMucmVtb3ZlSXRlbSwge1xuICAgICAgICBpZDogaWQsXG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBncm91cFZhbHVlOiBncm91cC52YWx1ZVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGFzc2VkRWxlbWVudC50cmlnZ2VyRXZlbnQoRVZFTlRTLnJlbW92ZUl0ZW0sIHtcbiAgICAgICAgaWQ6IGlkLFxuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGxhYmVsOiBsYWJlbFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgX3Byb3RvLl9hZGRDaG9pY2UgPSBmdW5jdGlvbiBfYWRkQ2hvaWNlKF9yZWYxNCkge1xuICAgIHZhciB2YWx1ZSA9IF9yZWYxNC52YWx1ZSxcbiAgICAgICAgX3JlZjE0JGxhYmVsID0gX3JlZjE0LmxhYmVsLFxuICAgICAgICBsYWJlbCA9IF9yZWYxNCRsYWJlbCA9PT0gdm9pZCAwID8gbnVsbCA6IF9yZWYxNCRsYWJlbCxcbiAgICAgICAgX3JlZjE0JGlzU2VsZWN0ZWQgPSBfcmVmMTQuaXNTZWxlY3RlZCxcbiAgICAgICAgaXNTZWxlY3RlZCA9IF9yZWYxNCRpc1NlbGVjdGVkID09PSB2b2lkIDAgPyBmYWxzZSA6IF9yZWYxNCRpc1NlbGVjdGVkLFxuICAgICAgICBfcmVmMTQkaXNEaXNhYmxlZCA9IF9yZWYxNC5pc0Rpc2FibGVkLFxuICAgICAgICBpc0Rpc2FibGVkID0gX3JlZjE0JGlzRGlzYWJsZWQgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjE0JGlzRGlzYWJsZWQsXG4gICAgICAgIF9yZWYxNCRncm91cElkID0gX3JlZjE0Lmdyb3VwSWQsXG4gICAgICAgIGdyb3VwSWQgPSBfcmVmMTQkZ3JvdXBJZCA9PT0gdm9pZCAwID8gLTEgOiBfcmVmMTQkZ3JvdXBJZCxcbiAgICAgICAgX3JlZjE0JGN1c3RvbVByb3BlcnRpID0gX3JlZjE0LmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgIGN1c3RvbVByb3BlcnRpZXMgPSBfcmVmMTQkY3VzdG9tUHJvcGVydGkgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmMTQkY3VzdG9tUHJvcGVydGksXG4gICAgICAgIF9yZWYxNCRwbGFjZWhvbGRlciA9IF9yZWYxNC5wbGFjZWhvbGRlcixcbiAgICAgICAgcGxhY2Vob2xkZXIgPSBfcmVmMTQkcGxhY2Vob2xkZXIgPT09IHZvaWQgMCA/IGZhbHNlIDogX3JlZjE0JHBsYWNlaG9sZGVyLFxuICAgICAgICBfcmVmMTQka2V5Q29kZSA9IF9yZWYxNC5rZXlDb2RlLFxuICAgICAgICBrZXlDb2RlID0gX3JlZjE0JGtleUNvZGUgPT09IHZvaWQgMCA/IG51bGwgOiBfcmVmMTQka2V5Q29kZTtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBHZW5lcmF0ZSB1bmlxdWUgaWRcblxuXG4gICAgdmFyIGNob2ljZXMgPSB0aGlzLl9zdG9yZS5jaG9pY2VzO1xuICAgIHZhciBjaG9pY2VMYWJlbCA9IGxhYmVsIHx8IHZhbHVlO1xuICAgIHZhciBjaG9pY2VJZCA9IGNob2ljZXMgPyBjaG9pY2VzLmxlbmd0aCArIDEgOiAxO1xuICAgIHZhciBjaG9pY2VFbGVtZW50SWQgPSB0aGlzLl9iYXNlSWQgKyBcIi1cIiArIHRoaXMuX2lkTmFtZXMuaXRlbUNob2ljZSArIFwiLVwiICsgY2hvaWNlSWQ7XG5cbiAgICB0aGlzLl9zdG9yZS5kaXNwYXRjaChjaG9pY2VzX2FkZENob2ljZSh7XG4gICAgICBpZDogY2hvaWNlSWQsXG4gICAgICBncm91cElkOiBncm91cElkLFxuICAgICAgZWxlbWVudElkOiBjaG9pY2VFbGVtZW50SWQsXG4gICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICBsYWJlbDogY2hvaWNlTGFiZWwsXG4gICAgICBkaXNhYmxlZDogaXNEaXNhYmxlZCxcbiAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGN1c3RvbVByb3BlcnRpZXMsXG4gICAgICBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIsXG4gICAgICBrZXlDb2RlOiBrZXlDb2RlXG4gICAgfSkpO1xuXG4gICAgaWYgKGlzU2VsZWN0ZWQpIHtcbiAgICAgIHRoaXMuX2FkZEl0ZW0oe1xuICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgIGxhYmVsOiBjaG9pY2VMYWJlbCxcbiAgICAgICAgY2hvaWNlSWQ6IGNob2ljZUlkLFxuICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBjdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgICBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIsXG4gICAgICAgIGtleUNvZGU6IGtleUNvZGVcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2FkZEdyb3VwID0gZnVuY3Rpb24gX2FkZEdyb3VwKF9yZWYxNSkge1xuICAgIHZhciBfdGhpczIwID0gdGhpcztcblxuICAgIHZhciBncm91cCA9IF9yZWYxNS5ncm91cCxcbiAgICAgICAgaWQgPSBfcmVmMTUuaWQsXG4gICAgICAgIF9yZWYxNSR2YWx1ZUtleSA9IF9yZWYxNS52YWx1ZUtleSxcbiAgICAgICAgdmFsdWVLZXkgPSBfcmVmMTUkdmFsdWVLZXkgPT09IHZvaWQgMCA/ICd2YWx1ZScgOiBfcmVmMTUkdmFsdWVLZXksXG4gICAgICAgIF9yZWYxNSRsYWJlbEtleSA9IF9yZWYxNS5sYWJlbEtleSxcbiAgICAgICAgbGFiZWxLZXkgPSBfcmVmMTUkbGFiZWxLZXkgPT09IHZvaWQgMCA/ICdsYWJlbCcgOiBfcmVmMTUkbGFiZWxLZXk7XG4gICAgdmFyIGdyb3VwQ2hvaWNlcyA9IGlzVHlwZSgnT2JqZWN0JywgZ3JvdXApID8gZ3JvdXAuY2hvaWNlcyA6IEFycmF5LmZyb20oZ3JvdXAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ09QVElPTicpKTtcbiAgICB2YXIgZ3JvdXBJZCA9IGlkIHx8IE1hdGguZmxvb3IobmV3IERhdGUoKS52YWx1ZU9mKCkgKiBNYXRoLnJhbmRvbSgpKTtcbiAgICB2YXIgaXNEaXNhYmxlZCA9IGdyb3VwLmRpc2FibGVkID8gZ3JvdXAuZGlzYWJsZWQgOiBmYWxzZTtcblxuICAgIGlmIChncm91cENob2ljZXMpIHtcbiAgICAgIHRoaXMuX3N0b3JlLmRpc3BhdGNoKGdyb3Vwc19hZGRHcm91cCh7XG4gICAgICAgIHZhbHVlOiBncm91cC5sYWJlbCxcbiAgICAgICAgaWQ6IGdyb3VwSWQsXG4gICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgZGlzYWJsZWQ6IGlzRGlzYWJsZWRcbiAgICAgIH0pKTtcblxuICAgICAgdmFyIGFkZEdyb3VwQ2hvaWNlcyA9IGZ1bmN0aW9uIGFkZEdyb3VwQ2hvaWNlcyhjaG9pY2UpIHtcbiAgICAgICAgdmFyIGlzT3B0RGlzYWJsZWQgPSBjaG9pY2UuZGlzYWJsZWQgfHwgY2hvaWNlLnBhcmVudE5vZGUgJiYgY2hvaWNlLnBhcmVudE5vZGUuZGlzYWJsZWQ7XG5cbiAgICAgICAgX3RoaXMyMC5fYWRkQ2hvaWNlKHtcbiAgICAgICAgICB2YWx1ZTogY2hvaWNlW3ZhbHVlS2V5XSxcbiAgICAgICAgICBsYWJlbDogaXNUeXBlKCdPYmplY3QnLCBjaG9pY2UpID8gY2hvaWNlW2xhYmVsS2V5XSA6IGNob2ljZS5pbm5lckhUTUwsXG4gICAgICAgICAgaXNTZWxlY3RlZDogY2hvaWNlLnNlbGVjdGVkLFxuICAgICAgICAgIGlzRGlzYWJsZWQ6IGlzT3B0RGlzYWJsZWQsXG4gICAgICAgICAgZ3JvdXBJZDogZ3JvdXBJZCxcbiAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBjaG9pY2UuY3VzdG9tUHJvcGVydGllcyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogY2hvaWNlLnBsYWNlaG9sZGVyXG4gICAgICAgIH0pO1xuICAgICAgfTtcblxuICAgICAgZ3JvdXBDaG9pY2VzLmZvckVhY2goYWRkR3JvdXBDaG9pY2VzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3RvcmUuZGlzcGF0Y2goZ3JvdXBzX2FkZEdyb3VwKHtcbiAgICAgICAgdmFsdWU6IGdyb3VwLmxhYmVsLFxuICAgICAgICBpZDogZ3JvdXAuaWQsXG4gICAgICAgIGFjdGl2ZTogZmFsc2UsXG4gICAgICAgIGRpc2FibGVkOiBncm91cC5kaXNhYmxlZFxuICAgICAgfSkpO1xuICAgIH1cbiAgfTtcblxuICBfcHJvdG8uX2dldFRlbXBsYXRlID0gZnVuY3Rpb24gX2dldFRlbXBsYXRlKHRlbXBsYXRlKSB7XG4gICAgdmFyIF90aGlzJF90ZW1wbGF0ZXMkdGVtcDtcblxuICAgIGlmICghdGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHZhciBjbGFzc05hbWVzID0gdGhpcy5jb25maWcuY2xhc3NOYW1lcztcblxuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHJldHVybiAoX3RoaXMkX3RlbXBsYXRlcyR0ZW1wID0gdGhpcy5fdGVtcGxhdGVzW3RlbXBsYXRlXSkuY2FsbC5hcHBseShfdGhpcyRfdGVtcGxhdGVzJHRlbXAsIFt0aGlzLCBjbGFzc05hbWVzXS5jb25jYXQoYXJncykpO1xuICB9O1xuXG4gIF9wcm90by5fY3JlYXRlVGVtcGxhdGVzID0gZnVuY3Rpb24gX2NyZWF0ZVRlbXBsYXRlcygpIHtcbiAgICB2YXIgY2FsbGJhY2tPbkNyZWF0ZVRlbXBsYXRlcyA9IHRoaXMuY29uZmlnLmNhbGxiYWNrT25DcmVhdGVUZW1wbGF0ZXM7XG4gICAgdmFyIHVzZXJUZW1wbGF0ZXMgPSB7fTtcblxuICAgIGlmIChjYWxsYmFja09uQ3JlYXRlVGVtcGxhdGVzICYmIHR5cGVvZiBjYWxsYmFja09uQ3JlYXRlVGVtcGxhdGVzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB1c2VyVGVtcGxhdGVzID0gY2FsbGJhY2tPbkNyZWF0ZVRlbXBsYXRlcy5jYWxsKHRoaXMsIHN0clRvRWwpO1xuICAgIH1cblxuICAgIHRoaXMuX3RlbXBsYXRlcyA9IGNqc19kZWZhdWx0KCkoVEVNUExBVEVTLCB1c2VyVGVtcGxhdGVzKTtcbiAgfTtcblxuICBfcHJvdG8uX2NyZWF0ZUVsZW1lbnRzID0gZnVuY3Rpb24gX2NyZWF0ZUVsZW1lbnRzKCkge1xuICAgIHRoaXMuY29udGFpbmVyT3V0ZXIgPSBuZXcgY29udGFpbmVyX0NvbnRhaW5lcih7XG4gICAgICBlbGVtZW50OiB0aGlzLl9nZXRUZW1wbGF0ZSgnY29udGFpbmVyT3V0ZXInLCB0aGlzLl9kaXJlY3Rpb24sIHRoaXMuX2lzU2VsZWN0RWxlbWVudCwgdGhpcy5faXNTZWxlY3RPbmVFbGVtZW50LCB0aGlzLmNvbmZpZy5zZWFyY2hFbmFibGVkLCB0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudC50eXBlKSxcbiAgICAgIGNsYXNzTmFtZXM6IHRoaXMuY29uZmlnLmNsYXNzTmFtZXMsXG4gICAgICB0eXBlOiB0aGlzLnBhc3NlZEVsZW1lbnQuZWxlbWVudC50eXBlLFxuICAgICAgcG9zaXRpb246IHRoaXMuY29uZmlnLnBvc2l0aW9uXG4gICAgfSk7XG4gICAgdGhpcy5jb250YWluZXJJbm5lciA9IG5ldyBjb250YWluZXJfQ29udGFpbmVyKHtcbiAgICAgIGVsZW1lbnQ6IHRoaXMuX2dldFRlbXBsYXRlKCdjb250YWluZXJJbm5lcicpLFxuICAgICAgY2xhc3NOYW1lczogdGhpcy5jb25maWcuY2xhc3NOYW1lcyxcbiAgICAgIHR5cGU6IHRoaXMucGFzc2VkRWxlbWVudC5lbGVtZW50LnR5cGUsXG4gICAgICBwb3NpdGlvbjogdGhpcy5jb25maWcucG9zaXRpb25cbiAgICB9KTtcbiAgICB0aGlzLmlucHV0ID0gbmV3IGlucHV0X0lucHV0KHtcbiAgICAgIGVsZW1lbnQ6IHRoaXMuX2dldFRlbXBsYXRlKCdpbnB1dCcsIHRoaXMuX3BsYWNlaG9sZGVyVmFsdWUpLFxuICAgICAgY2xhc3NOYW1lczogdGhpcy5jb25maWcuY2xhc3NOYW1lcyxcbiAgICAgIHR5cGU6IHRoaXMucGFzc2VkRWxlbWVudC5lbGVtZW50LnR5cGUsXG4gICAgICBwcmV2ZW50UGFzdGU6ICF0aGlzLmNvbmZpZy5wYXN0ZVxuICAgIH0pO1xuICAgIHRoaXMuY2hvaWNlTGlzdCA9IG5ldyBsaXN0X0xpc3Qoe1xuICAgICAgZWxlbWVudDogdGhpcy5fZ2V0VGVtcGxhdGUoJ2Nob2ljZUxpc3QnLCB0aGlzLl9pc1NlbGVjdE9uZUVsZW1lbnQpXG4gICAgfSk7XG4gICAgdGhpcy5pdGVtTGlzdCA9IG5ldyBsaXN0X0xpc3Qoe1xuICAgICAgZWxlbWVudDogdGhpcy5fZ2V0VGVtcGxhdGUoJ2l0ZW1MaXN0JywgdGhpcy5faXNTZWxlY3RPbmVFbGVtZW50KVxuICAgIH0pO1xuICAgIHRoaXMuZHJvcGRvd24gPSBuZXcgRHJvcGRvd24oe1xuICAgICAgZWxlbWVudDogdGhpcy5fZ2V0VGVtcGxhdGUoJ2Ryb3Bkb3duJyksXG4gICAgICBjbGFzc05hbWVzOiB0aGlzLmNvbmZpZy5jbGFzc05hbWVzLFxuICAgICAgdHlwZTogdGhpcy5wYXNzZWRFbGVtZW50LmVsZW1lbnQudHlwZVxuICAgIH0pO1xuICB9O1xuXG4gIF9wcm90by5fY3JlYXRlU3RydWN0dXJlID0gZnVuY3Rpb24gX2NyZWF0ZVN0cnVjdHVyZSgpIHtcbiAgICAvLyBIaWRlIG9yaWdpbmFsIGVsZW1lbnRcbiAgICB0aGlzLnBhc3NlZEVsZW1lbnQuY29uY2VhbCgpOyAvLyBXcmFwIGlucHV0IGluIGNvbnRhaW5lciBwcmVzZXJ2aW5nIERPTSBvcmRlcmluZ1xuXG4gICAgdGhpcy5jb250YWluZXJJbm5lci53cmFwKHRoaXMucGFzc2VkRWxlbWVudC5lbGVtZW50KTsgLy8gV3JhcHBlciBpbm5lciBjb250YWluZXIgd2l0aCBvdXRlciBjb250YWluZXJcblxuICAgIHRoaXMuY29udGFpbmVyT3V0ZXIud3JhcCh0aGlzLmNvbnRhaW5lcklubmVyLmVsZW1lbnQpO1xuXG4gICAgaWYgKHRoaXMuX2lzU2VsZWN0T25lRWxlbWVudCkge1xuICAgICAgdGhpcy5pbnB1dC5wbGFjZWhvbGRlciA9IHRoaXMuY29uZmlnLnNlYXJjaFBsYWNlaG9sZGVyVmFsdWUgfHwgJyc7XG4gICAgfSBlbHNlIGlmICh0aGlzLl9wbGFjZWhvbGRlclZhbHVlKSB7XG4gICAgICB0aGlzLmlucHV0LnBsYWNlaG9sZGVyID0gdGhpcy5fcGxhY2Vob2xkZXJWYWx1ZTtcbiAgICAgIHRoaXMuaW5wdXQuc2V0V2lkdGgoKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvbnRhaW5lck91dGVyLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXJJbm5lci5lbGVtZW50KTtcbiAgICB0aGlzLmNvbnRhaW5lck91dGVyLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5kcm9wZG93bi5lbGVtZW50KTtcbiAgICB0aGlzLmNvbnRhaW5lcklubmVyLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5pdGVtTGlzdC5lbGVtZW50KTtcblxuICAgIGlmICghdGhpcy5faXNUZXh0RWxlbWVudCkge1xuICAgICAgdGhpcy5kcm9wZG93bi5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuY2hvaWNlTGlzdC5lbGVtZW50KTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX2lzU2VsZWN0T25lRWxlbWVudCkge1xuICAgICAgdGhpcy5jb250YWluZXJJbm5lci5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMuaW5wdXQuZWxlbWVudCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbmZpZy5zZWFyY2hFbmFibGVkKSB7XG4gICAgICB0aGlzLmRyb3Bkb3duLmVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMuaW5wdXQuZWxlbWVudCwgdGhpcy5kcm9wZG93bi5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9pc1NlbGVjdEVsZW1lbnQpIHtcbiAgICAgIHRoaXMuX2hpZ2hsaWdodFBvc2l0aW9uID0gMDtcbiAgICAgIHRoaXMuX2lzU2VhcmNoaW5nID0gZmFsc2U7XG5cbiAgICAgIHRoaXMuX3N0YXJ0TG9hZGluZygpO1xuXG4gICAgICBpZiAodGhpcy5fcHJlc2V0R3JvdXBzLmxlbmd0aCkge1xuICAgICAgICB0aGlzLl9hZGRQcmVkZWZpbmVkR3JvdXBzKHRoaXMuX3ByZXNldEdyb3Vwcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9hZGRQcmVkZWZpbmVkQ2hvaWNlcyh0aGlzLl9wcmVzZXRDaG9pY2VzKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5fc3RvcExvYWRpbmcoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5faXNUZXh0RWxlbWVudCkge1xuICAgICAgdGhpcy5fYWRkUHJlZGVmaW5lZEl0ZW1zKHRoaXMuX3ByZXNldEl0ZW1zKTtcbiAgICB9XG4gIH07XG5cbiAgX3Byb3RvLl9hZGRQcmVkZWZpbmVkR3JvdXBzID0gZnVuY3Rpb24gX2FkZFByZWRlZmluZWRHcm91cHMoZ3JvdXBzKSB7XG4gICAgdmFyIF90aGlzMjEgPSB0aGlzO1xuXG4gICAgLy8gSWYgd2UgaGF2ZSBhIHBsYWNlaG9sZGVyIG9wdGlvblxuICAgIHZhciBwbGFjZWhvbGRlckNob2ljZSA9IHRoaXMucGFzc2VkRWxlbWVudC5wbGFjZWhvbGRlck9wdGlvbjtcblxuICAgIGlmIChwbGFjZWhvbGRlckNob2ljZSAmJiBwbGFjZWhvbGRlckNob2ljZS5wYXJlbnROb2RlLnRhZ05hbWUgPT09ICdTRUxFQ1QnKSB7XG4gICAgICB0aGlzLl9hZGRDaG9pY2Uoe1xuICAgICAgICB2YWx1ZTogcGxhY2Vob2xkZXJDaG9pY2UudmFsdWUsXG4gICAgICAgIGxhYmVsOiBwbGFjZWhvbGRlckNob2ljZS5pbm5lckhUTUwsXG4gICAgICAgIGlzU2VsZWN0ZWQ6IHBsYWNlaG9sZGVyQ2hvaWNlLnNlbGVjdGVkLFxuICAgICAgICBpc0Rpc2FibGVkOiBwbGFjZWhvbGRlckNob2ljZS5kaXNhYmxlZCxcbiAgICAgICAgcGxhY2Vob2xkZXI6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuICAgICAgcmV0dXJuIF90aGlzMjEuX2FkZEdyb3VwKHtcbiAgICAgICAgZ3JvdXA6IGdyb3VwLFxuICAgICAgICBpZDogZ3JvdXAuaWQgfHwgbnVsbFxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLl9hZGRQcmVkZWZpbmVkQ2hvaWNlcyA9IGZ1bmN0aW9uIF9hZGRQcmVkZWZpbmVkQ2hvaWNlcyhjaG9pY2VzKSB7XG4gICAgdmFyIF90aGlzMjIgPSB0aGlzO1xuXG4gICAgLy8gSWYgc29ydGluZyBpcyBlbmFibGVkIG9yIHRoZSB1c2VyIGlzIHNlYXJjaGluZywgZmlsdGVyIGNob2ljZXNcbiAgICBpZiAodGhpcy5jb25maWcuc2hvdWxkU29ydCkge1xuICAgICAgY2hvaWNlcy5zb3J0KHRoaXMuY29uZmlnLnNvcnRlcik7XG4gICAgfVxuXG4gICAgdmFyIGhhc1NlbGVjdGVkQ2hvaWNlID0gY2hvaWNlcy5zb21lKGZ1bmN0aW9uIChjaG9pY2UpIHtcbiAgICAgIHJldHVybiBjaG9pY2Uuc2VsZWN0ZWQ7XG4gICAgfSk7XG4gICAgdmFyIGZpcnN0RW5hYmxlZENob2ljZUluZGV4ID0gY2hvaWNlcy5maW5kSW5kZXgoZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgcmV0dXJuIGNob2ljZS5kaXNhYmxlZCA9PT0gdW5kZWZpbmVkIHx8ICFjaG9pY2UuZGlzYWJsZWQ7XG4gICAgfSk7XG4gICAgY2hvaWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChjaG9pY2UsIGluZGV4KSB7XG4gICAgICB2YXIgdmFsdWUgPSBjaG9pY2UudmFsdWUsXG4gICAgICAgICAgbGFiZWwgPSBjaG9pY2UubGFiZWwsXG4gICAgICAgICAgY3VzdG9tUHJvcGVydGllcyA9IGNob2ljZS5jdXN0b21Qcm9wZXJ0aWVzLFxuICAgICAgICAgIHBsYWNlaG9sZGVyID0gY2hvaWNlLnBsYWNlaG9sZGVyO1xuXG4gICAgICBpZiAoX3RoaXMyMi5faXNTZWxlY3RFbGVtZW50KSB7XG4gICAgICAgIC8vIElmIHRoZSBjaG9pY2UgaXMgYWN0dWFsbHkgYSBncm91cFxuICAgICAgICBpZiAoY2hvaWNlLmNob2ljZXMpIHtcbiAgICAgICAgICBfdGhpczIyLl9hZGRHcm91cCh7XG4gICAgICAgICAgICBncm91cDogY2hvaWNlLFxuICAgICAgICAgICAgaWQ6IGNob2ljZS5pZCB8fCBudWxsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogSWYgdGhlcmUgaXMgYSBzZWxlY3RlZCBjaG9pY2UgYWxyZWFkeSBvciB0aGUgY2hvaWNlIGlzIG5vdCB0aGUgZmlyc3QgaW5cbiAgICAgICAgICAgKiB0aGUgYXJyYXksIGFkZCBlYWNoIGNob2ljZSBub3JtYWxseS5cbiAgICAgICAgICAgKlxuICAgICAgICAgICAqIE90aGVyd2lzZSB3ZSBwcmUtc2VsZWN0IHRoZSBmaXJzdCBlbmFibGVkIGNob2ljZSBpbiB0aGUgYXJyYXkgKFwic2VsZWN0LW9uZVwiIG9ubHkpXG4gICAgICAgICAgICovXG4gICAgICAgICAgdmFyIHNob3VsZFByZXNlbGVjdCA9IF90aGlzMjIuX2lzU2VsZWN0T25lRWxlbWVudCAmJiAhaGFzU2VsZWN0ZWRDaG9pY2UgJiYgaW5kZXggPT09IGZpcnN0RW5hYmxlZENob2ljZUluZGV4O1xuICAgICAgICAgIHZhciBpc1NlbGVjdGVkID0gc2hvdWxkUHJlc2VsZWN0ID8gdHJ1ZSA6IGNob2ljZS5zZWxlY3RlZDtcbiAgICAgICAgICB2YXIgaXNEaXNhYmxlZCA9IGNob2ljZS5kaXNhYmxlZDtcblxuICAgICAgICAgIF90aGlzMjIuX2FkZENob2ljZSh7XG4gICAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgICAgICBpc1NlbGVjdGVkOiBpc1NlbGVjdGVkLFxuICAgICAgICAgICAgaXNEaXNhYmxlZDogaXNEaXNhYmxlZCxcbiAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMyMi5fYWRkQ2hvaWNlKHtcbiAgICAgICAgICB2YWx1ZTogdmFsdWUsXG4gICAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICAgIGlzU2VsZWN0ZWQ6IGNob2ljZS5zZWxlY3RlZCxcbiAgICAgICAgICBpc0Rpc2FibGVkOiBjaG9pY2UuZGlzYWJsZWQsXG4gICAgICAgICAgY3VzdG9tUHJvcGVydGllczogY3VzdG9tUHJvcGVydGllcyxcbiAgICAgICAgICBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEBwYXJhbSB7SXRlbVtdfSBpdGVtc1xuICAgKi9cbiAgO1xuXG4gIF9wcm90by5fYWRkUHJlZGVmaW5lZEl0ZW1zID0gZnVuY3Rpb24gX2FkZFByZWRlZmluZWRJdGVtcyhpdGVtcykge1xuICAgIHZhciBfdGhpczIzID0gdGhpcztcblxuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ29iamVjdCcgJiYgaXRlbS52YWx1ZSkge1xuICAgICAgICBfdGhpczIzLl9hZGRJdGVtKHtcbiAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICBsYWJlbDogaXRlbS5sYWJlbCxcbiAgICAgICAgICBjaG9pY2VJZDogaXRlbS5pZCxcbiAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBpdGVtLmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgICAgcGxhY2Vob2xkZXI6IGl0ZW0ucGxhY2Vob2xkZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgX3RoaXMyMy5fYWRkSXRlbSh7XG4gICAgICAgICAgdmFsdWU6IGl0ZW1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgX3Byb3RvLl9zZXRDaG9pY2VPckl0ZW0gPSBmdW5jdGlvbiBfc2V0Q2hvaWNlT3JJdGVtKGl0ZW0pIHtcbiAgICB2YXIgX3RoaXMyNCA9IHRoaXM7XG5cbiAgICB2YXIgaXRlbVR5cGUgPSBnZXRUeXBlKGl0ZW0pLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIGhhbmRsZVR5cGUgPSB7XG4gICAgICBvYmplY3Q6IGZ1bmN0aW9uIG9iamVjdCgpIHtcbiAgICAgICAgaWYgKCFpdGVtLnZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IC8vIElmIHdlIGFyZSBkZWFsaW5nIHdpdGggYSBzZWxlY3QgaW5wdXQsIHdlIG5lZWQgdG8gY3JlYXRlIGFuIG9wdGlvbiBmaXJzdFxuICAgICAgICAvLyB0aGF0IGlzIHRoZW4gc2VsZWN0ZWQuIEZvciB0ZXh0IGlucHV0cyB3ZSBjYW4ganVzdCBhZGQgaXRlbXMgbm9ybWFsbHkuXG5cblxuICAgICAgICBpZiAoIV90aGlzMjQuX2lzVGV4dEVsZW1lbnQpIHtcbiAgICAgICAgICBfdGhpczI0Ll9hZGRDaG9pY2Uoe1xuICAgICAgICAgICAgdmFsdWU6IGl0ZW0udmFsdWUsXG4gICAgICAgICAgICBsYWJlbDogaXRlbS5sYWJlbCxcbiAgICAgICAgICAgIGlzU2VsZWN0ZWQ6IHRydWUsXG4gICAgICAgICAgICBpc0Rpc2FibGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGl0ZW0uY3VzdG9tUHJvcGVydGllcyxcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBpdGVtLnBsYWNlaG9sZGVyXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMyNC5fYWRkSXRlbSh7XG4gICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgICAgIGxhYmVsOiBpdGVtLmxhYmVsLFxuICAgICAgICAgICAgY2hvaWNlSWQ6IGl0ZW0uaWQsXG4gICAgICAgICAgICBjdXN0b21Qcm9wZXJ0aWVzOiBpdGVtLmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgICAgICBwbGFjZWhvbGRlcjogaXRlbS5wbGFjZWhvbGRlclxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc3RyaW5nOiBmdW5jdGlvbiBzdHJpbmcoKSB7XG4gICAgICAgIGlmICghX3RoaXMyNC5faXNUZXh0RWxlbWVudCkge1xuICAgICAgICAgIF90aGlzMjQuX2FkZENob2ljZSh7XG4gICAgICAgICAgICB2YWx1ZTogaXRlbSxcbiAgICAgICAgICAgIGxhYmVsOiBpdGVtLFxuICAgICAgICAgICAgaXNTZWxlY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgIGlzRGlzYWJsZWQ6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3RoaXMyNC5fYWRkSXRlbSh7XG4gICAgICAgICAgICB2YWx1ZTogaXRlbVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBoYW5kbGVUeXBlW2l0ZW1UeXBlXSgpO1xuICB9O1xuXG4gIF9wcm90by5fZmluZEFuZFNlbGVjdENob2ljZUJ5VmFsdWUgPSBmdW5jdGlvbiBfZmluZEFuZFNlbGVjdENob2ljZUJ5VmFsdWUodmFsKSB7XG4gICAgdmFyIF90aGlzMjUgPSB0aGlzO1xuXG4gICAgdmFyIGNob2ljZXMgPSB0aGlzLl9zdG9yZS5jaG9pY2VzOyAvLyBDaGVjayAndmFsdWUnIHByb3BlcnR5IGV4aXN0cyBhbmQgdGhlIGNob2ljZSBpc24ndCBhbHJlYWR5IHNlbGVjdGVkXG5cbiAgICB2YXIgZm91bmRDaG9pY2UgPSBjaG9pY2VzLmZpbmQoZnVuY3Rpb24gKGNob2ljZSkge1xuICAgICAgcmV0dXJuIF90aGlzMjUuY29uZmlnLnZhbHVlQ29tcGFyZXIoY2hvaWNlLnZhbHVlLCB2YWwpO1xuICAgIH0pO1xuXG4gICAgaWYgKGZvdW5kQ2hvaWNlICYmICFmb3VuZENob2ljZS5zZWxlY3RlZCkge1xuICAgICAgdGhpcy5fYWRkSXRlbSh7XG4gICAgICAgIHZhbHVlOiBmb3VuZENob2ljZS52YWx1ZSxcbiAgICAgICAgbGFiZWw6IGZvdW5kQ2hvaWNlLmxhYmVsLFxuICAgICAgICBjaG9pY2VJZDogZm91bmRDaG9pY2UuaWQsXG4gICAgICAgIGdyb3VwSWQ6IGZvdW5kQ2hvaWNlLmdyb3VwSWQsXG4gICAgICAgIGN1c3RvbVByb3BlcnRpZXM6IGZvdW5kQ2hvaWNlLmN1c3RvbVByb3BlcnRpZXMsXG4gICAgICAgIHBsYWNlaG9sZGVyOiBmb3VuZENob2ljZS5wbGFjZWhvbGRlcixcbiAgICAgICAga2V5Q29kZTogZm91bmRDaG9pY2Uua2V5Q29kZVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5fZ2VuZXJhdGVQbGFjZWhvbGRlclZhbHVlID0gZnVuY3Rpb24gX2dlbmVyYXRlUGxhY2Vob2xkZXJWYWx1ZSgpIHtcbiAgICBpZiAodGhpcy5faXNTZWxlY3RFbGVtZW50KSB7XG4gICAgICB2YXIgcGxhY2Vob2xkZXJPcHRpb24gPSB0aGlzLnBhc3NlZEVsZW1lbnQucGxhY2Vob2xkZXJPcHRpb247XG4gICAgICByZXR1cm4gcGxhY2Vob2xkZXJPcHRpb24gPyBwbGFjZWhvbGRlck9wdGlvbi50ZXh0IDogZmFsc2U7XG4gICAgfVxuXG4gICAgdmFyIF90aGlzJGNvbmZpZzQgPSB0aGlzLmNvbmZpZyxcbiAgICAgICAgcGxhY2Vob2xkZXIgPSBfdGhpcyRjb25maWc0LnBsYWNlaG9sZGVyLFxuICAgICAgICBwbGFjZWhvbGRlclZhbHVlID0gX3RoaXMkY29uZmlnNC5wbGFjZWhvbGRlclZhbHVlO1xuICAgIHZhciBkYXRhc2V0ID0gdGhpcy5wYXNzZWRFbGVtZW50LmVsZW1lbnQuZGF0YXNldDtcblxuICAgIGlmIChwbGFjZWhvbGRlcikge1xuICAgICAgaWYgKHBsYWNlaG9sZGVyVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHBsYWNlaG9sZGVyVmFsdWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRhc2V0LnBsYWNlaG9sZGVyKSB7XG4gICAgICAgIHJldHVybiBkYXRhc2V0LnBsYWNlaG9sZGVyO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICByZXR1cm4gQ2hvaWNlcztcbn0oKTtcblxuLyogaGFybW9ueSBkZWZhdWx0IGV4cG9ydCAqLyB2YXIgc2NyaXB0c19jaG9pY2VzID0gX193ZWJwYWNrX2V4cG9ydHNfX1tcImRlZmF1bHRcIl0gPSAoY2hvaWNlc19DaG9pY2VzKTtcblxuLyoqKi8gfSlcbi8qKioqKiovIF0pW1wiZGVmYXVsdFwiXTtcbn0pOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/choices.js/public/assets/scripts/choices.js\n");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/***/ ((module) => {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzP2YyOGMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBOztBQUVBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsVUFBVSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/process/browser.js\n");

/***/ }),

/***/ "./node_modules/tabulator-tables/dist/js/tabulator.es2015.js":
/*!*******************************************************************!*\
  !*** ./node_modules/tabulator-tables/dist/js/tabulator.es2015.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* Tabulator v4.9.3 (c) Oliver Folkerd */\n\n\n\n// https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nif (!Array.prototype.findIndex) {\n\n\tObject.defineProperty(Array.prototype, 'findIndex', {\n\n\t\tvalue: function value(predicate) {\n\n\t\t\t// 1. Let O be ? ToObject(this value).\n\n\t\t\tif (this == null) {\n\n\t\t\t\tthrow new TypeError('\"this\" is null or not defined');\n\t\t\t}\n\n\t\t\tvar o = Object(this);\n\n\t\t\t// 2. Let len be ? ToLength(? Get(O, \"length\")).\n\n\t\t\tvar len = o.length >>> 0;\n\n\t\t\t// 3. If IsCallable(predicate) is false, throw a TypeError exception.\n\n\t\t\tif (typeof predicate !== 'function') {\n\n\t\t\t\tthrow new TypeError('predicate must be a function');\n\t\t\t}\n\n\t\t\t// 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n\n\t\t\tvar thisArg = arguments[1];\n\n\t\t\t// 5. Let k be 0.\n\n\t\t\tvar k = 0;\n\n\t\t\t// 6. Repeat, while k < len\n\n\t\t\twhile (k < len) {\n\n\t\t\t\t// a. Let Pk be ! ToString(k).\n\n\t\t\t\t// b. Let kValue be ? Get(O, Pk).\n\n\t\t\t\t// c. Let testResult be ToBoolean(? Call(predicate, T,  kValue, k, O )).\n\n\t\t\t\t// d. If testResult is true, return k.\n\n\t\t\t\tvar kValue = o[k];\n\n\t\t\t\tif (predicate.call(thisArg, kValue, k, o)) {\n\n\t\t\t\t\treturn k;\n\t\t\t\t}\n\n\t\t\t\t// e. Increase k by 1.\n\n\t\t\t\tk++;\n\t\t\t}\n\n\t\t\t// 7. Return -1.\n\n\t\t\treturn -1;\n\t\t}\n\n\t});\n}\n\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n\nif (!Array.prototype.find) {\n\n\tObject.defineProperty(Array.prototype, 'find', {\n\n\t\tvalue: function value(predicate) {\n\n\t\t\t// 1. Let O be ? ToObject(this value).\n\n\t\t\tif (this == null) {\n\n\t\t\t\tthrow new TypeError('\"this\" is null or not defined');\n\t\t\t}\n\n\t\t\tvar o = Object(this);\n\n\t\t\t// 2. Let len be ? ToLength(? Get(O, \"length\")).\n\n\t\t\tvar len = o.length >>> 0;\n\n\t\t\t// 3. If IsCallable(predicate) is false, throw a TypeError exception.\n\n\t\t\tif (typeof predicate !== 'function') {\n\n\t\t\t\tthrow new TypeError('predicate must be a function');\n\t\t\t}\n\n\t\t\t// 4. If thisArg was supplied, let T be thisArg; else let T be undefined.\n\n\t\t\tvar thisArg = arguments[1];\n\n\t\t\t// 5. Let k be 0.\n\n\t\t\tvar k = 0;\n\n\t\t\t// 6. Repeat, while k < len\n\n\t\t\twhile (k < len) {\n\n\t\t\t\t// a. Let Pk be ! ToString(k).\n\n\t\t\t\t// b. Let kValue be ? Get(O, Pk).\n\n\t\t\t\t// c. Let testResult be ToBoolean(? Call(predicate, T,  kValue, k, O )).\n\n\t\t\t\t// d. If testResult is true, return kValue.\n\n\t\t\t\tvar kValue = o[k];\n\n\t\t\t\tif (predicate.call(thisArg, kValue, k, o)) {\n\n\t\t\t\t\treturn kValue;\n\t\t\t\t}\n\n\t\t\t\t// e. Increase k by 1.\n\n\t\t\t\tk++;\n\t\t\t}\n\n\t\t\t// 7. Return undefined.\n\n\t\t\treturn undefined;\n\t\t}\n\n\t});\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes#Polyfill\n\nif (!String.prototype.includes) {\n\n\tString.prototype.includes = function (search, start) {\n\n\t\t'use strict';\n\n\t\tif (search instanceof RegExp) {\n\n\t\t\tthrow TypeError('first argument must not be a RegExp');\n\t\t}\n\n\t\tif (start === undefined) {\n\t\t\tstart = 0;\n\t\t}\n\n\t\treturn this.indexOf(search, start) !== -1;\n\t};\n}\n\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n\nif (!Array.prototype.includes) {\n\n\tObject.defineProperty(Array.prototype, 'includes', {\n\n\t\tvalue: function value(searchElement, fromIndex) {\n\n\t\t\tif (this == null) {\n\n\t\t\t\tthrow new TypeError('\"this\" is null or not defined');\n\t\t\t}\n\n\t\t\t// 1. Let O be ? ToObject(this value).\n\n\t\t\tvar o = Object(this);\n\n\t\t\t// 2. Let len be ? ToLength(? Get(O, \"length\")).\n\n\t\t\tvar len = o.length >>> 0;\n\n\t\t\t// 3. If len is 0, return false.\n\n\t\t\tif (len === 0) {\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// 4. Let n be ? ToInteger(fromIndex).\n\n\t\t\t//    (If fromIndex is undefined, this step produces the value 0.)\n\n\t\t\tvar n = fromIndex | 0;\n\n\t\t\t// 5. If n  0, then\n\n\t\t\t//  a. Let k be n.\n\n\t\t\t// 6. Else n < 0,\n\n\t\t\t//  a. Let k be len + n.\n\n\t\t\t//  b. If k < 0, let k be 0.\n\n\t\t\tvar k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n\t\t\tfunction sameValueZero(x, y) {\n\n\t\t\t\treturn x === y || typeof x === 'number' && typeof y === 'number' && isNaN(x) && isNaN(y);\n\t\t\t}\n\n\t\t\t// 7. Repeat, while k < len\n\n\t\t\twhile (k < len) {\n\n\t\t\t\t// a. Let elementK be the result of ? Get(O, ! ToString(k)).\n\n\t\t\t\t// b. If SameValueZero(searchElement, elementK) is true, return true.\n\n\t\t\t\tif (sameValueZero(o[k], searchElement)) {\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t// c. Increase k by 1.\n\n\t\t\t\tk++;\n\t\t\t}\n\n\t\t\t// 8. Return false\n\n\t\t\treturn false;\n\t\t}\n\n\t});\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill\n\nif (typeof Object.assign !== 'function') {\n\n\t// Must be writable: true, enumerable: false, configurable: true\n\n\tObject.defineProperty(Object, \"assign\", {\n\n\t\tvalue: function assign(target, varArgs) {\n\t\t\t// .length of function is 2\n\n\t\t\t'use strict';\n\n\t\t\tif (target === null || target === undefined) {\n\n\t\t\t\tthrow new TypeError('Cannot convert undefined or null to object');\n\t\t\t}\n\n\t\t\tvar to = Object(target);\n\n\t\t\tfor (var index = 1; index < arguments.length; index++) {\n\n\t\t\t\tvar nextSource = arguments[index];\n\n\t\t\t\tif (nextSource !== null && nextSource !== undefined) {\n\n\t\t\t\t\tfor (var nextKey in nextSource) {\n\n\t\t\t\t\t\t// Avoid bugs when hasOwnProperty is shadowed\n\n\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n\n\t\t\t\t\t\t\tto[nextKey] = nextSource[nextKey];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn to;\n\t\t},\n\n\t\twritable: true,\n\n\t\tconfigurable: true\n\n\t});\n}\n\nvar ColumnManager = function ColumnManager(table) {\n\n\tthis.table = table; //hold parent table\n\n\tthis.blockHozScrollEvent = false;\n\n\tthis.headersElement = this.createHeadersElement();\n\n\tthis.element = this.createHeaderElement(); //containing element\n\n\tthis.rowManager = null; //hold row manager object\n\n\tthis.columns = []; // column definition object\n\n\tthis.columnsByIndex = []; //columns by index\n\n\tthis.columnsByField = {}; //columns by field\n\n\tthis.scrollLeft = 0;\n\n\tthis.element.insertBefore(this.headersElement, this.element.firstChild);\n};\n\n////////////// Setup Functions /////////////////\n\n\nColumnManager.prototype.createHeadersElement = function () {\n\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-headers\");\n\n\treturn el;\n};\n\nColumnManager.prototype.createHeaderElement = function () {\n\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-header\");\n\n\tif (!this.table.options.headerVisible) {\n\n\t\tel.classList.add(\"tabulator-header-hidden\");\n\t}\n\n\treturn el;\n};\n\nColumnManager.prototype.initialize = function () {\n\n\tvar self = this;\n\n\t//scroll body along with header\n\n\t// self.element.addEventListener(\"scroll\", function(e){\n\n\t// \tif(!self.blockHozScrollEvent){\n\n\t// \t\tself.table.rowManager.scrollHorizontal(self.element.scrollLeft);\n\n\t// \t}\n\n\t// });\n};\n\n//link to row manager\n\nColumnManager.prototype.setRowManager = function (manager) {\n\n\tthis.rowManager = manager;\n};\n\n//return containing element\n\nColumnManager.prototype.getElement = function () {\n\n\treturn this.element;\n};\n\n//return header containing element\n\nColumnManager.prototype.getHeadersElement = function () {\n\n\treturn this.headersElement;\n};\n\n// ColumnManager.prototype.tempScrollBlock = function(){\n\n// \tclearTimeout(this.blockHozScrollEvent);\n\n// \tthis.blockHozScrollEvent = setTimeout(() => {this.blockHozScrollEvent = false;}, 50);\n\n// }\n\n\n//scroll horizontally to match table body\n\nColumnManager.prototype.scrollHorizontal = function (left) {\n\n\tvar hozAdjust = 0,\n\t    scrollWidth = this.element.scrollWidth - this.table.element.clientWidth;\n\n\t// this.tempScrollBlock();\n\n\tthis.element.scrollLeft = left;\n\n\t//adjust for vertical scrollbar moving table when present\n\n\tif (left > scrollWidth) {\n\n\t\thozAdjust = left - scrollWidth;\n\n\t\tthis.element.style.marginLeft = -hozAdjust + \"px\";\n\t} else {\n\n\t\tthis.element.style.marginLeft = 0;\n\t}\n\n\t//keep frozen columns fixed in position\n\n\t//this._calcFrozenColumnsPos(hozAdjust + 3);\n\n\n\tthis.scrollLeft = left;\n\n\tif (this.table.modExists(\"frozenColumns\")) {\n\n\t\tthis.table.modules.frozenColumns.scrollHorizontal();\n\t}\n};\n\n///////////// Column Setup Functions /////////////\n\n\nColumnManager.prototype.generateColumnsFromRowData = function (data) {\n\n\tvar cols = [],\n\t    definitions = this.table.options.autoColumnsDefinitions,\n\t    row,\n\t    sorter;\n\n\tif (data && data.length) {\n\n\t\trow = data[0];\n\n\t\tfor (var key in row) {\n\n\t\t\tvar col = {\n\n\t\t\t\tfield: key,\n\n\t\t\t\ttitle: key\n\n\t\t\t};\n\n\t\t\tvar value = row[key];\n\n\t\t\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\n\t\t\t\tcase \"undefined\":\n\n\t\t\t\t\tsorter = \"string\";\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"boolean\":\n\n\t\t\t\t\tsorter = \"boolean\";\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"object\":\n\n\t\t\t\t\tif (Array.isArray(value)) {\n\n\t\t\t\t\t\tsorter = \"array\";\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\n\t\t\t\t\tif (!isNaN(value) && value !== \"\") {\n\n\t\t\t\t\t\tsorter = \"number\";\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif (value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)) {\n\n\t\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tcol.sorter = sorter;\n\n\t\t\tcols.push(col);\n\t\t}\n\n\t\tif (definitions) {\n\n\t\t\tswitch (typeof definitions === 'undefined' ? 'undefined' : _typeof(definitions)) {\n\n\t\t\t\tcase \"function\":\n\n\t\t\t\t\tthis.table.options.columns = definitions.call(this.table, cols);\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"object\":\n\n\t\t\t\t\tif (Array.isArray(definitions)) {\n\n\t\t\t\t\t\tcols.forEach(function (col) {\n\n\t\t\t\t\t\t\tvar match = definitions.find(function (def) {\n\n\t\t\t\t\t\t\t\treturn def.field === col.field;\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif (match) {\n\n\t\t\t\t\t\t\t\tObject.assign(col, match);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tcols.forEach(function (col) {\n\n\t\t\t\t\t\t\tif (definitions[col.field]) {\n\n\t\t\t\t\t\t\t\tObject.assign(col, definitions[col.field]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.table.options.columns = cols;\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t} else {\n\n\t\t\tthis.table.options.columns = cols;\n\t\t}\n\n\t\tthis.setColumns(this.table.options.columns);\n\t}\n};\n\nColumnManager.prototype.setColumns = function (cols, row) {\n\n\tvar self = this;\n\n\twhile (self.headersElement.firstChild) {\n\t\tself.headersElement.removeChild(self.headersElement.firstChild);\n\t}self.columns = [];\n\n\tself.columnsByIndex = [];\n\n\tself.columnsByField = {};\n\n\t//reset frozen columns\n\n\tif (self.table.modExists(\"frozenColumns\")) {\n\n\t\tself.table.modules.frozenColumns.reset();\n\t}\n\n\tcols.forEach(function (def, i) {\n\n\t\tself._addColumn(def);\n\t});\n\n\tself._reIndexColumns();\n\n\tif (self.table.options.responsiveLayout && self.table.modExists(\"responsiveLayout\", true)) {\n\n\t\tself.table.modules.responsiveLayout.initialize();\n\t}\n\n\tif (this.table.options.virtualDomHoz) {\n\n\t\tthis.table.vdomHoz.reinitialize(false, true);\n\t}\n\n\tself.redraw(true);\n};\n\nColumnManager.prototype._addColumn = function (definition, before, nextToColumn) {\n\n\tvar column = new Column(definition, this),\n\t    colEl = column.getElement(),\n\t    index = nextToColumn ? this.findColumnIndex(nextToColumn) : nextToColumn;\n\n\tif (nextToColumn && index > -1) {\n\n\t\tvar parentIndex = this.columns.indexOf(nextToColumn.getTopColumn());\n\n\t\tvar nextEl = nextToColumn.getElement();\n\n\t\tif (before) {\n\n\t\t\tthis.columns.splice(parentIndex, 0, column);\n\n\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl);\n\t\t} else {\n\n\t\t\tthis.columns.splice(parentIndex + 1, 0, column);\n\n\t\t\tnextEl.parentNode.insertBefore(colEl, nextEl.nextSibling);\n\t\t}\n\t} else {\n\n\t\tif (before) {\n\n\t\t\tthis.columns.unshift(column);\n\n\t\t\tthis.headersElement.insertBefore(column.getElement(), this.headersElement.firstChild);\n\t\t} else {\n\n\t\t\tthis.columns.push(column);\n\n\t\t\tthis.headersElement.appendChild(column.getElement());\n\t\t}\n\n\t\tcolumn.columnRendered();\n\t}\n\n\treturn column;\n};\n\nColumnManager.prototype.registerColumnField = function (col) {\n\n\tif (col.definition.field) {\n\n\t\tthis.columnsByField[col.definition.field] = col;\n\t}\n};\n\nColumnManager.prototype.registerColumnPosition = function (col) {\n\n\tthis.columnsByIndex.push(col);\n};\n\nColumnManager.prototype._reIndexColumns = function () {\n\n\tthis.columnsByIndex = [];\n\n\tthis.columns.forEach(function (column) {\n\n\t\tcolumn.reRegisterPosition();\n\t});\n};\n\n//ensure column headers take up the correct amount of space in column groups\n\nColumnManager.prototype._verticalAlignHeaders = function () {\n\n\tvar self = this,\n\t    minHeight = 0;\n\n\tself.columns.forEach(function (column) {\n\n\t\tvar height;\n\n\t\tcolumn.clearVerticalAlign();\n\n\t\theight = column.getHeight();\n\n\t\tif (height > minHeight) {\n\n\t\t\tminHeight = height;\n\t\t}\n\t});\n\n\tself.columns.forEach(function (column) {\n\n\t\tcolumn.verticalAlign(self.table.options.columnHeaderVertAlign, minHeight);\n\t});\n\n\tself.rowManager.adjustTableSize();\n};\n\n//////////////// Column Details /////////////////\n\n\nColumnManager.prototype.findColumn = function (subject) {\n\n\tvar self = this;\n\n\tif ((typeof subject === 'undefined' ? 'undefined' : _typeof(subject)) == \"object\") {\n\n\t\tif (subject instanceof Column) {\n\n\t\t\t//subject is column element\n\n\t\t\treturn subject;\n\t\t} else if (subject instanceof ColumnComponent) {\n\n\t\t\t//subject is public column component\n\n\t\t\treturn subject._getSelf() || false;\n\t\t} else if (typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement) {\n\n\t\t\t//subject is a HTML element of the column header\n\n\t\t\tvar match = self.columns.find(function (column) {\n\n\t\t\t\treturn column.element === subject;\n\t\t\t});\n\n\t\t\treturn match || false;\n\t\t}\n\t} else {\n\n\t\t//subject should be treated as the field name of the column\n\n\t\treturn this.columnsByField[subject] || false;\n\t}\n\n\t//catch all for any other type of input\n\n\n\treturn false;\n};\n\nColumnManager.prototype.getColumnByField = function (field) {\n\n\treturn this.columnsByField[field];\n};\n\nColumnManager.prototype.getColumnsByFieldRoot = function (root) {\n\tvar _this = this;\n\n\tvar matches = [];\n\n\tObject.keys(this.columnsByField).forEach(function (field) {\n\n\t\tvar fieldRoot = field.split(\".\")[0];\n\n\t\tif (fieldRoot === root) {\n\n\t\t\tmatches.push(_this.columnsByField[field]);\n\t\t}\n\t});\n\n\treturn matches;\n};\n\nColumnManager.prototype.getColumnByIndex = function (index) {\n\n\treturn this.columnsByIndex[index];\n};\n\nColumnManager.prototype.getFirstVisibileColumn = function (index) {\n\n\tvar index = this.columnsByIndex.findIndex(function (col) {\n\n\t\treturn col.visible;\n\t});\n\n\treturn index > -1 ? this.columnsByIndex[index] : false;\n};\n\nColumnManager.prototype.getColumns = function () {\n\n\treturn this.columns;\n};\n\nColumnManager.prototype.findColumnIndex = function (column) {\n\n\treturn this.columnsByIndex.findIndex(function (col) {\n\n\t\treturn column === col;\n\t});\n};\n\n//return all columns that are not groups\n\nColumnManager.prototype.getRealColumns = function () {\n\n\treturn this.columnsByIndex;\n};\n\n//travers across columns and call action\n\nColumnManager.prototype.traverse = function (callback) {\n\n\tvar self = this;\n\n\tself.columnsByIndex.forEach(function (column, i) {\n\n\t\tcallback(column, i);\n\t});\n};\n\n//get defintions of actual columns\n\nColumnManager.prototype.getDefinitions = function (active) {\n\n\tvar self = this,\n\t    output = [];\n\n\tself.columnsByIndex.forEach(function (column) {\n\n\t\tif (!active || active && column.visible) {\n\n\t\t\toutput.push(column.getDefinition());\n\t\t}\n\t});\n\n\treturn output;\n};\n\n//get full nested definition tree\n\nColumnManager.prototype.getDefinitionTree = function () {\n\n\tvar self = this,\n\t    output = [];\n\n\tself.columns.forEach(function (column) {\n\n\t\toutput.push(column.getDefinition(true));\n\t});\n\n\treturn output;\n};\n\nColumnManager.prototype.getComponents = function (structured) {\n\n\tvar self = this,\n\t    output = [],\n\t    columns = structured ? self.columns : self.columnsByIndex;\n\n\tcolumns.forEach(function (column) {\n\n\t\toutput.push(column.getComponent());\n\t});\n\n\treturn output;\n};\n\nColumnManager.prototype.getWidth = function () {\n\n\tvar width = 0;\n\n\tthis.columnsByIndex.forEach(function (column) {\n\n\t\tif (column.visible) {\n\n\t\t\twidth += column.getWidth();\n\t\t}\n\t});\n\n\treturn width;\n};\n\nColumnManager.prototype.moveColumn = function (from, to, after) {\n\n\tthis.moveColumnActual(from, to, after);\n\n\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\tthis.table.modules.responsiveLayout.initialize();\n\t}\n\n\tif (this.table.modExists(\"columnCalcs\")) {\n\n\t\tthis.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows);\n\t}\n\n\tto.element.parentNode.insertBefore(from.element, to.element);\n\n\tif (after) {\n\n\t\tto.element.parentNode.insertBefore(to.element, from.element);\n\t}\n\n\tthis._verticalAlignHeaders();\n\n\tthis.table.rowManager.reinitialize();\n};\n\nColumnManager.prototype.moveColumnActual = function (from, to, after) {\n\n\tif (from.parent.isGroup) {\n\n\t\tthis._moveColumnInArray(from.parent.columns, from, to, after);\n\t} else {\n\n\t\tthis._moveColumnInArray(this.columns, from, to, after);\n\t}\n\n\tthis._moveColumnInArray(this.columnsByIndex, from, to, after, true);\n\n\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\tthis.table.modules.responsiveLayout.initialize();\n\t}\n\n\tif (this.table.options.virtualDomHoz) {\n\n\t\tthis.table.vdomHoz.reinitialize(true);\n\t}\n\n\tif (this.table.options.columnMoved) {\n\n\t\tthis.table.options.columnMoved.call(this.table, from.getComponent(), this.table.columnManager.getComponents());\n\t}\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.columns) {\n\n\t\tthis.table.modules.persistence.save(\"columns\");\n\t}\n};\n\nColumnManager.prototype._moveColumnInArray = function (columns, from, to, after, updateRows) {\n\tvar _this2 = this;\n\n\tvar fromIndex = columns.indexOf(from),\n\t    toIndex,\n\t    rows = [];\n\n\tif (fromIndex > -1) {\n\n\t\tcolumns.splice(fromIndex, 1);\n\n\t\ttoIndex = columns.indexOf(to);\n\n\t\tif (toIndex > -1) {\n\n\t\t\tif (after) {\n\n\t\t\t\ttoIndex = toIndex + 1;\n\t\t\t}\n\t\t} else {\n\n\t\t\ttoIndex = fromIndex;\n\t\t}\n\n\t\tcolumns.splice(toIndex, 0, from);\n\n\t\tif (updateRows) {\n\n\t\t\tif (this.table.options.dataTree && this.table.modExists(\"dataTree\", true)) {\n\n\t\t\t\tthis.table.rowManager.rows.forEach(function (row) {\n\n\t\t\t\t\trows = rows.concat(_this2.table.modules.dataTree.getTreeChildren(row, false, true));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\trows = rows.concat(this.table.rowManager.rows);\n\n\t\t\trows.forEach(function (row) {\n\n\t\t\t\tif (row.cells.length) {\n\n\t\t\t\t\tvar cell = row.cells.splice(fromIndex, 1)[0];\n\n\t\t\t\t\trow.cells.splice(toIndex, 0, cell);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n};\n\nColumnManager.prototype.scrollToColumn = function (column, position, ifVisible) {\n\tvar _this3 = this;\n\n\tvar left = 0,\n\t    offset = 0,\n\t    adjust = 0,\n\t    colEl = column.getElement();\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tif (typeof position === \"undefined\") {\n\n\t\t\tposition = _this3.table.options.scrollToColumnPosition;\n\t\t}\n\n\t\tif (typeof ifVisible === \"undefined\") {\n\n\t\t\tifVisible = _this3.table.options.scrollToColumnIfVisible;\n\t\t}\n\n\t\tif (column.visible) {\n\n\t\t\t//align to correct position\n\n\t\t\tswitch (position) {\n\n\t\t\t\tcase \"middle\":\n\n\t\t\t\tcase \"center\":\n\n\t\t\t\t\tadjust = -_this3.element.clientWidth / 2;\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"right\":\n\n\t\t\t\t\tadjust = colEl.clientWidth - _this3.headersElement.clientWidth;\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\t//check column visibility\n\n\t\t\tif (!ifVisible) {\n\n\t\t\t\toffset = colEl.offsetLeft;\n\n\t\t\t\tif (offset > 0 && offset + colEl.offsetWidth < _this3.element.clientWidth) {\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//calculate scroll position\n\n\t\t\tleft = colEl.offsetLeft + adjust;\n\n\t\t\tleft = Math.max(Math.min(left, _this3.table.rowManager.element.scrollWidth - _this3.table.rowManager.element.clientWidth), 0);\n\n\t\t\t_this3.table.rowManager.scrollHorizontal(left);\n\n\t\t\t_this3.scrollHorizontal(left);\n\n\t\t\tresolve();\n\t\t} else {\n\n\t\t\tconsole.warn(\"Scroll Error - Column not visible\");\n\n\t\t\treject(\"Scroll Error - Column not visible\");\n\t\t}\n\t});\n};\n\n//////////////// Cell Management /////////////////\n\n\nColumnManager.prototype.generateCells = function (row) {\n\n\tvar self = this;\n\n\tvar cells = [];\n\n\tself.columnsByIndex.forEach(function (column) {\n\n\t\tcells.push(column.generateCell(row));\n\t});\n\n\treturn cells;\n};\n\n//////////////// Column Management /////////////////\n\n\nColumnManager.prototype.getFlexBaseWidth = function () {\n\n\tvar self = this,\n\t    totalWidth = self.table.element.clientWidth,\n\t    //table element width\n\n\tfixedWidth = 0;\n\n\t//adjust for vertical scrollbar if present\n\n\tif (self.rowManager.element.scrollHeight > self.rowManager.element.clientHeight) {\n\n\t\ttotalWidth -= self.rowManager.element.offsetWidth - self.rowManager.element.clientWidth;\n\t}\n\n\tthis.columnsByIndex.forEach(function (column) {\n\n\t\tvar width, minWidth, colWidth;\n\n\t\tif (column.visible) {\n\n\t\t\twidth = column.definition.width || 0;\n\n\t\t\tminWidth = typeof column.minWidth == \"undefined\" ? self.table.options.columnMinWidth : parseInt(column.minWidth);\n\n\t\t\tif (typeof width == \"string\") {\n\n\t\t\t\tif (width.indexOf(\"%\") > -1) {\n\n\t\t\t\t\tcolWidth = totalWidth / 100 * parseInt(width);\n\t\t\t\t} else {\n\n\t\t\t\t\tcolWidth = parseInt(width);\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tcolWidth = width;\n\t\t\t}\n\n\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\t\t}\n\t});\n\n\treturn fixedWidth;\n};\n\nColumnManager.prototype.addColumn = function (definition, before, nextToColumn) {\n\tvar _this4 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tvar column = _this4._addColumn(definition, before, nextToColumn);\n\n\t\t_this4._reIndexColumns();\n\n\t\tif (_this4.table.options.responsiveLayout && _this4.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\t_this4.table.modules.responsiveLayout.initialize();\n\t\t}\n\n\t\tif (_this4.table.modExists(\"columnCalcs\")) {\n\n\t\t\t_this4.table.modules.columnCalcs.recalc(_this4.table.rowManager.activeRows);\n\t\t}\n\n\t\t_this4.redraw(true);\n\n\t\tif (_this4.table.modules.layout.getMode() != \"fitColumns\") {\n\n\t\t\tcolumn.reinitializeWidth();\n\t\t}\n\n\t\t_this4._verticalAlignHeaders();\n\n\t\t_this4.table.rowManager.reinitialize();\n\n\t\tif (_this4.table.options.virtualDomHoz) {\n\n\t\t\t_this4.table.vdomHoz.reinitialize();\n\t\t}\n\n\t\tresolve(column);\n\t});\n};\n\n//remove column from system\n\nColumnManager.prototype.deregisterColumn = function (column) {\n\n\tvar field = column.getField(),\n\t    index;\n\n\t//remove from field list\n\n\tif (field) {\n\n\t\tdelete this.columnsByField[field];\n\t}\n\n\t//remove from index list\n\n\tindex = this.columnsByIndex.indexOf(column);\n\n\tif (index > -1) {\n\n\t\tthis.columnsByIndex.splice(index, 1);\n\t}\n\n\t//remove from column list\n\n\tindex = this.columns.indexOf(column);\n\n\tif (index > -1) {\n\n\t\tthis.columns.splice(index, 1);\n\t}\n\n\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\tthis.table.modules.responsiveLayout.initialize();\n\t}\n\n\tthis._verticalAlignHeaders();\n\n\tthis.redraw();\n};\n\n//redraw columns\n\nColumnManager.prototype.redraw = function (force) {\n\n\tif (force) {\n\n\t\tif (Tabulator.prototype.helpers.elVisible(this.element)) {\n\n\t\t\tthis._verticalAlignHeaders();\n\t\t}\n\n\t\tthis.table.rowManager.resetScroll();\n\n\t\tthis.table.rowManager.reinitialize();\n\t}\n\n\tif ([\"fitColumns\", \"fitDataStretch\"].indexOf(this.table.modules.layout.getMode()) > -1) {\n\n\t\tthis.table.modules.layout.layout();\n\t} else {\n\n\t\tif (force) {\n\n\t\t\tthis.table.modules.layout.layout();\n\t\t} else {\n\n\t\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tif (this.table.modExists(\"frozenColumns\")) {\n\n\t\tthis.table.modules.frozenColumns.layout();\n\t}\n\n\tif (this.table.modExists(\"columnCalcs\")) {\n\n\t\tthis.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows);\n\t}\n\n\tif (force) {\n\n\t\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.columns) {\n\n\t\t\tthis.table.modules.persistence.save(\"columns\");\n\t\t}\n\n\t\tif (this.table.modExists(\"columnCalcs\")) {\n\n\t\t\tthis.table.modules.columnCalcs.redraw();\n\t\t}\n\t}\n\n\tthis.table.footerManager.redraw();\n};\n\n//public column object\nvar ColumnComponent = function ColumnComponent(column) {\n\tthis._column = column;\n\tthis.type = \"ColumnComponent\";\n};\n\nColumnComponent.prototype.getElement = function () {\n\treturn this._column.getElement();\n};\n\nColumnComponent.prototype.getDefinition = function () {\n\treturn this._column.getDefinition();\n};\n\nColumnComponent.prototype.getField = function () {\n\treturn this._column.getField();\n};\n\nColumnComponent.prototype.getCells = function () {\n\tvar cells = [];\n\n\tthis._column.cells.forEach(function (cell) {\n\t\tcells.push(cell.getComponent());\n\t});\n\n\treturn cells;\n};\n\nColumnComponent.prototype.getVisibility = function () {\n\tconsole.warn(\"getVisibility function is deprecated, you should now use the isVisible function\");\n\treturn this._column.visible;\n};\n\nColumnComponent.prototype.isVisible = function () {\n\treturn this._column.visible;\n};\n\nColumnComponent.prototype.show = function () {\n\tif (this._column.isGroup) {\n\t\tthis._column.columns.forEach(function (column) {\n\t\t\tcolumn.show();\n\t\t});\n\t} else {\n\t\tthis._column.show();\n\t}\n};\n\nColumnComponent.prototype.hide = function () {\n\tif (this._column.isGroup) {\n\t\tthis._column.columns.forEach(function (column) {\n\t\t\tcolumn.hide();\n\t\t});\n\t} else {\n\t\tthis._column.hide();\n\t}\n};\n\nColumnComponent.prototype.toggle = function () {\n\tif (this._column.visible) {\n\t\tthis.hide();\n\t} else {\n\t\tthis.show();\n\t}\n};\n\nColumnComponent.prototype.delete = function () {\n\treturn this._column.delete();\n};\n\nColumnComponent.prototype.getSubColumns = function () {\n\tvar output = [];\n\n\tif (this._column.columns.length) {\n\t\tthis._column.columns.forEach(function (column) {\n\t\t\toutput.push(column.getComponent());\n\t\t});\n\t}\n\n\treturn output;\n};\n\nColumnComponent.prototype.getParentColumn = function () {\n\treturn this._column.parent instanceof Column ? this._column.parent.getComponent() : false;\n};\n\nColumnComponent.prototype._getSelf = function () {\n\treturn this._column;\n};\n\nColumnComponent.prototype.scrollTo = function () {\n\treturn this._column.table.columnManager.scrollToColumn(this._column);\n};\n\nColumnComponent.prototype.getTable = function () {\n\treturn this._column.table;\n};\n\nColumnComponent.prototype.headerFilterFocus = function () {\n\tif (this._column.table.modExists(\"filter\", true)) {\n\t\tthis._column.table.modules.filter.setHeaderFilterFocus(this._column);\n\t}\n};\n\nColumnComponent.prototype.reloadHeaderFilter = function () {\n\tif (this._column.table.modExists(\"filter\", true)) {\n\t\tthis._column.table.modules.filter.reloadHeaderFilter(this._column);\n\t}\n};\n\nColumnComponent.prototype.getHeaderFilterValue = function () {\n\tif (this._column.table.modExists(\"filter\", true)) {\n\t\treturn this._column.table.modules.filter.getHeaderFilterValue(this._column);\n\t}\n};\n\nColumnComponent.prototype.setHeaderFilterValue = function (value) {\n\tif (this._column.table.modExists(\"filter\", true)) {\n\t\tthis._column.table.modules.filter.setHeaderFilterValue(this._column, value);\n\t}\n};\n\nColumnComponent.prototype.move = function (to, after) {\n\tvar toColumn = this._column.table.columnManager.findColumn(to);\n\n\tif (toColumn) {\n\t\tthis._column.table.columnManager.moveColumn(this._column, toColumn, after);\n\t} else {\n\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t}\n};\n\nColumnComponent.prototype.getNextColumn = function () {\n\tvar nextCol = this._column.nextColumn();\n\n\treturn nextCol ? nextCol.getComponent() : false;\n};\n\nColumnComponent.prototype.getPrevColumn = function () {\n\tvar prevCol = this._column.prevColumn();\n\n\treturn prevCol ? prevCol.getComponent() : false;\n};\n\nColumnComponent.prototype.updateDefinition = function (updates) {\n\treturn this._column.updateDefinition(updates);\n};\n\nColumnComponent.prototype.getWidth = function () {\n\treturn this._column.getWidth();\n};\n\nColumnComponent.prototype.setWidth = function (width) {\n\tvar result;\n\n\tif (width === true) {\n\t\tresult = this._column.reinitializeWidth(true);\n\t} else {\n\t\tresult = this._column.setWidth(width);\n\t}\n\n\tif (this._column.table.options.virtualDomHoz) {\n\t\tthis._column.table.vdomHoz.reinitialize(true);\n\t}\n\n\treturn result;\n};\n\nColumnComponent.prototype.validate = function () {\n\treturn this._column.validate();\n};\n\nvar Column = function Column(def, parent) {\n\tvar self = this;\n\n\tthis.table = parent.table;\n\tthis.definition = def; //column definition\n\tthis.parent = parent; //hold parent object\n\tthis.type = \"column\"; //type of element\n\tthis.columns = []; //child columns\n\tthis.cells = []; //cells bound to this column\n\tthis.element = this.createElement(); //column header element\n\tthis.contentElement = false;\n\tthis.titleHolderElement = false;\n\tthis.titleElement = false;\n\tthis.groupElement = this.createGroupElement(); //column group holder element\n\tthis.isGroup = false;\n\tthis.tooltip = false; //hold column tooltip\n\tthis.hozAlign = \"\"; //horizontal text alignment\n\tthis.vertAlign = \"\"; //vert text alignment\n\n\t//multi dimensional filed handling\n\tthis.field = \"\";\n\tthis.fieldStructure = \"\";\n\tthis.getFieldValue = \"\";\n\tthis.setFieldValue = \"\";\n\n\tthis.titleFormatterRendered = false;\n\n\tthis.setField(this.definition.field);\n\n\tif (this.table.options.invalidOptionWarnings) {\n\t\tthis.checkDefinition();\n\t}\n\n\tthis.modules = {}; //hold module variables;\n\n\tthis.cellEvents = {\n\t\tcellClick: false,\n\t\tcellDblClick: false,\n\t\tcellContext: false,\n\t\tcellTap: false,\n\t\tcellDblTap: false,\n\t\tcellTapHold: false,\n\t\tcellMouseEnter: false,\n\t\tcellMouseLeave: false,\n\t\tcellMouseOver: false,\n\t\tcellMouseOut: false,\n\t\tcellMouseMove: false\n\t};\n\n\tthis.width = null; //column width\n\tthis.widthStyled = \"\"; //column width prestyled to improve render efficiency\n\tthis.maxWidth = null; //column maximum width\n\tthis.maxWidthStyled = \"\"; //column maximum prestyled to improve render efficiency\n\tthis.minWidth = null; //column minimum width\n\tthis.minWidthStyled = \"\"; //column minimum prestyled to improve render efficiency\n\tthis.widthFixed = false; //user has specified a width for this column\n\n\tthis.visible = true; //default visible state\n\n\tthis.component = null;\n\n\tthis._mapDepricatedFunctionality();\n\n\t//initialize column\n\tif (def.columns) {\n\n\t\tthis.isGroup = true;\n\n\t\tdef.columns.forEach(function (def, i) {\n\t\t\tvar newCol = new Column(def, self);\n\t\t\tself.attachColumn(newCol);\n\t\t});\n\n\t\tself.checkColumnVisibility();\n\t} else {\n\t\tparent.registerColumnField(this);\n\t}\n\n\tif (def.rowHandle && this.table.options.movableRows !== false && this.table.modExists(\"moveRow\")) {\n\t\tthis.table.modules.moveRow.setHandle(true);\n\t}\n\n\tthis._buildHeader();\n\n\tthis.bindModuleColumns();\n};\n\nColumn.prototype.createElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-col\");\n\tel.setAttribute(\"role\", \"columnheader\");\n\tel.setAttribute(\"aria-sort\", \"none\");\n\n\treturn el;\n};\n\nColumn.prototype.createGroupElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-col-group-cols\");\n\n\treturn el;\n};\n\nColumn.prototype.checkDefinition = function () {\n\tvar _this5 = this;\n\n\tObject.keys(this.definition).forEach(function (key) {\n\t\tif (_this5.defaultOptionList.indexOf(key) === -1) {\n\t\t\tconsole.warn(\"Invalid column definition option in '\" + (_this5.field || _this5.definition.title) + \"' column:\", key);\n\t\t}\n\t});\n};\n\nColumn.prototype.setField = function (field) {\n\tthis.field = field;\n\tthis.fieldStructure = field ? this.table.options.nestedFieldSeparator ? field.split(this.table.options.nestedFieldSeparator) : [field] : [];\n\tthis.getFieldValue = this.fieldStructure.length > 1 ? this._getNestedData : this._getFlatData;\n\tthis.setFieldValue = this.fieldStructure.length > 1 ? this._setNestedData : this._setFlatData;\n};\n\n//register column position with column manager\nColumn.prototype.registerColumnPosition = function (column) {\n\tthis.parent.registerColumnPosition(column);\n};\n\n//register column position with column manager\nColumn.prototype.registerColumnField = function (column) {\n\tthis.parent.registerColumnField(column);\n};\n\n//trigger position registration\nColumn.prototype.reRegisterPosition = function () {\n\tif (this.isGroup) {\n\t\tthis.columns.forEach(function (column) {\n\t\t\tcolumn.reRegisterPosition();\n\t\t});\n\t} else {\n\t\tthis.registerColumnPosition(this);\n\t}\n};\n\nColumn.prototype._mapDepricatedFunctionality = function () {\n\tif (typeof this.definition.hideInHtml !== \"undefined\") {\n\t\tthis.definition.htmlOutput = !this.definition.hideInHtml;\n\t\tconsole.warn(\"hideInHtml column definition property is deprecated, you should now use htmlOutput\");\n\t}\n\n\tif (typeof this.definition.align !== \"undefined\") {\n\t\tthis.definition.hozAlign = this.definition.align;\n\t\tconsole.warn(\"align column definition property is deprecated, you should now use hozAlign\");\n\t}\n\n\tif (typeof this.definition.downloadTitle !== \"undefined\") {\n\t\tthis.definition.titleDownload = this.definition.downloadTitle;\n\t\tconsole.warn(\"downloadTitle definition property is deprecated, you should now use titleDownload\");\n\t}\n};\n\nColumn.prototype.setTooltip = function () {\n\tvar self = this,\n\t    def = self.definition;\n\n\t//set header tooltips\n\tvar tooltip = def.headerTooltip || def.tooltip === false ? def.headerTooltip : self.table.options.tooltipsHeader;\n\n\tif (tooltip) {\n\t\tif (tooltip === true) {\n\t\t\tif (def.field) {\n\t\t\t\tself.table.modules.localize.bind(\"columns|\" + def.field, function (value) {\n\t\t\t\t\tself.element.setAttribute(\"title\", value || def.title);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.element.setAttribute(\"title\", def.title);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof tooltip == \"function\") {\n\t\t\t\ttooltip = tooltip(self.getComponent());\n\n\t\t\t\tif (tooltip === false) {\n\t\t\t\t\ttooltip = \"\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tself.element.setAttribute(\"title\", tooltip);\n\t\t}\n\t} else {\n\t\tself.element.setAttribute(\"title\", \"\");\n\t}\n};\n\n//build header element\nColumn.prototype._buildHeader = function () {\n\tvar self = this,\n\t    def = self.definition;\n\n\twhile (self.element.firstChild) {\n\t\tself.element.removeChild(self.element.firstChild);\n\t}if (def.headerVertical) {\n\t\tself.element.classList.add(\"tabulator-col-vertical\");\n\n\t\tif (def.headerVertical === \"flip\") {\n\t\t\tself.element.classList.add(\"tabulator-col-vertical-flip\");\n\t\t}\n\t}\n\n\tself.contentElement = self._bindEvents();\n\n\tself.contentElement = self._buildColumnHeaderContent();\n\n\tself.element.appendChild(self.contentElement);\n\n\tif (self.isGroup) {\n\t\tself._buildGroupHeader();\n\t} else {\n\t\tself._buildColumnHeader();\n\t}\n\n\tself.setTooltip();\n\n\t//set resizable handles\n\tif (self.table.options.resizableColumns && self.table.modExists(\"resizeColumns\")) {\n\t\tself.table.modules.resizeColumns.initializeColumn(\"header\", self, self.element);\n\t}\n\n\t//set resizable handles\n\tif (def.headerFilter && self.table.modExists(\"filter\") && self.table.modExists(\"edit\")) {\n\t\tif (typeof def.headerFilterPlaceholder !== \"undefined\" && def.field) {\n\t\t\tself.table.modules.localize.setHeaderFilterColumnPlaceholder(def.field, def.headerFilterPlaceholder);\n\t\t}\n\n\t\tself.table.modules.filter.initializeColumn(self);\n\t}\n\n\t//set resizable handles\n\tif (self.table.modExists(\"frozenColumns\")) {\n\t\tself.table.modules.frozenColumns.initializeColumn(self);\n\t}\n\n\t//set movable column\n\tif (self.table.options.movableColumns && !self.isGroup && self.table.modExists(\"moveColumn\")) {\n\t\tself.table.modules.moveColumn.initializeColumn(self);\n\t}\n\n\t//set calcs column\n\tif ((def.topCalc || def.bottomCalc) && self.table.modExists(\"columnCalcs\")) {\n\t\tself.table.modules.columnCalcs.initializeColumn(self);\n\t}\n\n\t//handle persistence\n\tif (self.table.modExists(\"persistence\") && self.table.modules.persistence.config.columns) {\n\t\tself.table.modules.persistence.initializeColumn(self);\n\t}\n\n\t//update header tooltip on mouse enter\n\tself.element.addEventListener(\"mouseenter\", function (e) {\n\t\tself.setTooltip();\n\t});\n};\n\nColumn.prototype._bindEvents = function () {\n\n\tvar self = this,\n\t    def = self.definition,\n\t    dblTap,\n\t    tapHold,\n\t    tap;\n\n\t//setup header click event bindings\n\tif (typeof def.headerClick == \"function\") {\n\t\tself.element.addEventListener(\"click\", function (e) {\n\t\t\tdef.headerClick(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (typeof def.headerDblClick == \"function\") {\n\t\tself.element.addEventListener(\"dblclick\", function (e) {\n\t\t\tdef.headerDblClick(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (typeof def.headerContext == \"function\") {\n\t\tself.element.addEventListener(\"contextmenu\", function (e) {\n\t\t\tdef.headerContext(e, self.getComponent());\n\t\t});\n\t}\n\n\t//setup header tap event bindings\n\tif (typeof def.headerTap == \"function\") {\n\t\ttap = false;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\ttap = true;\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tif (tap) {\n\t\t\t\tdef.headerTap(e, self.getComponent());\n\t\t\t}\n\n\t\t\ttap = false;\n\t\t});\n\t}\n\n\tif (typeof def.headerDblTap == \"function\") {\n\t\tdblTap = null;\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\n\t\t\tif (dblTap) {\n\t\t\t\tclearTimeout(dblTap);\n\t\t\t\tdblTap = null;\n\n\t\t\t\tdef.headerDblTap(e, self.getComponent());\n\t\t\t} else {\n\n\t\t\t\tdblTap = setTimeout(function () {\n\t\t\t\t\tclearTimeout(dblTap);\n\t\t\t\t\tdblTap = null;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (typeof def.headerTapHold == \"function\") {\n\t\ttapHold = null;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\n\t\t\ttapHold = setTimeout(function () {\n\t\t\t\tclearTimeout(tapHold);\n\t\t\t\ttapHold = null;\n\t\t\t\ttap = false;\n\t\t\t\tdef.headerTapHold(e, self.getComponent());\n\t\t\t}, 1000);\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\t\t\ttapHold = null;\n\t\t});\n\t}\n\n\t//store column cell click event bindings\n\tif (typeof def.cellClick == \"function\") {\n\t\tself.cellEvents.cellClick = def.cellClick;\n\t}\n\n\tif (typeof def.cellDblClick == \"function\") {\n\t\tself.cellEvents.cellDblClick = def.cellDblClick;\n\t}\n\n\tif (typeof def.cellContext == \"function\") {\n\t\tself.cellEvents.cellContext = def.cellContext;\n\t}\n\n\t//store column mouse event bindings\n\tif (typeof def.cellMouseEnter == \"function\") {\n\t\tself.cellEvents.cellMouseEnter = def.cellMouseEnter;\n\t}\n\n\tif (typeof def.cellMouseLeave == \"function\") {\n\t\tself.cellEvents.cellMouseLeave = def.cellMouseLeave;\n\t}\n\n\tif (typeof def.cellMouseOver == \"function\") {\n\t\tself.cellEvents.cellMouseOver = def.cellMouseOver;\n\t}\n\n\tif (typeof def.cellMouseOut == \"function\") {\n\t\tself.cellEvents.cellMouseOut = def.cellMouseOut;\n\t}\n\n\tif (typeof def.cellMouseMove == \"function\") {\n\t\tself.cellEvents.cellMouseMove = def.cellMouseMove;\n\t}\n\n\t//setup column cell tap event bindings\n\tif (typeof def.cellTap == \"function\") {\n\t\tself.cellEvents.cellTap = def.cellTap;\n\t}\n\n\tif (typeof def.cellDblTap == \"function\") {\n\t\tself.cellEvents.cellDblTap = def.cellDblTap;\n\t}\n\n\tif (typeof def.cellTapHold == \"function\") {\n\t\tself.cellEvents.cellTapHold = def.cellTapHold;\n\t}\n\n\t//setup column cell edit callbacks\n\tif (typeof def.cellEdited == \"function\") {\n\t\tself.cellEvents.cellEdited = def.cellEdited;\n\t}\n\n\tif (typeof def.cellEditing == \"function\") {\n\t\tself.cellEvents.cellEditing = def.cellEditing;\n\t}\n\n\tif (typeof def.cellEditCancelled == \"function\") {\n\t\tself.cellEvents.cellEditCancelled = def.cellEditCancelled;\n\t}\n};\n\n//build header element for header\nColumn.prototype._buildColumnHeader = function () {\n\tvar _this6 = this;\n\n\tvar def = this.definition,\n\t    table = this.table,\n\t    sortable;\n\n\t//set column sorter\n\tif (table.modExists(\"sort\")) {\n\t\ttable.modules.sort.initializeColumn(this, this.titleHolderElement);\n\t}\n\n\t//set column header context menu\n\tif ((def.headerContextMenu || def.headerClickMenu || def.headerMenu) && table.modExists(\"menu\")) {\n\t\ttable.modules.menu.initializeColumnHeader(this);\n\t}\n\n\t//set column formatter\n\tif (table.modExists(\"format\")) {\n\t\ttable.modules.format.initializeColumn(this);\n\t}\n\n\t//set column editor\n\tif (typeof def.editor != \"undefined\" && table.modExists(\"edit\")) {\n\t\ttable.modules.edit.initializeColumn(this);\n\t}\n\n\t//set colum validator\n\tif (typeof def.validator != \"undefined\" && table.modExists(\"validate\")) {\n\t\ttable.modules.validate.initializeColumn(this);\n\t}\n\n\t//set column mutator\n\tif (table.modExists(\"mutator\")) {\n\t\ttable.modules.mutator.initializeColumn(this);\n\t}\n\n\t//set column accessor\n\tif (table.modExists(\"accessor\")) {\n\t\ttable.modules.accessor.initializeColumn(this);\n\t}\n\n\t//set respoviveLayout\n\tif (_typeof(table.options.responsiveLayout) && table.modExists(\"responsiveLayout\")) {\n\t\ttable.modules.responsiveLayout.initializeColumn(this);\n\t}\n\n\t//set column visibility\n\tif (typeof def.visible != \"undefined\") {\n\t\tif (def.visible) {\n\t\t\tthis.show(true);\n\t\t} else {\n\t\t\tthis.hide(true);\n\t\t}\n\t}\n\n\t//asign additional css classes to column header\n\tif (def.cssClass) {\n\t\tvar classeNames = def.cssClass.split(\" \");\n\t\tclasseNames.forEach(function (className) {\n\t\t\t_this6.element.classList.add(className);\n\t\t});\n\t}\n\n\tif (def.field) {\n\t\tthis.element.setAttribute(\"tabulator-field\", def.field);\n\t}\n\n\t//set min width if present\n\tthis.setMinWidth(typeof def.minWidth == \"undefined\" ? this.table.options.columnMinWidth : parseInt(def.minWidth));\n\n\tif (def.maxWidth || this.table.options.columnMaxWidth) {\n\t\tif (def.maxWidth !== false) {\n\t\t\tthis.setMaxWidth(typeof def.maxWidth == \"undefined\" ? this.table.options.columnMaxWidth : parseInt(def.maxWidth));\n\t\t}\n\t}\n\n\tthis.reinitializeWidth();\n\n\t//set tooltip if present\n\tthis.tooltip = this.definition.tooltip || this.definition.tooltip === false ? this.definition.tooltip : this.table.options.tooltips;\n\n\t//set orizontal text alignment\n\tthis.hozAlign = typeof this.definition.hozAlign == \"undefined\" ? this.table.options.cellHozAlign : this.definition.hozAlign;\n\tthis.vertAlign = typeof this.definition.vertAlign == \"undefined\" ? this.table.options.cellVertAlign : this.definition.vertAlign;\n\n\tthis.titleElement.style.textAlign = this.definition.headerHozAlign || this.table.options.headerHozAlign;\n};\n\nColumn.prototype._buildColumnHeaderContent = function () {\n\tvar def = this.definition,\n\t    table = this.table;\n\n\tvar contentElement = document.createElement(\"div\");\n\tcontentElement.classList.add(\"tabulator-col-content\");\n\n\tthis.titleHolderElement = document.createElement(\"div\");\n\tthis.titleHolderElement.classList.add(\"tabulator-col-title-holder\");\n\n\tcontentElement.appendChild(this.titleHolderElement);\n\n\tthis.titleElement = this._buildColumnHeaderTitle();\n\n\tthis.titleHolderElement.appendChild(this.titleElement);\n\n\treturn contentElement;\n};\n\n//build title element of column\nColumn.prototype._buildColumnHeaderTitle = function () {\n\tvar self = this,\n\t    def = self.definition,\n\t    table = self.table,\n\t    title;\n\n\tvar titleHolderElement = document.createElement(\"div\");\n\ttitleHolderElement.classList.add(\"tabulator-col-title\");\n\n\tif (def.editableTitle) {\n\t\tvar titleElement = document.createElement(\"input\");\n\t\ttitleElement.classList.add(\"tabulator-title-editor\");\n\n\t\ttitleElement.addEventListener(\"click\", function (e) {\n\t\t\te.stopPropagation();\n\t\t\ttitleElement.focus();\n\t\t});\n\n\t\ttitleElement.addEventListener(\"change\", function () {\n\t\t\tdef.title = titleElement.value;\n\t\t\ttable.options.columnTitleChanged.call(self.table, self.getComponent());\n\t\t});\n\n\t\ttitleHolderElement.appendChild(titleElement);\n\n\t\tif (def.field) {\n\t\t\ttable.modules.localize.bind(\"columns|\" + def.field, function (text) {\n\t\t\t\ttitleElement.value = text || def.title || \"&nbsp;\";\n\t\t\t});\n\t\t} else {\n\t\t\ttitleElement.value = def.title || \"&nbsp;\";\n\t\t}\n\t} else {\n\t\tif (def.field) {\n\t\t\ttable.modules.localize.bind(\"columns|\" + def.field, function (text) {\n\t\t\t\tself._formatColumnHeaderTitle(titleHolderElement, text || def.title || \"&nbsp;\");\n\t\t\t});\n\t\t} else {\n\t\t\tself._formatColumnHeaderTitle(titleHolderElement, def.title || \"&nbsp;\");\n\t\t}\n\t}\n\n\treturn titleHolderElement;\n};\n\nColumn.prototype._formatColumnHeaderTitle = function (el, title) {\n\tvar _this7 = this;\n\n\tvar formatter, contents, params, mockCell, onRendered;\n\n\tif (this.definition.titleFormatter && this.table.modExists(\"format\")) {\n\n\t\tformatter = this.table.modules.format.getFormatter(this.definition.titleFormatter);\n\n\t\tonRendered = function onRendered(callback) {\n\t\t\t_this7.titleFormatterRendered = callback;\n\t\t};\n\n\t\tmockCell = {\n\t\t\tgetValue: function getValue() {\n\t\t\t\treturn title;\n\t\t\t},\n\t\t\tgetElement: function getElement() {\n\t\t\t\treturn el;\n\t\t\t}\n\t\t};\n\n\t\tparams = this.definition.titleFormatterParams || {};\n\n\t\tparams = typeof params === \"function\" ? params() : params;\n\n\t\tcontents = formatter.call(this.table.modules.format, mockCell, params, onRendered);\n\n\t\tswitch (typeof contents === 'undefined' ? 'undefined' : _typeof(contents)) {\n\t\t\tcase \"object\":\n\t\t\t\tif (contents instanceof Node) {\n\t\t\t\t\tel.appendChild(contents);\n\t\t\t\t} else {\n\t\t\t\t\tel.innerHTML = \"\";\n\t\t\t\t\tconsole.warn(\"Format Error - Title formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", contents);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"undefined\":\n\t\t\tcase \"null\":\n\t\t\t\tel.innerHTML = \"\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tel.innerHTML = contents;\n\t\t}\n\t} else {\n\t\tel.innerHTML = title;\n\t}\n};\n\n//build header element for column group\nColumn.prototype._buildGroupHeader = function () {\n\tvar _this8 = this;\n\n\tthis.element.classList.add(\"tabulator-col-group\");\n\tthis.element.setAttribute(\"role\", \"columngroup\");\n\tthis.element.setAttribute(\"aria-title\", this.definition.title);\n\n\t//asign additional css classes to column header\n\tif (this.definition.cssClass) {\n\t\tvar classeNames = this.definition.cssClass.split(\" \");\n\t\tclasseNames.forEach(function (className) {\n\t\t\t_this8.element.classList.add(className);\n\t\t});\n\t}\n\n\t//set column header context menu\n\tif ((this.definition.headerContextMenu || this.definition.headerMenu) && this.table.modExists(\"menu\")) {\n\t\tthis.table.modules.menu.initializeColumnHeader(this);\n\t}\n\n\tthis.titleElement.style.textAlign = this.definition.headerHozAlign || this.table.options.headerHozAlign;\n\n\tthis.element.appendChild(this.groupElement);\n};\n\n//flat field lookup\nColumn.prototype._getFlatData = function (data) {\n\treturn data[this.field];\n};\n\n//nested field lookup\nColumn.prototype._getNestedData = function (data) {\n\tvar dataObj = data,\n\t    structure = this.fieldStructure,\n\t    length = structure.length,\n\t    output;\n\n\tfor (var _i = 0; _i < length; _i++) {\n\n\t\tdataObj = dataObj[structure[_i]];\n\n\t\toutput = dataObj;\n\n\t\tif (!dataObj) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn output;\n};\n\n//flat field set\nColumn.prototype._setFlatData = function (data, value) {\n\tif (this.field) {\n\t\tdata[this.field] = value;\n\t}\n};\n\n//nested field set\nColumn.prototype._setNestedData = function (data, value) {\n\tvar dataObj = data,\n\t    structure = this.fieldStructure,\n\t    length = structure.length;\n\n\tfor (var _i2 = 0; _i2 < length; _i2++) {\n\n\t\tif (_i2 == length - 1) {\n\t\t\tdataObj[structure[_i2]] = value;\n\t\t} else {\n\t\t\tif (!dataObj[structure[_i2]]) {\n\t\t\t\tif (typeof value !== \"undefined\") {\n\t\t\t\t\tdataObj[structure[_i2]] = {};\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdataObj = dataObj[structure[_i2]];\n\t\t}\n\t}\n};\n\n//attach column to this group\nColumn.prototype.attachColumn = function (column) {\n\tvar self = this;\n\n\tif (self.groupElement) {\n\t\tself.columns.push(column);\n\t\tself.groupElement.appendChild(column.getElement());\n\t} else {\n\t\tconsole.warn(\"Column Warning - Column being attached to another column instead of column group\");\n\t}\n};\n\n//vertically align header in column\nColumn.prototype.verticalAlign = function (alignment, height) {\n\n\t//calculate height of column header and group holder element\n\tvar parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : height || this.parent.getHeadersElement().clientHeight;\n\t// var parentHeight = this.parent.isGroup ? this.parent.getGroupElement().clientHeight : this.parent.getHeadersElement().clientHeight;\n\n\tthis.element.style.height = parentHeight + \"px\";\n\n\tif (this.isGroup) {\n\t\tthis.groupElement.style.minHeight = parentHeight - this.contentElement.offsetHeight + \"px\";\n\t}\n\n\t//vertically align cell contents\n\tif (!this.isGroup && alignment !== \"top\") {\n\t\tif (alignment === \"bottom\") {\n\t\t\tthis.element.style.paddingTop = this.element.clientHeight - this.contentElement.offsetHeight + \"px\";\n\t\t} else {\n\t\t\tthis.element.style.paddingTop = (this.element.clientHeight - this.contentElement.offsetHeight) / 2 + \"px\";\n\t\t}\n\t}\n\n\tthis.columns.forEach(function (column) {\n\t\tcolumn.verticalAlign(alignment);\n\t});\n};\n\n//clear vertical alignmenet\nColumn.prototype.clearVerticalAlign = function () {\n\tthis.element.style.paddingTop = \"\";\n\tthis.element.style.height = \"\";\n\tthis.element.style.minHeight = \"\";\n\tthis.groupElement.style.minHeight = \"\";\n\n\tthis.columns.forEach(function (column) {\n\t\tcolumn.clearVerticalAlign();\n\t});\n};\n\nColumn.prototype.bindModuleColumns = function () {\n\t//check if rownum formatter is being used on a column\n\tif (this.definition.formatter == \"rownum\") {\n\t\tthis.table.rowManager.rowNumColumn = this;\n\t}\n};\n\n//// Retreive Column Information ////\n\n//return column header element\nColumn.prototype.getElement = function () {\n\treturn this.element;\n};\n\n//return colunm group element\nColumn.prototype.getGroupElement = function () {\n\treturn this.groupElement;\n};\n\n//return field name\nColumn.prototype.getField = function () {\n\treturn this.field;\n};\n\n//return the first column in a group\nColumn.prototype.getFirstColumn = function () {\n\tif (!this.isGroup) {\n\t\treturn this;\n\t} else {\n\t\tif (this.columns.length) {\n\t\t\treturn this.columns[0].getFirstColumn();\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\n//return the last column in a group\nColumn.prototype.getLastColumn = function () {\n\tif (!this.isGroup) {\n\t\treturn this;\n\t} else {\n\t\tif (this.columns.length) {\n\t\t\treturn this.columns[this.columns.length - 1].getLastColumn();\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\n//return all columns in a group\nColumn.prototype.getColumns = function () {\n\treturn this.columns;\n};\n\n//return all columns in a group\nColumn.prototype.getCells = function () {\n\treturn this.cells;\n};\n\n//retreive the top column in a group of columns\nColumn.prototype.getTopColumn = function () {\n\tif (this.parent.isGroup) {\n\t\treturn this.parent.getTopColumn();\n\t} else {\n\t\treturn this;\n\t}\n};\n\n//return column definition object\nColumn.prototype.getDefinition = function (updateBranches) {\n\tvar colDefs = [];\n\n\tif (this.isGroup && updateBranches) {\n\t\tthis.columns.forEach(function (column) {\n\t\t\tcolDefs.push(column.getDefinition(true));\n\t\t});\n\n\t\tthis.definition.columns = colDefs;\n\t}\n\n\treturn this.definition;\n};\n\n//////////////////// Actions ////////////////////\n\nColumn.prototype.checkColumnVisibility = function () {\n\tvar visible = false;\n\n\tthis.columns.forEach(function (column) {\n\t\tif (column.visible) {\n\t\t\tvisible = true;\n\t\t}\n\t});\n\n\tif (visible) {\n\t\tthis.show();\n\t\tthis.parent.table.options.columnVisibilityChanged.call(this.table, this.getComponent(), false);\n\t} else {\n\t\tthis.hide();\n\t}\n};\n\n//show column\nColumn.prototype.show = function (silent, responsiveToggle) {\n\tif (!this.visible) {\n\t\tthis.visible = true;\n\n\t\tthis.element.style.display = \"\";\n\n\t\tif (this.parent.isGroup) {\n\t\t\tthis.parent.checkColumnVisibility();\n\t\t}\n\n\t\tthis.cells.forEach(function (cell) {\n\t\t\tcell.show();\n\t\t});\n\n\t\tif (!this.isGroup && this.width === null) {\n\t\t\tthis.reinitializeWidth();\n\t\t}\n\n\t\tthis.table.columnManager._verticalAlignHeaders();\n\n\t\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.columns) {\n\t\t\tthis.table.modules.persistence.save(\"columns\");\n\t\t}\n\n\t\tif (!responsiveToggle && this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\t\t\tthis.table.modules.responsiveLayout.updateColumnVisibility(this, this.visible);\n\t\t}\n\n\t\tif (!silent) {\n\t\t\tthis.table.options.columnVisibilityChanged.call(this.table, this.getComponent(), true);\n\t\t}\n\n\t\tif (this.parent.isGroup) {\n\t\t\tthis.parent.matchChildWidths();\n\t\t}\n\n\t\tif (!this.silent && this.table.options.virtualDomHoz) {\n\t\t\tthis.table.vdomHoz.reinitialize();\n\t\t}\n\t}\n};\n\n//hide column\nColumn.prototype.hide = function (silent, responsiveToggle) {\n\tif (this.visible) {\n\t\tthis.visible = false;\n\n\t\tthis.element.style.display = \"none\";\n\n\t\tthis.table.columnManager._verticalAlignHeaders();\n\n\t\tif (this.parent.isGroup) {\n\t\t\tthis.parent.checkColumnVisibility();\n\t\t}\n\n\t\tthis.cells.forEach(function (cell) {\n\t\t\tcell.hide();\n\t\t});\n\n\t\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.columns) {\n\t\t\tthis.table.modules.persistence.save(\"columns\");\n\t\t}\n\n\t\tif (!responsiveToggle && this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\t\t\tthis.table.modules.responsiveLayout.updateColumnVisibility(this, this.visible);\n\t\t}\n\n\t\tif (!silent) {\n\t\t\tthis.table.options.columnVisibilityChanged.call(this.table, this.getComponent(), false);\n\t\t}\n\n\t\tif (this.parent.isGroup) {\n\t\t\tthis.parent.matchChildWidths();\n\t\t}\n\n\t\tif (!this.silent && this.table.options.virtualDomHoz) {\n\t\t\tthis.table.vdomHoz.reinitialize();\n\t\t}\n\t}\n};\n\nColumn.prototype.matchChildWidths = function () {\n\tvar childWidth = 0;\n\n\tif (this.contentElement && this.columns.length) {\n\t\tthis.columns.forEach(function (column) {\n\t\t\tif (column.visible) {\n\t\t\t\tchildWidth += column.getWidth();\n\t\t\t}\n\t\t});\n\n\t\tthis.contentElement.style.maxWidth = childWidth - 1 + \"px\";\n\n\t\tif (this.parent.isGroup) {\n\t\t\tthis.parent.matchChildWidths();\n\t\t}\n\t}\n};\n\nColumn.prototype.removeChild = function (child) {\n\tvar index = this.columns.indexOf(child);\n\n\tif (index > -1) {\n\t\tthis.columns.splice(index, 1);\n\t}\n\n\tif (!this.columns.length) {\n\t\tthis.delete();\n\t}\n};\n\nColumn.prototype.setWidth = function (width) {\n\tthis.widthFixed = true;\n\tthis.setWidthActual(width);\n};\n\nColumn.prototype.setWidthActual = function (width) {\n\tif (isNaN(width)) {\n\t\twidth = Math.floor(this.table.element.clientWidth / 100 * parseInt(width));\n\t}\n\n\twidth = Math.max(this.minWidth, width);\n\n\tif (this.maxWidth) {\n\t\twidth = Math.min(this.maxWidth, width);\n\t}\n\n\tthis.width = width;\n\tthis.widthStyled = width ? width + \"px\" : \"\";\n\n\tthis.element.style.width = this.widthStyled;\n\n\tif (!this.isGroup) {\n\t\tthis.cells.forEach(function (cell) {\n\t\t\tcell.setWidth();\n\t\t});\n\t}\n\n\tif (this.parent.isGroup) {\n\t\tthis.parent.matchChildWidths();\n\t}\n\n\t//set resizable handles\n\tif (this.table.modExists(\"frozenColumns\")) {\n\t\tthis.table.modules.frozenColumns.layout();\n\t}\n};\n\nColumn.prototype.checkCellHeights = function () {\n\tvar rows = [];\n\n\tthis.cells.forEach(function (cell) {\n\t\tif (cell.row.heightInitialized) {\n\t\t\tif (cell.row.getElement().offsetParent !== null) {\n\t\t\t\trows.push(cell.row);\n\t\t\t\tcell.row.clearCellHeight();\n\t\t\t} else {\n\t\t\t\tcell.row.heightInitialized = false;\n\t\t\t}\n\t\t}\n\t});\n\n\trows.forEach(function (row) {\n\t\trow.calcHeight();\n\t});\n\n\trows.forEach(function (row) {\n\t\trow.setCellHeight();\n\t});\n};\n\nColumn.prototype.getWidth = function () {\n\tvar width = 0;\n\n\tif (this.isGroup) {\n\t\tthis.columns.forEach(function (column) {\n\t\t\tif (column.visible) {\n\t\t\t\twidth += column.getWidth();\n\t\t\t}\n\t\t});\n\t} else {\n\t\twidth = this.width;\n\t}\n\n\treturn width;\n};\n\nColumn.prototype.getHeight = function () {\n\treturn this.element.offsetHeight;\n};\n\nColumn.prototype.setMinWidth = function (minWidth) {\n\tthis.minWidth = minWidth;\n\tthis.minWidthStyled = minWidth ? minWidth + \"px\" : \"\";\n\n\tthis.element.style.minWidth = this.minWidthStyled;\n\n\tthis.cells.forEach(function (cell) {\n\t\tcell.setMinWidth();\n\t});\n};\n\nColumn.prototype.setMaxWidth = function (maxWidth) {\n\tthis.maxWidth = maxWidth;\n\tthis.maxWidthStyled = maxWidth ? maxWidth + \"px\" : \"\";\n\n\tthis.element.style.maxWidth = this.maxWidthStyled;\n\n\tthis.cells.forEach(function (cell) {\n\t\tcell.setMaxWidth();\n\t});\n};\n\nColumn.prototype.delete = function () {\n\tvar _this9 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar index;\n\n\t\tif (_this9.isGroup) {\n\t\t\t_this9.columns.forEach(function (column) {\n\t\t\t\tcolumn.delete();\n\t\t\t});\n\t\t}\n\n\t\t//cancel edit if column is currently being edited\n\t\tif (_this9.table.modExists(\"edit\")) {\n\t\t\tif (_this9.table.modules.edit.currentCell.column === _this9) {\n\t\t\t\t_this9.table.modules.edit.cancelEdit();\n\t\t\t}\n\t\t}\n\n\t\tvar cellCount = _this9.cells.length;\n\n\t\tfor (var _i3 = 0; _i3 < cellCount; _i3++) {\n\t\t\t_this9.cells[0].delete();\n\t\t}\n\n\t\tif (_this9.element.parentNode) {\n\t\t\t_this9.element.parentNode.removeChild(_this9.element);\n\t\t}\n\n\t\t_this9.element = false;\n\t\t_this9.contentElement = false;\n\t\t_this9.titleElement = false;\n\t\t_this9.groupElement = false;\n\n\t\tif (_this9.parent.isGroup) {\n\t\t\t_this9.parent.removeChild(_this9);\n\t\t}\n\n\t\t_this9.table.columnManager.deregisterColumn(_this9);\n\n\t\tif (_this9.table.options.virtualDomHoz) {\n\t\t\t_this9.table.vdomHoz.reinitialize(true);\n\t\t}\n\n\t\tresolve();\n\t});\n};\n\nColumn.prototype.columnRendered = function () {\n\tif (this.titleFormatterRendered) {\n\t\tthis.titleFormatterRendered();\n\t}\n};\n\nColumn.prototype.validate = function () {\n\tvar invalid = [];\n\n\tthis.cells.forEach(function (cell) {\n\t\tif (!cell.validate()) {\n\t\t\tinvalid.push(cell.getComponent());\n\t\t}\n\t});\n\n\treturn invalid.length ? invalid : true;\n};\n\n//////////////// Cell Management /////////////////\n\n//generate cell for this column\nColumn.prototype.generateCell = function (row) {\n\tvar self = this;\n\n\tvar cell = new Cell(self, row);\n\n\tthis.cells.push(cell);\n\n\treturn cell;\n};\n\nColumn.prototype.nextColumn = function () {\n\tvar index = this.table.columnManager.findColumnIndex(this);\n\treturn index > -1 ? this._nextVisibleColumn(index + 1) : false;\n};\n\nColumn.prototype._nextVisibleColumn = function (index) {\n\tvar column = this.table.columnManager.getColumnByIndex(index);\n\treturn !column || column.visible ? column : this._nextVisibleColumn(index + 1);\n};\n\nColumn.prototype.prevColumn = function () {\n\tvar index = this.table.columnManager.findColumnIndex(this);\n\treturn index > -1 ? this._prevVisibleColumn(index - 1) : false;\n};\n\nColumn.prototype._prevVisibleColumn = function (index) {\n\tvar column = this.table.columnManager.getColumnByIndex(index);\n\treturn !column || column.visible ? column : this._prevVisibleColumn(index - 1);\n};\n\nColumn.prototype.reinitializeWidth = function (force) {\n\tthis.widthFixed = false;\n\n\t//set width if present\n\tif (typeof this.definition.width !== \"undefined\" && !force) {\n\t\tthis.setWidth(this.definition.width);\n\t}\n\n\t//hide header filters to prevent them altering column width\n\tif (this.table.modExists(\"filter\")) {\n\t\tthis.table.modules.filter.hideHeaderFilterElements();\n\t}\n\n\tthis.fitToData();\n\n\t//show header filters again after layout is complete\n\tif (this.table.modExists(\"filter\")) {\n\t\tthis.table.modules.filter.showHeaderFilterElements();\n\t}\n};\n\n//set column width to maximum cell width\nColumn.prototype.fitToData = function () {\n\tvar self = this;\n\n\tif (!this.widthFixed) {\n\t\tthis.element.style.width = \"\";\n\n\t\tself.cells.forEach(function (cell) {\n\t\t\tcell.clearWidth();\n\t\t});\n\t}\n\n\tvar maxWidth = this.element.offsetWidth;\n\n\tif (!self.width || !this.widthFixed) {\n\t\tself.cells.forEach(function (cell) {\n\t\t\tvar width = cell.getWidth();\n\n\t\t\tif (width > maxWidth) {\n\t\t\t\tmaxWidth = width;\n\t\t\t}\n\t\t});\n\n\t\tif (maxWidth) {\n\t\t\tself.setWidthActual(maxWidth + 1);\n\t\t}\n\t}\n};\n\nColumn.prototype.updateDefinition = function (updates) {\n\tvar _this10 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar definition;\n\n\t\tif (!_this10.isGroup) {\n\t\t\tif (!_this10.parent.isGroup) {\n\t\t\t\tdefinition = Object.assign({}, _this10.getDefinition());\n\t\t\t\tdefinition = Object.assign(definition, updates);\n\n\t\t\t\t_this10.table.columnManager.addColumn(definition, false, _this10).then(function (column) {\n\n\t\t\t\t\tif (definition.field == _this10.field) {\n\t\t\t\t\t\t_this10.field = false; //cleair field name to prevent deletion of duplicate column from arrays\n\t\t\t\t\t}\n\n\t\t\t\t\t_this10.delete().then(function () {\n\t\t\t\t\t\tresolve(column.getComponent());\n\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t});\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\t\treject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Column Update Error - The updateDefinition function is only available on ungrouped columns\");\n\t\t\treject(\"Column Update Error - The updateDefinition function is only available on columns, not column groups\");\n\t\t}\n\t});\n};\n\nColumn.prototype.deleteCell = function (cell) {\n\tvar index = this.cells.indexOf(cell);\n\n\tif (index > -1) {\n\t\tthis.cells.splice(index, 1);\n\t}\n};\n\nColumn.prototype.defaultOptionList = [\"title\", \"field\", \"columns\", \"visible\", \"align\", \"hozAlign\", \"vertAlign\", \"width\", \"minWidth\", \"maxWidth\", \"widthGrow\", \"widthShrink\", \"resizable\", \"frozen\", \"responsive\", \"tooltip\", \"cssClass\", \"rowHandle\", \"hideInHtml\", \"print\", \"htmlOutput\", \"sorter\", \"sorterParams\", \"formatter\", \"formatterParams\", \"variableHeight\", \"editable\", \"editor\", \"editorParams\", \"validator\", \"mutator\", \"mutatorParams\", \"mutatorData\", \"mutatorDataParams\", \"mutatorEdit\", \"mutatorEditParams\", \"mutatorClipboard\", \"mutatorClipboardParams\", \"accessor\", \"accessorParams\", \"accessorData\", \"accessorDataParams\", \"accessorDownload\", \"accessorDownloadParams\", \"accessorClipboard\", \"accessorClipboardParams\", \"accessorPrint\", \"accessorPrintParams\", \"accessorHtmlOutput\", \"accessorHtmlOutputParams\", \"clipboard\", \"download\", \"downloadTitle\", \"topCalc\", \"topCalcParams\", \"topCalcFormatter\", \"topCalcFormatterParams\", \"bottomCalc\", \"bottomCalcParams\", \"bottomCalcFormatter\", \"bottomCalcFormatterParams\", \"cellClick\", \"cellDblClick\", \"cellContext\", \"cellTap\", \"cellDblTap\", \"cellTapHold\", \"cellMouseEnter\", \"cellMouseLeave\", \"cellMouseOver\", \"cellMouseOut\", \"cellMouseMove\", \"cellEditing\", \"cellEdited\", \"cellEditCancelled\", \"headerSort\", \"headerSortStartingDir\", \"headerSortTristate\", \"headerClick\", \"headerDblClick\", \"headerContext\", \"headerTap\", \"headerDblTap\", \"headerTapHold\", \"headerTooltip\", \"headerVertical\", \"headerHozAlign\", \"editableTitle\", \"titleFormatter\", \"titleFormatterParams\", \"headerFilter\", \"headerFilterPlaceholder\", \"headerFilterParams\", \"headerFilterEmptyCheck\", \"headerFilterFunc\", \"headerFilterFuncParams\", \"headerFilterLiveFilter\", \"print\", \"headerContextMenu\", \"headerMenu\", \"contextMenu\",\n// \"headerClickMenu\",\n\"clickMenu\", \"formatterPrint\", \"formatterPrintParams\", \"formatterClipboard\", \"formatterClipboardParams\", \"formatterHtmlOutput\", \"formatterHtmlOutputParams\", \"titlePrint\", \"titleClipboard\", \"titleHtmlOutput\", \"titleDownload\"];\n\n//////////////// Event Bindings /////////////////\n\n//////////////// Object Generation /////////////////\nColumn.prototype.getComponent = function () {\n\tif (!this.component) {\n\t\tthis.component = new ColumnComponent(this);\n\t}\n\n\treturn this.component;\n};\n\nvar RowManager = function RowManager(table) {\n\n\tthis.table = table;\n\tthis.element = this.createHolderElement(); //containing element\n\tthis.tableElement = this.createTableElement(); //table element\n\tthis.heightFixer = this.createTableElement(); //table element\n\tthis.columnManager = null; //hold column manager object\n\tthis.height = 0; //hold height of table element\n\n\tthis.firstRender = false; //handle first render\n\tthis.renderMode = \"virtual\"; //current rendering mode\n\tthis.fixedHeight = false; //current rendering mode\n\n\tthis.rows = []; //hold row data objects\n\tthis.activeRows = []; //rows currently available to on display in the table\n\tthis.activeRowsCount = 0; //count of active rows\n\n\tthis.displayRows = []; //rows currently on display in the table\n\tthis.displayRowsCount = 0; //count of display rows\n\n\tthis.scrollTop = 0;\n\tthis.scrollLeft = 0;\n\n\tthis.vDomRowHeight = 20; //approximation of row heights for padding\n\n\tthis.vDomTop = 0; //hold position for first rendered row in the virtual DOM\n\tthis.vDomBottom = 0; //hold possition for last rendered row in the virtual DOM\n\n\tthis.vDomScrollPosTop = 0; //last scroll position of the vDom top;\n\tthis.vDomScrollPosBottom = 0; //last scroll position of the vDom bottom;\n\n\tthis.vDomTopPad = 0; //hold value of padding for top of virtual DOM\n\tthis.vDomBottomPad = 0; //hold value of padding for bottom of virtual DOM\n\n\tthis.vDomMaxRenderChain = 90; //the maximum number of dom elements that can be rendered in 1 go\n\n\tthis.vDomWindowBuffer = 0; //window row buffer before removing elements, to smooth scrolling\n\n\tthis.vDomWindowMinTotalRows = 20; //minimum number of rows to be generated in virtual dom (prevent buffering issues on tables with tall rows)\n\tthis.vDomWindowMinMarginRows = 5; //minimum number of rows to be generated in virtual dom margin\n\n\tthis.vDomTopNewRows = []; //rows to normalize after appending to optimize render speed\n\tthis.vDomBottomNewRows = []; //rows to normalize after appending to optimize render speed\n\n\tthis.rowNumColumn = false; //hold column component for row number column\n\n\tthis.redrawBlock = false; //prevent redraws to allow multiple data manipulations becore continuing\n\tthis.redrawBlockRestoreConfig = false; //store latest redraw function calls for when redraw is needed\n\tthis.redrawBlockRederInPosition = false; //store latest redraw function calls for when redraw is needed\n};\n\n//////////////// Setup Functions /////////////////\n\nRowManager.prototype.createHolderElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-tableHolder\");\n\tel.setAttribute(\"tabindex\", 0);\n\n\treturn el;\n};\n\nRowManager.prototype.createTableElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-table\");\n\n\treturn el;\n};\n\n//return containing element\nRowManager.prototype.getElement = function () {\n\treturn this.element;\n};\n\n//return table element\nRowManager.prototype.getTableElement = function () {\n\treturn this.tableElement;\n};\n\n//return position of row in table\nRowManager.prototype.getRowPosition = function (row, active) {\n\tif (active) {\n\t\treturn this.activeRows.indexOf(row);\n\t} else {\n\t\treturn this.rows.indexOf(row);\n\t}\n};\n\n//link to column manager\nRowManager.prototype.setColumnManager = function (manager) {\n\tthis.columnManager = manager;\n};\n\nRowManager.prototype.initialize = function () {\n\tvar self = this;\n\n\tself.setRenderMode();\n\n\t//initialize manager\n\tself.element.appendChild(self.tableElement);\n\n\tself.firstRender = true;\n\n\t//scroll header along with table body\n\tself.element.addEventListener(\"scroll\", function () {\n\t\tvar left = self.element.scrollLeft;\n\n\t\t//handle horizontal scrolling\n\t\tif (self.scrollLeft != left) {\n\t\t\tself.columnManager.scrollHorizontal(left);\n\n\t\t\tif (self.table.options.groupBy) {\n\t\t\t\tself.table.modules.groupRows.scrollHeaders(left);\n\t\t\t}\n\n\t\t\tif (self.table.modExists(\"columnCalcs\")) {\n\t\t\t\tself.table.modules.columnCalcs.scrollHorizontal(left);\n\t\t\t}\n\n\t\t\tself.table.options.scrollHorizontal(left);\n\t\t}\n\n\t\tself.scrollLeft = left;\n\t});\n\n\t//handle virtual dom scrolling\n\tif (this.renderMode === \"virtual\") {\n\n\t\tself.element.addEventListener(\"scroll\", function () {\n\t\t\tvar top = self.element.scrollTop;\n\t\t\tvar dir = self.scrollTop > top;\n\n\t\t\t//handle verical scrolling\n\t\t\tif (self.scrollTop != top) {\n\t\t\t\tself.scrollTop = top;\n\t\t\t\tself.scrollVertical(dir);\n\n\t\t\t\tif (self.table.options.ajaxProgressiveLoad == \"scroll\") {\n\t\t\t\t\tself.table.modules.ajax.nextPage(self.element.scrollHeight - self.element.clientHeight - top);\n\t\t\t\t}\n\n\t\t\t\tself.table.options.scrollVertical(top);\n\t\t\t} else {\n\t\t\t\tself.scrollTop = top;\n\t\t\t}\n\t\t});\n\t}\n};\n\n////////////////// Row Manipulation //////////////////\n\nRowManager.prototype.findRow = function (subject) {\n\tvar self = this;\n\n\tif ((typeof subject === 'undefined' ? 'undefined' : _typeof(subject)) == \"object\") {\n\n\t\tif (subject instanceof Row) {\n\t\t\t//subject is row element\n\t\t\treturn subject;\n\t\t} else if (subject instanceof RowComponent) {\n\t\t\t//subject is public row component\n\t\t\treturn subject._getSelf() || false;\n\t\t} else if (typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement) {\n\t\t\t//subject is a HTML element of the row\n\t\t\tvar match = self.rows.find(function (row) {\n\t\t\t\treturn row.getElement() === subject;\n\t\t\t});\n\n\t\t\treturn match || false;\n\t\t}\n\t} else if (typeof subject == \"undefined\" || subject === null) {\n\t\treturn false;\n\t} else {\n\t\t//subject should be treated as the index of the row\n\t\tvar _match = self.rows.find(function (row) {\n\t\t\treturn row.data[self.table.options.index] == subject;\n\t\t});\n\n\t\treturn _match || false;\n\t}\n\n\t//catch all for any other type of input\n\n\treturn false;\n};\n\nRowManager.prototype.getRowFromDataObject = function (data) {\n\tvar match = this.rows.find(function (row) {\n\t\treturn row.data === data;\n\t});\n\n\treturn match || false;\n};\n\nRowManager.prototype.getRowFromPosition = function (position, active) {\n\tif (active) {\n\t\treturn this.activeRows[position];\n\t} else {\n\t\treturn this.rows[position];\n\t}\n};\n\nRowManager.prototype.scrollToRow = function (row, position, ifVisible) {\n\tvar _this11 = this;\n\n\tvar rowIndex = this.getDisplayRows().indexOf(row),\n\t    rowEl = row.getElement(),\n\t    rowTop,\n\t    offset = 0;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (rowIndex > -1) {\n\n\t\t\tif (typeof position === \"undefined\") {\n\t\t\t\tposition = _this11.table.options.scrollToRowPosition;\n\t\t\t}\n\n\t\t\tif (typeof ifVisible === \"undefined\") {\n\t\t\t\tifVisible = _this11.table.options.scrollToRowIfVisible;\n\t\t\t}\n\n\t\t\tif (position === \"nearest\") {\n\t\t\t\tswitch (_this11.renderMode) {\n\t\t\t\t\tcase \"classic\":\n\t\t\t\t\t\trowTop = Tabulator.prototype.helpers.elOffset(rowEl).top;\n\t\t\t\t\t\tposition = Math.abs(_this11.element.scrollTop - rowTop) > Math.abs(_this11.element.scrollTop + _this11.element.clientHeight - rowTop) ? \"bottom\" : \"top\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"virtual\":\n\t\t\t\t\t\tposition = Math.abs(_this11.vDomTop - rowIndex) > Math.abs(_this11.vDomBottom - rowIndex) ? \"bottom\" : \"top\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//check row visibility\n\t\t\tif (!ifVisible) {\n\t\t\t\tif (Tabulator.prototype.helpers.elVisible(rowEl)) {\n\t\t\t\t\toffset = Tabulator.prototype.helpers.elOffset(rowEl).top - Tabulator.prototype.helpers.elOffset(_this11.element).top;\n\n\t\t\t\t\tif (offset > 0 && offset < _this11.element.clientHeight - rowEl.offsetHeight) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//scroll to row\n\t\t\tswitch (_this11.renderMode) {\n\t\t\t\tcase \"classic\":\n\t\t\t\t\t_this11.element.scrollTop = Tabulator.prototype.helpers.elOffset(rowEl).top - Tabulator.prototype.helpers.elOffset(_this11.element).top + _this11.element.scrollTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"virtual\":\n\t\t\t\t\t_this11._virtualRenderFill(rowIndex, true);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t//align to correct position\n\t\t\tswitch (position) {\n\t\t\t\tcase \"middle\":\n\t\t\t\tcase \"center\":\n\n\t\t\t\t\tif (_this11.element.scrollHeight - _this11.element.scrollTop == _this11.element.clientHeight) {\n\t\t\t\t\t\t_this11.element.scrollTop = _this11.element.scrollTop + (rowEl.offsetTop - _this11.element.scrollTop) - (_this11.element.scrollHeight - rowEl.offsetTop) / 2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this11.element.scrollTop = _this11.element.scrollTop - _this11.element.clientHeight / 2;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"bottom\":\n\n\t\t\t\t\tif (_this11.element.scrollHeight - _this11.element.scrollTop == _this11.element.clientHeight) {\n\t\t\t\t\t\t_this11.element.scrollTop = _this11.element.scrollTop - (_this11.element.scrollHeight - rowEl.offsetTop) + rowEl.offsetHeight;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this11.element.scrollTop = _this11.element.scrollTop - _this11.element.clientHeight + rowEl.offsetHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tresolve();\n\t\t} else {\n\t\t\tconsole.warn(\"Scroll Error - Row not visible\");\n\t\t\treject(\"Scroll Error - Row not visible\");\n\t\t}\n\t});\n};\n\n////////////////// Data Handling //////////////////\n\nRowManager.prototype.setData = function (data, renderInPosition, columnsChanged) {\n\tvar _this12 = this;\n\n\tvar self = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (renderInPosition && _this12.getDisplayRows().length) {\n\t\t\tif (self.table.options.pagination) {\n\t\t\t\tself._setDataActual(data, true);\n\t\t\t} else {\n\t\t\t\t_this12.reRenderInPosition(function () {\n\t\t\t\t\tself._setDataActual(data);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (_this12.table.options.autoColumns && columnsChanged) {\n\t\t\t\t_this12.table.columnManager.generateColumnsFromRowData(data);\n\t\t\t}\n\t\t\t_this12.resetScroll();\n\n\t\t\t_this12._setDataActual(data);\n\t\t}\n\n\t\tresolve();\n\t});\n};\n\nRowManager.prototype._setDataActual = function (data, renderInPosition) {\n\tvar self = this;\n\n\tself.table.options.dataLoading.call(this.table, data);\n\n\tthis._wipeElements();\n\n\tif (this.table.options.history && this.table.modExists(\"history\")) {\n\t\tthis.table.modules.history.clear();\n\t}\n\n\tif (Array.isArray(data)) {\n\n\t\tif (this.table.modExists(\"selectRow\")) {\n\t\t\tthis.table.modules.selectRow.clearSelectionData();\n\t\t}\n\n\t\tif (this.table.options.reactiveData && this.table.modExists(\"reactiveData\", true)) {\n\t\t\tthis.table.modules.reactiveData.watchData(data);\n\t\t}\n\n\t\tdata.forEach(function (def, i) {\n\t\t\tif (def && (typeof def === 'undefined' ? 'undefined' : _typeof(def)) === \"object\") {\n\t\t\t\tvar row = new Row(def, self);\n\t\t\t\tself.rows.push(row);\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Data Loading Warning - Invalid row data detected and ignored, expecting object but received:\", def);\n\t\t\t}\n\t\t});\n\n\t\tself.refreshActiveData(false, false, renderInPosition);\n\n\t\tself.table.options.dataLoaded.call(this.table, data);\n\t} else {\n\t\tconsole.error(\"Data Loading Error - Unable to process data due to invalid data type \\nExpecting: array \\nReceived: \", typeof data === 'undefined' ? 'undefined' : _typeof(data), \"\\nData:     \", data);\n\t}\n};\n\nRowManager.prototype._wipeElements = function () {\n\tthis.rows.forEach(function (row) {\n\t\trow.wipe();\n\t});\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\tthis.table.modules.groupRows.wipe();\n\t}\n\n\tthis.rows = [];\n\tthis.activeRows = [];\n\tthis.activeRowsCount = 0;\n\tthis.displayRows = [];\n\tthis.displayRowsCount = 0;\n\n\tthis.adjustTableSize();\n};\n\nRowManager.prototype.deleteRow = function (row, blockRedraw) {\n\tvar allIndex = this.rows.indexOf(row),\n\t    activeIndex = this.activeRows.indexOf(row);\n\n\tif (activeIndex > -1) {\n\t\tthis.activeRows.splice(activeIndex, 1);\n\t}\n\n\tif (allIndex > -1) {\n\t\tthis.rows.splice(allIndex, 1);\n\t}\n\n\tthis.setActiveRows(this.activeRows);\n\n\tthis.displayRowIterator(function (rows) {\n\t\tvar displayIndex = rows.indexOf(row);\n\n\t\tif (displayIndex > -1) {\n\t\t\trows.splice(displayIndex, 1);\n\t\t}\n\t});\n\n\tif (!blockRedraw) {\n\t\tthis.reRenderInPosition();\n\t}\n\n\tthis.regenerateRowNumbers();\n\n\tthis.table.options.rowDeleted.call(this.table, row.getComponent());\n\n\tif (this.table.options.dataChanged) {\n\t\tthis.table.options.dataChanged.call(this.table, this.getData());\n\t}\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t} else if (this.table.options.pagination && this.table.modExists(\"page\")) {\n\t\tthis.refreshActiveData(false, false, true);\n\t} else {\n\t\tif (this.table.options.pagination && this.table.modExists(\"page\")) {\n\t\t\tthis.refreshActiveData(\"page\");\n\t\t}\n\t}\n};\n\nRowManager.prototype.addRow = function (data, pos, index, blockRedraw) {\n\n\tvar row = this.addRowActual(data, pos, index, blockRedraw);\n\n\tif (this.table.options.history && this.table.modExists(\"history\")) {\n\t\tthis.table.modules.history.action(\"rowAdd\", row, { data: data, pos: pos, index: index });\n\t}\n\n\treturn row;\n};\n\n//add multiple rows\nRowManager.prototype.addRows = function (data, pos, index) {\n\tvar _this13 = this;\n\n\tvar self = this,\n\t    length = 0,\n\t    rows = [];\n\n\treturn new Promise(function (resolve, reject) {\n\t\tpos = _this13.findAddRowPos(pos);\n\n\t\tif (!Array.isArray(data)) {\n\t\t\tdata = [data];\n\t\t}\n\n\t\tlength = data.length - 1;\n\n\t\tif (typeof index == \"undefined\" && pos || typeof index !== \"undefined\" && !pos) {\n\t\t\tdata.reverse();\n\t\t}\n\n\t\tdata.forEach(function (item, i) {\n\t\t\tvar row = self.addRow(item, pos, index, true);\n\t\t\trows.push(row);\n\t\t});\n\n\t\tif (_this13.table.options.groupBy && _this13.table.modExists(\"groupRows\")) {\n\t\t\t_this13.table.modules.groupRows.updateGroupRows(true);\n\t\t} else if (_this13.table.options.pagination && _this13.table.modExists(\"page\")) {\n\t\t\t_this13.refreshActiveData(false, false, true);\n\t\t} else {\n\t\t\t_this13.reRenderInPosition();\n\t\t}\n\n\t\t//recalc column calculations if present\n\t\tif (_this13.table.modExists(\"columnCalcs\")) {\n\t\t\t_this13.table.modules.columnCalcs.recalc(_this13.table.rowManager.activeRows);\n\t\t}\n\n\t\t_this13.regenerateRowNumbers();\n\t\tresolve(rows);\n\t});\n};\n\nRowManager.prototype.findAddRowPos = function (pos) {\n\tif (typeof pos === \"undefined\") {\n\t\tpos = this.table.options.addRowPos;\n\t}\n\n\tif (pos === \"pos\") {\n\t\tpos = true;\n\t}\n\n\tif (pos === \"bottom\") {\n\t\tpos = false;\n\t}\n\n\treturn pos;\n};\n\nRowManager.prototype.addRowActual = function (data, pos, index, blockRedraw) {\n\tvar row = data instanceof Row ? data : new Row(data || {}, this),\n\t    top = this.findAddRowPos(pos),\n\t    allIndex = -1,\n\t    activeIndex,\n\t    dispRows;\n\n\tif (!index && this.table.options.pagination && this.table.options.paginationAddRow == \"page\") {\n\t\tdispRows = this.getDisplayRows();\n\n\t\tif (top) {\n\t\t\tif (dispRows.length) {\n\t\t\t\tindex = dispRows[0];\n\t\t\t} else {\n\t\t\t\tif (this.activeRows.length) {\n\t\t\t\t\tindex = this.activeRows[this.activeRows.length - 1];\n\t\t\t\t\ttop = false;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (dispRows.length) {\n\t\t\t\tindex = dispRows[dispRows.length - 1];\n\t\t\t\ttop = dispRows.length < this.table.modules.page.getPageSize() ? false : true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (typeof index !== \"undefined\") {\n\t\tindex = this.findRow(index);\n\t}\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\tthis.table.modules.groupRows.assignRowToGroup(row);\n\n\t\tvar groupRows = row.getGroup().rows;\n\n\t\tif (groupRows.length > 1) {\n\n\t\t\tif (!index || index && groupRows.indexOf(index) == -1) {\n\t\t\t\tif (top) {\n\t\t\t\t\tif (groupRows[0] !== row) {\n\t\t\t\t\t\tindex = groupRows[0];\n\t\t\t\t\t\tthis._moveRowInArray(row.getGroup().rows, row, index, !top);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (groupRows[groupRows.length - 1] !== row) {\n\t\t\t\t\t\tindex = groupRows[groupRows.length - 1];\n\t\t\t\t\t\tthis._moveRowInArray(row.getGroup().rows, row, index, !top);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._moveRowInArray(row.getGroup().rows, row, index, !top);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index) {\n\t\tallIndex = this.rows.indexOf(index);\n\t}\n\n\tif (index && allIndex > -1) {\n\t\tactiveIndex = this.activeRows.indexOf(index);\n\n\t\tthis.displayRowIterator(function (rows) {\n\t\t\tvar displayIndex = rows.indexOf(index);\n\n\t\t\tif (displayIndex > -1) {\n\t\t\t\trows.splice(top ? displayIndex : displayIndex + 1, 0, row);\n\t\t\t}\n\t\t});\n\n\t\tif (activeIndex > -1) {\n\t\t\tthis.activeRows.splice(top ? activeIndex : activeIndex + 1, 0, row);\n\t\t}\n\n\t\tthis.rows.splice(top ? allIndex : allIndex + 1, 0, row);\n\t} else {\n\n\t\tif (top) {\n\n\t\t\tthis.displayRowIterator(function (rows) {\n\t\t\t\trows.unshift(row);\n\t\t\t});\n\n\t\t\tthis.activeRows.unshift(row);\n\t\t\tthis.rows.unshift(row);\n\t\t} else {\n\t\t\tthis.displayRowIterator(function (rows) {\n\t\t\t\trows.push(row);\n\t\t\t});\n\n\t\t\tthis.activeRows.push(row);\n\t\t\tthis.rows.push(row);\n\t\t}\n\t}\n\n\tthis.setActiveRows(this.activeRows);\n\n\tthis.table.options.rowAdded.call(this.table, row.getComponent());\n\n\tif (this.table.options.dataChanged) {\n\t\tthis.table.options.dataChanged.call(this.table, this.getData());\n\t}\n\n\tif (!blockRedraw) {\n\t\tthis.reRenderInPosition();\n\t}\n\n\treturn row;\n};\n\nRowManager.prototype.moveRow = function (from, to, after) {\n\tif (this.table.options.history && this.table.modExists(\"history\")) {\n\t\tthis.table.modules.history.action(\"rowMove\", from, { posFrom: this.getRowPosition(from), posTo: this.getRowPosition(to), to: to, after: after });\n\t}\n\n\tthis.moveRowActual(from, to, after);\n\n\tthis.regenerateRowNumbers();\n\n\tthis.table.options.rowMoved.call(this.table, from.getComponent());\n};\n\nRowManager.prototype.moveRowActual = function (from, to, after) {\n\tvar _this14 = this;\n\n\tthis._moveRowInArray(this.rows, from, to, after);\n\tthis._moveRowInArray(this.activeRows, from, to, after);\n\n\tthis.displayRowIterator(function (rows) {\n\t\t_this14._moveRowInArray(rows, from, to, after);\n\t});\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\n\t\tif (!after && to instanceof Group) {\n\t\t\tto = this.table.rowManager.prevDisplayRow(from) || to;\n\t\t}\n\n\t\tvar toGroup = to.getGroup();\n\t\tvar fromGroup = from.getGroup();\n\n\t\tif (toGroup === fromGroup) {\n\t\t\tthis._moveRowInArray(toGroup.rows, from, to, after);\n\t\t} else {\n\t\t\tif (fromGroup) {\n\t\t\t\tfromGroup.removeRow(from);\n\t\t\t}\n\n\t\t\ttoGroup.insertRow(from, to, after);\n\t\t}\n\t}\n};\n\nRowManager.prototype._moveRowInArray = function (rows, from, to, after) {\n\tvar fromIndex, toIndex, start, end;\n\n\tif (from !== to) {\n\n\t\tfromIndex = rows.indexOf(from);\n\n\t\tif (fromIndex > -1) {\n\n\t\t\trows.splice(fromIndex, 1);\n\n\t\t\ttoIndex = rows.indexOf(to);\n\n\t\t\tif (toIndex > -1) {\n\n\t\t\t\tif (after) {\n\t\t\t\t\trows.splice(toIndex + 1, 0, from);\n\t\t\t\t} else {\n\t\t\t\t\trows.splice(toIndex, 0, from);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trows.splice(fromIndex, 0, from);\n\t\t\t}\n\t\t}\n\n\t\t//restyle rows\n\t\tif (rows === this.getDisplayRows()) {\n\n\t\t\tstart = fromIndex < toIndex ? fromIndex : toIndex;\n\t\t\tend = toIndex > fromIndex ? toIndex : fromIndex + 1;\n\n\t\t\tfor (var _i4 = start; _i4 <= end; _i4++) {\n\t\t\t\tif (rows[_i4]) {\n\t\t\t\t\tthis.styleRow(rows[_i4], _i4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nRowManager.prototype.clearData = function () {\n\tthis.setData([]);\n};\n\nRowManager.prototype.getRowIndex = function (row) {\n\treturn this.findRowIndex(row, this.rows);\n};\n\nRowManager.prototype.getDisplayRowIndex = function (row) {\n\tvar index = this.getDisplayRows().indexOf(row);\n\treturn index > -1 ? index : false;\n};\n\nRowManager.prototype.nextDisplayRow = function (row, rowOnly) {\n\tvar index = this.getDisplayRowIndex(row),\n\t    nextRow = false;\n\n\tif (index !== false && index < this.displayRowsCount - 1) {\n\t\tnextRow = this.getDisplayRows()[index + 1];\n\t}\n\n\tif (nextRow && (!(nextRow instanceof Row) || nextRow.type != \"row\")) {\n\t\treturn this.nextDisplayRow(nextRow, rowOnly);\n\t}\n\n\treturn nextRow;\n};\n\nRowManager.prototype.prevDisplayRow = function (row, rowOnly) {\n\tvar index = this.getDisplayRowIndex(row),\n\t    prevRow = false;\n\n\tif (index) {\n\t\tprevRow = this.getDisplayRows()[index - 1];\n\t}\n\n\tif (rowOnly && prevRow && (!(prevRow instanceof Row) || prevRow.type != \"row\")) {\n\t\treturn this.prevDisplayRow(prevRow, rowOnly);\n\t}\n\n\treturn prevRow;\n};\n\nRowManager.prototype.findRowIndex = function (row, list) {\n\tvar rowIndex;\n\n\trow = this.findRow(row);\n\n\tif (row) {\n\t\trowIndex = list.indexOf(row);\n\n\t\tif (rowIndex > -1) {\n\t\t\treturn rowIndex;\n\t\t}\n\t}\n\n\treturn false;\n};\n\nRowManager.prototype.getData = function (active, transform) {\n\tvar output = [],\n\t    rows = this.getRows(active);\n\n\trows.forEach(function (row) {\n\t\tif (row.type == \"row\") {\n\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t}\n\t});\n\n\treturn output;\n};\n\nRowManager.prototype.getComponents = function (active) {\n\tvar output = [],\n\t    rows = this.getRows(active);\n\n\trows.forEach(function (row) {\n\t\toutput.push(row.getComponent());\n\t});\n\n\treturn output;\n};\n\nRowManager.prototype.getDataCount = function (active) {\n\tvar rows = this.getRows(active);\n\n\treturn rows.length;\n};\n\nRowManager.prototype._genRemoteRequest = function () {\n\tvar _this15 = this;\n\n\tvar table = this.table,\n\t    options = table.options,\n\t    params = {};\n\n\tif (table.modExists(\"page\")) {\n\t\t//set sort data if defined\n\t\tif (options.ajaxSorting) {\n\t\t\tvar sorters = this.table.modules.sort.getSort();\n\n\t\t\tsorters.forEach(function (item) {\n\t\t\t\tdelete item.column;\n\t\t\t});\n\n\t\t\tparams[this.table.modules.page.paginationDataSentNames.sorters] = sorters;\n\t\t}\n\n\t\t//set filter data if defined\n\t\tif (options.ajaxFiltering) {\n\t\t\tvar filters = this.table.modules.filter.getFilters(true, true);\n\n\t\t\tparams[this.table.modules.page.paginationDataSentNames.filters] = filters;\n\t\t}\n\n\t\tthis.table.modules.ajax.setParams(params, true);\n\t}\n\n\ttable.modules.ajax.sendRequest().then(function (data) {\n\t\t_this15._setDataActual(data, true);\n\t}).catch(function (e) {});\n};\n\n//choose the path to refresh data after a filter update\nRowManager.prototype.filterRefresh = function () {\n\tvar table = this.table,\n\t    options = table.options,\n\t    left = this.scrollLeft;\n\n\tif (options.ajaxFiltering) {\n\t\tif (options.pagination == \"remote\" && table.modExists(\"page\")) {\n\t\t\ttable.modules.page.reset(true);\n\t\t\ttable.modules.page.setPage(1).then(function () {}).catch(function () {});\n\t\t} else if (options.ajaxProgressiveLoad) {\n\t\t\ttable.modules.ajax.loadData().then(function () {}).catch(function () {});\n\t\t} else {\n\t\t\t//assume data is url, make ajax call to url to get data\n\t\t\tthis._genRemoteRequest();\n\t\t}\n\t} else {\n\t\tthis.refreshActiveData(\"filter\");\n\t}\n\n\tthis.scrollHorizontal(left);\n};\n\n//choose the path to refresh data after a sorter update\nRowManager.prototype.sorterRefresh = function (loadOrignalData) {\n\tvar table = this.table,\n\t    options = this.table.options,\n\t    left = this.scrollLeft;\n\n\tif (options.ajaxSorting) {\n\t\tif ((options.pagination == \"remote\" || options.progressiveLoad) && table.modExists(\"page\")) {\n\t\t\ttable.modules.page.reset(true);\n\t\t\ttable.modules.page.setPage(1).then(function () {}).catch(function () {});\n\t\t} else if (options.ajaxProgressiveLoad) {\n\t\t\ttable.modules.ajax.loadData().then(function () {}).catch(function () {});\n\t\t} else {\n\t\t\t//assume data is url, make ajax call to url to get data\n\t\t\tthis._genRemoteRequest();\n\t\t}\n\t} else {\n\t\tthis.refreshActiveData(loadOrignalData ? \"filter\" : \"sort\");\n\t}\n\n\tthis.scrollHorizontal(left);\n};\n\nRowManager.prototype.scrollHorizontal = function (left) {\n\tthis.scrollLeft = left;\n\tthis.element.scrollLeft = left;\n\n\tif (this.table.options.groupBy) {\n\t\tthis.table.modules.groupRows.scrollHeaders(left);\n\t}\n\n\tif (this.table.modExists(\"columnCalcs\")) {\n\t\tthis.table.modules.columnCalcs.scrollHorizontal(left);\n\t}\n};\n\n//set active data set\nRowManager.prototype.refreshActiveData = function (stage, skipStage, renderInPosition) {\n\tvar self = this,\n\t    table = this.table,\n\t    cascadeOrder = [\"all\", \"filter\", \"sort\", \"display\", \"freeze\", \"group\", \"tree\", \"page\"],\n\t    displayIndex;\n\n\tif (this.redrawBlock) {\n\n\t\tif (!this.redrawBlockRestoreConfig || cascadeOrder.indexOf(stage) < cascadeOrder.indexOf(this.redrawBlockRestoreConfig.stage)) {\n\t\t\tthis.redrawBlockRestoreConfig = {\n\t\t\t\tstage: stage,\n\t\t\t\tskipStage: skipStage,\n\t\t\t\trenderInPosition: renderInPosition\n\t\t\t};\n\t\t}\n\n\t\treturn;\n\t} else {\n\n\t\tif (self.table.modExists(\"edit\")) {\n\t\t\tself.table.modules.edit.cancelEdit();\n\t\t}\n\n\t\tif (!stage) {\n\t\t\tstage = \"all\";\n\t\t}\n\n\t\tif (table.options.selectable && !table.options.selectablePersistence && table.modExists(\"selectRow\")) {\n\t\t\ttable.modules.selectRow.deselectRows();\n\t\t}\n\n\t\t//cascade through data refresh stages\n\t\tswitch (stage) {\n\t\t\tcase \"all\":\n\n\t\t\tcase \"filter\":\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (table.modExists(\"filter\")) {\n\t\t\t\t\t\tself.setActiveRows(table.modules.filter.filter(self.rows));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.setActiveRows(self.rows.slice(0));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\n\t\t\tcase \"sort\":\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (table.modExists(\"sort\")) {\n\t\t\t\t\t\ttable.modules.sort.sort(this.activeRows);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\n\t\t\t\t//regenerate row numbers for row number formatter if in use\n\t\t\t\tthis.regenerateRowNumbers();\n\n\t\t\t//generic stage to allow for pipeline trigger after the data manipulation stage\n\t\t\tcase \"display\":\n\t\t\t\tthis.resetDisplayRows();\n\n\t\t\tcase \"freeze\":\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (this.table.modExists(\"frozenRows\")) {\n\t\t\t\t\t\tif (table.modules.frozenRows.isFrozen()) {\n\t\t\t\t\t\t\tif (!table.modules.frozenRows.getDisplayIndex()) {\n\t\t\t\t\t\t\t\ttable.modules.frozenRows.setDisplayIndex(this.getNextDisplayIndex());\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdisplayIndex = table.modules.frozenRows.getDisplayIndex();\n\n\t\t\t\t\t\t\tdisplayIndex = self.setDisplayRows(table.modules.frozenRows.getRows(this.getDisplayRows(displayIndex - 1)), displayIndex);\n\n\t\t\t\t\t\t\tif (displayIndex !== true) {\n\t\t\t\t\t\t\t\ttable.modules.frozenRows.setDisplayIndex(displayIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\n\t\t\tcase \"group\":\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (table.options.groupBy && table.modExists(\"groupRows\")) {\n\n\t\t\t\t\t\tif (!table.modules.groupRows.getDisplayIndex()) {\n\t\t\t\t\t\t\ttable.modules.groupRows.setDisplayIndex(this.getNextDisplayIndex());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisplayIndex = table.modules.groupRows.getDisplayIndex();\n\n\t\t\t\t\t\tdisplayIndex = self.setDisplayRows(table.modules.groupRows.getRows(this.getDisplayRows(displayIndex - 1)), displayIndex);\n\n\t\t\t\t\t\tif (displayIndex !== true) {\n\t\t\t\t\t\t\ttable.modules.groupRows.setDisplayIndex(displayIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\n\t\t\tcase \"tree\":\n\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (table.options.dataTree && table.modExists(\"dataTree\")) {\n\t\t\t\t\t\tif (!table.modules.dataTree.getDisplayIndex()) {\n\t\t\t\t\t\t\ttable.modules.dataTree.setDisplayIndex(this.getNextDisplayIndex());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisplayIndex = table.modules.dataTree.getDisplayIndex();\n\n\t\t\t\t\t\tdisplayIndex = self.setDisplayRows(table.modules.dataTree.getRows(this.getDisplayRows(displayIndex - 1)), displayIndex);\n\n\t\t\t\t\t\tif (displayIndex !== true) {\n\t\t\t\t\t\t\ttable.modules.dataTree.setDisplayIndex(displayIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\n\t\t\t\tif (table.options.pagination && table.modExists(\"page\") && !renderInPosition) {\n\t\t\t\t\tif (table.modules.page.getMode() == \"local\") {\n\t\t\t\t\t\ttable.modules.page.reset();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\tcase \"page\":\n\t\t\t\tif (!skipStage) {\n\t\t\t\t\tif (table.options.pagination && table.modExists(\"page\")) {\n\n\t\t\t\t\t\tif (!table.modules.page.getDisplayIndex()) {\n\t\t\t\t\t\t\ttable.modules.page.setDisplayIndex(this.getNextDisplayIndex());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisplayIndex = table.modules.page.getDisplayIndex();\n\n\t\t\t\t\t\tif (table.modules.page.getMode() == \"local\") {\n\t\t\t\t\t\t\ttable.modules.page.setMaxRows(this.getDisplayRows(displayIndex - 1).length);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdisplayIndex = self.setDisplayRows(table.modules.page.getRows(this.getDisplayRows(displayIndex - 1)), displayIndex);\n\n\t\t\t\t\t\tif (displayIndex !== true) {\n\t\t\t\t\t\t\ttable.modules.page.setDisplayIndex(displayIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tskipStage = false;\n\t\t\t\t}\n\t\t}\n\n\t\tif (Tabulator.prototype.helpers.elVisible(self.element)) {\n\t\t\tif (renderInPosition) {\n\t\t\t\tself.reRenderInPosition();\n\t\t\t} else {\n\n\t\t\t\tif (stage === \"all\" && this.table.options.virtualDomHoz) {\n\t\t\t\t\tthis.table.vdomHoz.dataChange();\n\t\t\t\t}\n\n\t\t\t\tself.renderTable();\n\n\t\t\t\tif (table.options.layoutColumnsOnNewData) {\n\t\t\t\t\tself.table.columnManager.redraw(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (table.modExists(\"columnCalcs\")) {\n\t\t\ttable.modules.columnCalcs.recalc(this.activeRows);\n\t\t}\n\t}\n};\n\n//regenerate row numbers for row number formatter if in use\nRowManager.prototype.regenerateRowNumbers = function () {\n\tvar _this16 = this;\n\n\tif (this.rowNumColumn) {\n\t\tthis.activeRows.forEach(function (row) {\n\t\t\tvar cell = row.getCell(_this16.rowNumColumn);\n\n\t\t\tif (cell) {\n\t\t\t\tcell._generateContents();\n\t\t\t}\n\t\t});\n\t}\n};\n\nRowManager.prototype.setActiveRows = function (activeRows) {\n\tthis.activeRows = activeRows;\n\tthis.activeRowsCount = this.activeRows.length;\n};\n\n//reset display rows array\nRowManager.prototype.resetDisplayRows = function () {\n\tthis.displayRows = [];\n\n\tthis.displayRows.push(this.activeRows.slice(0));\n\n\tthis.displayRowsCount = this.displayRows[0].length;\n\n\tif (this.table.modExists(\"frozenRows\")) {\n\t\tthis.table.modules.frozenRows.setDisplayIndex(0);\n\t}\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\tthis.table.modules.groupRows.setDisplayIndex(0);\n\t}\n\n\tif (this.table.options.pagination && this.table.modExists(\"page\")) {\n\t\tthis.table.modules.page.setDisplayIndex(0);\n\t}\n};\n\nRowManager.prototype.getNextDisplayIndex = function () {\n\treturn this.displayRows.length;\n};\n\n//set display row pipeline data\nRowManager.prototype.setDisplayRows = function (displayRows, index) {\n\n\tvar output = true;\n\n\tif (index && typeof this.displayRows[index] != \"undefined\") {\n\t\tthis.displayRows[index] = displayRows;\n\t\toutput = true;\n\t} else {\n\t\tthis.displayRows.push(displayRows);\n\t\toutput = index = this.displayRows.length - 1;\n\t}\n\n\tif (index == this.displayRows.length - 1) {\n\t\tthis.displayRowsCount = this.displayRows[this.displayRows.length - 1].length;\n\t}\n\n\treturn output;\n};\n\nRowManager.prototype.getDisplayRows = function (index) {\n\tif (typeof index == \"undefined\") {\n\t\treturn this.displayRows.length ? this.displayRows[this.displayRows.length - 1] : [];\n\t} else {\n\t\treturn this.displayRows[index] || [];\n\t}\n};\n\nRowManager.prototype.getVisibleRows = function (viewable) {\n\tvar topEdge = this.element.scrollTop,\n\t    bottomEdge = this.element.clientHeight + topEdge,\n\t    topFound = false,\n\t    topRow = 0,\n\t    bottomRow = 0,\n\t    rows = this.getDisplayRows();\n\n\tif (viewable) {\n\n\t\tthis.getDisplayRows();\n\t\tfor (var i = this.vDomTop; i <= this.vDomBottom; i++) {\n\t\t\tif (rows[i]) {\n\t\t\t\tif (!topFound) {\n\t\t\t\t\tif (topEdge - rows[i].getElement().offsetTop >= 0) {\n\t\t\t\t\t\ttopRow = i;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttopFound = true;\n\n\t\t\t\t\t\tif (bottomEdge - rows[i].getElement().offsetTop >= 0) {\n\t\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (bottomEdge - rows[i].getElement().offsetTop >= 0) {\n\t\t\t\t\t\tbottomRow = i;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\ttopRow = this.vDomTop;\n\t\tbottomRow = this.vDomBottom;\n\t}\n\n\treturn rows.slice(topRow, bottomRow + 1);\n};\n\n//repeat action accross display rows\nRowManager.prototype.displayRowIterator = function (callback) {\n\tthis.displayRows.forEach(callback);\n\n\tthis.displayRowsCount = this.displayRows[this.displayRows.length - 1].length;\n};\n\n//return only actual rows (not group headers etc)\nRowManager.prototype.getRows = function (active) {\n\tvar rows;\n\n\tswitch (active) {\n\t\tcase \"active\":\n\t\t\trows = this.activeRows;\n\t\t\tbreak;\n\n\t\tcase \"display\":\n\t\t\trows = this.table.rowManager.getDisplayRows();\n\t\t\tbreak;\n\n\t\tcase \"visible\":\n\t\t\trows = this.getVisibleRows(true);\n\t\t\tbreak;\n\n\t\tcase \"selected\":\n\t\t\trows = this.table.modules.selectRow.selectedRows;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\trows = this.rows;\n\t}\n\n\treturn rows;\n};\n\n///////////////// Table Rendering /////////////////\n\n//trigger rerender of table in current position\nRowManager.prototype.reRenderInPosition = function (callback) {\n\tif (this.getRenderMode() == \"virtual\") {\n\n\t\tif (this.redrawBlock) {\n\t\t\tif (callback) {\n\t\t\t\tcallback();\n\t\t\t} else {\n\t\t\t\tthis.redrawBlockRederInPosition = true;\n\t\t\t}\n\t\t} else {\n\t\t\tvar scrollTop = this.element.scrollTop;\n\t\t\tvar topRow = false;\n\t\t\tvar topOffset = false;\n\n\t\t\tvar left = this.scrollLeft;\n\n\t\t\tvar rows = this.getDisplayRows();\n\n\t\t\tfor (var i = this.vDomTop; i <= this.vDomBottom; i++) {\n\n\t\t\t\tif (rows[i]) {\n\t\t\t\t\tvar diff = scrollTop - rows[i].getElement().offsetTop;\n\n\t\t\t\t\tif (topOffset === false || Math.abs(diff) < topOffset) {\n\t\t\t\t\t\ttopOffset = diff;\n\t\t\t\t\t\ttopRow = i;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (callback) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\tthis._virtualRenderFill(topRow === false ? this.displayRowsCount - 1 : topRow, true, topOffset || 0);\n\n\t\t\tthis.scrollHorizontal(left);\n\t\t}\n\t} else {\n\t\tthis.renderTable();\n\n\t\tif (callback) {\n\t\t\tcallback();\n\t\t}\n\t}\n};\n\nRowManager.prototype.setRenderMode = function () {\n\n\tif (this.table.options.virtualDom) {\n\n\t\tthis.renderMode = \"virtual\";\n\n\t\tif (this.table.element.clientHeight || this.table.options.height) {\n\t\t\tthis.fixedHeight = true;\n\t\t} else {\n\t\t\tthis.fixedHeight = false;\n\t\t}\n\t} else {\n\t\tthis.renderMode = \"classic\";\n\t}\n};\n\nRowManager.prototype.getRenderMode = function () {\n\treturn this.renderMode;\n};\n\nRowManager.prototype.renderTable = function () {\n\n\tthis.table.options.renderStarted.call(this.table);\n\n\tthis.element.scrollTop = 0;\n\n\tswitch (this.renderMode) {\n\t\tcase \"classic\":\n\t\t\tthis._simpleRender();\n\t\t\tbreak;\n\n\t\tcase \"virtual\":\n\t\t\tthis._virtualRenderFill();\n\t\t\tbreak;\n\t}\n\n\tif (this.firstRender) {\n\t\tif (this.displayRowsCount) {\n\t\t\tthis.firstRender = false;\n\t\t\tthis.table.modules.layout.layout();\n\t\t} else {\n\t\t\tthis.renderEmptyScroll();\n\t\t}\n\t}\n\n\tif (this.table.modExists(\"frozenColumns\")) {\n\t\tthis.table.modules.frozenColumns.layout();\n\t}\n\n\tif (!this.displayRowsCount) {\n\t\tif (this.table.options.placeholder) {\n\n\t\t\tthis.table.options.placeholder.setAttribute(\"tabulator-render-mode\", this.renderMode);\n\n\t\t\tthis.getElement().appendChild(this.table.options.placeholder);\n\t\t\tthis.table.options.placeholder.style.width = this.table.columnManager.getWidth() + \"px\";\n\t\t}\n\t}\n\n\tthis.table.options.renderComplete.call(this.table);\n};\n\n//simple render on heightless table\nRowManager.prototype._simpleRender = function () {\n\tthis._clearVirtualDom();\n\n\tif (this.displayRowsCount) {\n\t\tthis.checkClassicModeGroupHeaderWidth();\n\t} else {\n\t\tthis.renderEmptyScroll();\n\t}\n};\n\nRowManager.prototype.checkClassicModeGroupHeaderWidth = function () {\n\tvar self = this,\n\t    element = this.tableElement,\n\t    onlyGroupHeaders = true;\n\n\tself.getDisplayRows().forEach(function (row, index) {\n\t\tself.styleRow(row, index);\n\t\telement.appendChild(row.getElement());\n\t\trow.initialize(true);\n\n\t\tif (row.type !== \"group\") {\n\t\t\tonlyGroupHeaders = false;\n\t\t}\n\t});\n\n\tif (onlyGroupHeaders) {\n\t\telement.style.minWidth = self.table.columnManager.getWidth() + \"px\";\n\t} else {\n\t\telement.style.minWidth = \"\";\n\t}\n};\n\n//show scrollbars on empty table div\nRowManager.prototype.renderEmptyScroll = function () {\n\tif (this.table.options.placeholder) {\n\t\tthis.tableElement.style.display = \"none\";\n\t} else {\n\t\tthis.tableElement.style.minWidth = this.table.columnManager.getWidth() + \"px\";\n\t\t// this.tableElement.style.minHeight = \"1px\";\n\t\t// this.tableElement.style.visibility = \"hidden\";\n\t}\n};\n\nRowManager.prototype._clearVirtualDom = function () {\n\tvar element = this.tableElement;\n\n\tif (this.table.options.placeholder && this.table.options.placeholder.parentNode) {\n\t\tthis.table.options.placeholder.parentNode.removeChild(this.table.options.placeholder);\n\t}\n\n\t// element.children.detach();\n\twhile (element.firstChild) {\n\t\telement.removeChild(element.firstChild);\n\t}element.style.paddingTop = \"\";\n\telement.style.paddingBottom = \"\";\n\telement.style.minWidth = \"\";\n\telement.style.minHeight = \"\";\n\telement.style.display = \"\";\n\telement.style.visibility = \"\";\n\n\tthis.scrollTop = 0;\n\tthis.scrollLeft = 0;\n\tthis.vDomTop = 0;\n\tthis.vDomBottom = 0;\n\tthis.vDomTopPad = 0;\n\tthis.vDomBottomPad = 0;\n};\n\nRowManager.prototype.styleRow = function (row, index) {\n\tvar rowEl = row.getElement();\n\n\tif (index % 2) {\n\t\trowEl.classList.add(\"tabulator-row-even\");\n\t\trowEl.classList.remove(\"tabulator-row-odd\");\n\t} else {\n\t\trowEl.classList.add(\"tabulator-row-odd\");\n\t\trowEl.classList.remove(\"tabulator-row-even\");\n\t}\n};\n\n//full virtual render\nRowManager.prototype._virtualRenderFill = function (position, forceMove, offset) {\n\tvar self = this,\n\t    element = self.tableElement,\n\t    holder = self.element,\n\t    topPad = 0,\n\t    rowsHeight = 0,\n\t    topPadHeight = 0,\n\t    i = 0,\n\t    onlyGroupHeaders = true,\n\t    rows = self.getDisplayRows();\n\n\tposition = position || 0;\n\n\toffset = offset || 0;\n\n\tif (!position) {\n\t\tself._clearVirtualDom();\n\t} else {\n\t\twhile (element.firstChild) {\n\t\t\telement.removeChild(element.firstChild);\n\t\t} //check if position is too close to bottom of table\n\t\tvar heightOccupied = (self.displayRowsCount - position + 1) * self.vDomRowHeight;\n\n\t\tif (heightOccupied < self.height) {\n\t\t\tposition -= Math.ceil((self.height - heightOccupied) / self.vDomRowHeight);\n\n\t\t\tif (position < 0) {\n\t\t\t\tposition = 0;\n\t\t\t}\n\t\t}\n\n\t\t//calculate initial pad\n\t\ttopPad = Math.min(Math.max(Math.floor(self.vDomWindowBuffer / self.vDomRowHeight), self.vDomWindowMinMarginRows), position);\n\t\tposition -= topPad;\n\t}\n\n\tif (self.displayRowsCount && Tabulator.prototype.helpers.elVisible(self.element)) {\n\n\t\tself.vDomTop = position;\n\n\t\tself.vDomBottom = position - 1;\n\n\t\twhile ((rowsHeight <= self.height + self.vDomWindowBuffer || i < self.vDomWindowMinTotalRows) && self.vDomBottom < self.displayRowsCount - 1) {\n\t\t\tvar index = self.vDomBottom + 1,\n\t\t\t    row = rows[index],\n\t\t\t    rowHeight = 0;\n\n\t\t\tself.styleRow(row, index);\n\n\t\t\telement.appendChild(row.getElement());\n\n\t\t\trow.initialize();\n\n\t\t\tif (!row.heightInitialized) {\n\t\t\t\trow.normalizeHeight(true);\n\t\t\t}\n\n\t\t\t// if(!row.initialized){\n\t\t\t// \trow.initialize(true);\n\t\t\t// }else{\n\t\t\t// \tif(!row.heightInitialized){\n\t\t\t// \t\trow.normalizeHeight(true);\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t\trowHeight = row.getHeight();\n\n\t\t\tif (i < topPad) {\n\t\t\t\ttopPadHeight += rowHeight;\n\t\t\t} else {\n\t\t\t\trowsHeight += rowHeight;\n\t\t\t}\n\n\t\t\tif (rowHeight > this.vDomWindowBuffer) {\n\t\t\t\tthis.vDomWindowBuffer = rowHeight * 2;\n\t\t\t}\n\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tonlyGroupHeaders = false;\n\t\t\t}\n\n\t\t\tself.vDomBottom++;\n\t\t\ti++;\n\t\t}\n\n\t\tif (!position) {\n\t\t\tthis.vDomTopPad = 0;\n\t\t\t//adjust rowheight to match average of rendered elements\n\t\t\tself.vDomRowHeight = Math.floor((rowsHeight + topPadHeight) / i);\n\t\t\tself.vDomBottomPad = self.vDomRowHeight * (self.displayRowsCount - self.vDomBottom - 1);\n\n\t\t\tself.vDomScrollHeight = topPadHeight + rowsHeight + self.vDomBottomPad - self.height;\n\t\t} else {\n\t\t\tself.vDomTopPad = !forceMove ? self.scrollTop - topPadHeight : self.vDomRowHeight * this.vDomTop + offset;\n\t\t\tself.vDomBottomPad = self.vDomBottom == self.displayRowsCount - 1 ? 0 : Math.max(self.vDomScrollHeight - self.vDomTopPad - rowsHeight - topPadHeight, 0);\n\t\t}\n\n\t\telement.style.paddingTop = self.vDomTopPad + \"px\";\n\t\telement.style.paddingBottom = self.vDomBottomPad + \"px\";\n\n\t\tif (forceMove) {\n\t\t\tthis.scrollTop = self.vDomTopPad + topPadHeight + offset - (this.element.scrollWidth > this.element.clientWidth ? this.element.offsetHeight - this.element.clientHeight : 0);\n\t\t}\n\n\t\tthis.scrollTop = Math.min(this.scrollTop, this.element.scrollHeight - this.height);\n\n\t\t//adjust for horizontal scrollbar if present (and not at top of table)\n\t\tif (this.element.scrollWidth > this.element.offsetWidth && forceMove) {\n\t\t\tthis.scrollTop += this.element.offsetHeight - this.element.clientHeight;\n\t\t}\n\n\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\n\t\tholder.scrollTop = this.scrollTop;\n\n\t\telement.style.minWidth = onlyGroupHeaders ? self.table.columnManager.getWidth() + \"px\" : \"\";\n\n\t\tif (self.table.options.groupBy) {\n\t\t\tif (self.table.modules.layout.getMode() != \"fitDataFill\" && self.displayRowsCount == self.table.modules.groupRows.countGroups()) {\n\t\t\t\tself.tableElement.style.minWidth = self.table.columnManager.getWidth();\n\t\t\t}\n\t\t}\n\t} else {\n\t\tthis.renderEmptyScroll();\n\t}\n\n\tif (!this.fixedHeight) {\n\t\tthis.adjustTableSize();\n\t}\n};\n\n//handle vertical scrolling\nRowManager.prototype.scrollVertical = function (dir) {\n\tvar topDiff = this.scrollTop - this.vDomScrollPosTop;\n\tvar bottomDiff = this.scrollTop - this.vDomScrollPosBottom;\n\tvar margin = this.vDomWindowBuffer * 2;\n\n\tif (-topDiff > margin || bottomDiff > margin) {\n\t\t//if big scroll redraw table;\n\t\tvar left = this.scrollLeft;\n\t\tthis._virtualRenderFill(Math.floor(this.element.scrollTop / this.element.scrollHeight * this.displayRowsCount));\n\t\tthis.scrollHorizontal(left);\n\t} else {\n\n\t\tif (dir) {\n\t\t\t//scrolling up\n\t\t\tif (topDiff < 0) {\n\n\t\t\t\tthis._addTopRow(-topDiff);\n\t\t\t}\n\n\t\t\tif (bottomDiff < 0) {\n\n\t\t\t\t//hide bottom row if needed\n\t\t\t\tif (this.vDomScrollHeight - this.scrollTop > this.vDomWindowBuffer) {\n\t\t\t\t\tthis._removeBottomRow(-bottomDiff);\n\t\t\t\t} else {\n\t\t\t\t\tthis.vDomScrollPosBottom = this.scrollTop;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t//scrolling down\n\t\t\tif (topDiff >= 0) {\n\n\t\t\t\t//hide top row if needed\n\t\t\t\tif (this.scrollTop > this.vDomWindowBuffer) {\n\n\t\t\t\t\tthis._removeTopRow(topDiff);\n\t\t\t\t} else {\n\t\t\t\t\tthis.vDomScrollPosTop = this.scrollTop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (bottomDiff >= 0) {\n\n\t\t\t\tthis._addBottomRow(bottomDiff);\n\t\t\t}\n\t\t}\n\t}\n};\n\nRowManager.prototype._addTopRow = function (topDiff) {\n\tvar i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n\tvar table = this.tableElement,\n\t    rows = this.getDisplayRows();\n\n\tif (this.vDomTop) {\n\t\tvar index = this.vDomTop - 1,\n\t\t    topRow = rows[index],\n\t\t    topRowHeight = topRow.getHeight() || this.vDomRowHeight;\n\n\t\t//hide top row if needed\n\t\tif (topDiff >= topRowHeight) {\n\t\t\tthis.styleRow(topRow, index);\n\t\t\ttable.insertBefore(topRow.getElement(), table.firstChild);\n\t\t\tif (!topRow.initialized || !topRow.heightInitialized) {\n\t\t\t\tthis.vDomTopNewRows.push(topRow);\n\n\t\t\t\tif (!topRow.heightInitialized) {\n\t\t\t\t\ttopRow.clearCellHeight();\n\t\t\t\t}\n\t\t\t}\n\t\t\ttopRow.initialize();\n\n\t\t\tthis.vDomTopPad -= topRowHeight;\n\n\t\t\tif (this.vDomTopPad < 0) {\n\t\t\t\tthis.vDomTopPad = index * this.vDomRowHeight;\n\t\t\t}\n\n\t\t\tif (!index) {\n\t\t\t\tthis.vDomTopPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingTop = this.vDomTopPad + \"px\";\n\t\t\tthis.vDomScrollPosTop -= topRowHeight;\n\t\t\tthis.vDomTop--;\n\t\t}\n\n\t\ttopDiff = -(this.scrollTop - this.vDomScrollPosTop);\n\n\t\tif (topRow.getHeight() > this.vDomWindowBuffer) {\n\t\t\tthis.vDomWindowBuffer = topRow.getHeight() * 2;\n\t\t}\n\n\t\tif (i < this.vDomMaxRenderChain && this.vDomTop && topDiff >= (rows[this.vDomTop - 1].getHeight() || this.vDomRowHeight)) {\n\t\t\tthis._addTopRow(topDiff, i + 1);\n\t\t} else {\n\t\t\tthis._quickNormalizeRowHeight(this.vDomTopNewRows);\n\t\t}\n\t}\n};\n\nRowManager.prototype._removeTopRow = function (topDiff) {\n\tvar table = this.tableElement,\n\t    topRow = this.getDisplayRows()[this.vDomTop],\n\t    topRowHeight = topRow.getHeight() || this.vDomRowHeight;\n\n\tif (topDiff >= topRowHeight) {\n\n\t\tvar rowEl = topRow.getElement();\n\t\trowEl.parentNode.removeChild(rowEl);\n\n\t\tthis.vDomTopPad += topRowHeight;\n\t\ttable.style.paddingTop = this.vDomTopPad + \"px\";\n\t\tthis.vDomScrollPosTop += this.vDomTop ? topRowHeight : topRowHeight + this.vDomWindowBuffer;\n\t\tthis.vDomTop++;\n\n\t\ttopDiff = this.scrollTop - this.vDomScrollPosTop;\n\n\t\tthis._removeTopRow(topDiff);\n\t}\n};\n\nRowManager.prototype._addBottomRow = function (bottomDiff) {\n\tvar i = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n\tvar table = this.tableElement,\n\t    rows = this.getDisplayRows();\n\n\tif (this.vDomBottom < this.displayRowsCount - 1) {\n\t\tvar index = this.vDomBottom + 1,\n\t\t    bottomRow = rows[index],\n\t\t    bottomRowHeight = bottomRow.getHeight() || this.vDomRowHeight;\n\n\t\t//hide bottom row if needed\n\t\tif (bottomDiff >= bottomRowHeight) {\n\t\t\tthis.styleRow(bottomRow, index);\n\t\t\ttable.appendChild(bottomRow.getElement());\n\n\t\t\tif (!bottomRow.initialized || !bottomRow.heightInitialized) {\n\t\t\t\tthis.vDomBottomNewRows.push(bottomRow);\n\n\t\t\t\tif (!bottomRow.heightInitialized) {\n\t\t\t\t\tbottomRow.clearCellHeight();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbottomRow.initialize();\n\n\t\t\tthis.vDomBottomPad -= bottomRowHeight;\n\n\t\t\tif (this.vDomBottomPad < 0 || index == this.displayRowsCount - 1) {\n\t\t\t\tthis.vDomBottomPad = 0;\n\t\t\t}\n\n\t\t\ttable.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\t\tthis.vDomScrollPosBottom += bottomRowHeight;\n\t\t\tthis.vDomBottom++;\n\t\t}\n\n\t\tbottomDiff = this.scrollTop - this.vDomScrollPosBottom;\n\n\t\tif (bottomRow.getHeight() > this.vDomWindowBuffer) {\n\t\t\tthis.vDomWindowBuffer = bottomRow.getHeight() * 2;\n\t\t}\n\n\t\tif (i < this.vDomMaxRenderChain && this.vDomBottom < this.displayRowsCount - 1 && bottomDiff >= (rows[this.vDomBottom + 1].getHeight() || this.vDomRowHeight)) {\n\t\t\tthis._addBottomRow(bottomDiff, i + 1);\n\t\t} else {\n\t\t\tthis._quickNormalizeRowHeight(this.vDomBottomNewRows);\n\t\t}\n\t}\n};\n\nRowManager.prototype._removeBottomRow = function (bottomDiff) {\n\tvar table = this.tableElement,\n\t    bottomRow = this.getDisplayRows()[this.vDomBottom],\n\t    bottomRowHeight = bottomRow.getHeight() || this.vDomRowHeight;\n\n\tif (bottomDiff >= bottomRowHeight) {\n\n\t\tvar rowEl = bottomRow.getElement();\n\n\t\tif (rowEl.parentNode) {\n\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t}\n\n\t\tthis.vDomBottomPad += bottomRowHeight;\n\n\t\tif (this.vDomBottomPad < 0) {\n\t\t\tthis.vDomBottomPad = 0;\n\t\t}\n\n\t\ttable.style.paddingBottom = this.vDomBottomPad + \"px\";\n\t\tthis.vDomScrollPosBottom -= bottomRowHeight;\n\t\tthis.vDomBottom--;\n\n\t\tbottomDiff = -(this.scrollTop - this.vDomScrollPosBottom);\n\n\t\tthis._removeBottomRow(bottomDiff);\n\t}\n};\n\nRowManager.prototype._quickNormalizeRowHeight = function (rows) {\n\trows.forEach(function (row) {\n\t\trow.calcHeight();\n\t});\n\n\trows.forEach(function (row) {\n\t\trow.setCellHeight();\n\t});\n\n\trows.length = 0;\n};\n\n//normalize height of active rows\nRowManager.prototype.normalizeHeight = function () {\n\tthis.activeRows.forEach(function (row) {\n\t\trow.normalizeHeight();\n\t});\n};\n\n//adjust the height of the table holder to fit in the Tabulator element\nRowManager.prototype.adjustTableSize = function () {\n\tvar initialHeight = this.element.clientHeight,\n\t    modExists;\n\n\tif (this.renderMode === \"virtual\") {\n\n\t\tvar otherHeight = Math.floor(this.columnManager.getElement().getBoundingClientRect().height + (this.table.footerManager && this.table.footerManager.active && !this.table.footerManager.external ? this.table.footerManager.getElement().getBoundingClientRect().height : 0));\n\n\t\tif (this.fixedHeight) {\n\t\t\tthis.element.style.minHeight = \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\tthis.element.style.height = \"calc(100% - \" + otherHeight + \"px)\";\n\t\t\tthis.element.style.maxHeight = \"calc(100% - \" + otherHeight + \"px)\";\n\t\t} else {\n\t\t\tthis.element.style.height = \"\";\n\t\t\tthis.element.style.height = this.table.element.clientHeight - otherHeight + \"px\";\n\t\t\tthis.element.scrollTop = this.scrollTop;\n\t\t}\n\n\t\tthis.height = this.element.clientHeight;\n\t\tthis.vDomWindowBuffer = this.table.options.virtualDomBuffer || this.height;\n\n\t\t//check if the table has changed size when dealing with variable height tables\n\t\tif (!this.fixedHeight && initialHeight != this.element.clientHeight) {\n\t\t\tmodExists = this.table.modExists(\"resizeTable\");\n\n\t\t\tif (modExists && !this.table.modules.resizeTable.autoResize || !modExists) {\n\t\t\t\tthis.redraw();\n\t\t\t}\n\t\t}\n\t}\n};\n\n//renitialize all rows\nRowManager.prototype.reinitialize = function () {\n\tthis.rows.forEach(function (row) {\n\t\trow.reinitialize(true);\n\t});\n};\n\n//prevent table from being redrawn\nRowManager.prototype.blockRedraw = function () {\n\tthis.redrawBlock = true;\n\tthis.redrawBlockRestoreConfig = false;\n};\n\n//restore table redrawing\nRowManager.prototype.restoreRedraw = function () {\n\tthis.redrawBlock = false;\n\n\tif (this.redrawBlockRestoreConfig) {\n\t\tthis.refreshActiveData(this.redrawBlockRestoreConfig.stage, this.redrawBlockRestoreConfig.skipStage, this.redrawBlockRestoreConfig.renderInPosition);\n\n\t\tthis.redrawBlockRestoreConfig = false;\n\t} else {\n\t\tif (this.redrawBlockRederInPosition) {\n\t\t\tthis.reRenderInPosition();\n\t\t}\n\t}\n\n\tthis.redrawBlockRederInPosition = false;\n};\n\n//redraw table\nRowManager.prototype.redraw = function (force) {\n\tvar pos = 0,\n\t    left = this.scrollLeft;\n\n\tthis.adjustTableSize();\n\n\tthis.table.tableWidth = this.table.element.clientWidth;\n\n\tif (!force) {\n\t\tif (this.renderMode == \"classic\") {\n\n\t\t\tif (this.table.options.groupBy) {\n\t\t\t\tthis.refreshActiveData(\"group\", false, false);\n\t\t\t} else {\n\t\t\t\tthis._simpleRender();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.reRenderInPosition();\n\t\t\tthis.scrollHorizontal(left);\n\t\t}\n\n\t\tif (!this.displayRowsCount) {\n\t\t\tif (this.table.options.placeholder) {\n\t\t\t\tthis.getElement().appendChild(this.table.options.placeholder);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tthis.renderTable();\n\t}\n};\n\nRowManager.prototype.resetScroll = function () {\n\tthis.element.scrollLeft = 0;\n\tthis.element.scrollTop = 0;\n\n\tif (this.table.browser === \"ie\") {\n\t\tvar event = document.createEvent(\"Event\");\n\t\tevent.initEvent(\"scroll\", false, true);\n\t\tthis.element.dispatchEvent(event);\n\t} else {\n\t\tthis.element.dispatchEvent(new Event('scroll'));\n\t}\n};\n\nvar VDomHoz = function VDomHoz(table) {\n\tthis.table = table;\n\n\tthis.element = this.table.rowManager.tableElement;\n\tthis.holderEl = this.table.rowManager.element;\n\n\tthis.leftCol = 0;\n\tthis.rightCol = 0;\n\tthis.scrollLeft = 0;\n\n\tthis.vDomScrollPosLeft = 0;\n\tthis.vDomScrollPosRight = 0;\n\n\tthis.vDomPadLeft = 0;\n\tthis.vDomPadRight = 0;\n\n\tthis.fitDataColAvg = 0;\n\n\tthis.window = 200; //pixel margin to make column visible before it is shown on screen\n\n\tthis.initialized = false;\n\n\tthis.columns = [];\n\n\tif (this.compatabilityCheck()) {\n\t\tthis.initialize();\n\t}\n};\n\nVDomHoz.prototype.compatabilityCheck = function () {\n\tvar options = this.table.options,\n\t    frozen = false,\n\t    ok = true;\n\n\tif (options.layout == \"fitDataTable\") {\n\t\tconsole.warn(\"Horizontal Vitrual DOM is not compatible with fitDataTable layout mode\");\n\t\tok = false;\n\t}\n\n\tif (options.responsiveLayout) {\n\t\tconsole.warn(\"Horizontal Vitrual DOM is not compatible with responsive columns\");\n\t\tok = false;\n\t}\n\n\tif (this.table.rtl) {\n\t\tconsole.warn(\"Horizontal Vitrual DOM is not currently compatible with RTL text direction\");\n\t\tok = false;\n\t}\n\n\t// if(options.rowFormatter){\n\t// \tconsole.warn(\"Horizontal Vitrual DOM is not compatible with row formatters\");\n\t// \tok = false;\n\t// }\n\n\tif (options.columns) {\n\t\tfrozen = options.columns.find(function (col) {\n\t\t\treturn col.frozen;\n\t\t});\n\n\t\tif (frozen) {\n\t\t\tconsole.warn(\"Horizontal Vitrual DOM is not compatible with frozen columns\");\n\t\t\tok = false;\n\t\t}\n\t}\n\n\tif (!ok) {\n\t\toptions.virtualDomHoz = false;\n\t}\n\n\treturn ok;\n};\n\nVDomHoz.prototype.initialize = function () {\n\tvar _this17 = this;\n\n\tthis.holderEl.addEventListener(\"scroll\", function () {\n\t\tvar left = _this17.holderEl.scrollLeft;\n\n\t\tif (_this17.scrollLeft != left) {\n\t\t\t_this17.scrollLeft = left;\n\t\t\t_this17.scroll(left - (_this17.vDomScrollPosLeft + _this17.window));\n\t\t}\n\t});\n};\n\nVDomHoz.prototype.deinitialize = function () {\n\tthis.initialized = false;\n};\n\nVDomHoz.prototype.clear = function () {\n\tthis.columns = [];\n\n\tthis.leftCol = -1;\n\tthis.rightCol = 0;\n\n\tthis.vDomScrollPosLeft = 0;\n\tthis.vDomScrollPosRight = 0;\n\tthis.vDomPadLeft = 0;\n\tthis.vDomPadRight = 0;\n};\n\nVDomHoz.prototype.dataChange = function () {\n\tvar change = false,\n\t    collsWidth = 0,\n\t    colEnd = 0,\n\t    group,\n\t    row,\n\t    rowEl;\n\n\tif (this.table.options.layout === \"fitData\") {\n\t\tthis.table.columnManager.columnsByIndex.forEach(function (column) {\n\t\t\tif (!column.definition.width && column.visible) {\n\t\t\t\tchange = true;\n\t\t\t}\n\t\t});\n\n\t\tif (change) {\n\t\t\tif (change && this.table.rowManager.getDisplayRows().length) {\n\t\t\t\t// this.table.vdomHoz.deinitialize();\n\n\t\t\t\tthis.vDomScrollPosRight = this.scrollLeft + this.holderEl.clientWidth + this.window;\n\n\t\t\t\tif (this.table.options.groupBy) {\n\t\t\t\t\tgroup = this.table.modules.groupRows.getGroups(false)[0];\n\n\t\t\t\t\trow = group.getRows(false)[0];\n\t\t\t\t} else {\n\t\t\t\t\trow = this.table.rowManager.getDisplayRows()[0];\n\t\t\t\t}\n\n\t\t\t\tif (row) {\n\n\t\t\t\t\trowEl = row.getElement();\n\n\t\t\t\t\trow.generateCells();\n\n\t\t\t\t\tthis.element.appendChild(rowEl);\n\n\t\t\t\t\tfor (var colEnd = 0; colEnd < row.cells.length; colEnd++) {\n\t\t\t\t\t\tvar cell = row.cells[colEnd];\n\t\t\t\t\t\trowEl.appendChild(cell.getElement());\n\n\t\t\t\t\t\tcell.column.reinitializeWidth();\n\n\t\t\t\t\t\tcollsWidth += cell.column.getWidth();\n\n\t\t\t\t\t\tif (collsWidth > this.vDomScrollPosRight) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\n\t\t\t\t\tthis.fitDataColAvg = Math.floor(collsWidth / (colEnd + 1));\n\n\t\t\t\t\tfor (colEnd; colEnd < this.table.columnManager.columnsByIndex.length; colEnd++) {\n\t\t\t\t\t\tthis.table.columnManager.columnsByIndex[colEnd].setWidth(this.fitDataColAvg);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.reinitialize(false, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (this.table.options.layout === \"fitColumns\") {\n\t\t\tthis.table.modules.layout.layout();\n\t\t\tthis.table.vdomHoz.reinitialize(false, true);\n\t\t}\n\t}\n};\n\nVDomHoz.prototype.fitDataLayoutOverride = function () {\n\tfor (var _i5 = this.leftCol; _i5 <= this.rightCol; _i5++) {\n\t\tthis.columns[_i5].reinitializeWidth();\n\t}\n};\n\nVDomHoz.prototype.reinitialize = function (update, blockRedraw) {\n\tvar _this18 = this;\n\n\tvar old = {\n\t\tcols: this.columns,\n\t\tleftCol: this.leftCol,\n\t\trightCol: this.rightCol\n\t};\n\n\tif (update && !this.initialized) {\n\t\treturn;\n\t}\n\n\tthis.clear();\n\n\tthis.scrollLeft = this.holderEl.scrollLeft;\n\n\tthis.vDomScrollPosLeft = this.scrollLeft - this.window;\n\tthis.vDomScrollPosRight = this.scrollLeft + this.holderEl.clientWidth + this.window;\n\n\tvar colPos = 0;\n\n\tthis.table.columnManager.columnsByIndex.forEach(function (column) {\n\t\tvar config = {};\n\n\t\tif (column.visible) {\n\t\t\tvar width = column.getWidth();\n\n\t\t\tconfig.leftPos = colPos;\n\t\t\tconfig.rightPos = colPos + width;\n\n\t\t\tif (colPos + width > _this18.vDomScrollPosLeft && colPos < _this18.vDomScrollPosRight) {\n\t\t\t\t//column is visible\n\n\t\t\t\tif (_this18.leftCol == -1) {\n\t\t\t\t\t_this18.leftCol = _this18.columns.length;\n\t\t\t\t\t_this18.vDomPadLeft = colPos;\n\t\t\t\t}\n\n\t\t\t\t_this18.rightCol = _this18.columns.length;\n\t\t\t} else {\n\t\t\t\t// column is hidden\n\t\t\t\tif (_this18.leftCol !== -1) {\n\t\t\t\t\t_this18.vDomPadRight += width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_this18.columns.push(column);\n\n\t\t\tcolumn.modules.vdomHoz = config;\n\n\t\t\tcolPos += width;\n\t\t}\n\t});\n\n\tthis.element.style.paddingLeft = this.vDomPadLeft + \"px\";\n\tthis.element.style.paddingRight = this.vDomPadRight + \"px\";\n\n\tthis.initialized = true;\n\n\tif (!blockRedraw) {\n\t\tif (!update || this.reinitChanged(old)) {\n\t\t\tthis.renitializeRows();\n\t\t}\n\t}\n\n\tthis.holderEl.scrollLeft = this.scrollLeft;\n};\n\nVDomHoz.prototype.reinitChanged = function (old) {\n\tvar _this19 = this;\n\n\tvar match = true;\n\n\tif (old.cols.length !== this.columns.length || old.leftCol !== this.leftCol || old.rightCol !== this.rightCol) {\n\t\treturn true;\n\t}\n\n\told.cols.forEach(function (col, i) {\n\t\tif (col !== _this19.columns[i]) {\n\t\t\tmatch = false;\n\t\t}\n\t});\n\n\treturn !match;\n};\n\nVDomHoz.prototype.renitializeRows = function () {\n\tvar _this20 = this;\n\n\tvar rows = this.table.rowManager.getVisibleRows();\n\trows.forEach(function (row) {\n\t\t_this20.reinitializeRow(row, true);\n\t});\n};\n\nVDomHoz.prototype.scroll = function (diff) {\n\tthis.vDomScrollPosLeft += diff;\n\tthis.vDomScrollPosRight += diff;\n\n\tif (diff > this.holderEl.clientWidth * .8) {\n\t\tthis.reinitialize();\n\t} else {\n\t\tif (diff > 0) {\n\t\t\t//scroll right\n\t\t\tthis.addColRight();\n\t\t\tthis.removeColLeft();\n\t\t} else {\n\t\t\t//scroll left\n\t\t\tthis.addColLeft();\n\t\t\tthis.removeColRight();\n\t\t}\n\t}\n};\n\nVDomHoz.prototype.colPositionAdjust = function (start, end, diff) {\n\tfor (var _i6 = start; _i6 < end; _i6++) {\n\t\tvar column = this.columns[_i6];\n\n\t\tcolumn.modules.vdomHoz.leftPos -= diff;\n\t\tcolumn.modules.vdomHoz.rightPos -= diff;\n\t}\n};\n\nVDomHoz.prototype.addColRight = function () {\n\tvar column = this.columns[this.rightCol + 1],\n\t    rows,\n\t    oldWidth,\n\t    widthDiff;\n\n\tif (column && column.modules.vdomHoz.leftPos <= this.vDomScrollPosRight) {\n\n\t\trows = this.table.rowManager.getVisibleRows();\n\n\t\trows.forEach(function (row) {\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\trow.getElement().appendChild(cell.getElement());\n\t\t\t\tcell.cellRendered();\n\t\t\t}\n\t\t});\n\n\t\tif (this.fitDataColAvg) {\n\n\t\t\toldWidth = column.getWidth();\n\n\t\t\tif (oldWidth === this.fitDataColAvg) {\n\t\t\t\tcolumn.reinitializeWidth();\n\n\t\t\t\twidthDiff = oldWidth - column.getWidth();\n\n\t\t\t\tif (widthDiff) {\n\t\t\t\t\tcolumn.modules.vdomHoz.rightPos -= widthDiff;\n\t\t\t\t\tthis.colPositionAdjust(this.rightCol + 1, this.columns.length, widthDiff);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.rightCol++;\n\n\t\tif (this.rightCol >= this.columns.length - 1) {\n\t\t\tthis.vDomPadRight = 0;\n\t\t} else {\n\t\t\tthis.vDomPadRight -= column.getWidth();\n\t\t}\n\n\t\tthis.element.style.paddingRight = this.vDomPadRight + \"px\";\n\n\t\tthis.addColRight();\n\t}\n};\n\nVDomHoz.prototype.addColLeft = function () {\n\tvar column = this.columns[this.leftCol - 1],\n\t    rows;\n\n\tif (column && column.modules.vdomHoz.rightPos >= this.vDomScrollPosLeft) {\n\t\tvar rows = this.table.rowManager.getVisibleRows();\n\n\t\trows.forEach(function (row) {\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\trow.getElement().prepend(cell.getElement());\n\t\t\t\tcell.cellRendered();\n\t\t\t}\n\t\t});\n\n\t\tif (!this.leftCol) {\n\t\t\tthis.vDomPadLeft = 0;\n\t\t} else {\n\t\t\tthis.vDomPadLeft -= column.getWidth();\n\t\t}\n\n\t\tthis.element.style.paddingLeft = this.vDomPadLeft + \"px\";\n\n\t\tthis.leftCol--;\n\n\t\tthis.addColLeft();\n\t}\n};\n\nVDomHoz.prototype.removeColRight = function (column) {\n\tvar column = this.columns[this.rightCol],\n\t    rows;\n\n\tif (column && column.modules.vdomHoz.leftPos > this.vDomScrollPosRight) {\n\t\trows = this.table.rowManager.getVisibleRows();\n\n\t\tcolumn.modules.vdomHoz.visible = false;\n\n\t\trows.forEach(function (row) {\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t}\n\t\t});\n\n\t\tthis.vDomPadRight += column.getWidth();\n\t\tthis.element.style.paddingRight = this.vDomPadRight + \"px\";\n\n\t\tthis.rightCol--;\n\n\t\tthis.removeColRight();\n\t}\n};\n\nVDomHoz.prototype.removeColLeft = function () {\n\tvar column = this.columns[this.leftCol],\n\t    rows;\n\n\tif (column && column.modules.vdomHoz.rightPos < this.vDomScrollPosLeft) {\n\n\t\trows = this.table.rowManager.getVisibleRows();\n\n\t\trows.forEach(function (row) {\n\t\t\tif (row.type !== \"group\") {\n\t\t\t\tvar cell = row.getCell(column);\n\t\t\t\trow.getElement().removeChild(cell.getElement());\n\t\t\t}\n\t\t});\n\n\t\tthis.vDomPadLeft += column.getWidth();\n\t\tthis.element.style.paddingLeft = this.vDomPadLeft + \"px\";\n\n\t\tthis.leftCol++;\n\n\t\tthis.removeColLeft();\n\t}\n};\n\nVDomHoz.prototype.initializeRow = function (row) {\n\tif (row.type !== \"group\") {\n\t\trow.modules.vdomHoz = {\n\t\t\tleftCol: this.leftCol,\n\t\t\trightCol: this.rightCol\n\t\t};\n\n\t\tfor (var _i7 = this.leftCol; _i7 <= this.rightCol; _i7++) {\n\t\t\tvar column = this.columns[_i7];\n\n\t\t\tif (column && column.visible) {\n\t\t\t\tvar cell = row.getCell(column);\n\n\t\t\t\trow.getElement().appendChild(cell.getElement());\n\t\t\t\tcell.cellRendered();\n\t\t\t}\n\t\t}\n\t}\n};\n\nVDomHoz.prototype.reinitializeRow = function (row, force) {\n\tif (row.type !== \"group\") {\n\t\tif (force || !row.modules.vdomHoz || row.modules.vdomHoz.leftCol !== this.leftCol || row.modules.vdomHoz.rightCol !== this.rightCol) {\n\t\t\tvar rowEl = row.getElement();\n\t\t\twhile (rowEl.firstChild) {\n\t\t\t\trowEl.removeChild(rowEl.firstChild);\n\t\t\t}this.initializeRow(row);\n\t\t}\n\t}\n};\n//public row object\nvar RowComponent = function RowComponent(row) {\n\tthis._row = row;\n};\n\nRowComponent.prototype.getData = function (transform) {\n\treturn this._row.getData(transform);\n};\n\nRowComponent.prototype.getElement = function () {\n\treturn this._row.getElement();\n};\n\nRowComponent.prototype.getCells = function () {\n\tvar cells = [];\n\n\tthis._row.getCells().forEach(function (cell) {\n\t\tcells.push(cell.getComponent());\n\t});\n\n\treturn cells;\n};\n\nRowComponent.prototype.getCell = function (column) {\n\tvar cell = this._row.getCell(column);\n\treturn cell ? cell.getComponent() : false;\n};\n\nRowComponent.prototype.getIndex = function () {\n\treturn this._row.getData(\"data\")[this._row.table.options.index];\n};\n\nRowComponent.prototype.getPosition = function (active) {\n\treturn this._row.table.rowManager.getRowPosition(this._row, active);\n};\n\nRowComponent.prototype.delete = function () {\n\treturn this._row.delete();\n};\n\nRowComponent.prototype.scrollTo = function () {\n\treturn this._row.table.rowManager.scrollToRow(this._row);\n};\n\nRowComponent.prototype.pageTo = function () {\n\tif (this._row.table.modExists(\"page\", true)) {\n\t\treturn this._row.table.modules.page.setPageToRow(this._row);\n\t}\n};\n\nRowComponent.prototype.move = function (to, after) {\n\tthis._row.moveToRow(to, after);\n};\n\nRowComponent.prototype.update = function (data) {\n\treturn this._row.updateData(data);\n};\n\nRowComponent.prototype.normalizeHeight = function () {\n\tthis._row.normalizeHeight(true);\n};\n\nRowComponent.prototype.select = function () {\n\tthis._row.table.modules.selectRow.selectRows(this._row);\n};\n\nRowComponent.prototype.deselect = function () {\n\tthis._row.table.modules.selectRow.deselectRows(this._row);\n};\n\nRowComponent.prototype.toggleSelect = function () {\n\tthis._row.table.modules.selectRow.toggleRow(this._row);\n};\n\nRowComponent.prototype.isSelected = function () {\n\treturn this._row.table.modules.selectRow.isRowSelected(this._row);\n};\n\nRowComponent.prototype._getSelf = function () {\n\treturn this._row;\n};\n\nRowComponent.prototype.validate = function () {\n\treturn this._row.validate();\n};\n\nRowComponent.prototype.freeze = function () {\n\tif (this._row.table.modExists(\"frozenRows\", true)) {\n\t\tthis._row.table.modules.frozenRows.freezeRow(this._row);\n\t}\n};\n\nRowComponent.prototype.unfreeze = function () {\n\tif (this._row.table.modExists(\"frozenRows\", true)) {\n\t\tthis._row.table.modules.frozenRows.unfreezeRow(this._row);\n\t}\n};\n\nRowComponent.prototype.isFrozen = function () {\n\tif (this._row.table.modExists(\"frozenRows\", true)) {\n\t\tvar index = this._row.table.modules.frozenRows.rows.indexOf(this._row);\n\t\treturn index > -1;\n\t}\n\n\treturn false;\n};\n\nRowComponent.prototype.treeCollapse = function () {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\tthis._row.table.modules.dataTree.collapseRow(this._row);\n\t}\n};\n\nRowComponent.prototype.treeExpand = function () {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\tthis._row.table.modules.dataTree.expandRow(this._row);\n\t}\n};\n\nRowComponent.prototype.treeToggle = function () {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\tthis._row.table.modules.dataTree.toggleRow(this._row);\n\t}\n};\n\nRowComponent.prototype.getTreeParent = function () {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\treturn this._row.table.modules.dataTree.getTreeParent(this._row);\n\t}\n\n\treturn false;\n};\n\nRowComponent.prototype.getTreeChildren = function () {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\treturn this._row.table.modules.dataTree.getTreeChildren(this._row, true);\n\t}\n\n\treturn false;\n};\n\nRowComponent.prototype.addTreeChild = function (data, pos, index) {\n\tif (this._row.table.modExists(\"dataTree\", true)) {\n\t\treturn this._row.table.modules.dataTree.addTreeChildRow(this._row, data, pos, index);\n\t}\n\n\treturn false;\n};\n\nRowComponent.prototype.reformat = function () {\n\treturn this._row.reinitialize();\n};\n\nRowComponent.prototype.getGroup = function () {\n\treturn this._row.getGroup().getComponent();\n};\n\nRowComponent.prototype.getTable = function () {\n\treturn this._row.table;\n};\n\nRowComponent.prototype.getNextRow = function () {\n\tvar row = this._row.nextRow();\n\treturn row ? row.getComponent() : row;\n};\n\nRowComponent.prototype.getPrevRow = function () {\n\tvar row = this._row.prevRow();\n\treturn row ? row.getComponent() : row;\n};\n\nvar Row = function Row(data, parent) {\n\tvar type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"row\";\n\n\tthis.table = parent.table;\n\tthis.parent = parent;\n\tthis.data = {};\n\tthis.type = type; //type of element\n\tthis.element = false;\n\tthis.modules = {}; //hold module variables;\n\tthis.cells = [];\n\tthis.height = 0; //hold element height\n\tthis.heightStyled = \"\"; //hold element height prestyled to improve render efficiency\n\tthis.manualHeight = false; //user has manually set row height\n\tthis.outerHeight = 0; //holde lements outer height\n\tthis.initialized = false; //element has been rendered\n\tthis.heightInitialized = false; //element has resized cells to fit\n\n\tthis.component = null;\n\n\tthis.created = false;\n\n\tthis.setData(data);\n};\n\nRow.prototype.create = function () {\n\tif (!this.created) {\n\t\tthis.created = true;\n\t\tthis.generateElement();\n\t}\n};\n\nRow.prototype.createElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-row\");\n\tel.setAttribute(\"role\", \"row\");\n\n\tthis.element = el;\n};\n\nRow.prototype.getElement = function () {\n\tthis.create();\n\treturn this.element;\n};\n\nRow.prototype.detachElement = function () {\n\tif (this.element && this.element.parentNode) {\n\t\tthis.element.parentNode.removeChild(this.element);\n\t}\n};\n\nRow.prototype.generateElement = function () {\n\tvar self = this,\n\t    dblTap,\n\t    tapHold,\n\t    tap;\n\n\tthis.createElement();\n\n\t//set row selection characteristics\n\tif (self.table.options.selectable !== false && self.table.modExists(\"selectRow\")) {\n\t\tself.table.modules.selectRow.initializeRow(this);\n\t}\n\n\t//setup movable rows\n\tif (self.table.options.movableRows !== false && self.table.modExists(\"moveRow\")) {\n\t\tself.table.modules.moveRow.initializeRow(this);\n\t}\n\n\t//setup data tree\n\tif (self.table.options.dataTree !== false && self.table.modExists(\"dataTree\")) {\n\t\tself.table.modules.dataTree.initializeRow(this);\n\t}\n\n\t//setup column colapse container\n\tif (self.table.options.responsiveLayout === \"collapse\" && self.table.modExists(\"responsiveLayout\")) {\n\t\tself.table.modules.responsiveLayout.initializeRow(this);\n\t}\n\n\t//set column menu\n\tif ((self.table.options.rowContextMenu || self.table.options.rowClickMenu) && this.table.modExists(\"menu\")) {\n\t\tself.table.modules.menu.initializeRow(this);\n\t}\n\n\t//handle row click events\n\tif (self.table.options.rowClick) {\n\t\tself.element.addEventListener(\"click\", function (e) {\n\t\t\tself.table.options.rowClick(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowDblClick) {\n\t\tself.element.addEventListener(\"dblclick\", function (e) {\n\t\t\tself.table.options.rowDblClick(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowContext) {\n\t\tself.element.addEventListener(\"contextmenu\", function (e) {\n\t\t\tself.table.options.rowContext(e, self.getComponent());\n\t\t});\n\t}\n\n\t//handle mouse events\n\tif (self.table.options.rowMouseEnter) {\n\t\tself.element.addEventListener(\"mouseenter\", function (e) {\n\t\t\tself.table.options.rowMouseEnter(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowMouseLeave) {\n\t\tself.element.addEventListener(\"mouseleave\", function (e) {\n\t\t\tself.table.options.rowMouseLeave(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowMouseOver) {\n\t\tself.element.addEventListener(\"mouseover\", function (e) {\n\t\t\tself.table.options.rowMouseOver(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowMouseOut) {\n\t\tself.element.addEventListener(\"mouseout\", function (e) {\n\t\t\tself.table.options.rowMouseOut(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowMouseMove) {\n\t\tself.element.addEventListener(\"mousemove\", function (e) {\n\t\t\tself.table.options.rowMouseMove(e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.table.options.rowTap) {\n\n\t\ttap = false;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\ttap = true;\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tif (tap) {\n\t\t\t\tself.table.options.rowTap(e, self.getComponent());\n\t\t\t}\n\n\t\t\ttap = false;\n\t\t});\n\t}\n\n\tif (self.table.options.rowDblTap) {\n\n\t\tdblTap = null;\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\n\t\t\tif (dblTap) {\n\t\t\t\tclearTimeout(dblTap);\n\t\t\t\tdblTap = null;\n\n\t\t\t\tself.table.options.rowDblTap(e, self.getComponent());\n\t\t\t} else {\n\n\t\t\t\tdblTap = setTimeout(function () {\n\t\t\t\t\tclearTimeout(dblTap);\n\t\t\t\t\tdblTap = null;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (self.table.options.rowTapHold) {\n\n\t\ttapHold = null;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\n\t\t\ttapHold = setTimeout(function () {\n\t\t\t\tclearTimeout(tapHold);\n\t\t\t\ttapHold = null;\n\t\t\t\ttap = false;\n\t\t\t\tself.table.options.rowTapHold(e, self.getComponent());\n\t\t\t}, 1000);\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\t\t\ttapHold = null;\n\t\t});\n\t}\n};\n\nRow.prototype.generateCells = function () {\n\tthis.cells = this.table.columnManager.generateCells(this);\n};\n\n//functions to setup on first render\nRow.prototype.initialize = function (force) {\n\tvar _this21 = this;\n\n\tthis.create();\n\n\tif (!this.initialized || force) {\n\n\t\tthis.deleteCells();\n\n\t\twhile (this.element.firstChild) {\n\t\t\tthis.element.removeChild(this.element.firstChild);\n\t\t} //handle frozen cells\n\t\tif (this.table.modExists(\"frozenColumns\")) {\n\t\t\tthis.table.modules.frozenColumns.layoutRow(this);\n\t\t}\n\n\t\tthis.generateCells();\n\n\t\tif (this.table.options.virtualDomHoz && this.table.vdomHoz.initialized) {\n\t\t\tthis.table.vdomHoz.initializeRow(this);\n\t\t} else {\n\t\t\tthis.cells.forEach(function (cell) {\n\t\t\t\t_this21.element.appendChild(cell.getElement());\n\t\t\t\tcell.cellRendered();\n\t\t\t});\n\t\t}\n\n\t\tif (force) {\n\t\t\tthis.normalizeHeight();\n\t\t}\n\n\t\t//setup movable rows\n\t\tif (this.table.options.dataTree && this.table.modExists(\"dataTree\")) {\n\t\t\tthis.table.modules.dataTree.layoutRow(this);\n\t\t}\n\n\t\t//setup column colapse container\n\t\tif (this.table.options.responsiveLayout === \"collapse\" && this.table.modExists(\"responsiveLayout\")) {\n\t\t\tthis.table.modules.responsiveLayout.layoutRow(this);\n\t\t}\n\n\t\tif (this.table.options.rowFormatter) {\n\t\t\tthis.table.options.rowFormatter(this.getComponent());\n\t\t}\n\n\t\t//set resizable handles\n\t\tif (this.table.options.resizableRows && this.table.modExists(\"resizeRows\")) {\n\t\t\tthis.table.modules.resizeRows.initializeRow(this);\n\t\t}\n\n\t\tthis.initialized = true;\n\t} else {\n\t\tif (this.table.options.virtualDomHoz) {\n\t\t\tthis.table.vdomHoz.reinitializeRow(this);\n\t\t}\n\t}\n};\n\nRow.prototype.reinitializeHeight = function () {\n\tthis.heightInitialized = false;\n\n\tif (this.element && this.element.offsetParent !== null) {\n\t\tthis.normalizeHeight(true);\n\t}\n};\n\nRow.prototype.reinitialize = function (children) {\n\tthis.initialized = false;\n\tthis.heightInitialized = false;\n\n\tif (!this.manualHeight) {\n\t\tthis.height = 0;\n\t\tthis.heightStyled = \"\";\n\t}\n\n\tif (this.element && this.element.offsetParent !== null) {\n\t\tthis.initialize(true);\n\t}\n\n\tif (this.table.options.dataTree && this.table.modExists(\"dataTree\", true)) {\n\t\tthis.table.modules.dataTree.getTreeChildren(this, false, true).forEach(function (child) {\n\t\t\tchild.reinitialize(true);\n\t\t});\n\t}\n};\n\n//get heights when doing bulk row style calcs in virtual DOM\nRow.prototype.calcHeight = function (force) {\n\n\tvar maxHeight = 0,\n\t    minHeight = this.table.options.resizableRows ? this.element.clientHeight : 0;\n\n\tthis.cells.forEach(function (cell) {\n\t\tvar height = cell.getHeight();\n\t\tif (height > maxHeight) {\n\t\t\tmaxHeight = height;\n\t\t}\n\t});\n\n\tif (force) {\n\t\tthis.height = Math.max(maxHeight, minHeight);\n\t} else {\n\t\tthis.height = this.manualHeight ? this.height : Math.max(maxHeight, minHeight);\n\t}\n\n\tthis.heightStyled = this.height ? this.height + \"px\" : \"\";\n\tthis.outerHeight = this.element.offsetHeight;\n};\n\n//set of cells\nRow.prototype.setCellHeight = function () {\n\tthis.cells.forEach(function (cell) {\n\t\tcell.setHeight();\n\t});\n\n\tthis.heightInitialized = true;\n};\n\nRow.prototype.clearCellHeight = function () {\n\tthis.cells.forEach(function (cell) {\n\t\tcell.clearHeight();\n\t});\n};\n\n//normalize the height of elements in the row\nRow.prototype.normalizeHeight = function (force) {\n\n\tif (force) {\n\t\tthis.clearCellHeight();\n\t}\n\n\tthis.calcHeight(force);\n\n\tthis.setCellHeight();\n};\n\n// Row.prototype.setHeight = function(height){\n// \tthis.height = height;\n\n// \tthis.setCellHeight();\n// };\n\n//set height of rows\nRow.prototype.setHeight = function (height, force) {\n\tif (this.height != height || force) {\n\n\t\tthis.manualHeight = true;\n\n\t\tthis.height = height;\n\t\tthis.heightStyled = height ? height + \"px\" : \"\";\n\n\t\tthis.setCellHeight();\n\n\t\t// this.outerHeight = this.element.outerHeight();\n\t\tthis.outerHeight = this.element.offsetHeight;\n\t}\n};\n\n//return rows outer height\nRow.prototype.getHeight = function () {\n\treturn this.outerHeight;\n};\n\n//return rows outer Width\nRow.prototype.getWidth = function () {\n\treturn this.element.offsetWidth;\n};\n\n//////////////// Cell Management /////////////////\n\nRow.prototype.deleteCell = function (cell) {\n\tvar index = this.cells.indexOf(cell);\n\n\tif (index > -1) {\n\t\tthis.cells.splice(index, 1);\n\t}\n};\n\n//////////////// Data Management /////////////////\n\nRow.prototype.setData = function (data) {\n\tif (this.table.modExists(\"mutator\")) {\n\t\tdata = this.table.modules.mutator.transformRow(data, \"data\");\n\t}\n\n\tthis.data = data;\n\n\tif (this.table.options.reactiveData && this.table.modExists(\"reactiveData\", true)) {\n\t\tthis.table.modules.reactiveData.watchRow(this);\n\t}\n};\n\n//update the rows data\nRow.prototype.updateData = function (updatedData) {\n\tvar _this22 = this;\n\n\tvar visible = this.element && Tabulator.prototype.helpers.elVisible(this.element),\n\t    tempData = {},\n\t    newRowData;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tif (typeof updatedData === \"string\") {\n\t\t\tupdatedData = JSON.parse(updatedData);\n\t\t}\n\n\t\tif (_this22.table.options.reactiveData && _this22.table.modExists(\"reactiveData\", true)) {\n\t\t\t_this22.table.modules.reactiveData.block();\n\t\t}\n\n\t\t//mutate incomming data if needed\n\t\tif (_this22.table.modExists(\"mutator\")) {\n\n\t\t\ttempData = Object.assign(tempData, _this22.data);\n\t\t\ttempData = Object.assign(tempData, updatedData);\n\n\t\t\tnewRowData = _this22.table.modules.mutator.transformRow(tempData, \"data\", updatedData);\n\t\t} else {\n\t\t\tnewRowData = updatedData;\n\t\t}\n\n\t\t//set data\n\t\tfor (var attrname in newRowData) {\n\t\t\t_this22.data[attrname] = newRowData[attrname];\n\t\t}\n\n\t\tif (_this22.table.options.reactiveData && _this22.table.modExists(\"reactiveData\", true)) {\n\t\t\t_this22.table.modules.reactiveData.unblock();\n\t\t}\n\n\t\t//update affected cells only\n\t\tfor (var attrname in updatedData) {\n\n\t\t\tvar columns = _this22.table.columnManager.getColumnsByFieldRoot(attrname);\n\n\t\t\tcolumns.forEach(function (column) {\n\t\t\t\tvar cell = _this22.getCell(column.getField());\n\n\t\t\t\tif (cell) {\n\t\t\t\t\tvar value = column.getFieldValue(newRowData);\n\t\t\t\t\tif (cell.getValue() != value) {\n\t\t\t\t\t\tcell.setValueProcessData(value);\n\n\t\t\t\t\t\tif (visible) {\n\t\t\t\t\t\t\tcell.cellRendered();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (_this22.table.options.groupUpdateOnCellEdit && _this22.table.options.groupBy && _this22.table.modExists(\"groupRows\")) {\n\t\t\t_this22.table.modules.groupRows.reassignRowToGroup(_this22.row);\n\t\t}\n\n\t\t//Partial reinitialization if visible\n\t\tif (visible) {\n\t\t\t_this22.normalizeHeight(true);\n\n\t\t\tif (_this22.table.options.rowFormatter) {\n\t\t\t\t_this22.table.options.rowFormatter(_this22.getComponent());\n\t\t\t}\n\t\t} else {\n\t\t\t_this22.initialized = false;\n\t\t\t_this22.height = 0;\n\t\t\t_this22.heightStyled = \"\";\n\t\t}\n\n\t\tif (_this22.table.options.dataTree !== false && _this22.table.modExists(\"dataTree\") && _this22.table.modules.dataTree.redrawNeeded(updatedData)) {\n\t\t\t_this22.table.modules.dataTree.initializeRow(_this22);\n\n\t\t\tif (visible) {\n\t\t\t\t_this22.table.modules.dataTree.layoutRow(_this22);\n\t\t\t\t_this22.table.rowManager.refreshActiveData(\"tree\", false, true);\n\t\t\t}\n\t\t}\n\n\t\t//this.reinitialize();\n\n\t\t_this22.table.options.rowUpdated.call(_this22.table, _this22.getComponent());\n\n\t\tif (_this22.table.options.dataChanged) {\n\t\t\t_this22.table.options.dataChanged.call(_this22.table, _this22.table.rowManager.getData());\n\t\t}\n\n\t\tresolve();\n\t});\n};\n\nRow.prototype.getData = function (transform) {\n\tif (transform) {\n\t\tif (this.table.modExists(\"accessor\")) {\n\t\t\treturn this.table.modules.accessor.transformRow(this, transform);\n\t\t}\n\t}\n\n\treturn this.data;\n};\n\nRow.prototype.getCell = function (column) {\n\tvar match = false;\n\n\tcolumn = this.table.columnManager.findColumn(column);\n\n\tmatch = this.cells.find(function (cell) {\n\t\treturn cell.column === column;\n\t});\n\n\treturn match;\n};\n\nRow.prototype.getCellIndex = function (findCell) {\n\treturn this.cells.findIndex(function (cell) {\n\t\treturn cell === findCell;\n\t});\n};\n\nRow.prototype.findNextEditableCell = function (index) {\n\tvar nextCell = false;\n\n\tif (index < this.cells.length - 1) {\n\t\tfor (var i = index + 1; i < this.cells.length; i++) {\n\t\t\tvar cell = this.cells[i];\n\n\t\t\tif (cell.column.modules.edit && Tabulator.prototype.helpers.elVisible(cell.getElement())) {\n\t\t\t\tvar allowEdit = true;\n\n\t\t\t\tif (typeof cell.column.modules.edit.check == \"function\") {\n\t\t\t\t\tallowEdit = cell.column.modules.edit.check(cell.getComponent());\n\t\t\t\t}\n\n\t\t\t\tif (allowEdit) {\n\t\t\t\t\tnextCell = cell;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nextCell;\n};\n\nRow.prototype.findPrevEditableCell = function (index) {\n\tvar prevCell = false;\n\n\tif (index > 0) {\n\t\tfor (var i = index - 1; i >= 0; i--) {\n\t\t\tvar cell = this.cells[i],\n\t\t\t    allowEdit = true;\n\n\t\t\tif (cell.column.modules.edit && Tabulator.prototype.helpers.elVisible(cell.getElement())) {\n\t\t\t\tif (typeof cell.column.modules.edit.check == \"function\") {\n\t\t\t\t\tallowEdit = cell.column.modules.edit.check(cell.getComponent());\n\t\t\t\t}\n\n\t\t\t\tif (allowEdit) {\n\t\t\t\t\tprevCell = cell;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn prevCell;\n};\n\nRow.prototype.getCells = function () {\n\treturn this.cells;\n};\n\nRow.prototype.nextRow = function () {\n\tvar row = this.table.rowManager.nextDisplayRow(this, true);\n\treturn row || false;\n};\n\nRow.prototype.prevRow = function () {\n\tvar row = this.table.rowManager.prevDisplayRow(this, true);\n\treturn row || false;\n};\n\nRow.prototype.moveToRow = function (to, before) {\n\tvar toRow = this.table.rowManager.findRow(to);\n\n\tif (toRow) {\n\t\tthis.table.rowManager.moveRowActual(this, toRow, !before);\n\t\tthis.table.rowManager.refreshActiveData(\"display\", false, true);\n\t} else {\n\t\tconsole.warn(\"Move Error - No matching row found:\", to);\n\t}\n};\n\nRow.prototype.validate = function () {\n\tvar invalid = [];\n\n\tthis.cells.forEach(function (cell) {\n\t\tif (!cell.validate()) {\n\t\t\tinvalid.push(cell.getComponent());\n\t\t}\n\t});\n\n\treturn invalid.length ? invalid : true;\n};\n\n///////////////////// Actions  /////////////////////\n\nRow.prototype.delete = function () {\n\tvar _this23 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar index, rows;\n\n\t\tif (_this23.table.options.history && _this23.table.modExists(\"history\")) {\n\n\t\t\tif (_this23.table.options.groupBy && _this23.table.modExists(\"groupRows\")) {\n\t\t\t\trows = _this23.getGroup().rows;\n\t\t\t\tindex = rows.indexOf(_this23);\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = rows[index - 1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tindex = _this23.table.rowManager.getRowIndex(_this23);\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = _this23.table.rowManager.rows[index - 1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_this23.table.modules.history.action(\"rowDelete\", _this23, { data: _this23.getData(), pos: !index, index: index });\n\t\t}\n\n\t\t_this23.deleteActual();\n\n\t\tresolve();\n\t});\n};\n\nRow.prototype.deleteActual = function (blockRedraw) {\n\tvar index = this.table.rowManager.getRowIndex(this);\n\n\tthis.detatchModules();\n\n\t// if(this.table.options.dataTree && this.table.modExists(\"dataTree\")){\n\t// \tthis.table.modules.dataTree.collapseRow(this, true);\n\t// }\n\n\t//remove any reactive data watchers from row object\n\tif (this.table.options.reactiveData && this.table.modExists(\"reactiveData\", true)) {}\n\t// this.table.modules.reactiveData.unwatchRow(this);\n\n\n\t//remove from group\n\tif (this.modules.group) {\n\t\tthis.modules.group.removeRow(this);\n\t}\n\n\tthis.table.rowManager.deleteRow(this, blockRedraw);\n\n\tthis.deleteCells();\n\n\tthis.initialized = false;\n\tthis.heightInitialized = false;\n\tthis.element = false;\n\n\tif (this.table.options.dataTree && this.table.modExists(\"dataTree\", true)) {\n\t\tthis.table.modules.dataTree.rowDelete(this);\n\t}\n\n\t//recalc column calculations if present\n\tif (this.table.modExists(\"columnCalcs\")) {\n\t\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\t\tthis.table.modules.columnCalcs.recalcRowGroup(this);\n\t\t} else {\n\t\t\tthis.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows);\n\t\t}\n\t}\n};\n\nRow.prototype.detatchModules = function () {\n\t//deselect row if it is selected\n\tif (this.table.modExists(\"selectRow\")) {\n\t\tthis.table.modules.selectRow._deselectRow(this, true);\n\t}\n\n\t//cancel edit if row is currently being edited\n\tif (this.table.modExists(\"edit\")) {\n\t\tif (this.table.modules.edit.currentCell.row === this) {\n\t\t\tthis.table.modules.edit.cancelEdit();\n\t\t}\n\t}\n\n\tif (this.table.modExists(\"frozenRows\")) {\n\t\tthis.table.modules.frozenRows.detachRow(this);\n\t}\n};\n\nRow.prototype.deleteCells = function () {\n\tvar cellCount = this.cells.length;\n\n\tfor (var _i8 = 0; _i8 < cellCount; _i8++) {\n\t\tthis.cells[0].delete();\n\t}\n};\n\nRow.prototype.wipe = function () {\n\tthis.detatchModules();\n\tthis.deleteCells();\n\n\tif (this.element) {\n\t\twhile (this.element.firstChild) {\n\t\t\tthis.element.removeChild(this.element.firstChild);\n\t\t}if (this.element.parentNode) {\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t}\n\n\tthis.element = false;\n\tthis.modules = {};\n};\n\nRow.prototype.getGroup = function () {\n\treturn this.modules.group || false;\n};\n\n//////////////// Object Generation /////////////////\nRow.prototype.getComponent = function () {\n\tif (!this.component) {\n\t\tthis.component = new RowComponent(this);\n\t}\n\n\treturn this.component;\n};\n\n//public row object\nvar CellComponent = function CellComponent(cell) {\n\tthis._cell = cell;\n};\n\nCellComponent.prototype.getValue = function () {\n\treturn this._cell.getValue();\n};\n\nCellComponent.prototype.getOldValue = function () {\n\treturn this._cell.getOldValue();\n};\n\nCellComponent.prototype.getInitialValue = function () {\n\treturn this._cell.initialValue;\n};\n\nCellComponent.prototype.getElement = function () {\n\treturn this._cell.getElement();\n};\n\nCellComponent.prototype.getRow = function () {\n\treturn this._cell.row.getComponent();\n};\n\nCellComponent.prototype.getData = function () {\n\treturn this._cell.row.getData();\n};\n\nCellComponent.prototype.getField = function () {\n\treturn this._cell.column.getField();\n};\n\nCellComponent.prototype.getColumn = function () {\n\treturn this._cell.column.getComponent();\n};\n\nCellComponent.prototype.setValue = function (value, mutate) {\n\tif (typeof mutate == \"undefined\") {\n\t\tmutate = true;\n\t}\n\n\tthis._cell.setValue(value, mutate);\n};\n\nCellComponent.prototype.restoreOldValue = function () {\n\tthis._cell.setValueActual(this._cell.getOldValue());\n};\n\nCellComponent.prototype.restoreInitialValue = function () {\n\tthis._cell.setValueActual(this._cell.initialValue);\n};\n\nCellComponent.prototype.edit = function (force) {\n\treturn this._cell.edit(force);\n};\n\nCellComponent.prototype.cancelEdit = function () {\n\tthis._cell.cancelEdit();\n};\n\nCellComponent.prototype.isEdited = function () {\n\treturn !!this._cell.modules.edit && this._cell.modules.edit.edited;\n};\n\nCellComponent.prototype.clearEdited = function () {\n\tif (self.table.modExists(\"edit\", true)) {\n\t\tthis._cell.table.modules.edit.clearEdited(this._cell);\n\t}\n};\n\nCellComponent.prototype.isValid = function () {\n\treturn this._cell.modules.validate ? !this._cell.modules.validate.invalid : true;\n};\n\nCellComponent.prototype.validate = function () {\n\treturn this._cell.validate();\n};\n\nCellComponent.prototype.clearValidation = function () {\n\tif (this._cell.table.modExists(\"validate\", true)) {\n\t\tthis._cell.table.modules.validate.clearValidation(this._cell);\n\t}\n};\n\nCellComponent.prototype.nav = function () {\n\treturn this._cell.nav();\n};\n\nCellComponent.prototype.checkHeight = function () {\n\tthis._cell.checkHeight();\n};\n\nCellComponent.prototype.getTable = function () {\n\treturn this._cell.table;\n};\n\nCellComponent.prototype._getSelf = function () {\n\treturn this._cell;\n};\n\nvar Cell = function Cell(column, row) {\n\n\tthis.table = column.table;\n\tthis.column = column;\n\tthis.row = row;\n\tthis.element = null;\n\tthis.value = null;\n\tthis.initialValue;\n\tthis.oldValue = null;\n\tthis.modules = {};\n\n\tthis.height = null;\n\tthis.width = null;\n\tthis.minWidth = null;\n\n\tthis.component = null;\n\n\tthis.loaded = false; //track if the cell has been added to the DOM yet\n\n\tthis.build();\n};\n\n//////////////// Setup Functions /////////////////\n\n//generate element\nCell.prototype.build = function () {\n\tthis.generateElement();\n\n\tthis.setWidth();\n\n\tthis._configureCell();\n\n\tthis.setValueActual(this.column.getFieldValue(this.row.data));\n\n\tthis.initialValue = this.value;\n};\n\nCell.prototype.generateElement = function () {\n\tthis.element = document.createElement('div');\n\tthis.element.className = \"tabulator-cell\";\n\tthis.element.setAttribute(\"role\", \"gridcell\");\n\tthis.element = this.element;\n};\n\nCell.prototype._configureCell = function () {\n\tvar self = this,\n\t    cellEvents = self.column.cellEvents,\n\t    element = self.element,\n\t    field = this.column.getField(),\n\t    vertAligns = {\n\t\ttop: \"flex-start\",\n\t\tbottom: \"flex-end\",\n\t\tmiddle: \"center\"\n\t},\n\t    hozAligns = {\n\t\tleft: \"flex-start\",\n\t\tright: \"flex-end\",\n\t\tcenter: \"center\"\n\t};\n\n\t//set text alignment\n\telement.style.textAlign = self.column.hozAlign;\n\n\tif (self.column.vertAlign) {\n\t\telement.style.display = \"inline-flex\";\n\n\t\telement.style.alignItems = vertAligns[self.column.vertAlign] || \"\";\n\n\t\tif (self.column.hozAlign) {\n\t\t\telement.style.justifyContent = hozAligns[self.column.hozAlign] || \"\";\n\t\t}\n\t}\n\n\tif (field) {\n\t\telement.setAttribute(\"tabulator-field\", field);\n\t}\n\n\t//add class to cell if needed\n\tif (self.column.definition.cssClass) {\n\t\tvar classNames = self.column.definition.cssClass.split(\" \");\n\t\tclassNames.forEach(function (className) {\n\t\t\telement.classList.add(className);\n\t\t});\n\t}\n\n\t//update tooltip on mouse enter\n\tif (this.table.options.tooltipGenerationMode === \"hover\") {\n\t\telement.addEventListener(\"mouseenter\", function (e) {\n\t\t\tself._generateTooltip();\n\t\t});\n\t}\n\n\tself._bindClickEvents(cellEvents);\n\n\tself._bindTouchEvents(cellEvents);\n\n\tself._bindMouseEvents(cellEvents);\n\n\tif (self.column.modules.edit) {\n\t\tself.table.modules.edit.bindEditor(self);\n\t}\n\n\tif (self.column.definition.rowHandle && self.table.options.movableRows !== false && self.table.modExists(\"moveRow\")) {\n\t\tself.table.modules.moveRow.initializeCell(self);\n\t}\n\n\t//hide cell if not visible\n\tif (!self.column.visible) {\n\t\tself.hide();\n\t}\n};\n\nCell.prototype._bindClickEvents = function (cellEvents) {\n\tvar self = this,\n\t    element = self.element;\n\n\t//set event bindings\n\tif (cellEvents.cellClick || self.table.options.cellClick) {\n\t\telement.addEventListener(\"click\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellClick) {\n\t\t\t\tcellEvents.cellClick.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellClick) {\n\t\t\t\tself.table.options.cellClick.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellDblClick || this.table.options.cellDblClick) {\n\t\telement.addEventListener(\"dblclick\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellDblClick) {\n\t\t\t\tcellEvents.cellDblClick.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellDblClick) {\n\t\t\t\tself.table.options.cellDblClick.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t} else {\n\t\telement.addEventListener(\"dblclick\", function (e) {\n\n\t\t\tif (self.table.modExists(\"edit\")) {\n\t\t\t\tif (self.table.modules.edit.currentCell === self) {\n\t\t\t\t\treturn; //prevent instant selection of editor content\n\t\t\t\t}\n\t\t\t}\n\n\t\t\te.preventDefault();\n\n\t\t\ttry {\n\t\t\t\tif (document.selection) {\n\t\t\t\t\t// IE\n\t\t\t\t\tvar range = document.body.createTextRange();\n\t\t\t\t\trange.moveToElementText(self.element);\n\t\t\t\t\trange.select();\n\t\t\t\t} else if (window.getSelection) {\n\t\t\t\t\tvar range = document.createRange();\n\t\t\t\t\trange.selectNode(self.element);\n\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\twindow.getSelection().addRange(range);\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\t\t});\n\t}\n\n\tif (cellEvents.cellContext || this.table.options.cellContext) {\n\t\telement.addEventListener(\"contextmenu\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellContext) {\n\t\t\t\tcellEvents.cellContext.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellContext) {\n\t\t\t\tself.table.options.cellContext.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n};\n\nCell.prototype._bindMouseEvents = function (cellEvents) {\n\tvar self = this,\n\t    element = self.element;\n\n\tif (cellEvents.cellMouseEnter || self.table.options.cellMouseEnter) {\n\t\telement.addEventListener(\"mouseenter\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellMouseEnter) {\n\t\t\t\tcellEvents.cellMouseEnter.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellMouseEnter) {\n\t\t\t\tself.table.options.cellMouseEnter.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellMouseLeave || self.table.options.cellMouseLeave) {\n\t\telement.addEventListener(\"mouseleave\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellMouseLeave) {\n\t\t\t\tcellEvents.cellMouseLeave.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellMouseLeave) {\n\t\t\t\tself.table.options.cellMouseLeave.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellMouseOver || self.table.options.cellMouseOver) {\n\t\telement.addEventListener(\"mouseover\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellMouseOver) {\n\t\t\t\tcellEvents.cellMouseOver.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellMouseOver) {\n\t\t\t\tself.table.options.cellMouseOver.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellMouseOut || self.table.options.cellMouseOut) {\n\t\telement.addEventListener(\"mouseout\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellMouseOut) {\n\t\t\t\tcellEvents.cellMouseOut.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellMouseOut) {\n\t\t\t\tself.table.options.cellMouseOut.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellMouseMove || self.table.options.cellMouseMove) {\n\t\telement.addEventListener(\"mousemove\", function (e) {\n\t\t\tvar component = self.getComponent();\n\n\t\t\tif (cellEvents.cellMouseMove) {\n\t\t\t\tcellEvents.cellMouseMove.call(self.table, e, component);\n\t\t\t}\n\n\t\t\tif (self.table.options.cellMouseMove) {\n\t\t\t\tself.table.options.cellMouseMove.call(self.table, e, component);\n\t\t\t}\n\t\t});\n\t}\n};\n\nCell.prototype._bindTouchEvents = function (cellEvents) {\n\tvar self = this,\n\t    element = self.element,\n\t    dblTap,\n\t    tapHold,\n\t    tap;\n\n\tif (cellEvents.cellTap || this.table.options.cellTap) {\n\t\ttap = false;\n\n\t\telement.addEventListener(\"touchstart\", function (e) {\n\t\t\ttap = true;\n\t\t}, { passive: true });\n\n\t\telement.addEventListener(\"touchend\", function (e) {\n\t\t\tif (tap) {\n\t\t\t\tvar component = self.getComponent();\n\n\t\t\t\tif (cellEvents.cellTap) {\n\t\t\t\t\tcellEvents.cellTap.call(self.table, e, component);\n\t\t\t\t}\n\n\t\t\t\tif (self.table.options.cellTap) {\n\t\t\t\t\tself.table.options.cellTap.call(self.table, e, component);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttap = false;\n\t\t});\n\t}\n\n\tif (cellEvents.cellDblTap || this.table.options.cellDblTap) {\n\t\tdblTap = null;\n\n\t\telement.addEventListener(\"touchend\", function (e) {\n\n\t\t\tif (dblTap) {\n\t\t\t\tclearTimeout(dblTap);\n\t\t\t\tdblTap = null;\n\n\t\t\t\tvar component = self.getComponent();\n\n\t\t\t\tif (cellEvents.cellDblTap) {\n\t\t\t\t\tcellEvents.cellDblTap.call(self.table, e, component);\n\t\t\t\t}\n\n\t\t\t\tif (self.table.options.cellDblTap) {\n\t\t\t\t\tself.table.options.cellDblTap.call(self.table, e, component);\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tdblTap = setTimeout(function () {\n\t\t\t\t\tclearTimeout(dblTap);\n\t\t\t\t\tdblTap = null;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (cellEvents.cellTapHold || this.table.options.cellTapHold) {\n\t\ttapHold = null;\n\n\t\telement.addEventListener(\"touchstart\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\n\t\t\ttapHold = setTimeout(function () {\n\t\t\t\tclearTimeout(tapHold);\n\t\t\t\ttapHold = null;\n\t\t\t\ttap = false;\n\t\t\t\tvar component = self.getComponent();\n\n\t\t\t\tif (cellEvents.cellTapHold) {\n\t\t\t\t\tcellEvents.cellTapHold.call(self.table, e, component);\n\t\t\t\t}\n\n\t\t\t\tif (self.table.options.cellTapHold) {\n\t\t\t\t\tself.table.options.cellTapHold.call(self.table, e, component);\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}, { passive: true });\n\n\t\telement.addEventListener(\"touchend\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\t\t\ttapHold = null;\n\t\t});\n\t}\n};\n\n//generate cell contents\nCell.prototype._generateContents = function () {\n\tvar val;\n\n\tif (this.table.modExists(\"format\")) {\n\t\tval = this.table.modules.format.formatValue(this);\n\t} else {\n\t\tval = this.element.innerHTML = this.value;\n\t}\n\n\tswitch (typeof val === 'undefined' ? 'undefined' : _typeof(val)) {\n\t\tcase \"object\":\n\t\t\tif (val instanceof Node) {\n\n\t\t\t\t//clear previous cell contents\n\t\t\t\twhile (this.element.firstChild) {\n\t\t\t\t\tthis.element.removeChild(this.element.firstChild);\n\t\t\t\t}this.element.appendChild(val);\n\t\t\t} else {\n\t\t\t\tthis.element.innerHTML = \"\";\n\n\t\t\t\tif (val != null) {\n\t\t\t\t\tconsole.warn(\"Format Error - Formatter has returned a type of object, the only valid formatter object return is an instance of Node, the formatter returned:\", val);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"undefined\":\n\t\tcase \"null\":\n\t\t\tthis.element.innerHTML = \"\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.element.innerHTML = val;\n\t}\n};\n\nCell.prototype.cellRendered = function () {\n\tif (this.table.modExists(\"format\") && this.table.modules.format.cellRendered) {\n\t\tthis.table.modules.format.cellRendered(this);\n\t}\n};\n\n//generate tooltip text\nCell.prototype._generateTooltip = function () {\n\tvar tooltip = this.column.tooltip;\n\n\tif (tooltip) {\n\t\tif (tooltip === true) {\n\t\t\ttooltip = this.value;\n\t\t} else if (typeof tooltip == \"function\") {\n\t\t\ttooltip = tooltip(this.getComponent());\n\n\t\t\tif (tooltip === false) {\n\t\t\t\ttooltip = \"\";\n\t\t\t}\n\t\t}\n\n\t\tif (typeof tooltip === \"undefined\") {\n\t\t\ttooltip = \"\";\n\t\t}\n\n\t\tthis.element.setAttribute(\"title\", tooltip);\n\t} else {\n\t\tthis.element.setAttribute(\"title\", \"\");\n\t}\n};\n\n//////////////////// Getters ////////////////////\nCell.prototype.getElement = function (containerOnly) {\n\tif (!this.loaded) {\n\t\tthis.loaded = true;\n\t\tif (!containerOnly) {\n\t\t\tthis.layoutElement();\n\t\t}\n\t}\n\n\treturn this.element;\n};\n\nCell.prototype.getValue = function () {\n\treturn this.value;\n};\n\nCell.prototype.getOldValue = function () {\n\treturn this.oldValue;\n};\n\n//////////////////// Actions ////////////////////\n\nCell.prototype.setValue = function (value, mutate) {\n\n\tvar changed = this.setValueProcessData(value, mutate),\n\t    component;\n\n\tif (changed) {\n\t\tif (this.table.options.history && this.table.modExists(\"history\")) {\n\t\t\tthis.table.modules.history.action(\"cellEdit\", this, { oldValue: this.oldValue, newValue: this.value });\n\t\t}\n\n\t\tcomponent = this.getComponent();\n\n\t\tif (this.column.cellEvents.cellEdited) {\n\t\t\tthis.column.cellEvents.cellEdited.call(this.table, component);\n\t\t}\n\n\t\tif (this.table.options.groupUpdateOnCellEdit && this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\t\tthis.table.modules.groupRows.reassignRowToGroup(this.row);\n\t\t}\n\n\t\tthis.cellRendered();\n\n\t\tthis.table.options.cellEdited.call(this.table, component);\n\n\t\tif (this.table.options.dataChanged) {\n\t\t\tthis.table.options.dataChanged.call(this.table, this.table.rowManager.getData());\n\t\t}\n\t}\n};\n\nCell.prototype.setValueProcessData = function (value, mutate) {\n\tvar changed = false;\n\n\tif (this.value != value) {\n\n\t\tchanged = true;\n\n\t\tif (mutate) {\n\t\t\tif (this.column.modules.mutate) {\n\t\t\t\tvalue = this.table.modules.mutator.transformCell(this, value);\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.setValueActual(value);\n\n\tif (changed && this.table.modExists(\"columnCalcs\")) {\n\t\tif (this.column.definition.topCalc || this.column.definition.bottomCalc) {\n\t\t\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\n\t\t\t\tif (this.table.options.columnCalcs == \"table\" || this.table.options.columnCalcs == \"both\") {\n\t\t\t\t\tthis.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows);\n\t\t\t\t}\n\n\t\t\t\tif (this.table.options.columnCalcs != \"table\") {\n\t\t\t\t\tthis.table.modules.columnCalcs.recalcRowGroup(this.row);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.table.modules.columnCalcs.recalc(this.table.rowManager.activeRows);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn changed;\n};\n\nCell.prototype.setValueActual = function (value) {\n\tthis.oldValue = this.value;\n\n\tthis.value = value;\n\n\tif (this.table.options.reactiveData && this.table.modExists(\"reactiveData\")) {\n\t\tthis.table.modules.reactiveData.block();\n\t}\n\n\tthis.column.setFieldValue(this.row.data, value);\n\n\tif (this.table.options.reactiveData && this.table.modExists(\"reactiveData\")) {\n\t\tthis.table.modules.reactiveData.unblock();\n\t}\n\n\tif (this.loaded) {\n\t\tthis.layoutElement();\n\t}\n};\n\nCell.prototype.layoutElement = function () {\n\tthis._generateContents();\n\tthis._generateTooltip();\n\n\t//set resizable handles\n\tif (this.table.options.resizableColumns && this.table.modExists(\"resizeColumns\") && this.row.type === \"row\") {\n\t\tthis.table.modules.resizeColumns.initializeColumn(\"cell\", this.column, this.element);\n\t}\n\n\tif ((this.column.definition.contextMenu || this.column.definition.clickMenu) && this.table.modExists(\"menu\")) {\n\t\tthis.table.modules.menu.initializeCell(this);\n\t}\n\n\t//handle frozen cells\n\tif (this.table.modExists(\"frozenColumns\")) {\n\t\tthis.table.modules.frozenColumns.layoutElement(this.element, this.column);\n\t}\n};\n\nCell.prototype.setWidth = function () {\n\tthis.width = this.column.width;\n\tthis.element.style.width = this.column.widthStyled;\n};\n\nCell.prototype.clearWidth = function () {\n\tthis.width = \"\";\n\tthis.element.style.width = \"\";\n};\n\nCell.prototype.getWidth = function () {\n\treturn this.width || this.element.offsetWidth;\n};\n\nCell.prototype.setMinWidth = function () {\n\tthis.minWidth = this.column.minWidth;\n\tthis.element.style.minWidth = this.column.minWidthStyled;\n};\n\nCell.prototype.setMaxWidth = function () {\n\tthis.maxWidth = this.column.maxWidth;\n\tthis.element.style.maxWidth = this.column.maxWidthStyled;\n};\n\nCell.prototype.checkHeight = function () {\n\t// var height = this.element.css(\"height\");\n\tthis.row.reinitializeHeight();\n};\n\nCell.prototype.clearHeight = function () {\n\tthis.element.style.height = \"\";\n\tthis.height = null;\n};\n\nCell.prototype.setHeight = function () {\n\tthis.height = this.row.height;\n\tthis.element.style.height = this.row.heightStyled;\n};\n\nCell.prototype.getHeight = function () {\n\treturn this.height || this.element.offsetHeight;\n};\n\nCell.prototype.show = function () {\n\tthis.element.style.display = this.column.vertAlign ? \"inline-flex\" : \"\";\n};\n\nCell.prototype.hide = function () {\n\tthis.element.style.display = \"none\";\n};\n\nCell.prototype.edit = function (force) {\n\tif (this.table.modExists(\"edit\", true)) {\n\t\treturn this.table.modules.edit.editCell(this, force);\n\t}\n};\n\nCell.prototype.cancelEdit = function () {\n\tif (this.table.modExists(\"edit\", true)) {\n\t\tvar editing = this.table.modules.edit.getCurrentCell();\n\n\t\tif (editing && editing._getSelf() === this) {\n\t\t\tthis.table.modules.edit.cancelEdit();\n\t\t} else {\n\t\t\tconsole.warn(\"Cancel Editor Error - This cell is not currently being edited \");\n\t\t}\n\t}\n};\n\nCell.prototype.validate = function () {\n\tif (this.column.modules.validate && this.table.modExists(\"validate\", true)) {\n\t\tvar valid = this.table.modules.validate.validate(this.column.modules.validate, this, this.getValue());\n\n\t\treturn valid === true;\n\t} else {\n\t\treturn true;\n\t}\n};\n\nCell.prototype.delete = function () {\n\tif (!this.table.rowManager.redrawBlock && this.element.parentNode) {\n\t\tthis.element.parentNode.removeChild(this.element);\n\t}\n\n\tif (this.modules.validate && this.modules.validate.invalid) {\n\t\tthis.table.modules.validate.clearValidation(this);\n\t}\n\n\tif (this.modules.edit && this.modules.edit.edited) {\n\t\tthis.table.modules.edit.clearEdited(this);\n\t}\n\n\tif (this.table.options.history) {\n\t\tthis.table.modules.history.clearComponentHistory(this);\n\t}\n\n\tthis.element = false;\n\tthis.column.deleteCell(this);\n\tthis.row.deleteCell(this);\n\tthis.calcs = {};\n};\n\n//////////////// Navigation /////////////////\n\nCell.prototype.nav = function () {\n\n\tvar self = this,\n\t    nextCell = false,\n\t    index = this.row.getCellIndex(this);\n\n\treturn {\n\t\tnext: function next() {\n\t\t\tvar nextCell = this.right(),\n\t\t\t    nextRow;\n\n\t\t\tif (!nextCell) {\n\t\t\t\tnextRow = self.table.rowManager.nextDisplayRow(self.row, true);\n\n\t\t\t\tif (nextRow) {\n\t\t\t\t\tnextCell = nextRow.findNextEditableCell(-1);\n\n\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\tnextCell.edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tprev: function prev() {\n\t\t\tvar nextCell = this.left(),\n\t\t\t    prevRow;\n\n\t\t\tif (!nextCell) {\n\t\t\t\tprevRow = self.table.rowManager.prevDisplayRow(self.row, true);\n\n\t\t\t\tif (prevRow) {\n\t\t\t\t\tnextCell = prevRow.findPrevEditableCell(prevRow.cells.length);\n\n\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\tnextCell.edit();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tleft: function left() {\n\n\t\t\tnextCell = self.row.findPrevEditableCell(index);\n\n\t\t\tif (nextCell) {\n\t\t\t\tnextCell.edit();\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tright: function right() {\n\t\t\tnextCell = self.row.findNextEditableCell(index);\n\n\t\t\tif (nextCell) {\n\t\t\t\tnextCell.edit();\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tup: function up() {\n\t\t\tvar nextRow = self.table.rowManager.prevDisplayRow(self.row, true);\n\n\t\t\tif (nextRow) {\n\t\t\t\tnextRow.cells[index].edit();\n\t\t\t}\n\t\t},\n\t\tdown: function down() {\n\t\t\tvar nextRow = self.table.rowManager.nextDisplayRow(self.row, true);\n\n\t\t\tif (nextRow) {\n\t\t\t\tnextRow.cells[index].edit();\n\t\t\t}\n\t\t}\n\n\t};\n};\n\nCell.prototype.getIndex = function () {\n\tthis.row.getCellIndex(this);\n};\n\n//////////////// Object Generation /////////////////\nCell.prototype.getComponent = function () {\n\n\tif (!this.component) {\n\t\tthis.component = new CellComponent(this);\n\t}\n\n\treturn this.component;\n};\nvar FooterManager = function FooterManager(table) {\n\tthis.table = table;\n\tthis.active = false;\n\tthis.element = this.createElement(); //containing element\n\tthis.external = false;\n\tthis.links = [];\n\n\tthis._initialize();\n};\n\nFooterManager.prototype.createElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-footer\");\n\n\treturn el;\n};\n\nFooterManager.prototype._initialize = function (element) {\n\tif (this.table.options.footerElement) {\n\n\t\tswitch (_typeof(this.table.options.footerElement)) {\n\t\t\tcase \"string\":\n\n\t\t\t\tif (this.table.options.footerElement[0] === \"<\") {\n\t\t\t\t\tthis.element.innerHTML = this.table.options.footerElement;\n\t\t\t\t} else {\n\t\t\t\t\tthis.external = true;\n\t\t\t\t\tthis.element = document.querySelector(this.table.options.footerElement);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.element = this.table.options.footerElement;\n\t\t\t\tbreak;\n\t\t}\n\t}\n};\n\nFooterManager.prototype.getElement = function () {\n\treturn this.element;\n};\n\nFooterManager.prototype.append = function (element, parent) {\n\tthis.activate(parent);\n\n\tthis.element.appendChild(element);\n\tthis.table.rowManager.adjustTableSize();\n};\n\nFooterManager.prototype.prepend = function (element, parent) {\n\tthis.activate(parent);\n\n\tthis.element.insertBefore(element, this.element.firstChild);\n\tthis.table.rowManager.adjustTableSize();\n};\n\nFooterManager.prototype.remove = function (element) {\n\telement.parentNode.removeChild(element);\n\tthis.deactivate();\n};\n\nFooterManager.prototype.deactivate = function (force) {\n\tif (!this.element.firstChild || force) {\n\t\tif (!this.external) {\n\t\t\tthis.element.parentNode.removeChild(this.element);\n\t\t}\n\t\tthis.active = false;\n\t}\n\n\t// this.table.rowManager.adjustTableSize();\n};\n\nFooterManager.prototype.activate = function (parent) {\n\tif (!this.active) {\n\t\tthis.active = true;\n\t\tif (!this.external) {\n\t\t\tthis.table.element.appendChild(this.getElement());\n\t\t\tthis.table.element.style.display = '';\n\t\t}\n\t}\n\n\tif (parent) {\n\t\tthis.links.push(parent);\n\t}\n};\n\nFooterManager.prototype.redraw = function () {\n\tthis.links.forEach(function (link) {\n\t\tlink.footerRedraw();\n\t});\n};\n\nvar Tabulator = function Tabulator(element, options) {\n\n\tthis.options = {};\n\n\tthis.columnManager = null; // hold Column Manager\n\tthis.rowManager = null; //hold Row Manager\n\tthis.footerManager = null; //holder Footer Manager\n\tthis.vdomHoz = null; //holder horizontal virtual dom\n\n\n\tthis.browser = \"\"; //hold current browser type\n\tthis.browserSlow = false; //handle reduced functionality for slower browsers\n\tthis.browserMobile = false; //check if running on moble, prevent resize cancelling edit on keyboard appearence\n\tthis.rtl = false; //check if the table is in RTL mode\n\n\tthis.modules = {}; //hold all modules bound to this table\n\n\tif (this.initializeElement(element)) {\n\t\tthis.initializeOptions(options || {});\n\t\tthis._create();\n\t}\n\n\tTabulator.prototype.comms.register(this); //register table for inderdevice communication\n};\n\n//default setup options\nTabulator.prototype.defaultOptions = {\n\n\theight: false, //height of tabulator\n\tminHeight: false, //minimum height of tabulator\n\tmaxHeight: false, //maximum height of tabulator\n\n\tlayout: \"fitData\", ///layout type \"fitColumns\" | \"fitData\"\n\tlayoutColumnsOnNewData: false, //update column widths on setData\n\n\tcolumnMinWidth: 40, //minimum global width for a column\n\tcolumnMaxWidth: false, //minimum global width for a column\n\tcolumnHeaderVertAlign: \"top\", //vertical alignment of column headers\n\tcolumnVertAlign: false, // DEPRECATED - Left to allow warning\n\n\tresizableColumns: true, //resizable columns\n\tresizableRows: false, //resizable rows\n\tautoResize: true, //auto resize table\n\n\tcolumns: [], //store for colum header info\n\n\tcellHozAlign: \"\", //horizontal align columns\n\tcellVertAlign: \"\", //vertical align columns\n\theaderHozAlign: \"\", //horizontal header alignment\n\n\n\tdata: [], //default starting data\n\n\tautoColumns: false, //build columns from data row structure\n\tautoColumnsDefinitions: false,\n\n\treactiveData: false, //enable data reactivity\n\n\tnestedFieldSeparator: \".\", //seperatpr for nested data\n\n\ttooltips: false, //Tool tip value\n\ttooltipsHeader: false, //Tool tip for headers\n\ttooltipGenerationMode: \"load\", //when to generate tooltips\n\n\tinitialSort: false, //initial sorting criteria\n\tinitialFilter: false, //initial filtering criteria\n\tinitialHeaderFilter: false, //initial header filtering criteria\n\n\tcolumnHeaderSortMulti: true, //multiple or single column sorting\n\n\tsortOrderReverse: false, //reverse internal sort ordering\n\n\theaderSort: true, //set default global header sort\n\theaderSortTristate: false, //set default tristate header sorting\n\theaderSortElement: \"<div class='tabulator-arrow'></div>\", //header sort element\n\n\tfooterElement: false, //hold footer element\n\n\tindex: \"id\", //filed for row index\n\n\ttextDirection: \"auto\",\n\n\tkeybindings: [], //array for keybindings\n\n\ttabEndNewRow: false, //create new row when tab to end of table\n\n\tinvalidOptionWarnings: true, //allow toggling of invalid option warnings\n\n\tclipboard: false, //enable clipboard\n\tclipboardCopyStyled: true, //formatted table data\n\tclipboardCopyConfig: false, //clipboard config\n\tclipboardCopyFormatter: false, //DEPRICATED - REMOVE in 5.0\n\tclipboardCopyRowRange: \"active\", //restrict clipboard to visible rows only\n\tclipboardPasteParser: \"table\", //convert pasted clipboard data to rows\n\tclipboardPasteAction: \"insert\", //how to insert pasted data into the table\n\n\tclipboardCopied: function clipboardCopied() {}, //data has been copied to the clipboard\n\tclipboardPasted: function clipboardPasted() {}, //data has been pasted into the table\n\tclipboardPasteError: function clipboardPasteError() {}, //data has not successfully been pasted into the table\n\n\tdownloadDataFormatter: false, //function to manipulate table data before it is downloaded\n\tdownloadReady: function downloadReady(data, blob) {\n\t\treturn blob;\n\t}, //function to manipulate download data\n\tdownloadComplete: false, //function to manipulate download data\n\tdownloadConfig: {}, //download config\n\tdownloadRowRange: \"active\", //restrict download to active rows only\n\n\tdataTree: false, //enable data tree\n\tdataTreeFilter: true, //filter child rows\n\tdataTreeSort: true, //sort child rows\n\tdataTreeElementColumn: false,\n\tdataTreeBranchElement: true, //show data tree branch element\n\tdataTreeChildIndent: 9, //data tree child indent in px\n\tdataTreeChildField: \"_children\", //data tre column field to look for child rows\n\tdataTreeCollapseElement: false, //data tree row collapse element\n\tdataTreeExpandElement: false, //data tree row expand element\n\tdataTreeStartExpanded: false,\n\tdataTreeRowExpanded: function dataTreeRowExpanded() {}, //row has been expanded\n\tdataTreeRowCollapsed: function dataTreeRowCollapsed() {}, //row has been collapsed\n\tdataTreeChildColumnCalcs: false, //include visible data tree rows in column calculations\n\tdataTreeSelectPropagate: false, //seleccting a parent row selects its children\n\n\tprintAsHtml: false, //enable print as html\n\tprintFormatter: false, //printing page formatter\n\tprintHeader: false, //page header contents\n\tprintFooter: false, //page footer contents\n\tprintCopyStyle: true, //DEPRICATED - REMOVE in 5.0\n\tprintStyled: true, //enable print as html styling\n\tprintVisibleRows: true, //DEPRICATED - REMOVE in 5.0\n\tprintRowRange: \"visible\", //restrict print to visible rows only\n\tprintConfig: {}, //print config options\n\n\taddRowPos: \"bottom\", //position to insert blank rows, top|bottom\n\n\tselectable: \"highlight\", //highlight rows on hover\n\tselectableRangeMode: \"drag\", //highlight rows on hover\n\tselectableRollingSelection: true, //roll selection once maximum number of selectable rows is reached\n\tselectablePersistence: true, // maintain selection when table view is updated\n\tselectableCheck: function selectableCheck(data, row) {\n\t\treturn true;\n\t}, //check wheather row is selectable\n\n\theaderFilterLiveFilterDelay: 300, //delay before updating column after user types in header filter\n\theaderFilterPlaceholder: false, //placeholder text to display in header filters\n\n\theaderVisible: true, //hide header\n\n\thistory: false, //enable edit history\n\n\tlocale: false, //current system language\n\tlangs: {},\n\n\tvirtualDom: true, //enable DOM virtualization\n\tvirtualDomBuffer: 0, // set virtual DOM buffer size\n\tvirtualDomHoz: false, //enable horizontal DOM virtualization\n\n\tpersistentLayout: false, //DEPRICATED - REMOVE in 5.0\n\tpersistentSort: false, //DEPRICATED - REMOVE in 5.0\n\tpersistentFilter: false, //DEPRICATED - REMOVE in 5.0\n\tpersistenceID: \"\", //key for persistent storage\n\tpersistenceMode: true, //mode for storing persistence information\n\tpersistenceReaderFunc: false, //function for handling persistence data reading\n\tpersistenceWriterFunc: false, //function for handling persistence data writing\n\n\tpersistence: false,\n\n\tresponsiveLayout: false, //responsive layout flags\n\tresponsiveLayoutCollapseStartOpen: true, //start showing collapsed data\n\tresponsiveLayoutCollapseUseFormatters: true, //responsive layout collapse formatter\n\tresponsiveLayoutCollapseFormatter: false, //responsive layout collapse formatter\n\n\tpagination: false, //set pagination type\n\tpaginationSize: false, //set number of rows to a page\n\tpaginationInitialPage: 1, //initail page to show on load\n\tpaginationButtonCount: 5, // set count of page button\n\tpaginationSizeSelector: false, //add pagination size selector element\n\tpaginationElement: false, //element to hold pagination numbers\n\tpaginationDataSent: {}, //pagination data sent to the server\n\tpaginationDataReceived: {}, //pagination data received from the server\n\tpaginationAddRow: \"page\", //add rows on table or page\n\n\tajaxURL: false, //url for ajax loading\n\tajaxURLGenerator: false,\n\tajaxParams: {}, //params for ajax loading\n\tajaxConfig: \"get\", //ajax request type\n\tajaxContentType: \"form\", //ajax request type\n\tajaxRequestFunc: false, //promise function\n\tajaxLoader: true, //show loader\n\tajaxLoaderLoading: false, //loader element\n\tajaxLoaderError: false, //loader element\n\tajaxFiltering: false,\n\tajaxSorting: false,\n\tajaxProgressiveLoad: false, //progressive loading\n\tajaxProgressiveLoadDelay: 0, //delay between requests\n\tajaxProgressiveLoadScrollMargin: 0, //margin before scroll begins\n\n\tgroupBy: false, //enable table grouping and set field to group by\n\tgroupStartOpen: true, //starting state of group\n\tgroupValues: false,\n\tgroupUpdateOnCellEdit: false,\n\n\tgroupHeader: false, //header generation function\n\tgroupHeaderPrint: null,\n\tgroupHeaderClipboard: null,\n\tgroupHeaderHtmlOutput: null,\n\tgroupHeaderDownload: null,\n\n\thtmlOutputConfig: false, //html outypu config\n\n\tmovableColumns: false, //enable movable columns\n\n\tmovableRows: false, //enable movable rows\n\tmovableRowsConnectedTables: false, //tables for movable rows to be connected to\n\tmovableRowsConnectedElements: false, //other elements for movable rows to be connected to\n\tmovableRowsSender: false,\n\tmovableRowsReceiver: \"insert\",\n\tmovableRowsSendingStart: function movableRowsSendingStart() {},\n\tmovableRowsSent: function movableRowsSent() {},\n\tmovableRowsSentFailed: function movableRowsSentFailed() {},\n\tmovableRowsSendingStop: function movableRowsSendingStop() {},\n\tmovableRowsReceivingStart: function movableRowsReceivingStart() {},\n\tmovableRowsReceived: function movableRowsReceived() {},\n\tmovableRowsReceivedFailed: function movableRowsReceivedFailed() {},\n\tmovableRowsReceivingStop: function movableRowsReceivingStop() {},\n\tmovableRowsElementDrop: function movableRowsElementDrop() {},\n\n\tscrollToRowPosition: \"top\",\n\tscrollToRowIfVisible: true,\n\n\tscrollToColumnPosition: \"left\",\n\tscrollToColumnIfVisible: true,\n\n\trowFormatter: false,\n\trowFormatterPrint: null,\n\trowFormatterClipboard: null,\n\trowFormatterHtmlOutput: null,\n\n\tplaceholder: false,\n\n\t//table building callbacks\n\ttableBuilding: function tableBuilding() {},\n\ttableBuilt: function tableBuilt() {},\n\n\t//render callbacks\n\trenderStarted: function renderStarted() {},\n\trenderComplete: function renderComplete() {},\n\n\t//row callbacks\n\trowClick: false,\n\trowDblClick: false,\n\trowContext: false,\n\trowTap: false,\n\trowDblTap: false,\n\trowTapHold: false,\n\trowMouseEnter: false,\n\trowMouseLeave: false,\n\trowMouseOver: false,\n\trowMouseOut: false,\n\trowMouseMove: false,\n\trowContextMenu: false,\n\trowClickMenu: false,\n\trowAdded: function rowAdded() {},\n\trowDeleted: function rowDeleted() {},\n\trowMoved: function rowMoved() {},\n\trowUpdated: function rowUpdated() {},\n\trowSelectionChanged: function rowSelectionChanged() {},\n\trowSelected: function rowSelected() {},\n\trowDeselected: function rowDeselected() {},\n\trowResized: function rowResized() {},\n\n\t//cell callbacks\n\t//row callbacks\n\tcellClick: false,\n\tcellDblClick: false,\n\tcellContext: false,\n\tcellTap: false,\n\tcellDblTap: false,\n\tcellTapHold: false,\n\tcellMouseEnter: false,\n\tcellMouseLeave: false,\n\tcellMouseOver: false,\n\tcellMouseOut: false,\n\tcellMouseMove: false,\n\tcellEditing: function cellEditing() {},\n\tcellEdited: function cellEdited() {},\n\tcellEditCancelled: function cellEditCancelled() {},\n\n\t//column callbacks\n\tcolumnMoved: false,\n\tcolumnResized: function columnResized() {},\n\tcolumnTitleChanged: function columnTitleChanged() {},\n\tcolumnVisibilityChanged: function columnVisibilityChanged() {},\n\n\t//HTML iport callbacks\n\thtmlImporting: function htmlImporting() {},\n\thtmlImported: function htmlImported() {},\n\n\t//data callbacks\n\tdataLoading: function dataLoading() {},\n\tdataLoaded: function dataLoaded() {},\n\tdataEdited: false, //DEPRECATED\n\tdataChanged: false,\n\n\t//ajax callbacks\n\tajaxRequesting: function ajaxRequesting() {},\n\tajaxResponse: false,\n\tajaxError: function ajaxError() {},\n\n\t//filtering callbacks\n\tdataFiltering: false,\n\tdataFiltered: false,\n\n\t//sorting callbacks\n\tdataSorting: function dataSorting() {},\n\tdataSorted: function dataSorted() {},\n\n\t//grouping callbacks\n\tgroupToggleElement: \"arrow\",\n\tgroupClosedShowCalcs: false,\n\tdataGrouping: function dataGrouping() {},\n\tdataGrouped: false,\n\tgroupVisibilityChanged: function groupVisibilityChanged() {},\n\tgroupClick: false,\n\tgroupDblClick: false,\n\tgroupContext: false,\n\tgroupContextMenu: false,\n\tgroupClickMenu: false,\n\tgroupTap: false,\n\tgroupDblTap: false,\n\tgroupTapHold: false,\n\n\tcolumnCalcs: true,\n\n\t//pagination callbacks\n\tpageLoaded: function pageLoaded() {},\n\n\t//localization callbacks\n\tlocalized: function localized() {},\n\n\t//validation callbacks\n\tvalidationMode: \"blocking\",\n\tvalidationFailed: function validationFailed() {},\n\n\t//history callbacks\n\thistoryUndo: function historyUndo() {},\n\thistoryRedo: function historyRedo() {},\n\n\t//scroll callbacks\n\tscrollHorizontal: function scrollHorizontal() {},\n\tscrollVertical: function scrollVertical() {}\n};\n\nTabulator.prototype.initializeOptions = function (options) {\n\n\t//warn user if option is not available\n\tif (options.invalidOptionWarnings !== false) {\n\t\tfor (var key in options) {\n\t\t\tif (typeof this.defaultOptions[key] === \"undefined\") {\n\t\t\t\tconsole.warn(\"Invalid table constructor option:\", key);\n\t\t\t}\n\t\t}\n\t}\n\n\t//assign options to table\n\tfor (var key in this.defaultOptions) {\n\t\tif (key in options) {\n\t\t\tthis.options[key] = options[key];\n\t\t} else {\n\t\t\tif (Array.isArray(this.defaultOptions[key])) {\n\t\t\t\tthis.options[key] = Object.assign([], this.defaultOptions[key]);\n\t\t\t} else if (_typeof(this.defaultOptions[key]) === \"object\" && this.defaultOptions[key] !== null) {\n\t\t\t\tthis.options[key] = Object.assign({}, this.defaultOptions[key]);\n\t\t\t} else {\n\t\t\t\tthis.options[key] = this.defaultOptions[key];\n\t\t\t}\n\t\t}\n\t}\n};\n\nTabulator.prototype.initializeElement = function (element) {\n\n\tif (typeof HTMLElement !== \"undefined\" && element instanceof HTMLElement) {\n\t\tthis.element = element;\n\t\treturn true;\n\t} else if (typeof element === \"string\") {\n\t\tthis.element = document.querySelector(element);\n\n\t\tif (this.element) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconsole.error(\"Tabulator Creation Error - no element found matching selector: \", element);\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tconsole.error(\"Tabulator Creation Error - Invalid element provided:\", element);\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.rtlCheck = function () {\n\tvar style = window.getComputedStyle(this.element);\n\n\tswitch (this.options.textDirection) {\n\t\tcase \"auto\":\n\t\t\tif (style.direction !== \"rtl\") {\n\t\t\t\tbreak;\n\t\t\t};\n\n\t\tcase \"rtl\":\n\t\t\tthis.element.classList.add(\"tabulator-rtl\");\n\t\t\tthis.rtl = true;\n\t\t\tbreak;\n\n\t\tcase \"ltr\":\n\t\t\tthis.element.classList.add(\"tabulator-ltr\");\n\n\t\tdefault:\n\t\t\tthis.rtl = false;\n\t}\n};\n\n//convert depricated functionality to new functions\nTabulator.prototype._mapDepricatedFunctionality = function () {\n\n\t//map depricated persistance setup options\n\tif (this.options.persistentLayout || this.options.persistentSort || this.options.persistentFilter) {\n\t\tif (!this.options.persistence) {\n\t\t\tthis.options.persistence = {};\n\t\t}\n\t}\n\n\tif (this.options.dataEdited) {\n\t\tconsole.warn(\"DEPRECATION WARNING - dataEdited option has been deprecated, please use the dataChanged option instead\");\n\t\tthis.options.dataChanged = this.options.dataEdited;\n\t}\n\n\tif (this.options.downloadDataFormatter) {\n\t\tconsole.warn(\"DEPRECATION WARNING - downloadDataFormatter option has been deprecated\");\n\t}\n\n\tif (typeof this.options.clipboardCopyHeader !== \"undefined\") {\n\t\tthis.options.columnHeaders = this.options.clipboardCopyHeader;\n\t\tconsole.warn(\"DEPRECATION WARNING - clipboardCopyHeader option has been deprecated, please use the columnHeaders property on the clipboardCopyConfig option\");\n\t}\n\n\tif (this.options.printVisibleRows !== true) {\n\t\tconsole.warn(\"printVisibleRows option is deprecated, you should now use the printRowRange option\");\n\n\t\tthis.options.persistence.printRowRange = \"active\";\n\t}\n\n\tif (this.options.printCopyStyle !== true) {\n\t\tconsole.warn(\"printCopyStyle option is deprecated, you should now use the printStyled option\");\n\n\t\tthis.options.persistence.printStyled = this.options.printCopyStyle;\n\t}\n\n\tif (this.options.persistentLayout) {\n\t\tconsole.warn(\"persistentLayout option is deprecated, you should now use the persistence option\");\n\n\t\tif (this.options.persistence !== true && typeof this.options.persistence.columns === \"undefined\") {\n\t\t\tthis.options.persistence.columns = true;\n\t\t}\n\t}\n\n\tif (this.options.persistentSort) {\n\t\tconsole.warn(\"persistentSort option is deprecated, you should now use the persistence option\");\n\n\t\tif (this.options.persistence !== true && typeof this.options.persistence.sort === \"undefined\") {\n\t\t\tthis.options.persistence.sort = true;\n\t\t}\n\t}\n\n\tif (this.options.persistentFilter) {\n\t\tconsole.warn(\"persistentFilter option is deprecated, you should now use the persistence option\");\n\n\t\tif (this.options.persistence !== true && typeof this.options.persistence.filter === \"undefined\") {\n\t\t\tthis.options.persistence.filter = true;\n\t\t}\n\t}\n\n\tif (this.options.columnVertAlign) {\n\t\tconsole.warn(\"columnVertAlign option is deprecated, you should now use the columnHeaderVertAlign option\");\n\n\t\tthis.options.columnHeaderVertAlign = this.options.columnVertAlign;\n\t}\n};\n\nTabulator.prototype._clearSelection = function () {\n\n\tthis.element.classList.add(\"tabulator-block-select\");\n\n\tif (window.getSelection) {\n\t\tif (window.getSelection().empty) {\n\t\t\t// Chrome\n\t\t\twindow.getSelection().empty();\n\t\t} else if (window.getSelection().removeAllRanges) {\n\t\t\t// Firefox\n\t\t\twindow.getSelection().removeAllRanges();\n\t\t}\n\t} else if (document.selection) {\n\t\t// IE?\n\t\tdocument.selection.empty();\n\t}\n\n\tthis.element.classList.remove(\"tabulator-block-select\");\n};\n\n//concreate table\nTabulator.prototype._create = function () {\n\tthis._clearObjectPointers();\n\n\tthis._mapDepricatedFunctionality();\n\n\tthis.bindModules();\n\n\tthis.rtlCheck();\n\n\tif (this.element.tagName === \"TABLE\") {\n\t\tif (this.modExists(\"htmlTableImport\", true)) {\n\t\t\tthis.modules.htmlTableImport.parseTable();\n\t\t}\n\t}\n\n\tthis.columnManager = new ColumnManager(this);\n\tthis.rowManager = new RowManager(this);\n\tthis.footerManager = new FooterManager(this);\n\n\tthis.columnManager.setRowManager(this.rowManager);\n\tthis.rowManager.setColumnManager(this.columnManager);\n\n\tif (this.options.virtualDomHoz) {\n\t\tthis.vdomHoz = new VDomHoz(this);\n\t}\n\n\tthis._buildElement();\n\n\tthis._loadInitialData();\n};\n\n//clear pointers to objects in default config object\nTabulator.prototype._clearObjectPointers = function () {\n\tthis.options.columns = this.options.columns.slice(0);\n\n\tif (!this.options.reactiveData) {\n\t\tthis.options.data = this.options.data.slice(0);\n\t}\n};\n\n//build tabulator element\nTabulator.prototype._buildElement = function () {\n\tvar _this24 = this;\n\n\tvar element = this.element,\n\t    mod = this.modules,\n\t    options = this.options;\n\n\toptions.tableBuilding.call(this);\n\n\telement.classList.add(\"tabulator\");\n\telement.setAttribute(\"role\", \"grid\");\n\n\t//empty element\n\twhile (element.firstChild) {\n\t\telement.removeChild(element.firstChild);\n\t} //set table height\n\tif (options.height) {\n\t\toptions.height = isNaN(options.height) ? options.height : options.height + \"px\";\n\t\telement.style.height = options.height;\n\t}\n\n\t//set table min height\n\tif (options.minHeight !== false) {\n\t\toptions.minHeight = isNaN(options.minHeight) ? options.minHeight : options.minHeight + \"px\";\n\t\telement.style.minHeight = options.minHeight;\n\t}\n\n\t//set table maxHeight\n\tif (options.maxHeight !== false) {\n\t\toptions.maxHeight = isNaN(options.maxHeight) ? options.maxHeight : options.maxHeight + \"px\";\n\t\telement.style.maxHeight = options.maxHeight;\n\t}\n\n\tthis.columnManager.initialize();\n\tthis.rowManager.initialize();\n\n\tthis._detectBrowser();\n\n\tif (this.modExists(\"layout\", true)) {\n\t\tmod.layout.initialize(options.layout);\n\t}\n\n\t//set localization\n\n\tmod.localize.initialize();\n\n\tif (options.headerFilterPlaceholder !== false) {\n\t\tmod.localize.setHeaderFilterPlaceholder(options.headerFilterPlaceholder);\n\t}\n\n\tfor (var locale in options.langs) {\n\t\tmod.localize.installLang(locale, options.langs[locale]);\n\t}\n\n\tmod.localize.setLocale(options.locale);\n\n\t//configure placeholder element\n\tif (typeof options.placeholder == \"string\") {\n\n\t\tvar el = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-placeholder\");\n\n\t\tvar span = document.createElement(\"span\");\n\t\tspan.innerHTML = options.placeholder;\n\n\t\tel.appendChild(span);\n\n\t\toptions.placeholder = el;\n\t}\n\n\t//build table elements\n\telement.appendChild(this.columnManager.getElement());\n\telement.appendChild(this.rowManager.getElement());\n\n\tif (options.footerElement) {\n\t\tthis.footerManager.activate();\n\t}\n\n\tif (options.persistence && this.modExists(\"persistence\", true)) {\n\t\tmod.persistence.initialize();\n\t}\n\n\tif (options.movableRows && this.modExists(\"moveRow\")) {\n\t\tmod.moveRow.initialize();\n\t}\n\n\tif (options.autoColumns && this.options.data) {\n\t\tthis.columnManager.generateColumnsFromRowData(this.options.data);\n\t}\n\n\tif (this.modExists(\"columnCalcs\")) {\n\t\tmod.columnCalcs.initialize();\n\t}\n\n\tthis.columnManager.setColumns(options.columns);\n\n\tif (options.dataTree && this.modExists(\"dataTree\", true)) {\n\t\tmod.dataTree.initialize();\n\t}\n\n\tif (this.modExists(\"frozenRows\")) {\n\t\tthis.modules.frozenRows.initialize();\n\t}\n\n\tif ((options.persistence && this.modExists(\"persistence\", true) && mod.persistence.config.sort || options.initialSort) && this.modExists(\"sort\", true)) {\n\t\tvar sorters = [];\n\n\t\tif (options.persistence && this.modExists(\"persistence\", true) && mod.persistence.config.sort) {\n\t\t\tsorters = mod.persistence.load(\"sort\");\n\n\t\t\tif (sorters === false && options.initialSort) {\n\t\t\t\tsorters = options.initialSort;\n\t\t\t}\n\t\t} else if (options.initialSort) {\n\t\t\tsorters = options.initialSort;\n\t\t}\n\n\t\tmod.sort.setSort(sorters);\n\t}\n\n\tif ((options.persistence && this.modExists(\"persistence\", true) && mod.persistence.config.filter || options.initialFilter) && this.modExists(\"filter\", true)) {\n\t\tvar filters = [];\n\n\t\tif (options.persistence && this.modExists(\"persistence\", true) && mod.persistence.config.filter) {\n\t\t\tfilters = mod.persistence.load(\"filter\");\n\n\t\t\tif (filters === false && options.initialFilter) {\n\t\t\t\tfilters = options.initialFilter;\n\t\t\t}\n\t\t} else if (options.initialFilter) {\n\t\t\tfilters = options.initialFilter;\n\t\t}\n\n\t\tmod.filter.setFilter(filters);\n\t}\n\n\tif (options.initialHeaderFilter && this.modExists(\"filter\", true)) {\n\t\toptions.initialHeaderFilter.forEach(function (item) {\n\n\t\t\tvar column = _this24.columnManager.findColumn(item.field);\n\n\t\t\tif (column) {\n\t\t\t\tmod.filter.setHeaderFilterValue(column, item.value);\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", item.field);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n\n\tif (this.modExists(\"ajax\")) {\n\t\tmod.ajax.initialize();\n\t}\n\n\tif (options.pagination && this.modExists(\"page\", true)) {\n\t\tmod.page.initialize();\n\t}\n\n\tif (options.groupBy && this.modExists(\"groupRows\", true)) {\n\t\tmod.groupRows.initialize();\n\t}\n\n\tif (this.modExists(\"keybindings\")) {\n\t\tmod.keybindings.initialize();\n\t}\n\n\tif (this.modExists(\"selectRow\")) {\n\t\tmod.selectRow.clearSelectionData(true);\n\t}\n\n\tif (options.autoResize && this.modExists(\"resizeTable\")) {\n\t\tmod.resizeTable.initialize();\n\t}\n\n\tif (this.modExists(\"clipboard\")) {\n\t\tmod.clipboard.initialize();\n\t}\n\n\tif (options.printAsHtml && this.modExists(\"print\")) {\n\t\tmod.print.initialize();\n\t}\n\n\toptions.tableBuilt.call(this);\n};\n\nTabulator.prototype._loadInitialData = function () {\n\tvar self = this;\n\n\tif (self.options.pagination && self.modExists(\"page\")) {\n\t\tself.modules.page.reset(true, true);\n\n\t\tif (self.options.pagination == \"local\") {\n\t\t\tif (self.options.data.length) {\n\t\t\t\tself.rowManager.setData(self.options.data, false, true);\n\t\t\t} else {\n\t\t\t\tif ((self.options.ajaxURL || self.options.ajaxURLGenerator) && self.modExists(\"ajax\")) {\n\t\t\t\t\tself.modules.ajax.loadData(false, true).then(function () {}).catch(function () {\n\t\t\t\t\t\tif (self.options.paginationInitialPage) {\n\t\t\t\t\t\t\tself.modules.page.setPage(self.options.paginationInitialPage);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tself.rowManager.setData(self.options.data, false, true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (self.options.paginationInitialPage) {\n\t\t\t\tself.modules.page.setPage(self.options.paginationInitialPage);\n\t\t\t}\n\t\t} else {\n\t\t\tif (self.options.ajaxURL) {\n\t\t\t\tself.modules.page.setPage(self.options.paginationInitialPage).then(function () {}).catch(function () {});\n\t\t\t} else {\n\t\t\t\tself.rowManager.setData([], false, true);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (self.options.data.length) {\n\t\t\tself.rowManager.setData(self.options.data);\n\t\t} else {\n\t\t\tif ((self.options.ajaxURL || self.options.ajaxURLGenerator) && self.modExists(\"ajax\")) {\n\t\t\t\tself.modules.ajax.loadData(false, true).then(function () {}).catch(function () {});\n\t\t\t} else {\n\t\t\t\tself.rowManager.setData(self.options.data, false, true);\n\t\t\t}\n\t\t}\n\t}\n};\n\n//deconstructor\nTabulator.prototype.destroy = function () {\n\tvar element = this.element;\n\n\tTabulator.prototype.comms.deregister(this); //deregister table from inderdevice communication\n\n\tif (this.options.reactiveData && this.modExists(\"reactiveData\", true)) {\n\t\tthis.modules.reactiveData.unwatchData();\n\t}\n\n\t//clear row data\n\tthis.rowManager.rows.forEach(function (row) {\n\t\trow.wipe();\n\t});\n\n\tthis.rowManager.rows = [];\n\tthis.rowManager.activeRows = [];\n\tthis.rowManager.displayRows = [];\n\n\t//clear event bindings\n\tif (this.options.autoResize && this.modExists(\"resizeTable\")) {\n\t\tthis.modules.resizeTable.clearBindings();\n\t}\n\n\tif (this.modExists(\"keybindings\")) {\n\t\tthis.modules.keybindings.clearBindings();\n\t}\n\n\t//clear DOM\n\twhile (element.firstChild) {\n\t\telement.removeChild(element.firstChild);\n\t}element.classList.remove(\"tabulator\");\n};\n\nTabulator.prototype._detectBrowser = function () {\n\tvar ua = navigator.userAgent || navigator.vendor || window.opera;\n\n\tif (ua.indexOf(\"Trident\") > -1) {\n\t\tthis.browser = \"ie\";\n\t\tthis.browserSlow = true;\n\t} else if (ua.indexOf(\"Edge\") > -1) {\n\t\tthis.browser = \"edge\";\n\t\tthis.browserSlow = true;\n\t} else if (ua.indexOf(\"Firefox\") > -1) {\n\t\tthis.browser = \"firefox\";\n\t\tthis.browserSlow = false;\n\t} else {\n\t\tthis.browser = \"other\";\n\t\tthis.browserSlow = false;\n\t}\n\n\tthis.browserMobile = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(ua) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(ua.substr(0, 4));\n};\n\n////////////////// Data Handling //////////////////\n\n//block table redrawing\nTabulator.prototype.blockRedraw = function () {\n\treturn this.rowManager.blockRedraw();\n};\n\n//restore table redrawing\nTabulator.prototype.restoreRedraw = function () {\n\treturn this.rowManager.restoreRedraw();\n};\n\n//local data from local file\nTabulator.prototype.setDataFromLocalFile = function (extensions) {\n\tvar _this25 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar input = document.createElement(\"input\");\n\t\tinput.type = \"file\";\n\t\tinput.accept = extensions || \".json,application/json\";\n\n\t\tinput.addEventListener(\"change\", function (e) {\n\t\t\tvar file = input.files[0],\n\t\t\t    reader = new FileReader(),\n\t\t\t    data;\n\n\t\t\treader.readAsText(file);\n\n\t\t\treader.onload = function (e) {\n\n\t\t\t\ttry {\n\t\t\t\t\tdata = JSON.parse(reader.result);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn(\"File Load Error - File contents is invalid JSON\", e);\n\t\t\t\t\treject(e);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t_this25.setData(data).then(function (data) {\n\t\t\t\t\tresolve(data);\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tresolve(err);\n\t\t\t\t});\n\t\t\t};\n\n\t\t\treader.onerror = function (e) {\n\t\t\t\tconsole.warn(\"File Load Error - Unable to read file\");\n\t\t\t\treject();\n\t\t\t};\n\t\t});\n\n\t\tinput.click();\n\t});\n};\n\n//load data\nTabulator.prototype.setData = function (data, params, config) {\n\tif (this.modExists(\"ajax\")) {\n\t\tthis.modules.ajax.blockActiveRequest();\n\t}\n\n\treturn this._setData(data, params, config, false, true);\n};\n\nTabulator.prototype._setData = function (data, params, config, inPosition, columnsChanged) {\n\tvar self = this;\n\n\tif (typeof data === \"string\") {\n\t\tif (data.indexOf(\"{\") == 0 || data.indexOf(\"[\") == 0) {\n\t\t\t//data is a json encoded string\n\t\t\treturn self.rowManager.setData(JSON.parse(data), inPosition, columnsChanged);\n\t\t} else {\n\n\t\t\tif (self.modExists(\"ajax\", true)) {\n\t\t\t\tif (params) {\n\t\t\t\t\tself.modules.ajax.setParams(params);\n\t\t\t\t}\n\n\t\t\t\tif (config) {\n\t\t\t\t\tself.modules.ajax.setConfig(config);\n\t\t\t\t}\n\n\t\t\t\tself.modules.ajax.setUrl(data);\n\n\t\t\t\tif (self.options.pagination == \"remote\" && self.modExists(\"page\", true)) {\n\t\t\t\t\tself.modules.page.reset(true, true);\n\t\t\t\t\treturn self.modules.page.setPage(1);\n\t\t\t\t} else {\n\t\t\t\t\t//assume data is url, make ajax call to url to get data\n\t\t\t\t\treturn self.modules.ajax.loadData(inPosition, columnsChanged);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (data) {\n\t\t\t//asume data is already an object\n\t\t\treturn self.rowManager.setData(data, inPosition, columnsChanged);\n\t\t} else {\n\n\t\t\t//no data provided, check if ajaxURL is present;\n\t\t\tif (self.modExists(\"ajax\") && (self.modules.ajax.getUrl || self.options.ajaxURLGenerator)) {\n\n\t\t\t\tif (self.options.pagination == \"remote\" && self.modExists(\"page\", true)) {\n\t\t\t\t\tself.modules.page.reset(true, true);\n\t\t\t\t\treturn self.modules.page.setPage(1);\n\t\t\t\t} else {\n\t\t\t\t\treturn self.modules.ajax.loadData(inPosition, columnsChanged);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//empty data\n\t\t\t\treturn self.rowManager.setData([], inPosition, columnsChanged);\n\t\t\t}\n\t\t}\n\t}\n};\n\n//clear data\nTabulator.prototype.clearData = function () {\n\tif (this.modExists(\"ajax\")) {\n\t\tthis.modules.ajax.blockActiveRequest();\n\t}\n\n\tthis.rowManager.clearData();\n};\n\n//get table data array\nTabulator.prototype.getData = function (active) {\n\n\tif (active === true) {\n\t\tconsole.warn(\"passing a boolean to the getData function is deprecated, you should now pass the string 'active'\");\n\t\tactive = \"active\";\n\t}\n\n\treturn this.rowManager.getData(active);\n};\n\n//get table data array count\nTabulator.prototype.getDataCount = function (active) {\n\n\tif (active === true) {\n\t\tconsole.warn(\"passing a boolean to the getDataCount function is deprecated, you should now pass the string 'active'\");\n\t\tactive = \"active\";\n\t}\n\n\treturn this.rowManager.getDataCount(active);\n};\n\n//search for specific row components\nTabulator.prototype.searchRows = function (field, type, value) {\n\tif (this.modExists(\"filter\", true)) {\n\t\treturn this.modules.filter.search(\"rows\", field, type, value);\n\t}\n};\n\n//search for specific data\nTabulator.prototype.searchData = function (field, type, value) {\n\tif (this.modExists(\"filter\", true)) {\n\t\treturn this.modules.filter.search(\"data\", field, type, value);\n\t}\n};\n\n//get table html\nTabulator.prototype.getHtml = function (visible, style, config) {\n\tif (this.modExists(\"export\", true)) {\n\t\treturn this.modules.export.getHtml(visible, style, config);\n\t}\n};\n\n//get print html\nTabulator.prototype.print = function (visible, style, config) {\n\tif (this.modExists(\"print\", true)) {\n\t\treturn this.modules.print.printFullscreen(visible, style, config);\n\t}\n};\n\n//retrieve Ajax URL\nTabulator.prototype.getAjaxUrl = function () {\n\tif (this.modExists(\"ajax\", true)) {\n\t\treturn this.modules.ajax.getUrl();\n\t}\n};\n\n//replace data, keeping table in position with same sort\nTabulator.prototype.replaceData = function (data, params, config) {\n\tif (this.modExists(\"ajax\")) {\n\t\tthis.modules.ajax.blockActiveRequest();\n\t}\n\n\treturn this._setData(data, params, config, true);\n};\n\n//update table data\nTabulator.prototype.updateData = function (data) {\n\tvar _this26 = this;\n\n\tvar self = this;\n\tvar responses = 0;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this26.modExists(\"ajax\")) {\n\t\t\t_this26.modules.ajax.blockActiveRequest();\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif (data) {\n\t\t\tdata.forEach(function (item) {\n\t\t\t\tvar row = self.rowManager.findRow(item[self.options.index]);\n\n\t\t\t\tif (row) {\n\t\t\t\t\tresponses++;\n\n\t\t\t\t\trow.updateData(item).then(function () {\n\t\t\t\t\t\tresponses--;\n\n\t\t\t\t\t\tif (!responses) {\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\treject(\"Update Error - No data provided\");\n\t\t}\n\t});\n};\n\nTabulator.prototype.addData = function (data, pos, index) {\n\tvar _this27 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this27.modExists(\"ajax\")) {\n\t\t\t_this27.modules.ajax.blockActiveRequest();\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif (data) {\n\t\t\t_this27.rowManager.addRows(data, pos, index).then(function (rows) {\n\t\t\t\tvar output = [];\n\n\t\t\t\trows.forEach(function (row) {\n\t\t\t\t\toutput.push(row.getComponent());\n\t\t\t\t});\n\n\t\t\t\tresolve(output);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\treject(\"Update Error - No data provided\");\n\t\t}\n\t});\n};\n\n//update table data\nTabulator.prototype.updateOrAddData = function (data) {\n\tvar _this28 = this;\n\n\tvar self = this,\n\t    rows = [],\n\t    responses = 0;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this28.modExists(\"ajax\")) {\n\t\t\t_this28.modules.ajax.blockActiveRequest();\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif (data) {\n\t\t\tdata.forEach(function (item) {\n\t\t\t\tvar row = self.rowManager.findRow(item[self.options.index]);\n\n\t\t\t\tresponses++;\n\n\t\t\t\tif (row) {\n\t\t\t\t\trow.updateData(item).then(function () {\n\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\trows.push(row.getComponent());\n\n\t\t\t\t\t\tif (!responses) {\n\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tself.rowManager.addRows(item).then(function (newRows) {\n\t\t\t\t\t\tresponses--;\n\t\t\t\t\t\trows.push(newRows[0].getComponent());\n\n\t\t\t\t\t\tif (!responses) {\n\t\t\t\t\t\t\tresolve(rows);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Update Error - No data provided\");\n\t\t\treject(\"Update Error - No data provided\");\n\t\t}\n\t});\n};\n\n//get row object\nTabulator.prototype.getRow = function (index) {\n\tvar row = this.rowManager.findRow(index);\n\n\tif (row) {\n\t\treturn row.getComponent();\n\t} else {\n\t\tconsole.warn(\"Find Error - No matching row found:\", index);\n\t\treturn false;\n\t}\n};\n\n//get row object\nTabulator.prototype.getRowFromPosition = function (position, active) {\n\tvar row = this.rowManager.getRowFromPosition(position, active);\n\n\tif (row) {\n\t\treturn row.getComponent();\n\t} else {\n\t\tconsole.warn(\"Find Error - No matching row found:\", position);\n\t\treturn false;\n\t}\n};\n\n//delete row from table\nTabulator.prototype.deleteRow = function (index) {\n\tvar _this29 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar self = _this29,\n\t\t    count = 0,\n\t\t    successCount = 0,\n\t\t    foundRows = [];\n\n\t\tfunction doneCheck() {\n\t\t\tcount++;\n\n\t\t\tif (count == index.length) {\n\t\t\t\tif (successCount) {\n\t\t\t\t\tself.rowManager.reRenderInPosition();\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!Array.isArray(index)) {\n\t\t\tindex = [index];\n\t\t}\n\n\t\t//find matching rows\n\t\tindex.forEach(function (item) {\n\t\t\tvar row = _this29.rowManager.findRow(item, true);\n\n\t\t\tif (row) {\n\t\t\t\tfoundRows.push(row);\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Delete Error - No matching row found:\", item);\n\t\t\t\treject(\"Delete Error - No matching row found\");\n\t\t\t\tdoneCheck();\n\t\t\t}\n\t\t});\n\n\t\t//sort rows into correct order to ensure smooth delete from table\n\t\tfoundRows.sort(function (a, b) {\n\t\t\treturn _this29.rowManager.rows.indexOf(a) > _this29.rowManager.rows.indexOf(b) ? 1 : -1;\n\t\t});\n\n\t\tfoundRows.forEach(function (row) {\n\t\t\trow.delete().then(function () {\n\t\t\t\tsuccessCount++;\n\t\t\t\tdoneCheck();\n\t\t\t}).catch(function (err) {\n\t\t\t\tdoneCheck();\n\t\t\t\treject(err);\n\t\t\t});\n\t\t});\n\t});\n};\n\n//add row to table\nTabulator.prototype.addRow = function (data, pos, index) {\n\tvar _this30 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\t_this30.rowManager.addRows(data, pos, index).then(function (rows) {\n\t\t\t//recalc column calculations if present\n\t\t\tif (_this30.modExists(\"columnCalcs\")) {\n\t\t\t\t_this30.modules.columnCalcs.recalc(_this30.rowManager.activeRows);\n\t\t\t}\n\n\t\t\tresolve(rows[0].getComponent());\n\t\t});\n\t});\n};\n\n//update a row if it exitsts otherwise create it\nTabulator.prototype.updateOrAddRow = function (index, data) {\n\tvar _this31 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar row = _this31.rowManager.findRow(index);\n\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif (row) {\n\t\t\trow.updateData(data).then(function () {\n\t\t\t\t//recalc column calculations if present\n\t\t\t\tif (_this31.modExists(\"columnCalcs\")) {\n\t\t\t\t\t_this31.modules.columnCalcs.recalc(_this31.rowManager.activeRows);\n\t\t\t\t}\n\n\t\t\t\tresolve(row.getComponent());\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\trow = _this31.rowManager.addRows(data).then(function (rows) {\n\t\t\t\t//recalc column calculations if present\n\t\t\t\tif (_this31.modExists(\"columnCalcs\")) {\n\t\t\t\t\t_this31.modules.columnCalcs.recalc(_this31.rowManager.activeRows);\n\t\t\t\t}\n\n\t\t\t\tresolve(rows[0].getComponent());\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t}\n\t});\n};\n\n//update row data\nTabulator.prototype.updateRow = function (index, data) {\n\tvar _this32 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar row = _this32.rowManager.findRow(index);\n\n\t\tif (typeof data === \"string\") {\n\t\t\tdata = JSON.parse(data);\n\t\t}\n\n\t\tif (row) {\n\t\t\trow.updateData(data).then(function () {\n\t\t\t\tresolve(row.getComponent());\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Update Error - No matching row found:\", index);\n\t\t\treject(\"Update Error - No matching row found\");\n\t\t}\n\t});\n};\n\n//scroll to row in DOM\nTabulator.prototype.scrollToRow = function (index, position, ifVisible) {\n\tvar _this33 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar row = _this33.rowManager.findRow(index);\n\n\t\tif (row) {\n\t\t\t_this33.rowManager.scrollToRow(row, position, ifVisible).then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Scroll Error - No matching row found:\", index);\n\t\t\treject(\"Scroll Error - No matching row found\");\n\t\t}\n\t});\n};\n\nTabulator.prototype.moveRow = function (from, to, after) {\n\tvar fromRow = this.rowManager.findRow(from);\n\n\tif (fromRow) {\n\t\tfromRow.moveToRow(to, after);\n\t} else {\n\t\tconsole.warn(\"Move Error - No matching row found:\", from);\n\t}\n};\n\nTabulator.prototype.getRows = function (active) {\n\n\tif (active === true) {\n\t\tconsole.warn(\"passing a boolean to the getRows function is deprecated, you should now pass the string 'active'\");\n\t\tactive = \"active\";\n\t}\n\n\treturn this.rowManager.getComponents(active);\n};\n\n//get position of row in table\nTabulator.prototype.getRowPosition = function (index, active) {\n\tvar row = this.rowManager.findRow(index);\n\n\tif (row) {\n\t\treturn this.rowManager.getRowPosition(row, active);\n\t} else {\n\t\tconsole.warn(\"Position Error - No matching row found:\", index);\n\t\treturn false;\n\t}\n};\n\n//copy table data to clipboard\nTabulator.prototype.copyToClipboard = function (selector) {\n\tif (this.modExists(\"clipboard\", true)) {\n\t\tthis.modules.clipboard.copy(selector);\n\t}\n};\n\n/////////////// Column Functions  ///////////////\n\nTabulator.prototype.setColumns = function (definition) {\n\tthis.columnManager.setColumns(definition);\n};\n\nTabulator.prototype.getColumns = function (structured) {\n\treturn this.columnManager.getComponents(structured);\n};\n\nTabulator.prototype.getColumn = function (field) {\n\tvar col = this.columnManager.findColumn(field);\n\n\tif (col) {\n\t\treturn col.getComponent();\n\t} else {\n\t\tconsole.warn(\"Find Error - No matching column found:\", field);\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getColumnDefinitions = function () {\n\treturn this.columnManager.getDefinitionTree();\n};\n\nTabulator.prototype.getColumnLayout = function () {\n\tif (this.modExists(\"persistence\", true)) {\n\t\treturn this.modules.persistence.parseColumns(this.columnManager.getColumns());\n\t}\n};\n\nTabulator.prototype.setColumnLayout = function (layout) {\n\tif (this.modExists(\"persistence\", true)) {\n\t\tthis.columnManager.setColumns(this.modules.persistence.mergeDefinition(this.options.columns, layout));\n\t\treturn true;\n\t}\n\treturn false;\n};\n\nTabulator.prototype.showColumn = function (field) {\n\tvar column = this.columnManager.findColumn(field);\n\n\tif (column) {\n\t\tcolumn.show();\n\n\t\tif (this.options.responsiveLayout && this.modExists(\"responsiveLayout\", true)) {\n\t\t\tthis.modules.responsiveLayout.update();\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Column Show Error - No matching column found:\", field);\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.hideColumn = function (field) {\n\tvar column = this.columnManager.findColumn(field);\n\n\tif (column) {\n\t\tcolumn.hide();\n\n\t\tif (this.options.responsiveLayout && this.modExists(\"responsiveLayout\", true)) {\n\t\t\tthis.modules.responsiveLayout.update();\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Column Hide Error - No matching column found:\", field);\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.toggleColumn = function (field) {\n\tvar column = this.columnManager.findColumn(field);\n\n\tif (column) {\n\t\tif (column.visible) {\n\t\t\tcolumn.hide();\n\t\t} else {\n\t\t\tcolumn.show();\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Column Visibility Toggle Error - No matching column found:\", field);\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.addColumn = function (definition, before, field) {\n\tvar _this34 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar column = _this34.columnManager.findColumn(field);\n\n\t\t_this34.columnManager.addColumn(definition, before, column).then(function (column) {\n\t\t\tresolve(column.getComponent());\n\t\t}).catch(function (err) {\n\t\t\treject(err);\n\t\t});\n\t});\n};\n\nTabulator.prototype.deleteColumn = function (field) {\n\tvar _this35 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar column = _this35.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\tcolumn.delete().then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Column Delete Error - No matching column found:\", field);\n\t\t\treject();\n\t\t}\n\t});\n};\n\nTabulator.prototype.updateColumnDefinition = function (field, definition) {\n\tvar _this36 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar column = _this36.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\tcolumn.updateDefinition(definition).then(function (col) {\n\t\t\t\tresolve(col);\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Column Update Error - No matching column found:\", field);\n\t\t\treject();\n\t\t}\n\t});\n};\n\nTabulator.prototype.moveColumn = function (from, to, after) {\n\tvar fromColumn = this.columnManager.findColumn(from);\n\tvar toColumn = this.columnManager.findColumn(to);\n\n\tif (fromColumn) {\n\t\tif (toColumn) {\n\t\t\tthis.columnManager.moveColumn(fromColumn, toColumn, after);\n\t\t} else {\n\t\t\tconsole.warn(\"Move Error - No matching column found:\", toColumn);\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Move Error - No matching column found:\", from);\n\t}\n};\n\n//scroll to column in DOM\nTabulator.prototype.scrollToColumn = function (field, position, ifVisible) {\n\tvar _this37 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar column = _this37.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\t_this37.columnManager.scrollToColumn(column, position, ifVisible).then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function (err) {\n\t\t\t\treject(err);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Scroll Error - No matching column found:\", field);\n\t\t\treject(\"Scroll Error - No matching column found\");\n\t\t}\n\t});\n};\n\n//////////// Localization Functions  ////////////\nTabulator.prototype.setLocale = function (locale) {\n\tthis.modules.localize.setLocale(locale);\n};\n\nTabulator.prototype.getLocale = function () {\n\treturn this.modules.localize.getLocale();\n};\n\nTabulator.prototype.getLang = function (locale) {\n\treturn this.modules.localize.getLang(locale);\n};\n\n//////////// General Public Functions ////////////\n\n//redraw list without updating data\nTabulator.prototype.redraw = function (force) {\n\tthis.columnManager.redraw(force);\n\tthis.rowManager.redraw(force);\n};\n\nTabulator.prototype.setHeight = function (height) {\n\n\tif (this.rowManager.renderMode !== \"classic\") {\n\t\tthis.options.height = isNaN(height) ? height : height + \"px\";\n\t\tthis.element.style.height = this.options.height;\n\t\tthis.rowManager.setRenderMode();\n\t\tthis.rowManager.redraw();\n\t} else {\n\t\tconsole.warn(\"setHeight function is not available in classic render mode\");\n\t}\n};\n\n///////////////////// Sorting ////////////////////\n\n//trigger sort\nTabulator.prototype.setSort = function (sortList, dir) {\n\tif (this.modExists(\"sort\", true)) {\n\t\tthis.modules.sort.setSort(sortList, dir);\n\t\tthis.rowManager.sorterRefresh();\n\t}\n};\n\nTabulator.prototype.getSorters = function () {\n\tif (this.modExists(\"sort\", true)) {\n\t\treturn this.modules.sort.getSort();\n\t}\n};\n\nTabulator.prototype.clearSort = function () {\n\tif (this.modExists(\"sort\", true)) {\n\t\tthis.modules.sort.clear();\n\t\tthis.rowManager.sorterRefresh();\n\t}\n};\n\n///////////////////// Filtering ////////////////////\n\n//set standard filters\nTabulator.prototype.setFilter = function (field, type, value, params) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.modules.filter.setFilter(field, type, value, params);\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n//set standard filters\nTabulator.prototype.refreshFilter = function () {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n//add filter to array\nTabulator.prototype.addFilter = function (field, type, value, params) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.modules.filter.addFilter(field, type, value, params);\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n//get all filters\nTabulator.prototype.getFilters = function (all) {\n\tif (this.modExists(\"filter\", true)) {\n\t\treturn this.modules.filter.getFilters(all);\n\t}\n};\n\nTabulator.prototype.setHeaderFilterFocus = function (field) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tvar column = this.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\tthis.modules.filter.setHeaderFilterFocus(column);\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Focus Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\nTabulator.prototype.getHeaderFilterValue = function (field) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tvar column = this.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\treturn this.modules.filter.getHeaderFilterValue(column);\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t}\n\t}\n};\n\nTabulator.prototype.setHeaderFilterValue = function (field, value) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tvar column = this.columnManager.findColumn(field);\n\n\t\tif (column) {\n\t\t\tthis.modules.filter.setHeaderFilterValue(column, value);\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No matching column found:\", field);\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\nTabulator.prototype.getHeaderFilters = function () {\n\tif (this.modExists(\"filter\", true)) {\n\t\treturn this.modules.filter.getHeaderFilters();\n\t}\n};\n\n//remove filter from array\nTabulator.prototype.removeFilter = function (field, type, value) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.modules.filter.removeFilter(field, type, value);\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n//clear filters\nTabulator.prototype.clearFilter = function (all) {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.modules.filter.clearFilter(all);\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n//clear header filters\nTabulator.prototype.clearHeaderFilter = function () {\n\tif (this.modExists(\"filter\", true)) {\n\t\tthis.modules.filter.clearHeaderFilter();\n\t\tthis.rowManager.filterRefresh();\n\t}\n};\n\n///////////////////// select ////////////////////\nTabulator.prototype.selectRow = function (rows) {\n\tif (this.modExists(\"selectRow\", true)) {\n\t\tif (rows === true) {\n\t\t\tconsole.warn(\"passing a boolean to the selectRowselectRow function is deprecated, you should now pass the string 'active'\");\n\t\t\trows = \"active\";\n\t\t}\n\t\tthis.modules.selectRow.selectRows(rows);\n\t}\n};\n\nTabulator.prototype.deselectRow = function (rows) {\n\tif (this.modExists(\"selectRow\", true)) {\n\t\tthis.modules.selectRow.deselectRows(rows);\n\t}\n};\n\nTabulator.prototype.toggleSelectRow = function (row) {\n\tif (this.modExists(\"selectRow\", true)) {\n\t\tthis.modules.selectRow.toggleRow(row);\n\t}\n};\n\nTabulator.prototype.getSelectedRows = function () {\n\tif (this.modExists(\"selectRow\", true)) {\n\t\treturn this.modules.selectRow.getSelectedRows();\n\t}\n};\n\nTabulator.prototype.getSelectedData = function () {\n\tif (this.modExists(\"selectRow\", true)) {\n\t\treturn this.modules.selectRow.getSelectedData();\n\t}\n};\n\n///////////////////// validation  ////////////////////\nTabulator.prototype.getInvalidCells = function () {\n\tif (this.modExists(\"validate\", true)) {\n\t\treturn this.modules.validate.getInvalidCells();\n\t}\n};\n\nTabulator.prototype.clearCellValidation = function (cells) {\n\tvar _this38 = this;\n\n\tif (this.modExists(\"validate\", true)) {\n\n\t\tif (!cells) {\n\t\t\tcells = this.modules.validate.getInvalidCells();\n\t\t}\n\n\t\tif (!Array.isArray(cells)) {\n\t\t\tcells = [cells];\n\t\t}\n\n\t\tcells.forEach(function (cell) {\n\t\t\t_this38.modules.validate.clearValidation(cell._getSelf());\n\t\t});\n\t}\n};\n\nTabulator.prototype.validate = function (cells) {\n\tvar output = [];\n\n\t//clear row data\n\tthis.rowManager.rows.forEach(function (row) {\n\t\tvar valid = row.validate();\n\n\t\tif (valid !== true) {\n\t\t\toutput = output.concat(valid);\n\t\t}\n\t});\n\n\treturn output.length ? output : true;\n};\n\n//////////// Pagination Functions  ////////////\n\nTabulator.prototype.setMaxPage = function (max) {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\tthis.modules.page.setMaxPage(max);\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.setPage = function (page) {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\treturn this.modules.page.setPage(page);\n\t} else {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\treject();\n\t\t});\n\t}\n};\n\nTabulator.prototype.setPageToRow = function (row) {\n\tvar _this39 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this39.options.pagination && _this39.modExists(\"page\")) {\n\t\t\trow = _this39.rowManager.findRow(row);\n\n\t\t\tif (row) {\n\t\t\t\t_this39.modules.page.setPageToRow(row).then(function () {\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(function () {\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treject();\n\t\t\t}\n\t\t} else {\n\t\t\treject();\n\t\t}\n\t});\n};\n\nTabulator.prototype.setPageSize = function (size) {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\tthis.modules.page.setPageSize(size);\n\t\tthis.modules.page.setPage(1).then(function () {}).catch(function () {});\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getPageSize = function () {\n\tif (this.options.pagination && this.modExists(\"page\", true)) {\n\t\treturn this.modules.page.getPageSize();\n\t}\n};\n\nTabulator.prototype.previousPage = function () {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\tthis.modules.page.previousPage();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.nextPage = function () {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\tthis.modules.page.nextPage();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getPage = function () {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\treturn this.modules.page.getPage();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getPageMax = function () {\n\tif (this.options.pagination && this.modExists(\"page\")) {\n\t\treturn this.modules.page.getPageMax();\n\t} else {\n\t\treturn false;\n\t}\n};\n\n///////////////// Grouping Functions ///////////////\n\nTabulator.prototype.setGroupBy = function (groups) {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\tthis.options.groupBy = groups;\n\t\tthis.modules.groupRows.initialize();\n\t\tthis.rowManager.refreshActiveData(\"display\");\n\n\t\tif (this.options.persistence && this.modExists(\"persistence\", true) && this.modules.persistence.config.group) {\n\t\t\tthis.modules.persistence.save(\"group\");\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.setGroupValues = function (groupValues) {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\tthis.options.groupValues = groupValues;\n\t\tthis.modules.groupRows.initialize();\n\t\tthis.rowManager.refreshActiveData(\"display\");\n\n\t\tif (this.options.persistence && this.modExists(\"persistence\", true) && this.modules.persistence.config.group) {\n\t\t\tthis.modules.persistence.save(\"group\");\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.setGroupStartOpen = function (values) {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\tthis.options.groupStartOpen = values;\n\t\tthis.modules.groupRows.initialize();\n\t\tif (this.options.groupBy) {\n\t\t\tthis.rowManager.refreshActiveData(\"group\");\n\n\t\t\tif (this.options.persistence && this.modExists(\"persistence\", true) && this.modules.persistence.config.group) {\n\t\t\t\tthis.modules.persistence.save(\"group\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.setGroupHeader = function (values) {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\tthis.options.groupHeader = values;\n\t\tthis.modules.groupRows.initialize();\n\t\tif (this.options.groupBy) {\n\t\t\tthis.rowManager.refreshActiveData(\"group\");\n\n\t\t\tif (this.options.persistence && this.modExists(\"persistence\", true) && this.modules.persistence.config.group) {\n\t\t\t\tthis.modules.persistence.save(\"group\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Grouping Update - cant refresh view, no groups have been set\");\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getGroups = function (values) {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\treturn this.modules.groupRows.getGroups(true);\n\t} else {\n\t\treturn false;\n\t}\n};\n\n// get grouped table data in the same format as getData()\nTabulator.prototype.getGroupedData = function () {\n\tif (this.modExists(\"groupRows\", true)) {\n\t\treturn this.options.groupBy ? this.modules.groupRows.getGroupedData() : this.getData();\n\t}\n};\n\nTabulator.prototype.getEditedCells = function () {\n\tif (this.modExists(\"edit\", true)) {\n\t\treturn this.modules.edit.getEditedCells();\n\t}\n};\n\nTabulator.prototype.clearCellEdited = function (cells) {\n\tvar _this40 = this;\n\n\tif (this.modExists(\"edit\", true)) {\n\n\t\tif (!cells) {\n\t\t\tcells = this.modules.edit.getEditedCells();\n\t\t}\n\n\t\tif (!Array.isArray(cells)) {\n\t\t\tcells = [cells];\n\t\t}\n\n\t\tcells.forEach(function (cell) {\n\t\t\t_this40.modules.edit.clearEdited(cell._getSelf());\n\t\t});\n\t}\n};\n\n///////////////// Column Calculation Functions ///////////////\nTabulator.prototype.getCalcResults = function () {\n\tif (this.modExists(\"columnCalcs\", true)) {\n\t\treturn this.modules.columnCalcs.getResults();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.recalc = function () {\n\tif (this.modExists(\"columnCalcs\", true)) {\n\t\tthis.modules.columnCalcs.recalcAll(this.rowManager.activeRows);\n\t}\n};\n\n/////////////// Navigation Management //////////////\n\nTabulator.prototype.navigatePrev = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\treturn cell.nav().prev();\n\t\t}\n\t}\n\n\treturn false;\n};\n\nTabulator.prototype.navigateNext = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\treturn cell.nav().next();\n\t\t}\n\t}\n\n\treturn false;\n};\n\nTabulator.prototype.navigateLeft = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\te.preventDefault();\n\t\t\treturn cell.nav().left();\n\t\t}\n\t}\n\n\treturn false;\n};\n\nTabulator.prototype.navigateRight = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\te.preventDefault();\n\t\t\treturn cell.nav().right();\n\t\t}\n\t}\n\n\treturn false;\n};\n\nTabulator.prototype.navigateUp = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\te.preventDefault();\n\t\t\treturn cell.nav().up();\n\t\t}\n\t}\n\n\treturn false;\n};\n\nTabulator.prototype.navigateDown = function () {\n\tvar cell = false;\n\n\tif (this.modExists(\"edit\", true)) {\n\t\tcell = this.modules.edit.currentCell;\n\n\t\tif (cell) {\n\t\t\te.preventDefault();\n\t\t\treturn cell.nav().down();\n\t\t}\n\t}\n\n\treturn false;\n};\n\n/////////////// History Management //////////////\nTabulator.prototype.undo = function () {\n\tif (this.options.history && this.modExists(\"history\", true)) {\n\t\treturn this.modules.history.undo();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.redo = function () {\n\tif (this.options.history && this.modExists(\"history\", true)) {\n\t\treturn this.modules.history.redo();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getHistoryUndoSize = function () {\n\tif (this.options.history && this.modExists(\"history\", true)) {\n\t\treturn this.modules.history.getHistoryUndoSize();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.getHistoryRedoSize = function () {\n\tif (this.options.history && this.modExists(\"history\", true)) {\n\t\treturn this.modules.history.getHistoryRedoSize();\n\t} else {\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.clearHistory = function () {\n\tif (this.options.history && this.modExists(\"history\", true)) {\n\t\treturn this.modules.history.clear();\n\t} else {\n\t\treturn false;\n\t}\n};\n\n/////////////// Download Management //////////////\n\nTabulator.prototype.download = function (type, filename, options, active) {\n\tif (this.modExists(\"download\", true)) {\n\t\tthis.modules.download.download(type, filename, options, active);\n\t}\n};\n\nTabulator.prototype.downloadToTab = function (type, filename, options, active) {\n\tif (this.modExists(\"download\", true)) {\n\t\tthis.modules.download.download(type, filename, options, active, true);\n\t}\n};\n\n/////////// Inter Table Communications ///////////\n\nTabulator.prototype.tableComms = function (table, module, action, data) {\n\tthis.modules.comms.receive(table, module, action, data);\n};\n\n////////////// Extension Management //////////////\n\n//object to hold module\nTabulator.prototype.moduleBindings = {};\n\n//extend module\nTabulator.prototype.extendModule = function (name, property, values) {\n\n\tif (Tabulator.prototype.moduleBindings[name]) {\n\t\tvar source = Tabulator.prototype.moduleBindings[name].prototype[property];\n\n\t\tif (source) {\n\t\t\tif ((typeof values === 'undefined' ? 'undefined' : _typeof(values)) == \"object\") {\n\t\t\t\tfor (var key in values) {\n\t\t\t\t\tsource[key] = values[key];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Module Error - Invalid value type, it must be an object\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Module Error - property does not exist:\", property);\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Module Error - module does not exist:\", name);\n\t}\n};\n\n//add module to tabulator\nTabulator.prototype.registerModule = function (name, module) {\n\tvar self = this;\n\tTabulator.prototype.moduleBindings[name] = module;\n};\n\n//ensure that module are bound to instantiated function\nTabulator.prototype.bindModules = function () {\n\tthis.modules = {};\n\n\tfor (var name in Tabulator.prototype.moduleBindings) {\n\t\tthis.modules[name] = new Tabulator.prototype.moduleBindings[name](this);\n\t}\n};\n\n//Check for module\nTabulator.prototype.modExists = function (plugin, required) {\n\tif (this.modules[plugin]) {\n\t\treturn true;\n\t} else {\n\t\tif (required) {\n\t\t\tconsole.error(\"Tabulator Module Not Installed: \" + plugin);\n\t\t}\n\t\treturn false;\n\t}\n};\n\nTabulator.prototype.helpers = {\n\n\telVisible: function elVisible(el) {\n\t\treturn !(el.offsetWidth <= 0 && el.offsetHeight <= 0);\n\t},\n\n\telOffset: function elOffset(el) {\n\t\tvar box = el.getBoundingClientRect();\n\n\t\treturn {\n\t\t\ttop: box.top + window.pageYOffset - document.documentElement.clientTop,\n\t\t\tleft: box.left + window.pageXOffset - document.documentElement.clientLeft\n\t\t};\n\t},\n\n\tdeepClone: function deepClone(obj) {\n\t\tvar clone = Object.assign(Array.isArray(obj) ? [] : {}, obj);\n\n\t\tfor (var i in obj) {\n\t\t\tif (obj[i] != null && _typeof(obj[i]) === \"object\") {\n\t\t\t\tif (obj[i] instanceof Date) {\n\t\t\t\t\tclone[i] = new Date(obj[i]);\n\t\t\t\t} else {\n\t\t\t\t\tclone[i] = this.deepClone(obj[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn clone;\n\t}\n};\n\nTabulator.prototype.comms = {\n\ttables: [],\n\tregister: function register(table) {\n\t\tTabulator.prototype.comms.tables.push(table);\n\t},\n\tderegister: function deregister(table) {\n\t\tvar index = Tabulator.prototype.comms.tables.indexOf(table);\n\n\t\tif (index > -1) {\n\t\t\tTabulator.prototype.comms.tables.splice(index, 1);\n\t\t}\n\t},\n\tlookupTable: function lookupTable(query, silent) {\n\t\tvar results = [],\n\t\t    matches,\n\t\t    match;\n\n\t\tif (typeof query === \"string\") {\n\t\t\tmatches = document.querySelectorAll(query);\n\n\t\t\tif (matches.length) {\n\t\t\t\tfor (var i = 0; i < matches.length; i++) {\n\t\t\t\t\tmatch = Tabulator.prototype.comms.matchElement(matches[i]);\n\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\tresults.push(match);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (typeof HTMLElement !== \"undefined\" && query instanceof HTMLElement || query instanceof Tabulator) {\n\t\t\tmatch = Tabulator.prototype.comms.matchElement(query);\n\n\t\t\tif (match) {\n\t\t\t\tresults.push(match);\n\t\t\t}\n\t\t} else if (Array.isArray(query)) {\n\t\t\tquery.forEach(function (item) {\n\t\t\t\tresults = results.concat(Tabulator.prototype.comms.lookupTable(item));\n\t\t\t});\n\t\t} else {\n\t\t\tif (!silent) {\n\t\t\t\tconsole.warn(\"Table Connection Error - Invalid Selector\", query);\n\t\t\t}\n\t\t}\n\n\t\treturn results;\n\t},\n\tmatchElement: function matchElement(element) {\n\t\treturn Tabulator.prototype.comms.tables.find(function (table) {\n\t\t\treturn element instanceof Tabulator ? table === element : table.element === element;\n\t\t});\n\t}\n};\n\nTabulator.prototype.findTable = function (query) {\n\tvar results = Tabulator.prototype.comms.lookupTable(query, true);\n\treturn Array.isArray(results) && !results.length ? false : results;\n};\n\nvar Layout = function Layout(table) {\n\n\tthis.table = table;\n\n\tthis.mode = null;\n};\n\n//initialize layout system\n\nLayout.prototype.initialize = function (layout) {\n\n\tif (this.modes[layout]) {\n\n\t\tthis.mode = layout;\n\t} else {\n\n\t\tconsole.warn(\"Layout Error - invalid mode set, defaulting to 'fitData' : \" + layout);\n\n\t\tthis.mode = 'fitData';\n\t}\n\n\tthis.table.element.setAttribute(\"tabulator-layout\", this.mode);\n};\n\nLayout.prototype.getMode = function () {\n\n\treturn this.mode;\n};\n\n//trigger table layout\n\nLayout.prototype.layout = function () {\n\n\tthis.modes[this.mode].call(this, this.table.columnManager.columnsByIndex);\n\n\tif (this.mode.indexOf(\"fitData\") === 0 && this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.columns) {\n\n\t\tthis.table.modules.persistence.save(\"columns\");\n\t}\n};\n\n//layout render functions\n\nLayout.prototype.modes = {\n\n\t//resize columns to fit data they contain\n\n\t\"fitData\": function fitData(columns) {\n\n\t\tif (this.table.options.virtualDomHoz) {\n\n\t\t\tthis.table.vdomHoz.fitDataLayoutOverride();\n\t\t} else {\n\n\t\t\tcolumns.forEach(function (column) {\n\n\t\t\t\tcolumn.reinitializeWidth();\n\t\t\t});\n\t\t}\n\n\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\t},\n\n\t//resize columns to fit data they contain and stretch row to fill table\n\n\t\"fitDataFill\": function fitDataFill(columns) {\n\n\t\tcolumns.forEach(function (column) {\n\n\t\t\tcolumn.reinitializeWidth();\n\t\t});\n\n\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\t},\n\n\t//resize columns to fit data they contain\n\n\t\"fitDataTable\": function fitDataTable(columns) {\n\n\t\tcolumns.forEach(function (column) {\n\n\t\t\tcolumn.reinitializeWidth();\n\t\t});\n\n\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\t},\n\n\t//resize columns to fit data the contain and stretch last column to fill table\n\n\t\"fitDataStretch\": function fitDataStretch(columns) {\n\t\tvar _this41 = this;\n\n\t\tvar colsWidth = 0,\n\t\t    tableWidth = this.table.rowManager.element.clientWidth,\n\t\t    gap = 0,\n\t\t    lastCol = false;\n\n\t\tcolumns.forEach(function (column, i) {\n\n\t\t\tif (!column.widthFixed) {\n\n\t\t\t\tcolumn.reinitializeWidth();\n\t\t\t}\n\n\t\t\tif (_this41.table.options.responsiveLayout ? column.modules.responsive.visible : column.visible) {\n\n\t\t\t\tlastCol = column;\n\t\t\t}\n\n\t\t\tif (column.visible) {\n\n\t\t\t\tcolsWidth += column.getWidth();\n\t\t\t}\n\t\t});\n\n\t\tif (lastCol) {\n\n\t\t\tgap = tableWidth - colsWidth + lastCol.getWidth();\n\n\t\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\t\tlastCol.setWidth(0);\n\n\t\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t\t}\n\n\t\t\tif (gap > 0) {\n\n\t\t\t\tlastCol.setWidth(gap);\n\t\t\t} else {\n\n\t\t\t\tlastCol.reinitializeWidth();\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t\t}\n\t\t}\n\t},\n\n\t//resize columns to fit\n\n\t\"fitColumns\": function fitColumns(columns) {\n\n\t\tvar self = this;\n\n\t\tvar totalWidth = self.table.element.clientWidth; //table element width\n\n\t\tvar fixedWidth = 0; //total width of columns with a defined width\n\n\t\tvar flexWidth = 0; //total width available to flexible columns\n\n\t\tvar flexGrowUnits = 0; //total number of widthGrow blocks accross all columns\n\n\t\tvar flexColWidth = 0; //desired width of flexible columns\n\n\t\tvar flexColumns = []; //array of flexible width columns\n\n\t\tvar fixedShrinkColumns = []; //array of fixed width columns that can shrink\n\n\t\tvar flexShrinkUnits = 0; //total number of widthShrink blocks accross all columns\n\n\t\tvar overflowWidth = 0; //horizontal overflow width\n\n\t\tvar gapFill = 0; //number of pixels to be added to final column to close and half pixel gaps\n\n\n\t\tfunction calcWidth(width) {\n\n\t\t\tvar colWidth;\n\n\t\t\tif (typeof width == \"string\") {\n\n\t\t\t\tif (width.indexOf(\"%\") > -1) {\n\n\t\t\t\t\tcolWidth = totalWidth / 100 * parseInt(width);\n\t\t\t\t} else {\n\n\t\t\t\t\tcolWidth = parseInt(width);\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\tcolWidth = width;\n\t\t\t}\n\n\t\t\treturn colWidth;\n\t\t}\n\n\t\t//ensure columns resize to take up the correct amount of space\n\n\t\tfunction scaleColumns(columns, freeSpace, colWidth, shrinkCols) {\n\n\t\t\tvar oversizeCols = [],\n\t\t\t    oversizeSpace = 0,\n\t\t\t    remainingSpace = 0,\n\t\t\t    nextColWidth = 0,\n\t\t\t    remainingFlexGrowUnits = flexGrowUnits,\n\t\t\t    gap = 0,\n\t\t\t    changeUnits = 0,\n\t\t\t    undersizeCols = [];\n\n\t\t\tfunction calcGrow(col) {\n\n\t\t\t\treturn colWidth * (col.column.definition.widthGrow || 1);\n\t\t\t}\n\n\t\t\tfunction calcShrink(col) {\n\n\t\t\t\treturn calcWidth(col.width) - colWidth * (col.column.definition.widthShrink || 0);\n\t\t\t}\n\n\t\t\tcolumns.forEach(function (col, i) {\n\n\t\t\t\tvar width = shrinkCols ? calcShrink(col) : calcGrow(col);\n\n\t\t\t\tif (col.column.minWidth >= width) {\n\n\t\t\t\t\toversizeCols.push(col);\n\t\t\t\t} else {\n\n\t\t\t\t\tif (col.column.maxWidth && col.column.maxWidth < width) {\n\n\t\t\t\t\t\tcol.width = col.column.maxWidth;\n\n\t\t\t\t\t\tfreeSpace -= col.column.maxWidth;\n\n\t\t\t\t\t\tremainingFlexGrowUnits -= shrinkCols ? col.column.definition.widthShrink || 1 : col.column.definition.widthGrow || 1;\n\n\t\t\t\t\t\tif (remainingFlexGrowUnits) {\n\n\t\t\t\t\t\t\tcolWidth = Math.floor(freeSpace / remainingFlexGrowUnits);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tundersizeCols.push(col);\n\n\t\t\t\t\t\tchangeUnits += shrinkCols ? col.column.definition.widthShrink || 1 : col.column.definition.widthGrow || 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (oversizeCols.length) {\n\n\t\t\t\toversizeCols.forEach(function (col) {\n\n\t\t\t\t\toversizeSpace += shrinkCols ? col.width - col.column.minWidth : col.column.minWidth;\n\n\t\t\t\t\tcol.width = col.column.minWidth;\n\t\t\t\t});\n\n\t\t\t\tremainingSpace = freeSpace - oversizeSpace;\n\n\t\t\t\tnextColWidth = changeUnits ? Math.floor(remainingSpace / changeUnits) : remainingSpace;\n\n\t\t\t\tgap = remainingSpace - nextColWidth * changeUnits;\n\n\t\t\t\tgap += scaleColumns(undersizeCols, remainingSpace, nextColWidth, shrinkCols);\n\t\t\t} else {\n\n\t\t\t\tgap = changeUnits ? freeSpace - Math.floor(freeSpace / changeUnits) * changeUnits : freeSpace;\n\n\t\t\t\tundersizeCols.forEach(function (column) {\n\n\t\t\t\t\tcolumn.width = shrinkCols ? calcShrink(column) : calcGrow(column);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn gap;\n\t\t}\n\n\t\tif (this.table.options.responsiveLayout && this.table.modExists(\"responsiveLayout\", true)) {\n\n\t\t\tthis.table.modules.responsiveLayout.update();\n\t\t}\n\n\t\t//adjust for vertical scrollbar if present\n\n\t\tif (this.table.rowManager.element.scrollHeight > this.table.rowManager.element.clientHeight) {\n\n\t\t\ttotalWidth -= this.table.rowManager.element.offsetWidth - this.table.rowManager.element.clientWidth;\n\t\t}\n\n\t\tcolumns.forEach(function (column) {\n\n\t\t\tvar width, minWidth, colWidth;\n\n\t\t\tif (column.visible) {\n\n\t\t\t\twidth = column.definition.width;\n\n\t\t\t\tminWidth = parseInt(column.minWidth);\n\n\t\t\t\tif (width) {\n\n\t\t\t\t\tcolWidth = calcWidth(width);\n\n\t\t\t\t\tfixedWidth += colWidth > minWidth ? colWidth : minWidth;\n\n\t\t\t\t\tif (column.definition.widthShrink) {\n\n\t\t\t\t\t\tfixedShrinkColumns.push({\n\n\t\t\t\t\t\t\tcolumn: column,\n\n\t\t\t\t\t\t\twidth: colWidth > minWidth ? colWidth : minWidth\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tflexShrinkUnits += column.definition.widthShrink;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tflexColumns.push({\n\n\t\t\t\t\t\tcolumn: column,\n\n\t\t\t\t\t\twidth: 0\n\n\t\t\t\t\t});\n\n\t\t\t\t\tflexGrowUnits += column.definition.widthGrow || 1;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//calculate available space\n\n\t\tflexWidth = totalWidth - fixedWidth;\n\n\t\t//calculate correct column size\n\n\t\tflexColWidth = Math.floor(flexWidth / flexGrowUnits);\n\n\t\t//generate column widths\n\n\t\tvar gapFill = scaleColumns(flexColumns, flexWidth, flexColWidth, false);\n\n\t\t//increase width of last column to account for rounding errors\n\n\t\tif (flexColumns.length && gapFill > 0) {\n\n\t\t\tflexColumns[flexColumns.length - 1].width += +gapFill;\n\t\t}\n\n\t\t//caculate space for columns to be shrunk into\n\n\t\tflexColumns.forEach(function (col) {\n\n\t\t\tflexWidth -= col.width;\n\t\t});\n\n\t\toverflowWidth = Math.abs(gapFill) + flexWidth;\n\n\t\t//shrink oversize columns if there is no available space\n\n\t\tif (overflowWidth > 0 && flexShrinkUnits) {\n\n\t\t\tgapFill = scaleColumns(fixedShrinkColumns, overflowWidth, Math.floor(overflowWidth / flexShrinkUnits), true);\n\t\t}\n\n\t\t//decrease width of last column to account for rounding errors\n\n\t\tif (fixedShrinkColumns.length) {\n\n\t\t\tfixedShrinkColumns[fixedShrinkColumns.length - 1].width -= gapFill;\n\t\t}\n\n\t\tflexColumns.forEach(function (col) {\n\n\t\t\tcol.column.setWidth(col.width);\n\t\t});\n\n\t\tfixedShrinkColumns.forEach(function (col) {\n\n\t\t\tcol.column.setWidth(col.width);\n\t\t});\n\t}\n\n};\n\nTabulator.prototype.registerModule(\"layout\", Layout);\nvar Localize = function Localize(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.locale = \"default\"; //current locale\n\tthis.lang = false; //current language\n\tthis.bindings = {}; //update events to call when locale is changed\n\tthis.langList = {};\n};\n\nLocalize.prototype.initialize = function () {\n\tthis.langList = Tabulator.prototype.helpers.deepClone(this.langs);\n};\n\n//set header placehoder\nLocalize.prototype.setHeaderFilterPlaceholder = function (placeholder) {\n\tthis.langList.default.headerFilters.default = placeholder;\n};\n\n//set header filter placeholder by column\nLocalize.prototype.setHeaderFilterColumnPlaceholder = function (column, placeholder) {\n\tthis.langList.default.headerFilters.columns[column] = placeholder;\n\n\tif (this.lang && !this.lang.headerFilters.columns[column]) {\n\t\tthis.lang.headerFilters.columns[column] = placeholder;\n\t}\n};\n\n//setup a lang description object\nLocalize.prototype.installLang = function (locale, lang) {\n\tif (this.langList[locale]) {\n\t\tthis._setLangProp(this.langList[locale], lang);\n\t} else {\n\t\tthis.langList[locale] = lang;\n\t}\n};\n\nLocalize.prototype._setLangProp = function (lang, values) {\n\tfor (var key in values) {\n\t\tif (lang[key] && _typeof(lang[key]) == \"object\") {\n\t\t\tthis._setLangProp(lang[key], values[key]);\n\t\t} else {\n\t\t\tlang[key] = values[key];\n\t\t}\n\t}\n};\n\n//set current locale\nLocalize.prototype.setLocale = function (desiredLocale) {\n\tvar self = this;\n\n\tdesiredLocale = desiredLocale || \"default\";\n\n\t//fill in any matching languge values\n\tfunction traverseLang(trans, path) {\n\t\tfor (var prop in trans) {\n\t\t\tif (_typeof(trans[prop]) == \"object\") {\n\t\t\t\tif (!path[prop]) {\n\t\t\t\t\tpath[prop] = {};\n\t\t\t\t}\n\t\t\t\ttraverseLang(trans[prop], path[prop]);\n\t\t\t} else {\n\t\t\t\tpath[prop] = trans[prop];\n\t\t\t}\n\t\t}\n\t}\n\n\t//determing correct locale to load\n\tif (desiredLocale === true && navigator.language) {\n\t\t//get local from system\n\t\tdesiredLocale = navigator.language.toLowerCase();\n\t}\n\n\tif (desiredLocale) {\n\n\t\t//if locale is not set, check for matching top level locale else use default\n\t\tif (!self.langList[desiredLocale]) {\n\t\t\tvar prefix = desiredLocale.split(\"-\")[0];\n\n\t\t\tif (self.langList[prefix]) {\n\t\t\t\tconsole.warn(\"Localization Error - Exact matching locale not found, using closest match: \", desiredLocale, prefix);\n\t\t\t\tdesiredLocale = prefix;\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Localization Error - Matching locale not found, using default: \", desiredLocale);\n\t\t\t\tdesiredLocale = \"default\";\n\t\t\t}\n\t\t}\n\t}\n\n\tself.locale = desiredLocale;\n\n\t//load default lang template\n\tself.lang = Tabulator.prototype.helpers.deepClone(self.langList.default || {});\n\n\tif (desiredLocale != \"default\") {\n\t\ttraverseLang(self.langList[desiredLocale], self.lang);\n\t}\n\n\tself.table.options.localized.call(self.table, self.locale, self.lang);\n\n\tself._executeBindings();\n};\n\n//get current locale\nLocalize.prototype.getLocale = function (locale) {\n\treturn self.locale;\n};\n\n//get lang object for given local or current if none provided\nLocalize.prototype.getLang = function (locale) {\n\treturn locale ? this.langList[locale] : this.lang;\n};\n\n//get text for current locale\nLocalize.prototype.getText = function (path, value) {\n\tvar path = value ? path + \"|\" + value : path,\n\t    pathArray = path.split(\"|\"),\n\t    text = this._getLangElement(pathArray, this.locale);\n\n\t// if(text === false){\n\t// \tconsole.warn(\"Localization Error - Matching localized text not found for given path: \", path);\n\t// }\n\n\treturn text || \"\";\n};\n\n//traverse langs object and find localized copy\nLocalize.prototype._getLangElement = function (path, locale) {\n\tvar self = this;\n\tvar root = self.lang;\n\n\tpath.forEach(function (level) {\n\t\tvar rootPath;\n\n\t\tif (root) {\n\t\t\trootPath = root[level];\n\n\t\t\tif (typeof rootPath != \"undefined\") {\n\t\t\t\troot = rootPath;\n\t\t\t} else {\n\t\t\t\troot = false;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn root;\n};\n\n//set update binding\nLocalize.prototype.bind = function (path, callback) {\n\tif (!this.bindings[path]) {\n\t\tthis.bindings[path] = [];\n\t}\n\n\tthis.bindings[path].push(callback);\n\n\tcallback(this.getText(path), this.lang);\n};\n\n//itterate through bindings and trigger updates\nLocalize.prototype._executeBindings = function () {\n\tvar self = this;\n\n\tvar _loop = function _loop(path) {\n\t\tself.bindings[path].forEach(function (binding) {\n\t\t\tbinding(self.getText(path), self.lang);\n\t\t});\n\t};\n\n\tfor (var path in self.bindings) {\n\t\t_loop(path);\n\t}\n};\n\n//Localized text listings\nLocalize.prototype.langs = {\n\t\"default\": { //hold default locale text\n\t\t\"groups\": {\n\t\t\t\"item\": \"item\",\n\t\t\t\"items\": \"items\"\n\t\t},\n\t\t\"columns\": {},\n\t\t\"ajax\": {\n\t\t\t\"loading\": \"Loading\",\n\t\t\t\"error\": \"Error\"\n\t\t},\n\t\t\"pagination\": {\n\t\t\t\"page_size\": \"Page Size\",\n\t\t\t\"page_title\": \"Show Page\",\n\t\t\t\"first\": \"First\",\n\t\t\t\"first_title\": \"First Page\",\n\t\t\t\"last\": \"Last\",\n\t\t\t\"last_title\": \"Last Page\",\n\t\t\t\"prev\": \"Prev\",\n\t\t\t\"prev_title\": \"Prev Page\",\n\t\t\t\"next\": \"Next\",\n\t\t\t\"next_title\": \"Next Page\",\n\t\t\t\"all\": \"All\"\n\t\t},\n\t\t\"headerFilters\": {\n\t\t\t\"default\": \"filter column...\",\n\t\t\t\"columns\": {}\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"localize\", Localize);\nvar Comms = function Comms(table) {\n\tthis.table = table;\n};\n\nComms.prototype.getConnections = function (selectors) {\n\tvar self = this,\n\t    connections = [],\n\t    connection;\n\n\tconnection = Tabulator.prototype.comms.lookupTable(selectors);\n\n\tconnection.forEach(function (con) {\n\t\tif (self.table !== con) {\n\t\t\tconnections.push(con);\n\t\t}\n\t});\n\n\treturn connections;\n};\n\nComms.prototype.send = function (selectors, module, action, data) {\n\tvar self = this,\n\t    connections = this.getConnections(selectors);\n\n\tconnections.forEach(function (connection) {\n\t\tconnection.tableComms(self.table.element, module, action, data);\n\t});\n\n\tif (!connections.length && selectors) {\n\t\tconsole.warn(\"Table Connection Error - No tables matching selector found\", selectors);\n\t}\n};\n\nComms.prototype.receive = function (table, module, action, data) {\n\tif (this.table.modExists(module)) {\n\t\treturn this.table.modules[module].commsReceived(table, action, data);\n\t} else {\n\t\tconsole.warn(\"Inter-table Comms Error - no such module:\", module);\n\t}\n};\n\nTabulator.prototype.registerModule(\"comms\", Comms);\n\nvar Accessor = function Accessor(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.allowedTypes = [\"\", \"data\", \"download\", \"clipboard\", \"print\", \"htmlOutput\"]; //list of accessor types\n};\n\n//initialize column accessor\nAccessor.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    match = false,\n\t    config = {};\n\n\tthis.allowedTypes.forEach(function (type) {\n\t\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t    accessor;\n\n\t\tif (column.definition[key]) {\n\t\t\taccessor = self.lookupAccessor(column.definition[key]);\n\n\t\t\tif (accessor) {\n\t\t\t\tmatch = true;\n\n\t\t\t\tconfig[key] = {\n\t\t\t\t\taccessor: accessor,\n\t\t\t\t\tparams: column.definition[key + \"Params\"] || {}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\n\tif (match) {\n\t\tcolumn.modules.accessor = config;\n\t}\n};\n\nAccessor.prototype.lookupAccessor = function (value) {\n\tvar accessor = false;\n\n\t//set column accessor\n\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\t\tcase \"string\":\n\t\t\tif (this.accessors[value]) {\n\t\t\t\taccessor = this.accessors[value];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Accessor Error - No such accessor found, ignoring: \", value);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\taccessor = value;\n\t\t\tbreak;\n\t}\n\n\treturn accessor;\n};\n\n//apply accessor to row\nAccessor.prototype.transformRow = function (row, type) {\n\tvar key = \"accessor\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t    rowComponent = row.getComponent();\n\n\t//clone data object with deep copy to isolate internal data from returned result\n\tvar data = Tabulator.prototype.helpers.deepClone(row.data || {});\n\n\tthis.table.columnManager.traverse(function (column) {\n\t\tvar value, accessor, params, colCompnent;\n\n\t\tif (column.modules.accessor) {\n\n\t\t\taccessor = column.modules.accessor[key] || column.modules.accessor.accessor || false;\n\n\t\t\tif (accessor) {\n\t\t\t\tvalue = column.getFieldValue(data);\n\n\t\t\t\tif (value != \"undefined\") {\n\t\t\t\t\tcolCompnent = column.getComponent();\n\t\t\t\t\tparams = typeof accessor.params === \"function\" ? accessor.params(value, data, type, colCompnent, rowComponent) : accessor.params;\n\t\t\t\t\tcolumn.setFieldValue(data, accessor.accessor(value, data, type, params, colCompnent, rowComponent));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\treturn data;\n},\n\n//default accessors\nAccessor.prototype.accessors = {};\n\nTabulator.prototype.registerModule(\"accessor\", Accessor);\nvar Ajax = function Ajax(table) {\n\n\tthis.table = table; //hold Tabulator object\n\tthis.config = false; //hold config object for ajax request\n\tthis.url = \"\"; //request URL\n\tthis.urlGenerator = false;\n\tthis.params = false; //request parameters\n\n\tthis.loaderElement = this.createLoaderElement(); //loader message div\n\tthis.msgElement = this.createMsgElement(); //message element\n\tthis.loadingElement = false;\n\tthis.errorElement = false;\n\tthis.loaderPromise = false;\n\n\tthis.progressiveLoad = false;\n\tthis.loading = false;\n\n\tthis.requestOrder = 0; //prevent requests comming out of sequence if overridden by another load request\n};\n\n//initialize setup options\nAjax.prototype.initialize = function () {\n\tvar template;\n\n\tthis.loaderElement.appendChild(this.msgElement);\n\n\tif (this.table.options.ajaxLoaderLoading) {\n\t\tif (typeof this.table.options.ajaxLoaderLoading == \"string\") {\n\t\t\ttemplate = document.createElement('template');\n\t\t\ttemplate.innerHTML = this.table.options.ajaxLoaderLoading.trim();\n\t\t\tthis.loadingElement = template.content.firstChild;\n\t\t} else {\n\t\t\tthis.loadingElement = this.table.options.ajaxLoaderLoading;\n\t\t}\n\t}\n\n\tthis.loaderPromise = this.table.options.ajaxRequestFunc || this.defaultLoaderPromise;\n\n\tthis.urlGenerator = this.table.options.ajaxURLGenerator || this.defaultURLGenerator;\n\n\tif (this.table.options.ajaxLoaderError) {\n\t\tif (typeof this.table.options.ajaxLoaderError == \"string\") {\n\t\t\ttemplate = document.createElement('template');\n\t\t\ttemplate.innerHTML = this.table.options.ajaxLoaderError.trim();\n\t\t\tthis.errorElement = template.content.firstChild;\n\t\t} else {\n\t\t\tthis.errorElement = this.table.options.ajaxLoaderError;\n\t\t}\n\t}\n\n\tif (this.table.options.ajaxParams) {\n\t\tthis.setParams(this.table.options.ajaxParams);\n\t}\n\n\tif (this.table.options.ajaxConfig) {\n\t\tthis.setConfig(this.table.options.ajaxConfig);\n\t}\n\n\tif (this.table.options.ajaxURL) {\n\t\tthis.setUrl(this.table.options.ajaxURL);\n\t}\n\n\tif (this.table.options.ajaxProgressiveLoad) {\n\t\tif (this.table.options.pagination) {\n\t\t\tthis.progressiveLoad = false;\n\t\t\tconsole.error(\"Progressive Load Error - Pagination and progressive load cannot be used at the same time\");\n\t\t} else {\n\t\t\tif (this.table.modExists(\"page\")) {\n\t\t\t\tthis.progressiveLoad = this.table.options.ajaxProgressiveLoad;\n\t\t\t\tthis.table.modules.page.initializeProgressive(this.progressiveLoad);\n\t\t\t} else {\n\t\t\t\tconsole.error(\"Pagination plugin is required for progressive ajax loading\");\n\t\t\t}\n\t\t}\n\t}\n};\n\nAjax.prototype.createLoaderElement = function () {\n\tvar el = document.createElement(\"div\");\n\tel.classList.add(\"tabulator-loader\");\n\treturn el;\n};\n\nAjax.prototype.createMsgElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-loader-msg\");\n\tel.setAttribute(\"role\", \"alert\");\n\n\treturn el;\n};\n\n//set ajax params\nAjax.prototype.setParams = function (params, update) {\n\tif (update) {\n\t\tthis.params = this.params || {};\n\n\t\tfor (var key in params) {\n\t\t\tthis.params[key] = params[key];\n\t\t}\n\t} else {\n\t\tthis.params = params;\n\t}\n};\n\nAjax.prototype.getParams = function () {\n\treturn this.params || {};\n};\n\n//load config object\nAjax.prototype.setConfig = function (config) {\n\tthis._loadDefaultConfig();\n\n\tif (typeof config == \"string\") {\n\t\tthis.config.method = config;\n\t} else {\n\t\tfor (var key in config) {\n\t\t\tthis.config[key] = config[key];\n\t\t}\n\t}\n};\n\n//create config object from default\nAjax.prototype._loadDefaultConfig = function (force) {\n\tvar self = this;\n\tif (!self.config || force) {\n\n\t\tself.config = {};\n\n\t\t//load base config from defaults\n\t\tfor (var key in self.defaultConfig) {\n\t\t\tself.config[key] = self.defaultConfig[key];\n\t\t}\n\t}\n};\n\n//set request url\nAjax.prototype.setUrl = function (url) {\n\tthis.url = url;\n};\n\n//get request url\nAjax.prototype.getUrl = function () {\n\treturn this.url;\n};\n\n//lstandard loading function\nAjax.prototype.loadData = function (inPosition, columnsChanged) {\n\tvar self = this;\n\n\tif (this.progressiveLoad) {\n\t\treturn this._loadDataProgressive();\n\t} else {\n\t\treturn this._loadDataStandard(inPosition, columnsChanged);\n\t}\n};\n\nAjax.prototype.nextPage = function (diff) {\n\tvar margin;\n\n\tif (!this.loading) {\n\n\t\tmargin = this.table.options.ajaxProgressiveLoadScrollMargin || this.table.rowManager.getElement().clientHeight * 2;\n\n\t\tif (diff < margin) {\n\t\t\tthis.table.modules.page.nextPage().then(function () {}).catch(function () {});\n\t\t}\n\t}\n};\n\nAjax.prototype.blockActiveRequest = function () {\n\tthis.requestOrder++;\n};\n\nAjax.prototype._loadDataProgressive = function () {\n\tthis.table.rowManager.setData([]);\n\treturn this.table.modules.page.setPage(1);\n};\n\nAjax.prototype._loadDataStandard = function (inPosition, columnsChanged) {\n\tvar _this42 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\t_this42.sendRequest(inPosition).then(function (data) {\n\t\t\t_this42.table.rowManager.setData(data, inPosition, columnsChanged).then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function (e) {\n\t\t\t\treject(e);\n\t\t\t});\n\t\t}).catch(function (e) {\n\t\t\treject(e);\n\t\t});\n\t});\n};\n\nAjax.prototype.generateParamsList = function (data, prefix) {\n\tvar self = this,\n\t    output = [];\n\n\tprefix = prefix || \"\";\n\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(function (item, i) {\n\t\t\toutput = output.concat(self.generateParamsList(item, prefix ? prefix + \"[\" + i + \"]\" : i));\n\t\t});\n\t} else if ((typeof data === 'undefined' ? 'undefined' : _typeof(data)) === \"object\") {\n\t\tfor (var key in data) {\n\t\t\toutput = output.concat(self.generateParamsList(data[key], prefix ? prefix + \"[\" + key + \"]\" : key));\n\t\t}\n\t} else {\n\t\toutput.push({ key: prefix, value: data });\n\t}\n\n\treturn output;\n};\n\nAjax.prototype.serializeParams = function (params) {\n\tvar output = this.generateParamsList(params),\n\t    encoded = [];\n\n\toutput.forEach(function (item) {\n\t\tencoded.push(encodeURIComponent(item.key) + \"=\" + encodeURIComponent(item.value));\n\t});\n\n\treturn encoded.join(\"&\");\n};\n\n//send ajax request\nAjax.prototype.sendRequest = function (silent) {\n\tvar _this43 = this;\n\n\tvar self = this,\n\t    url = self.url,\n\t    requestNo,\n\t    esc,\n\t    query;\n\n\tself.requestOrder++;\n\trequestNo = self.requestOrder;\n\n\tself._loadDefaultConfig();\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (self.table.options.ajaxRequesting.call(_this43.table, self.url, self.params) !== false) {\n\n\t\t\tself.loading = true;\n\n\t\t\tif (!silent) {\n\t\t\t\tself.showLoader();\n\t\t\t}\n\n\t\t\t_this43.loaderPromise(url, self.config, self.params).then(function (data) {\n\t\t\t\tif (requestNo === self.requestOrder) {\n\t\t\t\t\tif (self.table.options.ajaxResponse) {\n\t\t\t\t\t\tdata = self.table.options.ajaxResponse.call(self.table, self.url, self.params, data);\n\t\t\t\t\t}\n\t\t\t\t\tresolve(data);\n\n\t\t\t\t\tself.hideLoader();\n\t\t\t\t\tself.loading = false;\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Ajax Response Blocked - An active ajax request was blocked by an attempt to change table data while the request was being made\");\n\t\t\t\t}\n\t\t\t}).catch(function (error) {\n\t\t\t\tconsole.error(\"Ajax Load Error: \", error);\n\t\t\t\tself.table.options.ajaxError.call(self.table, error);\n\n\t\t\t\tself.showError();\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.hideLoader();\n\t\t\t\t}, 3000);\n\n\t\t\t\tself.loading = false;\n\n\t\t\t\treject(error);\n\t\t\t});\n\t\t} else {\n\t\t\treject();\n\t\t}\n\t});\n};\n\nAjax.prototype.showLoader = function () {\n\tvar shouldLoad = typeof this.table.options.ajaxLoader === \"function\" ? this.table.options.ajaxLoader() : this.table.options.ajaxLoader;\n\n\tif (shouldLoad) {\n\n\t\tthis.hideLoader();\n\n\t\twhile (this.msgElement.firstChild) {\n\t\t\tthis.msgElement.removeChild(this.msgElement.firstChild);\n\t\t}this.msgElement.classList.remove(\"tabulator-error\");\n\t\tthis.msgElement.classList.add(\"tabulator-loading\");\n\n\t\tif (this.loadingElement) {\n\t\t\tthis.msgElement.appendChild(this.loadingElement);\n\t\t} else {\n\t\t\tthis.msgElement.innerHTML = this.table.modules.localize.getText(\"ajax|loading\");\n\t\t}\n\n\t\tthis.table.element.appendChild(this.loaderElement);\n\t}\n};\n\nAjax.prototype.showError = function () {\n\tthis.hideLoader();\n\n\twhile (this.msgElement.firstChild) {\n\t\tthis.msgElement.removeChild(this.msgElement.firstChild);\n\t}this.msgElement.classList.remove(\"tabulator-loading\");\n\tthis.msgElement.classList.add(\"tabulator-error\");\n\n\tif (this.errorElement) {\n\t\tthis.msgElement.appendChild(this.errorElement);\n\t} else {\n\t\tthis.msgElement.innerHTML = this.table.modules.localize.getText(\"ajax|error\");\n\t}\n\n\tthis.table.element.appendChild(this.loaderElement);\n};\n\nAjax.prototype.hideLoader = function () {\n\tif (this.loaderElement.parentNode) {\n\t\tthis.loaderElement.parentNode.removeChild(this.loaderElement);\n\t}\n};\n\n//default ajax config object\nAjax.prototype.defaultConfig = {\n\tmethod: \"GET\"\n};\n\nAjax.prototype.defaultURLGenerator = function (url, config, params) {\n\n\tif (url) {\n\t\tif (params && Object.keys(params).length) {\n\t\t\tif (!config.method || config.method.toLowerCase() == \"get\") {\n\t\t\t\tconfig.method = \"get\";\n\n\t\t\t\turl += (url.includes(\"?\") ? \"&\" : \"?\") + this.modules.ajax.serializeParams(params);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn url;\n};\n\nAjax.prototype.defaultLoaderPromise = function (url, config, params) {\n\tvar self = this,\n\t    contentType;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\t//set url\n\t\turl = self.urlGenerator.call(self.table, url, config, params);\n\n\t\t//set body content if not GET request\n\t\tif (config.method.toUpperCase() != \"GET\") {\n\t\t\tcontentType = _typeof(self.table.options.ajaxContentType) === \"object\" ? self.table.options.ajaxContentType : self.contentTypeFormatters[self.table.options.ajaxContentType];\n\t\t\tif (contentType) {\n\n\t\t\t\tfor (var key in contentType.headers) {\n\t\t\t\t\tif (!config.headers) {\n\t\t\t\t\t\tconfig.headers = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof config.headers[key] === \"undefined\") {\n\t\t\t\t\t\tconfig.headers[key] = contentType.headers[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconfig.body = contentType.body.call(self, url, config, params);\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Ajax Error - Invalid ajaxContentType value:\", self.table.options.ajaxContentType);\n\t\t\t}\n\t\t}\n\n\t\tif (url) {\n\n\t\t\t//configure headers\n\t\t\tif (typeof config.headers === \"undefined\") {\n\t\t\t\tconfig.headers = {};\n\t\t\t}\n\n\t\t\tif (typeof config.headers.Accept === \"undefined\") {\n\t\t\t\tconfig.headers.Accept = \"application/json\";\n\t\t\t}\n\n\t\t\tif (typeof config.headers[\"X-Requested-With\"] === \"undefined\") {\n\t\t\t\tconfig.headers[\"X-Requested-With\"] = \"XMLHttpRequest\";\n\t\t\t}\n\n\t\t\tif (typeof config.mode === \"undefined\") {\n\t\t\t\tconfig.mode = \"cors\";\n\t\t\t}\n\n\t\t\tif (config.mode == \"cors\") {\n\n\t\t\t\tif (typeof config.headers[\"Access-Control-Allow-Origin\"] === \"undefined\") {\n\t\t\t\t\tconfig.headers[\"Access-Control-Allow-Origin\"] = window.location.origin;\n\t\t\t\t}\n\n\t\t\t\tif (typeof config.credentials === \"undefined\") {\n\t\t\t\t\tconfig.credentials = 'same-origin';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (typeof config.credentials === \"undefined\") {\n\t\t\t\t\tconfig.credentials = 'include';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//send request\n\t\t\tfetch(url, config).then(function (response) {\n\t\t\t\tif (response.ok) {\n\t\t\t\t\tresponse.json().then(function (data) {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}).catch(function (error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t\tconsole.warn(\"Ajax Load Error - Invalid JSON returned\", error);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \" + response.status, response.statusText);\n\t\t\t\t\treject(response);\n\t\t\t\t}\n\t\t\t}).catch(function (error) {\n\t\t\t\tconsole.error(\"Ajax Load Error - Connection Error: \", error);\n\t\t\t\treject(error);\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Ajax Load Error - No URL Set\");\n\t\t\tresolve([]);\n\t\t}\n\t});\n};\n\nAjax.prototype.contentTypeFormatters = {\n\t\"json\": {\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tbody: function body(url, config, params) {\n\t\t\treturn JSON.stringify(params);\n\t\t}\n\t},\n\t\"form\": {\n\t\theaders: {},\n\t\tbody: function body(url, config, params) {\n\t\t\tvar output = this.generateParamsList(params),\n\t\t\t    form = new FormData();\n\n\t\t\toutput.forEach(function (item) {\n\t\t\t\tform.append(item.key, item.value);\n\t\t\t});\n\n\t\t\treturn form;\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"ajax\", Ajax);\n\n//public calc object\nvar CalcComponent = function CalcComponent(row) {\n\tthis._row = row;\n};\n\nCalcComponent.prototype.getData = function (transform) {\n\treturn this._row.getData(transform);\n};\n\nCalcComponent.prototype.getElement = function () {\n\treturn this._row.getElement();\n};\n\nCalcComponent.prototype.getTable = function () {\n\treturn this._row.table;\n};\n\nCalcComponent.prototype.getCells = function () {\n\tvar cells = [];\n\n\tthis._row.getCells().forEach(function (cell) {\n\t\tcells.push(cell.getComponent());\n\t});\n\n\treturn cells;\n};\n\nCalcComponent.prototype.getCell = function (column) {\n\tvar cell = this._row.getCell(column);\n\treturn cell ? cell.getComponent() : false;\n};\n\nCalcComponent.prototype._getSelf = function () {\n\treturn this._row;\n};\n\nvar ColumnCalcs = function ColumnCalcs(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.topCalcs = [];\n\tthis.botCalcs = [];\n\tthis.genColumn = false;\n\tthis.topElement = this.createElement();\n\tthis.botElement = this.createElement();\n\tthis.topRow = false;\n\tthis.botRow = false;\n\tthis.topInitialized = false;\n\tthis.botInitialized = false;\n\n\tthis.initialize();\n};\n\nColumnCalcs.prototype.createElement = function () {\n\tvar el = document.createElement(\"div\");\n\tel.classList.add(\"tabulator-calcs-holder\");\n\treturn el;\n};\n\nColumnCalcs.prototype.initialize = function () {\n\tthis.genColumn = new Column({ field: \"value\" }, this);\n};\n\n//dummy functions to handle being mock column manager\nColumnCalcs.prototype.registerColumnField = function () {};\n\n//initialize column calcs\nColumnCalcs.prototype.initializeColumn = function (column) {\n\tvar def = column.definition;\n\n\tvar config = {\n\t\ttopCalcParams: def.topCalcParams || {},\n\t\tbotCalcParams: def.bottomCalcParams || {}\n\t};\n\n\tif (def.topCalc) {\n\n\t\tswitch (_typeof(def.topCalc)) {\n\t\t\tcase \"string\":\n\t\t\t\tif (this.calculations[def.topCalc]) {\n\t\t\t\t\tconfig.topCalc = this.calculations[def.topCalc];\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.topCalc);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tconfig.topCalc = def.topCalc;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif (config.topCalc) {\n\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\tthis.topCalcs.push(column);\n\n\t\t\tif (this.table.options.columnCalcs != \"group\") {\n\t\t\t\tthis.initializeTopRow();\n\t\t\t}\n\t\t}\n\t}\n\n\tif (def.bottomCalc) {\n\t\tswitch (_typeof(def.bottomCalc)) {\n\t\t\tcase \"string\":\n\t\t\t\tif (this.calculations[def.bottomCalc]) {\n\t\t\t\t\tconfig.botCalc = this.calculations[def.bottomCalc];\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Column Calc Error - No such calculation found, ignoring: \", def.bottomCalc);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tconfig.botCalc = def.bottomCalc;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif (config.botCalc) {\n\t\t\tcolumn.modules.columnCalcs = config;\n\t\t\tthis.botCalcs.push(column);\n\n\t\t\tif (this.table.options.columnCalcs != \"group\") {\n\t\t\t\tthis.initializeBottomRow();\n\t\t\t}\n\t\t}\n\t}\n};\n\nColumnCalcs.prototype.removeCalcs = function () {\n\tvar changed = false;\n\n\tif (this.topInitialized) {\n\t\tthis.topInitialized = false;\n\t\tthis.topElement.parentNode.removeChild(this.topElement);\n\t\tchanged = true;\n\t}\n\n\tif (this.botInitialized) {\n\t\tthis.botInitialized = false;\n\t\tthis.table.footerManager.remove(this.botElement);\n\t\tchanged = true;\n\t}\n\n\tif (changed) {\n\t\tthis.table.rowManager.adjustTableSize();\n\t}\n};\n\nColumnCalcs.prototype.initializeTopRow = function () {\n\tif (!this.topInitialized) {\n\t\tthis.table.columnManager.getElement().insertBefore(this.topElement, this.table.columnManager.headersElement.nextSibling);\n\t\tthis.topInitialized = true;\n\t}\n};\n\nColumnCalcs.prototype.initializeBottomRow = function () {\n\tif (!this.botInitialized) {\n\t\tthis.table.footerManager.prepend(this.botElement);\n\t\tthis.botInitialized = true;\n\t}\n};\n\nColumnCalcs.prototype.scrollHorizontal = function (left) {\n\tif (this.botInitialized && this.botRow) {\n\t\tthis.botRow.getElement().style.marginLeft = -left + \"px\";\n\t}\n};\n\nColumnCalcs.prototype.recalc = function (rows) {\n\tvar data, row;\n\n\tif (this.topInitialized || this.botInitialized) {\n\t\tdata = this.rowsToData(rows);\n\n\t\tif (this.topInitialized) {\n\t\t\tif (this.topRow) {\n\t\t\t\tthis.topRow.deleteCells();\n\t\t\t}\n\n\t\t\trow = this.generateRow(\"top\", this.rowsToData(rows));\n\t\t\tthis.topRow = row;\n\t\t\twhile (this.topElement.firstChild) {\n\t\t\t\tthis.topElement.removeChild(this.topElement.firstChild);\n\t\t\t}this.topElement.appendChild(row.getElement());\n\t\t\trow.initialize(true);\n\t\t}\n\n\t\tif (this.botInitialized) {\n\t\t\tif (this.botRow) {\n\t\t\t\tthis.botRow.deleteCells();\n\t\t\t}\n\n\t\t\trow = this.generateRow(\"bottom\", this.rowsToData(rows));\n\t\t\tthis.botRow = row;\n\t\t\twhile (this.botElement.firstChild) {\n\t\t\t\tthis.botElement.removeChild(this.botElement.firstChild);\n\t\t\t}this.botElement.appendChild(row.getElement());\n\t\t\trow.initialize(true);\n\t\t}\n\n\t\tthis.table.rowManager.adjustTableSize();\n\n\t\t//set resizable handles\n\t\tif (this.table.modExists(\"frozenColumns\")) {\n\t\t\tthis.table.modules.frozenColumns.layout();\n\t\t}\n\t}\n};\n\nColumnCalcs.prototype.recalcRowGroup = function (row) {\n\tthis.recalcGroup(this.table.modules.groupRows.getRowGroup(row));\n};\n\nColumnCalcs.prototype.recalcAll = function () {\n\tvar _this44 = this;\n\n\tif (this.topCalcs.length || this.botCalcs.length) {\n\t\tif (this.table.options.columnCalcs !== \"group\") {\n\t\t\tthis.recalc(this.table.rowManager.activeRows);\n\t\t}\n\n\t\tif (this.table.options.groupBy && this.table.options.columnCalcs !== \"table\") {\n\n\t\t\tvar groups = table.modules.groupRows.getChildGroups();\n\n\t\t\tgroups.forEach(function (group) {\n\t\t\t\t_this44.recalcGroup(group);\n\t\t\t});\n\t\t}\n\t}\n};\n\nColumnCalcs.prototype.recalcGroup = function (group) {\n\tvar data, rowData;\n\n\tif (group) {\n\t\tif (group.calcs) {\n\t\t\tif (group.calcs.bottom) {\n\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\trowData = this.generateRowData(\"bottom\", data);\n\n\t\t\t\tgroup.calcs.bottom.updateData(rowData);\n\t\t\t\tgroup.calcs.bottom.reinitialize();\n\t\t\t}\n\n\t\t\tif (group.calcs.top) {\n\t\t\t\tdata = this.rowsToData(group.rows);\n\t\t\t\trowData = this.generateRowData(\"top\", data);\n\n\t\t\t\tgroup.calcs.top.updateData(rowData);\n\t\t\t\tgroup.calcs.top.reinitialize();\n\t\t\t}\n\t\t}\n\t}\n};\n\n//generate top stats row\nColumnCalcs.prototype.generateTopRow = function (rows) {\n\treturn this.generateRow(\"top\", this.rowsToData(rows));\n};\n//generate bottom stats row\nColumnCalcs.prototype.generateBottomRow = function (rows) {\n\treturn this.generateRow(\"bottom\", this.rowsToData(rows));\n};\n\nColumnCalcs.prototype.rowsToData = function (rows) {\n\tvar _this45 = this;\n\n\tvar data = [];\n\n\trows.forEach(function (row) {\n\t\tdata.push(row.getData());\n\n\t\tif (_this45.table.options.dataTree && _this45.table.options.dataTreeChildColumnCalcs) {\n\t\t\tif (row.modules.dataTree.open) {\n\t\t\t\tvar children = _this45.rowsToData(_this45.table.modules.dataTree.getFilteredTreeChildren(row));\n\t\t\t\tdata = data.concat(children);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn data;\n};\n\n//generate stats row\nColumnCalcs.prototype.generateRow = function (pos, data) {\n\tvar self = this,\n\t    rowData = this.generateRowData(pos, data),\n\t    row;\n\n\tif (self.table.modExists(\"mutator\")) {\n\t\tself.table.modules.mutator.disable();\n\t}\n\n\trow = new Row(rowData, this, \"calc\");\n\n\tif (self.table.modExists(\"mutator\")) {\n\t\tself.table.modules.mutator.enable();\n\t}\n\n\trow.getElement().classList.add(\"tabulator-calcs\", \"tabulator-calcs-\" + pos);\n\n\trow.component = false;\n\n\trow.getComponent = function () {\n\t\tif (!this.component) {\n\t\t\tthis.component = new CalcComponent(this);\n\t\t}\n\n\t\treturn this.component;\n\t};\n\n\trow.generateCells = function () {\n\n\t\tvar cells = [];\n\n\t\tself.table.columnManager.columnsByIndex.forEach(function (column) {\n\n\t\t\t//set field name of mock column\n\t\t\tself.genColumn.setField(column.getField());\n\t\t\tself.genColumn.hozAlign = column.hozAlign;\n\n\t\t\tif (column.definition[pos + \"CalcFormatter\"] && self.table.modExists(\"format\")) {\n\t\t\t\tself.genColumn.modules.format = {\n\t\t\t\t\tformatter: self.table.modules.format.getFormatter(column.definition[pos + \"CalcFormatter\"]),\n\t\t\t\t\tparams: column.definition[pos + \"CalcFormatterParams\"] || {}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tself.genColumn.modules.format = {\n\t\t\t\t\tformatter: self.table.modules.format.getFormatter(\"plaintext\"),\n\t\t\t\t\tparams: {}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t//ensure css class defintion is replicated to calculation cell\n\t\t\tself.genColumn.definition.cssClass = column.definition.cssClass;\n\n\t\t\t//generate cell and assign to correct column\n\t\t\tvar cell = new Cell(self.genColumn, row);\n\t\t\tcell.getElement();\n\t\t\tcell.column = column;\n\t\t\tcell.setWidth();\n\n\t\t\tcolumn.cells.push(cell);\n\t\t\tcells.push(cell);\n\n\t\t\tif (!column.visible) {\n\t\t\t\tcell.hide();\n\t\t\t}\n\t\t});\n\n\t\tthis.cells = cells;\n\t};\n\n\treturn row;\n};\n\n//generate stats row\nColumnCalcs.prototype.generateRowData = function (pos, data) {\n\tvar rowData = {},\n\t    calcs = pos == \"top\" ? this.topCalcs : this.botCalcs,\n\t    type = pos == \"top\" ? \"topCalc\" : \"botCalc\",\n\t    params,\n\t    paramKey;\n\n\tcalcs.forEach(function (column) {\n\t\tvar values = [];\n\n\t\tif (column.modules.columnCalcs && column.modules.columnCalcs[type]) {\n\t\t\tdata.forEach(function (item) {\n\t\t\t\tvalues.push(column.getFieldValue(item));\n\t\t\t});\n\n\t\t\tparamKey = type + \"Params\";\n\t\t\tparams = typeof column.modules.columnCalcs[paramKey] === \"function\" ? column.modules.columnCalcs[paramKey](values, data) : column.modules.columnCalcs[paramKey];\n\n\t\t\tcolumn.setFieldValue(rowData, column.modules.columnCalcs[type](values, data, params));\n\t\t}\n\t});\n\n\treturn rowData;\n};\n\nColumnCalcs.prototype.hasTopCalcs = function () {\n\treturn !!this.topCalcs.length;\n};\n\nColumnCalcs.prototype.hasBottomCalcs = function () {\n\treturn !!this.botCalcs.length;\n};\n\n//handle table redraw\nColumnCalcs.prototype.redraw = function () {\n\tif (this.topRow) {\n\t\tthis.topRow.normalizeHeight(true);\n\t}\n\tif (this.botRow) {\n\t\tthis.botRow.normalizeHeight(true);\n\t}\n};\n\n//return the calculated\nColumnCalcs.prototype.getResults = function () {\n\tvar self = this,\n\t    results = {},\n\t    groups;\n\n\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\tgroups = this.table.modules.groupRows.getGroups(true);\n\n\t\tgroups.forEach(function (group) {\n\t\t\tresults[group.getKey()] = self.getGroupResults(group);\n\t\t});\n\t} else {\n\t\tresults = {\n\t\t\ttop: this.topRow ? this.topRow.getData() : {},\n\t\t\tbottom: this.botRow ? this.botRow.getData() : {}\n\t\t};\n\t}\n\n\treturn results;\n};\n\n//get results from a group\nColumnCalcs.prototype.getGroupResults = function (group) {\n\tvar self = this,\n\t    groupObj = group._getSelf(),\n\t    subGroups = group.getSubGroups(),\n\t    subGroupResults = {},\n\t    results = {};\n\n\tsubGroups.forEach(function (subgroup) {\n\t\tsubGroupResults[subgroup.getKey()] = self.getGroupResults(subgroup);\n\t});\n\n\tresults = {\n\t\ttop: groupObj.calcs.top ? groupObj.calcs.top.getData() : {},\n\t\tbottom: groupObj.calcs.bottom ? groupObj.calcs.bottom.getData() : {},\n\t\tgroups: subGroupResults\n\t};\n\n\treturn results;\n};\n\n//default calculations\nColumnCalcs.prototype.calculations = {\n\t\"avg\": function avg(values, data, calcParams) {\n\t\tvar output = 0,\n\t\t    precision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : 2;\n\n\t\tif (values.length) {\n\t\t\toutput = values.reduce(function (sum, value) {\n\t\t\t\treturn Number(sum) + Number(value);\n\t\t\t});\n\n\t\t\toutput = output / values.length;\n\n\t\t\toutput = precision !== false ? output.toFixed(precision) : output;\n\t\t}\n\n\t\treturn parseFloat(output).toString();\n\t},\n\t\"max\": function max(values, data, calcParams) {\n\t\tvar output = null,\n\t\t    precision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function (value) {\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif (value > output || output === null) {\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? precision !== false ? output.toFixed(precision) : output : \"\";\n\t},\n\t\"min\": function min(values, data, calcParams) {\n\t\tvar output = null,\n\t\t    precision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tvalues.forEach(function (value) {\n\n\t\t\tvalue = Number(value);\n\n\t\t\tif (value < output || output === null) {\n\t\t\t\toutput = value;\n\t\t\t}\n\t\t});\n\n\t\treturn output !== null ? precision !== false ? output.toFixed(precision) : output : \"\";\n\t},\n\t\"sum\": function sum(values, data, calcParams) {\n\t\tvar output = 0,\n\t\t    precision = typeof calcParams.precision !== \"undefined\" ? calcParams.precision : false;\n\n\t\tif (values.length) {\n\t\t\tvalues.forEach(function (value) {\n\t\t\t\tvalue = Number(value);\n\n\t\t\t\toutput += !isNaN(value) ? Number(value) : 0;\n\t\t\t});\n\t\t}\n\n\t\treturn precision !== false ? output.toFixed(precision) : output;\n\t},\n\t\"concat\": function concat(values, data, calcParams) {\n\t\tvar output = 0;\n\n\t\tif (values.length) {\n\t\t\toutput = values.reduce(function (sum, value) {\n\t\t\t\treturn String(sum) + String(value);\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t},\n\t\"count\": function count(values, data, calcParams) {\n\t\tvar output = 0;\n\n\t\tif (values.length) {\n\t\t\tvalues.forEach(function (value) {\n\t\t\t\tif (value) {\n\t\t\t\t\toutput++;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn output;\n\t}\n};\n\nTabulator.prototype.registerModule(\"columnCalcs\", ColumnCalcs);\n\nvar Clipboard = function Clipboard(table) {\n\tthis.table = table;\n\tthis.mode = true;\n\n\tthis.pasteParser = function () {};\n\tthis.pasteAction = function () {};\n\tthis.customSelection = false;\n\tthis.rowRange = false;\n\tthis.blocked = true; //block copy actions not originating from this command\n};\n\nClipboard.prototype.initialize = function () {\n\tvar _this46 = this;\n\n\tthis.mode = this.table.options.clipboard;\n\n\tthis.rowRange = this.table.options.clipboardCopyRowRange;\n\n\tif (this.mode === true || this.mode === \"copy\") {\n\t\tthis.table.element.addEventListener(\"copy\", function (e) {\n\t\t\tvar plain, html, list;\n\n\t\t\tif (!_this46.blocked) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tif (_this46.customSelection) {\n\t\t\t\t\tplain = _this46.customSelection;\n\n\t\t\t\t\tif (_this46.table.options.clipboardCopyFormatter) {\n\t\t\t\t\t\tplain = _this46.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tvar list = _this46.table.modules.export.generateExportList(_this46.table.options.clipboardCopyConfig, _this46.table.options.clipboardCopyStyled, _this46.rowRange, \"clipboard\");\n\n\t\t\t\t\thtml = _this46.table.modules.export.genereateHTMLTable(list);\n\t\t\t\t\tplain = html ? _this46.generatePlainContent(list) : \"\";\n\n\t\t\t\t\tif (_this46.table.options.clipboardCopyFormatter) {\n\t\t\t\t\t\tplain = _this46.table.options.clipboardCopyFormatter(\"plain\", plain);\n\t\t\t\t\t\thtml = _this46.table.options.clipboardCopyFormatter(\"html\", html);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (window.clipboardData && window.clipboardData.setData) {\n\t\t\t\t\twindow.clipboardData.setData('Text', plain);\n\t\t\t\t} else if (e.clipboardData && e.clipboardData.setData) {\n\t\t\t\t\te.clipboardData.setData('text/plain', plain);\n\t\t\t\t\tif (html) {\n\t\t\t\t\t\te.clipboardData.setData('text/html', html);\n\t\t\t\t\t}\n\t\t\t\t} else if (e.originalEvent && e.originalEvent.clipboardData.setData) {\n\t\t\t\t\te.originalEvent.clipboardData.setData('text/plain', plain);\n\t\t\t\t\tif (html) {\n\t\t\t\t\t\te.originalEvent.clipboardData.setData('text/html', html);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t_this46.table.options.clipboardCopied.call(_this46.table, plain, html);\n\n\t\t\t\t_this46.reset();\n\t\t\t}\n\t\t});\n\t}\n\n\tif (this.mode === true || this.mode === \"paste\") {\n\t\tthis.table.element.addEventListener(\"paste\", function (e) {\n\t\t\t_this46.paste(e);\n\t\t});\n\t}\n\n\tthis.setPasteParser(this.table.options.clipboardPasteParser);\n\tthis.setPasteAction(this.table.options.clipboardPasteAction);\n};\n\nClipboard.prototype.reset = function () {\n\tthis.blocked = true;\n\tthis.customSelection = false;\n};\n\nClipboard.prototype.generatePlainContent = function (list) {\n\tvar output = [];\n\n\tlist.forEach(function (row) {\n\t\tvar rowData = [];\n\n\t\trow.columns.forEach(function (col) {\n\t\t\tvar value = \"\";\n\n\t\t\tif (col) {\n\n\t\t\t\tif (row.type === \"group\") {\n\t\t\t\t\tcol.value = col.component.getKey();\n\t\t\t\t}\n\n\t\t\t\tif (col.value === null) {\n\t\t\t\t\tvalue = \"\";\n\t\t\t\t} else {\n\t\t\t\t\tswitch (_typeof(col.value)) {\n\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\tvalue = JSON.stringify(col.value);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tvalue = col.value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trowData.push(value);\n\t\t});\n\n\t\toutput.push(rowData.join(\"\\t\"));\n\t});\n\n\treturn output.join(\"\\n\");\n};\n\nClipboard.prototype.copy = function (range, internal) {\n\tvar range, sel, textRange;\n\tthis.blocked = false;\n\tthis.customSelection = false;\n\n\tif (this.mode === true || this.mode === \"copy\") {\n\n\t\tthis.rowRange = range || this.table.options.clipboardCopyRowRange;\n\n\t\tif (typeof window.getSelection != \"undefined\" && typeof document.createRange != \"undefined\") {\n\t\t\trange = document.createRange();\n\t\t\trange.selectNodeContents(this.table.element);\n\t\t\tsel = window.getSelection();\n\n\t\t\tif (sel.toString() && internal) {\n\t\t\t\tthis.customSelection = sel.toString();\n\t\t\t}\n\n\t\t\tsel.removeAllRanges();\n\t\t\tsel.addRange(range);\n\t\t} else if (typeof document.selection != \"undefined\" && typeof document.body.createTextRange != \"undefined\") {\n\t\t\ttextRange = document.body.createTextRange();\n\t\t\ttextRange.moveToElementText(this.table.element);\n\t\t\ttextRange.select();\n\t\t}\n\n\t\tdocument.execCommand('copy');\n\n\t\tif (sel) {\n\t\t\tsel.removeAllRanges();\n\t\t}\n\t}\n};\n\n//PASTE EVENT HANDLING\n\nClipboard.prototype.setPasteAction = function (action) {\n\n\tswitch (typeof action === 'undefined' ? 'undefined' : _typeof(action)) {\n\t\tcase \"string\":\n\t\t\tthis.pasteAction = this.pasteActions[action];\n\n\t\t\tif (!this.pasteAction) {\n\t\t\t\tconsole.warn(\"Clipboard Error - No such paste action found:\", action);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tthis.pasteAction = action;\n\t\t\tbreak;\n\t}\n};\n\nClipboard.prototype.setPasteParser = function (parser) {\n\tswitch (typeof parser === 'undefined' ? 'undefined' : _typeof(parser)) {\n\t\tcase \"string\":\n\t\t\tthis.pasteParser = this.pasteParsers[parser];\n\n\t\t\tif (!this.pasteParser) {\n\t\t\t\tconsole.warn(\"Clipboard Error - No such paste parser found:\", parser);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tthis.pasteParser = parser;\n\t\t\tbreak;\n\t}\n};\n\nClipboard.prototype.paste = function (e) {\n\tvar data, rowData, rows;\n\n\tif (this.checkPaseOrigin(e)) {\n\n\t\tdata = this.getPasteData(e);\n\n\t\trowData = this.pasteParser.call(this, data);\n\n\t\tif (rowData) {\n\t\t\te.preventDefault();\n\n\t\t\tif (this.table.modExists(\"mutator\")) {\n\t\t\t\trowData = this.mutateData(rowData);\n\t\t\t}\n\n\t\t\trows = this.pasteAction.call(this, rowData);\n\t\t\tthis.table.options.clipboardPasted.call(this.table, data, rowData, rows);\n\t\t} else {\n\t\t\tthis.table.options.clipboardPasteError.call(this.table, data);\n\t\t}\n\t}\n};\n\nClipboard.prototype.mutateData = function (data) {\n\tvar self = this,\n\t    output = [];\n\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(function (row) {\n\t\t\toutput.push(self.table.modules.mutator.transformRow(row, \"clipboard\"));\n\t\t});\n\t} else {\n\t\toutput = data;\n\t}\n\n\treturn output;\n};\n\nClipboard.prototype.checkPaseOrigin = function (e) {\n\tvar valid = true;\n\n\tif (e.target.tagName != \"DIV\" || this.table.modules.edit.currentCell) {\n\t\tvalid = false;\n\t}\n\n\treturn valid;\n};\n\nClipboard.prototype.getPasteData = function (e) {\n\tvar data;\n\n\tif (window.clipboardData && window.clipboardData.getData) {\n\t\tdata = window.clipboardData.getData('Text');\n\t} else if (e.clipboardData && e.clipboardData.getData) {\n\t\tdata = e.clipboardData.getData('text/plain');\n\t} else if (e.originalEvent && e.originalEvent.clipboardData.getData) {\n\t\tdata = e.originalEvent.clipboardData.getData('text/plain');\n\t}\n\n\treturn data;\n};\n\nClipboard.prototype.pasteParsers = {\n\ttable: function table(clipboard) {\n\t\tvar data = [],\n\t\t    success = false,\n\t\t    headerFindSuccess = true,\n\t\t    columns = this.table.columnManager.columns,\n\t\t    columnMap = [],\n\t\t    rows = [];\n\n\t\t//get data from clipboard into array of columns and rows.\n\t\tclipboard = clipboard.split(\"\\n\");\n\n\t\tclipboard.forEach(function (row) {\n\t\t\tdata.push(row.split(\"\\t\"));\n\t\t});\n\n\t\tif (data.length && !(data.length === 1 && data[0].length < 2)) {\n\t\t\tsuccess = true;\n\n\t\t\t//check if headers are present by title\n\t\t\tdata[0].forEach(function (value) {\n\t\t\t\tvar column = columns.find(function (column) {\n\t\t\t\t\treturn value && column.definition.title && value.trim() && column.definition.title.trim() === value.trim();\n\t\t\t\t});\n\n\t\t\t\tif (column) {\n\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t} else {\n\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//check if column headers are present by field\n\t\t\tif (!headerFindSuccess) {\n\t\t\t\theaderFindSuccess = true;\n\t\t\t\tcolumnMap = [];\n\n\t\t\t\tdata[0].forEach(function (value) {\n\t\t\t\t\tvar column = columns.find(function (column) {\n\t\t\t\t\t\treturn value && column.field && value.trim() && column.field.trim() === value.trim();\n\t\t\t\t\t});\n\n\t\t\t\t\tif (column) {\n\t\t\t\t\t\tcolumnMap.push(column);\n\t\t\t\t\t} else {\n\t\t\t\t\t\theaderFindSuccess = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (!headerFindSuccess) {\n\t\t\t\t\tcolumnMap = this.table.columnManager.columnsByIndex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//remove header row if found\n\t\t\tif (headerFindSuccess) {\n\t\t\t\tdata.shift();\n\t\t\t}\n\n\t\t\tdata.forEach(function (item) {\n\t\t\t\tvar row = {};\n\n\t\t\t\titem.forEach(function (value, i) {\n\t\t\t\t\tif (columnMap[i]) {\n\t\t\t\t\t\trow[columnMap[i].field] = value;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trows.push(row);\n\t\t\t});\n\n\t\t\treturn rows;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\nClipboard.prototype.pasteActions = {\n\treplace: function replace(rows) {\n\t\treturn this.table.setData(rows);\n\t},\n\tupdate: function update(rows) {\n\t\treturn this.table.updateOrAddData(rows);\n\t},\n\tinsert: function insert(rows) {\n\t\treturn this.table.addData(rows);\n\t}\n};\n\nTabulator.prototype.registerModule(\"clipboard\", Clipboard);\n\nvar DataTree = function DataTree(table) {\n\tthis.table = table;\n\tthis.indent = 10;\n\tthis.field = \"\";\n\tthis.collapseEl = null;\n\tthis.expandEl = null;\n\tthis.branchEl = null;\n\tthis.elementField = false;\n\n\tthis.startOpen = function () {};\n\n\tthis.displayIndex = 0;\n};\n\nDataTree.prototype.initialize = function () {\n\tvar dummyEl = null,\n\t    firstCol = this.table.columnManager.getFirstVisibileColumn(),\n\t    options = this.table.options;\n\n\tthis.field = options.dataTreeChildField;\n\tthis.indent = options.dataTreeChildIndent;\n\tthis.elementField = options.dataTreeElementColumn || (firstCol ? firstCol.field : false);\n\n\tif (options.dataTreeBranchElement) {\n\n\t\tif (options.dataTreeBranchElement === true) {\n\t\t\tthis.branchEl = document.createElement(\"div\");\n\t\t\tthis.branchEl.classList.add(\"tabulator-data-tree-branch\");\n\t\t} else {\n\t\t\tif (typeof options.dataTreeBranchElement === \"string\") {\n\t\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\t\tdummyEl.innerHTML = options.dataTreeBranchElement;\n\t\t\t\tthis.branchEl = dummyEl.firstChild;\n\t\t\t} else {\n\t\t\t\tthis.branchEl = options.dataTreeBranchElement;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (options.dataTreeCollapseElement) {\n\t\tif (typeof options.dataTreeCollapseElement === \"string\") {\n\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\tdummyEl.innerHTML = options.dataTreeCollapseElement;\n\t\t\tthis.collapseEl = dummyEl.firstChild;\n\t\t} else {\n\t\t\tthis.collapseEl = options.dataTreeCollapseElement;\n\t\t}\n\t} else {\n\t\tthis.collapseEl = document.createElement(\"div\");\n\t\tthis.collapseEl.classList.add(\"tabulator-data-tree-control\");\n\t\tthis.collapseEl.tabIndex = 0;\n\t\tthis.collapseEl.innerHTML = \"<div class='tabulator-data-tree-control-collapse'></div>\";\n\t}\n\n\tif (options.dataTreeExpandElement) {\n\t\tif (typeof options.dataTreeExpandElement === \"string\") {\n\t\t\tdummyEl = document.createElement(\"div\");\n\t\t\tdummyEl.innerHTML = options.dataTreeExpandElement;\n\t\t\tthis.expandEl = dummyEl.firstChild;\n\t\t} else {\n\t\t\tthis.expandEl = options.dataTreeExpandElement;\n\t\t}\n\t} else {\n\t\tthis.expandEl = document.createElement(\"div\");\n\t\tthis.expandEl.classList.add(\"tabulator-data-tree-control\");\n\t\tthis.expandEl.tabIndex = 0;\n\t\tthis.expandEl.innerHTML = \"<div class='tabulator-data-tree-control-expand'></div>\";\n\t}\n\n\tswitch (_typeof(options.dataTreeStartExpanded)) {\n\t\tcase \"boolean\":\n\t\t\tthis.startOpen = function (row, index) {\n\t\t\t\treturn options.dataTreeStartExpanded;\n\t\t\t};\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tthis.startOpen = options.dataTreeStartExpanded;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tthis.startOpen = function (row, index) {\n\t\t\t\treturn options.dataTreeStartExpanded[index];\n\t\t\t};\n\t\t\tbreak;\n\t}\n};\n\nDataTree.prototype.initializeRow = function (row) {\n\tvar childArray = row.getData()[this.field];\n\tvar isArray = Array.isArray(childArray);\n\n\tvar children = isArray || !isArray && (typeof childArray === 'undefined' ? 'undefined' : _typeof(childArray)) === \"object\" && childArray !== null;\n\n\tif (!children && row.modules.dataTree && row.modules.dataTree.branchEl) {\n\t\trow.modules.dataTree.branchEl.parentNode.removeChild(row.modules.dataTree.branchEl);\n\t}\n\n\tif (!children && row.modules.dataTree && row.modules.dataTree.controlEl) {\n\t\trow.modules.dataTree.controlEl.parentNode.removeChild(row.modules.dataTree.controlEl);\n\t}\n\n\trow.modules.dataTree = {\n\t\tindex: row.modules.dataTree ? row.modules.dataTree.index : 0,\n\t\topen: children ? row.modules.dataTree ? row.modules.dataTree.open : this.startOpen(row.getComponent(), 0) : false,\n\t\tcontrolEl: row.modules.dataTree && children ? row.modules.dataTree.controlEl : false,\n\t\tbranchEl: row.modules.dataTree && children ? row.modules.dataTree.branchEl : false,\n\t\tparent: row.modules.dataTree ? row.modules.dataTree.parent : false,\n\t\tchildren: children\n\t};\n};\n\nDataTree.prototype.layoutRow = function (row) {\n\tvar cell = this.elementField ? row.getCell(this.elementField) : row.getCells()[0],\n\t    el = cell.getElement(),\n\t    config = row.modules.dataTree;\n\n\tif (config.branchEl) {\n\t\tif (config.branchEl.parentNode) {\n\t\t\tconfig.branchEl.parentNode.removeChild(config.branchEl);\n\t\t}\n\t\tconfig.branchEl = false;\n\t}\n\n\tif (config.controlEl) {\n\t\tif (config.controlEl.parentNode) {\n\t\t\tconfig.controlEl.parentNode.removeChild(config.controlEl);\n\t\t}\n\t\tconfig.controlEl = false;\n\t}\n\n\tthis.generateControlElement(row, el);\n\n\trow.getElement().classList.add(\"tabulator-tree-level-\" + config.index);\n\n\tif (config.index) {\n\t\tif (this.branchEl) {\n\t\t\tconfig.branchEl = this.branchEl.cloneNode(true);\n\t\t\tel.insertBefore(config.branchEl, el.firstChild);\n\n\t\t\tif (this.table.rtl) {\n\t\t\t\tconfig.branchEl.style.marginRight = (config.branchEl.offsetWidth + config.branchEl.style.marginLeft) * (config.index - 1) + config.index * this.indent + \"px\";\n\t\t\t} else {\n\t\t\t\tconfig.branchEl.style.marginLeft = (config.branchEl.offsetWidth + config.branchEl.style.marginRight) * (config.index - 1) + config.index * this.indent + \"px\";\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (this.table.rtl) {\n\t\t\t\tel.style.paddingRight = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-right')) + config.index * this.indent + \"px\";\n\t\t\t} else {\n\t\t\t\tel.style.paddingLeft = parseInt(window.getComputedStyle(el, null).getPropertyValue('padding-left')) + config.index * this.indent + \"px\";\n\t\t\t}\n\t\t}\n\t}\n};\n\nDataTree.prototype.generateControlElement = function (row, el) {\n\tvar _this47 = this;\n\n\tvar config = row.modules.dataTree,\n\t    el = el || row.getCells()[0].getElement(),\n\t    oldControl = config.controlEl;\n\n\tif (config.children !== false) {\n\n\t\tif (config.open) {\n\t\t\tconfig.controlEl = this.collapseEl.cloneNode(true);\n\t\t\tconfig.controlEl.addEventListener(\"click\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\t_this47.collapseRow(row);\n\t\t\t});\n\t\t} else {\n\t\t\tconfig.controlEl = this.expandEl.cloneNode(true);\n\t\t\tconfig.controlEl.addEventListener(\"click\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\t_this47.expandRow(row);\n\t\t\t});\n\t\t}\n\n\t\tconfig.controlEl.addEventListener(\"mousedown\", function (e) {\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tif (oldControl && oldControl.parentNode === el) {\n\t\t\toldControl.parentNode.replaceChild(config.controlEl, oldControl);\n\t\t} else {\n\t\t\tel.insertBefore(config.controlEl, el.firstChild);\n\t\t}\n\t}\n};\n\nDataTree.prototype.setDisplayIndex = function (index) {\n\tthis.displayIndex = index;\n};\n\nDataTree.prototype.getDisplayIndex = function () {\n\treturn this.displayIndex;\n};\n\nDataTree.prototype.getRows = function (rows) {\n\tvar _this48 = this;\n\n\tvar output = [];\n\n\trows.forEach(function (row, i) {\n\t\tvar config, children;\n\n\t\toutput.push(row);\n\n\t\tif (row instanceof Row) {\n\n\t\t\trow.create();\n\n\t\t\tconfig = row.modules.dataTree.children;\n\n\t\t\tif (!config.index && config.children !== false) {\n\t\t\t\tchildren = _this48.getChildren(row);\n\n\t\t\t\tchildren.forEach(function (child) {\n\t\t\t\t\tchild.create();\n\t\t\t\t\toutput.push(child);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\treturn output;\n};\n\nDataTree.prototype.getChildren = function (row, allChildren) {\n\tvar _this49 = this;\n\n\tvar config = row.modules.dataTree,\n\t    children = [],\n\t    output = [];\n\n\tif (config.children !== false && (config.open || allChildren)) {\n\t\tif (!Array.isArray(config.children)) {\n\t\t\tconfig.children = this.generateChildren(row);\n\t\t}\n\n\t\tif (this.table.modExists(\"filter\") && this.table.options.dataTreeFilter) {\n\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t} else {\n\t\t\tchildren = config.children;\n\t\t}\n\n\t\tif (this.table.modExists(\"sort\") && this.table.options.dataTreeSort) {\n\t\t\tthis.table.modules.sort.sort(children);\n\t\t}\n\n\t\tchildren.forEach(function (child) {\n\t\t\toutput.push(child);\n\n\t\t\tvar subChildren = _this49.getChildren(child);\n\n\t\t\tsubChildren.forEach(function (sub) {\n\t\t\t\toutput.push(sub);\n\t\t\t});\n\t\t});\n\t}\n\n\treturn output;\n};\n\nDataTree.prototype.generateChildren = function (row) {\n\tvar _this50 = this;\n\n\tvar children = [];\n\n\tvar childArray = row.getData()[this.field];\n\n\tif (!Array.isArray(childArray)) {\n\t\tchildArray = [childArray];\n\t}\n\n\tchildArray.forEach(function (childData) {\n\t\tvar childRow = new Row(childData || {}, _this50.table.rowManager);\n\n\t\tchildRow.create();\n\n\t\tchildRow.modules.dataTree.index = row.modules.dataTree.index + 1;\n\t\tchildRow.modules.dataTree.parent = row;\n\n\t\tif (childRow.modules.dataTree.children) {\n\t\t\tchildRow.modules.dataTree.open = _this50.startOpen(childRow.getComponent(), childRow.modules.dataTree.index);\n\t\t}\n\t\tchildren.push(childRow);\n\t});\n\n\treturn children;\n};\n\nDataTree.prototype.expandRow = function (row, silent) {\n\tvar config = row.modules.dataTree;\n\n\tif (config.children !== false) {\n\t\tconfig.open = true;\n\n\t\trow.reinitialize();\n\n\t\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n\n\t\tthis.table.options.dataTreeRowExpanded(row.getComponent(), row.modules.dataTree.index);\n\t}\n};\n\nDataTree.prototype.collapseRow = function (row) {\n\tvar config = row.modules.dataTree;\n\n\tif (config.children !== false) {\n\t\tconfig.open = false;\n\n\t\trow.reinitialize();\n\n\t\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n\n\t\tthis.table.options.dataTreeRowCollapsed(row.getComponent(), row.modules.dataTree.index);\n\t}\n};\n\nDataTree.prototype.toggleRow = function (row) {\n\tvar config = row.modules.dataTree;\n\n\tif (config.children !== false) {\n\t\tif (config.open) {\n\t\t\tthis.collapseRow(row);\n\t\t} else {\n\t\t\tthis.expandRow(row);\n\t\t}\n\t}\n};\n\nDataTree.prototype.getTreeParent = function (row) {\n\treturn row.modules.dataTree.parent ? row.modules.dataTree.parent.getComponent() : false;\n};\n\nDataTree.prototype.getFilteredTreeChildren = function (row) {\n\tvar config = row.modules.dataTree,\n\t    output = [],\n\t    children;\n\n\tif (config.children) {\n\n\t\tif (!Array.isArray(config.children)) {\n\t\t\tconfig.children = this.generateChildren(row);\n\t\t}\n\n\t\tif (this.table.modExists(\"filter\") && this.table.options.dataTreeFilter) {\n\t\t\tchildren = this.table.modules.filter.filter(config.children);\n\t\t} else {\n\t\t\tchildren = config.children;\n\t\t}\n\n\t\tchildren.forEach(function (childRow) {\n\t\t\tif (childRow instanceof Row) {\n\t\t\t\toutput.push(childRow);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn output;\n};\n\nDataTree.prototype.rowDelete = function (row) {\n\tvar parent = row.modules.dataTree.parent,\n\t    childIndex;\n\n\tif (parent) {\n\t\tchildIndex = this.findChildIndex(row, parent);\n\n\t\tif (childIndex !== false) {\n\t\t\tparent.data[this.field].splice(childIndex, 1);\n\t\t}\n\n\t\tif (!parent.data[this.field].length) {\n\t\t\tdelete parent.data[this.field];\n\t\t}\n\n\t\tthis.initializeRow(parent);\n\t\tthis.layoutRow(parent);\n\t}\n\n\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n};\n\nDataTree.prototype.addTreeChildRow = function (row, data, top, index) {\n\tvar childIndex = false;\n\n\tif (typeof data === \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\n\tif (!Array.isArray(row.data[this.field])) {\n\t\trow.data[this.field] = [];\n\n\t\trow.modules.dataTree.open = this.startOpen(row.getComponent(), row.modules.dataTree.index);\n\t}\n\n\tif (typeof index !== \"undefined\") {\n\t\tchildIndex = this.findChildIndex(index, row);\n\n\t\tif (childIndex !== false) {\n\t\t\trow.data[this.field].splice(top ? childIndex : childIndex + 1, 0, data);\n\t\t}\n\t}\n\n\tif (childIndex === false) {\n\t\tif (top) {\n\t\t\trow.data[this.field].unshift(data);\n\t\t} else {\n\t\t\trow.data[this.field].push(data);\n\t\t}\n\t}\n\n\tthis.initializeRow(row);\n\tthis.layoutRow(row);\n\n\tthis.table.rowManager.refreshActiveData(\"tree\", false, true);\n};\n\nDataTree.prototype.findChildIndex = function (subject, parent) {\n\tvar _this51 = this;\n\n\tvar match = false;\n\n\tif ((typeof subject === 'undefined' ? 'undefined' : _typeof(subject)) == \"object\") {\n\n\t\tif (subject instanceof Row) {\n\t\t\t//subject is row element\n\t\t\tmatch = subject.data;\n\t\t} else if (subject instanceof RowComponent) {\n\t\t\t//subject is public row component\n\t\t\tmatch = subject._getSelf().data;\n\t\t} else if (typeof HTMLElement !== \"undefined\" && subject instanceof HTMLElement) {\n\t\t\tif (parent.modules.dataTree) {\n\t\t\t\tmatch = parent.modules.dataTree.children.find(function (childRow) {\n\t\t\t\t\treturn childRow instanceof Row ? childRow.element === subject : false;\n\t\t\t\t});\n\n\t\t\t\tif (match) {\n\t\t\t\t\tmatch = match.data;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else if (typeof subject == \"undefined\" || subject === null) {\n\t\tmatch = false;\n\t} else {\n\t\t//subject should be treated as the index of the row\n\t\tmatch = parent.data[this.field].find(function (row) {\n\t\t\treturn row.data[_this51.table.options.index] == subject;\n\t\t});\n\t}\n\n\tif (match) {\n\n\t\tif (Array.isArray(parent.data[this.field])) {\n\t\t\tmatch = parent.data[this.field].indexOf(match);\n\t\t}\n\n\t\tif (match == -1) {\n\t\t\tmatch = false;\n\t\t}\n\t}\n\n\t//catch all for any other type of input\n\n\treturn match;\n};\n\nDataTree.prototype.getTreeChildren = function (row, component, recurse) {\n\tvar _this52 = this;\n\n\tvar config = row.modules.dataTree,\n\t    output = [];\n\n\tif (config.children) {\n\n\t\tif (!Array.isArray(config.children)) {\n\t\t\tconfig.children = this.generateChildren(row);\n\t\t}\n\n\t\tconfig.children.forEach(function (childRow) {\n\t\t\tif (childRow instanceof Row) {\n\t\t\t\toutput.push(component ? childRow.getComponent() : childRow);\n\n\t\t\t\tif (recurse) {\n\t\t\t\t\toutput = output.concat(_this52.getTreeChildren(childRow, component, recurse));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn output;\n};\n\nDataTree.prototype.checkForRestyle = function (cell) {\n\tif (!cell.row.cells.indexOf(cell)) {\n\t\tcell.row.reinitialize();\n\t}\n};\n\nDataTree.prototype.getChildField = function () {\n\treturn this.field;\n};\n\nDataTree.prototype.redrawNeeded = function (data) {\n\treturn (this.field ? typeof data[this.field] !== \"undefined\" : false) || (this.elementField ? typeof data[this.elementField] !== \"undefined\" : false);\n};\n\nTabulator.prototype.registerModule(\"dataTree\", DataTree);\n\nvar Download = function Download(table) {\n\tthis.table = table; //hold Tabulator object\n};\n\n//trigger file download\nDownload.prototype.download = function (type, filename, options, range, interceptCallback) {\n\tvar self = this,\n\t    downloadFunc = false;\n\n\tfunction buildLink(data, mime) {\n\t\tif (interceptCallback) {\n\t\t\tif (interceptCallback === true) {\n\t\t\t\tself.triggerDownload(data, mime, type, filename, true);\n\t\t\t} else {\n\t\t\t\tinterceptCallback(data);\n\t\t\t}\n\t\t} else {\n\t\t\tself.triggerDownload(data, mime, type, filename);\n\t\t}\n\t}\n\n\tif (typeof type == \"function\") {\n\t\tdownloadFunc = type;\n\t} else {\n\t\tif (self.downloaders[type]) {\n\t\t\tdownloadFunc = self.downloaders[type];\n\t\t} else {\n\t\t\tconsole.warn(\"Download Error - No such download type found: \", type);\n\t\t}\n\t}\n\n\tif (downloadFunc) {\n\t\tvar list = this.generateExportList(range);\n\n\t\tdownloadFunc.call(this.table, list, options || {}, buildLink);\n\t}\n};\n\nDownload.prototype.generateExportList = function (range) {\n\tvar list = this.table.modules.export.generateExportList(this.table.options.downloadConfig, false, range || this.table.options.downloadRowRange, \"download\");\n\n\t//assign group header formatter\n\tvar groupHeader = this.table.options.groupHeaderDownload;\n\n\tif (groupHeader && !Array.isArray(groupHeader)) {\n\t\tgroupHeader = [groupHeader];\n\t}\n\n\tlist.forEach(function (row) {\n\t\tvar group;\n\n\t\tif (row.type === \"group\") {\n\t\t\tgroup = row.columns[0];\n\n\t\t\tif (groupHeader && groupHeader[row.indent]) {\n\t\t\t\tgroup.value = groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn list;\n};\n\nDownload.prototype.triggerDownload = function (data, mime, type, filename, newTab) {\n\tvar element = document.createElement('a'),\n\t    blob = new Blob([data], { type: mime }),\n\t    filename = filename || \"Tabulator.\" + (typeof type === \"function\" ? \"txt\" : type);\n\n\tblob = this.table.options.downloadReady.call(this.table, data, blob);\n\n\tif (blob) {\n\n\t\tif (newTab) {\n\t\t\twindow.open(window.URL.createObjectURL(blob));\n\t\t} else {\n\t\t\tif (navigator.msSaveOrOpenBlob) {\n\t\t\t\tnavigator.msSaveOrOpenBlob(blob, filename);\n\t\t\t} else {\n\t\t\t\telement.setAttribute('href', window.URL.createObjectURL(blob));\n\n\t\t\t\t//set file title\n\t\t\t\telement.setAttribute('download', filename);\n\n\t\t\t\t//trigger download\n\t\t\t\telement.style.display = 'none';\n\t\t\t\tdocument.body.appendChild(element);\n\t\t\t\telement.click();\n\n\t\t\t\t//remove temporary link element\n\t\t\t\tdocument.body.removeChild(element);\n\t\t\t}\n\t\t}\n\n\t\tif (this.table.options.downloadComplete) {\n\t\t\tthis.table.options.downloadComplete();\n\t\t}\n\t}\n};\n\nDownload.prototype.commsReceived = function (table, action, data) {\n\tswitch (action) {\n\t\tcase \"intercept\":\n\t\t\tthis.download(data.type, \"\", data.options, data.active, data.intercept);\n\t\t\tbreak;\n\t}\n};\n\n//downloaders\nDownload.prototype.downloaders = {\n\tcsv: function csv(list, options, setFileContents) {\n\t\tvar delimiter = options && options.delimiter ? options.delimiter : \",\",\n\t\t    fileContents = [],\n\t\t    headers = [];\n\n\t\tlist.forEach(function (row) {\n\t\t\tvar item = [];\n\n\t\t\tswitch (row.type) {\n\t\t\t\tcase \"group\":\n\t\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process row groups\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"calc\":\n\t\t\t\t\tconsole.warn(\"Download Warning - CSV downloader cannot process column calculations\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"header\":\n\t\t\t\t\trow.columns.forEach(function (col, i) {\n\t\t\t\t\t\tif (col && col.depth === 1) {\n\t\t\t\t\t\t\theaders[i] = typeof col.value == \"undefined\" || col.value === null ? \"\" : '\"' + String(col.value).split('\"').join('\"\"') + '\"';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"row\":\n\t\t\t\t\trow.columns.forEach(function (col) {\n\n\t\t\t\t\t\tif (col) {\n\n\t\t\t\t\t\t\tswitch (_typeof(col.value)) {\n\t\t\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\t\t\tcol.value = JSON.stringify(col.value);\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tcase \"null\":\n\t\t\t\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\titem.push('\"' + String(col.value).split('\"').join('\"\"') + '\"');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tfileContents.push(item.join(delimiter));\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif (headers.length) {\n\t\t\tfileContents.unshift(headers.join(delimiter));\n\t\t}\n\n\t\tfileContents = fileContents.join(\"\\n\");\n\n\t\tif (options.bom) {\n\t\t\tfileContents = '\\uFEFF' + fileContents;\n\t\t}\n\n\t\tsetFileContents(fileContents, \"text/csv\");\n\t},\n\n\tjson: function json(list, options, setFileContents) {\n\t\tvar fileContents = [];\n\n\t\tlist.forEach(function (row) {\n\t\t\tvar item = {};\n\n\t\t\tswitch (row.type) {\n\t\t\t\tcase \"header\":\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"group\":\n\t\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process row groups\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"calc\":\n\t\t\t\t\tconsole.warn(\"Download Warning - JSON downloader cannot process column calculations\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"row\":\n\t\t\t\t\trow.columns.forEach(function (col) {\n\t\t\t\t\t\tif (col) {\n\t\t\t\t\t\t\titem[col.component.getField()] = col.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tfileContents.push(item);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tfileContents = JSON.stringify(fileContents, null, '\\t');\n\n\t\tsetFileContents(fileContents, \"application/json\");\n\t},\n\n\tpdf: function pdf(list, options, setFileContents) {\n\t\tvar header = [],\n\t\t    body = [],\n\t\t    autoTableParams = {},\n\t\t    rowGroupStyles = options.rowGroupStyles || {\n\t\t\tfontStyle: \"bold\",\n\t\t\tfontSize: 12,\n\t\t\tcellPadding: 6,\n\t\t\tfillColor: 220\n\t\t},\n\t\t    rowCalcStyles = options.rowCalcStyles || {\n\t\t\tfontStyle: \"bold\",\n\t\t\tfontSize: 10,\n\t\t\tcellPadding: 4,\n\t\t\tfillColor: 232\n\t\t},\n\t\t    jsPDFParams = options.jsPDF || {},\n\t\t    title = options && options.title ? options.title : \"\";\n\n\t\tif (!jsPDFParams.orientation) {\n\t\t\tjsPDFParams.orientation = options.orientation || \"landscape\";\n\t\t}\n\n\t\tif (!jsPDFParams.unit) {\n\t\t\tjsPDFParams.unit = \"pt\";\n\t\t}\n\n\t\t//parse row list\n\t\tlist.forEach(function (row) {\n\t\t\tvar item = {};\n\n\t\t\tswitch (row.type) {\n\t\t\t\tcase \"header\":\n\t\t\t\t\theader.push(parseRow(row));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"group\":\n\t\t\t\t\tbody.push(parseRow(row, rowGroupStyles));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"calc\":\n\t\t\t\t\tbody.push(parseRow(row, rowCalcStyles));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"row\":\n\t\t\t\t\tbody.push(parseRow(row));\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tfunction parseRow(row, styles) {\n\t\t\tvar rowData = [];\n\n\t\t\trow.columns.forEach(function (col) {\n\t\t\t\tvar cell;\n\n\t\t\t\tif (col) {\n\t\t\t\t\tswitch (_typeof(col.value)) {\n\t\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\t\tcol.value = JSON.stringify(col.value);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\tcase \"null\":\n\t\t\t\t\t\t\tcol.value = \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcell = {\n\t\t\t\t\t\tcontent: col.value,\n\t\t\t\t\t\tcolSpan: col.width,\n\t\t\t\t\t\trowSpan: col.height\n\t\t\t\t\t};\n\n\t\t\t\t\tif (styles) {\n\t\t\t\t\t\tcell.styles = styles;\n\t\t\t\t\t}\n\n\t\t\t\t\trowData.push(cell);\n\t\t\t\t} else {\n\t\t\t\t\trowData.push(\"\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn rowData;\n\t\t}\n\n\t\t//configure PDF\n\t\tvar doc = new jsPDF(jsPDFParams); //set document to landscape, better for most tables\n\n\t\tif (options && options.autoTable) {\n\t\t\tif (typeof options.autoTable === \"function\") {\n\t\t\t\tautoTableParams = options.autoTable(doc) || {};\n\t\t\t} else {\n\t\t\t\tautoTableParams = options.autoTable;\n\t\t\t}\n\t\t}\n\n\t\tif (title) {\n\t\t\tautoTableParams.addPageContent = function (data) {\n\t\t\t\tdoc.text(title, 40, 30);\n\t\t\t};\n\t\t}\n\n\t\tautoTableParams.head = header;\n\t\tautoTableParams.body = body;\n\n\t\tdoc.autoTable(autoTableParams);\n\n\t\tif (options && options.documentProcessing) {\n\t\t\toptions.documentProcessing(doc);\n\t\t}\n\n\t\tsetFileContents(doc.output(\"arraybuffer\"), \"application/pdf\");\n\t},\n\n\txlsx: function xlsx(list, options, setFileContents) {\n\t\tvar self = this,\n\t\t    sheetName = options.sheetName || \"Sheet1\",\n\t\t    workbook = XLSX.utils.book_new(),\n\t\t    output;\n\n\t\tworkbook.SheetNames = [];\n\t\tworkbook.Sheets = {};\n\n\t\tfunction generateSheet() {\n\t\t\tvar rows = [],\n\t\t\t    merges = [],\n\t\t\t    worksheet = {},\n\t\t\t    range = { s: { c: 0, r: 0 }, e: { c: list[0] ? list[0].columns.reduce(function (a, b) {\n\t\t\t\t\t\treturn a + (b && b.width ? b.width : 1);\n\t\t\t\t\t}, 0) : 0, r: list.length } };\n\n\t\t\t//parse row list\n\t\t\tlist.forEach(function (row, i) {\n\t\t\t\tvar rowData = [];\n\n\t\t\t\trow.columns.forEach(function (col, j) {\n\n\t\t\t\t\tif (col) {\n\t\t\t\t\t\trowData.push(!(col.value instanceof Date) && _typeof(col.value) === \"object\" ? JSON.stringify(col.value) : col.value);\n\n\t\t\t\t\t\tif (col.width > 1 || col.height > -1) {\n\t\t\t\t\t\t\tmerges.push({ s: { r: i, c: j }, e: { r: i + col.height - 1, c: j + col.width - 1 } });\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trowData.push(\"\");\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trows.push(rowData);\n\t\t\t});\n\n\t\t\t//convert rows to worksheet\n\t\t\tXLSX.utils.sheet_add_aoa(worksheet, rows);\n\n\t\t\tworksheet['!ref'] = XLSX.utils.encode_range(range);\n\n\t\t\tif (merges.length) {\n\t\t\t\tworksheet[\"!merges\"] = merges;\n\t\t\t}\n\n\t\t\treturn worksheet;\n\t\t}\n\n\t\tif (options.sheetOnly) {\n\t\t\tsetFileContents(generateSheet());\n\t\t\treturn;\n\t\t}\n\n\t\tif (options.sheets) {\n\t\t\tfor (var sheet in options.sheets) {\n\n\t\t\t\tif (options.sheets[sheet] === true) {\n\t\t\t\t\tworkbook.SheetNames.push(sheet);\n\t\t\t\t\tworkbook.Sheets[sheet] = generateSheet();\n\t\t\t\t} else {\n\n\t\t\t\t\tworkbook.SheetNames.push(sheet);\n\n\t\t\t\t\tthis.modules.comms.send(options.sheets[sheet], \"download\", \"intercept\", {\n\t\t\t\t\t\ttype: \"xlsx\",\n\t\t\t\t\t\toptions: { sheetOnly: true },\n\t\t\t\t\t\tactive: self.active,\n\t\t\t\t\t\tintercept: function intercept(data) {\n\t\t\t\t\t\t\tworkbook.Sheets[sheet] = data;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tworkbook.SheetNames.push(sheetName);\n\t\t\tworkbook.Sheets[sheetName] = generateSheet();\n\t\t}\n\n\t\tif (options.documentProcessing) {\n\t\t\tworkbook = options.documentProcessing(workbook);\n\t\t}\n\n\t\t//convert workbook to binary array\n\t\tfunction s2ab(s) {\n\t\t\tvar buf = new ArrayBuffer(s.length);\n\t\t\tvar view = new Uint8Array(buf);\n\t\t\tfor (var i = 0; i != s.length; ++i) {\n\t\t\t\tview[i] = s.charCodeAt(i) & 0xFF;\n\t\t\t}return buf;\n\t\t}\n\n\t\toutput = XLSX.write(workbook, { bookType: 'xlsx', bookSST: true, type: 'binary' });\n\n\t\tsetFileContents(s2ab(output), \"application/octet-stream\");\n\t},\n\n\thtml: function html(list, options, setFileContents) {\n\t\tif (this.modExists(\"export\", true)) {\n\t\t\tsetFileContents(this.modules.export.genereateHTMLTable(list), \"text/html\");\n\t\t}\n\t}\n\n};\n\nTabulator.prototype.registerModule(\"download\", Download);\n\nvar Edit = function Edit(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.currentCell = false; //hold currently editing cell\n\tthis.mouseClick = false; //hold mousedown state to prevent click binding being overriden by editor opening\n\tthis.recursionBlock = false; //prevent focus recursion\n\tthis.invalidEdit = false;\n\tthis.editedCells = [];\n};\n\n//initialize column editor\nEdit.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    config = {\n\t\teditor: false,\n\t\tblocked: false,\n\t\tcheck: column.definition.editable,\n\t\tparams: column.definition.editorParams || {}\n\t};\n\n\t//set column editor\n\tswitch (_typeof(column.definition.editor)) {\n\t\tcase \"string\":\n\n\t\t\tif (column.definition.editor === \"tick\") {\n\t\t\t\tcolumn.definition.editor = \"tickCross\";\n\t\t\t\tconsole.warn(\"DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor\");\n\t\t\t}\n\n\t\t\tif (self.editors[column.definition.editor]) {\n\t\t\t\tconfig.editor = self.editors[column.definition.editor];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Editor Error - No such editor found: \", column.definition.editor);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tconfig.editor = column.definition.editor;\n\t\t\tbreak;\n\n\t\tcase \"boolean\":\n\n\t\t\tif (column.definition.editor === true) {\n\n\t\t\t\tif (typeof column.definition.formatter !== \"function\") {\n\n\t\t\t\t\tif (column.definition.formatter === \"tick\") {\n\t\t\t\t\t\tcolumn.definition.formatter = \"tickCross\";\n\t\t\t\t\t\tconsole.warn(\"DEPRECATION WARNING - the tick editor has been deprecated, please use the tickCross editor\");\n\t\t\t\t\t}\n\n\t\t\t\t\tif (self.editors[column.definition.formatter]) {\n\t\t\t\t\t\tconfig.editor = self.editors[column.definition.formatter];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.editor = self.editors[\"input\"];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Editor Error - Cannot auto lookup editor for a custom formatter: \", column.definition.formatter);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t}\n\n\tif (config.editor) {\n\t\tcolumn.modules.edit = config;\n\t}\n};\n\nEdit.prototype.getCurrentCell = function () {\n\treturn this.currentCell ? this.currentCell.getComponent() : false;\n};\n\nEdit.prototype.clearEditor = function (cancel) {\n\tvar cell = this.currentCell,\n\t    cellEl;\n\n\tthis.invalidEdit = false;\n\n\tif (cell) {\n\t\tthis.currentCell = false;\n\n\t\tcellEl = cell.getElement();\n\n\t\tif (cancel) {\n\t\t\tcell.validate();\n\t\t} else {\n\t\t\tcellEl.classList.remove(\"tabulator-validation-fail\");\n\t\t}\n\n\t\tcellEl.classList.remove(\"tabulator-editing\");\n\t\twhile (cellEl.firstChild) {\n\t\t\tcellEl.removeChild(cellEl.firstChild);\n\t\t}cell.row.getElement().classList.remove(\"tabulator-row-editing\");\n\t}\n};\n\nEdit.prototype.cancelEdit = function () {\n\n\tif (this.currentCell) {\n\t\tvar cell = this.currentCell;\n\t\tvar component = this.currentCell.getComponent();\n\n\t\tthis.clearEditor(true);\n\t\tcell.setValueActual(cell.getValue());\n\t\tcell.cellRendered();\n\n\t\tif (cell.column.definition.editor == \"textarea\" || cell.column.definition.variableHeight) {\n\t\t\tcell.row.normalizeHeight(true);\n\t\t}\n\n\t\tif (cell.column.cellEvents.cellEditCancelled) {\n\t\t\tcell.column.cellEvents.cellEditCancelled.call(this.table, component);\n\t\t}\n\n\t\tthis.table.options.cellEditCancelled.call(this.table, component);\n\t}\n};\n\n//return a formatted value for a cell\nEdit.prototype.bindEditor = function (cell) {\n\tvar self = this,\n\t    element = cell.getElement(true);\n\n\telement.setAttribute(\"tabindex\", 0);\n\n\telement.addEventListener(\"click\", function (e) {\n\t\tif (!element.classList.contains(\"tabulator-editing\")) {\n\t\t\telement.focus({ preventScroll: true });\n\t\t}\n\t});\n\n\telement.addEventListener(\"mousedown\", function (e) {\n\t\tif (e.button === 2) {\n\t\t\te.preventDefault();\n\t\t} else {\n\t\t\tself.mouseClick = true;\n\t\t}\n\t});\n\n\telement.addEventListener(\"focus\", function (e) {\n\t\tif (!self.recursionBlock) {\n\t\t\tself.edit(cell, e, false);\n\t\t}\n\t});\n};\n\nEdit.prototype.focusCellNoEvent = function (cell, block) {\n\tthis.recursionBlock = true;\n\tif (!(block && this.table.browser === \"ie\")) {\n\t\tcell.getElement().focus({ preventScroll: true });\n\t}\n\tthis.recursionBlock = false;\n};\n\nEdit.prototype.editCell = function (cell, forceEdit) {\n\tthis.focusCellNoEvent(cell);\n\tthis.edit(cell, false, forceEdit);\n};\n\nEdit.prototype.focusScrollAdjust = function (cell) {\n\tif (this.table.rowManager.getRenderMode() == \"virtual\") {\n\t\tvar topEdge = this.table.rowManager.element.scrollTop,\n\t\t    bottomEdge = this.table.rowManager.element.clientHeight + this.table.rowManager.element.scrollTop,\n\t\t    rowEl = cell.row.getElement(),\n\t\t    offset = rowEl.offsetTop;\n\n\t\tif (rowEl.offsetTop < topEdge) {\n\t\t\tthis.table.rowManager.element.scrollTop -= topEdge - rowEl.offsetTop;\n\t\t} else {\n\t\t\tif (rowEl.offsetTop + rowEl.offsetHeight > bottomEdge) {\n\t\t\t\tthis.table.rowManager.element.scrollTop += rowEl.offsetTop + rowEl.offsetHeight - bottomEdge;\n\t\t\t}\n\t\t}\n\n\t\tvar leftEdge = this.table.rowManager.element.scrollLeft,\n\t\t    rightEdge = this.table.rowManager.element.clientWidth + this.table.rowManager.element.scrollLeft,\n\t\t    cellEl = cell.getElement(),\n\t\t    offset = cellEl.offsetLeft;\n\n\t\tif (this.table.modExists(\"frozenColumns\")) {\n\t\t\tleftEdge += parseInt(this.table.modules.frozenColumns.leftMargin);\n\t\t\trightEdge -= parseInt(this.table.modules.frozenColumns.rightMargin);\n\t\t}\n\n\t\tif (this.table.options.virtualDomHoz) {\n\t\t\tleftEdge -= parseInt(this.table.vdomHoz.vDomPadLeft);\n\t\t\trightEdge -= parseInt(this.table.vdomHoz.vDomPadLeft);\n\t\t}\n\n\t\tif (cellEl.offsetLeft < leftEdge) {\n\n\t\t\tthis.table.rowManager.element.scrollLeft -= leftEdge - cellEl.offsetLeft;\n\t\t} else {\n\t\t\tif (cellEl.offsetLeft + cellEl.offsetWidth > rightEdge) {\n\t\t\t\tthis.table.rowManager.element.scrollLeft += cellEl.offsetLeft + cellEl.offsetWidth - rightEdge;\n\t\t\t}\n\t\t}\n\t}\n};\n\nEdit.prototype.edit = function (cell, e, forceEdit) {\n\tvar self = this,\n\t    allowEdit = true,\n\t    rendered = function rendered() {},\n\t    element = cell.getElement(),\n\t    cellEditor,\n\t    component,\n\t    params;\n\n\t//prevent editing if another cell is refusing to leave focus (eg. validation fail)\n\tif (this.currentCell) {\n\t\tif (!this.invalidEdit) {\n\t\t\tthis.cancelEdit();\n\t\t}\n\t\treturn;\n\t}\n\n\t//handle successfull value change\n\tfunction success(value) {\n\t\tif (self.currentCell === cell) {\n\t\t\tvar valid = true;\n\n\t\t\tif (cell.column.modules.validate && self.table.modExists(\"validate\") && self.table.options.validationMode != \"manual\") {\n\t\t\t\tvalid = self.table.modules.validate.validate(cell.column.modules.validate, cell, value);\n\t\t\t}\n\n\t\t\tif (valid === true || self.table.options.validationMode === \"highlight\") {\n\t\t\t\tself.clearEditor();\n\n\t\t\t\tif (!cell.modules.edit) {\n\t\t\t\t\tcell.modules.edit = {};\n\t\t\t\t}\n\n\t\t\t\tcell.modules.edit.edited = true;\n\n\t\t\t\tif (self.editedCells.indexOf(cell) == -1) {\n\t\t\t\t\tself.editedCells.push(cell);\n\t\t\t\t}\n\n\t\t\t\tcell.setValue(value, true);\n\n\t\t\t\tif (self.table.options.dataTree && self.table.modExists(\"dataTree\")) {\n\t\t\t\t\tself.table.modules.dataTree.checkForRestyle(cell);\n\t\t\t\t}\n\n\t\t\t\tif (valid !== true) {\n\t\t\t\t\telement.classList.add(\"tabulator-validation-fail\");\n\t\t\t\t\tself.table.options.validationFailed.call(self.table, cell.getComponent(), value, valid);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tself.invalidEdit = true;\n\t\t\t\telement.classList.add(\"tabulator-validation-fail\");\n\t\t\t\tself.focusCellNoEvent(cell, true);\n\t\t\t\trendered();\n\t\t\t\tself.table.options.validationFailed.call(self.table, cell.getComponent(), value, valid);\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\t// console.warn(\"Edit Success Error - cannot call success on a cell that is no longer being edited\");\n\t\t}\n\t}\n\n\t//handle aborted edit\n\tfunction cancel() {\n\t\tif (self.currentCell === cell) {\n\t\t\tself.cancelEdit();\n\n\t\t\tif (self.table.options.dataTree && self.table.modExists(\"dataTree\")) {\n\t\t\t\tself.table.modules.dataTree.checkForRestyle(cell);\n\t\t\t}\n\t\t} else {\n\t\t\t// console.warn(\"Edit Success Error - cannot call cancel on a cell that is no longer being edited\");\n\t\t}\n\t}\n\n\tfunction onRendered(callback) {\n\t\trendered = callback;\n\t}\n\n\tif (!cell.column.modules.edit.blocked) {\n\t\tif (e) {\n\t\t\te.stopPropagation();\n\t\t}\n\n\t\tswitch (_typeof(cell.column.modules.edit.check)) {\n\t\t\tcase \"function\":\n\t\t\t\tallowEdit = cell.column.modules.edit.check(cell.getComponent());\n\t\t\t\tbreak;\n\n\t\t\tcase \"boolean\":\n\t\t\t\tallowEdit = cell.column.modules.edit.check;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (allowEdit || forceEdit) {\n\n\t\t\tself.cancelEdit();\n\n\t\t\tself.currentCell = cell;\n\n\t\t\tthis.focusScrollAdjust(cell);\n\n\t\t\tcomponent = cell.getComponent();\n\n\t\t\tif (this.mouseClick) {\n\t\t\t\tthis.mouseClick = false;\n\n\t\t\t\tif (cell.column.cellEvents.cellClick) {\n\t\t\t\t\tcell.column.cellEvents.cellClick.call(this.table, e, component);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (cell.column.cellEvents.cellEditing) {\n\t\t\t\tcell.column.cellEvents.cellEditing.call(this.table, component);\n\t\t\t}\n\n\t\t\tself.table.options.cellEditing.call(this.table, component);\n\n\t\t\tparams = typeof cell.column.modules.edit.params === \"function\" ? cell.column.modules.edit.params(component) : cell.column.modules.edit.params;\n\n\t\t\tcellEditor = cell.column.modules.edit.editor.call(self, component, onRendered, success, cancel, params);\n\n\t\t\t//if editor returned, add to DOM, if false, abort edit\n\t\t\tif (cellEditor !== false) {\n\n\t\t\t\tif (cellEditor instanceof Node) {\n\t\t\t\t\telement.classList.add(\"tabulator-editing\");\n\t\t\t\t\tcell.row.getElement().classList.add(\"tabulator-row-editing\");\n\t\t\t\t\twhile (element.firstChild) {\n\t\t\t\t\t\telement.removeChild(element.firstChild);\n\t\t\t\t\t}element.appendChild(cellEditor);\n\n\t\t\t\t\t//trigger onRendered Callback\n\t\t\t\t\trendered();\n\n\t\t\t\t\t//prevent editing from triggering rowClick event\n\t\t\t\t\tvar children = element.children;\n\n\t\t\t\t\tfor (var i = 0; i < children.length; i++) {\n\t\t\t\t\t\tchildren[i].addEventListener(\"click\", function (e) {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Edit Error - Editor should return an instance of Node, the editor returned:\", cellEditor);\n\t\t\t\t\telement.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\telement.blur();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t} else {\n\t\t\tthis.mouseClick = false;\n\t\t\telement.blur();\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tthis.mouseClick = false;\n\t\telement.blur();\n\t\treturn false;\n\t}\n};\n\nEdit.prototype.maskInput = function (el, options) {\n\tvar mask = options.mask,\n\t    maskLetter = typeof options.maskLetterChar !== \"undefined\" ? options.maskLetterChar : \"A\",\n\t    maskNumber = typeof options.maskNumberChar !== \"undefined\" ? options.maskNumberChar : \"9\",\n\t    maskWildcard = typeof options.maskWildcardChar !== \"undefined\" ? options.maskWildcardChar : \"*\",\n\t    success = false;\n\n\tfunction fillSymbols(index) {\n\t\tvar symbol = mask[index];\n\t\tif (typeof symbol !== \"undefined\" && symbol !== maskWildcard && symbol !== maskLetter && symbol !== maskNumber) {\n\t\t\tel.value = el.value + \"\" + symbol;\n\t\t\tfillSymbols(index + 1);\n\t\t}\n\t}\n\n\tel.addEventListener(\"keydown\", function (e) {\n\t\tvar index = el.value.length,\n\t\t    char = e.key;\n\n\t\tif (e.keyCode > 46) {\n\t\t\tif (index >= mask.length) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tsuccess = false;\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tswitch (mask[index]) {\n\t\t\t\t\tcase maskLetter:\n\t\t\t\t\t\tif (char.toUpperCase() == char.toLowerCase()) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tsuccess = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskNumber:\n\t\t\t\t\t\tif (isNaN(char)) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tsuccess = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase maskWildcard:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (char !== mask[index]) {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tsuccess = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsuccess = true;\n\t\t}\n\n\t\treturn;\n\t});\n\n\tel.addEventListener(\"keyup\", function (e) {\n\t\tif (e.keyCode > 46) {\n\t\t\tif (options.maskAutoFill) {\n\t\t\t\tfillSymbols(el.value.length);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (!el.placeholder) {\n\t\tel.placeholder = mask;\n\t}\n\n\tif (options.maskAutoFill) {\n\t\tfillSymbols(el.value.length);\n\t}\n};\n\nEdit.prototype.getEditedCells = function () {\n\tvar output = [];\n\n\tthis.editedCells.forEach(function (cell) {\n\t\toutput.push(cell.getComponent());\n\t});\n\n\treturn output;\n};\n\nEdit.prototype.clearEdited = function (cell) {\n\tvar editIndex;\n\n\tif (cell.modules.edit && cell.modules.edit.edited) {\n\t\tcell.modules.edit.edited = false;\n\n\t\tif (cell.modules.validate) {\n\t\t\tcell.modules.validate.invalid = false;\n\t\t}\n\t}\n\n\teditIndex = this.editedCells.indexOf(cell);\n\n\tif (editIndex > -1) {\n\t\tthis.editedCells.splice(editIndex, 1);\n\t}\n};\n\n//default data editors\nEdit.prototype.editors = {\n\n\t//input element\n\tinput: function input(cell, onRendered, success, cancel, editorParams) {\n\n\t\t//create and style input\n\t\tvar cellValue = cell.getValue(),\n\t\t    input = document.createElement(\"input\");\n\n\t\tinput.setAttribute(\"type\", editorParams.search ? \"search\" : \"text\");\n\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = typeof cellValue !== \"undefined\" ? cellValue : \"\";\n\n\t\tonRendered(function () {\n\t\t\tinput.focus({ preventScroll: true });\n\t\t\tinput.style.height = \"100%\";\n\t\t});\n\n\t\tfunction onChange(e) {\n\t\t\tif ((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\" || input.value !== cellValue) {\n\t\t\t\tif (success(input.value)) {\n\t\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t}\n\n\t\t//submit new value on blur or change\n\t\tinput.addEventListener(\"change\", onChange);\n\t\tinput.addEventListener(\"blur\", onChange);\n\n\t\t//submit new value on enter\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t\t// case 9:\n\t\t\t\tcase 13:\n\t\t\t\t\tonChange(e);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 35:\n\t\t\t\tcase 36:\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif (editorParams.mask) {\n\t\t\tthis.table.modules.edit.maskInput(input, editorParams);\n\t\t}\n\n\t\treturn input;\n\t},\n\n\t//resizable text area element\n\ttextarea: function textarea(cell, onRendered, success, cancel, editorParams) {\n\t\tvar self = this,\n\t\t    cellValue = cell.getValue(),\n\t\t    vertNav = editorParams.verticalNavigation || \"hybrid\",\n\t\t    value = String(cellValue !== null && typeof cellValue !== \"undefined\" ? cellValue : \"\"),\n\t\t    count = (value.match(/(?:\\r\\n|\\r|\\n)/g) || []).length + 1,\n\t\t    input = document.createElement(\"textarea\"),\n\t\t    scrollHeight = 0;\n\n\t\t//create and style input\n\t\tinput.style.display = \"block\";\n\t\tinput.style.padding = \"2px\";\n\t\tinput.style.height = \"100%\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\t\tinput.style.whiteSpace = \"pre-wrap\";\n\t\tinput.style.resize = \"none\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = value;\n\n\t\tonRendered(function () {\n\t\t\tinput.focus({ preventScroll: true });\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\tinput.scrollHeight;\n\t\t\tinput.style.height = input.scrollHeight + \"px\";\n\t\t\tcell.getRow().normalizeHeight();\n\t\t});\n\n\t\tfunction onChange(e) {\n\n\t\t\tif ((cellValue === null || typeof cellValue === \"undefined\") && input.value !== \"\" || input.value !== cellValue) {\n\n\t\t\t\tif (success(input.value)) {\n\t\t\t\t\tcellValue = input.value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tcell.getRow().normalizeHeight();\n\t\t\t\t}, 300);\n\t\t\t} else {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t}\n\n\t\t//submit new value on blur or change\n\t\tinput.addEventListener(\"change\", onChange);\n\t\tinput.addEventListener(\"blur\", onChange);\n\n\t\tinput.addEventListener(\"keyup\", function () {\n\n\t\t\tinput.style.height = \"\";\n\n\t\t\tvar heightNow = input.scrollHeight;\n\n\t\t\tinput.style.height = heightNow + \"px\";\n\n\t\t\tif (heightNow != scrollHeight) {\n\t\t\t\tscrollHeight = heightNow;\n\t\t\t\tcell.getRow().normalizeHeight();\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 27:\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 38:\n\t\t\t\t\t//up arrow\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && input.selectionStart) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 40:\n\t\t\t\t\t//down arrow\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && input.selectionStart !== input.value.length) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 35:\n\t\t\t\tcase 36:\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif (editorParams.mask) {\n\t\t\tthis.table.modules.edit.maskInput(input, editorParams);\n\t\t}\n\n\t\treturn input;\n\t},\n\n\t//input element with type of number\n\tnumber: function number(cell, onRendered, success, cancel, editorParams) {\n\n\t\tvar cellValue = cell.getValue(),\n\t\t    vertNav = editorParams.verticalNavigation || \"editor\",\n\t\t    input = document.createElement(\"input\");\n\n\t\tinput.setAttribute(\"type\", \"number\");\n\n\t\tif (typeof editorParams.max != \"undefined\") {\n\t\t\tinput.setAttribute(\"max\", editorParams.max);\n\t\t}\n\n\t\tif (typeof editorParams.min != \"undefined\") {\n\t\t\tinput.setAttribute(\"min\", editorParams.min);\n\t\t}\n\n\t\tif (typeof editorParams.step != \"undefined\") {\n\t\t\tinput.setAttribute(\"step\", editorParams.step);\n\t\t}\n\n\t\t//create and style input\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = cellValue;\n\n\t\tvar blurFunc = function blurFunc(e) {\n\t\t\tonChange();\n\t\t};\n\n\t\tonRendered(function () {\n\t\t\t//submit new value on blur\n\t\t\tinput.removeEventListener(\"blur\", blurFunc);\n\n\t\t\tinput.focus({ preventScroll: true });\n\t\t\tinput.style.height = \"100%\";\n\n\t\t\t//submit new value on blur\n\t\t\tinput.addEventListener(\"blur\", blurFunc);\n\t\t});\n\n\t\tfunction onChange() {\n\t\t\tvar value = input.value;\n\n\t\t\tif (!isNaN(value) && value !== \"\") {\n\t\t\t\tvalue = Number(value);\n\t\t\t}\n\n\t\t\tif (value !== cellValue) {\n\t\t\t\tif (success(value)) {\n\t\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t}\n\n\t\t//submit new value on enter\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 13:\n\t\t\t\t\t// case 9:\n\t\t\t\t\tonChange();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 38: //up arrow\n\t\t\t\tcase 40:\n\t\t\t\t\t//down arrow\n\t\t\t\t\tif (vertNav == \"editor\") {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 35:\n\t\t\t\tcase 36:\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tif (editorParams.mask) {\n\t\t\tthis.table.modules.edit.maskInput(input, editorParams);\n\t\t}\n\n\t\treturn input;\n\t},\n\n\t//input element with type of number\n\trange: function range(cell, onRendered, success, cancel, editorParams) {\n\n\t\tvar cellValue = cell.getValue(),\n\t\t    input = document.createElement(\"input\");\n\n\t\tinput.setAttribute(\"type\", \"range\");\n\n\t\tif (typeof editorParams.max != \"undefined\") {\n\t\t\tinput.setAttribute(\"max\", editorParams.max);\n\t\t}\n\n\t\tif (typeof editorParams.min != \"undefined\") {\n\t\t\tinput.setAttribute(\"min\", editorParams.min);\n\t\t}\n\n\t\tif (typeof editorParams.step != \"undefined\") {\n\t\t\tinput.setAttribute(\"step\", editorParams.step);\n\t\t}\n\n\t\t//create and style input\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = cellValue;\n\n\t\tonRendered(function () {\n\t\t\tinput.focus({ preventScroll: true });\n\t\t\tinput.style.height = \"100%\";\n\t\t});\n\n\t\tfunction onChange() {\n\t\t\tvar value = input.value;\n\n\t\t\tif (!isNaN(value) && value !== \"\") {\n\t\t\t\tvalue = Number(value);\n\t\t\t}\n\n\t\t\tif (value != cellValue) {\n\t\t\t\tif (success(value)) {\n\t\t\t\t\tcellValue = value; //persist value if successfully validated incase editor is used as header filter\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t}\n\n\t\t//submit new value on blur\n\t\tinput.addEventListener(\"blur\", function (e) {\n\t\t\tonChange();\n\t\t});\n\n\t\t//submit new value on enter\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 13:\n\t\t\t\t\t// case 9:\n\t\t\t\t\tonChange();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn input;\n\t},\n\n\t//select\n\tselect: function select(cell, onRendered, success, cancel, editorParams) {\n\t\tvar _this53 = this;\n\n\t\tvar self = this,\n\t\t    cellEl = cell.getElement(),\n\t\t    initialValue = cell.getValue(),\n\t\t    vertNav = editorParams.verticalNavigation || \"editor\",\n\t\t    initialDisplayValue = typeof initialValue !== \"undefined\" || initialValue === null ? Array.isArray(initialValue) ? initialValue : [initialValue] : typeof editorParams.defaultValue !== \"undefined\" ? editorParams.defaultValue : [],\n\t\t    input = document.createElement(\"input\"),\n\t\t    listEl = document.createElement(\"div\"),\n\t\t    multiselect = editorParams.multiselect,\n\t\t    dataItems = [],\n\t\t    currentItem = {},\n\t\t    displayItems = [],\n\t\t    currentItems = [],\n\t\t    blurable = true,\n\t\t    blockListShow = false,\n\t\t    searchWord = \"\",\n\t\t    searchWordTimeout = null;\n\n\t\tif (Array.isArray(editorParams) || !Array.isArray(editorParams) && (typeof editorParams === 'undefined' ? 'undefined' : _typeof(editorParams)) === \"object\" && !editorParams.values) {\n\t\t\tconsole.warn(\"DEPRECATION WARNING - values for the select editor must now be passed into the values property of the editorParams object, not as the editorParams object\");\n\t\t\teditorParams = { values: editorParams };\n\t\t}\n\n\t\tfunction getUniqueColumnValues(field) {\n\t\t\tvar output = {},\n\t\t\t    data = self.table.getData(),\n\t\t\t    column;\n\n\t\t\tif (field) {\n\t\t\t\tcolumn = self.table.columnManager.getColumnByField(field);\n\t\t\t} else {\n\t\t\t\tcolumn = cell.getColumn()._getSelf();\n\t\t\t}\n\n\t\t\tif (column) {\n\t\t\t\tdata.forEach(function (row) {\n\t\t\t\t\tvar val = column.getFieldValue(row);\n\n\t\t\t\t\tif (val !== null && typeof val !== \"undefined\" && val !== \"\") {\n\t\t\t\t\t\toutput[val] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"unable to find matching column to create select lookup list:\", field);\n\t\t\t}\n\n\t\t\treturn Object.keys(output);\n\t\t}\n\n\t\tfunction parseItems(inputValues, curentValues) {\n\t\t\tvar dataList = [];\n\t\t\tvar displayList = [];\n\n\t\t\tfunction processComplexListItem(item) {\n\t\t\t\tvar item = {\n\t\t\t\t\tlabel: item.label,\n\t\t\t\t\tvalue: item.value,\n\t\t\t\t\titemParams: item.itemParams,\n\t\t\t\t\telementAttributes: item.elementAttributes,\n\t\t\t\t\telement: false\n\t\t\t\t};\n\n\t\t\t\t// if(item.value === curentValue || (!isNaN(parseFloat(item.value)) && !isNaN(parseFloat(item.value)) && parseFloat(item.value) === parseFloat(curentValue))){\n\t\t\t\t// \tsetCurrentItem(item);\n\t\t\t\t// }\n\n\t\t\t\tif (curentValues.indexOf(item.value) > -1) {\n\t\t\t\t\tsetItem(item);\n\t\t\t\t}\n\n\t\t\t\tdataList.push(item);\n\t\t\t\tdisplayList.push(item);\n\n\t\t\t\treturn item;\n\t\t\t}\n\n\t\t\tif (typeof inputValues == \"function\") {\n\t\t\t\tinputValues = inputValues(cell);\n\t\t\t}\n\n\t\t\tif (Array.isArray(inputValues)) {\n\t\t\t\tinputValues.forEach(function (value) {\n\t\t\t\t\tvar item;\n\n\t\t\t\t\tif ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === \"object\") {\n\n\t\t\t\t\t\tif (value.options) {\n\t\t\t\t\t\t\titem = {\n\t\t\t\t\t\t\t\tlabel: value.label,\n\t\t\t\t\t\t\t\tgroup: true,\n\t\t\t\t\t\t\t\titemParams: value.itemParams,\n\t\t\t\t\t\t\t\telementAttributes: value.elementAttributes,\n\t\t\t\t\t\t\t\telement: false\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tdisplayList.push(item);\n\n\t\t\t\t\t\t\tvalue.options.forEach(function (item) {\n\t\t\t\t\t\t\t\tprocessComplexListItem(item);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tprocessComplexListItem(value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\titem = {\n\t\t\t\t\t\t\tlabel: value,\n\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\telement: false\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// if(item.value === curentValue || (!isNaN(parseFloat(item.value)) && !isNaN(parseFloat(item.value)) && parseFloat(item.value) === parseFloat(curentValue))){\n\t\t\t\t\t\t// \tsetCurrentItem(item);\n\t\t\t\t\t\t// }\n\n\t\t\t\t\t\tif (curentValues.indexOf(item.value) > -1) {\n\t\t\t\t\t\t\tsetItem(item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdataList.push(item);\n\t\t\t\t\t\tdisplayList.push(item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfor (var key in inputValues) {\n\t\t\t\t\tvar item = {\n\t\t\t\t\t\tlabel: inputValues[key],\n\t\t\t\t\t\tvalue: key,\n\t\t\t\t\t\telement: false\n\t\t\t\t\t};\n\n\t\t\t\t\t// if(item.value === curentValue || (!isNaN(parseFloat(item.value)) && !isNaN(parseFloat(item.value)) && parseFloat(item.value) === parseFloat(curentValue))){\n\t\t\t\t\t// \tsetCurrentItem(item);\n\t\t\t\t\t// }\n\n\t\t\t\t\tif (curentValues.indexOf(item.value) > -1) {\n\t\t\t\t\t\tsetItem(item);\n\t\t\t\t\t}\n\n\t\t\t\t\tdataList.push(item);\n\t\t\t\t\tdisplayList.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (editorParams.sortValuesList) {\n\t\t\t\tdataList.sort(function (a, b) {\n\t\t\t\t\treturn a.label < b.label ? -1 : a.label > b.label ? 1 : 0;\n\t\t\t\t});\n\n\t\t\t\tdisplayList.sort(function (a, b) {\n\t\t\t\t\treturn a.label < b.label ? -1 : a.label > b.label ? 1 : 0;\n\t\t\t\t});\n\n\t\t\t\tif (editorParams.sortValuesList !== \"asc\") {\n\t\t\t\t\tdataList.reverse();\n\t\t\t\t\tdisplayList.reverse();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdataItems = dataList;\n\t\t\tdisplayItems = displayList;\n\n\t\t\tfillList();\n\t\t}\n\n\t\tfunction fillList() {\n\t\t\twhile (listEl.firstChild) {\n\t\t\t\tlistEl.removeChild(listEl.firstChild);\n\t\t\t}displayItems.forEach(function (item) {\n\n\t\t\t\tvar el = item.element;\n\n\t\t\t\tif (!el) {\n\t\t\t\t\tel = document.createElement(\"div\");\n\t\t\t\t\titem.label = editorParams.listItemFormatter ? editorParams.listItemFormatter(item.value, item.label, cell, el, item.itemParams) : item.label;\n\t\t\t\t\tif (item.group) {\n\t\t\t\t\t\tel.classList.add(\"tabulator-edit-select-list-group\");\n\t\t\t\t\t\tel.tabIndex = 0;\n\t\t\t\t\t\tel.innerHTML = item.label === \"\" ? \"&nbsp;\" : item.label;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel.classList.add(\"tabulator-edit-select-list-item\");\n\t\t\t\t\t\tel.tabIndex = 0;\n\t\t\t\t\t\tel.innerHTML = item.label === \"\" ? \"&nbsp;\" : item.label;\n\n\t\t\t\t\t\tel.addEventListener(\"click\", function () {\n\t\t\t\t\t\t\tblockListShow = true;\n\n\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\tblockListShow = false;\n\t\t\t\t\t\t\t}, 10);\n\n\t\t\t\t\t\t\t// setCurrentItem(item);\n\t\t\t\t\t\t\t// chooseItem();\n\t\t\t\t\t\t\tif (multiselect) {\n\t\t\t\t\t\t\t\ttoggleItem(item);\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchooseItem(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// if(item === currentItem){\n\t\t\t\t\t\t// \tel.classList.add(\"active\");\n\t\t\t\t\t\t// }\n\n\t\t\t\t\t\tif (currentItems.indexOf(item) > -1) {\n\t\t\t\t\t\t\tel.classList.add(\"active\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.elementAttributes && _typeof(item.elementAttributes) == \"object\") {\n\t\t\t\t\t\tfor (var key in item.elementAttributes) {\n\t\t\t\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\t\t\t\tel.setAttribute(key, input.getAttribute(key) + item.elementAttributes[\"+\" + key]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tel.setAttribute(key, item.elementAttributes[key]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tel.addEventListener(\"mousedown\", function () {\n\t\t\t\t\t\tblurable = false;\n\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tblurable = true;\n\t\t\t\t\t\t}, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\titem.element = el;\n\t\t\t\t}\n\n\t\t\t\tlistEl.appendChild(el);\n\t\t\t});\n\t\t}\n\n\t\tfunction setCurrentItem(item, active) {\n\n\t\t\tif (!multiselect && currentItem && currentItem.element) {\n\t\t\t\tcurrentItem.element.classList.remove(\"active\");\n\t\t\t}\n\n\t\t\tif (currentItem && currentItem.element) {\n\t\t\t\tcurrentItem.element.classList.remove(\"focused\");\n\t\t\t}\n\n\t\t\tcurrentItem = item;\n\n\t\t\tif (item.element) {\n\t\t\t\titem.element.classList.add(\"focused\");\n\t\t\t\tif (active) {\n\t\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (item && item.element && item.element.scrollIntoView) {\n\t\t\t\titem.element.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\n\t\t\t}\n\t\t}\n\n\t\t// function chooseItem(){\n\t\t// \thideList();\n\n\t\t// \tif(initialValue !== currentItem.value){\n\t\t// \t\tinitialValue = currentItem.value;\n\t\t// \t\tsuccess(currentItem.value);\n\t\t// \t}else{\n\t\t// \t\tcancel();\n\t\t// \t}\n\t\t// }\n\n\t\tfunction setItem(item) {\n\t\t\tvar index = currentItems.indexOf(item);\n\n\t\t\tif (index == -1) {\n\t\t\t\tcurrentItems.push(item);\n\t\t\t\tsetCurrentItem(item, true);\n\t\t\t}\n\n\t\t\tfillInput();\n\t\t}\n\n\t\tfunction unsetItem(index) {\n\t\t\tvar item = currentItems[index];\n\n\t\t\tif (index > -1) {\n\t\t\t\tcurrentItems.splice(index, 1);\n\t\t\t\tif (item.element) {\n\t\t\t\t\titem.element.classList.remove(\"active\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction toggleItem(item) {\n\t\t\tif (!item) {\n\t\t\t\titem = currentItem;\n\t\t\t}\n\n\t\t\tvar index = currentItems.indexOf(item);\n\n\t\t\tif (index > -1) {\n\t\t\t\tunsetItem(index);\n\t\t\t} else {\n\t\t\t\tif (multiselect !== true && currentItems.length >= multiselect) {\n\t\t\t\t\tunsetItem(0);\n\t\t\t\t}\n\n\t\t\t\tsetItem(item);\n\t\t\t}\n\n\t\t\tfillInput();\n\t\t}\n\n\t\tfunction chooseItem(item) {\n\t\t\thideList();\n\n\t\t\tif (!item) {\n\t\t\t\titem = currentItem;\n\t\t\t}\n\n\t\t\tif (item) {\n\t\t\t\tinput.value = item.label;\n\t\t\t\tsuccess(item.value);\n\t\t\t}\n\n\t\t\tinitialDisplayValue = [item.value];\n\t\t}\n\n\t\tfunction chooseItems(silent) {\n\t\t\tif (!silent) {\n\t\t\t\thideList();\n\t\t\t}\n\n\t\t\tvar output = [];\n\n\t\t\tcurrentItems.forEach(function (item) {\n\t\t\t\toutput.push(item.value);\n\t\t\t});\n\n\t\t\tinitialDisplayValue = output;\n\n\t\t\tsuccess(output);\n\t\t}\n\n\t\tfunction fillInput() {\n\t\t\tvar output = [];\n\n\t\t\tcurrentItems.forEach(function (item) {\n\t\t\t\toutput.push(item.label);\n\t\t\t});\n\n\t\t\tinput.value = output.join(\", \");\n\n\t\t\tif (self.currentCell === false) {\n\t\t\t\tchooseItems(true);\n\t\t\t}\n\t\t}\n\n\t\tfunction unsetItems() {\n\n\t\t\tvar len = currentItems.length;\n\n\t\t\tfor (var _i9 = 0; _i9 < len; _i9++) {\n\t\t\t\tunsetItem(0);\n\t\t\t}\n\t\t}\n\n\t\tfunction cancelItem() {\n\t\t\thideList();\n\t\t\tcancel();\n\t\t}\n\n\t\tfunction showList() {\n\t\t\tcurrentItems = [];\n\n\t\t\tif (!listEl.parentNode) {\n\t\t\t\tif (editorParams.values === true) {\n\t\t\t\t\tparseItems(getUniqueColumnValues(), initialDisplayValue);\n\t\t\t\t} else if (typeof editorParams.values === \"string\") {\n\t\t\t\t\tparseItems(getUniqueColumnValues(editorParams.values), initialDisplayValue);\n\t\t\t\t} else {\n\t\t\t\t\tparseItems(editorParams.values || [], initialDisplayValue);\n\t\t\t\t}\n\n\t\t\t\tvar offset = Tabulator.prototype.helpers.elOffset(cellEl);\n\n\t\t\t\tlistEl.style.minWidth = cellEl.offsetWidth + \"px\";\n\n\t\t\t\tlistEl.style.top = offset.top + cellEl.offsetHeight + \"px\";\n\t\t\t\tlistEl.style.left = offset.left + \"px\";\n\n\t\t\t\tlistEl.addEventListener(\"mousedown\", function (e) {\n\t\t\t\t\tblurable = false;\n\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tblurable = true;\n\t\t\t\t\t}, 10);\n\t\t\t\t});\n\n\t\t\t\tdocument.body.appendChild(listEl);\n\t\t\t}\n\t\t}\n\n\t\tfunction hideList() {\n\t\t\tif (listEl.parentNode) {\n\t\t\t\tlistEl.parentNode.removeChild(listEl);\n\t\t\t}\n\n\t\t\tremoveScrollListener();\n\t\t}\n\n\t\tfunction removeScrollListener() {\n\t\t\tself.table.rowManager.element.removeEventListener(\"scroll\", cancelItem);\n\t\t}\n\n\t\tfunction scrollTovalue(char) {\n\n\t\t\tclearTimeout(searchWordTimeout);\n\n\t\t\tvar character = String.fromCharCode(event.keyCode).toLowerCase();\n\t\t\tsearchWord += character.toLowerCase();\n\n\t\t\tvar match = dataItems.find(function (item) {\n\t\t\t\treturn typeof item.label !== \"undefined\" && item.label.toLowerCase().startsWith(searchWord);\n\t\t\t});\n\n\t\t\tif (match) {\n\t\t\t\tsetCurrentItem(match, !multiselect);\n\t\t\t}\n\n\t\t\tsearchWordTimeout = setTimeout(function () {\n\t\t\t\tsearchWord = \"\";\n\t\t\t}, 800);\n\t\t}\n\n\t\t//style input\n\t\tinput.setAttribute(\"type\", \"text\");\n\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\t\tinput.style.cursor = \"default\";\n\t\tinput.readOnly = this.currentCell != false;\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = typeof initialValue !== \"undefined\" || initialValue === null ? initialValue : \"\";\n\n\t\t// if(editorParams.values === true){\n\t\t// \tparseItems(getUniqueColumnValues(), initialValue);\n\t\t// }else if(typeof editorParams.values === \"string\"){\n\t\t// \tparseItems(getUniqueColumnValues(editorParams.values), initialValue);\n\t\t// }else{\n\t\t// \tparseItems(editorParams.values || [], initialValue);\n\t\t// }\n\n\t\tinput.addEventListener(\"search\", function (e) {\n\t\t\tif (!input.value) {\n\t\t\t\tunsetItems();\n\t\t\t\tchooseItems();\n\t\t\t}\n\t\t});\n\n\t\t//allow key based navigation\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tvar index;\n\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 38:\n\t\t\t\t\t//up arrow\n\t\t\t\t\tindex = dataItems.indexOf(currentItem);\n\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && index) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\t\tsetCurrentItem(dataItems[index - 1], !multiselect);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 40:\n\t\t\t\t\t//down arrow\n\t\t\t\t\tindex = dataItems.indexOf(currentItem);\n\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && index < dataItems.length - 1) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif (index < dataItems.length - 1) {\n\t\t\t\t\t\t\tif (index == -1) {\n\t\t\t\t\t\t\t\tsetCurrentItem(dataItems[0], !multiselect);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetCurrentItem(dataItems[index + 1], !multiselect);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 37: //left arrow\n\t\t\t\tcase 39:\n\t\t\t\t\t//right arrow\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 13:\n\t\t\t\t\t//enter\n\t\t\t\t\t// chooseItem();\n\n\t\t\t\t\tif (multiselect) {\n\t\t\t\t\t\ttoggleItem();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tchooseItem();\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\t//escape\n\t\t\t\t\tcancelItem();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 9:\n\t\t\t\t\t//tab\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (self.currentCell === false) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (e.keyCode >= 38 && e.keyCode <= 90) {\n\t\t\t\t\t\tscrollTovalue(e.keyCode);\n\t\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"blur\", function (e) {\n\t\t\tif (blurable) {\n\t\t\t\tif (multiselect) {\n\t\t\t\t\tchooseItems();\n\t\t\t\t} else {\n\t\t\t\t\tcancelItem();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"focus\", function (e) {\n\t\t\tif (!blockListShow) {\n\t\t\t\tshowList();\n\t\t\t}\n\t\t});\n\n\t\t//style list element\n\t\tlistEl = document.createElement(\"div\");\n\t\tlistEl.classList.add(\"tabulator-edit-select-list\");\n\n\t\tonRendered(function () {\n\t\t\tinput.style.height = \"100%\";\n\t\t\tinput.focus({ preventScroll: true });\n\t\t});\n\n\t\tsetTimeout(function () {\n\t\t\t_this53.table.rowManager.element.addEventListener(\"scroll\", cancelItem);\n\t\t}, 10);\n\n\t\treturn input;\n\t},\n\n\t//autocomplete\n\tautocomplete: function autocomplete(cell, onRendered, success, cancel, editorParams) {\n\t\tvar _this54 = this;\n\n\t\tvar self = this,\n\t\t    cellEl = cell.getElement(),\n\t\t    initialValue = cell.getValue(),\n\t\t    vertNav = editorParams.verticalNavigation || \"editor\",\n\t\t    initialDisplayValue = typeof initialValue !== \"undefined\" || initialValue === null ? initialValue : typeof editorParams.defaultValue !== \"undefined\" ? editorParams.defaultValue : \"\",\n\t\t    input = document.createElement(\"input\"),\n\t\t    listEl = document.createElement(\"div\"),\n\t\t    allItems = [],\n\t\t    displayItems = [],\n\t\t    values = [],\n\t\t    currentItem = false,\n\t\t    blurable = true,\n\t\t    uniqueColumnValues = false;\n\n\t\t//style input\n\t\tinput.setAttribute(\"type\", \"search\");\n\n\t\tinput.style.padding = \"4px\";\n\t\tinput.style.width = \"100%\";\n\t\tinput.style.boxSizing = \"border-box\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//style list element\n\t\tlistEl.classList.add(\"tabulator-edit-select-list\");\n\n\t\tlistEl.addEventListener(\"mousedown\", function (e) {\n\t\t\tblurable = false;\n\n\t\t\tsetTimeout(function () {\n\t\t\t\tblurable = true;\n\t\t\t}, 10);\n\t\t});\n\n\t\tfunction genUniqueColumnValues() {\n\t\t\tif (editorParams.values === true) {\n\t\t\t\tuniqueColumnValues = getUniqueColumnValues();\n\t\t\t} else if (typeof editorParams.values === \"string\") {\n\t\t\t\tuniqueColumnValues = getUniqueColumnValues(editorParams.values);\n\t\t\t}\n\t\t}\n\n\t\tfunction getUniqueColumnValues(field) {\n\t\t\tvar output = {},\n\t\t\t    data = self.table.getData(),\n\t\t\t    column;\n\n\t\t\tif (field) {\n\t\t\t\tcolumn = self.table.columnManager.getColumnByField(field);\n\t\t\t} else {\n\t\t\t\tcolumn = cell.getColumn()._getSelf();\n\t\t\t}\n\n\t\t\tif (column) {\n\t\t\t\tdata.forEach(function (row) {\n\t\t\t\t\tvar val = column.getFieldValue(row);\n\n\t\t\t\t\tif (val !== null && typeof val !== \"undefined\" && val !== \"\") {\n\t\t\t\t\t\toutput[val] = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (editorParams.sortValuesList) {\n\t\t\t\t\tif (editorParams.sortValuesList == \"asc\") {\n\t\t\t\t\t\toutput = Object.keys(output).sort();\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutput = Object.keys(output).sort().reverse();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toutput = Object.keys(output);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"unable to find matching column to create autocomplete lookup list:\", field);\n\t\t\t}\n\n\t\t\treturn output;\n\t\t}\n\n\t\tfunction filterList(term, intialLoad) {\n\t\t\tvar matches = [],\n\t\t\t    values,\n\t\t\t    items,\n\t\t\t    searchEl;\n\n\t\t\t//lookup base values list\n\t\t\tif (uniqueColumnValues) {\n\t\t\t\tvalues = uniqueColumnValues;\n\t\t\t} else {\n\t\t\t\tvalues = editorParams.values || [];\n\t\t\t}\n\n\t\t\tif (editorParams.searchFunc) {\n\t\t\t\tmatches = editorParams.searchFunc(term, values);\n\n\t\t\t\tif (matches instanceof Promise) {\n\n\t\t\t\t\taddNotice(typeof editorParams.searchingPlaceholder !== \"undefined\" ? editorParams.searchingPlaceholder : \"Searching...\");\n\n\t\t\t\t\tmatches.then(function (result) {\n\t\t\t\t\t\tfillListIfNotEmpty(parseItems(result), intialLoad);\n\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\tconsole.err(\"error in autocomplete search promise:\", err);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tfillListIfNotEmpty(parseItems(matches), intialLoad);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\titems = parseItems(values);\n\n\t\t\t\tif (term === \"\") {\n\t\t\t\t\tif (editorParams.showListOnEmpty) {\n\t\t\t\t\t\tmatches = items;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\titems.forEach(function (item) {\n\t\t\t\t\t\tif (item.value !== null || typeof item.value !== \"undefined\") {\n\t\t\t\t\t\t\tif (String(item.value).toLowerCase().indexOf(String(term).toLowerCase()) > -1 || String(item.title).toLowerCase().indexOf(String(term).toLowerCase()) > -1) {\n\t\t\t\t\t\t\t\tmatches.push(item);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfillListIfNotEmpty(matches, intialLoad);\n\t\t\t}\n\t\t}\n\n\t\tfunction addNotice(notice) {\n\t\t\tvar searchEl = document.createElement(\"div\");\n\n\t\t\tclearList();\n\n\t\t\tif (notice !== false) {\n\t\t\t\tsearchEl.classList.add(\"tabulator-edit-select-list-notice\");\n\t\t\t\tsearchEl.tabIndex = 0;\n\n\t\t\t\tif (notice instanceof Node) {\n\t\t\t\t\tsearchEl.appendChild(notice);\n\t\t\t\t} else {\n\t\t\t\t\tsearchEl.innerHTML = notice;\n\t\t\t\t}\n\n\t\t\t\tlistEl.appendChild(searchEl);\n\t\t\t}\n\t\t}\n\n\t\tfunction parseItems(inputValues) {\n\t\t\tvar itemList = [];\n\n\t\t\tif (Array.isArray(inputValues)) {\n\t\t\t\tinputValues.forEach(function (value) {\n\n\t\t\t\t\tvar item = {};\n\n\t\t\t\t\tif ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === \"object\") {\n\t\t\t\t\t\titem.title = editorParams.listItemFormatter ? editorParams.listItemFormatter(value.value, value.label) : value.label;\n\t\t\t\t\t\titem.value = value.value;\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.title = editorParams.listItemFormatter ? editorParams.listItemFormatter(value, value) : value;\n\t\t\t\t\t\titem.value = value;\n\t\t\t\t\t}\n\n\t\t\t\t\titemList.push(item);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfor (var key in inputValues) {\n\t\t\t\t\tvar item = {\n\t\t\t\t\t\ttitle: editorParams.listItemFormatter ? editorParams.listItemFormatter(key, inputValues[key]) : inputValues[key],\n\t\t\t\t\t\tvalue: key\n\t\t\t\t\t};\n\n\t\t\t\t\titemList.push(item);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn itemList;\n\t\t}\n\n\t\tfunction clearList() {\n\t\t\twhile (listEl.firstChild) {\n\t\t\t\tlistEl.removeChild(listEl.firstChild);\n\t\t\t}\n\t\t}\n\n\t\tfunction fillListIfNotEmpty(items, intialLoad) {\n\t\t\tif (items.length) {\n\t\t\t\tfillList(items, intialLoad);\n\t\t\t} else {\n\t\t\t\tif (editorParams.emptyPlaceholder) {\n\t\t\t\t\taddNotice(editorParams.emptyPlaceholder);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction fillList(items, intialLoad) {\n\t\t\tvar current = false;\n\n\t\t\tclearList();\n\n\t\t\tdisplayItems = items;\n\n\t\t\tdisplayItems.forEach(function (item) {\n\t\t\t\tvar el = item.element;\n\n\t\t\t\tif (!el) {\n\t\t\t\t\tel = document.createElement(\"div\");\n\t\t\t\t\tel.classList.add(\"tabulator-edit-select-list-item\");\n\t\t\t\t\tel.tabIndex = 0;\n\t\t\t\t\tel.innerHTML = item.title;\n\n\t\t\t\t\tel.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\tsetCurrentItem(item);\n\t\t\t\t\t\tchooseItem();\n\t\t\t\t\t});\n\n\t\t\t\t\tel.addEventListener(\"mousedown\", function (e) {\n\t\t\t\t\t\tblurable = false;\n\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tblurable = true;\n\t\t\t\t\t\t}, 10);\n\t\t\t\t\t});\n\n\t\t\t\t\titem.element = el;\n\n\t\t\t\t\tif (intialLoad && item.value == initialValue) {\n\t\t\t\t\t\tinput.value = item.title;\n\t\t\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t\t\t\tcurrent = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item === currentItem) {\n\t\t\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t\t\t\tcurrent = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlistEl.appendChild(el);\n\t\t\t});\n\n\t\t\tif (!current) {\n\t\t\t\tsetCurrentItem(false);\n\t\t\t}\n\t\t}\n\n\t\tfunction chooseItem() {\n\t\t\thideList();\n\n\t\t\tif (currentItem) {\n\t\t\t\tif (initialValue !== currentItem.value) {\n\t\t\t\t\tinitialValue = currentItem.value;\n\t\t\t\t\tinput.value = currentItem.title;\n\t\t\t\t\tsuccess(currentItem.value);\n\t\t\t\t} else {\n\t\t\t\t\tcancel();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (editorParams.freetext) {\n\t\t\t\t\tinitialValue = input.value;\n\t\t\t\t\tsuccess(input.value);\n\t\t\t\t} else {\n\t\t\t\t\tif (editorParams.allowEmpty && input.value === \"\") {\n\t\t\t\t\t\tinitialValue = input.value;\n\t\t\t\t\t\tsuccess(input.value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcancel();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction showList() {\n\t\t\tif (!listEl.parentNode) {\n\n\t\t\t\tconsole.log(\"show\", initialDisplayValue);\n\t\t\t\twhile (listEl.firstChild) {\n\t\t\t\t\tlistEl.removeChild(listEl.firstChild);\n\t\t\t\t}var offset = Tabulator.prototype.helpers.elOffset(cellEl);\n\n\t\t\t\tlistEl.style.minWidth = cellEl.offsetWidth + \"px\";\n\n\t\t\t\tlistEl.style.top = offset.top + cellEl.offsetHeight + \"px\";\n\t\t\t\tlistEl.style.left = offset.left + \"px\";\n\t\t\t\tdocument.body.appendChild(listEl);\n\t\t\t}\n\t\t}\n\n\t\tfunction setCurrentItem(item, showInputValue) {\n\t\t\tif (currentItem && currentItem.element) {\n\t\t\t\tcurrentItem.element.classList.remove(\"active\");\n\t\t\t}\n\n\t\t\tcurrentItem = item;\n\n\t\t\tif (item && item.element) {\n\t\t\t\titem.element.classList.add(\"active\");\n\t\t\t}\n\n\t\t\tif (item && item.element && item.element.scrollIntoView) {\n\t\t\t\titem.element.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\n\t\t\t}\n\t\t}\n\n\t\tfunction hideList() {\n\t\t\tif (listEl.parentNode) {\n\t\t\t\tlistEl.parentNode.removeChild(listEl);\n\t\t\t}\n\n\t\t\tremoveScrollListener();\n\t\t}\n\n\t\tfunction cancelItem() {\n\t\t\thideList();\n\t\t\tcancel();\n\t\t}\n\n\t\tfunction removeScrollListener() {\n\t\t\tself.table.rowManager.element.removeEventListener(\"scroll\", cancelItem);\n\t\t}\n\n\t\t//allow key based navigation\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tvar index;\n\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 38:\n\t\t\t\t\t//up arrow\n\t\t\t\t\tindex = displayItems.indexOf(currentItem);\n\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && index) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\t\tsetCurrentItem(displayItems[index - 1]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetCurrentItem(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 40:\n\t\t\t\t\t//down arrow\n\n\t\t\t\t\tindex = displayItems.indexOf(currentItem);\n\n\t\t\t\t\tif (vertNav == \"editor\" || vertNav == \"hybrid\" && index < displayItems.length - 1) {\n\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif (index < displayItems.length - 1) {\n\t\t\t\t\t\t\tif (index == -1) {\n\t\t\t\t\t\t\t\tsetCurrentItem(displayItems[0]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetCurrentItem(displayItems[index + 1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 37: //left arrow\n\t\t\t\tcase 39:\n\t\t\t\t\t//right arrow\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t// e.preventDefault();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 13:\n\t\t\t\t\t//enter\n\t\t\t\t\tchooseItem();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\t//escape\n\t\t\t\t\tcancelItem();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 36: //home\n\t\t\t\tcase 35:\n\t\t\t\t\t//end\n\t\t\t\t\t//prevent table navigation while using input element\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"keyup\", function (e) {\n\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 38: //up arrow\n\t\t\t\tcase 37: //left arrow\n\t\t\t\tcase 39: //up arrow\n\t\t\t\tcase 40: //right arrow\n\t\t\t\tcase 13: //enter\n\t\t\t\tcase 27:\n\t\t\t\t\t//escape\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tfilterList(input.value);\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"search\", function (e) {\n\t\t\tfilterList(input.value);\n\t\t});\n\n\t\tinput.addEventListener(\"blur\", function (e) {\n\t\t\tif (blurable) {\n\t\t\t\tchooseItem();\n\t\t\t}\n\t\t});\n\n\t\tinput.addEventListener(\"focus\", function (e) {\n\t\t\tvar value = initialDisplayValue;\n\t\t\tgenUniqueColumnValues();\n\t\t\tshowList();\n\t\t\tinput.value = value;\n\t\t\tfilterList(value, true);\n\t\t});\n\n\t\tonRendered(function () {\n\t\t\tinput.style.height = \"100%\";\n\t\t\tinput.focus({ preventScroll: true });\n\t\t});\n\n\t\tif (editorParams.mask) {\n\t\t\tthis.table.modules.edit.maskInput(input, editorParams);\n\t\t}\n\n\t\tsetTimeout(function () {\n\t\t\t_this54.table.rowManager.element.addEventListener(\"scroll\", cancelItem);\n\t\t}, 10);\n\n\t\tgenUniqueColumnValues();\n\t\tinput.value = initialDisplayValue;\n\t\tfilterList(initialDisplayValue, true);\n\n\t\treturn input;\n\t},\n\n\t//star rating\n\tstar: function star(cell, onRendered, success, cancel, editorParams) {\n\t\tvar self = this,\n\t\t    element = cell.getElement(),\n\t\t    value = cell.getValue(),\n\t\t    maxStars = element.getElementsByTagName(\"svg\").length || 5,\n\t\t    size = element.getElementsByTagName(\"svg\")[0] ? element.getElementsByTagName(\"svg\")[0].getAttribute(\"width\") : 14,\n\t\t    stars = [],\n\t\t    starsHolder = document.createElement(\"div\"),\n\t\t    star = document.createElementNS('http://www.w3.org/2000/svg', \"svg\");\n\n\t\t//change star type\n\t\tfunction starChange(val) {\n\t\t\tstars.forEach(function (star, i) {\n\t\t\t\tif (i < val) {\n\t\t\t\t\tif (self.table.browser == \"ie\") {\n\t\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-active\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstar.classList.replace(\"tabulator-star-inactive\", \"tabulator-star-active\");\n\t\t\t\t\t}\n\n\t\t\t\t\tstar.innerHTML = '<polygon fill=\"#488CE9\" stroke=\"#014AAE\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t\t} else {\n\t\t\t\t\tif (self.table.browser == \"ie\") {\n\t\t\t\t\t\tstar.setAttribute(\"class\", \"tabulator-star-inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstar.classList.replace(\"tabulator-star-active\", \"tabulator-star-inactive\");\n\t\t\t\t\t}\n\n\t\t\t\t\tstar.innerHTML = '<polygon fill=\"#010155\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t//build stars\n\t\tfunction buildStar(i) {\n\n\t\t\tvar starHolder = document.createElement(\"span\");\n\t\t\tvar nextStar = star.cloneNode(true);\n\n\t\t\tstars.push(nextStar);\n\n\t\t\tstarHolder.addEventListener(\"mouseenter\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\tstarChange(i);\n\t\t\t});\n\n\t\t\tstarHolder.addEventListener(\"mousemove\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t});\n\n\t\t\tstarHolder.addEventListener(\"click\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\tsuccess(i);\n\t\t\t\telement.blur();\n\t\t\t});\n\n\t\t\tstarHolder.appendChild(nextStar);\n\t\t\tstarsHolder.appendChild(starHolder);\n\t\t}\n\n\t\t//handle keyboard navigation value change\n\t\tfunction changeValue(val) {\n\t\t\tvalue = val;\n\t\t\tstarChange(val);\n\t\t}\n\n\t\t//style cell\n\t\telement.style.whiteSpace = \"nowrap\";\n\t\telement.style.overflow = \"hidden\";\n\t\telement.style.textOverflow = \"ellipsis\";\n\n\t\t//style holding element\n\t\tstarsHolder.style.verticalAlign = \"middle\";\n\t\tstarsHolder.style.display = \"inline-block\";\n\t\tstarsHolder.style.padding = \"4px\";\n\n\t\t//style star\n\t\tstar.setAttribute(\"width\", size);\n\t\tstar.setAttribute(\"height\", size);\n\t\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\t\tstar.setAttribute(\"xml:space\", \"preserve\");\n\t\tstar.style.padding = \"0 1px\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tstarsHolder.setAttribute(key, starsHolder.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tstarsHolder.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//create correct number of stars\n\t\tfor (var i = 1; i <= maxStars; i++) {\n\t\t\tbuildStar(i);\n\t\t}\n\n\t\t//ensure value does not exceed number of stars\n\t\tvalue = Math.min(parseInt(value), maxStars);\n\n\t\t// set initial styling of stars\n\t\tstarChange(value);\n\n\t\tstarsHolder.addEventListener(\"mousemove\", function (e) {\n\t\t\tstarChange(0);\n\t\t});\n\n\t\tstarsHolder.addEventListener(\"click\", function (e) {\n\t\t\tsuccess(0);\n\t\t});\n\n\t\telement.addEventListener(\"blur\", function (e) {\n\t\t\tcancel();\n\t\t});\n\n\t\t//allow key based navigation\n\t\telement.addEventListener(\"keydown\", function (e) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 39:\n\t\t\t\t\t//right arrow\n\t\t\t\t\tchangeValue(value + 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 37:\n\t\t\t\t\t//left arrow\n\t\t\t\t\tchangeValue(value - 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 13:\n\t\t\t\t\t//enter\n\t\t\t\t\tsuccess(value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\t//escape\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\treturn starsHolder;\n\t},\n\n\t//draggable progress bar\n\tprogress: function progress(cell, onRendered, success, cancel, editorParams) {\n\t\tvar element = cell.getElement(),\n\t\t    max = typeof editorParams.max === \"undefined\" ? element.getElementsByTagName(\"div\")[0].getAttribute(\"max\") || 100 : editorParams.max,\n\t\t    min = typeof editorParams.min === \"undefined\" ? element.getElementsByTagName(\"div\")[0].getAttribute(\"min\") || 0 : editorParams.min,\n\t\t    percent = (max - min) / 100,\n\t\t    value = cell.getValue() || 0,\n\t\t    handle = document.createElement(\"div\"),\n\t\t    bar = document.createElement(\"div\"),\n\t\t    mouseDrag,\n\t\t    mouseDragWidth;\n\n\t\t//set new value\n\t\tfunction updateValue() {\n\t\t\tvar style = window.getComputedStyle(element, null);\n\n\t\t\tvar calcVal = percent * Math.round(bar.offsetWidth / ((element.clientWidth - parseInt(style.getPropertyValue(\"padding-left\")) - parseInt(style.getPropertyValue(\"padding-right\"))) / 100)) + min;\n\t\t\tsuccess(calcVal);\n\t\t\telement.setAttribute(\"aria-valuenow\", calcVal);\n\t\t\telement.setAttribute(\"aria-label\", value);\n\t\t}\n\n\t\t//style handle\n\t\thandle.style.position = \"absolute\";\n\t\thandle.style.right = \"0\";\n\t\thandle.style.top = \"0\";\n\t\thandle.style.bottom = \"0\";\n\t\thandle.style.width = \"5px\";\n\t\thandle.classList.add(\"tabulator-progress-handle\");\n\n\t\t//style bar\n\t\tbar.style.display = \"inline-block\";\n\t\tbar.style.position = \"relative\";\n\t\t// bar.style.top = \"8px\";\n\t\t// bar.style.bottom = \"8px\";\n\t\t// bar.style.left = \"4px\";\n\t\t// bar.style.marginRight = \"4px\";\n\t\tbar.style.height = \"100%\";\n\t\tbar.style.backgroundColor = \"#488CE9\";\n\t\tbar.style.maxWidth = \"100%\";\n\t\tbar.style.minWidth = \"0%\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tbar.setAttribute(key, bar.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tbar.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//style cell\n\t\telement.style.padding = \"4px 4px\";\n\n\t\t//make sure value is in range\n\t\tvalue = Math.min(parseFloat(value), max);\n\t\tvalue = Math.max(parseFloat(value), min);\n\n\t\t//workout percentage\n\t\tvalue = Math.round((value - min) / percent);\n\t\t// bar.style.right = value + \"%\";\n\t\tbar.style.width = value + \"%\";\n\n\t\telement.setAttribute(\"aria-valuemin\", min);\n\t\telement.setAttribute(\"aria-valuemax\", max);\n\n\t\tbar.appendChild(handle);\n\n\t\thandle.addEventListener(\"mousedown\", function (e) {\n\t\t\tmouseDrag = e.screenX;\n\t\t\tmouseDragWidth = bar.offsetWidth;\n\t\t});\n\n\t\thandle.addEventListener(\"mouseover\", function () {\n\t\t\thandle.style.cursor = \"ew-resize\";\n\t\t});\n\n\t\telement.addEventListener(\"mousemove\", function (e) {\n\t\t\tif (mouseDrag) {\n\t\t\t\tbar.style.width = mouseDragWidth + e.screenX - mouseDrag + \"px\";\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener(\"mouseup\", function (e) {\n\t\t\tif (mouseDrag) {\n\t\t\t\te.stopPropagation();\n\t\t\t\te.stopImmediatePropagation();\n\n\t\t\t\tmouseDrag = false;\n\t\t\t\tmouseDragWidth = false;\n\n\t\t\t\tupdateValue();\n\t\t\t}\n\t\t});\n\n\t\t//allow key based navigation\n\t\telement.addEventListener(\"keydown\", function (e) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase 39:\n\t\t\t\t\t//right arrow\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbar.style.width = bar.clientWidth + element.clientWidth / 100 + \"px\";\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 37:\n\t\t\t\t\t//left arrow\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tbar.style.width = bar.clientWidth - element.clientWidth / 100 + \"px\";\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 9: //tab\n\t\t\t\tcase 13:\n\t\t\t\t\t//enter\n\t\t\t\t\tupdateValue();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 27:\n\t\t\t\t\t//escape\n\t\t\t\t\tcancel();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener(\"blur\", function () {\n\t\t\tcancel();\n\t\t});\n\n\t\treturn bar;\n\t},\n\n\t//checkbox\n\ttickCross: function tickCross(cell, onRendered, success, cancel, editorParams) {\n\t\tvar value = cell.getValue(),\n\t\t    input = document.createElement(\"input\"),\n\t\t    tristate = editorParams.tristate,\n\t\t    indetermValue = typeof editorParams.indeterminateValue === \"undefined\" ? null : editorParams.indeterminateValue,\n\t\t    indetermState = false;\n\n\t\tinput.setAttribute(\"type\", \"checkbox\");\n\t\tinput.style.marginTop = \"5px\";\n\t\tinput.style.boxSizing = \"border-box\";\n\n\t\tif (editorParams.elementAttributes && _typeof(editorParams.elementAttributes) == \"object\") {\n\t\t\tfor (var key in editorParams.elementAttributes) {\n\t\t\t\tif (key.charAt(0) == \"+\") {\n\t\t\t\t\tkey = key.slice(1);\n\t\t\t\t\tinput.setAttribute(key, input.getAttribute(key) + editorParams.elementAttributes[\"+\" + key]);\n\t\t\t\t} else {\n\t\t\t\t\tinput.setAttribute(key, editorParams.elementAttributes[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinput.value = value;\n\n\t\tif (tristate && (typeof value === \"undefined\" || value === indetermValue || value === \"\")) {\n\t\t\tindetermState = true;\n\t\t\tinput.indeterminate = true;\n\t\t}\n\n\t\tif (this.table.browser != \"firefox\") {\n\t\t\t//prevent blur issue on mac firefox\n\t\t\tonRendered(function () {\n\t\t\t\tinput.focus({ preventScroll: true });\n\t\t\t});\n\t\t}\n\n\t\tinput.checked = value === true || value === \"true\" || value === \"True\" || value === 1;\n\n\t\tonRendered(function () {\n\t\t\tinput.focus();\n\t\t});\n\n\t\tfunction setValue(blur) {\n\t\t\tif (tristate) {\n\t\t\t\tif (!blur) {\n\t\t\t\t\tif (input.checked && !indetermState) {\n\t\t\t\t\t\tinput.checked = false;\n\t\t\t\t\t\tinput.indeterminate = true;\n\t\t\t\t\t\tindetermState = true;\n\t\t\t\t\t\treturn indetermValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindetermState = false;\n\t\t\t\t\t\treturn input.checked;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (indetermState) {\n\t\t\t\t\t\treturn indetermValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn input.checked;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn input.checked;\n\t\t\t}\n\t\t}\n\n\t\t//submit new value on blur\n\t\tinput.addEventListener(\"change\", function (e) {\n\t\t\tsuccess(setValue());\n\t\t});\n\n\t\tinput.addEventListener(\"blur\", function (e) {\n\t\t\tsuccess(setValue(true));\n\t\t});\n\n\t\t//submit new value on enter\n\t\tinput.addEventListener(\"keydown\", function (e) {\n\t\t\tif (e.keyCode == 13) {\n\t\t\t\tsuccess(setValue());\n\t\t\t}\n\t\t\tif (e.keyCode == 27) {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t});\n\n\t\treturn input;\n\t}\n};\n\nTabulator.prototype.registerModule(\"edit\", Edit);\n\nvar ExportRow = function ExportRow(type, columns, component, indent) {\n\tthis.type = type;\n\tthis.columns = columns;\n\tthis.component = component || false;\n\tthis.indent = indent || 0;\n};\n\nvar ExportColumn = function ExportColumn(value, component, width, height, depth) {\n\tthis.value = value;\n\tthis.component = component || false;\n\tthis.width = width;\n\tthis.height = height;\n\tthis.depth = depth;\n};\n\nvar Export = function Export(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.config = {};\n\tthis.cloneTableStyle = true;\n\tthis.colVisProp = \"\";\n};\n\nExport.prototype.generateExportList = function (config, style, range, colVisProp) {\n\tthis.cloneTableStyle = style;\n\tthis.config = config || {};\n\tthis.colVisProp = colVisProp;\n\n\tvar headers = this.config.columnHeaders !== false ? this.headersToExportRows(this.generateColumnGroupHeaders()) : [];\n\tvar body = this.bodyToExportRows(this.rowLookup(range));\n\n\treturn headers.concat(body);\n};\n\nExport.prototype.genereateTable = function (config, style, range, colVisProp) {\n\tvar list = this.generateExportList(config, style, range, colVisProp);\n\n\treturn this.genereateTableElement(list);\n};\n\nExport.prototype.rowLookup = function (range) {\n\tvar _this55 = this;\n\n\tvar rows = [];\n\n\tif (typeof range == \"function\") {\n\t\trange.call(this.table).forEach(function (row) {\n\t\t\trow = _this55.table.rowManager.findRow(row);\n\n\t\t\tif (row) {\n\t\t\t\trows.push(row);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tswitch (range) {\n\t\t\tcase true:\n\t\t\tcase \"visible\":\n\t\t\t\trows = this.table.rowManager.getVisibleRows(true);\n\t\t\t\tbreak;\n\n\t\t\tcase \"all\":\n\t\t\t\trows = this.table.rowManager.rows;\n\t\t\t\tbreak;\n\n\t\t\tcase \"selected\":\n\t\t\t\trows = this.table.modules.selectRow.selectedRows;\n\t\t\t\tbreak;\n\n\t\t\tcase \"active\":\n\t\t\tdefault:\n\t\t\t\tif (this.table.options.pagination) {\n\t\t\t\t\trows = this.table.rowManager.getDisplayRows(this.table.rowManager.displayRows.length - 2);\n\t\t\t\t} else {\n\t\t\t\t\trows = this.table.rowManager.getDisplayRows();\n\t\t\t\t}\n\t\t}\n\t}\n\n\treturn Object.assign([], rows);\n};\n\nExport.prototype.generateColumnGroupHeaders = function () {\n\tvar _this56 = this;\n\n\tvar output = [];\n\n\tvar columns = this.config.columnGroups !== false ? this.table.columnManager.columns : this.table.columnManager.columnsByIndex;\n\n\tcolumns.forEach(function (column) {\n\t\tvar colData = _this56.processColumnGroup(column);\n\n\t\tif (colData) {\n\t\t\toutput.push(colData);\n\t\t}\n\t});\n\n\treturn output;\n};\n\nExport.prototype.processColumnGroup = function (column) {\n\tvar _this57 = this;\n\n\tvar subGroups = column.columns,\n\t    maxDepth = 0,\n\t    title = column.definition[\"title\" + (this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1))] || column.definition.title;\n\n\tvar groupData = {\n\t\ttitle: title,\n\t\tcolumn: column,\n\t\tdepth: 1\n\t};\n\n\tif (subGroups.length) {\n\t\tgroupData.subGroups = [];\n\t\tgroupData.width = 0;\n\n\t\tsubGroups.forEach(function (subGroup) {\n\t\t\tvar subGroupData = _this57.processColumnGroup(subGroup);\n\n\t\t\tif (subGroupData) {\n\t\t\t\tgroupData.width += subGroupData.width;\n\t\t\t\tgroupData.subGroups.push(subGroupData);\n\n\t\t\t\tif (subGroupData.depth > maxDepth) {\n\t\t\t\t\tmaxDepth = subGroupData.depth;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgroupData.depth += maxDepth;\n\n\t\tif (!groupData.width) {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tif (this.columnVisCheck(column)) {\n\t\t\tgroupData.width = 1;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn groupData;\n};\n\nExport.prototype.columnVisCheck = function (column) {\n\treturn column.definition[this.colVisProp] !== false && (column.visible || !column.visible && column.definition[this.colVisProp]);\n};\n\nExport.prototype.headersToExportRows = function (columns) {\n\tvar headers = [],\n\t    headerDepth = 0,\n\t    exportRows = [];\n\n\tfunction parseColumnGroup(column, level) {\n\n\t\tvar depth = headerDepth - level;\n\n\t\tif (typeof headers[level] === \"undefined\") {\n\t\t\theaders[level] = [];\n\t\t}\n\n\t\tcolumn.height = column.subGroups ? 1 : depth - column.depth + 1;\n\n\t\theaders[level].push(column);\n\n\t\tif (column.height > 1) {\n\t\t\tfor (var _i10 = 1; _i10 < column.height; _i10++) {\n\n\t\t\t\tif (typeof headers[level + _i10] === \"undefined\") {\n\t\t\t\t\theaders[level + _i10] = [];\n\t\t\t\t}\n\n\t\t\t\theaders[level + _i10].push(false);\n\t\t\t}\n\t\t}\n\n\t\tif (column.width > 1) {\n\t\t\tfor (var _i11 = 1; _i11 < column.width; _i11++) {\n\t\t\t\theaders[level].push(false);\n\t\t\t}\n\t\t}\n\n\t\tif (column.subGroups) {\n\t\t\tcolumn.subGroups.forEach(function (subGroup) {\n\t\t\t\tparseColumnGroup(subGroup, level + 1);\n\t\t\t});\n\t\t}\n\t}\n\n\t//calculate maximum header debth\n\tcolumns.forEach(function (column) {\n\t\tif (column.depth > headerDepth) {\n\t\t\theaderDepth = column.depth;\n\t\t}\n\t});\n\n\tcolumns.forEach(function (column) {\n\t\tparseColumnGroup(column, 0);\n\t});\n\n\theaders.forEach(function (header) {\n\t\tvar columns = [];\n\n\t\theader.forEach(function (col) {\n\t\t\tif (col) {\n\t\t\t\tcolumns.push(new ExportColumn(col.title, col.column.getComponent(), col.width, col.height, col.depth));\n\t\t\t} else {\n\t\t\t\tcolumns.push(null);\n\t\t\t}\n\t\t});\n\n\t\texportRows.push(new ExportRow(\"header\", columns));\n\t});\n\n\treturn exportRows;\n};\n\nExport.prototype.bodyToExportRows = function (rows) {\n\tvar _this58 = this;\n\n\tvar columns = [];\n\tvar exportRows = [];\n\n\tthis.table.columnManager.columnsByIndex.forEach(function (column) {\n\t\tif (_this58.columnVisCheck(column)) {\n\t\t\tcolumns.push(column.getComponent());\n\t\t}\n\t});\n\n\tif (this.config.columnCalcs !== false && this.table.modExists(\"columnCalcs\")) {\n\t\tif (this.table.modules.columnCalcs.topInitialized) {\n\t\t\trows.unshift(this.table.modules.columnCalcs.topRow);\n\t\t}\n\n\t\tif (this.table.modules.columnCalcs.botInitialized) {\n\t\t\trows.push(this.table.modules.columnCalcs.botRow);\n\t\t}\n\t}\n\n\trows = rows.filter(function (row) {\n\t\tswitch (row.type) {\n\t\t\tcase \"group\":\n\t\t\t\treturn _this58.config.rowGroups !== false;\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\treturn _this58.config.columnCalcs !== false;\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\treturn !(_this58.table.options.dataTree && _this58.config.dataTree === false && row.modules.dataTree.parent);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\trows.forEach(function (row, i) {\n\t\tvar rowData = row.getData(_this58.colVisProp);\n\t\tvar exportCols = [];\n\t\tvar indent = 0;\n\n\t\tswitch (row.type) {\n\t\t\tcase \"group\":\n\t\t\t\tindent = row.level;\n\t\t\t\texportCols.push(new ExportColumn(row.key, row.getComponent(), columns.length, 1));\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\tcase \"row\":\n\t\t\t\tcolumns.forEach(function (col) {\n\t\t\t\t\texportCols.push(new ExportColumn(col._column.getFieldValue(rowData), col, 1, 1));\n\t\t\t\t});\n\n\t\t\t\tif (_this58.table.options.dataTree && _this58.config.dataTree !== false) {\n\t\t\t\t\tindent = row.modules.dataTree.index;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\texportRows.push(new ExportRow(row.type, exportCols, row.getComponent(), indent));\n\t});\n\n\treturn exportRows;\n};\n\nExport.prototype.genereateTableElement = function (list) {\n\tvar _this59 = this;\n\n\tvar table = document.createElement(\"table\"),\n\t    headerEl = document.createElement(\"thead\"),\n\t    bodyEl = document.createElement(\"tbody\"),\n\t    styles = this.lookupTableStyles(),\n\t    rowFormatter = this.table.options[\"rowFormatter\" + (this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1))],\n\t    setup = {};\n\n\tsetup.rowFormatter = rowFormatter !== null ? rowFormatter : this.table.options.rowFormatter;\n\n\tif (this.table.options.dataTree && this.config.dataTree !== false && this.table.modExists(\"columnCalcs\")) {\n\t\tsetup.treeElementField = this.table.modules.dataTree.elementField;\n\t}\n\n\t//assign group header formatter\n\tsetup.groupHeader = this.table.options[\"groupHeader\" + (this.colVisProp.charAt(0).toUpperCase() + this.colVisProp.slice(1))];\n\n\tif (setup.groupHeader && !Array.isArray(setup.groupHeader)) {\n\t\tsetup.groupHeader = [setup.groupHeader];\n\t}\n\n\ttable.classList.add(\"tabulator-print-table\");\n\n\tthis.mapElementStyles(this.table.columnManager.getHeadersElement(), headerEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\n\tif (list.length > 1000) {\n\t\tconsole.warn(\"It may take a long time to render an HTML table with more than 1000 rows\");\n\t}\n\n\tlist.forEach(function (row, i) {\n\t\tswitch (row.type) {\n\t\t\tcase \"header\":\n\t\t\t\theaderEl.appendChild(_this59.genereateHeaderElement(row, setup, styles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"group\":\n\t\t\t\tbodyEl.appendChild(_this59.genereateGroupElement(row, setup, styles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"calc\":\n\t\t\t\tbodyEl.appendChild(_this59.genereateCalcElement(row, setup, styles));\n\t\t\t\tbreak;\n\n\t\t\tcase \"row\":\n\t\t\t\tvar rowEl = _this59.genereateRowElement(row, setup, styles);\n\t\t\t\t_this59.mapElementStyles(i % 2 && styles.evenRow ? styles.evenRow : styles.oddRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\t\t\t\tbodyEl.appendChild(rowEl);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif (headerEl.innerHTML) {\n\t\ttable.appendChild(headerEl);\n\t}\n\n\ttable.appendChild(bodyEl);\n\n\tthis.mapElementStyles(this.table.element, table, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\"]);\n\treturn table;\n};\n\nExport.prototype.lookupTableStyles = function () {\n\tvar styles = {};\n\n\t//lookup row styles\n\tif (this.cloneTableStyle && window.getComputedStyle) {\n\t\tstyles.oddRow = this.table.element.querySelector(\".tabulator-row-odd:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\tstyles.evenRow = this.table.element.querySelector(\".tabulator-row-even:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\tstyles.calcRow = this.table.element.querySelector(\".tabulator-row.tabulator-calcs\");\n\t\tstyles.firstRow = this.table.element.querySelector(\".tabulator-row:not(.tabulator-group):not(.tabulator-calcs)\");\n\t\tstyles.firstGroup = this.table.element.getElementsByClassName(\"tabulator-group\")[0];\n\n\t\tif (styles.firstRow) {\n\t\t\tstyles.styleCells = styles.firstRow.getElementsByClassName(\"tabulator-cell\");\n\t\t\tstyles.firstCell = styles.styleCells[0];\n\t\t\tstyles.lastCell = styles.styleCells[styles.styleCells.length - 1];\n\t\t}\n\t}\n\n\treturn styles;\n};\n\nExport.prototype.genereateHeaderElement = function (row, setup, styles) {\n\tvar _this60 = this;\n\n\tvar rowEl = document.createElement(\"tr\");\n\n\trow.columns.forEach(function (column) {\n\t\tif (column) {\n\t\t\tvar cellEl = document.createElement(\"th\");\n\t\t\tvar classNames = column.component._column.definition.cssClass ? column.component._column.definition.cssClass.split(\" \") : [];\n\n\t\t\tcellEl.colSpan = column.width;\n\t\t\tcellEl.rowSpan = column.height;\n\n\t\t\tcellEl.innerHTML = column.value;\n\n\t\t\tif (_this60.cloneTableStyle) {\n\t\t\t\tcellEl.style.boxSizing = \"border-box\";\n\t\t\t}\n\n\t\t\tclassNames.forEach(function (className) {\n\t\t\t\tcellEl.classList.add(className);\n\t\t\t});\n\n\t\t\t_this60.mapElementStyles(column.component.getElement(), cellEl, [\"text-align\", \"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"background-color\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\t\t\t_this60.mapElementStyles(column.component._column.contentElement, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\n\t\t\tif (column.component._column.visible) {\n\t\t\t\t_this60.mapElementStyles(column.component.getElement(), cellEl, [\"width\"]);\n\t\t\t} else {\n\t\t\t\tif (column.component._column.definition.width) {\n\t\t\t\t\tcellEl.style.width = column.component._column.definition.width + \"px\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (column.component._column.parent) {\n\t\t\t\t_this60.mapElementStyles(column.component._column.parent.groupElement, cellEl, [\"border-top\"]);\n\t\t\t}\n\n\t\t\trowEl.appendChild(cellEl);\n\t\t}\n\t});\n\n\treturn rowEl;\n};\n\nExport.prototype.genereateGroupElement = function (row, setup, styles) {\n\n\tvar rowEl = document.createElement(\"tr\"),\n\t    cellEl = document.createElement(\"td\"),\n\t    group = row.columns[0];\n\n\trowEl.classList.add(\"tabulator-print-table-row\");\n\n\tif (setup.groupHeader && setup.groupHeader[row.indent]) {\n\t\tgroup.value = setup.groupHeader[row.indent](group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t} else {\n\t\tif (setup.groupHeader === false) {\n\t\t\tgroup.value = group.value;\n\t\t} else {\n\t\t\tgroup.value = row.component._group.generator(group.value, row.component._group.getRowCount(), row.component._group.getData(), row.component);\n\t\t}\n\t}\n\n\tcellEl.colSpan = group.width;\n\tcellEl.innerHTML = group.value;\n\n\trowEl.classList.add(\"tabulator-print-table-group\");\n\trowEl.classList.add(\"tabulator-group-level-\" + row.indent);\n\n\tif (group.component.isVisible()) {\n\t\trowEl.classList.add(\"tabulator-group-visible\");\n\t}\n\n\tthis.mapElementStyles(styles.firstGroup, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\tthis.mapElementStyles(styles.firstGroup, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\"]);\n\n\trowEl.appendChild(cellEl);\n\n\treturn rowEl;\n};\n\nExport.prototype.genereateCalcElement = function (row, setup, styles) {\n\tvar rowEl = this.genereateRowElement(row, setup, styles);\n\n\trowEl.classList.add(\"tabulator-print-table-calcs\");\n\tthis.mapElementStyles(styles.calcRow, rowEl, [\"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\", \"background-color\"]);\n\n\treturn rowEl;\n};\n\nExport.prototype.genereateRowElement = function (row, setup, styles) {\n\tvar _this61 = this;\n\n\tvar rowEl = document.createElement(\"tr\");\n\n\trowEl.classList.add(\"tabulator-print-table-row\");\n\n\trow.columns.forEach(function (col) {\n\n\t\tif (col) {\n\t\t\tvar cellEl = document.createElement(\"td\"),\n\t\t\t    column = col.component._column,\n\t\t\t    value = col.value;\n\n\t\t\tvar cellWrapper = {\n\t\t\t\tmodules: {},\n\t\t\t\tgetValue: function getValue() {\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\tgetField: function getField() {\n\t\t\t\t\treturn column.definition.field;\n\t\t\t\t},\n\t\t\t\tgetElement: function getElement() {\n\t\t\t\t\treturn cellEl;\n\t\t\t\t},\n\t\t\t\tgetColumn: function getColumn() {\n\t\t\t\t\treturn column.getComponent();\n\t\t\t\t},\n\t\t\t\tgetData: function getData() {\n\t\t\t\t\treturn row.component.getData();\n\t\t\t\t},\n\t\t\t\tgetRow: function getRow() {\n\t\t\t\t\treturn row.component;\n\t\t\t\t},\n\t\t\t\tgetComponent: function getComponent() {\n\t\t\t\t\treturn cellWrapper;\n\t\t\t\t},\n\t\t\t\tcolumn: column\n\t\t\t};\n\n\t\t\tvar classNames = column.definition.cssClass ? column.definition.cssClass.split(\" \") : [];\n\n\t\t\tclassNames.forEach(function (className) {\n\t\t\t\tcellEl.classList.add(className);\n\t\t\t});\n\n\t\t\tif (_this61.table.modExists(\"format\") && _this61.config.formatCells !== false) {\n\t\t\t\tvalue = _this61.table.modules.format.formatExportValue(cellWrapper, _this61.colVisProp);\n\t\t\t} else {\n\t\t\t\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\t\t\t\t\tcase \"object\":\n\t\t\t\t\t\tvalue = JSON.stringify(value);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\tcase \"null\":\n\t\t\t\t\t\tvalue = \"\";\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tvalue = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value instanceof Node) {\n\t\t\t\tcellEl.appendChild(value);\n\t\t\t} else {\n\t\t\t\tcellEl.innerHTML = value;\n\t\t\t}\n\n\t\t\tif (styles.firstCell) {\n\t\t\t\t_this61.mapElementStyles(styles.firstCell, cellEl, [\"padding-top\", \"padding-left\", \"padding-right\", \"padding-bottom\", \"border-top\", \"border-left\", \"border-right\", \"border-bottom\", \"color\", \"font-weight\", \"font-family\", \"font-size\"]);\n\n\t\t\t\tif (column.definition.align) {\n\t\t\t\t\tcellEl.style.textAlign = column.definition.align;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (_this61.table.options.dataTree && _this61.config.dataTree !== false) {\n\t\t\t\tif (setup.treeElementField && setup.treeElementField == column.field || !setup.treeElementField && i == 0) {\n\t\t\t\t\tif (row.component._row.modules.dataTree.controlEl) {\n\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.controlEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\tif (row.component._row.modules.dataTree.branchEl) {\n\t\t\t\t\t\tcellEl.insertBefore(row.component._row.modules.dataTree.branchEl.cloneNode(true), cellEl.firstChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trowEl.appendChild(cellEl);\n\n\t\t\tif (cellWrapper.modules.format && cellWrapper.modules.format.renderedCallback) {\n\t\t\t\tcellWrapper.modules.format.renderedCallback();\n\t\t\t}\n\n\t\t\tif (setup.rowFormatter && _this61.config.formatCells !== false) {\n\t\t\t\tsetup.rowFormatter(row.component);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn rowEl;\n};\n\nExport.prototype.genereateHTMLTable = function (list) {\n\tvar holder = document.createElement(\"div\");\n\n\tholder.appendChild(this.genereateTableElement(list));\n\n\treturn holder.innerHTML;\n};\n\nExport.prototype.getHtml = function (visible, style, config, colVisProp) {\n\tvar list = this.generateExportList(config || this.table.options.htmlOutputConfig, style, visible, colVisProp || \"htmlOutput\");\n\n\treturn this.genereateHTMLTable(list);\n};\n\nExport.prototype.mapElementStyles = function (from, to, props) {\n\tif (this.cloneTableStyle && from && to) {\n\n\t\tvar lookup = {\n\t\t\t\"background-color\": \"backgroundColor\",\n\t\t\t\"color\": \"fontColor\",\n\t\t\t\"width\": \"width\",\n\t\t\t\"font-weight\": \"fontWeight\",\n\t\t\t\"font-family\": \"fontFamily\",\n\t\t\t\"font-size\": \"fontSize\",\n\t\t\t\"text-align\": \"textAlign\",\n\t\t\t\"border-top\": \"borderTop\",\n\t\t\t\"border-left\": \"borderLeft\",\n\t\t\t\"border-right\": \"borderRight\",\n\t\t\t\"border-bottom\": \"borderBottom\",\n\t\t\t\"padding-top\": \"paddingTop\",\n\t\t\t\"padding-left\": \"paddingLeft\",\n\t\t\t\"padding-right\": \"paddingRight\",\n\t\t\t\"padding-bottom\": \"paddingBottom\"\n\t\t};\n\n\t\tif (window.getComputedStyle) {\n\t\t\tvar fromStyle = window.getComputedStyle(from);\n\n\t\t\tprops.forEach(function (prop) {\n\t\t\t\tto.style[lookup[prop]] = fromStyle.getPropertyValue(prop);\n\t\t\t});\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"export\", Export);\n\nvar Filter = function Filter(table) {\n\n\tthis.table = table; //hold Tabulator object\n\n\tthis.filterList = []; //hold filter list\n\tthis.headerFilters = {}; //hold column filters\n\tthis.headerFilterColumns = []; //hold columns that use header filters\n\n\tthis.prevHeaderFilterChangeCheck = \"\";\n\tthis.prevHeaderFilterChangeCheck = \"{}\";\n\n\tthis.changed = false; //has filtering changed since last render\n};\n\n//initialize column header filter\nFilter.prototype.initializeColumn = function (column, value) {\n\tvar self = this,\n\t    field = column.getField(),\n\t    params;\n\n\t//handle successfull value change\n\tfunction success(value) {\n\t\tvar filterType = column.modules.filter.tagType == \"input\" && column.modules.filter.attrType == \"text\" || column.modules.filter.tagType == \"textarea\" ? \"partial\" : \"match\",\n\t\t    type = \"\",\n\t\t    filterChangeCheck = \"\",\n\t\t    filterFunc;\n\n\t\tif (typeof column.modules.filter.prevSuccess === \"undefined\" || column.modules.filter.prevSuccess !== value) {\n\n\t\t\tcolumn.modules.filter.prevSuccess = value;\n\n\t\t\tif (!column.modules.filter.emptyFunc(value)) {\n\t\t\t\tcolumn.modules.filter.value = value;\n\n\t\t\t\tswitch (_typeof(column.definition.headerFilterFunc)) {\n\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\tif (self.filters[column.definition.headerFilterFunc]) {\n\t\t\t\t\t\t\ttype = column.definition.headerFilterFunc;\n\t\t\t\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\t\treturn self.filters[column.definition.headerFilterFunc](value, fieldVal, data, params);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.warn(\"Header Filter Error - Matching filter function not found: \", column.definition.headerFilterFunc);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\t\t\tvar params = column.definition.headerFilterFuncParams || {};\n\t\t\t\t\t\t\tvar fieldVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\tparams = typeof params === \"function\" ? params(value, fieldVal, data) : params;\n\n\t\t\t\t\t\t\treturn column.definition.headerFilterFunc(value, fieldVal, data, params);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\ttype = filterFunc;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (!filterFunc) {\n\t\t\t\t\tswitch (filterType) {\n\t\t\t\t\t\tcase \"partial\":\n\t\t\t\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\t\t\t\tvar colVal = column.getFieldValue(data);\n\n\t\t\t\t\t\t\t\tif (typeof colVal !== 'undefined' && colVal !== null) {\n\t\t\t\t\t\t\t\t\treturn String(colVal).toLowerCase().indexOf(String(value).toLowerCase()) > -1;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\ttype = \"like\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\t\t\t\treturn column.getFieldValue(data) == value;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\ttype = \"=\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself.headerFilters[field] = { value: value, func: filterFunc, type: type, params: params || {} };\n\t\t\t} else {\n\t\t\t\tdelete self.headerFilters[field];\n\t\t\t}\n\n\t\t\tfilterChangeCheck = JSON.stringify(self.headerFilters);\n\n\t\t\tif (self.prevHeaderFilterChangeCheck !== filterChangeCheck) {\n\t\t\t\tself.prevHeaderFilterChangeCheck = filterChangeCheck;\n\n\t\t\t\tself.changed = true;\n\t\t\t\tself.table.rowManager.filterRefresh();\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tcolumn.modules.filter = {\n\t\tsuccess: success,\n\t\tattrType: false,\n\t\ttagType: false,\n\t\temptyFunc: false\n\t};\n\n\tthis.generateHeaderFilterElement(column);\n};\n\nFilter.prototype.generateHeaderFilterElement = function (column, initialValue, reinitialize) {\n\tvar _this62 = this;\n\n\tvar self = this,\n\t    success = column.modules.filter.success,\n\t    field = column.getField(),\n\t    filterElement,\n\t    editor,\n\t    editorElement,\n\t    cellWrapper,\n\t    typingTimer,\n\t    searchTrigger,\n\t    params;\n\n\t//handle aborted edit\n\tfunction cancel() {}\n\n\tif (column.modules.filter.headerElement && column.modules.filter.headerElement.parentNode) {\n\t\tcolumn.contentElement.removeChild(column.modules.filter.headerElement.parentNode);\n\t}\n\n\tif (field) {\n\n\t\t//set empty value function\n\t\tcolumn.modules.filter.emptyFunc = column.definition.headerFilterEmptyCheck || function (value) {\n\t\t\treturn !value && value !== \"0\" && value !== 0;\n\t\t};\n\n\t\tfilterElement = document.createElement(\"div\");\n\t\tfilterElement.classList.add(\"tabulator-header-filter\");\n\n\t\t//set column editor\n\t\tswitch (_typeof(column.definition.headerFilter)) {\n\t\t\tcase \"string\":\n\t\t\t\tif (self.table.modules.edit.editors[column.definition.headerFilter]) {\n\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.headerFilter];\n\n\t\t\t\t\tif ((column.definition.headerFilter === \"tick\" || column.definition.headerFilter === \"tickCross\") && !column.definition.headerFilterEmptyCheck) {\n\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function (value) {\n\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"Filter Error - Cannot build header filter, No such editor found: \", column.definition.editor);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\teditor = column.definition.headerFilter;\n\t\t\t\tbreak;\n\n\t\t\tcase \"boolean\":\n\t\t\t\tif (column.modules.edit && column.modules.edit.editor) {\n\t\t\t\t\teditor = column.modules.edit.editor;\n\t\t\t\t} else {\n\t\t\t\t\tif (column.definition.formatter && self.table.modules.edit.editors[column.definition.formatter]) {\n\t\t\t\t\t\teditor = self.table.modules.edit.editors[column.definition.formatter];\n\n\t\t\t\t\t\tif ((column.definition.formatter === \"tick\" || column.definition.formatter === \"tickCross\") && !column.definition.headerFilterEmptyCheck) {\n\t\t\t\t\t\t\tcolumn.modules.filter.emptyFunc = function (value) {\n\t\t\t\t\t\t\t\treturn value !== true && value !== false;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\teditor = self.table.modules.edit.editors[\"input\"];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (editor) {\n\n\t\t\tcellWrapper = {\n\t\t\t\tgetValue: function getValue() {\n\t\t\t\t\treturn typeof initialValue !== \"undefined\" ? initialValue : \"\";\n\t\t\t\t},\n\t\t\t\tgetField: function getField() {\n\t\t\t\t\treturn column.definition.field;\n\t\t\t\t},\n\t\t\t\tgetElement: function getElement() {\n\t\t\t\t\treturn filterElement;\n\t\t\t\t},\n\t\t\t\tgetColumn: function getColumn() {\n\t\t\t\t\treturn column.getComponent();\n\t\t\t\t},\n\t\t\t\tgetRow: function getRow() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tnormalizeHeight: function normalizeHeight() {}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tparams = column.definition.headerFilterParams || {};\n\n\t\t\tparams = typeof params === \"function\" ? params.call(self.table) : params;\n\n\t\t\teditorElement = editor.call(this.table.modules.edit, cellWrapper, function () {}, success, cancel, params);\n\n\t\t\tif (!editorElement) {\n\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor returned a value of false\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!(editorElement instanceof Node)) {\n\t\t\t\tconsole.warn(\"Filter Error - Cannot add filter to \" + field + \" column, editor should return an instance of Node, the editor returned:\", editorElement);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//set Placeholder Text\n\t\t\tif (field) {\n\t\t\t\tself.table.modules.localize.bind(\"headerFilters|columns|\" + column.definition.field, function (value) {\n\t\t\t\t\teditorElement.setAttribute(\"placeholder\", typeof value !== \"undefined\" && value ? value : self.table.modules.localize.getText(\"headerFilters|default\"));\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tself.table.modules.localize.bind(\"headerFilters|default\", function (value) {\n\t\t\t\t\teditorElement.setAttribute(\"placeholder\", typeof self.column.definition.headerFilterPlaceholder !== \"undefined\" && self.column.definition.headerFilterPlaceholder ? self.column.definition.headerFilterPlaceholder : value);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//focus on element on click\n\t\t\teditorElement.addEventListener(\"click\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t\teditorElement.focus();\n\t\t\t});\n\n\t\t\teditorElement.addEventListener(\"focus\", function (e) {\n\t\t\t\tvar left = _this62.table.columnManager.element.scrollLeft;\n\n\t\t\t\tif (left !== _this62.table.rowManager.element.scrollLeft) {\n\t\t\t\t\t_this62.table.rowManager.scrollHorizontal(left);\n\t\t\t\t\t_this62.table.columnManager.scrollHorizontal(left);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//live update filters as user types\n\t\t\ttypingTimer = false;\n\n\t\t\tsearchTrigger = function searchTrigger(e) {\n\t\t\t\tif (typingTimer) {\n\t\t\t\t\tclearTimeout(typingTimer);\n\t\t\t\t}\n\n\t\t\t\ttypingTimer = setTimeout(function () {\n\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t}, self.table.options.headerFilterLiveFilterDelay);\n\t\t\t};\n\n\t\t\tcolumn.modules.filter.headerElement = editorElement;\n\t\t\tcolumn.modules.filter.attrType = editorElement.hasAttribute(\"type\") ? editorElement.getAttribute(\"type\").toLowerCase() : \"\";\n\t\t\tcolumn.modules.filter.tagType = editorElement.tagName.toLowerCase();\n\n\t\t\tif (column.definition.headerFilterLiveFilter !== false) {\n\n\t\t\t\tif (!(column.definition.headerFilter === 'autocomplete' || column.definition.headerFilter === 'tickCross' || (column.definition.editor === 'autocomplete' || column.definition.editor === 'tickCross') && column.definition.headerFilter === true)) {\n\t\t\t\t\teditorElement.addEventListener(\"keyup\", searchTrigger);\n\t\t\t\t\teditorElement.addEventListener(\"search\", searchTrigger);\n\n\t\t\t\t\t//update number filtered columns on change\n\t\t\t\t\tif (column.modules.filter.attrType == \"number\") {\n\t\t\t\t\t\teditorElement.addEventListener(\"change\", function (e) {\n\t\t\t\t\t\t\tsuccess(editorElement.value);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t//change text inputs to search inputs to allow for clearing of field\n\t\t\t\t\tif (column.modules.filter.attrType == \"text\" && this.table.browser !== \"ie\") {\n\t\t\t\t\t\teditorElement.setAttribute(\"type\", \"search\");\n\t\t\t\t\t\t// editorElement.off(\"change blur\"); //prevent blur from triggering filter and preventing selection click\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//prevent input and select elements from propegating click to column sorters etc\n\t\t\t\tif (column.modules.filter.tagType == \"input\" || column.modules.filter.tagType == \"select\" || column.modules.filter.tagType == \"textarea\") {\n\t\t\t\t\teditorElement.addEventListener(\"mousedown\", function (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfilterElement.appendChild(editorElement);\n\n\t\t\tcolumn.contentElement.appendChild(filterElement);\n\n\t\t\tif (!reinitialize) {\n\t\t\t\tself.headerFilterColumns.push(column);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Filter Error - Cannot add header filter, column has no field set:\", column.definition.title);\n\t}\n};\n\n//hide all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\nFilter.prototype.hideHeaderFilterElements = function () {\n\tthis.headerFilterColumns.forEach(function (column) {\n\t\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\t\tcolumn.modules.filter.headerElement.style.display = 'none';\n\t\t}\n\t});\n};\n\n//show all header filter elements (used to ensure correct column widths in \"fitData\" layout mode)\nFilter.prototype.showHeaderFilterElements = function () {\n\tthis.headerFilterColumns.forEach(function (column) {\n\t\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\t\tcolumn.modules.filter.headerElement.style.display = '';\n\t\t}\n\t});\n};\n\n//programatically set focus of header filter\nFilter.prototype.setHeaderFilterFocus = function (column) {\n\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\tcolumn.modules.filter.headerElement.focus();\n\t} else {\n\t\tconsole.warn(\"Column Filter Focus Error - No header filter set on column:\", column.getField());\n\t}\n};\n\n//programmatically get value of header filter\nFilter.prototype.getHeaderFilterValue = function (column) {\n\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\treturn column.modules.filter.headerElement.value;\n\t} else {\n\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t}\n};\n\n//programatically set value of header filter\nFilter.prototype.setHeaderFilterValue = function (column, value) {\n\tif (column) {\n\t\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\t\tthis.generateHeaderFilterElement(column, value, true);\n\t\t\tcolumn.modules.filter.success(value);\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n};\n\nFilter.prototype.reloadHeaderFilter = function (column) {\n\tif (column) {\n\t\tif (column.modules.filter && column.modules.filter.headerElement) {\n\t\t\tthis.generateHeaderFilterElement(column, column.modules.filter.value, true);\n\t\t} else {\n\t\t\tconsole.warn(\"Column Filter Error - No header filter set on column:\", column.getField());\n\t\t}\n\t}\n};\n\n//check if the filters has changed since last use\nFilter.prototype.hasChanged = function () {\n\tvar changed = this.changed;\n\tthis.changed = false;\n\treturn changed;\n};\n\n//set standard filters\nFilter.prototype.setFilter = function (field, type, value, params) {\n\tvar self = this;\n\n\tself.filterList = [];\n\n\tif (!Array.isArray(field)) {\n\t\tfield = [{ field: field, type: type, value: value, params: params }];\n\t}\n\n\tself.addFilter(field);\n};\n\n//add filter to array\nFilter.prototype.addFilter = function (field, type, value, params) {\n\tvar self = this;\n\n\tif (!Array.isArray(field)) {\n\t\tfield = [{ field: field, type: type, value: value, params: params }];\n\t}\n\n\tfield.forEach(function (filter) {\n\n\t\tfilter = self.findFilter(filter);\n\n\t\tif (filter) {\n\t\t\tself.filterList.push(filter);\n\n\t\t\tself.changed = true;\n\t\t}\n\t});\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.filter) {\n\t\tthis.table.modules.persistence.save(\"filter\");\n\t}\n};\n\nFilter.prototype.findFilter = function (filter) {\n\tvar self = this,\n\t    column;\n\n\tif (Array.isArray(filter)) {\n\t\treturn this.findSubFilters(filter);\n\t}\n\n\tvar filterFunc = false;\n\n\tif (typeof filter.field == \"function\") {\n\t\tfilterFunc = function filterFunc(data) {\n\t\t\treturn filter.field(data, filter.type || {}); // pass params to custom filter function\n\t\t};\n\t} else {\n\n\t\tif (self.filters[filter.type]) {\n\n\t\t\tcolumn = self.table.columnManager.getColumnByField(filter.field);\n\n\t\t\tif (column) {\n\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\treturn self.filters[filter.type](filter.value, column.getFieldValue(data), data, filter.params || {});\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tfilterFunc = function filterFunc(data) {\n\t\t\t\t\treturn self.filters[filter.type](filter.value, data[filter.field], data, filter.params || {});\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Filter Error - No such filter type found, ignoring: \", filter.type);\n\t\t}\n\t}\n\n\tfilter.func = filterFunc;\n\n\treturn filter.func ? filter : false;\n};\n\nFilter.prototype.findSubFilters = function (filters) {\n\tvar self = this,\n\t    output = [];\n\n\tfilters.forEach(function (filter) {\n\t\tfilter = self.findFilter(filter);\n\n\t\tif (filter) {\n\t\t\toutput.push(filter);\n\t\t}\n\t});\n\n\treturn output.length ? output : false;\n};\n\n//get all filters\nFilter.prototype.getFilters = function (all, ajax) {\n\tvar output = [];\n\n\tif (all) {\n\t\toutput = this.getHeaderFilters();\n\t}\n\n\tif (ajax) {\n\t\toutput.forEach(function (item) {\n\t\t\tif (typeof item.type == \"function\") {\n\t\t\t\titem.type = \"function\";\n\t\t\t}\n\t\t});\n\t}\n\n\toutput = output.concat(this.filtersToArray(this.filterList, ajax));\n\n\treturn output;\n};\n\n//filter to Object\nFilter.prototype.filtersToArray = function (filterList, ajax) {\n\tvar _this63 = this;\n\n\tvar output = [];\n\n\tfilterList.forEach(function (filter) {\n\t\tvar item;\n\n\t\tif (Array.isArray(filter)) {\n\t\t\toutput.push(_this63.filtersToArray(filter, ajax));\n\t\t} else {\n\t\t\titem = { field: filter.field, type: filter.type, value: filter.value };\n\n\t\t\tif (ajax) {\n\t\t\t\tif (typeof item.type == \"function\") {\n\t\t\t\t\titem.type = \"function\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toutput.push(item);\n\t\t}\n\t});\n\n\treturn output;\n};\n\n//get all filters\nFilter.prototype.getHeaderFilters = function () {\n\tvar self = this,\n\t    output = [];\n\n\tfor (var key in this.headerFilters) {\n\t\toutput.push({ field: key, type: this.headerFilters[key].type, value: this.headerFilters[key].value });\n\t}\n\n\treturn output;\n};\n\n//remove filter from array\nFilter.prototype.removeFilter = function (field, type, value) {\n\tvar self = this;\n\n\tif (!Array.isArray(field)) {\n\t\tfield = [{ field: field, type: type, value: value }];\n\t}\n\n\tfield.forEach(function (filter) {\n\t\tvar index = -1;\n\n\t\tif (_typeof(filter.field) == \"object\") {\n\t\t\tindex = self.filterList.findIndex(function (element) {\n\t\t\t\treturn filter === element;\n\t\t\t});\n\t\t} else {\n\t\t\tindex = self.filterList.findIndex(function (element) {\n\t\t\t\treturn filter.field === element.field && filter.type === element.type && filter.value === element.value;\n\t\t\t});\n\t\t}\n\n\t\tif (index > -1) {\n\t\t\tself.filterList.splice(index, 1);\n\t\t\tself.changed = true;\n\t\t} else {\n\t\t\tconsole.warn(\"Filter Error - No matching filter type found, ignoring: \", filter.type);\n\t\t}\n\t});\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.filter) {\n\t\tthis.table.modules.persistence.save(\"filter\");\n\t}\n};\n\n//clear filters\nFilter.prototype.clearFilter = function (all) {\n\tthis.filterList = [];\n\n\tif (all) {\n\t\tthis.clearHeaderFilter();\n\t}\n\n\tthis.changed = true;\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.filter) {\n\t\tthis.table.modules.persistence.save(\"filter\");\n\t}\n};\n\n//clear header filters\nFilter.prototype.clearHeaderFilter = function () {\n\tvar self = this;\n\n\tthis.headerFilters = {};\n\tself.prevHeaderFilterChangeCheck = \"{}\";\n\n\tthis.headerFilterColumns.forEach(function (column) {\n\t\tif (typeof column.modules.filter.value !== \"undefined\") {\n\t\t\tdelete column.modules.filter.value;\n\t\t}\n\t\tcolumn.modules.filter.prevSuccess = undefined;\n\t\tself.reloadHeaderFilter(column);\n\t});\n\n\tthis.changed = true;\n};\n\n//search data and return matching rows\nFilter.prototype.search = function (searchType, field, type, value) {\n\tvar self = this,\n\t    activeRows = [],\n\t    filterList = [];\n\n\tif (!Array.isArray(field)) {\n\t\tfield = [{ field: field, type: type, value: value }];\n\t}\n\n\tfield.forEach(function (filter) {\n\t\tfilter = self.findFilter(filter);\n\n\t\tif (filter) {\n\t\t\tfilterList.push(filter);\n\t\t}\n\t});\n\n\tthis.table.rowManager.rows.forEach(function (row) {\n\t\tvar match = true;\n\n\t\tfilterList.forEach(function (filter) {\n\t\t\tif (!self.filterRecurse(filter, row.getData())) {\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\n\t\tif (match) {\n\t\t\tactiveRows.push(searchType === \"data\" ? row.getData(\"data\") : row.getComponent());\n\t\t}\n\t});\n\n\treturn activeRows;\n};\n\n//filter row array\nFilter.prototype.filter = function (rowList, filters) {\n\tvar self = this,\n\t    activeRows = [],\n\t    activeRowComponents = [];\n\n\tif (self.table.options.dataFiltering) {\n\t\tself.table.options.dataFiltering.call(self.table, self.getFilters());\n\t}\n\n\tif (!self.table.options.ajaxFiltering && (self.filterList.length || Object.keys(self.headerFilters).length)) {\n\n\t\trowList.forEach(function (row) {\n\t\t\tif (self.filterRow(row)) {\n\t\t\t\tactiveRows.push(row);\n\t\t\t}\n\t\t});\n\t} else {\n\t\tactiveRows = rowList.slice(0);\n\t}\n\n\tif (self.table.options.dataFiltered) {\n\n\t\tactiveRows.forEach(function (row) {\n\t\t\tactiveRowComponents.push(row.getComponent());\n\t\t});\n\n\t\tself.table.options.dataFiltered.call(self.table, self.getFilters(), activeRowComponents);\n\t}\n\n\treturn activeRows;\n};\n\n//filter individual row\nFilter.prototype.filterRow = function (row, filters) {\n\tvar self = this,\n\t    match = true,\n\t    data = row.getData();\n\n\tself.filterList.forEach(function (filter) {\n\t\tif (!self.filterRecurse(filter, data)) {\n\t\t\tmatch = false;\n\t\t}\n\t});\n\n\tfor (var field in self.headerFilters) {\n\t\tif (!self.headerFilters[field].func(data)) {\n\t\t\tmatch = false;\n\t\t}\n\t}\n\n\treturn match;\n};\n\nFilter.prototype.filterRecurse = function (filter, data) {\n\tvar self = this,\n\t    match = false;\n\n\tif (Array.isArray(filter)) {\n\t\tfilter.forEach(function (subFilter) {\n\t\t\tif (self.filterRecurse(subFilter, data)) {\n\t\t\t\tmatch = true;\n\t\t\t}\n\t\t});\n\t} else {\n\t\tmatch = filter.func(data);\n\t}\n\n\treturn match;\n};\n\n//list of available filters\nFilter.prototype.filters = {\n\n\t//equal to\n\t\"=\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal == filterVal ? true : false;\n\t},\n\n\t//less than\n\t\"<\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal < filterVal ? true : false;\n\t},\n\n\t//less than or equal to\n\t\"<=\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal <= filterVal ? true : false;\n\t},\n\n\t//greater than\n\t\">\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal > filterVal ? true : false;\n\t},\n\n\t//greater than or equal to\n\t\">=\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal >= filterVal ? true : false;\n\t},\n\n\t//not equal to\n\t\"!=\": function _(filterVal, rowVal, rowData, filterParams) {\n\t\treturn rowVal != filterVal ? true : false;\n\t},\n\n\t\"regex\": function regex(filterVal, rowVal, rowData, filterParams) {\n\n\t\tif (typeof filterVal == \"string\") {\n\t\t\tfilterVal = new RegExp(filterVal);\n\t\t}\n\n\t\treturn filterVal.test(rowVal);\n\t},\n\n\t//contains the string\n\t\"like\": function like(filterVal, rowVal, rowData, filterParams) {\n\t\tif (filterVal === null || typeof filterVal === \"undefined\") {\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t} else {\n\t\t\tif (typeof rowVal !== 'undefined' && rowVal !== null) {\n\t\t\t\treturn String(rowVal).toLowerCase().indexOf(filterVal.toLowerCase()) > -1;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//contains the keywords\n\t\"keywords\": function keywords(filterVal, rowVal, rowData, filterParams) {\n\t\tvar keywords = filterVal.toLowerCase().split(typeof filterParams.separator === \"undefined\" ? \" \" : filterParams.separator),\n\t\t    value = String(rowVal === null || typeof rowVal === \"undefined\" ? \"\" : rowVal).toLowerCase(),\n\t\t    matches = [];\n\n\t\tkeywords.forEach(function (keyword) {\n\t\t\tif (value.includes(keyword)) {\n\t\t\t\tmatches.push(true);\n\t\t\t}\n\t\t});\n\n\t\treturn filterParams.matchAll ? matches.length === keywords.length : !!matches.length;\n\t},\n\n\t//starts with the string\n\t\"starts\": function starts(filterVal, rowVal, rowData, filterParams) {\n\t\tif (filterVal === null || typeof filterVal === \"undefined\") {\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t} else {\n\t\t\tif (typeof rowVal !== 'undefined' && rowVal !== null) {\n\t\t\t\treturn String(rowVal).toLowerCase().startsWith(filterVal.toLowerCase());\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//ends with the string\n\t\"ends\": function ends(filterVal, rowVal, rowData, filterParams) {\n\t\tif (filterVal === null || typeof filterVal === \"undefined\") {\n\t\t\treturn rowVal === filterVal ? true : false;\n\t\t} else {\n\t\t\tif (typeof rowVal !== 'undefined' && rowVal !== null) {\n\t\t\t\treturn String(rowVal).toLowerCase().endsWith(filterVal.toLowerCase());\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t},\n\n\t//in array\n\t\"in\": function _in(filterVal, rowVal, rowData, filterParams) {\n\t\tif (Array.isArray(filterVal)) {\n\t\t\treturn filterVal.length ? filterVal.indexOf(rowVal) > -1 : true;\n\t\t} else {\n\t\t\tconsole.warn(\"Filter Error - filter value is not an array:\", filterVal);\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"filter\", Filter);\n\nvar Format = function Format(table) {\n\tthis.table = table; //hold Tabulator object\n};\n\n//initialize column formatter\nFormat.prototype.initializeColumn = function (column) {\n\tcolumn.modules.format = this.lookupFormatter(column, \"\");\n\n\tif (typeof column.definition.formatterPrint !== \"undefined\") {\n\t\tcolumn.modules.format.print = this.lookupFormatter(column, \"Print\");\n\t}\n\n\tif (typeof column.definition.formatterClipboard !== \"undefined\") {\n\t\tcolumn.modules.format.clipboard = this.lookupFormatter(column, \"Clipboard\");\n\t}\n\n\tif (typeof column.definition.formatterHtmlOutput !== \"undefined\") {\n\t\tcolumn.modules.format.htmlOutput = this.lookupFormatter(column, \"HtmlOutput\");\n\t}\n};\n\nFormat.prototype.lookupFormatter = function (column, type) {\n\tvar config = { params: column.definition[\"formatter\" + type + \"Params\"] || {} },\n\t    formatter = column.definition[\"formatter\" + type];\n\n\t//set column formatter\n\tswitch (typeof formatter === 'undefined' ? 'undefined' : _typeof(formatter)) {\n\t\tcase \"string\":\n\n\t\t\tif (formatter === \"tick\") {\n\t\t\t\tformatter = \"tickCross\";\n\n\t\t\t\tif (typeof config.params.crossElement == \"undefined\") {\n\t\t\t\t\tconfig.params.crossElement = false;\n\t\t\t\t}\n\n\t\t\t\tconsole.warn(\"DEPRECATION WARNING - the tick formatter has been deprecated, please use the tickCross formatter with the crossElement param set to false\");\n\t\t\t}\n\n\t\t\tif (this.formatters[formatter]) {\n\t\t\t\tconfig.formatter = this.formatters[formatter];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Formatter Error - No such formatter found: \", formatter);\n\t\t\t\tconfig.formatter = this.formatters.plaintext;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tconfig.formatter = formatter;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tconfig.formatter = this.formatters.plaintext;\n\t\t\tbreak;\n\t}\n\n\treturn config;\n};\n\nFormat.prototype.cellRendered = function (cell) {\n\tif (cell.modules.format && cell.modules.format.renderedCallback && !cell.modules.format.rendered) {\n\t\tcell.modules.format.renderedCallback();\n\t\tcell.modules.format.rendered = true;\n\t}\n};\n\n//return a formatted value for a cell\nFormat.prototype.formatValue = function (cell) {\n\tvar component = cell.getComponent(),\n\t    params = typeof cell.column.modules.format.params === \"function\" ? cell.column.modules.format.params(component) : cell.column.modules.format.params;\n\n\tfunction onRendered(callback) {\n\t\tif (!cell.modules.format) {\n\t\t\tcell.modules.format = {};\n\t\t}\n\n\t\tcell.modules.format.renderedCallback = callback;\n\t\tcell.modules.format.rendered = false;\n\t}\n\n\treturn cell.column.modules.format.formatter.call(this, component, params, onRendered);\n};\n\nFormat.prototype.formatExportValue = function (cell, type) {\n\tvar formatter = cell.column.modules.format[type],\n\t    params;\n\n\tif (formatter) {\n\t\tvar onRendered = function onRendered(callback) {\n\t\t\tif (!cell.modules.format) {\n\t\t\t\tcell.modules.format = {};\n\t\t\t}\n\n\t\t\tcell.modules.format.renderedCallback = callback;\n\t\t\tcell.modules.format.rendered = false;\n\t\t};\n\n\t\tparams = typeof formatter.params === \"function\" ? formatter.params(component) : formatter.params;\n\n\t\treturn formatter.formatter.call(this, cell.getComponent(), params, onRendered);\n\t} else {\n\t\treturn this.formatValue(cell);\n\t}\n};\n\nFormat.prototype.sanitizeHTML = function (value) {\n\tif (value) {\n\t\tvar entityMap = {\n\t\t\t'&': '&amp;',\n\t\t\t'<': '&lt;',\n\t\t\t'>': '&gt;',\n\t\t\t'\"': '&quot;',\n\t\t\t\"'\": '&#39;',\n\t\t\t'/': '&#x2F;',\n\t\t\t'`': '&#x60;',\n\t\t\t'=': '&#x3D;'\n\t\t};\n\n\t\treturn String(value).replace(/[&<>\"'`=\\/]/g, function (s) {\n\t\t\treturn entityMap[s];\n\t\t});\n\t} else {\n\t\treturn value;\n\t}\n};\n\nFormat.prototype.emptyToSpace = function (value) {\n\treturn value === null || typeof value === \"undefined\" || value === \"\" ? \"&nbsp;\" : value;\n};\n\n//get formatter for cell\nFormat.prototype.getFormatter = function (formatter) {\n\tvar formatter;\n\n\tswitch (typeof formatter === 'undefined' ? 'undefined' : _typeof(formatter)) {\n\t\tcase \"string\":\n\t\t\tif (this.formatters[formatter]) {\n\t\t\t\tformatter = this.formatters[formatter];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Formatter Error - No such formatter found: \", formatter);\n\t\t\t\tformatter = this.formatters.plaintext;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tformatter = formatter;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tformatter = this.formatters.plaintext;\n\t\t\tbreak;\n\t}\n\n\treturn formatter;\n};\n\n//default data formatters\nFormat.prototype.formatters = {\n\t//plain text value\n\tplaintext: function plaintext(cell, formatterParams, onRendered) {\n\t\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n\t},\n\n\t//html text value\n\thtml: function html(cell, formatterParams, onRendered) {\n\t\treturn cell.getValue();\n\t},\n\n\t//multiline text area\n\ttextarea: function textarea(cell, formatterParams, onRendered) {\n\t\tcell.getElement().style.whiteSpace = \"pre-wrap\";\n\t\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n\t},\n\n\t//currency formatting\n\tmoney: function money(cell, formatterParams, onRendered) {\n\t\tvar floatVal = parseFloat(cell.getValue()),\n\t\t    number,\n\t\t    integer,\n\t\t    decimal,\n\t\t    rgx;\n\n\t\tvar decimalSym = formatterParams.decimal || \".\";\n\t\tvar thousandSym = formatterParams.thousand || \",\";\n\t\tvar symbol = formatterParams.symbol || \"\";\n\t\tvar after = !!formatterParams.symbolAfter;\n\t\tvar precision = typeof formatterParams.precision !== \"undefined\" ? formatterParams.precision : 2;\n\n\t\tif (isNaN(floatVal)) {\n\t\t\treturn this.emptyToSpace(this.sanitizeHTML(cell.getValue()));\n\t\t}\n\n\t\tnumber = precision !== false ? floatVal.toFixed(precision) : floatVal;\n\t\tnumber = String(number).split(\".\");\n\n\t\tinteger = number[0];\n\t\tdecimal = number.length > 1 ? decimalSym + number[1] : \"\";\n\n\t\trgx = /(\\d+)(\\d{3})/;\n\n\t\twhile (rgx.test(integer)) {\n\t\t\tinteger = integer.replace(rgx, \"$1\" + thousandSym + \"$2\");\n\t\t}\n\n\t\treturn after ? integer + decimal + symbol : symbol + integer + decimal;\n\t},\n\n\t//clickable anchor tag\n\tlink: function link(cell, formatterParams, onRendered) {\n\t\tvar value = cell.getValue(),\n\t\t    urlPrefix = formatterParams.urlPrefix || \"\",\n\t\t    download = formatterParams.download,\n\t\t    label = value,\n\t\t    el = document.createElement(\"a\"),\n\t\t    data;\n\n\t\tif (formatterParams.labelField) {\n\t\t\tdata = cell.getData();\n\t\t\tlabel = data[formatterParams.labelField];\n\t\t}\n\n\t\tif (formatterParams.label) {\n\t\t\tswitch (_typeof(formatterParams.label)) {\n\t\t\t\tcase \"string\":\n\t\t\t\t\tlabel = formatterParams.label;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"function\":\n\t\t\t\t\tlabel = formatterParams.label(cell);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (label) {\n\t\t\tif (formatterParams.urlField) {\n\t\t\t\tdata = cell.getData();\n\t\t\t\tvalue = data[formatterParams.urlField];\n\t\t\t}\n\n\t\t\tif (formatterParams.url) {\n\t\t\t\tswitch (_typeof(formatterParams.url)) {\n\t\t\t\t\tcase \"string\":\n\t\t\t\t\t\tvalue = formatterParams.url;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\tvalue = formatterParams.url(cell);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tel.setAttribute(\"href\", urlPrefix + value);\n\n\t\t\tif (formatterParams.target) {\n\t\t\t\tel.setAttribute(\"target\", formatterParams.target);\n\t\t\t}\n\n\t\t\tif (formatterParams.download) {\n\n\t\t\t\tif (typeof download == \"function\") {\n\t\t\t\t\tdownload = download(cell);\n\t\t\t\t} else {\n\t\t\t\t\tdownload = download === true ? \"\" : download;\n\t\t\t\t}\n\n\t\t\t\tel.setAttribute(\"download\", download);\n\t\t\t}\n\n\t\t\tel.innerHTML = this.emptyToSpace(this.sanitizeHTML(label));\n\n\t\t\treturn el;\n\t\t} else {\n\t\t\treturn \"&nbsp;\";\n\t\t}\n\t},\n\n\t//image element\n\timage: function image(cell, formatterParams, onRendered) {\n\t\tvar el = document.createElement(\"img\"),\n\t\t    src = cell.getValue();\n\n\t\tif (formatterParams.urlPrefix) {\n\t\t\tsrc = formatterParams.urlPrefix + cell.getValue();\n\t\t}\n\n\t\tif (formatterParams.urlSuffix) {\n\t\t\tsrc = src + formatterParams.urlSuffix;\n\t\t}\n\n\t\tel.setAttribute(\"src\", src);\n\n\t\tswitch (_typeof(formatterParams.height)) {\n\t\t\tcase \"number\":\n\t\t\t\tel.style.height = formatterParams.height + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase \"string\":\n\t\t\t\tel.style.height = formatterParams.height;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch (_typeof(formatterParams.width)) {\n\t\t\tcase \"number\":\n\t\t\t\tel.style.width = formatterParams.width + \"px\";\n\t\t\t\tbreak;\n\n\t\t\tcase \"string\":\n\t\t\t\tel.style.width = formatterParams.width;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tel.addEventListener(\"load\", function () {\n\t\t\tcell.getRow().normalizeHeight();\n\t\t});\n\n\t\treturn el;\n\t},\n\n\t//tick or cross\n\ttickCross: function tickCross(cell, formatterParams, onRendered) {\n\t\tvar value = cell.getValue(),\n\t\t    element = cell.getElement(),\n\t\t    empty = formatterParams.allowEmpty,\n\t\t    truthy = formatterParams.allowTruthy,\n\t\t    tick = typeof formatterParams.tickElement !== \"undefined\" ? formatterParams.tickElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>',\n\t\t    cross = typeof formatterParams.crossElement !== \"undefined\" ? formatterParams.crossElement : '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\"  viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n\n\t\tif (truthy && value || value === true || value === \"true\" || value === \"True\" || value === 1 || value === \"1\") {\n\t\t\telement.setAttribute(\"aria-checked\", true);\n\t\t\treturn tick || \"\";\n\t\t} else {\n\t\t\tif (empty && (value === \"null\" || value === \"\" || value === null || typeof value === \"undefined\")) {\n\t\t\t\telement.setAttribute(\"aria-checked\", \"mixed\");\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\telement.setAttribute(\"aria-checked\", false);\n\t\t\t\treturn cross || \"\";\n\t\t\t}\n\t\t}\n\t},\n\n\tdatetime: function datetime(cell, formatterParams, onRendered) {\n\t\tvar inputFormat = formatterParams.inputFormat || \"YYYY-MM-DD hh:mm:ss\";\n\t\tvar outputFormat = formatterParams.outputFormat || \"DD/MM/YYYY hh:mm:ss\";\n\t\tvar invalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\t\tvar value = cell.getValue();\n\n\t\tvar newDatetime = moment(value, inputFormat);\n\n\t\tif (newDatetime.isValid()) {\n\t\t\treturn formatterParams.timezone ? newDatetime.tz(formatterParams.timezone).format(outputFormat) : newDatetime.format(outputFormat);\n\t\t} else {\n\n\t\t\tif (invalid === true) {\n\t\t\t\treturn value;\n\t\t\t} else if (typeof invalid === \"function\") {\n\t\t\t\treturn invalid(value);\n\t\t\t} else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t},\n\n\tdatetimediff: function datetime(cell, formatterParams, onRendered) {\n\t\tvar inputFormat = formatterParams.inputFormat || \"YYYY-MM-DD hh:mm:ss\";\n\t\tvar invalid = typeof formatterParams.invalidPlaceholder !== \"undefined\" ? formatterParams.invalidPlaceholder : \"\";\n\t\tvar suffix = typeof formatterParams.suffix !== \"undefined\" ? formatterParams.suffix : false;\n\t\tvar unit = typeof formatterParams.unit !== \"undefined\" ? formatterParams.unit : undefined;\n\t\tvar humanize = typeof formatterParams.humanize !== \"undefined\" ? formatterParams.humanize : false;\n\t\tvar date = typeof formatterParams.date !== \"undefined\" ? formatterParams.date : moment();\n\t\tvar value = cell.getValue();\n\n\t\tvar newDatetime = moment(value, inputFormat);\n\n\t\tif (newDatetime.isValid()) {\n\t\t\tif (humanize) {\n\t\t\t\treturn moment.duration(newDatetime.diff(date)).humanize(suffix);\n\t\t\t} else {\n\t\t\t\treturn newDatetime.diff(date, unit) + (suffix ? \" \" + suffix : \"\");\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (invalid === true) {\n\t\t\t\treturn value;\n\t\t\t} else if (typeof invalid === \"function\") {\n\t\t\t\treturn invalid(value);\n\t\t\t} else {\n\t\t\t\treturn invalid;\n\t\t\t}\n\t\t}\n\t},\n\n\t//select\n\tlookup: function lookup(cell, formatterParams, onRendered) {\n\t\tvar value = cell.getValue();\n\n\t\tif (typeof formatterParams[value] === \"undefined\") {\n\t\t\tconsole.warn('Missing display value for ' + value);\n\t\t\treturn value;\n\t\t}\n\n\t\treturn formatterParams[value];\n\t},\n\n\t//star rating\n\tstar: function star(cell, formatterParams, onRendered) {\n\t\tvar value = cell.getValue(),\n\t\t    element = cell.getElement(),\n\t\t    maxStars = formatterParams && formatterParams.stars ? formatterParams.stars : 5,\n\t\t    stars = document.createElement(\"span\"),\n\t\t    star = document.createElementNS('http://www.w3.org/2000/svg', \"svg\"),\n\t\t    starActive = '<polygon fill=\"#FFEA00\" stroke=\"#C1AB60\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>',\n\t\t    starInactive = '<polygon fill=\"#D2D2D2\" stroke=\"#686868\" stroke-width=\"37.6152\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" points=\"259.216,29.942 330.27,173.919 489.16,197.007 374.185,309.08 401.33,467.31 259.216,392.612 117.104,467.31 144.25,309.08 29.274,197.007 188.165,173.919 \"/>';\n\n\t\t//style stars holder\n\t\tstars.style.verticalAlign = \"middle\";\n\n\t\t//style star\n\t\tstar.setAttribute(\"width\", \"14\");\n\t\tstar.setAttribute(\"height\", \"14\");\n\t\tstar.setAttribute(\"viewBox\", \"0 0 512 512\");\n\t\tstar.setAttribute(\"xml:space\", \"preserve\");\n\t\tstar.style.padding = \"0 1px\";\n\n\t\tvalue = value && !isNaN(value) ? parseInt(value) : 0;\n\n\t\tvalue = Math.max(0, Math.min(value, maxStars));\n\n\t\tfor (var i = 1; i <= maxStars; i++) {\n\t\t\tvar nextStar = star.cloneNode(true);\n\t\t\tnextStar.innerHTML = i <= value ? starActive : starInactive;\n\n\t\t\tstars.appendChild(nextStar);\n\t\t}\n\n\t\telement.style.whiteSpace = \"nowrap\";\n\t\telement.style.overflow = \"hidden\";\n\t\telement.style.textOverflow = \"ellipsis\";\n\n\t\telement.setAttribute(\"aria-label\", value);\n\n\t\treturn stars;\n\t},\n\n\ttraffic: function traffic(cell, formatterParams, onRendered) {\n\t\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\t\t    el = document.createElement(\"span\"),\n\t\t    max = formatterParams && formatterParams.max ? formatterParams.max : 100,\n\t\t    min = formatterParams && formatterParams.min ? formatterParams.min : 0,\n\t\t    colors = formatterParams && typeof formatterParams.color !== \"undefined\" ? formatterParams.color : [\"red\", \"orange\", \"green\"],\n\t\t    color = \"#666666\",\n\t\t    percent,\n\t\t    percentValue;\n\n\t\tif (isNaN(value) || typeof cell.getValue() === \"undefined\") {\n\t\t\treturn;\n\t\t}\n\n\t\tel.classList.add(\"tabulator-traffic-light\");\n\n\t\t//make sure value is in range\n\t\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\t\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t\t//workout percentage\n\t\tpercent = (max - min) / 100;\n\t\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t\t//set color\n\t\tswitch (typeof colors === 'undefined' ? 'undefined' : _typeof(colors)) {\n\t\t\tcase \"string\":\n\t\t\t\tcolor = colors;\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tcolor = colors(value);\n\t\t\t\tbreak;\n\t\t\tcase \"object\":\n\t\t\t\tif (Array.isArray(colors)) {\n\t\t\t\t\tvar unit = 100 / colors.length;\n\t\t\t\t\tvar index = Math.floor(percentValue / unit);\n\n\t\t\t\t\tindex = Math.min(index, colors.length - 1);\n\t\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\t\tcolor = colors[index];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\n\t\tel.style.backgroundColor = color;\n\n\t\treturn el;\n\t},\n\n\t//progress bar\n\tprogress: function progress(cell, formatterParams, onRendered) {\n\t\t//progress bar\n\t\tvar value = this.sanitizeHTML(cell.getValue()) || 0,\n\t\t    element = cell.getElement(),\n\t\t    max = formatterParams && formatterParams.max ? formatterParams.max : 100,\n\t\t    min = formatterParams && formatterParams.min ? formatterParams.min : 0,\n\t\t    legendAlign = formatterParams && formatterParams.legendAlign ? formatterParams.legendAlign : \"center\",\n\t\t    percent,\n\t\t    percentValue,\n\t\t    color,\n\t\t    legend,\n\t\t    legendColor,\n\t\t    top,\n\t\t    left,\n\t\t    right,\n\t\t    bottom;\n\n\t\t//make sure value is in range\n\t\tpercentValue = parseFloat(value) <= max ? parseFloat(value) : max;\n\t\tpercentValue = parseFloat(percentValue) >= min ? parseFloat(percentValue) : min;\n\n\t\t//workout percentage\n\t\tpercent = (max - min) / 100;\n\t\tpercentValue = Math.round((percentValue - min) / percent);\n\n\t\t//set bar color\n\t\tswitch (_typeof(formatterParams.color)) {\n\t\t\tcase \"string\":\n\t\t\t\tcolor = formatterParams.color;\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tcolor = formatterParams.color(value);\n\t\t\t\tbreak;\n\t\t\tcase \"object\":\n\t\t\t\tif (Array.isArray(formatterParams.color)) {\n\t\t\t\t\tvar unit = 100 / formatterParams.color.length;\n\t\t\t\t\tvar index = Math.floor(percentValue / unit);\n\n\t\t\t\t\tindex = Math.min(index, formatterParams.color.length - 1);\n\t\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\t\tcolor = formatterParams.color[index];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\tcolor = \"#2DC214\";\n\t\t}\n\n\t\t//generate legend\n\t\tswitch (_typeof(formatterParams.legend)) {\n\t\t\tcase \"string\":\n\t\t\t\tlegend = formatterParams.legend;\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tlegend = formatterParams.legend(value);\n\t\t\t\tbreak;\n\t\t\tcase \"boolean\":\n\t\t\t\tlegend = value;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlegend = false;\n\t\t}\n\n\t\t//set legend color\n\t\tswitch (_typeof(formatterParams.legendColor)) {\n\t\t\tcase \"string\":\n\t\t\t\tlegendColor = formatterParams.legendColor;\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tlegendColor = formatterParams.legendColor(value);\n\t\t\t\tbreak;\n\t\t\tcase \"object\":\n\t\t\t\tif (Array.isArray(formatterParams.legendColor)) {\n\t\t\t\t\tvar unit = 100 / formatterParams.legendColor.length;\n\t\t\t\t\tvar index = Math.floor(percentValue / unit);\n\n\t\t\t\t\tindex = Math.min(index, formatterParams.legendColor.length - 1);\n\t\t\t\t\tindex = Math.max(index, 0);\n\t\t\t\t\tlegendColor = formatterParams.legendColor[index];\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlegendColor = \"#000\";\n\t\t}\n\n\t\telement.style.minWidth = \"30px\";\n\t\telement.style.position = \"relative\";\n\n\t\telement.setAttribute(\"aria-label\", percentValue);\n\n\t\tvar barEl = document.createElement(\"div\");\n\t\tbarEl.style.display = \"inline-block\";\n\t\tbarEl.style.position = \"relative\";\n\t\tbarEl.style.width = percentValue + \"%\";\n\t\tbarEl.style.backgroundColor = color;\n\t\tbarEl.style.height = \"100%\";\n\n\t\tbarEl.setAttribute('data-max', max);\n\t\tbarEl.setAttribute('data-min', min);\n\n\t\tif (legend) {\n\t\t\tvar legendEl = document.createElement(\"div\");\n\t\t\tlegendEl.style.position = \"absolute\";\n\t\t\tlegendEl.style.top = \"4px\";\n\t\t\tlegendEl.style.left = 0;\n\t\t\tlegendEl.style.textAlign = legendAlign;\n\t\t\tlegendEl.style.width = \"100%\";\n\t\t\tlegendEl.style.color = legendColor;\n\t\t\tlegendEl.innerHTML = legend;\n\t\t}\n\n\t\tonRendered(function () {\n\n\t\t\t//handle custom element needed if formatter is to be included in printed/downloaded output\n\t\t\tif (!(cell instanceof CellComponent)) {\n\t\t\t\tvar holderEl = document.createElement(\"div\");\n\t\t\t\tholderEl.style.position = \"absolute\";\n\t\t\t\tholderEl.style.top = \"4px\";\n\t\t\t\tholderEl.style.bottom = \"4px\";\n\t\t\t\tholderEl.style.left = \"4px\";\n\t\t\t\tholderEl.style.right = \"4px\";\n\n\t\t\t\telement.appendChild(holderEl);\n\n\t\t\t\telement = holderEl;\n\t\t\t}\n\n\t\t\telement.appendChild(barEl);\n\n\t\t\tif (legend) {\n\t\t\t\telement.appendChild(legendEl);\n\t\t\t}\n\t\t});\n\n\t\treturn \"\";\n\t},\n\n\t//background color\n\tcolor: function color(cell, formatterParams, onRendered) {\n\t\tcell.getElement().style.backgroundColor = this.sanitizeHTML(cell.getValue());\n\t\treturn \"\";\n\t},\n\n\t//tick icon\n\tbuttonTick: function buttonTick(cell, formatterParams, onRendered) {\n\t\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#2DC214\" clip-rule=\"evenodd\" d=\"M21.652,3.211c-0.293-0.295-0.77-0.295-1.061,0L9.41,14.34  c-0.293,0.297-0.771,0.297-1.062,0L3.449,9.351C3.304,9.203,3.114,9.13,2.923,9.129C2.73,9.128,2.534,9.201,2.387,9.351  l-2.165,1.946C0.078,11.445,0,11.63,0,11.823c0,0.194,0.078,0.397,0.223,0.544l4.94,5.184c0.292,0.296,0.771,0.776,1.062,1.07  l2.124,2.141c0.292,0.293,0.769,0.293,1.062,0l14.366-14.34c0.293-0.294,0.293-0.777,0-1.071L21.652,3.211z\" fill-rule=\"evenodd\"/></svg>';\n\t},\n\n\t//cross icon\n\tbuttonCross: function buttonCross(cell, formatterParams, onRendered) {\n\t\treturn '<svg enable-background=\"new 0 0 24 24\" height=\"14\" width=\"14\" viewBox=\"0 0 24 24\" xml:space=\"preserve\" ><path fill=\"#CE1515\" d=\"M22.245,4.015c0.313,0.313,0.313,0.826,0,1.139l-6.276,6.27c-0.313,0.312-0.313,0.826,0,1.14l6.273,6.272  c0.313,0.313,0.313,0.826,0,1.14l-2.285,2.277c-0.314,0.312-0.828,0.312-1.142,0l-6.271-6.271c-0.313-0.313-0.828-0.313-1.141,0  l-6.276,6.267c-0.313,0.313-0.828,0.313-1.141,0l-2.282-2.28c-0.313-0.313-0.313-0.826,0-1.14l6.278-6.269  c0.313-0.312,0.313-0.826,0-1.14L1.709,5.147c-0.314-0.313-0.314-0.827,0-1.14l2.284-2.278C4.308,1.417,4.821,1.417,5.135,1.73  L11.405,8c0.314,0.314,0.828,0.314,1.141,0.001l6.276-6.267c0.312-0.312,0.826-0.312,1.141,0L22.245,4.015z\"/></svg>';\n\t},\n\n\t//current row number\n\trownum: function rownum(cell, formatterParams, onRendered) {\n\t\treturn this.table.rowManager.activeRows.indexOf(cell.getRow()._getSelf()) + 1;\n\t},\n\n\t//row handle\n\thandle: function handle(cell, formatterParams, onRendered) {\n\t\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\t\treturn \"<div class='tabulator-row-handle-box'><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div><div class='tabulator-row-handle-bar'></div></div>\";\n\t},\n\n\tresponsiveCollapse: function responsiveCollapse(cell, formatterParams, onRendered) {\n\t\tvar self = this,\n\t\t    open = false,\n\t\t    el = document.createElement(\"div\"),\n\t\t    config = cell.getRow()._row.modules.responsiveLayout;\n\n\t\tel.classList.add(\"tabulator-responsive-collapse-toggle\");\n\t\tel.innerHTML = \"<span class='tabulator-responsive-collapse-toggle-open'>+</span><span class='tabulator-responsive-collapse-toggle-close'>-</span>\";\n\n\t\tcell.getElement().classList.add(\"tabulator-row-handle\");\n\n\t\tfunction toggleList(isOpen) {\n\t\t\tvar collapseEl = config.element;\n\n\t\t\tconfig.open = isOpen;\n\n\t\t\tif (collapseEl) {\n\n\t\t\t\tif (config.open) {\n\t\t\t\t\tel.classList.add(\"open\");\n\t\t\t\t\tcollapseEl.style.display = '';\n\t\t\t\t} else {\n\t\t\t\t\tel.classList.remove(\"open\");\n\t\t\t\t\tcollapseEl.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tel.addEventListener(\"click\", function (e) {\n\t\t\te.stopImmediatePropagation();\n\t\t\ttoggleList(!config.open);\n\t\t});\n\n\t\ttoggleList(config.open);\n\n\t\treturn el;\n\t},\n\n\trowSelection: function rowSelection(cell, formatterParams, onRendered) {\n\t\tvar _this64 = this;\n\n\t\tvar checkbox = document.createElement(\"input\");\n\n\t\tcheckbox.type = 'checkbox';\n\n\t\tif (this.table.modExists(\"selectRow\", true)) {\n\n\t\t\tcheckbox.addEventListener(\"click\", function (e) {\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\n\t\t\tif (typeof cell.getRow == 'function') {\n\t\t\t\tvar row = cell.getRow();\n\n\t\t\t\tif (row instanceof RowComponent) {\n\n\t\t\t\t\tcheckbox.addEventListener(\"change\", function (e) {\n\t\t\t\t\t\trow.toggleSelect();\n\t\t\t\t\t});\n\n\t\t\t\t\tcheckbox.checked = row.isSelected && row.isSelected();\n\t\t\t\t\tthis.table.modules.selectRow.registerRowSelectCheckbox(row, checkbox);\n\t\t\t\t} else {\n\t\t\t\t\tcheckbox = \"\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcheckbox.addEventListener(\"change\", function (e) {\n\t\t\t\t\tif (_this64.table.modules.selectRow.selectedRows.length) {\n\t\t\t\t\t\t_this64.table.deselectRow();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_this64.table.selectRow(formatterParams.rowRange);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.table.modules.selectRow.registerHeaderSelectCheckbox(checkbox);\n\t\t\t}\n\t\t}\n\t\treturn checkbox;\n\t}\n};\n\nTabulator.prototype.registerModule(\"format\", Format);\n\nvar FrozenColumns = function FrozenColumns(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.leftColumns = [];\n\tthis.rightColumns = [];\n\tthis.leftMargin = 0;\n\tthis.rightMargin = 0;\n\tthis.rightPadding = 0;\n\tthis.initializationMode = \"left\";\n\tthis.active = false;\n\tthis.scrollEndTimer = false;\n};\n\n//reset initial state\nFrozenColumns.prototype.reset = function () {\n\tthis.initializationMode = \"left\";\n\tthis.leftColumns = [];\n\tthis.rightColumns = [];\n\tthis.leftMargin = 0;\n\tthis.rightMargin = 0;\n\tthis.rightMargin = 0;\n\tthis.active = false;\n\n\tthis.table.columnManager.headersElement.style.marginLeft = 0;\n\tthis.table.columnManager.element.style.paddingRight = 0;\n};\n\n//initialize specific column\nFrozenColumns.prototype.initializeColumn = function (column) {\n\tvar config = { margin: 0, edge: false };\n\n\tif (!column.isGroup) {\n\n\t\tif (this.frozenCheck(column)) {\n\n\t\t\tconfig.position = this.initializationMode;\n\n\t\t\tif (this.initializationMode == \"left\") {\n\t\t\t\tthis.leftColumns.push(column);\n\t\t\t} else {\n\t\t\t\tthis.rightColumns.unshift(column);\n\t\t\t}\n\n\t\t\tthis.active = true;\n\n\t\t\tcolumn.modules.frozen = config;\n\t\t} else {\n\t\t\tthis.initializationMode = \"right\";\n\t\t}\n\t}\n};\n\nFrozenColumns.prototype.frozenCheck = function (column) {\n\tvar frozen = false;\n\n\tif (column.parent.isGroup && column.definition.frozen) {\n\t\tconsole.warn(\"Frozen Column Error - Parent column group must be frozen, not individual columns or sub column groups\");\n\t}\n\n\tif (column.parent.isGroup) {\n\t\treturn this.frozenCheck(column.parent);\n\t} else {\n\t\treturn column.definition.frozen;\n\t}\n\n\treturn frozen;\n};\n\n//quick layout to smooth horizontal scrolling\nFrozenColumns.prototype.scrollHorizontal = function () {\n\tvar _this65 = this;\n\n\tvar rows;\n\n\tif (this.active) {\n\t\tclearTimeout(this.scrollEndTimer);\n\n\t\t//layout all rows after scroll is complete\n\t\tthis.scrollEndTimer = setTimeout(function () {\n\t\t\t_this65.layout();\n\t\t}, 100);\n\n\t\trows = this.table.rowManager.getVisibleRows();\n\n\t\tthis.calcMargins();\n\n\t\tthis.layoutColumnPosition();\n\n\t\tthis.layoutCalcRows();\n\n\t\trows.forEach(function (row) {\n\t\t\tif (row.type === \"row\") {\n\t\t\t\t_this65.layoutRow(row);\n\t\t\t}\n\t\t});\n\n\t\tthis.table.rowManager.tableElement.style.marginRight = this.rightMargin;\n\t}\n};\n\n//calculate margins for rows\nFrozenColumns.prototype.calcMargins = function () {\n\tthis.leftMargin = this._calcSpace(this.leftColumns, this.leftColumns.length) + \"px\";\n\tthis.table.columnManager.headersElement.style.marginLeft = this.leftMargin;\n\n\tthis.rightMargin = this._calcSpace(this.rightColumns, this.rightColumns.length) + \"px\";\n\tthis.table.columnManager.element.style.paddingRight = this.rightMargin;\n\n\t//calculate right frozen columns\n\tthis.rightPadding = this.table.rowManager.element.clientWidth + this.table.columnManager.scrollLeft;\n};\n\n//layout calculation rows\nFrozenColumns.prototype.layoutCalcRows = function () {\n\tif (this.table.modExists(\"columnCalcs\")) {\n\t\tif (this.table.modules.columnCalcs.topInitialized && this.table.modules.columnCalcs.topRow) {\n\t\t\tthis.layoutRow(this.table.modules.columnCalcs.topRow);\n\t\t}\n\t\tif (this.table.modules.columnCalcs.botInitialized && this.table.modules.columnCalcs.botRow) {\n\t\t\tthis.layoutRow(this.table.modules.columnCalcs.botRow);\n\t\t}\n\t}\n};\n\n//calculate column positions and layout headers\nFrozenColumns.prototype.layoutColumnPosition = function (allCells) {\n\tvar _this66 = this;\n\n\tvar leftParents = [];\n\n\tthis.leftColumns.forEach(function (column, i) {\n\t\tcolumn.modules.frozen.margin = _this66._calcSpace(_this66.leftColumns, i) + _this66.table.columnManager.scrollLeft + \"px\";\n\n\t\tif (i == _this66.leftColumns.length - 1) {\n\t\t\tcolumn.modules.frozen.edge = true;\n\t\t} else {\n\t\t\tcolumn.modules.frozen.edge = false;\n\t\t}\n\n\t\tif (column.parent.isGroup) {\n\t\t\tvar parentEl = _this66.getColGroupParentElement(column);\n\t\t\tif (!leftParents.includes(parentEl)) {\n\t\t\t\t_this66.layoutElement(parentEl, column);\n\t\t\t\tleftParents.push(parentEl);\n\t\t\t}\n\n\t\t\tif (column.modules.frozen.edge) {\n\t\t\t\tparentEl.classList.add(\"tabulator-frozen-\" + column.modules.frozen.position);\n\t\t\t}\n\t\t} else {\n\t\t\t_this66.layoutElement(column.getElement(), column);\n\t\t}\n\n\t\tif (allCells) {\n\t\t\tcolumn.cells.forEach(function (cell) {\n\t\t\t\t_this66.layoutElement(cell.getElement(true), column);\n\t\t\t});\n\t\t}\n\t});\n\n\tthis.rightColumns.forEach(function (column, i) {\n\t\tcolumn.modules.frozen.margin = _this66.rightPadding - _this66._calcSpace(_this66.rightColumns, i + 1) + \"px\";\n\n\t\tif (i == _this66.rightColumns.length - 1) {\n\t\t\tcolumn.modules.frozen.edge = true;\n\t\t} else {\n\t\t\tcolumn.modules.frozen.edge = false;\n\t\t}\n\n\t\tif (column.parent.isGroup) {\n\t\t\t_this66.layoutElement(_this66.getColGroupParentElement(column), column);\n\t\t} else {\n\t\t\t_this66.layoutElement(column.getElement(), column);\n\t\t}\n\n\t\tif (allCells) {\n\t\t\tcolumn.cells.forEach(function (cell) {\n\t\t\t\t_this66.layoutElement(cell.getElement(true), column);\n\t\t\t});\n\t\t}\n\t});\n};\n\nFrozenColumns.prototype.getColGroupParentElement = function (column) {\n\treturn column.parent.isGroup ? this.getColGroupParentElement(column.parent) : column.getElement();\n};\n\n//layout columns appropropriatly\nFrozenColumns.prototype.layout = function () {\n\tvar self = this,\n\t    rightMargin = 0;\n\n\tif (self.active) {\n\n\t\t//calculate row padding\n\t\tthis.calcMargins();\n\n\t\t// self.table.rowManager.activeRows.forEach(function(row){\n\t\t// \tself.layoutRow(row);\n\t\t// });\n\n\t\t// if(self.table.options.dataTree){\n\t\tself.table.rowManager.getDisplayRows().forEach(function (row) {\n\t\t\tif (row.type === \"row\") {\n\t\t\t\tself.layoutRow(row);\n\t\t\t}\n\t\t});\n\t\t// }\n\n\t\tthis.layoutCalcRows();\n\n\t\t//calculate left columns\n\t\tthis.layoutColumnPosition(true);\n\n\t\t// if(tableHolder.scrollHeight > tableHolder.clientHeight){\n\t\t// \trightMargin -= tableHolder.offsetWidth - tableHolder.clientWidth;\n\t\t// }\n\n\t\tthis.table.rowManager.tableElement.style.marginRight = this.rightMargin;\n\t}\n};\n\nFrozenColumns.prototype.layoutRow = function (row) {\n\tvar _this67 = this;\n\n\tvar rowEl = row.getElement();\n\n\trowEl.style.paddingLeft = this.leftMargin;\n\t// rowEl.style.paddingRight = this.rightMargin + \"px\";\n\n\tthis.leftColumns.forEach(function (column) {\n\t\tvar cell = row.getCell(column);\n\n\t\tif (cell) {\n\t\t\t_this67.layoutElement(cell.getElement(true), column);\n\t\t}\n\t});\n\n\tthis.rightColumns.forEach(function (column) {\n\t\tvar cell = row.getCell(column);\n\n\t\tif (cell) {\n\t\t\t_this67.layoutElement(cell.getElement(true), column);\n\t\t}\n\t});\n};\n\nFrozenColumns.prototype.layoutElement = function (element, column) {\n\n\tif (column.modules.frozen) {\n\t\telement.style.position = \"absolute\";\n\t\telement.style.left = column.modules.frozen.margin;\n\n\t\telement.classList.add(\"tabulator-frozen\");\n\n\t\tif (column.modules.frozen.edge) {\n\t\t\telement.classList.add(\"tabulator-frozen-\" + column.modules.frozen.position);\n\t\t}\n\t}\n};\n\nFrozenColumns.prototype._calcSpace = function (columns, index) {\n\tvar width = 0;\n\n\tfor (var _i12 = 0; _i12 < index; _i12++) {\n\t\tif (columns[_i12].visible) {\n\t\t\twidth += columns[_i12].getWidth();\n\t\t}\n\t}\n\n\treturn width;\n};\n\nTabulator.prototype.registerModule(\"frozenColumns\", FrozenColumns);\nvar FrozenRows = function FrozenRows(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.topElement = document.createElement(\"div\");\n\tthis.rows = [];\n\tthis.displayIndex = 0; //index in display pipeline\n};\n\nFrozenRows.prototype.initialize = function () {\n\tthis.rows = [];\n\n\tthis.topElement.classList.add(\"tabulator-frozen-rows-holder\");\n\n\t// this.table.columnManager.element.append(this.topElement);\n\tthis.table.columnManager.getElement().insertBefore(this.topElement, this.table.columnManager.headersElement.nextSibling);\n};\n\nFrozenRows.prototype.setDisplayIndex = function (index) {\n\tthis.displayIndex = index;\n};\n\nFrozenRows.prototype.getDisplayIndex = function () {\n\treturn this.displayIndex;\n};\n\nFrozenRows.prototype.isFrozen = function () {\n\treturn !!this.rows.length;\n};\n\n//filter frozen rows out of display data\nFrozenRows.prototype.getRows = function (rows) {\n\tvar self = this,\n\t    frozen = [],\n\t    output = rows.slice(0);\n\n\tthis.rows.forEach(function (row) {\n\t\tvar index = output.indexOf(row);\n\n\t\tif (index > -1) {\n\t\t\toutput.splice(index, 1);\n\t\t}\n\t});\n\n\treturn output;\n};\n\nFrozenRows.prototype.freezeRow = function (row) {\n\tif (!row.modules.frozen) {\n\t\trow.modules.frozen = true;\n\t\tthis.topElement.appendChild(row.getElement());\n\t\trow.initialize();\n\t\trow.normalizeHeight();\n\t\tthis.table.rowManager.adjustTableSize();\n\n\t\tthis.rows.push(row);\n\n\t\tthis.table.rowManager.refreshActiveData(\"display\");\n\n\t\tthis.styleRows();\n\t} else {\n\t\tconsole.warn(\"Freeze Error - Row is already frozen\");\n\t}\n};\n\nFrozenRows.prototype.unfreezeRow = function (row) {\n\tvar index = this.rows.indexOf(row);\n\n\tif (row.modules.frozen) {\n\n\t\trow.modules.frozen = false;\n\n\t\tthis.detachRow(row);\n\n\t\tthis.table.rowManager.adjustTableSize();\n\n\t\tthis.table.rowManager.refreshActiveData(\"display\");\n\n\t\tif (this.rows.length) {\n\t\t\tthis.styleRows();\n\t\t}\n\t} else {\n\t\tconsole.warn(\"Freeze Error - Row is already unfrozen\");\n\t}\n};\n\nFrozenRows.prototype.detachRow = function (row) {\n\tvar index = this.rows.indexOf(row);\n\n\tif (index > -1) {\n\t\tvar rowEl = row.getElement();\n\t\trowEl.parentNode.removeChild(rowEl);\n\n\t\tthis.rows.splice(index, 1);\n\t}\n};\n\nFrozenRows.prototype.styleRows = function (row) {\n\tvar self = this;\n\n\tthis.rows.forEach(function (row, i) {\n\t\tself.table.rowManager.styleRow(row, i);\n\t});\n};\n\nTabulator.prototype.registerModule(\"frozenRows\", FrozenRows);\n\n//public group object\nvar GroupComponent = function GroupComponent(group) {\n\tthis._group = group;\n\tthis.type = \"GroupComponent\";\n};\n\nGroupComponent.prototype.getKey = function () {\n\treturn this._group.key;\n};\n\nGroupComponent.prototype.getField = function () {\n\treturn this._group.field;\n};\n\nGroupComponent.prototype.getElement = function () {\n\treturn this._group.element;\n};\n\nGroupComponent.prototype.getRows = function () {\n\treturn this._group.getRows(true);\n};\n\nGroupComponent.prototype.getSubGroups = function () {\n\treturn this._group.getSubGroups(true);\n};\n\nGroupComponent.prototype.getParentGroup = function () {\n\treturn this._group.parent ? this._group.parent.getComponent() : false;\n};\n\nGroupComponent.prototype.getVisibility = function () {\n\tconsole.warn(\"getVisibility function is deprecated, you should now use the isVisible function\");\n\treturn this._group.visible;\n};\n\nGroupComponent.prototype.isVisible = function () {\n\treturn this._group.visible;\n};\n\nGroupComponent.prototype.show = function () {\n\tthis._group.show();\n};\n\nGroupComponent.prototype.hide = function () {\n\tthis._group.hide();\n};\n\nGroupComponent.prototype.toggle = function () {\n\tthis._group.toggleVisibility();\n};\n\nGroupComponent.prototype._getSelf = function () {\n\treturn this._group;\n};\n\nGroupComponent.prototype.getTable = function () {\n\treturn this._group.groupManager.table;\n};\n\n//////////////////////////////////////////////////\n//////////////// Group Functions /////////////////\n//////////////////////////////////////////////////\n\nvar Group = function Group(groupManager, parent, level, key, field, generator, oldGroup) {\n\n\tthis.groupManager = groupManager;\n\tthis.parent = parent;\n\tthis.key = key;\n\tthis.level = level;\n\tthis.field = field;\n\tthis.hasSubGroups = level < groupManager.groupIDLookups.length - 1;\n\tthis.addRow = this.hasSubGroups ? this._addRowToGroup : this._addRow;\n\tthis.type = \"group\"; //type of element\n\tthis.old = oldGroup;\n\tthis.rows = [];\n\tthis.groups = [];\n\tthis.groupList = [];\n\tthis.generator = generator;\n\tthis.elementContents = false;\n\tthis.height = 0;\n\tthis.outerHeight = 0;\n\tthis.initialized = false;\n\tthis.calcs = {};\n\tthis.initialized = false;\n\tthis.modules = {};\n\tthis.arrowElement = false;\n\n\tthis.visible = oldGroup ? oldGroup.visible : typeof groupManager.startOpen[level] !== \"undefined\" ? groupManager.startOpen[level] : groupManager.startOpen[0];\n\n\tthis.component = null;\n\n\tthis.createElements();\n\tthis.addBindings();\n\n\tthis.createValueGroups();\n};\n\nGroup.prototype.wipe = function () {\n\tif (this.groupList.length) {\n\t\tthis.groupList.forEach(function (group) {\n\t\t\tgroup.wipe();\n\t\t});\n\t} else {\n\t\tthis.element = false;\n\t\tthis.arrowElement = false;\n\t\tthis.elementContents = false;\n\t}\n};\n\nGroup.prototype.createElements = function () {\n\tvar arrow = document.createElement(\"div\");\n\tarrow.classList.add(\"tabulator-arrow\");\n\n\tthis.element = document.createElement(\"div\");\n\tthis.element.classList.add(\"tabulator-row\");\n\tthis.element.classList.add(\"tabulator-group\");\n\tthis.element.classList.add(\"tabulator-group-level-\" + this.level);\n\tthis.element.setAttribute(\"role\", \"rowgroup\");\n\n\tthis.arrowElement = document.createElement(\"div\");\n\tthis.arrowElement.classList.add(\"tabulator-group-toggle\");\n\tthis.arrowElement.appendChild(arrow);\n\n\t//setup movable rows\n\tif (this.groupManager.table.options.movableRows !== false && this.groupManager.table.modExists(\"moveRow\")) {\n\t\tthis.groupManager.table.modules.moveRow.initializeGroupHeader(this);\n\t}\n};\n\nGroup.prototype.createValueGroups = function () {\n\tvar _this68 = this;\n\n\tvar level = this.level + 1;\n\tif (this.groupManager.allowedValues && this.groupManager.allowedValues[level]) {\n\t\tthis.groupManager.allowedValues[level].forEach(function (value) {\n\t\t\t_this68._createGroup(value, level);\n\t\t});\n\t}\n};\n\nGroup.prototype.addBindings = function () {\n\tvar self = this,\n\t    dblTap,\n\t    tapHold,\n\t    tap,\n\t    toggleElement;\n\n\t//handle group click events\n\tif (self.groupManager.table.options.groupClick) {\n\t\tself.element.addEventListener(\"click\", function (e) {\n\t\t\tself.groupManager.table.options.groupClick.call(self.groupManager.table, e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.groupManager.table.options.groupDblClick) {\n\t\tself.element.addEventListener(\"dblclick\", function (e) {\n\t\t\tself.groupManager.table.options.groupDblClick.call(self.groupManager.table, e, self.getComponent());\n\t\t});\n\t}\n\n\tif (self.groupManager.table.options.groupContext) {\n\t\tself.element.addEventListener(\"contextmenu\", function (e) {\n\t\t\tself.groupManager.table.options.groupContext.call(self.groupManager.table, e, self.getComponent());\n\t\t});\n\t}\n\n\tif ((self.groupManager.table.options.groupContextMenu || self.groupManager.table.options.groupClickMenu) && self.groupManager.table.modExists(\"menu\")) {\n\t\tself.groupManager.table.modules.menu.initializeGroup.call(self.groupManager.table.modules.menu, self);\n\t}\n\n\tif (self.groupManager.table.options.groupTap) {\n\n\t\ttap = false;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\ttap = true;\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tif (tap) {\n\t\t\t\tself.groupManager.table.options.groupTap(e, self.getComponent());\n\t\t\t}\n\n\t\t\ttap = false;\n\t\t});\n\t}\n\n\tif (self.groupManager.table.options.groupDblTap) {\n\n\t\tdblTap = null;\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\n\t\t\tif (dblTap) {\n\t\t\t\tclearTimeout(dblTap);\n\t\t\t\tdblTap = null;\n\n\t\t\t\tself.groupManager.table.options.groupDblTap(e, self.getComponent());\n\t\t\t} else {\n\n\t\t\t\tdblTap = setTimeout(function () {\n\t\t\t\t\tclearTimeout(dblTap);\n\t\t\t\t\tdblTap = null;\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (self.groupManager.table.options.groupTapHold) {\n\n\t\ttapHold = null;\n\n\t\tself.element.addEventListener(\"touchstart\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\n\t\t\ttapHold = setTimeout(function () {\n\t\t\t\tclearTimeout(tapHold);\n\t\t\t\ttapHold = null;\n\t\t\t\ttap = false;\n\t\t\t\tself.groupManager.table.options.groupTapHold(e, self.getComponent());\n\t\t\t}, 1000);\n\t\t}, { passive: true });\n\n\t\tself.element.addEventListener(\"touchend\", function (e) {\n\t\t\tclearTimeout(tapHold);\n\t\t\ttapHold = null;\n\t\t});\n\t}\n\n\tif (self.groupManager.table.options.groupToggleElement) {\n\t\ttoggleElement = self.groupManager.table.options.groupToggleElement == \"arrow\" ? self.arrowElement : self.element;\n\n\t\ttoggleElement.addEventListener(\"click\", function (e) {\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t\tself.toggleVisibility();\n\t\t});\n\t}\n};\n\nGroup.prototype._createGroup = function (groupID, level) {\n\tvar groupKey = level + \"_\" + groupID;\n\tvar group = new Group(this.groupManager, this, level, groupID, this.groupManager.groupIDLookups[level].field, this.groupManager.headerGenerator[level] || this.groupManager.headerGenerator[0], this.old ? this.old.groups[groupKey] : false);\n\n\tthis.groups[groupKey] = group;\n\tthis.groupList.push(group);\n};\n\nGroup.prototype._addRowToGroup = function (row) {\n\n\tvar level = this.level + 1;\n\n\tif (this.hasSubGroups) {\n\t\tvar groupID = this.groupManager.groupIDLookups[level].func(row.getData()),\n\t\t    groupKey = level + \"_\" + groupID;\n\n\t\tif (this.groupManager.allowedValues && this.groupManager.allowedValues[level]) {\n\t\t\tif (this.groups[groupKey]) {\n\t\t\t\tthis.groups[groupKey].addRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.groups[groupKey]) {\n\t\t\t\tthis._createGroup(groupID, level);\n\t\t\t}\n\n\t\t\tthis.groups[groupKey].addRow(row);\n\t\t}\n\t}\n};\n\nGroup.prototype._addRow = function (row) {\n\tthis.rows.push(row);\n\trow.modules.group = this;\n};\n\nGroup.prototype.insertRow = function (row, to, after) {\n\tvar data = this.conformRowData({});\n\n\trow.updateData(data);\n\n\tvar toIndex = this.rows.indexOf(to);\n\n\tif (toIndex > -1) {\n\t\tif (after) {\n\t\t\tthis.rows.splice(toIndex + 1, 0, row);\n\t\t} else {\n\t\t\tthis.rows.splice(toIndex, 0, row);\n\t\t}\n\t} else {\n\t\tif (after) {\n\t\t\tthis.rows.push(row);\n\t\t} else {\n\t\t\tthis.rows.unshift(row);\n\t\t}\n\t}\n\n\trow.modules.group = this;\n\n\tthis.generateGroupHeaderContents();\n\n\tif (this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\") {\n\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t}\n\n\tthis.groupManager.updateGroupRows(true);\n};\n\nGroup.prototype.scrollHeader = function (left) {\n\tthis.arrowElement.style.marginLeft = left;\n\n\tthis.groupList.forEach(function (child) {\n\t\tchild.scrollHeader(left);\n\t});\n};\n\nGroup.prototype.getRowIndex = function (row) {};\n\n//update row data to match grouping contraints\nGroup.prototype.conformRowData = function (data) {\n\tif (this.field) {\n\t\tdata[this.field] = this.key;\n\t} else {\n\t\tconsole.warn(\"Data Conforming Error - Cannot conform row data to match new group as groupBy is a function\");\n\t}\n\n\tif (this.parent) {\n\t\tdata = this.parent.conformRowData(data);\n\t}\n\n\treturn data;\n};\n\nGroup.prototype.removeRow = function (row) {\n\tvar index = this.rows.indexOf(row);\n\tvar el = row.getElement();\n\n\tif (index > -1) {\n\t\tthis.rows.splice(index, 1);\n\t}\n\n\tif (!this.groupManager.table.options.groupValues && !this.rows.length) {\n\t\tif (this.parent) {\n\t\t\tthis.parent.removeGroup(this);\n\t\t} else {\n\t\t\tthis.groupManager.removeGroup(this);\n\t\t}\n\n\t\tthis.groupManager.updateGroupRows(true);\n\t} else {\n\n\t\tif (el.parentNode) {\n\t\t\tel.parentNode.removeChild(el);\n\t\t}\n\n\t\tthis.generateGroupHeaderContents();\n\n\t\tif (this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.options.columnCalcs != \"table\") {\n\t\t\tthis.groupManager.table.modules.columnCalcs.recalcGroup(this);\n\t\t}\n\t}\n};\n\nGroup.prototype.removeGroup = function (group) {\n\tvar groupKey = group.level + \"_\" + group.key,\n\t    index;\n\n\tif (this.groups[groupKey]) {\n\t\tdelete this.groups[groupKey];\n\n\t\tindex = this.groupList.indexOf(group);\n\n\t\tif (index > -1) {\n\t\t\tthis.groupList.splice(index, 1);\n\t\t}\n\n\t\tif (!this.groupList.length) {\n\t\t\tif (this.parent) {\n\t\t\t\tthis.parent.removeGroup(this);\n\t\t\t} else {\n\t\t\t\tthis.groupManager.removeGroup(this);\n\t\t\t}\n\t\t}\n\t}\n};\n\nGroup.prototype.getHeadersAndRows = function (noCalc) {\n\tvar output = [];\n\n\toutput.push(this);\n\n\tthis._visSet();\n\n\tif (this.visible) {\n\t\tif (this.groupList.length) {\n\t\t\tthis.groupList.forEach(function (group) {\n\t\t\t\toutput = output.concat(group.getHeadersAndRows(noCalc));\n\t\t\t});\n\t\t} else {\n\t\t\tif (!noCalc && this.groupManager.table.options.columnCalcs != \"table\" && this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasTopCalcs()) {\n\t\t\t\tif (this.calcs.top) {\n\t\t\t\t\tthis.calcs.top.detachElement();\n\t\t\t\t\tthis.calcs.top.deleteCells();\n\t\t\t\t}\n\n\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\toutput.push(this.calcs.top);\n\t\t\t}\n\n\t\t\toutput = output.concat(this.rows);\n\n\t\t\tif (!noCalc && this.groupManager.table.options.columnCalcs != \"table\" && this.groupManager.table.modExists(\"columnCalcs\") && this.groupManager.table.modules.columnCalcs.hasBottomCalcs()) {\n\t\t\t\tif (this.calcs.bottom) {\n\t\t\t\t\tthis.calcs.bottom.detachElement();\n\t\t\t\t\tthis.calcs.bottom.deleteCells();\n\t\t\t\t}\n\n\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (!this.groupList.length && this.groupManager.table.options.columnCalcs != \"table\") {\n\n\t\t\tif (this.groupManager.table.modExists(\"columnCalcs\")) {\n\n\t\t\t\tif (!noCalc && this.groupManager.table.modules.columnCalcs.hasTopCalcs()) {\n\t\t\t\t\tif (this.calcs.top) {\n\t\t\t\t\t\tthis.calcs.top.detachElement();\n\t\t\t\t\t\tthis.calcs.top.deleteCells();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.groupManager.table.options.groupClosedShowCalcs) {\n\t\t\t\t\t\tthis.calcs.top = this.groupManager.table.modules.columnCalcs.generateTopRow(this.rows);\n\t\t\t\t\t\toutput.push(this.calcs.top);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!noCalc && this.groupManager.table.modules.columnCalcs.hasBottomCalcs()) {\n\t\t\t\t\tif (this.calcs.bottom) {\n\t\t\t\t\t\tthis.calcs.bottom.detachElement();\n\t\t\t\t\t\tthis.calcs.bottom.deleteCells();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.groupManager.table.options.groupClosedShowCalcs) {\n\t\t\t\t\t\tthis.calcs.bottom = this.groupManager.table.modules.columnCalcs.generateBottomRow(this.rows);\n\t\t\t\t\t\toutput.push(this.calcs.bottom);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output;\n};\n\nGroup.prototype.getData = function (visible, transform) {\n\tvar self = this,\n\t    output = [];\n\n\tthis._visSet();\n\n\tif (!visible || visible && this.visible) {\n\t\tthis.rows.forEach(function (row) {\n\t\t\toutput.push(row.getData(transform || \"data\"));\n\t\t});\n\t}\n\n\treturn output;\n};\n\n// Group.prototype.getRows = function(){\n// \tthis._visSet();\n\n// \treturn this.visible ? this.rows : [];\n// };\n\nGroup.prototype.getRowCount = function () {\n\tvar count = 0;\n\n\tif (this.groupList.length) {\n\t\tthis.groupList.forEach(function (group) {\n\t\t\tcount += group.getRowCount();\n\t\t});\n\t} else {\n\t\tcount = this.rows.length;\n\t}\n\treturn count;\n};\n\nGroup.prototype.toggleVisibility = function () {\n\tif (this.visible) {\n\t\tthis.hide();\n\t} else {\n\t\tthis.show();\n\t}\n};\n\nGroup.prototype.hide = function () {\n\tthis.visible = false;\n\n\tif (this.groupManager.table.rowManager.getRenderMode() == \"classic\" && !this.groupManager.table.options.pagination) {\n\n\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\n\t\tif (this.groupList.length) {\n\t\t\tthis.groupList.forEach(function (group) {\n\n\t\t\t\tvar rows = group.getHeadersAndRows();\n\n\t\t\t\trows.forEach(function (row) {\n\t\t\t\t\trow.detachElement();\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tthis.rows.forEach(function (row) {\n\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\trowEl.parentNode.removeChild(rowEl);\n\t\t\t});\n\t\t}\n\n\t\tthis.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(), this.groupManager.getDisplayIndex());\n\n\t\tthis.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth();\n\t} else {\n\t\tthis.groupManager.updateGroupRows(true);\n\t}\n\n\tthis.groupManager.table.options.groupVisibilityChanged.call(this.table, this.getComponent(), false);\n};\n\nGroup.prototype.show = function () {\n\tvar self = this;\n\n\tself.visible = true;\n\n\tif (this.groupManager.table.rowManager.getRenderMode() == \"classic\" && !this.groupManager.table.options.pagination) {\n\n\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\n\t\tvar prev = self.getElement();\n\n\t\tif (this.groupList.length) {\n\t\t\tthis.groupList.forEach(function (group) {\n\t\t\t\tvar rows = group.getHeadersAndRows();\n\n\t\t\t\trows.forEach(function (row) {\n\t\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\t\trow.initialize();\n\t\t\t\t\tprev = rowEl;\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tself.rows.forEach(function (row) {\n\t\t\t\tvar rowEl = row.getElement();\n\t\t\t\tprev.parentNode.insertBefore(rowEl, prev.nextSibling);\n\t\t\t\trow.initialize();\n\t\t\t\tprev = rowEl;\n\t\t\t});\n\t\t}\n\n\t\tthis.groupManager.table.rowManager.setDisplayRows(this.groupManager.updateGroupRows(), this.groupManager.getDisplayIndex());\n\n\t\tthis.groupManager.table.rowManager.checkClassicModeGroupHeaderWidth();\n\t} else {\n\t\tthis.groupManager.updateGroupRows(true);\n\t}\n\n\tthis.groupManager.table.options.groupVisibilityChanged.call(this.table, this.getComponent(), true);\n};\n\nGroup.prototype._visSet = function () {\n\tvar data = [];\n\n\tif (typeof this.visible == \"function\") {\n\n\t\tthis.rows.forEach(function (row) {\n\t\t\tdata.push(row.getData());\n\t\t});\n\n\t\tthis.visible = this.visible(this.key, this.getRowCount(), data, this.getComponent());\n\t}\n};\n\nGroup.prototype.getRowGroup = function (row) {\n\tvar match = false;\n\tif (this.groupList.length) {\n\t\tthis.groupList.forEach(function (group) {\n\t\t\tvar result = group.getRowGroup(row);\n\n\t\t\tif (result) {\n\t\t\t\tmatch = result;\n\t\t\t}\n\t\t});\n\t} else {\n\t\tif (this.rows.find(function (item) {\n\t\t\treturn item === row;\n\t\t})) {\n\t\t\tmatch = this;\n\t\t}\n\t}\n\n\treturn match;\n};\n\nGroup.prototype.getSubGroups = function (component) {\n\tvar output = [];\n\n\tthis.groupList.forEach(function (child) {\n\t\toutput.push(component ? child.getComponent() : child);\n\t});\n\n\treturn output;\n};\n\nGroup.prototype.getRows = function (compoment) {\n\tvar output = [];\n\n\tthis.rows.forEach(function (row) {\n\t\toutput.push(compoment ? row.getComponent() : row);\n\t});\n\n\treturn output;\n};\n\nGroup.prototype.generateGroupHeaderContents = function () {\n\tvar data = [];\n\n\tthis.rows.forEach(function (row) {\n\t\tdata.push(row.getData());\n\t});\n\n\tthis.elementContents = this.generator(this.key, this.getRowCount(), data, this.getComponent());\n\n\twhile (this.element.firstChild) {\n\t\tthis.element.removeChild(this.element.firstChild);\n\t}if (typeof this.elementContents === \"string\") {\n\t\tthis.element.innerHTML = this.elementContents;\n\t} else {\n\t\tthis.element.appendChild(this.elementContents);\n\t}\n\n\tthis.element.insertBefore(this.arrowElement, this.element.firstChild);\n};\n\nGroup.prototype.getPath = function () {\n\tvar path = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n\tpath.unshift(this.key);\n\tif (this.parent) {\n\t\tthis.parent.getPath(path);\n\t}\n\treturn path;\n};\n////////////// Standard Row Functions //////////////\n\nGroup.prototype.getElement = function () {\n\tthis.addBindingsd = false;\n\n\tthis._visSet();\n\n\tif (this.visible) {\n\t\tthis.element.classList.add(\"tabulator-group-visible\");\n\t} else {\n\t\tthis.element.classList.remove(\"tabulator-group-visible\");\n\t}\n\n\tfor (var i = 0; i < this.element.childNodes.length; ++i) {\n\t\tthis.element.childNodes[i].parentNode.removeChild(this.element.childNodes[i]);\n\t}\n\n\tthis.generateGroupHeaderContents();\n\n\t// this.addBindings();\n\n\treturn this.element;\n};\n\nGroup.prototype.detachElement = function () {\n\tif (this.element && this.element.parentNode) {\n\t\tthis.element.parentNode.removeChild(this.element);\n\t}\n};\n\n//normalize the height of elements in the row\nGroup.prototype.normalizeHeight = function () {\n\tthis.setHeight(this.element.clientHeight);\n};\n\nGroup.prototype.initialize = function (force) {\n\tif (!this.initialized || force) {\n\t\tthis.normalizeHeight();\n\t\tthis.initialized = true;\n\t}\n};\n\nGroup.prototype.reinitialize = function () {\n\tthis.initialized = false;\n\tthis.height = 0;\n\n\tif (Tabulator.prototype.helpers.elVisible(this.element)) {\n\t\tthis.initialize(true);\n\t}\n};\n\nGroup.prototype.setHeight = function (height) {\n\tif (this.height != height) {\n\t\tthis.height = height;\n\t\tthis.outerHeight = this.element.offsetHeight;\n\t}\n};\n\n//return rows outer height\nGroup.prototype.getHeight = function () {\n\treturn this.outerHeight;\n};\n\nGroup.prototype.getGroup = function () {\n\treturn this;\n};\n\nGroup.prototype.reinitializeHeight = function () {};\nGroup.prototype.calcHeight = function () {};\nGroup.prototype.setCellHeight = function () {};\nGroup.prototype.clearCellHeight = function () {};\n\n//////////////// Object Generation /////////////////\nGroup.prototype.getComponent = function () {\n\tif (!this.component) {\n\t\tthis.component = new GroupComponent(this);\n\t}\n\n\treturn this.component;\n};\n\n//////////////////////////////////////////////////\n////////////// Group Row Extension ///////////////\n//////////////////////////////////////////////////\n\nvar GroupRows = function GroupRows(table) {\n\n\tthis.table = table; //hold Tabulator object\n\n\tthis.groupIDLookups = false; //enable table grouping and set field to group by\n\tthis.startOpen = [function () {\n\t\treturn false;\n\t}]; //starting state of group\n\tthis.headerGenerator = [function () {\n\t\treturn \"\";\n\t}];\n\tthis.groupList = []; //ordered list of groups\n\tthis.allowedValues = false;\n\tthis.groups = {}; //hold row groups\n\tthis.displayIndex = 0; //index in display pipeline\n};\n\n//initialize group configuration\nGroupRows.prototype.initialize = function () {\n\tvar self = this,\n\t    groupBy = self.table.options.groupBy,\n\t    startOpen = self.table.options.groupStartOpen,\n\t    groupHeader = self.table.options.groupHeader;\n\n\tthis.allowedValues = self.table.options.groupValues;\n\n\tif (Array.isArray(groupBy) && Array.isArray(groupHeader) && groupBy.length > groupHeader.length) {\n\t\tconsole.warn(\"Error creating group headers, groupHeader array is shorter than groupBy array\");\n\t}\n\n\tself.headerGenerator = [function () {\n\t\treturn \"\";\n\t}];\n\tthis.startOpen = [function () {\n\t\treturn false;\n\t}]; //starting state of group\n\n\tself.table.modules.localize.bind(\"groups|item\", function (langValue, lang) {\n\t\tself.headerGenerator[0] = function (value, count, data) {\n\t\t\t//header layout function\n\t\t\treturn (typeof value === \"undefined\" ? \"\" : value) + \"<span>(\" + count + \" \" + (count === 1 ? langValue : lang.groups.items) + \")</span>\";\n\t\t};\n\t});\n\n\tthis.groupIDLookups = [];\n\n\tif (Array.isArray(groupBy) || groupBy) {\n\t\tif (this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"table\" && this.table.options.columnCalcs != \"both\") {\n\t\t\tthis.table.modules.columnCalcs.removeCalcs();\n\t\t}\n\t} else {\n\t\tif (this.table.modExists(\"columnCalcs\") && this.table.options.columnCalcs != \"group\") {\n\n\t\t\tvar cols = this.table.columnManager.getRealColumns();\n\n\t\t\tcols.forEach(function (col) {\n\t\t\t\tif (col.definition.topCalc) {\n\t\t\t\t\tself.table.modules.columnCalcs.initializeTopRow();\n\t\t\t\t}\n\n\t\t\t\tif (col.definition.bottomCalc) {\n\t\t\t\t\tself.table.modules.columnCalcs.initializeBottomRow();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tif (!Array.isArray(groupBy)) {\n\t\tgroupBy = [groupBy];\n\t}\n\n\tgroupBy.forEach(function (group, i) {\n\t\tvar lookupFunc, column;\n\n\t\tif (typeof group == \"function\") {\n\t\t\tlookupFunc = group;\n\t\t} else {\n\t\t\tcolumn = self.table.columnManager.getColumnByField(group);\n\n\t\t\tif (column) {\n\t\t\t\tlookupFunc = function lookupFunc(data) {\n\t\t\t\t\treturn column.getFieldValue(data);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tlookupFunc = function lookupFunc(data) {\n\t\t\t\t\treturn data[group];\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tself.groupIDLookups.push({\n\t\t\tfield: typeof group === \"function\" ? false : group,\n\t\t\tfunc: lookupFunc,\n\t\t\tvalues: self.allowedValues ? self.allowedValues[i] : false\n\t\t});\n\t});\n\n\tif (startOpen) {\n\n\t\tif (!Array.isArray(startOpen)) {\n\t\t\tstartOpen = [startOpen];\n\t\t}\n\n\t\tstartOpen.forEach(function (level) {\n\t\t\tlevel = typeof level == \"function\" ? level : function () {\n\t\t\t\treturn true;\n\t\t\t};\n\t\t});\n\n\t\tself.startOpen = startOpen;\n\t}\n\n\tif (groupHeader) {\n\t\tself.headerGenerator = Array.isArray(groupHeader) ? groupHeader : [groupHeader];\n\t}\n\n\tthis.initialized = true;\n};\n\nGroupRows.prototype.setDisplayIndex = function (index) {\n\tthis.displayIndex = index;\n};\n\nGroupRows.prototype.getDisplayIndex = function () {\n\treturn this.displayIndex;\n};\n\n//return appropriate rows with group headers\nGroupRows.prototype.getRows = function (rows) {\n\tif (this.groupIDLookups.length) {\n\n\t\tthis.table.options.dataGrouping.call(this.table);\n\n\t\tthis.generateGroups(rows);\n\n\t\tif (this.table.options.dataGrouped) {\n\t\t\tthis.table.options.dataGrouped.call(this.table, this.getGroups(true));\n\t\t}\n\n\t\treturn this.updateGroupRows();\n\t} else {\n\t\treturn rows.slice(0);\n\t}\n};\n\nGroupRows.prototype.getGroups = function (compoment) {\n\tvar groupComponents = [];\n\n\tthis.groupList.forEach(function (group) {\n\t\tgroupComponents.push(compoment ? group.getComponent() : group);\n\t});\n\n\treturn groupComponents;\n};\n\nGroupRows.prototype.getChildGroups = function (group) {\n\tvar _this69 = this;\n\n\tvar groupComponents = [];\n\n\tif (!group) {\n\t\tgroup = this;\n\t}\n\n\tgroup.groupList.forEach(function (child) {\n\t\tif (child.groupList.length) {\n\t\t\tgroupComponents = groupComponents.concat(_this69.getChildGroups(child));\n\t\t} else {\n\t\t\tgroupComponents.push(child);\n\t\t}\n\t});\n\n\treturn groupComponents;\n};\n\nGroupRows.prototype.wipe = function () {\n\tthis.groupList.forEach(function (group) {\n\t\tgroup.wipe();\n\t});\n};\n\nGroupRows.prototype.pullGroupListData = function (groupList) {\n\tvar self = this;\n\tvar groupListData = [];\n\n\tgroupList.forEach(function (group) {\n\t\tvar groupHeader = {};\n\t\tgroupHeader.level = 0;\n\t\tgroupHeader.rowCount = 0;\n\t\tgroupHeader.headerContent = \"\";\n\t\tvar childData = [];\n\n\t\tif (group.hasSubGroups) {\n\t\t\tchildData = self.pullGroupListData(group.groupList);\n\n\t\t\tgroupHeader.level = group.level;\n\t\t\tgroupHeader.rowCount = childData.length - group.groupList.length; // data length minus number of sub-headers\n\t\t\tgroupHeader.headerContent = group.generator(group.key, groupHeader.rowCount, group.rows, group);\n\n\t\t\tgroupListData.push(groupHeader);\n\t\t\tgroupListData = groupListData.concat(childData);\n\t\t} else {\n\t\t\tgroupHeader.level = group.level;\n\t\t\tgroupHeader.headerContent = group.generator(group.key, group.rows.length, group.rows, group);\n\t\t\tgroupHeader.rowCount = group.getRows().length;\n\n\t\t\tgroupListData.push(groupHeader);\n\n\t\t\tgroup.getRows().forEach(function (row) {\n\t\t\t\tgroupListData.push(row.getData(\"data\"));\n\t\t\t});\n\t\t}\n\t});\n\n\treturn groupListData;\n};\n\nGroupRows.prototype.getGroupedData = function () {\n\n\treturn this.pullGroupListData(this.groupList);\n};\n\nGroupRows.prototype.getRowGroup = function (row) {\n\tvar match = false;\n\n\tthis.groupList.forEach(function (group) {\n\t\tvar result = group.getRowGroup(row);\n\n\t\tif (result) {\n\t\t\tmatch = result;\n\t\t}\n\t});\n\n\treturn match;\n};\n\nGroupRows.prototype.countGroups = function () {\n\treturn this.groupList.length;\n};\n\nGroupRows.prototype.generateGroups = function (rows) {\n\tvar self = this,\n\t    oldGroups = self.groups;\n\n\tself.groups = {};\n\tself.groupList = [];\n\n\tif (this.allowedValues && this.allowedValues[0]) {\n\t\tthis.allowedValues[0].forEach(function (value) {\n\t\t\tself.createGroup(value, 0, oldGroups);\n\t\t});\n\n\t\trows.forEach(function (row) {\n\t\t\tself.assignRowToExistingGroup(row, oldGroups);\n\t\t});\n\t} else {\n\t\trows.forEach(function (row) {\n\t\t\tself.assignRowToGroup(row, oldGroups);\n\t\t});\n\t}\n};\n\nGroupRows.prototype.createGroup = function (groupID, level, oldGroups) {\n\tvar groupKey = level + \"_\" + groupID,\n\t    group;\n\n\toldGroups = oldGroups || [];\n\n\tgroup = new Group(this, false, level, groupID, this.groupIDLookups[0].field, this.headerGenerator[0], oldGroups[groupKey]);\n\n\tthis.groups[groupKey] = group;\n\tthis.groupList.push(group);\n};\n\n// GroupRows.prototype.assignRowToGroup = function(row, oldGroups){\n// \tvar groupID = this.groupIDLookups[0].func(row.getData()),\n// \tgroupKey = \"0_\" + groupID;\n\n// \tif(!this.groups[groupKey]){\n// \t\tthis.createGroup(groupID, 0, oldGroups);\n// \t}\n\n// \tthis.groups[groupKey].addRow(row);\n// };\n\nGroupRows.prototype.assignRowToExistingGroup = function (row, oldGroups) {\n\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t    groupKey = \"0_\" + groupID;\n\n\tif (this.groups[groupKey]) {\n\t\tthis.groups[groupKey].addRow(row);\n\t}\n};\n\nGroupRows.prototype.assignRowToGroup = function (row, oldGroups) {\n\tvar groupID = this.groupIDLookups[0].func(row.getData()),\n\t    newGroupNeeded = !this.groups[\"0_\" + groupID];\n\n\tif (newGroupNeeded) {\n\t\tthis.createGroup(groupID, 0, oldGroups);\n\t}\n\n\tthis.groups[\"0_\" + groupID].addRow(row);\n\n\treturn !newGroupNeeded;\n};\n\nGroupRows.prototype.reassignRowToGroup = function (row) {\n\tvar oldRowGroup = row.getGroup(),\n\t    oldGroupPath = oldRowGroup.getPath(),\n\t    newGroupPath = this.getExpectedPath(row),\n\t    samePath = true;\n\t// figure out if new group path is the same as old group path\n\tvar samePath = oldGroupPath.length == newGroupPath.length && oldGroupPath.every(function (element, index) {\n\t\treturn element === newGroupPath[index];\n\t});\n\t// refresh if they new path and old path aren't the same (aka the row's groupings have changed)\n\tif (!samePath) {\n\t\toldRowGroup.removeRow(row);\n\t\tthis.assignRowToGroup(row, self.groups);\n\t\tthis.table.rowManager.refreshActiveData(\"group\", false, true);\n\t}\n};\n\nGroupRows.prototype.getExpectedPath = function (row) {\n\tvar groupPath = [],\n\t    rowData = row.getData();\n\tthis.groupIDLookups.forEach(function (groupId) {\n\t\tgroupPath.push(groupId.func(rowData));\n\t});\n\treturn groupPath;\n};\n\nGroupRows.prototype.updateGroupRows = function (force) {\n\tvar self = this,\n\t    output = [],\n\t    oldRowCount;\n\n\tself.groupList.forEach(function (group) {\n\t\toutput = output.concat(group.getHeadersAndRows());\n\t});\n\n\t//force update of table display\n\tif (force) {\n\n\t\tvar displayIndex = self.table.rowManager.setDisplayRows(output, this.getDisplayIndex());\n\n\t\tif (displayIndex !== true) {\n\t\t\tthis.setDisplayIndex(displayIndex);\n\t\t}\n\n\t\tself.table.rowManager.refreshActiveData(\"group\", true, true);\n\t}\n\n\treturn output;\n};\n\nGroupRows.prototype.scrollHeaders = function (left) {\n\tif (this.table.options.virtualDomHoz) {\n\t\tleft -= this.table.vdomHoz.vDomPadLeft;\n\t}\n\n\tleft = left + \"px\";\n\n\tthis.groupList.forEach(function (group) {\n\t\tgroup.scrollHeader(left);\n\t});\n};\n\nGroupRows.prototype.removeGroup = function (group) {\n\tvar groupKey = group.level + \"_\" + group.key,\n\t    index;\n\n\tif (this.groups[groupKey]) {\n\t\tdelete this.groups[groupKey];\n\n\t\tindex = this.groupList.indexOf(group);\n\n\t\tif (index > -1) {\n\t\t\tthis.groupList.splice(index, 1);\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"groupRows\", GroupRows);\nvar History = function History(table) {\n\tthis.table = table; //hold Tabulator object\n\n\tthis.history = [];\n\tthis.index = -1;\n};\n\nHistory.prototype.clear = function () {\n\tthis.history = [];\n\tthis.index = -1;\n};\n\nHistory.prototype.action = function (type, component, data) {\n\n\tthis.history = this.history.slice(0, this.index + 1);\n\n\tthis.history.push({\n\t\ttype: type,\n\t\tcomponent: component,\n\t\tdata: data\n\t});\n\n\tthis.index++;\n};\n\nHistory.prototype.getHistoryUndoSize = function () {\n\treturn this.index + 1;\n};\n\nHistory.prototype.getHistoryRedoSize = function () {\n\treturn this.history.length - (this.index + 1);\n};\n\nHistory.prototype.clearComponentHistory = function (component) {\n\tvar index = this.history.findIndex(function (item) {\n\t\treturn item.component === component;\n\t});\n\n\tif (index > -1) {\n\t\tthis.history.splice(index, 1);\n\t\tif (index <= this.index) {\n\t\t\tthis.index--;\n\t\t}\n\n\t\tthis.clearComponentHistory(component);\n\t}\n};\n\nHistory.prototype.undo = function () {\n\n\tif (this.index > -1) {\n\t\tvar action = this.history[this.index];\n\n\t\tthis.undoers[action.type].call(this, action);\n\n\t\tthis.index--;\n\n\t\tthis.table.options.historyUndo.call(this.table, action.type, action.component.getComponent(), action.data);\n\n\t\treturn true;\n\t} else {\n\t\tconsole.warn(\"History Undo Error - No more history to undo\");\n\t\treturn false;\n\t}\n};\n\nHistory.prototype.redo = function () {\n\tif (this.history.length - 1 > this.index) {\n\n\t\tthis.index++;\n\n\t\tvar action = this.history[this.index];\n\n\t\tthis.redoers[action.type].call(this, action);\n\n\t\tthis.table.options.historyRedo.call(this.table, action.type, action.component.getComponent(), action.data);\n\n\t\treturn true;\n\t} else {\n\t\tconsole.warn(\"History Redo Error - No more history to redo\");\n\t\treturn false;\n\t}\n};\n\nHistory.prototype.undoers = {\n\tcellEdit: function cellEdit(action) {\n\t\taction.component.setValueProcessData(action.data.oldValue);\n\t},\n\n\trowAdd: function rowAdd(action) {\n\t\taction.component.deleteActual();\n\t},\n\n\trowDelete: function rowDelete(action) {\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\t},\n\n\trowMove: function rowMove(action) {\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.rows[action.data.posFrom], !action.data.after);\n\t\tthis.table.rowManager.redraw();\n\t}\n};\n\nHistory.prototype.redoers = {\n\tcellEdit: function cellEdit(action) {\n\t\taction.component.setValueProcessData(action.data.newValue);\n\t},\n\n\trowAdd: function rowAdd(action) {\n\t\tvar newRow = this.table.rowManager.addRowActual(action.data.data, action.data.pos, action.data.index);\n\n\t\tif (this.table.options.groupBy && this.table.modExists(\"groupRows\")) {\n\t\t\tthis.table.modules.groupRows.updateGroupRows(true);\n\t\t}\n\n\t\tthis._rebindRow(action.component, newRow);\n\t},\n\n\trowDelete: function rowDelete(action) {\n\t\taction.component.deleteActual();\n\t},\n\n\trowMove: function rowMove(action) {\n\t\tthis.table.rowManager.moveRowActual(action.component, this.table.rowManager.rows[action.data.posTo], action.data.after);\n\t\tthis.table.rowManager.redraw();\n\t}\n};\n\n//rebind rows to new element after deletion\nHistory.prototype._rebindRow = function (oldRow, newRow) {\n\tthis.history.forEach(function (action) {\n\t\tif (action.component instanceof Row) {\n\t\t\tif (action.component === oldRow) {\n\t\t\t\taction.component = newRow;\n\t\t\t}\n\t\t} else if (action.component instanceof Cell) {\n\t\t\tif (action.component.row === oldRow) {\n\t\t\t\tvar field = action.component.column.getField();\n\n\t\t\t\tif (field) {\n\t\t\t\t\taction.component = newRow.getCell(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n\nTabulator.prototype.registerModule(\"history\", History);\nvar HtmlTableImport = function HtmlTableImport(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.fieldIndex = [];\n\tthis.hasIndex = false;\n};\n\nHtmlTableImport.prototype.parseTable = function () {\n\tvar self = this,\n\t    element = self.table.element,\n\t    options = self.table.options,\n\t    columns = options.columns,\n\t    headers = element.getElementsByTagName(\"th\"),\n\t    rows = element.getElementsByTagName(\"tbody\")[0],\n\t    data = [],\n\t    newTable;\n\n\tself.hasIndex = false;\n\n\tself.table.options.htmlImporting.call(this.table);\n\n\trows = rows ? rows.getElementsByTagName(\"tr\") : [];\n\n\t//check for tablator inline options\n\tself._extractOptions(element, options);\n\n\tif (headers.length) {\n\t\tself._extractHeaders(headers, rows);\n\t} else {\n\t\tself._generateBlankHeaders(headers, rows);\n\t}\n\n\t//iterate through table rows and build data set\n\tfor (var index = 0; index < rows.length; index++) {\n\t\tvar row = rows[index],\n\t\t    cells = row.getElementsByTagName(\"td\"),\n\t\t    item = {};\n\n\t\t//create index if the dont exist in table\n\t\tif (!self.hasIndex) {\n\t\t\titem[options.index] = index;\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tvar cell = cells[i];\n\t\t\tif (typeof this.fieldIndex[i] !== \"undefined\") {\n\t\t\t\titem[this.fieldIndex[i]] = cell.innerHTML;\n\t\t\t}\n\t\t}\n\n\t\t//add row data to item\n\t\tdata.push(item);\n\t}\n\n\t//create new element\n\tvar newElement = document.createElement(\"div\");\n\n\t//transfer attributes to new element\n\tvar attributes = element.attributes;\n\n\t// loop through attributes and apply them on div\n\n\tfor (var i in attributes) {\n\t\tif (_typeof(attributes[i]) == \"object\") {\n\t\t\tnewElement.setAttribute(attributes[i].name, attributes[i].value);\n\t\t}\n\t}\n\n\t// replace table with div element\n\telement.parentNode.replaceChild(newElement, element);\n\n\toptions.data = data;\n\n\tself.table.options.htmlImported.call(this.table);\n\n\t// // newElement.tabulator(options);\n\n\tthis.table.element = newElement;\n};\n\n//extract tabulator attribute options\nHtmlTableImport.prototype._extractOptions = function (element, options, defaultOptions) {\n\tvar attributes = element.attributes;\n\tvar optionsArr = defaultOptions ? Object.assign([], defaultOptions) : Object.keys(options);\n\tvar optionsList = {};\n\n\toptionsArr.forEach(function (item) {\n\t\toptionsList[item.toLowerCase()] = item;\n\t});\n\n\tfor (var index in attributes) {\n\t\tvar attrib = attributes[index];\n\t\tvar name;\n\n\t\tif (attrib && (typeof attrib === 'undefined' ? 'undefined' : _typeof(attrib)) == \"object\" && attrib.name && attrib.name.indexOf(\"tabulator-\") === 0) {\n\t\t\tname = attrib.name.replace(\"tabulator-\", \"\");\n\n\t\t\tif (typeof optionsList[name] !== \"undefined\") {\n\t\t\t\toptions[optionsList[name]] = this._attribValue(attrib.value);\n\t\t\t}\n\t\t}\n\t}\n};\n\n//get value of attribute\nHtmlTableImport.prototype._attribValue = function (value) {\n\tif (value === \"true\") {\n\t\treturn true;\n\t}\n\n\tif (value === \"false\") {\n\t\treturn false;\n\t}\n\n\treturn value;\n};\n\n//find column if it has already been defined\nHtmlTableImport.prototype._findCol = function (title) {\n\tvar match = this.table.options.columns.find(function (column) {\n\t\treturn column.title === title;\n\t});\n\n\treturn match || false;\n};\n\n//extract column from headers\nHtmlTableImport.prototype._extractHeaders = function (headers, rows) {\n\tfor (var index = 0; index < headers.length; index++) {\n\t\tvar header = headers[index],\n\t\t    exists = false,\n\t\t    col = this._findCol(header.textContent),\n\t\t    width,\n\t\t    attributes;\n\n\t\tif (col) {\n\t\t\texists = true;\n\t\t} else {\n\t\t\tcol = { title: header.textContent.trim() };\n\t\t}\n\n\t\tif (!col.field) {\n\t\t\tcol.field = header.textContent.trim().toLowerCase().replace(\" \", \"_\");\n\t\t}\n\n\t\twidth = header.getAttribute(\"width\");\n\n\t\tif (width && !col.width) {\n\t\t\tcol.width = width;\n\t\t}\n\n\t\t//check for tablator inline options\n\t\tattributes = header.attributes;\n\n\t\t// //check for tablator inline options\n\t\tthis._extractOptions(header, col, Column.prototype.defaultOptionList);\n\n\t\tthis.fieldIndex[index] = col.field;\n\n\t\tif (col.field == this.table.options.index) {\n\t\t\tthis.hasIndex = true;\n\t\t}\n\n\t\tif (!exists) {\n\t\t\tthis.table.options.columns.push(col);\n\t\t}\n\t}\n};\n\n//generate blank headers\nHtmlTableImport.prototype._generateBlankHeaders = function (headers, rows) {\n\tfor (var index = 0; index < headers.length; index++) {\n\t\tvar header = headers[index],\n\t\t    col = { title: \"\", field: \"col\" + index };\n\n\t\tthis.fieldIndex[index] = col.field;\n\n\t\tvar width = header.getAttribute(\"width\");\n\n\t\tif (width) {\n\t\t\tcol.width = width;\n\t\t}\n\n\t\tthis.table.options.columns.push(col);\n\t}\n};\n\nTabulator.prototype.registerModule(\"htmlTableImport\", HtmlTableImport);\nvar Keybindings = function Keybindings(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.watchKeys = null;\n\tthis.pressedKeys = null;\n\tthis.keyupBinding = false;\n\tthis.keydownBinding = false;\n};\n\nKeybindings.prototype.initialize = function () {\n\tvar bindings = this.table.options.keybindings,\n\t    mergedBindings = {};\n\n\tthis.watchKeys = {};\n\tthis.pressedKeys = [];\n\n\tif (bindings !== false) {\n\n\t\tfor (var key in this.bindings) {\n\t\t\tmergedBindings[key] = this.bindings[key];\n\t\t}\n\n\t\tif (Object.keys(bindings).length) {\n\n\t\t\tfor (var _key in bindings) {\n\t\t\t\tmergedBindings[_key] = bindings[_key];\n\t\t\t}\n\t\t}\n\n\t\tthis.mapBindings(mergedBindings);\n\t\tthis.bindEvents();\n\t}\n};\n\nKeybindings.prototype.mapBindings = function (bindings) {\n\tvar _this70 = this;\n\n\tvar self = this;\n\n\tvar _loop2 = function _loop2(key) {\n\n\t\tif (_this70.actions[key]) {\n\n\t\t\tif (bindings[key]) {\n\n\t\t\t\tif (_typeof(bindings[key]) !== \"object\") {\n\t\t\t\t\tbindings[key] = [bindings[key]];\n\t\t\t\t}\n\n\t\t\t\tbindings[key].forEach(function (binding) {\n\t\t\t\t\tself.mapBinding(key, binding);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Key Binding Error - no such action:\", key);\n\t\t}\n\t};\n\n\tfor (var key in bindings) {\n\t\t_loop2(key);\n\t}\n};\n\nKeybindings.prototype.mapBinding = function (action, symbolsList) {\n\tvar self = this;\n\n\tvar binding = {\n\t\taction: this.actions[action],\n\t\tkeys: [],\n\t\tctrl: false,\n\t\tshift: false,\n\t\tmeta: false\n\t};\n\n\tvar symbols = symbolsList.toString().toLowerCase().split(\" \").join(\"\").split(\"+\");\n\n\tsymbols.forEach(function (symbol) {\n\t\tswitch (symbol) {\n\t\t\tcase \"ctrl\":\n\t\t\t\tbinding.ctrl = true;\n\t\t\t\tbreak;\n\n\t\t\tcase \"shift\":\n\t\t\t\tbinding.shift = true;\n\t\t\t\tbreak;\n\n\t\t\tcase \"meta\":\n\t\t\t\tbinding.meta = true;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tsymbol = parseInt(symbol);\n\t\t\t\tbinding.keys.push(symbol);\n\n\t\t\t\tif (!self.watchKeys[symbol]) {\n\t\t\t\t\tself.watchKeys[symbol] = [];\n\t\t\t\t}\n\n\t\t\t\tself.watchKeys[symbol].push(binding);\n\t\t}\n\t});\n};\n\nKeybindings.prototype.bindEvents = function () {\n\tvar self = this;\n\n\tthis.keyupBinding = function (e) {\n\t\tvar code = e.keyCode;\n\t\tvar bindings = self.watchKeys[code];\n\n\t\tif (bindings) {\n\n\t\t\tself.pressedKeys.push(code);\n\n\t\t\tbindings.forEach(function (binding) {\n\t\t\t\tself.checkBinding(e, binding);\n\t\t\t});\n\t\t}\n\t};\n\n\tthis.keydownBinding = function (e) {\n\t\tvar code = e.keyCode;\n\t\tvar bindings = self.watchKeys[code];\n\n\t\tif (bindings) {\n\n\t\t\tvar index = self.pressedKeys.indexOf(code);\n\n\t\t\tif (index > -1) {\n\t\t\t\tself.pressedKeys.splice(index, 1);\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.table.element.addEventListener(\"keydown\", this.keyupBinding);\n\n\tthis.table.element.addEventListener(\"keyup\", this.keydownBinding);\n};\n\nKeybindings.prototype.clearBindings = function () {\n\tif (this.keyupBinding) {\n\t\tthis.table.element.removeEventListener(\"keydown\", this.keyupBinding);\n\t}\n\n\tif (this.keydownBinding) {\n\t\tthis.table.element.removeEventListener(\"keyup\", this.keydownBinding);\n\t}\n};\n\nKeybindings.prototype.checkBinding = function (e, binding) {\n\tvar self = this,\n\t    match = true;\n\n\tif (e.ctrlKey == binding.ctrl && e.shiftKey == binding.shift && e.metaKey == binding.meta) {\n\t\tbinding.keys.forEach(function (key) {\n\t\t\tvar index = self.pressedKeys.indexOf(key);\n\n\t\t\tif (index == -1) {\n\t\t\t\tmatch = false;\n\t\t\t}\n\t\t});\n\n\t\tif (match) {\n\t\t\tbinding.action.call(self, e);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\n//default bindings\nKeybindings.prototype.bindings = {\n\tnavPrev: \"shift + 9\",\n\tnavNext: 9,\n\tnavUp: 38,\n\tnavDown: 40,\n\tscrollPageUp: 33,\n\tscrollPageDown: 34,\n\tscrollToStart: 36,\n\tscrollToEnd: 35,\n\tundo: \"ctrl + 90\",\n\tredo: \"ctrl + 89\",\n\tcopyToClipboard: \"ctrl + 67\"\n};\n\n//default actions\nKeybindings.prototype.actions = {\n\tkeyBlock: function keyBlock(e) {\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tscrollPageUp: function scrollPageUp(e) {\n\t\tvar rowManager = this.table.rowManager,\n\t\t    newPos = rowManager.scrollTop - rowManager.height,\n\t\t    scrollMax = rowManager.element.scrollHeight;\n\n\t\te.preventDefault();\n\n\t\tif (rowManager.displayRowsCount) {\n\t\t\tif (newPos >= 0) {\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t} else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\tscrollPageDown: function scrollPageDown(e) {\n\t\tvar rowManager = this.table.rowManager,\n\t\t    newPos = rowManager.scrollTop + rowManager.height,\n\t\t    scrollMax = rowManager.element.scrollHeight;\n\n\t\te.preventDefault();\n\n\t\tif (rowManager.displayRowsCount) {\n\t\t\tif (newPos <= scrollMax) {\n\t\t\t\trowManager.element.scrollTop = newPos;\n\t\t\t} else {\n\t\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\tscrollToStart: function scrollToStart(e) {\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif (rowManager.displayRowsCount) {\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[0]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\tscrollToEnd: function scrollToEnd(e) {\n\t\tvar rowManager = this.table.rowManager;\n\n\t\te.preventDefault();\n\n\t\tif (rowManager.displayRowsCount) {\n\t\t\trowManager.scrollToRow(rowManager.getDisplayRows()[rowManager.displayRowsCount - 1]);\n\t\t}\n\n\t\tthis.table.element.focus();\n\t},\n\tnavPrev: function navPrev(e) {\n\t\tvar cell = false;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcell.nav().prev();\n\t\t\t}\n\t\t}\n\t},\n\n\tnavNext: function navNext(e) {\n\t\tvar cell = false;\n\t\tvar newRow = this.table.options.tabEndNewRow;\n\t\tvar nav;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tnav = cell.nav();\n\n\t\t\t\tif (!nav.next()) {\n\t\t\t\t\tif (newRow) {\n\n\t\t\t\t\t\tcell.getElement().firstChild.blur();\n\n\t\t\t\t\t\tif (newRow === true) {\n\t\t\t\t\t\t\tnewRow = this.table.addRow({});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (typeof newRow == \"function\") {\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(newRow(cell.row.getComponent()));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewRow = this.table.addRow(Object.assign({}, newRow));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tnewRow.then(function () {\n\t\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\t\tnav.next();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tnavLeft: function navLeft(e) {\n\t\tvar cell = false;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcell.nav().left();\n\t\t\t}\n\t\t}\n\t},\n\n\tnavRight: function navRight(e) {\n\t\tvar cell = false;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcell.nav().right();\n\t\t\t}\n\t\t}\n\t},\n\n\tnavUp: function navUp(e) {\n\t\tvar cell = false;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcell.nav().up();\n\t\t\t}\n\t\t}\n\t},\n\n\tnavDown: function navDown(e) {\n\t\tvar cell = false;\n\n\t\tif (this.table.modExists(\"edit\")) {\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tcell.nav().down();\n\t\t\t}\n\t\t}\n\t},\n\n\tundo: function undo(e) {\n\t\tvar cell = false;\n\t\tif (this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")) {\n\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (!cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.table.modules.history.undo();\n\t\t\t}\n\t\t}\n\t},\n\n\tredo: function redo(e) {\n\t\tvar cell = false;\n\t\tif (this.table.options.history && this.table.modExists(\"history\") && this.table.modExists(\"edit\")) {\n\n\t\t\tcell = this.table.modules.edit.currentCell;\n\n\t\t\tif (!cell) {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.table.modules.history.redo();\n\t\t\t}\n\t\t}\n\t},\n\n\tcopyToClipboard: function copyToClipboard(e) {\n\t\tif (!this.table.modules.edit.currentCell) {\n\t\t\tif (this.table.modExists(\"clipboard\", true)) {\n\t\t\t\tthis.table.modules.clipboard.copy(false, true);\n\t\t\t}\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"keybindings\", Keybindings);\nvar Menu = function Menu(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.menuElements = [];\n\tthis.blurEvent = this.hideMenu.bind(this);\n\tthis.escEvent = this.escMenu.bind(this);\n\tthis.nestedMenuBlock = false;\n\tthis.positionReversedX = false;\n};\n\nMenu.prototype.initializeColumnHeader = function (column) {\n\tvar _this71 = this;\n\n\tvar headerMenuEl;\n\n\tif (column.definition.headerContextMenu) {\n\t\tcolumn.getElement().addEventListener(\"contextmenu\", this.LoadMenuEvent.bind(this, column, column.definition.headerContextMenu));\n\t\tthis.tapHold(column, column.definition.headerContextMenu);\n\t}\n\n\t// if(column.definition.headerClickMenu){\n\t// \tcolumn.getElement().addEventListener(\"click\", this.LoadMenuEvent.bind(this, column, column.definition.headerClickMenu));\n\t// }\n\n\tif (column.definition.headerMenu) {\n\n\t\theaderMenuEl = document.createElement(\"span\");\n\t\theaderMenuEl.classList.add(\"tabulator-header-menu-button\");\n\t\theaderMenuEl.innerHTML = \"&vellip;\";\n\n\t\theaderMenuEl.addEventListener(\"click\", function (e) {\n\t\t\te.stopPropagation();\n\t\t\te.preventDefault();\n\n\t\t\t_this71.LoadMenuEvent(column, column.definition.headerMenu, e);\n\t\t});\n\n\t\tcolumn.titleElement.insertBefore(headerMenuEl, column.titleElement.firstChild);\n\t}\n};\n\nMenu.prototype.LoadMenuEvent = function (component, menu, e) {\n\tmenu = typeof menu == \"function\" ? menu.call(this.table, component.getComponent(), e) : menu;\n\n\t// if(component instanceof Cell){\n\t// \te.stopImmediatePropagation();\n\t// }\n\n\tthis.loadMenu(e, component, menu);\n};\n\nMenu.prototype.tapHold = function (component, menu) {\n\tvar _this72 = this;\n\n\tvar element = component.getElement(),\n\t    tapHold = null,\n\t    loaded = false;\n\n\telement.addEventListener(\"touchstart\", function (e) {\n\t\tclearTimeout(tapHold);\n\t\tloaded = false;\n\n\t\ttapHold = setTimeout(function () {\n\t\t\tclearTimeout(tapHold);\n\t\t\ttapHold = null;\n\t\t\tloaded = true;\n\n\t\t\t_this72.LoadMenuEvent(component, menu, e);\n\t\t}, 1000);\n\t}, { passive: true });\n\n\telement.addEventListener(\"touchend\", function (e) {\n\t\tclearTimeout(tapHold);\n\t\ttapHold = null;\n\n\t\tif (loaded) {\n\t\t\te.preventDefault();\n\t\t}\n\t});\n};\n\nMenu.prototype.initializeCell = function (cell) {\n\tif (cell.column.definition.contextMenu) {\n\t\tcell.getElement(true).addEventListener(\"contextmenu\", this.LoadMenuEvent.bind(this, cell, cell.column.definition.contextMenu));\n\t\tthis.tapHold(cell, cell.column.definition.contextMenu);\n\t}\n\n\tif (cell.column.definition.clickMenu) {\n\t\tcell.getElement(true).addEventListener(\"click\", this.LoadMenuEvent.bind(this, cell, cell.column.definition.clickMenu));\n\t}\n};\n\nMenu.prototype.initializeRow = function (row) {\n\tif (this.table.options.rowContextMenu) {\n\t\trow.getElement().addEventListener(\"contextmenu\", this.LoadMenuEvent.bind(this, row, this.table.options.rowContextMenu));\n\t\tthis.tapHold(row, this.table.options.rowContextMenu);\n\t}\n\n\tif (this.table.options.rowClickMenu) {\n\t\trow.getElement().addEventListener(\"click\", this.LoadMenuEvent.bind(this, row, this.table.options.rowClickMenu));\n\t}\n};\n\nMenu.prototype.initializeGroup = function (group) {\n\tif (this.table.options.groupContextMenu) {\n\t\tgroup.getElement().addEventListener(\"contextmenu\", this.LoadMenuEvent.bind(this, group, this.table.options.groupContextMenu));\n\t\tthis.tapHold(group, this.table.options.groupContextMenu);\n\t}\n\n\tif (this.table.options.groupClickMenu) {\n\t\tgroup.getElement().addEventListener(\"click\", this.LoadMenuEvent.bind(this, group, this.table.options.groupClickMenu));\n\t}\n};\n\nMenu.prototype.loadMenu = function (e, component, menu, parentEl) {\n\tvar _this73 = this;\n\n\tvar touch = !(e instanceof MouseEvent);\n\n\tvar menuEl = document.createElement(\"div\");\n\tmenuEl.classList.add(\"tabulator-menu\");\n\n\tif (!touch) {\n\t\te.preventDefault();\n\t}\n\n\t//abort if no menu set\n\tif (!menu || !menu.length) {\n\t\treturn;\n\t}\n\n\tif (!parentEl) {\n\t\tif (this.nestedMenuBlock) {\n\t\t\t//abort if child menu already open\n\t\t\tif (this.isOpen()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.nestedMenuBlock = setTimeout(function () {\n\t\t\t\t_this73.nestedMenuBlock = false;\n\t\t\t}, 100);\n\t\t}\n\n\t\tthis.hideMenu();\n\t\tthis.menuElements = [];\n\t}\n\n\tmenu.forEach(function (item) {\n\t\tvar itemEl = document.createElement(\"div\"),\n\t\t    label = item.label,\n\t\t    disabled = item.disabled;\n\n\t\tif (item.separator) {\n\t\t\titemEl.classList.add(\"tabulator-menu-separator\");\n\t\t} else {\n\t\t\titemEl.classList.add(\"tabulator-menu-item\");\n\n\t\t\tif (typeof label == \"function\") {\n\t\t\t\tlabel = label.call(_this73.table, component.getComponent());\n\t\t\t}\n\n\t\t\tif (label instanceof Node) {\n\t\t\t\titemEl.appendChild(label);\n\t\t\t} else {\n\t\t\t\titemEl.innerHTML = label;\n\t\t\t}\n\n\t\t\tif (typeof disabled == \"function\") {\n\t\t\t\tdisabled = disabled.call(_this73.table, component.getComponent());\n\t\t\t}\n\n\t\t\tif (disabled) {\n\t\t\t\titemEl.classList.add(\"tabulator-menu-item-disabled\");\n\t\t\t\titemEl.addEventListener(\"click\", function (e) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (item.menu && item.menu.length) {\n\t\t\t\t\titemEl.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t_this73.hideOldSubMenus(menuEl);\n\t\t\t\t\t\t_this73.loadMenu(e, component, item.menu, itemEl);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (item.action) {\n\t\t\t\t\t\titemEl.addEventListener(\"click\", function (e) {\n\t\t\t\t\t\t\titem.action(e, component.getComponent());\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (item.menu && item.menu.length) {\n\t\t\t\titemEl.classList.add(\"tabulator-menu-item-submenu\");\n\t\t\t}\n\t\t}\n\n\t\tmenuEl.appendChild(itemEl);\n\t});\n\n\tmenuEl.addEventListener(\"click\", function (e) {\n\t\t_this73.hideMenu();\n\t});\n\n\tthis.menuElements.push(menuEl);\n\tthis.positionMenu(menuEl, parentEl, touch, e);\n};\n\nMenu.prototype.hideOldSubMenus = function (menuEl) {\n\tvar index = this.menuElements.indexOf(menuEl);\n\n\tif (index > -1) {\n\t\tfor (var _i13 = this.menuElements.length - 1; _i13 > index; _i13--) {\n\t\t\tvar el = this.menuElements[_i13];\n\n\t\t\tif (el.parentNode) {\n\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t}\n\n\t\t\tthis.menuElements.pop();\n\t\t}\n\t}\n};\n\nMenu.prototype.positionMenu = function (element, parentEl, touch, e) {\n\tvar _this74 = this;\n\n\tvar docHeight = Math.max(document.body.offsetHeight, window.innerHeight),\n\t    x,\n\t    y,\n\t    parentOffset;\n\n\tif (!parentEl) {\n\t\tx = touch ? e.touches[0].pageX : e.pageX;\n\t\ty = touch ? e.touches[0].pageY : e.pageY;\n\n\t\tthis.positionReversedX = false;\n\t} else {\n\t\tparentOffset = Tabulator.prototype.helpers.elOffset(parentEl);\n\t\tx = parentOffset.left + parentEl.offsetWidth;\n\t\ty = parentOffset.top - 1;\n\t}\n\n\telement.style.top = y + \"px\";\n\telement.style.left = x + \"px\";\n\n\tsetTimeout(function () {\n\t\t_this74.table.rowManager.element.addEventListener(\"scroll\", _this74.blurEvent);\n\t\tdocument.body.addEventListener(\"click\", _this74.blurEvent);\n\t\tdocument.body.addEventListener(\"contextmenu\", _this74.blurEvent);\n\t\twindow.addEventListener(\"resize\", _this74.blurEvent);\n\t\tdocument.body.addEventListener(\"keydown\", _this74.escEvent);\n\t}, 100);\n\n\tdocument.body.appendChild(element);\n\n\t//move menu to start on bottom edge if it is too close to the edge of the screen\n\tif (y + element.offsetHeight >= docHeight) {\n\t\telement.style.top = \"\";\n\n\t\tif (parentEl) {\n\t\t\telement.style.bottom = docHeight - parentOffset.top - parentEl.offsetHeight - 1 + \"px\";\n\t\t} else {\n\t\t\telement.style.bottom = docHeight - y + \"px\";\n\t\t}\n\t}\n\n\t//move menu to start on right edge if it is too close to the edge of the screen\n\tif (x + element.offsetWidth >= document.body.offsetWidth || this.positionReversedX) {\n\t\telement.style.left = \"\";\n\n\t\tif (parentEl) {\n\t\t\telement.style.right = document.documentElement.offsetWidth - parentOffset.left + \"px\";\n\t\t} else {\n\t\t\telement.style.right = document.documentElement.offsetWidth - x + \"px\";\n\t\t}\n\n\t\tthis.positionReversedX = true;\n\t}\n};\n\nMenu.prototype.isOpen = function () {\n\treturn !!this.menuElements.length;\n};\n\nMenu.prototype.escMenu = function (e) {\n\tif (e.keyCode == 27) {\n\t\tthis.hideMenu();\n\t}\n};\n\nMenu.prototype.hideMenu = function () {\n\tthis.menuElements.forEach(function (menuEl) {\n\t\tif (menuEl.parentNode) {\n\t\t\tmenuEl.parentNode.removeChild(menuEl);\n\t\t}\n\t});\n\n\tdocument.body.removeEventListener(\"keydown\", this.escEvent);\n\tdocument.body.removeEventListener(\"click\", this.blurEvent);\n\tdocument.body.removeEventListener(\"contextmenu\", this.blurEvent);\n\twindow.removeEventListener(\"resize\", this.blurEvent);\n\tthis.table.rowManager.element.removeEventListener(\"scroll\", this.blurEvent);\n};\n\n//default accessors\nMenu.prototype.menus = {};\n\nTabulator.prototype.registerModule(\"menu\", Menu);\nvar MoveColumns = function MoveColumns(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.placeholderElement = this.createPlaceholderElement();\n\tthis.hoverElement = false; //floating column header element\n\tthis.checkTimeout = false; //click check timeout holder\n\tthis.checkPeriod = 250; //period to wait on mousedown to consider this a move and not a click\n\tthis.moving = false; //currently moving column\n\tthis.toCol = false; //destination column\n\tthis.toColAfter = false; //position of moving column relative to the desitnation column\n\tthis.startX = 0; //starting position within header element\n\tthis.autoScrollMargin = 40; //auto scroll on edge when within margin\n\tthis.autoScrollStep = 5; //auto scroll distance in pixels\n\tthis.autoScrollTimeout = false; //auto scroll timeout\n\tthis.touchMove = false;\n\n\tthis.moveHover = this.moveHover.bind(this);\n\tthis.endMove = this.endMove.bind(this);\n};\n\nMoveColumns.prototype.createPlaceholderElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-col\");\n\tel.classList.add(\"tabulator-col-placeholder\");\n\n\treturn el;\n};\n\nMoveColumns.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    config = {},\n\t    colEl;\n\n\tif (!column.modules.frozen) {\n\n\t\tcolEl = column.getElement();\n\n\t\tconfig.mousemove = function (e) {\n\t\t\tif (column.parent === self.moving.parent) {\n\t\t\t\tif ((self.touchMove ? e.touches[0].pageX : e.pageX) - Tabulator.prototype.helpers.elOffset(colEl).left + self.table.columnManager.element.scrollLeft > column.getWidth() / 2) {\n\t\t\t\t\tif (self.toCol !== column || !self.toColAfter) {\n\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl.nextSibling);\n\t\t\t\t\t\tself.moveColumn(column, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (self.toCol !== column || self.toColAfter) {\n\t\t\t\t\t\tcolEl.parentNode.insertBefore(self.placeholderElement, colEl);\n\t\t\t\t\t\tself.moveColumn(column, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(self);\n\n\t\tcolEl.addEventListener(\"mousedown\", function (e) {\n\t\t\tself.touchMove = false;\n\t\t\tif (e.which === 1) {\n\t\t\t\tself.checkTimeout = setTimeout(function () {\n\t\t\t\t\tself.startMove(e, column);\n\t\t\t\t}, self.checkPeriod);\n\t\t\t}\n\t\t});\n\n\t\tcolEl.addEventListener(\"mouseup\", function (e) {\n\t\t\tif (e.which === 1) {\n\t\t\t\tif (self.checkTimeout) {\n\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tself.bindTouchEvents(column);\n\t}\n\n\tcolumn.modules.moveColumn = config;\n};\n\nMoveColumns.prototype.bindTouchEvents = function (column) {\n\tvar self = this,\n\t    colEl = column.getElement(),\n\t    startXMove = false,\n\t    //shifting center position of the cell\n\tdir = false,\n\t    currentCol,\n\t    nextCol,\n\t    prevCol,\n\t    nextColWidth,\n\t    prevColWidth,\n\t    nextColWidthLast,\n\t    prevColWidthLast;\n\n\tcolEl.addEventListener(\"touchstart\", function (e) {\n\t\tself.checkTimeout = setTimeout(function () {\n\t\t\tself.touchMove = true;\n\t\t\tcurrentCol = column;\n\t\t\tnextCol = column.nextColumn();\n\t\t\tnextColWidth = nextCol ? nextCol.getWidth() / 2 : 0;\n\t\t\tprevCol = column.prevColumn();\n\t\t\tprevColWidth = prevCol ? prevCol.getWidth() / 2 : 0;\n\t\t\tnextColWidthLast = 0;\n\t\t\tprevColWidthLast = 0;\n\t\t\tstartXMove = false;\n\n\t\t\tself.startMove(e, column);\n\t\t}, self.checkPeriod);\n\t}, { passive: true });\n\n\tcolEl.addEventListener(\"touchmove\", function (e) {\n\t\tvar halfCol, diff, moveToCol;\n\n\t\tif (self.moving) {\n\t\t\tself.moveHover(e);\n\n\t\t\tif (!startXMove) {\n\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t}\n\n\t\t\tdiff = e.touches[0].pageX - startXMove;\n\n\t\t\tif (diff > 0) {\n\t\t\t\tif (nextCol && diff - nextColWidthLast > nextColWidth) {\n\t\t\t\t\tmoveToCol = nextCol;\n\n\t\t\t\t\tif (moveToCol !== column) {\n\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(self.placeholderElement, moveToCol.getElement().nextSibling);\n\t\t\t\t\t\tself.moveColumn(moveToCol, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (prevCol && -diff - prevColWidthLast > prevColWidth) {\n\t\t\t\t\tmoveToCol = prevCol;\n\n\t\t\t\t\tif (moveToCol !== column) {\n\t\t\t\t\t\tstartXMove = e.touches[0].pageX;\n\t\t\t\t\t\tmoveToCol.getElement().parentNode.insertBefore(self.placeholderElement, moveToCol.getElement());\n\t\t\t\t\t\tself.moveColumn(moveToCol, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (moveToCol) {\n\t\t\t\tcurrentCol = moveToCol;\n\t\t\t\tnextCol = moveToCol.nextColumn();\n\t\t\t\tnextColWidthLast = nextColWidth;\n\t\t\t\tnextColWidth = nextCol ? nextCol.getWidth() / 2 : 0;\n\t\t\t\tprevCol = moveToCol.prevColumn();\n\t\t\t\tprevColWidthLast = prevColWidth;\n\t\t\t\tprevColWidth = prevCol ? prevCol.getWidth() / 2 : 0;\n\t\t\t}\n\t\t}\n\t}, { passive: true });\n\n\tcolEl.addEventListener(\"touchend\", function (e) {\n\t\tif (self.checkTimeout) {\n\t\t\tclearTimeout(self.checkTimeout);\n\t\t}\n\t\tif (self.moving) {\n\t\t\tself.endMove(e);\n\t\t}\n\t});\n};\n\nMoveColumns.prototype.startMove = function (e, column) {\n\tvar element = column.getElement();\n\n\tthis.moving = column;\n\tthis.startX = (this.touchMove ? e.touches[0].pageX : e.pageX) - Tabulator.prototype.helpers.elOffset(element).left;\n\n\tthis.table.element.classList.add(\"tabulator-block-select\");\n\n\t//create placeholder\n\tthis.placeholderElement.style.width = column.getWidth() + \"px\";\n\tthis.placeholderElement.style.height = column.getHeight() + \"px\";\n\n\telement.parentNode.insertBefore(this.placeholderElement, element);\n\telement.parentNode.removeChild(element);\n\n\t//create hover element\n\tthis.hoverElement = element.cloneNode(true);\n\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\n\tthis.table.columnManager.getElement().appendChild(this.hoverElement);\n\n\tthis.hoverElement.style.left = \"0\";\n\tthis.hoverElement.style.bottom = \"0\";\n\n\tif (!this.touchMove) {\n\t\tthis._bindMouseMove();\n\n\t\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\t\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\t}\n\n\tthis.moveHover(e);\n};\n\nMoveColumns.prototype._bindMouseMove = function () {\n\tthis.table.columnManager.columnsByIndex.forEach(function (column) {\n\t\tif (column.modules.moveColumn.mousemove) {\n\t\t\tcolumn.getElement().addEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t}\n\t});\n};\n\nMoveColumns.prototype._unbindMouseMove = function () {\n\tthis.table.columnManager.columnsByIndex.forEach(function (column) {\n\t\tif (column.modules.moveColumn.mousemove) {\n\t\t\tcolumn.getElement().removeEventListener(\"mousemove\", column.modules.moveColumn.mousemove);\n\t\t}\n\t});\n};\n\nMoveColumns.prototype.moveColumn = function (column, after) {\n\tvar movingCells = this.moving.getCells();\n\n\tthis.toCol = column;\n\tthis.toColAfter = after;\n\n\tif (after) {\n\t\tcolumn.getCells().forEach(function (cell, i) {\n\t\t\tvar cellEl = cell.getElement(true);\n\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl.nextSibling);\n\t\t});\n\t} else {\n\t\tcolumn.getCells().forEach(function (cell, i) {\n\t\t\tvar cellEl = cell.getElement(true);\n\t\t\tcellEl.parentNode.insertBefore(movingCells[i].getElement(), cellEl);\n\t\t});\n\t}\n};\n\nMoveColumns.prototype.endMove = function (e) {\n\tif (e.which === 1 || this.touchMove) {\n\t\tthis._unbindMouseMove();\n\n\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\n\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\tif (this.toCol) {\n\t\t\tthis.table.columnManager.moveColumnActual(this.moving, this.toCol, this.toColAfter);\n\t\t}\n\n\t\tthis.moving = false;\n\t\tthis.toCol = false;\n\t\tthis.toColAfter = false;\n\n\t\tif (!this.touchMove) {\n\t\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\t\t}\n\t}\n};\n\nMoveColumns.prototype.moveHover = function (e) {\n\tvar self = this,\n\t    columnHolder = self.table.columnManager.getElement(),\n\t    scrollLeft = columnHolder.scrollLeft,\n\t    xPos = (self.touchMove ? e.touches[0].pageX : e.pageX) - Tabulator.prototype.helpers.elOffset(columnHolder).left + scrollLeft,\n\t    scrollPos;\n\n\tself.hoverElement.style.left = xPos - self.startX + \"px\";\n\n\tif (xPos - scrollLeft < self.autoScrollMargin) {\n\t\tif (!self.autoScrollTimeout) {\n\t\t\tself.autoScrollTimeout = setTimeout(function () {\n\t\t\t\tscrollPos = Math.max(0, scrollLeft - 5);\n\t\t\t\tself.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\tself.autoScrollTimeout = false;\n\t\t\t}, 1);\n\t\t}\n\t}\n\n\tif (scrollLeft + columnHolder.clientWidth - xPos < self.autoScrollMargin) {\n\t\tif (!self.autoScrollTimeout) {\n\t\t\tself.autoScrollTimeout = setTimeout(function () {\n\t\t\t\tscrollPos = Math.min(columnHolder.clientWidth, scrollLeft + 5);\n\t\t\t\tself.table.rowManager.getElement().scrollLeft = scrollPos;\n\t\t\t\tself.autoScrollTimeout = false;\n\t\t\t}, 1);\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"moveColumn\", MoveColumns);\n\nvar MoveRows = function MoveRows(table) {\n\n\tthis.table = table; //hold Tabulator object\n\tthis.placeholderElement = this.createPlaceholderElement();\n\tthis.hoverElement = false; //floating row header element\n\tthis.checkTimeout = false; //click check timeout holder\n\tthis.checkPeriod = 150; //period to wait on mousedown to consider this a move and not a click\n\tthis.moving = false; //currently moving row\n\tthis.toRow = false; //destination row\n\tthis.toRowAfter = false; //position of moving row relative to the desitnation row\n\tthis.hasHandle = false; //row has handle instead of fully movable row\n\tthis.startY = 0; //starting Y position within header element\n\tthis.startX = 0; //starting X position within header element\n\n\tthis.moveHover = this.moveHover.bind(this);\n\tthis.endMove = this.endMove.bind(this);\n\tthis.tableRowDropEvent = false;\n\n\tthis.touchMove = false;\n\n\tthis.connection = false;\n\tthis.connectionSelectorsTables = false;\n\tthis.connectionSelectorsElements = false;\n\tthis.connectionElements = [];\n\tthis.connections = [];\n\n\tthis.connectedTable = false;\n\tthis.connectedRow = false;\n};\n\nMoveRows.prototype.createPlaceholderElement = function () {\n\tvar el = document.createElement(\"div\");\n\n\tel.classList.add(\"tabulator-row\");\n\tel.classList.add(\"tabulator-row-placeholder\");\n\n\treturn el;\n};\n\nMoveRows.prototype.initialize = function (handle) {\n\tthis.connectionSelectorsTables = this.table.options.movableRowsConnectedTables;\n\tthis.connectionSelectorsElements = this.table.options.movableRowsConnectedElements;\n\n\tthis.connection = this.connectionSelectorsTables || this.connectionSelectorsElements;\n};\n\nMoveRows.prototype.setHandle = function (handle) {\n\tthis.hasHandle = handle;\n};\n\nMoveRows.prototype.initializeGroupHeader = function (group) {\n\tvar self = this,\n\t    config = {},\n\t    rowEl;\n\n\t//inter table drag drop\n\tconfig.mouseup = function (e) {\n\t\tself.tableRowDrop(e, row);\n\t}.bind(self);\n\n\t//same table drag drop\n\tconfig.mousemove = function (e) {\n\t\tif (e.pageY - Tabulator.prototype.helpers.elOffset(group.element).top + self.table.rowManager.element.scrollTop > group.getHeight() / 2) {\n\t\t\tif (self.toRow !== group || !self.toRowAfter) {\n\t\t\t\tvar rowEl = group.getElement();\n\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\tself.moveRow(group, true);\n\t\t\t}\n\t\t} else {\n\t\t\tif (self.toRow !== group || self.toRowAfter) {\n\t\t\t\tvar rowEl = group.getElement();\n\t\t\t\tif (rowEl.previousSibling) {\n\t\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\t\tself.moveRow(group, false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}.bind(self);\n\n\tgroup.modules.moveRow = config;\n};\n\nMoveRows.prototype.initializeRow = function (row) {\n\tvar self = this,\n\t    config = {},\n\t    rowEl;\n\n\t//inter table drag drop\n\tconfig.mouseup = function (e) {\n\t\tself.tableRowDrop(e, row);\n\t}.bind(self);\n\n\t//same table drag drop\n\tconfig.mousemove = function (e) {\n\t\tvar rowEl = row.getElement();\n\n\t\tif (e.pageY - Tabulator.prototype.helpers.elOffset(rowEl).top + self.table.rowManager.element.scrollTop > row.getHeight() / 2) {\n\t\t\tif (self.toRow !== row || !self.toRowAfter) {\n\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl.nextSibling);\n\t\t\t\tself.moveRow(row, true);\n\t\t\t}\n\t\t} else {\n\t\t\tif (self.toRow !== row || self.toRowAfter) {\n\t\t\t\trowEl.parentNode.insertBefore(self.placeholderElement, rowEl);\n\t\t\t\tself.moveRow(row, false);\n\t\t\t}\n\t\t}\n\t}.bind(self);\n\n\tif (!this.hasHandle) {\n\n\t\trowEl = row.getElement();\n\n\t\trowEl.addEventListener(\"mousedown\", function (e) {\n\t\t\tif (e.which === 1) {\n\t\t\t\tself.checkTimeout = setTimeout(function () {\n\t\t\t\t\tself.startMove(e, row);\n\t\t\t\t}, self.checkPeriod);\n\t\t\t}\n\t\t});\n\n\t\trowEl.addEventListener(\"mouseup\", function (e) {\n\t\t\tif (e.which === 1) {\n\t\t\t\tif (self.checkTimeout) {\n\t\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.bindTouchEvents(row, row.getElement());\n\t}\n\n\trow.modules.moveRow = config;\n};\n\nMoveRows.prototype.initializeCell = function (cell) {\n\tvar self = this,\n\t    cellEl = cell.getElement(true);\n\n\tcellEl.addEventListener(\"mousedown\", function (e) {\n\t\tif (e.which === 1) {\n\t\t\tself.checkTimeout = setTimeout(function () {\n\t\t\t\tself.startMove(e, cell.row);\n\t\t\t}, self.checkPeriod);\n\t\t}\n\t});\n\n\tcellEl.addEventListener(\"mouseup\", function (e) {\n\t\tif (e.which === 1) {\n\t\t\tif (self.checkTimeout) {\n\t\t\t\tclearTimeout(self.checkTimeout);\n\t\t\t}\n\t\t}\n\t});\n\n\tthis.bindTouchEvents(cell.row, cellEl);\n};\n\nMoveRows.prototype.bindTouchEvents = function (row, element) {\n\tvar self = this,\n\t    startYMove = false,\n\t    //shifting center position of the cell\n\tdir = false,\n\t    currentRow,\n\t    nextRow,\n\t    prevRow,\n\t    nextRowHeight,\n\t    prevRowHeight,\n\t    nextRowHeightLast,\n\t    prevRowHeightLast;\n\n\telement.addEventListener(\"touchstart\", function (e) {\n\t\tself.checkTimeout = setTimeout(function () {\n\t\t\tself.touchMove = true;\n\t\t\tcurrentRow = row;\n\t\t\tnextRow = row.nextRow();\n\t\t\tnextRowHeight = nextRow ? nextRow.getHeight() / 2 : 0;\n\t\t\tprevRow = row.prevRow();\n\t\t\tprevRowHeight = prevRow ? prevRow.getHeight() / 2 : 0;\n\t\t\tnextRowHeightLast = 0;\n\t\t\tprevRowHeightLast = 0;\n\t\t\tstartYMove = false;\n\n\t\t\tself.startMove(e, row);\n\t\t}, self.checkPeriod);\n\t}, { passive: true });\n\tthis.moving, this.toRow, this.toRowAfter;\n\telement.addEventListener(\"touchmove\", function (e) {\n\n\t\tvar halfCol, diff, moveToRow;\n\n\t\tif (self.moving) {\n\t\t\te.preventDefault();\n\n\t\t\tself.moveHover(e);\n\n\t\t\tif (!startYMove) {\n\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t}\n\n\t\t\tdiff = e.touches[0].pageY - startYMove;\n\n\t\t\tif (diff > 0) {\n\t\t\t\tif (nextRow && diff - nextRowHeightLast > nextRowHeight) {\n\t\t\t\t\tmoveToRow = nextRow;\n\n\t\t\t\t\tif (moveToRow !== row) {\n\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(self.placeholderElement, moveToRow.getElement().nextSibling);\n\t\t\t\t\t\tself.moveRow(moveToRow, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (prevRow && -diff - prevRowHeightLast > prevRowHeight) {\n\t\t\t\t\tmoveToRow = prevRow;\n\n\t\t\t\t\tif (moveToRow !== row) {\n\t\t\t\t\t\tstartYMove = e.touches[0].pageY;\n\t\t\t\t\t\tmoveToRow.getElement().parentNode.insertBefore(self.placeholderElement, moveToRow.getElement());\n\t\t\t\t\t\tself.moveRow(moveToRow, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (moveToRow) {\n\t\t\t\tcurrentRow = moveToRow;\n\t\t\t\tnextRow = moveToRow.nextRow();\n\t\t\t\tnextRowHeightLast = nextRowHeight;\n\t\t\t\tnextRowHeight = nextRow ? nextRow.getHeight() / 2 : 0;\n\t\t\t\tprevRow = moveToRow.prevRow();\n\t\t\t\tprevRowHeightLast = prevRowHeight;\n\t\t\t\tprevRowHeight = prevRow ? prevRow.getHeight() / 2 : 0;\n\t\t\t}\n\t\t}\n\t});\n\n\telement.addEventListener(\"touchend\", function (e) {\n\t\tif (self.checkTimeout) {\n\t\t\tclearTimeout(self.checkTimeout);\n\t\t}\n\t\tif (self.moving) {\n\t\t\tself.endMove(e);\n\t\t\tself.touchMove = false;\n\t\t}\n\t});\n};\n\nMoveRows.prototype._bindMouseMove = function () {\n\tvar self = this;\n\n\tself.table.rowManager.getDisplayRows().forEach(function (row) {\n\t\tif ((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow.mousemove) {\n\t\t\trow.getElement().addEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t}\n\t});\n};\n\nMoveRows.prototype._unbindMouseMove = function () {\n\tvar self = this;\n\n\tself.table.rowManager.getDisplayRows().forEach(function (row) {\n\t\tif ((row.type === \"row\" || row.type === \"group\") && row.modules.moveRow.mousemove) {\n\t\t\trow.getElement().removeEventListener(\"mousemove\", row.modules.moveRow.mousemove);\n\t\t}\n\t});\n};\n\nMoveRows.prototype.startMove = function (e, row) {\n\tvar element = row.getElement();\n\n\tthis.setStartPosition(e, row);\n\n\tthis.moving = row;\n\n\tthis.table.element.classList.add(\"tabulator-block-select\");\n\n\t//create placeholder\n\tthis.placeholderElement.style.width = row.getWidth() + \"px\";\n\tthis.placeholderElement.style.height = row.getHeight() + \"px\";\n\n\tif (!this.connection) {\n\t\telement.parentNode.insertBefore(this.placeholderElement, element);\n\t\telement.parentNode.removeChild(element);\n\t} else {\n\t\tthis.table.element.classList.add(\"tabulator-movingrow-sending\");\n\t\tthis.connectToTables(row);\n\t}\n\n\t//create hover element\n\tthis.hoverElement = element.cloneNode(true);\n\tthis.hoverElement.classList.add(\"tabulator-moving\");\n\n\tif (this.connection) {\n\t\tdocument.body.appendChild(this.hoverElement);\n\t\tthis.hoverElement.style.left = \"0\";\n\t\tthis.hoverElement.style.top = \"0\";\n\t\tthis.hoverElement.style.width = this.table.element.clientWidth + \"px\";\n\t\tthis.hoverElement.style.whiteSpace = \"nowrap\";\n\t\tthis.hoverElement.style.overflow = \"hidden\";\n\t\tthis.hoverElement.style.pointerEvents = \"none\";\n\t} else {\n\t\tthis.table.rowManager.getTableElement().appendChild(this.hoverElement);\n\n\t\tthis.hoverElement.style.left = \"0\";\n\t\tthis.hoverElement.style.top = \"0\";\n\n\t\tthis._bindMouseMove();\n\t}\n\n\tdocument.body.addEventListener(\"mousemove\", this.moveHover);\n\tdocument.body.addEventListener(\"mouseup\", this.endMove);\n\n\tthis.moveHover(e);\n};\n\nMoveRows.prototype.setStartPosition = function (e, row) {\n\tvar pageX = this.touchMove ? e.touches[0].pageX : e.pageX,\n\t    pageY = this.touchMove ? e.touches[0].pageY : e.pageY,\n\t    element,\n\t    position;\n\n\telement = row.getElement();\n\tif (this.connection) {\n\t\tposition = element.getBoundingClientRect();\n\n\t\tthis.startX = position.left - pageX + window.pageXOffset;\n\t\tthis.startY = position.top - pageY + window.pageYOffset;\n\t} else {\n\t\tthis.startY = pageY - element.getBoundingClientRect().top;\n\t}\n};\n\nMoveRows.prototype.endMove = function (e) {\n\tif (!e || e.which === 1 || this.touchMove) {\n\t\tthis._unbindMouseMove();\n\n\t\tif (!this.connection) {\n\t\t\tthis.placeholderElement.parentNode.insertBefore(this.moving.getElement(), this.placeholderElement.nextSibling);\n\t\t\tthis.placeholderElement.parentNode.removeChild(this.placeholderElement);\n\t\t}\n\n\t\tthis.hoverElement.parentNode.removeChild(this.hoverElement);\n\n\t\tthis.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\tif (this.toRow) {\n\t\t\tthis.table.rowManager.moveRow(this.moving, this.toRow, this.toRowAfter);\n\t\t}\n\n\t\tthis.moving = false;\n\t\tthis.toRow = false;\n\t\tthis.toRowAfter = false;\n\n\t\tdocument.body.removeEventListener(\"mousemove\", this.moveHover);\n\t\tdocument.body.removeEventListener(\"mouseup\", this.endMove);\n\n\t\tif (this.connection) {\n\t\t\tthis.table.element.classList.remove(\"tabulator-movingrow-sending\");\n\t\t\tthis.disconnectFromTables();\n\t\t}\n\t}\n};\n\nMoveRows.prototype.moveRow = function (row, after) {\n\tthis.toRow = row;\n\tthis.toRowAfter = after;\n};\n\nMoveRows.prototype.moveHover = function (e) {\n\tif (this.connection) {\n\t\tthis.moveHoverConnections.call(this, e);\n\t} else {\n\t\tthis.moveHoverTable.call(this, e);\n\t}\n};\n\nMoveRows.prototype.moveHoverTable = function (e) {\n\tvar rowHolder = this.table.rowManager.getElement(),\n\t    scrollTop = rowHolder.scrollTop,\n\t    yPos = (this.touchMove ? e.touches[0].pageY : e.pageY) - rowHolder.getBoundingClientRect().top + scrollTop,\n\t    scrollPos;\n\n\tthis.hoverElement.style.top = yPos - this.startY + \"px\";\n};\n\nMoveRows.prototype.moveHoverConnections = function (e) {\n\tthis.hoverElement.style.left = this.startX + (this.touchMove ? e.touches[0].pageX : e.pageX) + \"px\";\n\tthis.hoverElement.style.top = this.startY + (this.touchMove ? e.touches[0].pageY : e.pageY) + \"px\";\n};\n\nMoveRows.prototype.elementRowDrop = function (e, element, row) {\n\tif (this.table.options.movableRowsElementDrop) {\n\t\tthis.table.options.movableRowsElementDrop(e, element, row ? row.getComponent() : false);\n\t}\n};\n\n//establish connection with other tables\nMoveRows.prototype.connectToTables = function (row) {\n\tvar _this75 = this;\n\n\tvar connectionTables;\n\n\tif (this.connectionSelectorsTables) {\n\t\tconnectionTables = this.table.modules.comms.getConnections(this.connectionSelectorsTables);\n\n\t\tthis.table.options.movableRowsSendingStart.call(this.table, connectionTables);\n\n\t\tthis.table.modules.comms.send(this.connectionSelectorsTables, \"moveRow\", \"connect\", {\n\t\t\trow: row\n\t\t});\n\t}\n\n\tif (this.connectionSelectorsElements) {\n\n\t\tthis.connectionElements = [];\n\n\t\tif (!Array.isArray(this.connectionSelectorsElements)) {\n\t\t\tthis.connectionSelectorsElements = [this.connectionSelectorsElements];\n\t\t}\n\n\t\tthis.connectionSelectorsElements.forEach(function (query) {\n\t\t\tif (typeof query === \"string\") {\n\t\t\t\t_this75.connectionElements = _this75.connectionElements.concat(Array.prototype.slice.call(document.querySelectorAll(query)));\n\t\t\t} else {\n\t\t\t\t_this75.connectionElements.push(query);\n\t\t\t}\n\t\t});\n\n\t\tthis.connectionElements.forEach(function (element) {\n\t\t\tvar dropEvent = function dropEvent(e) {\n\t\t\t\t_this75.elementRowDrop(e, element, _this75.moving);\n\t\t\t};\n\n\t\t\telement.addEventListener(\"mouseup\", dropEvent);\n\t\t\telement.tabulatorElementDropEvent = dropEvent;\n\n\t\t\telement.classList.add(\"tabulator-movingrow-receiving\");\n\t\t});\n\t}\n};\n\n//disconnect from other tables\nMoveRows.prototype.disconnectFromTables = function () {\n\tvar connectionTables;\n\n\tif (this.connectionSelectorsTables) {\n\t\tconnectionTables = this.table.modules.comms.getConnections(this.connectionSelectorsTables);\n\n\t\tthis.table.options.movableRowsSendingStop.call(this.table, connectionTables);\n\n\t\tthis.table.modules.comms.send(this.connectionSelectorsTables, \"moveRow\", \"disconnect\");\n\t}\n\n\tthis.connectionElements.forEach(function (element) {\n\t\telement.classList.remove(\"tabulator-movingrow-receiving\");\n\t\telement.removeEventListener(\"mouseup\", element.tabulatorElementDropEvent);\n\t\tdelete element.tabulatorElementDropEvent;\n\t});\n};\n\n//accept incomming connection\nMoveRows.prototype.connect = function (table, row) {\n\tvar self = this;\n\tif (!this.connectedTable) {\n\t\tthis.connectedTable = table;\n\t\tthis.connectedRow = row;\n\n\t\tthis.table.element.classList.add(\"tabulator-movingrow-receiving\");\n\n\t\tself.table.rowManager.getDisplayRows().forEach(function (row) {\n\t\t\tif (row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup) {\n\t\t\t\trow.getElement().addEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t}\n\t\t});\n\n\t\tself.tableRowDropEvent = self.tableRowDrop.bind(self);\n\n\t\tself.table.element.addEventListener(\"mouseup\", self.tableRowDropEvent);\n\n\t\tthis.table.options.movableRowsReceivingStart.call(this.table, row, table);\n\n\t\treturn true;\n\t} else {\n\t\tconsole.warn(\"Move Row Error - Table cannot accept connection, already connected to table:\", this.connectedTable);\n\t\treturn false;\n\t}\n};\n\n//close incomming connection\nMoveRows.prototype.disconnect = function (table) {\n\tvar self = this;\n\tif (table === this.connectedTable) {\n\t\tthis.connectedTable = false;\n\t\tthis.connectedRow = false;\n\n\t\tthis.table.element.classList.remove(\"tabulator-movingrow-receiving\");\n\n\t\tself.table.rowManager.getDisplayRows().forEach(function (row) {\n\t\t\tif (row.type === \"row\" && row.modules.moveRow && row.modules.moveRow.mouseup) {\n\t\t\t\trow.getElement().removeEventListener(\"mouseup\", row.modules.moveRow.mouseup);\n\t\t\t}\n\t\t});\n\n\t\tself.table.element.removeEventListener(\"mouseup\", self.tableRowDropEvent);\n\n\t\tthis.table.options.movableRowsReceivingStop.call(this.table, table);\n\t} else {\n\t\tconsole.warn(\"Move Row Error - trying to disconnect from non connected table\");\n\t}\n};\n\nMoveRows.prototype.dropComplete = function (table, row, success) {\n\tvar sender = false;\n\n\tif (success) {\n\n\t\tswitch (_typeof(this.table.options.movableRowsSender)) {\n\t\t\tcase \"string\":\n\t\t\t\tsender = this.senders[this.table.options.movableRowsSender];\n\t\t\t\tbreak;\n\n\t\t\tcase \"function\":\n\t\t\t\tsender = this.table.options.movableRowsSender;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (sender) {\n\t\t\tsender.call(this, this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t\t} else {\n\t\t\tif (this.table.options.movableRowsSender) {\n\t\t\t\tconsole.warn(\"Mover Row Error - no matching sender found:\", this.table.options.movableRowsSender);\n\t\t\t}\n\t\t}\n\n\t\tthis.table.options.movableRowsSent.call(this.table, this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t} else {\n\t\tthis.table.options.movableRowsSentFailed.call(this.table, this.moving.getComponent(), row ? row.getComponent() : undefined, table);\n\t}\n\n\tthis.endMove();\n};\n\nMoveRows.prototype.tableRowDrop = function (e, row) {\n\tvar receiver = false,\n\t    success = false;\n\n\te.stopImmediatePropagation();\n\n\tswitch (_typeof(this.table.options.movableRowsReceiver)) {\n\t\tcase \"string\":\n\t\t\treceiver = this.receivers[this.table.options.movableRowsReceiver];\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\treceiver = this.table.options.movableRowsReceiver;\n\t\t\tbreak;\n\t}\n\n\tif (receiver) {\n\t\tsuccess = receiver.call(this, this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t} else {\n\t\tconsole.warn(\"Mover Row Error - no matching receiver found:\", this.table.options.movableRowsReceiver);\n\t}\n\n\tif (success) {\n\t\tthis.table.options.movableRowsReceived.call(this.table, this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t} else {\n\t\tthis.table.options.movableRowsReceivedFailed.call(this.table, this.connectedRow.getComponent(), row ? row.getComponent() : undefined, this.connectedTable);\n\t}\n\n\tthis.table.modules.comms.send(this.connectedTable, \"moveRow\", \"dropcomplete\", {\n\t\trow: row,\n\t\tsuccess: success\n\t});\n};\n\nMoveRows.prototype.receivers = {\n\tinsert: function insert(fromRow, toRow, fromTable) {\n\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\n\t\treturn true;\n\t},\n\n\tadd: function add(fromRow, toRow, fromTable) {\n\t\tthis.table.addRow(fromRow.getData());\n\t\treturn true;\n\t},\n\n\tupdate: function update(fromRow, toRow, fromTable) {\n\t\tif (toRow) {\n\t\t\ttoRow.update(fromRow.getData());\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\treplace: function replace(fromRow, toRow, fromTable) {\n\t\tif (toRow) {\n\t\t\tthis.table.addRow(fromRow.getData(), undefined, toRow);\n\t\t\ttoRow.delete();\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n};\n\nMoveRows.prototype.senders = {\n\tdelete: function _delete(fromRow, toRow, toTable) {\n\t\tfromRow.delete();\n\t}\n};\n\nMoveRows.prototype.commsReceived = function (table, action, data) {\n\tswitch (action) {\n\t\tcase \"connect\":\n\t\t\treturn this.connect(table, data.row);\n\t\t\tbreak;\n\n\t\tcase \"disconnect\":\n\t\t\treturn this.disconnect(table);\n\t\t\tbreak;\n\n\t\tcase \"dropcomplete\":\n\t\t\treturn this.dropComplete(table, data.row, data.success);\n\t\t\tbreak;\n\t}\n};\n\nTabulator.prototype.registerModule(\"moveRow\", MoveRows);\nvar Mutator = function Mutator(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.allowedTypes = [\"\", \"data\", \"edit\", \"clipboard\"]; //list of muatation types\n\tthis.enabled = true;\n};\n\n//initialize column mutator\nMutator.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    match = false,\n\t    config = {};\n\n\tthis.allowedTypes.forEach(function (type) {\n\t\tvar key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t\t    mutator;\n\n\t\tif (column.definition[key]) {\n\t\t\tmutator = self.lookupMutator(column.definition[key]);\n\n\t\t\tif (mutator) {\n\t\t\t\tmatch = true;\n\n\t\t\t\tconfig[key] = {\n\t\t\t\t\tmutator: mutator,\n\t\t\t\t\tparams: column.definition[key + \"Params\"] || {}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\n\tif (match) {\n\t\tcolumn.modules.mutate = config;\n\t}\n};\n\nMutator.prototype.lookupMutator = function (value) {\n\tvar mutator = false;\n\n\t//set column mutator\n\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\t\tcase \"string\":\n\t\t\tif (this.mutators[value]) {\n\t\t\t\tmutator = this.mutators[value];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Mutator Error - No such mutator found, ignoring: \", value);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tmutator = value;\n\t\t\tbreak;\n\t}\n\n\treturn mutator;\n};\n\n//apply mutator to row\nMutator.prototype.transformRow = function (data, type, updatedData) {\n\tvar self = this,\n\t    key = \"mutator\" + (type.charAt(0).toUpperCase() + type.slice(1)),\n\t    value;\n\n\tif (this.enabled) {\n\n\t\tself.table.columnManager.traverse(function (column) {\n\t\t\tvar mutator, params, component;\n\n\t\t\tif (column.modules.mutate) {\n\t\t\t\tmutator = column.modules.mutate[key] || column.modules.mutate.mutator || false;\n\n\t\t\t\tif (mutator) {\n\t\t\t\t\tvalue = column.getFieldValue(typeof updatedData !== \"undefined\" ? updatedData : data);\n\n\t\t\t\t\tif (type == \"data\" || typeof value !== \"undefined\") {\n\t\t\t\t\t\tcomponent = column.getComponent();\n\t\t\t\t\t\tparams = typeof mutator.params === \"function\" ? mutator.params(value, data, type, component) : mutator.params;\n\t\t\t\t\t\tcolumn.setFieldValue(data, mutator.mutator(value, data, type, params, component));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\treturn data;\n};\n\n//apply mutator to new cell value\nMutator.prototype.transformCell = function (cell, value) {\n\tvar mutator = cell.column.modules.mutate.mutatorEdit || cell.column.modules.mutate.mutator || false,\n\t    tempData = {};\n\n\tif (mutator) {\n\t\ttempData = Object.assign(tempData, cell.row.getData());\n\t\tcell.column.setFieldValue(tempData, value);\n\t\treturn mutator.mutator(value, tempData, \"edit\", mutator.params, cell.getComponent());\n\t} else {\n\t\treturn value;\n\t}\n};\n\nMutator.prototype.enable = function () {\n\tthis.enabled = true;\n};\n\nMutator.prototype.disable = function () {\n\tthis.enabled = false;\n};\n\n//default mutators\nMutator.prototype.mutators = {};\n\nTabulator.prototype.registerModule(\"mutator\", Mutator);\nvar Page = function Page(table) {\n\n\tthis.table = table; //hold Tabulator object\n\n\tthis.mode = \"local\";\n\tthis.progressiveLoad = false;\n\n\tthis.size = 0;\n\tthis.page = 1;\n\tthis.count = 5;\n\tthis.max = 1;\n\n\tthis.displayIndex = 0; //index in display pipeline\n\n\tthis.initialLoad = true;\n\n\tthis.pageSizes = [];\n\n\tthis.dataReceivedNames = {};\n\tthis.dataSentNames = {};\n\n\tthis.createElements();\n};\n\nPage.prototype.createElements = function () {\n\n\tvar button;\n\n\tthis.element = document.createElement(\"span\");\n\tthis.element.classList.add(\"tabulator-paginator\");\n\n\tthis.pagesElement = document.createElement(\"span\");\n\tthis.pagesElement.classList.add(\"tabulator-pages\");\n\n\tbutton = document.createElement(\"button\");\n\tbutton.classList.add(\"tabulator-page\");\n\tbutton.setAttribute(\"type\", \"button\");\n\tbutton.setAttribute(\"role\", \"button\");\n\tbutton.setAttribute(\"aria-label\", \"\");\n\tbutton.setAttribute(\"title\", \"\");\n\n\tthis.firstBut = button.cloneNode(true);\n\tthis.firstBut.setAttribute(\"data-page\", \"first\");\n\n\tthis.prevBut = button.cloneNode(true);\n\tthis.prevBut.setAttribute(\"data-page\", \"prev\");\n\n\tthis.nextBut = button.cloneNode(true);\n\tthis.nextBut.setAttribute(\"data-page\", \"next\");\n\n\tthis.lastBut = button.cloneNode(true);\n\tthis.lastBut.setAttribute(\"data-page\", \"last\");\n\n\tif (this.table.options.paginationSizeSelector) {\n\t\tthis.pageSizeSelect = document.createElement(\"select\");\n\t\tthis.pageSizeSelect.classList.add(\"tabulator-page-size\");\n\t}\n};\n\nPage.prototype.generatePageSizeSelectList = function () {\n\tvar _this76 = this;\n\n\tvar pageSizes = [];\n\n\tif (this.pageSizeSelect) {\n\n\t\tif (Array.isArray(this.table.options.paginationSizeSelector)) {\n\t\t\tpageSizes = this.table.options.paginationSizeSelector;\n\t\t\tthis.pageSizes = pageSizes;\n\n\t\t\tif (this.pageSizes.indexOf(this.size) == -1) {\n\t\t\t\tpageSizes.unshift(this.size);\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (this.pageSizes.indexOf(this.size) == -1) {\n\t\t\t\tpageSizes = [];\n\n\t\t\t\tfor (var _i14 = 1; _i14 < 5; _i14++) {\n\t\t\t\t\tpageSizes.push(this.size * _i14);\n\t\t\t\t}\n\n\t\t\t\tthis.pageSizes = pageSizes;\n\t\t\t} else {\n\t\t\t\tpageSizes = this.pageSizes;\n\t\t\t}\n\t\t}\n\n\t\twhile (this.pageSizeSelect.firstChild) {\n\t\t\tthis.pageSizeSelect.removeChild(this.pageSizeSelect.firstChild);\n\t\t}pageSizes.forEach(function (item) {\n\t\t\tvar itemEl = document.createElement(\"option\");\n\t\t\titemEl.value = item;\n\n\t\t\tif (item === true) {\n\t\t\t\t_this76.table.modules.localize.bind(\"pagination|all\", function (value) {\n\t\t\t\t\titemEl.innerHTML = value;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\titemEl.innerHTML = item;\n\t\t\t}\n\n\t\t\t_this76.pageSizeSelect.appendChild(itemEl);\n\t\t});\n\n\t\tthis.pageSizeSelect.value = this.size;\n\t}\n};\n\n//setup pageination\nPage.prototype.initialize = function (hidden) {\n\tvar self = this,\n\t    pageSelectLabel,\n\t    testElRow,\n\t    testElCell;\n\n\t//update param names\n\tthis.dataSentNames = Object.assign({}, this.paginationDataSentNames);\n\tthis.dataSentNames = Object.assign(this.dataSentNames, this.table.options.paginationDataSent);\n\n\tthis.dataReceivedNames = Object.assign({}, this.paginationDataReceivedNames);\n\tthis.dataReceivedNames = Object.assign(this.dataReceivedNames, this.table.options.paginationDataReceived);\n\n\t//build pagination element\n\n\t//bind localizations\n\tself.table.modules.localize.bind(\"pagination|first\", function (value) {\n\t\tself.firstBut.innerHTML = value;\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|first_title\", function (value) {\n\t\tself.firstBut.setAttribute(\"aria-label\", value);\n\t\tself.firstBut.setAttribute(\"title\", value);\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|prev\", function (value) {\n\t\tself.prevBut.innerHTML = value;\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|prev_title\", function (value) {\n\t\tself.prevBut.setAttribute(\"aria-label\", value);\n\t\tself.prevBut.setAttribute(\"title\", value);\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|next\", function (value) {\n\t\tself.nextBut.innerHTML = value;\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|next_title\", function (value) {\n\t\tself.nextBut.setAttribute(\"aria-label\", value);\n\t\tself.nextBut.setAttribute(\"title\", value);\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|last\", function (value) {\n\t\tself.lastBut.innerHTML = value;\n\t});\n\n\tself.table.modules.localize.bind(\"pagination|last_title\", function (value) {\n\t\tself.lastBut.setAttribute(\"aria-label\", value);\n\t\tself.lastBut.setAttribute(\"title\", value);\n\t});\n\n\t//click bindings\n\tself.firstBut.addEventListener(\"click\", function () {\n\t\tself.setPage(1).then(function () {}).catch(function () {});\n\t});\n\n\tself.prevBut.addEventListener(\"click\", function () {\n\t\tself.previousPage().then(function () {}).catch(function () {});\n\t});\n\n\tself.nextBut.addEventListener(\"click\", function () {\n\t\tself.nextPage().then(function () {}).catch(function () {});\n\t});\n\n\tself.lastBut.addEventListener(\"click\", function () {\n\t\tself.setPage(self.max).then(function () {}).catch(function () {});\n\t});\n\n\tif (self.table.options.paginationElement) {\n\t\tself.element = self.table.options.paginationElement;\n\t}\n\n\tif (this.pageSizeSelect) {\n\t\tpageSelectLabel = document.createElement(\"label\");\n\n\t\tself.table.modules.localize.bind(\"pagination|page_size\", function (value) {\n\t\t\tself.pageSizeSelect.setAttribute(\"aria-label\", value);\n\t\t\tself.pageSizeSelect.setAttribute(\"title\", value);\n\t\t\tpageSelectLabel.innerHTML = value;\n\t\t});\n\n\t\tself.element.appendChild(pageSelectLabel);\n\t\tself.element.appendChild(self.pageSizeSelect);\n\n\t\tself.pageSizeSelect.addEventListener(\"change\", function (e) {\n\t\t\tself.setPageSize(self.pageSizeSelect.value == \"true\" ? true : self.pageSizeSelect.value);\n\t\t\tself.setPage(1).then(function () {}).catch(function () {});\n\t\t});\n\t}\n\n\t//append to DOM\n\tself.element.appendChild(self.firstBut);\n\tself.element.appendChild(self.prevBut);\n\tself.element.appendChild(self.pagesElement);\n\tself.element.appendChild(self.nextBut);\n\tself.element.appendChild(self.lastBut);\n\n\tif (!self.table.options.paginationElement && !hidden) {\n\t\tself.table.footerManager.append(self.element, self);\n\t}\n\n\t//set default values\n\tself.mode = self.table.options.pagination;\n\n\tif (self.table.options.paginationSize) {\n\t\tself.size = self.table.options.paginationSize;\n\t} else {\n\t\ttestElRow = document.createElement(\"div\");\n\t\ttestElRow.classList.add(\"tabulator-row\");\n\t\ttestElRow.style.visibility = hidden;\n\n\t\ttestElCell = document.createElement(\"div\");\n\t\ttestElCell.classList.add(\"tabulator-cell\");\n\t\ttestElCell.innerHTML = \"Page Row Test\";\n\n\t\ttestElRow.appendChild(testElCell);\n\n\t\tself.table.rowManager.getTableElement().appendChild(testElRow);\n\n\t\tself.size = Math.floor(self.table.rowManager.getElement().clientHeight / testElRow.offsetHeight);\n\n\t\tself.table.rowManager.getTableElement().removeChild(testElRow);\n\t}\n\n\t// self.page = self.table.options.paginationInitialPage || 1;\n\tself.count = self.table.options.paginationButtonCount;\n\n\tself.generatePageSizeSelectList();\n};\n\nPage.prototype.initializeProgressive = function (mode) {\n\tthis.initialize(true);\n\tthis.mode = \"progressive_\" + mode;\n\tthis.progressiveLoad = true;\n};\n\nPage.prototype.setDisplayIndex = function (index) {\n\tthis.displayIndex = index;\n};\n\nPage.prototype.getDisplayIndex = function () {\n\treturn this.displayIndex;\n};\n\n//calculate maximum page from number of rows\nPage.prototype.setMaxRows = function (rowCount) {\n\tif (!rowCount) {\n\t\tthis.max = 1;\n\t} else {\n\t\tthis.max = this.size === true ? 1 : Math.ceil(rowCount / this.size);\n\t}\n\n\tif (this.page > this.max) {\n\t\tthis.page = this.max;\n\t}\n};\n\n//reset to first page without triggering action\nPage.prototype.reset = function (force, columnsChanged) {\n\tif (this.mode == \"local\" || force) {\n\t\tthis.page = 1;\n\t}\n\n\tif (columnsChanged) {\n\t\tthis.initialLoad = true;\n\t}\n\n\treturn true;\n};\n\n//set the maxmum page\nPage.prototype.setMaxPage = function (max) {\n\n\tmax = parseInt(max);\n\n\tthis.max = max || 1;\n\n\tif (this.page > this.max) {\n\t\tthis.page = this.max;\n\t\tthis.trigger();\n\t}\n};\n\n//set current page number\nPage.prototype.setPage = function (page) {\n\tvar _this77 = this;\n\n\tvar self = this;\n\n\tswitch (page) {\n\t\tcase \"first\":\n\t\t\treturn this.setPage(1);\n\t\t\tbreak;\n\n\t\tcase \"prev\":\n\t\t\treturn this.previousPage();\n\t\t\tbreak;\n\n\t\tcase \"next\":\n\t\t\treturn this.nextPage();\n\t\t\tbreak;\n\n\t\tcase \"last\":\n\t\t\treturn this.setPage(this.max);\n\t\t\tbreak;\n\t}\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tpage = parseInt(page);\n\n\t\tif (page > 0 && page <= _this77.max || _this77.mode !== \"local\") {\n\t\t\t_this77.page = page;\n\t\t\t_this77.trigger().then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function () {\n\t\t\t\treject();\n\t\t\t});\n\n\t\t\tif (self.table.options.persistence && self.table.modExists(\"persistence\", true) && self.table.modules.persistence.config.page) {\n\t\t\t\tself.table.modules.persistence.save(\"page\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Pagination Error - Requested page is out of range of 1 - \" + _this77.max + \":\", page);\n\t\t\treject();\n\t\t}\n\t});\n};\n\nPage.prototype.setPageToRow = function (row) {\n\tvar _this78 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tvar rows = _this78.table.rowManager.getDisplayRows(_this78.displayIndex - 1);\n\t\tvar index = rows.indexOf(row);\n\n\t\tif (index > -1) {\n\t\t\tvar page = _this78.size === true ? 1 : Math.ceil((index + 1) / _this78.size);\n\n\t\t\t_this78.setPage(page).then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function () {\n\t\t\t\treject();\n\t\t\t});\n\t\t} else {\n\t\t\tconsole.warn(\"Pagination Error - Requested row is not visible\");\n\t\t\treject();\n\t\t}\n\t});\n};\n\nPage.prototype.setPageSize = function (size) {\n\tif (size !== true) {\n\t\tsize = parseInt(size);\n\t}\n\n\tif (size > 0) {\n\t\tthis.size = size;\n\t}\n\n\tif (this.pageSizeSelect) {\n\t\t// this.pageSizeSelect.value = size;\n\t\tthis.generatePageSizeSelectList();\n\t}\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.page) {\n\t\tthis.table.modules.persistence.save(\"page\");\n\t}\n};\n\n//setup the pagination buttons\nPage.prototype._setPageButtons = function () {\n\tvar self = this;\n\n\tvar leftSize = Math.floor((this.count - 1) / 2);\n\tvar rightSize = Math.ceil((this.count - 1) / 2);\n\tvar min = this.max - this.page + leftSize + 1 < this.count ? this.max - this.count + 1 : Math.max(this.page - leftSize, 1);\n\tvar max = this.page <= rightSize ? Math.min(this.count, this.max) : Math.min(this.page + rightSize, this.max);\n\n\twhile (self.pagesElement.firstChild) {\n\t\tself.pagesElement.removeChild(self.pagesElement.firstChild);\n\t}if (self.page == 1) {\n\t\tself.firstBut.disabled = true;\n\t\tself.prevBut.disabled = true;\n\t} else {\n\t\tself.firstBut.disabled = false;\n\t\tself.prevBut.disabled = false;\n\t}\n\n\tif (self.page == self.max) {\n\t\tself.lastBut.disabled = true;\n\t\tself.nextBut.disabled = true;\n\t} else {\n\t\tself.lastBut.disabled = false;\n\t\tself.nextBut.disabled = false;\n\t}\n\n\tfor (var _i15 = min; _i15 <= max; _i15++) {\n\t\tif (_i15 > 0 && _i15 <= self.max) {\n\t\t\tself.pagesElement.appendChild(self._generatePageButton(_i15));\n\t\t}\n\t}\n\n\tthis.footerRedraw();\n};\n\nPage.prototype._generatePageButton = function (page) {\n\tvar self = this,\n\t    button = document.createElement(\"button\");\n\n\tbutton.classList.add(\"tabulator-page\");\n\tif (page == self.page) {\n\t\tbutton.classList.add(\"active\");\n\t}\n\n\tbutton.setAttribute(\"type\", \"button\");\n\tbutton.setAttribute(\"role\", \"button\");\n\n\tself.table.modules.localize.bind(\"pagination|page_title\", function (value) {\n\t\tbutton.setAttribute(\"aria-label\", value + \" \" + page);\n\t\tbutton.setAttribute(\"title\", value + \" \" + page);\n\t});\n\n\tbutton.setAttribute(\"data-page\", page);\n\tbutton.textContent = page;\n\n\tbutton.addEventListener(\"click\", function (e) {\n\t\tself.setPage(page).then(function () {}).catch(function () {});\n\t});\n\n\treturn button;\n};\n\n//previous page\nPage.prototype.previousPage = function () {\n\tvar _this79 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this79.page > 1) {\n\t\t\t_this79.page--;\n\t\t\t_this79.trigger().then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function () {\n\t\t\t\treject();\n\t\t\t});\n\n\t\t\tif (_this79.table.options.persistence && _this79.table.modExists(\"persistence\", true) && _this79.table.modules.persistence.config.page) {\n\t\t\t\t_this79.table.modules.persistence.save(\"page\");\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.warn(\"Pagination Error - Previous page would be less than page 1:\", 0);\n\t\t\treject();\n\t\t}\n\t});\n};\n\n//next page\nPage.prototype.nextPage = function () {\n\tvar _this80 = this;\n\n\treturn new Promise(function (resolve, reject) {\n\t\tif (_this80.page < _this80.max) {\n\t\t\t_this80.page++;\n\t\t\t_this80.trigger().then(function () {\n\t\t\t\tresolve();\n\t\t\t}).catch(function () {\n\t\t\t\treject();\n\t\t\t});\n\n\t\t\tif (_this80.table.options.persistence && _this80.table.modExists(\"persistence\", true) && _this80.table.modules.persistence.config.page) {\n\t\t\t\t_this80.table.modules.persistence.save(\"page\");\n\t\t\t}\n\t\t} else {\n\t\t\tif (!_this80.progressiveLoad) {\n\t\t\t\tconsole.warn(\"Pagination Error - Next page would be greater than maximum page of \" + _this80.max + \":\", _this80.max + 1);\n\t\t\t}\n\t\t\treject();\n\t\t}\n\t});\n};\n\n//return current page number\nPage.prototype.getPage = function () {\n\treturn this.page;\n};\n\n//return max page number\nPage.prototype.getPageMax = function () {\n\treturn this.max;\n};\n\nPage.prototype.getPageSize = function (size) {\n\treturn this.size;\n};\n\nPage.prototype.getMode = function () {\n\treturn this.mode;\n};\n\n//return appropriate rows for current page\nPage.prototype.getRows = function (data) {\n\tvar output, start, end;\n\n\tif (this.mode == \"local\") {\n\t\toutput = [];\n\n\t\tif (this.size === true) {\n\t\t\tstart = 0;\n\t\t\tend = data.length;\n\t\t} else {\n\t\t\tstart = this.size * (this.page - 1);\n\t\t\tend = start + parseInt(this.size);\n\t\t}\n\n\t\tthis._setPageButtons();\n\n\t\tfor (var _i16 = start; _i16 < end; _i16++) {\n\t\t\tif (data[_i16]) {\n\t\t\t\toutput.push(data[_i16]);\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t} else {\n\n\t\tthis._setPageButtons();\n\n\t\treturn data.slice(0);\n\t}\n};\n\nPage.prototype.trigger = function () {\n\tvar _this81 = this;\n\n\tvar left;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tswitch (_this81.mode) {\n\t\t\tcase \"local\":\n\t\t\t\tleft = _this81.table.rowManager.scrollLeft;\n\n\t\t\t\t_this81.table.rowManager.refreshActiveData(\"page\");\n\t\t\t\t_this81.table.rowManager.scrollHorizontal(left);\n\n\t\t\t\t_this81.table.options.pageLoaded.call(_this81.table, _this81.getPage());\n\t\t\t\tresolve();\n\t\t\t\tbreak;\n\n\t\t\tcase \"remote\":\n\t\t\tcase \"progressive_load\":\n\t\t\tcase \"progressive_scroll\":\n\t\t\t\t_this81.table.modules.ajax.blockActiveRequest();\n\t\t\t\t_this81._getRemotePage().then(function () {\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(function () {\n\t\t\t\t\treject();\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.warn(\"Pagination Error - no such pagination mode:\", _this81.mode);\n\t\t\t\treject();\n\t\t}\n\t});\n};\n\nPage.prototype._getRemotePage = function () {\n\tvar _this82 = this;\n\n\tvar self = this,\n\t    oldParams,\n\t    pageParams;\n\n\treturn new Promise(function (resolve, reject) {\n\n\t\tif (!self.table.modExists(\"ajax\", true)) {\n\t\t\treject();\n\t\t}\n\n\t\t//record old params and restore after request has been made\n\t\toldParams = Tabulator.prototype.helpers.deepClone(self.table.modules.ajax.getParams() || {});\n\t\tpageParams = self.table.modules.ajax.getParams();\n\n\t\t//configure request params\n\t\tpageParams[_this82.dataSentNames.page] = self.page;\n\n\t\t//set page size if defined\n\t\tif (_this82.size) {\n\t\t\tpageParams[_this82.dataSentNames.size] = _this82.size;\n\t\t}\n\n\t\t//set sort data if defined\n\t\tif (_this82.table.options.ajaxSorting && _this82.table.modExists(\"sort\")) {\n\t\t\tvar sorters = self.table.modules.sort.getSort();\n\n\t\t\tsorters.forEach(function (item) {\n\t\t\t\tdelete item.column;\n\t\t\t});\n\n\t\t\tpageParams[_this82.dataSentNames.sorters] = sorters;\n\t\t}\n\n\t\t//set filter data if defined\n\t\tif (_this82.table.options.ajaxFiltering && _this82.table.modExists(\"filter\")) {\n\t\t\tvar filters = self.table.modules.filter.getFilters(true, true);\n\t\t\tpageParams[_this82.dataSentNames.filters] = filters;\n\t\t}\n\n\t\tself.table.modules.ajax.setParams(pageParams);\n\n\t\tself.table.modules.ajax.sendRequest(_this82.progressiveLoad).then(function (data) {\n\t\t\tself._parseRemoteData(data);\n\t\t\tresolve();\n\t\t}).catch(function (e) {\n\t\t\treject();\n\t\t});\n\n\t\tself.table.modules.ajax.setParams(oldParams);\n\t});\n};\n\nPage.prototype._parseRemoteData = function (data) {\n\tvar self = this,\n\t    left,\n\t    data,\n\t    margin;\n\n\tif (typeof data[this.dataReceivedNames.last_page] === \"undefined\") {\n\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + this.dataReceivedNames.last_page + \"' property\");\n\t}\n\n\tif (data[this.dataReceivedNames.data]) {\n\t\tthis.max = parseInt(data[this.dataReceivedNames.last_page]) || 1;\n\n\t\tif (this.progressiveLoad) {\n\t\t\tswitch (this.mode) {\n\t\t\t\tcase \"progressive_load\":\n\n\t\t\t\t\tif (this.page == 1) {\n\t\t\t\t\t\tthis.table.rowManager.setData(data[this.dataReceivedNames.data], false, this.initialLoad && this.page == 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.table.rowManager.addRows(data[this.dataReceivedNames.data]);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.page < this.max) {\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tself.nextPage().then(function () {}).catch(function () {});\n\t\t\t\t\t\t}, self.table.options.ajaxProgressiveLoadDelay);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"progressive_scroll\":\n\t\t\t\t\tdata = this.table.rowManager.getData().concat(data[this.dataReceivedNames.data]);\n\n\t\t\t\t\tthis.table.rowManager.setData(data, true, this.initialLoad && this.page == 1);\n\n\t\t\t\t\tmargin = this.table.options.ajaxProgressiveLoadScrollMargin || this.table.rowManager.element.clientHeight * 2;\n\n\t\t\t\t\tif (self.table.rowManager.element.scrollHeight <= self.table.rowManager.element.clientHeight + margin) {\n\t\t\t\t\t\tself.nextPage().then(function () {}).catch(function () {});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tleft = this.table.rowManager.scrollLeft;\n\n\t\t\tthis.table.rowManager.setData(data[this.dataReceivedNames.data], false, this.initialLoad && this.page == 1);\n\n\t\t\tthis.table.rowManager.scrollHorizontal(left);\n\n\t\t\tthis.table.columnManager.scrollHorizontal(left);\n\n\t\t\tthis.table.options.pageLoaded.call(this.table, this.getPage());\n\t\t}\n\n\t\tthis.initialLoad = false;\n\t} else {\n\t\tconsole.warn(\"Remote Pagination Error - Server response missing '\" + this.dataReceivedNames.data + \"' property\");\n\t}\n};\n\n//handle the footer element being redrawn\nPage.prototype.footerRedraw = function () {\n\tvar footer = this.table.footerManager.element;\n\n\tif (Math.ceil(footer.clientWidth) - footer.scrollWidth < 0) {\n\t\tthis.pagesElement.style.display = 'none';\n\t} else {\n\t\tthis.pagesElement.style.display = '';\n\n\t\tif (Math.ceil(footer.clientWidth) - footer.scrollWidth < 0) {\n\t\t\tthis.pagesElement.style.display = 'none';\n\t\t}\n\t}\n};\n\n//set the paramter names for pagination requests\nPage.prototype.paginationDataSentNames = {\n\t\"page\": \"page\",\n\t\"size\": \"size\",\n\t\"sorters\": \"sorters\",\n\t// \"sort_dir\":\"sort_dir\",\n\t\"filters\": \"filters\"\n\t// \"filter_value\":\"filter_value\",\n\t// \"filter_type\":\"filter_type\",\n};\n\n//set the property names for pagination responses\nPage.prototype.paginationDataReceivedNames = {\n\t\"current_page\": \"current_page\",\n\t\"last_page\": \"last_page\",\n\t\"data\": \"data\"\n};\n\nTabulator.prototype.registerModule(\"page\", Page);\n\nvar Persistence = function Persistence(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.mode = \"\";\n\tthis.id = \"\";\n\t// this.persistProps = [\"field\", \"width\", \"visible\"];\n\tthis.defWatcherBlock = false;\n\tthis.config = {};\n\tthis.readFunc = false;\n\tthis.writeFunc = false;\n};\n\n// Test for whether localStorage is available for use.\nPersistence.prototype.localStorageTest = function () {\n\tvar testKey = \"_tabulator_test\";\n\n\ttry {\n\t\twindow.localStorage.setItem(testKey, testKey);\n\t\twindow.localStorage.removeItem(testKey);\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n\n//setup parameters\nPersistence.prototype.initialize = function () {\n\t//determine persistent layout storage type\n\n\tvar mode = this.table.options.persistenceMode,\n\t    id = this.table.options.persistenceID,\n\t    retreivedData;\n\n\tthis.mode = mode !== true ? mode : this.localStorageTest() ? \"local\" : \"cookie\";\n\n\tif (this.table.options.persistenceReaderFunc) {\n\t\tif (typeof this.table.options.persistenceReaderFunc === \"function\") {\n\t\t\tthis.readFunc = this.table.options.persistenceReaderFunc;\n\t\t} else {\n\t\t\tif (this.readers[this.table.options.persistenceReaderFunc]) {\n\t\t\t\tthis.readFunc = this.readers[this.table.options.persistenceReaderFunc];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.table.options.persistenceReaderFunc);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (this.readers[this.mode]) {\n\t\t\tthis.readFunc = this.readers[this.mode];\n\t\t} else {\n\t\t\tconsole.warn(\"Persistence Read Error - invalid reader set\", this.mode);\n\t\t}\n\t}\n\n\tif (this.table.options.persistenceWriterFunc) {\n\t\tif (typeof this.table.options.persistenceWriterFunc === \"function\") {\n\t\t\tthis.writeFunc = this.table.options.persistenceWriterFunc;\n\t\t} else {\n\t\t\tif (this.readers[this.table.options.persistenceWriterFunc]) {\n\t\t\t\tthis.writeFunc = this.readers[this.table.options.persistenceWriterFunc];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Persistence Write Error - invalid reader set\", this.table.options.persistenceWriterFunc);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (this.writers[this.mode]) {\n\t\t\tthis.writeFunc = this.writers[this.mode];\n\t\t} else {\n\t\t\tconsole.warn(\"Persistence Write Error - invalid writer set\", this.mode);\n\t\t}\n\t}\n\n\t//set storage tag\n\tthis.id = \"tabulator-\" + (id || this.table.element.getAttribute(\"id\") || \"\");\n\n\tthis.config = {\n\t\tsort: this.table.options.persistence === true || this.table.options.persistence.sort,\n\t\tfilter: this.table.options.persistence === true || this.table.options.persistence.filter,\n\t\tgroup: this.table.options.persistence === true || this.table.options.persistence.group,\n\t\tpage: this.table.options.persistence === true || this.table.options.persistence.page,\n\t\tcolumns: this.table.options.persistence === true ? [\"title\", \"width\", \"visible\"] : this.table.options.persistence.columns\n\t};\n\n\t//load pagination data if needed\n\tif (this.config.page) {\n\t\tretreivedData = this.retreiveData(\"page\");\n\n\t\tif (retreivedData) {\n\t\t\tif (typeof retreivedData.paginationSize !== \"undefined\" && (this.config.page === true || this.config.page.size)) {\n\t\t\t\tthis.table.options.paginationSize = retreivedData.paginationSize;\n\t\t\t}\n\n\t\t\tif (typeof retreivedData.paginationInitialPage !== \"undefined\" && (this.config.page === true || this.config.page.page)) {\n\t\t\t\tthis.table.options.paginationInitialPage = retreivedData.paginationInitialPage;\n\t\t\t}\n\t\t}\n\t}\n\n\t//load group data if needed\n\tif (this.config.group) {\n\t\tretreivedData = this.retreiveData(\"group\");\n\n\t\tif (retreivedData) {\n\t\t\tif (typeof retreivedData.groupBy !== \"undefined\" && (this.config.group === true || this.config.group.groupBy)) {\n\t\t\t\tthis.table.options.groupBy = retreivedData.groupBy;\n\t\t\t}\n\t\t\tif (typeof retreivedData.groupStartOpen !== \"undefined\" && (this.config.group === true || this.config.group.groupStartOpen)) {\n\t\t\t\tthis.table.options.groupStartOpen = retreivedData.groupStartOpen;\n\t\t\t}\n\t\t\tif (typeof retreivedData.groupHeader !== \"undefined\" && (this.config.group === true || this.config.group.groupHeader)) {\n\t\t\t\tthis.table.options.groupHeader = retreivedData.groupHeader;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (this.config.columns) {\n\t\tthis.table.options.columns = this.load(\"columns\", this.table.options.columns);\n\t}\n};\n\nPersistence.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    def,\n\t    keys;\n\n\tif (this.config.columns) {\n\t\tthis.defWatcherBlock = true;\n\n\t\tdef = column.getDefinition();\n\n\t\tkeys = this.config.columns === true ? Object.keys(def) : this.config.columns;\n\n\t\tkeys.forEach(function (key) {\n\t\t\tvar props = Object.getOwnPropertyDescriptor(def, key);\n\t\t\tvar value = def[key];\n\t\t\tif (props) {\n\t\t\t\tObject.defineProperty(def, key, {\n\t\t\t\t\tset: function set(newValue) {\n\t\t\t\t\t\tvalue = newValue;\n\n\t\t\t\t\t\tif (!self.defWatcherBlock) {\n\t\t\t\t\t\t\tself.save(\"columns\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (props.set) {\n\t\t\t\t\t\t\tprops.set(newValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tget: function get() {\n\t\t\t\t\t\tif (props.get) {\n\t\t\t\t\t\t\tprops.get();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.defWatcherBlock = false;\n\t}\n};\n\n//load saved definitions\nPersistence.prototype.load = function (type, current) {\n\tvar data = this.retreiveData(type);\n\n\tif (current) {\n\t\tdata = data ? this.mergeDefinition(current, data) : current;\n\t}\n\n\treturn data;\n};\n\n//retreive data from memory\nPersistence.prototype.retreiveData = function (type) {\n\treturn this.readFunc ? this.readFunc(this.id, type) : false;\n};\n\n//merge old and new column definitions\nPersistence.prototype.mergeDefinition = function (oldCols, newCols) {\n\tvar self = this,\n\t    output = [];\n\n\t// oldCols = oldCols || [];\n\tnewCols = newCols || [];\n\n\tnewCols.forEach(function (column, to) {\n\n\t\tvar from = self._findColumn(oldCols, column),\n\t\t    keys;\n\n\t\tif (from) {\n\n\t\t\tif (self.config.columns === true || self.config.columns == undefined) {\n\t\t\t\tkeys = Object.keys(from);\n\t\t\t\tkeys.push(\"width\");\n\t\t\t} else {\n\t\t\t\tkeys = self.config.columns;\n\t\t\t}\n\n\t\t\tkeys.forEach(function (key) {\n\t\t\t\tif (key !== \"columns\" && typeof column[key] !== \"undefined\") {\n\t\t\t\t\tfrom[key] = column[key];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (from.columns) {\n\t\t\t\tfrom.columns = self.mergeDefinition(from.columns, column.columns);\n\t\t\t}\n\n\t\t\toutput.push(from);\n\t\t}\n\t});\n\n\toldCols.forEach(function (column, i) {\n\t\tvar from = self._findColumn(newCols, column);\n\t\tif (!from) {\n\t\t\tif (output.length > i) {\n\t\t\t\toutput.splice(i, 0, column);\n\t\t\t} else {\n\t\t\t\toutput.push(column);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn output;\n};\n\n//find matching columns\nPersistence.prototype._findColumn = function (columns, subject) {\n\tvar type = subject.columns ? \"group\" : subject.field ? \"field\" : \"object\";\n\n\treturn columns.find(function (col) {\n\t\tswitch (type) {\n\t\t\tcase \"group\":\n\t\t\t\treturn col.title === subject.title && col.columns.length === subject.columns.length;\n\t\t\t\tbreak;\n\n\t\t\tcase \"field\":\n\t\t\t\treturn col.field === subject.field;\n\t\t\t\tbreak;\n\n\t\t\tcase \"object\":\n\t\t\t\treturn col === subject;\n\t\t\t\tbreak;\n\t\t}\n\t});\n};\n\n//save data\nPersistence.prototype.save = function (type) {\n\tvar data = {};\n\n\tswitch (type) {\n\t\tcase \"columns\":\n\t\t\tdata = this.parseColumns(this.table.columnManager.getColumns());\n\t\t\tbreak;\n\n\t\tcase \"filter\":\n\t\t\tdata = this.table.modules.filter.getFilters();\n\t\t\tbreak;\n\n\t\tcase \"sort\":\n\t\t\tdata = this.validateSorters(this.table.modules.sort.getSort());\n\t\t\tbreak;\n\n\t\tcase \"group\":\n\t\t\tdata = this.getGroupConfig();\n\t\t\tbreak;\n\n\t\tcase \"page\":\n\t\t\tdata = this.getPageConfig();\n\t\t\tbreak;\n\t}\n\n\tif (this.writeFunc) {\n\t\tthis.writeFunc(this.id, type, data);\n\t}\n};\n\n//ensure sorters contain no function data\nPersistence.prototype.validateSorters = function (data) {\n\tdata.forEach(function (item) {\n\t\titem.column = item.field;\n\t\tdelete item.field;\n\t});\n\n\treturn data;\n};\n\nPersistence.prototype.getGroupConfig = function () {\n\tvar data = {};\n\n\tif (this.config.group) {\n\t\tif (this.config.group === true || this.config.group.groupBy) {\n\t\t\tdata.groupBy = this.table.options.groupBy;\n\t\t}\n\n\t\tif (this.config.group === true || this.config.group.groupStartOpen) {\n\t\t\tdata.groupStartOpen = this.table.options.groupStartOpen;\n\t\t}\n\n\t\tif (this.config.group === true || this.config.group.groupHeader) {\n\t\t\tdata.groupHeader = this.table.options.groupHeader;\n\t\t}\n\t}\n\n\treturn data;\n};\n\nPersistence.prototype.getPageConfig = function () {\n\tvar data = {};\n\n\tif (this.config.page) {\n\t\tif (this.config.page === true || this.config.page.size) {\n\t\t\tdata.paginationSize = this.table.modules.page.getPageSize();\n\t\t}\n\n\t\tif (this.config.page === true || this.config.page.page) {\n\t\t\tdata.paginationInitialPage = this.table.modules.page.getPage();\n\t\t}\n\t}\n\n\treturn data;\n};\n\n//parse columns for data to store\nPersistence.prototype.parseColumns = function (columns) {\n\tvar self = this,\n\t    definitions = [],\n\t    excludedKeys = [\"headerContextMenu\", \"headerMenu\", \"contextMenu\", \"clickMenu\"];\n\n\tcolumns.forEach(function (column) {\n\t\tvar defStore = {},\n\t\t    colDef = column.getDefinition(),\n\t\t    keys;\n\n\t\tif (column.isGroup) {\n\t\t\tdefStore.title = colDef.title;\n\t\t\tdefStore.columns = self.parseColumns(column.getColumns());\n\t\t} else {\n\t\t\tdefStore.field = column.getField();\n\n\t\t\tif (self.config.columns === true || self.config.columns == undefined) {\n\t\t\t\tkeys = Object.keys(colDef);\n\t\t\t\tkeys.push(\"width\");\n\t\t\t} else {\n\t\t\t\tkeys = self.config.columns;\n\t\t\t}\n\n\t\t\tkeys.forEach(function (key) {\n\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"width\":\n\t\t\t\t\t\tdefStore.width = column.getWidth();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"visible\":\n\t\t\t\t\t\tdefStore.visible = column.visible;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (typeof colDef[key] !== \"function\" && excludedKeys.indexOf(key) === -1) {\n\t\t\t\t\t\t\tdefStore[key] = colDef[key];\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tdefinitions.push(defStore);\n\t});\n\n\treturn definitions;\n};\n\n// read peristence information from storage\nPersistence.prototype.readers = {\n\tlocal: function local(id, type) {\n\t\tvar data = localStorage.getItem(id + \"-\" + type);\n\n\t\treturn data ? JSON.parse(data) : false;\n\t},\n\tcookie: function cookie(id, type) {\n\t\tvar cookie = document.cookie,\n\t\t    key = id + \"-\" + type,\n\t\t    cookiePos = cookie.indexOf(key + \"=\"),\n\t\t    end,\n\t\t    data;\n\n\t\t//if cookie exists, decode and load column data into tabulator\n\t\tif (cookiePos > -1) {\n\t\t\tcookie = cookie.substr(cookiePos);\n\n\t\t\tend = cookie.indexOf(\";\");\n\n\t\t\tif (end > -1) {\n\t\t\t\tcookie = cookie.substr(0, end);\n\t\t\t}\n\n\t\t\tdata = cookie.replace(key + \"=\", \"\");\n\t\t}\n\n\t\treturn data ? JSON.parse(data) : false;\n\t}\n};\n\n//write persistence information to storage\nPersistence.prototype.writers = {\n\tlocal: function local(id, type, data) {\n\t\tlocalStorage.setItem(id + \"-\" + type, JSON.stringify(data));\n\t},\n\tcookie: function cookie(id, type, data) {\n\t\tvar expireDate = new Date();\n\n\t\texpireDate.setDate(expireDate.getDate() + 10000);\n\n\t\tdocument.cookie = id + \"-\" + type + \"=\" + JSON.stringify(data) + \"; expires=\" + expireDate.toUTCString();\n\t}\n};\n\nTabulator.prototype.registerModule(\"persistence\", Persistence);\n\nvar Print = function Print(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.element = false;\n\tthis.manualBlock = false;\n};\n\nPrint.prototype.initialize = function () {\n\twindow.addEventListener(\"beforeprint\", this.replaceTable.bind(this));\n\twindow.addEventListener(\"afterprint\", this.cleanup.bind(this));\n};\n\nPrint.prototype.replaceTable = function () {\n\tif (!this.manualBlock) {\n\t\tthis.element = document.createElement(\"div\");\n\t\tthis.element.classList.add(\"tabulator-print-table\");\n\n\t\tthis.element.appendChild(this.table.modules.export.genereateTable(this.table.options.printConfig, this.table.options.printStyled, this.table.options.printRowRange, \"print\"));\n\n\t\tthis.table.element.style.display = \"none\";\n\n\t\tthis.table.element.parentNode.insertBefore(this.element, this.table.element);\n\t}\n};\n\nPrint.prototype.cleanup = function () {\n\tdocument.body.classList.remove(\"tabulator-print-fullscreen-hide\");\n\n\tif (this.element && this.element.parentNode) {\n\t\tthis.element.parentNode.removeChild(this.element);\n\t\tthis.table.element.style.display = \"\";\n\t}\n};\n\nPrint.prototype.printFullscreen = function (visible, style, config) {\n\tvar scrollX = window.scrollX,\n\t    scrollY = window.scrollY,\n\t    headerEl = document.createElement(\"div\"),\n\t    footerEl = document.createElement(\"div\"),\n\t    tableEl = this.table.modules.export.genereateTable(typeof config != \"undefined\" ? config : this.table.options.printConfig, typeof style != \"undefined\" ? style : this.table.options.printStyled, visible, \"print\"),\n\t    headerContent,\n\t    footerContent;\n\n\tthis.manualBlock = true;\n\n\tthis.element = document.createElement(\"div\");\n\tthis.element.classList.add(\"tabulator-print-fullscreen\");\n\n\tif (this.table.options.printHeader) {\n\t\theaderEl.classList.add(\"tabulator-print-header\");\n\n\t\theaderContent = typeof this.table.options.printHeader == \"function\" ? this.table.options.printHeader.call(this.table) : this.table.options.printHeader;\n\n\t\tif (typeof headerContent == \"string\") {\n\t\t\theaderEl.innerHTML = headerContent;\n\t\t} else {\n\t\t\theaderEl.appendChild(headerContent);\n\t\t}\n\n\t\tthis.element.appendChild(headerEl);\n\t}\n\n\tthis.element.appendChild(tableEl);\n\n\tif (this.table.options.printFooter) {\n\t\tfooterEl.classList.add(\"tabulator-print-footer\");\n\n\t\tfooterContent = typeof this.table.options.printFooter == \"function\" ? this.table.options.printFooter.call(this.table) : this.table.options.printFooter;\n\n\t\tif (typeof footerContent == \"string\") {\n\t\t\tfooterEl.innerHTML = footerContent;\n\t\t} else {\n\t\t\tfooterEl.appendChild(footerContent);\n\t\t}\n\n\t\tthis.element.appendChild(footerEl);\n\t}\n\n\tdocument.body.classList.add(\"tabulator-print-fullscreen-hide\");\n\tdocument.body.appendChild(this.element);\n\n\tif (this.table.options.printFormatter) {\n\t\tthis.table.options.printFormatter(this.element, tableEl);\n\t}\n\n\twindow.print();\n\n\tthis.cleanup();\n\n\twindow.scrollTo(scrollX, scrollY);\n\n\tthis.manualBlock = false;\n};\n\nTabulator.prototype.registerModule(\"print\", Print);\nvar ReactiveData = function ReactiveData(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.data = false;\n\tthis.blocked = false; //block reactivity while performing update\n\tthis.origFuncs = {}; // hold original data array functions to allow replacement after data is done with\n\tthis.currentVersion = 0;\n};\n\nReactiveData.prototype.watchData = function (data) {\n\tvar self = this,\n\t    pushFunc,\n\t    version;\n\n\tthis.currentVersion++;\n\n\tversion = this.currentVersion;\n\n\tself.unwatchData();\n\n\tself.data = data;\n\n\t//override array push function\n\tself.origFuncs.push = data.push;\n\n\tObject.defineProperty(self.data, \"push\", {\n\t\tenumerable: false,\n\t\tconfigurable: true,\n\t\tvalue: function value() {\n\t\t\tvar args = Array.from(arguments);\n\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\t\t\t\targs.forEach(function (arg) {\n\t\t\t\t\tself.table.rowManager.addRowActual(arg, false);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn self.origFuncs.push.apply(data, arguments);\n\t\t}\n\t});\n\n\t//override array unshift function\n\tself.origFuncs.unshift = data.unshift;\n\n\tObject.defineProperty(self.data, \"unshift\", {\n\t\tenumerable: false,\n\t\tconfigurable: true,\n\t\tvalue: function value() {\n\t\t\tvar args = Array.from(arguments);\n\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\t\t\t\targs.forEach(function (arg) {\n\t\t\t\t\tself.table.rowManager.addRowActual(arg, true);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn self.origFuncs.unshift.apply(data, arguments);\n\t\t}\n\t});\n\n\t//override array shift function\n\tself.origFuncs.shift = data.shift;\n\n\tObject.defineProperty(self.data, \"shift\", {\n\t\tenumerable: false,\n\t\tconfigurable: true,\n\t\tvalue: function value() {\n\t\t\tvar row;\n\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\t\t\t\tif (self.data.length) {\n\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[0]);\n\n\t\t\t\t\tif (row) {\n\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn self.origFuncs.shift.call(data);\n\t\t}\n\t});\n\n\t//override array pop function\n\tself.origFuncs.pop = data.pop;\n\n\tObject.defineProperty(self.data, \"pop\", {\n\t\tenumerable: false,\n\t\tconfigurable: true,\n\t\tvalue: function value() {\n\t\t\tvar row;\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\t\t\t\tif (self.data.length) {\n\t\t\t\t\trow = self.table.rowManager.getRowFromDataObject(self.data[self.data.length - 1]);\n\n\t\t\t\t\tif (row) {\n\t\t\t\t\t\trow.deleteActual();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn self.origFuncs.pop.call(data);\n\t\t}\n\t});\n\n\t//override array splice function\n\tself.origFuncs.splice = data.splice;\n\n\tObject.defineProperty(self.data, \"splice\", {\n\t\tenumerable: false,\n\t\tconfigurable: true,\n\t\tvalue: function value() {\n\t\t\tvar args = Array.from(arguments),\n\t\t\t    start = args[0] < 0 ? data.length + args[0] : args[0],\n\t\t\t    end = args[1],\n\t\t\t    newRows = args[2] ? args.slice(2) : false,\n\t\t\t    startRow;\n\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\n\t\t\t\t//add new rows\n\t\t\t\tif (newRows) {\n\t\t\t\t\tstartRow = data[start] ? self.table.rowManager.getRowFromDataObject(data[start]) : false;\n\n\t\t\t\t\tif (startRow) {\n\t\t\t\t\t\tnewRows.forEach(function (rowData) {\n\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, startRow, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewRows = newRows.slice().reverse();\n\n\t\t\t\t\t\tnewRows.forEach(function (rowData) {\n\t\t\t\t\t\t\tself.table.rowManager.addRowActual(rowData, true, false, true);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//delete removed rows\n\t\t\t\tif (end !== 0) {\n\t\t\t\t\tvar oldRows = data.slice(start, typeof args[1] === \"undefined\" ? args[1] : start + end);\n\n\t\t\t\t\toldRows.forEach(function (rowData, i) {\n\t\t\t\t\t\tvar row = self.table.rowManager.getRowFromDataObject(rowData);\n\n\t\t\t\t\t\tif (row) {\n\t\t\t\t\t\t\trow.deleteActual(i !== oldRows.length - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (newRows || end !== 0) {\n\t\t\t\t\tself.table.rowManager.reRenderInPosition();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn self.origFuncs.splice.apply(data, arguments);\n\t\t}\n\t});\n};\n\nReactiveData.prototype.unwatchData = function () {\n\tif (this.data !== false) {\n\t\tfor (var key in this.origFuncs) {\n\t\t\tObject.defineProperty(this.data, key, {\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true,\n\t\t\t\twritable: true,\n\t\t\t\tvalue: this.origFuncs.key\n\t\t\t});\n\t\t}\n\t}\n};\n\nReactiveData.prototype.watchRow = function (row) {\n\tvar data = row.getData();\n\n\tthis.blocked = true;\n\n\tfor (var key in data) {\n\t\tthis.watchKey(row, data, key);\n\t}\n\n\tif (this.table.options.dataTree) {\n\t\tthis.watchTreeChildren(row);\n\t}\n\n\tthis.blocked = false;\n};\n\nReactiveData.prototype.watchTreeChildren = function (row) {\n\tvar self = this,\n\t    childField = row.getData()[this.table.options.dataTreeChildField],\n\t    origFuncs = {};\n\n\tfunction rebuildTree() {\n\t\tself.table.modules.dataTree.initializeRow(row);\n\t\tself.table.modules.dataTree.layoutRow(row);\n\t\tself.table.rowManager.refreshActiveData(\"tree\", false, true);\n\t}\n\n\tif (childField) {\n\n\t\torigFuncs.push = childField.push;\n\n\t\tObject.defineProperty(childField, \"push\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function value() {\n\t\t\t\tvar result = origFuncs.push.apply(childField, arguments);\n\n\t\t\t\trebuildTree();\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\n\t\torigFuncs.unshift = childField.unshift;\n\n\t\tObject.defineProperty(childField, \"unshift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function value() {\n\t\t\t\tvar result = origFuncs.unshift.apply(childField, arguments);\n\n\t\t\t\trebuildTree();\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\n\t\torigFuncs.shift = childField.shift;\n\n\t\tObject.defineProperty(childField, \"shift\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function value() {\n\t\t\t\tvar result = origFuncs.shift.call(childField);\n\n\t\t\t\trebuildTree();\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\n\t\torigFuncs.pop = childField.pop;\n\n\t\tObject.defineProperty(childField, \"pop\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function value() {\n\t\t\t\tvar result = origFuncs.pop.call(childField);\n\n\t\t\t\trebuildTree();\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\n\t\torigFuncs.splice = childField.splice;\n\n\t\tObject.defineProperty(childField, \"splice\", {\n\t\t\tenumerable: false,\n\t\t\tconfigurable: true,\n\t\t\tvalue: function value() {\n\t\t\t\tvar result = origFuncs.splice.apply(childField, arguments);\n\n\t\t\t\trebuildTree();\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t}\n};\n\nReactiveData.prototype.watchKey = function (row, data, key) {\n\tvar self = this,\n\t    props = Object.getOwnPropertyDescriptor(data, key),\n\t    value = data[key],\n\t    version = this.currentVersion;\n\n\tObject.defineProperty(data, key, {\n\t\tset: function set(newValue) {\n\t\t\tvalue = newValue;\n\t\t\tif (!self.blocked && version === self.currentVersion) {\n\t\t\t\tvar update = {};\n\t\t\t\tupdate[key] = newValue;\n\t\t\t\trow.updateData(update);\n\t\t\t}\n\n\t\t\tif (props.set) {\n\t\t\t\tprops.set(newValue);\n\t\t\t}\n\t\t},\n\t\tget: function get() {\n\n\t\t\tif (props.get) {\n\t\t\t\tprops.get();\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\t});\n};\n\nReactiveData.prototype.unwatchRow = function (row) {\n\tvar data = row.getData();\n\n\tfor (var key in data) {\n\t\tObject.defineProperty(data, key, {\n\t\t\tvalue: data[key]\n\t\t});\n\t}\n};\n\nReactiveData.prototype.block = function () {\n\tthis.blocked = true;\n};\n\nReactiveData.prototype.unblock = function () {\n\tthis.blocked = false;\n};\n\nTabulator.prototype.registerModule(\"reactiveData\", ReactiveData);\n\nvar ResizeColumns = function ResizeColumns(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.startColumn = false;\n\tthis.startX = false;\n\tthis.startWidth = false;\n\tthis.handle = null;\n\tthis.prevHandle = null;\n};\n\nResizeColumns.prototype.initializeColumn = function (type, column, element) {\n\tvar self = this,\n\t    variableHeight = false,\n\t    mode = this.table.options.resizableColumns;\n\n\t//set column resize mode\n\tif (type === \"header\") {\n\t\tvariableHeight = column.definition.formatter == \"textarea\" || column.definition.variableHeight;\n\t\tcolumn.modules.resize = { variableHeight: variableHeight };\n\t}\n\n\tif (mode === true || mode == type) {\n\n\t\tvar handle = document.createElement('div');\n\t\thandle.className = \"tabulator-col-resize-handle\";\n\n\t\tvar prevHandle = document.createElement('div');\n\t\tprevHandle.className = \"tabulator-col-resize-handle prev\";\n\n\t\thandle.addEventListener(\"click\", function (e) {\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar handleDown = function handleDown(e) {\n\t\t\tvar nearestColumn = column.getLastColumn();\n\n\t\t\tif (nearestColumn && self._checkResizability(nearestColumn)) {\n\t\t\t\tself.startColumn = column;\n\t\t\t\tself._mouseDown(e, nearestColumn, handle);\n\t\t\t}\n\t\t};\n\n\t\thandle.addEventListener(\"mousedown\", handleDown);\n\t\thandle.addEventListener(\"touchstart\", handleDown, { passive: true });\n\n\t\t//reszie column on  double click\n\t\thandle.addEventListener(\"dblclick\", function (e) {\n\t\t\tvar col = column.getLastColumn();\n\n\t\t\tif (col && self._checkResizability(col)) {\n\t\t\t\te.stopPropagation();\n\t\t\t\tcol.reinitializeWidth(true);\n\t\t\t}\n\t\t});\n\n\t\tprevHandle.addEventListener(\"click\", function (e) {\n\t\t\te.stopPropagation();\n\t\t});\n\n\t\tvar prevHandleDown = function prevHandleDown(e) {\n\t\t\tvar nearestColumn, colIndex, prevColumn;\n\n\t\t\tnearestColumn = column.getFirstColumn();\n\n\t\t\tif (nearestColumn) {\n\t\t\t\tcolIndex = self.table.columnManager.findColumnIndex(nearestColumn);\n\t\t\t\tprevColumn = colIndex > 0 ? self.table.columnManager.getColumnByIndex(colIndex - 1) : false;\n\n\t\t\t\tif (prevColumn && self._checkResizability(prevColumn)) {\n\t\t\t\t\tself.startColumn = column;\n\t\t\t\t\tself._mouseDown(e, prevColumn, prevHandle);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tprevHandle.addEventListener(\"mousedown\", prevHandleDown);\n\t\tprevHandle.addEventListener(\"touchstart\", prevHandleDown, { passive: true });\n\n\t\t//resize column on double click\n\t\tprevHandle.addEventListener(\"dblclick\", function (e) {\n\t\t\tvar nearestColumn, colIndex, prevColumn;\n\n\t\t\tnearestColumn = column.getFirstColumn();\n\n\t\t\tif (nearestColumn) {\n\t\t\t\tcolIndex = self.table.columnManager.findColumnIndex(nearestColumn);\n\t\t\t\tprevColumn = colIndex > 0 ? self.table.columnManager.getColumnByIndex(colIndex - 1) : false;\n\n\t\t\t\tif (prevColumn && self._checkResizability(prevColumn)) {\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t\tprevColumn.reinitializeWidth(true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.appendChild(handle);\n\t\telement.appendChild(prevHandle);\n\t}\n};\n\nResizeColumns.prototype._checkResizability = function (column) {\n\treturn typeof column.definition.resizable != \"undefined\" ? column.definition.resizable : this.table.options.resizableColumns;\n};\n\nResizeColumns.prototype._mouseDown = function (e, column, handle) {\n\tvar self = this;\n\n\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\tfunction mouseMove(e) {\n\t\t// self.table.columnManager.tempScrollBlock();\n\n\t\tif (self.table.rtl) {\n\t\t\tcolumn.setWidth(self.startWidth - ((typeof e.screenX === \"undefined\" ? e.touches[0].screenX : e.screenX) - self.startX));\n\t\t} else {\n\t\t\tcolumn.setWidth(self.startWidth + ((typeof e.screenX === \"undefined\" ? e.touches[0].screenX : e.screenX) - self.startX));\n\t\t}\n\n\t\tif (self.table.options.virtualDomHoz) {\n\t\t\tself.table.vdomHoz.reinitialize(true);\n\t\t}\n\n\t\tif (!self.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight) {\n\t\t\tcolumn.checkCellHeights();\n\t\t}\n\t}\n\n\tfunction mouseUp(e) {\n\n\t\t//block editor from taking action while resizing is taking place\n\t\tif (self.startColumn.modules.edit) {\n\t\t\tself.startColumn.modules.edit.blocked = false;\n\t\t}\n\n\t\tif (self.table.browserSlow && column.modules.resize && column.modules.resize.variableHeight) {\n\t\t\tcolumn.checkCellHeights();\n\t\t}\n\n\t\tdocument.body.removeEventListener(\"mouseup\", mouseUp);\n\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\n\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\n\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\tif (self.table.options.persistence && self.table.modExists(\"persistence\", true) && self.table.modules.persistence.config.columns) {\n\t\t\tself.table.modules.persistence.save(\"columns\");\n\t\t}\n\n\t\tself.table.options.columnResized.call(self.table, column.getComponent());\n\t}\n\n\te.stopPropagation(); //prevent resize from interfereing with movable columns\n\n\t//block editor from taking action while resizing is taking place\n\tif (self.startColumn.modules.edit) {\n\t\tself.startColumn.modules.edit.blocked = true;\n\t}\n\n\tself.startX = typeof e.screenX === \"undefined\" ? e.touches[0].screenX : e.screenX;\n\tself.startWidth = column.getWidth();\n\n\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\thandle.addEventListener(\"touchmove\", mouseMove, { passive: true });\n\thandle.addEventListener(\"touchend\", mouseUp);\n};\n\nTabulator.prototype.registerModule(\"resizeColumns\", ResizeColumns);\nvar ResizeRows = function ResizeRows(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.startColumn = false;\n\tthis.startY = false;\n\tthis.startHeight = false;\n\tthis.handle = null;\n\tthis.prevHandle = null;\n};\n\nResizeRows.prototype.initializeRow = function (row) {\n\tvar self = this,\n\t    rowEl = row.getElement();\n\n\tvar handle = document.createElement('div');\n\thandle.className = \"tabulator-row-resize-handle\";\n\n\tvar prevHandle = document.createElement('div');\n\tprevHandle.className = \"tabulator-row-resize-handle prev\";\n\n\thandle.addEventListener(\"click\", function (e) {\n\t\te.stopPropagation();\n\t});\n\n\tvar handleDown = function handleDown(e) {\n\t\tself.startRow = row;\n\t\tself._mouseDown(e, row, handle);\n\t};\n\n\thandle.addEventListener(\"mousedown\", handleDown);\n\thandle.addEventListener(\"touchstart\", handleDown, { passive: true });\n\n\tprevHandle.addEventListener(\"click\", function (e) {\n\t\te.stopPropagation();\n\t});\n\n\tvar prevHandleDown = function prevHandleDown(e) {\n\t\tvar prevRow = self.table.rowManager.prevDisplayRow(row);\n\n\t\tif (prevRow) {\n\t\t\tself.startRow = prevRow;\n\t\t\tself._mouseDown(e, prevRow, prevHandle);\n\t\t}\n\t};\n\n\tprevHandle.addEventListener(\"mousedown\", prevHandleDown);\n\tprevHandle.addEventListener(\"touchstart\", prevHandleDown, { passive: true });\n\n\trowEl.appendChild(handle);\n\trowEl.appendChild(prevHandle);\n};\n\nResizeRows.prototype._mouseDown = function (e, row, handle) {\n\tvar self = this;\n\n\tself.table.element.classList.add(\"tabulator-block-select\");\n\n\tfunction mouseMove(e) {\n\t\trow.setHeight(self.startHeight + ((typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY) - self.startY));\n\t}\n\n\tfunction mouseUp(e) {\n\n\t\t// //block editor from taking action while resizing is taking place\n\t\t// if(self.startColumn.modules.edit){\n\t\t// \tself.startColumn.modules.edit.blocked = false;\n\t\t// }\n\n\t\tdocument.body.removeEventListener(\"mouseup\", mouseMove);\n\t\tdocument.body.removeEventListener(\"mousemove\", mouseMove);\n\n\t\thandle.removeEventListener(\"touchmove\", mouseMove);\n\t\thandle.removeEventListener(\"touchend\", mouseUp);\n\n\t\tself.table.element.classList.remove(\"tabulator-block-select\");\n\n\t\tself.table.options.rowResized.call(this.table, row.getComponent());\n\t}\n\n\te.stopPropagation(); //prevent resize from interfereing with movable columns\n\n\t//block editor from taking action while resizing is taking place\n\t// if(self.startColumn.modules.edit){\n\t// \tself.startColumn.modules.edit.blocked = true;\n\t// }\n\n\tself.startY = typeof e.screenY === \"undefined\" ? e.touches[0].screenY : e.screenY;\n\tself.startHeight = row.getHeight();\n\n\tdocument.body.addEventListener(\"mousemove\", mouseMove);\n\tdocument.body.addEventListener(\"mouseup\", mouseUp);\n\n\thandle.addEventListener(\"touchmove\", mouseMove, { passive: true });\n\thandle.addEventListener(\"touchend\", mouseUp);\n};\n\nTabulator.prototype.registerModule(\"resizeRows\", ResizeRows);\nvar ResizeTable = function ResizeTable(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.binding = false;\n\tthis.observer = false;\n\tthis.containerObserver = false;\n\n\tthis.tableHeight = 0;\n\tthis.tableWidth = 0;\n\tthis.containerHeight = 0;\n\tthis.containerWidth = 0;\n\n\tthis.autoResize = false;\n};\n\nResizeTable.prototype.initialize = function (row) {\n\tvar _this83 = this;\n\n\tvar table = this.table,\n\t    tableStyle;\n\n\tthis.tableHeight = table.element.clientHeight;\n\tthis.tableWidth = table.element.clientWidth;\n\n\tif (table.element.parentNode) {\n\t\tthis.containerHeight = table.element.parentNode.clientHeight;\n\t\tthis.containerWidth = table.element.parentNode.clientWidth;\n\t}\n\n\tif (typeof ResizeObserver !== \"undefined\" && table.rowManager.getRenderMode() === \"virtual\") {\n\n\t\tthis.autoResize = true;\n\n\t\tthis.observer = new ResizeObserver(function (entry) {\n\t\t\tif (!table.browserMobile || table.browserMobile && !table.modules.edit.currentCell) {\n\n\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\n\t\t\t\tif (_this83.tableHeight != nodeHeight || _this83.tableWidth != nodeWidth) {\n\t\t\t\t\t_this83.tableHeight = nodeHeight;\n\t\t\t\t\t_this83.tableWidth = nodeWidth;\n\n\t\t\t\t\tif (table.element.parentNode) {\n\t\t\t\t\t\t_this83.containerHeight = table.element.parentNode.clientHeight;\n\t\t\t\t\t\t_this83.containerWidth = table.element.parentNode.clientWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (table.options.virtualDomHoz) {\n\t\t\t\t\t\ttable.vdomHoz.reinitialize(true);\n\t\t\t\t\t}\n\n\t\t\t\t\ttable.redraw();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.observer.observe(table.element);\n\n\t\ttableStyle = window.getComputedStyle(table.element);\n\n\t\tif (this.table.element.parentNode && !this.table.rowManager.fixedHeight && (tableStyle.getPropertyValue(\"max-height\") || tableStyle.getPropertyValue(\"min-height\"))) {\n\n\t\t\tthis.containerObserver = new ResizeObserver(function (entry) {\n\t\t\t\tif (!table.browserMobile || table.browserMobile && !table.modules.edit.currentCell) {\n\n\t\t\t\t\tvar nodeHeight = Math.floor(entry[0].contentRect.height);\n\t\t\t\t\tvar nodeWidth = Math.floor(entry[0].contentRect.width);\n\n\t\t\t\t\tif (_this83.containerHeight != nodeHeight || _this83.containerWidth != nodeWidth) {\n\t\t\t\t\t\t_this83.containerHeight = nodeHeight;\n\t\t\t\t\t\t_this83.containerWidth = nodeWidth;\n\t\t\t\t\t\t_this83.tableHeight = table.element.clientHeight;\n\t\t\t\t\t\t_this83.tableWidth = table.element.clientWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (table.options.virtualDomHoz) {\n\t\t\t\t\t\ttable.vdomHoz.reinitialize(true);\n\t\t\t\t\t}\n\n\t\t\t\t\ttable.redraw();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.containerObserver.observe(this.table.element.parentNode);\n\t\t}\n\t} else {\n\t\tthis.binding = function () {\n\t\t\tif (!table.browserMobile || table.browserMobile && !table.modules.edit.currentCell) {\n\t\t\t\tif (table.options.virtualDomHoz) {\n\t\t\t\t\ttable.vdomHoz.reinitialize(true);\n\t\t\t\t}\n\n\t\t\t\ttable.redraw();\n\t\t\t}\n\t\t};\n\n\t\twindow.addEventListener(\"resize\", this.binding);\n\t}\n};\n\nResizeTable.prototype.clearBindings = function (row) {\n\tif (this.binding) {\n\t\twindow.removeEventListener(\"resize\", this.binding);\n\t}\n\n\tif (this.observer) {\n\t\tthis.observer.unobserve(this.table.element);\n\t}\n\n\tif (this.containerObserver) {\n\t\tthis.containerObserver.unobserve(this.table.element.parentNode);\n\t}\n};\n\nTabulator.prototype.registerModule(\"resizeTable\", ResizeTable);\nvar ResponsiveLayout = function ResponsiveLayout(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.columns = [];\n\tthis.hiddenColumns = [];\n\tthis.mode = \"\";\n\tthis.index = 0;\n\tthis.collapseFormatter = [];\n\tthis.collapseStartOpen = true;\n\tthis.collapseHandleColumn = false;\n};\n\n//generate resposive columns list\nResponsiveLayout.prototype.initialize = function () {\n\tvar self = this,\n\t    columns = [];\n\n\tthis.mode = this.table.options.responsiveLayout;\n\tthis.collapseFormatter = this.table.options.responsiveLayoutCollapseFormatter || this.formatCollapsedData;\n\tthis.collapseStartOpen = this.table.options.responsiveLayoutCollapseStartOpen;\n\tthis.hiddenColumns = [];\n\n\t//detemine level of responsivity for each column\n\tthis.table.columnManager.columnsByIndex.forEach(function (column, i) {\n\t\tif (column.modules.responsive) {\n\t\t\tif (column.modules.responsive.order && column.modules.responsive.visible) {\n\t\t\t\tcolumn.modules.responsive.index = i;\n\t\t\t\tcolumns.push(column);\n\n\t\t\t\tif (!column.visible && self.mode === \"collapse\") {\n\t\t\t\t\tself.hiddenColumns.push(column);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t//sort list by responsivity\n\tcolumns = columns.reverse();\n\tcolumns = columns.sort(function (a, b) {\n\t\tvar diff = b.modules.responsive.order - a.modules.responsive.order;\n\t\treturn diff || b.modules.responsive.index - a.modules.responsive.index;\n\t});\n\n\tthis.columns = columns;\n\n\tif (this.mode === \"collapse\") {\n\t\tthis.generateCollapsedContent();\n\t}\n\n\t//assign collapse column\n\tfor (var _iterator = this.table.columnManager.columnsByIndex, _isArray = Array.isArray(_iterator), _i17 = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n\t\tvar _ref;\n\n\t\tif (_isArray) {\n\t\t\tif (_i17 >= _iterator.length) break;\n\t\t\t_ref = _iterator[_i17++];\n\t\t} else {\n\t\t\t_i17 = _iterator.next();\n\t\t\tif (_i17.done) break;\n\t\t\t_ref = _i17.value;\n\t\t}\n\n\t\tvar col = _ref;\n\n\t\tif (col.definition.formatter == \"responsiveCollapse\") {\n\t\t\tthis.collapseHandleColumn = col;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (this.collapseHandleColumn) {\n\t\tif (this.hiddenColumns.length) {\n\t\t\tthis.collapseHandleColumn.show();\n\t\t} else {\n\t\t\tthis.collapseHandleColumn.hide();\n\t\t}\n\t}\n};\n\n//define layout information\nResponsiveLayout.prototype.initializeColumn = function (column) {\n\tvar def = column.getDefinition();\n\n\tcolumn.modules.responsive = { order: typeof def.responsive === \"undefined\" ? 1 : def.responsive, visible: def.visible === false ? false : true };\n};\n\nResponsiveLayout.prototype.initializeRow = function (row) {\n\tvar el;\n\n\tif (row.type !== \"calc\") {\n\t\tel = document.createElement(\"div\");\n\t\tel.classList.add(\"tabulator-responsive-collapse\");\n\n\t\trow.modules.responsiveLayout = {\n\t\t\telement: el,\n\t\t\topen: this.collapseStartOpen\n\t\t};\n\n\t\tif (!this.collapseStartOpen) {\n\t\t\tel.style.display = 'none';\n\t\t}\n\t}\n};\n\nResponsiveLayout.prototype.layoutRow = function (row) {\n\tvar rowEl = row.getElement();\n\n\tif (row.modules.responsiveLayout) {\n\t\trowEl.appendChild(row.modules.responsiveLayout.element);\n\t\tthis.generateCollapsedRowContent(row);\n\t}\n};\n\n//update column visibility\nResponsiveLayout.prototype.updateColumnVisibility = function (column, visible) {\n\tvar index;\n\tif (column.modules.responsive) {\n\t\tcolumn.modules.responsive.visible = visible;\n\t\tthis.initialize();\n\t}\n};\n\nResponsiveLayout.prototype.hideColumn = function (column) {\n\tvar colCount = this.hiddenColumns.length;\n\n\tcolumn.hide(false, true);\n\n\tif (this.mode === \"collapse\") {\n\t\tthis.hiddenColumns.unshift(column);\n\t\tthis.generateCollapsedContent();\n\n\t\tif (this.collapseHandleColumn && !colCount) {\n\t\t\tthis.collapseHandleColumn.show();\n\t\t}\n\t}\n};\n\nResponsiveLayout.prototype.showColumn = function (column) {\n\tvar index;\n\n\tcolumn.show(false, true);\n\t//set column width to prevent calculation loops on uninitialized columns\n\tcolumn.setWidth(column.getWidth());\n\n\tif (this.mode === \"collapse\") {\n\t\tindex = this.hiddenColumns.indexOf(column);\n\n\t\tif (index > -1) {\n\t\t\tthis.hiddenColumns.splice(index, 1);\n\t\t}\n\n\t\tthis.generateCollapsedContent();\n\n\t\tif (this.collapseHandleColumn && !this.hiddenColumns.length) {\n\t\t\tthis.collapseHandleColumn.hide();\n\t\t}\n\t}\n};\n\n//redraw columns to fit space\nResponsiveLayout.prototype.update = function () {\n\tvar self = this,\n\t    working = true;\n\n\twhile (working) {\n\n\t\tvar width = self.table.modules.layout.getMode() == \"fitColumns\" ? self.table.columnManager.getFlexBaseWidth() : self.table.columnManager.getWidth();\n\n\t\tvar diff = (self.table.options.headerVisible ? self.table.columnManager.element.clientWidth : self.table.element.clientWidth) - width;\n\n\t\tif (diff < 0) {\n\t\t\t//table is too wide\n\t\t\tvar column = self.columns[self.index];\n\n\t\t\tif (column) {\n\t\t\t\tself.hideColumn(column);\n\t\t\t\tself.index++;\n\t\t\t} else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t} else {\n\n\t\t\t//table has spare space\n\t\t\tvar _column = self.columns[self.index - 1];\n\n\t\t\tif (_column) {\n\t\t\t\tif (diff > 0) {\n\t\t\t\t\tif (diff >= _column.getWidth()) {\n\t\t\t\t\t\tself.showColumn(_column);\n\t\t\t\t\t\tself.index--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tworking = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tworking = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tworking = false;\n\t\t\t}\n\t\t}\n\n\t\tif (!self.table.rowManager.activeRowsCount) {\n\t\t\tself.table.rowManager.renderEmptyScroll();\n\t\t}\n\t}\n};\n\nResponsiveLayout.prototype.generateCollapsedContent = function () {\n\tvar self = this,\n\t    rows = this.table.rowManager.getDisplayRows();\n\n\trows.forEach(function (row) {\n\t\tself.generateCollapsedRowContent(row);\n\t});\n};\n\nResponsiveLayout.prototype.generateCollapsedRowContent = function (row) {\n\tvar el, contents;\n\n\tif (row.modules.responsiveLayout) {\n\t\tel = row.modules.responsiveLayout.element;\n\n\t\twhile (el.firstChild) {\n\t\t\tel.removeChild(el.firstChild);\n\t\t}contents = this.collapseFormatter(this.generateCollapsedRowData(row));\n\t\tif (contents) {\n\t\t\tel.appendChild(contents);\n\t\t}\n\t}\n};\n\nResponsiveLayout.prototype.generateCollapsedRowData = function (row) {\n\tvar self = this,\n\t    data = row.getData(),\n\t    output = [],\n\t    mockCellComponent;\n\n\tthis.hiddenColumns.forEach(function (column) {\n\t\tvar value = column.getFieldValue(data);\n\n\t\tif (column.definition.title && column.field) {\n\t\t\tif (column.modules.format && self.table.options.responsiveLayoutCollapseUseFormatters) {\n\n\t\t\t\tmockCellComponent = {\n\t\t\t\t\tvalue: false,\n\t\t\t\t\tdata: {},\n\t\t\t\t\tgetValue: function getValue() {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t},\n\t\t\t\t\tgetData: function getData() {\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t},\n\t\t\t\t\tgetElement: function getElement() {\n\t\t\t\t\t\treturn document.createElement(\"div\");\n\t\t\t\t\t},\n\t\t\t\t\tgetRow: function getRow() {\n\t\t\t\t\t\treturn row.getComponent();\n\t\t\t\t\t},\n\t\t\t\t\tgetColumn: function getColumn() {\n\t\t\t\t\t\treturn column.getComponent();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\toutput.push({\n\t\t\t\t\tfield: column.field,\n\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\tvalue: column.modules.format.formatter.call(self.table.modules.format, mockCellComponent, column.modules.format.params)\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\toutput.push({\n\t\t\t\t\tfield: column.field,\n\t\t\t\t\ttitle: column.definition.title,\n\t\t\t\t\tvalue: value\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\treturn output;\n};\n\nResponsiveLayout.prototype.formatCollapsedData = function (data) {\n\tvar list = document.createElement(\"table\");\n\n\tdata.forEach(function (item) {\n\t\tvar row = document.createElement(\"tr\");\n\t\tvar titleData = document.createElement(\"td\");\n\t\tvar valueData = document.createElement(\"td\");\n\t\tvar node_content;\n\n\t\tvar titleHighlight = document.createElement(\"strong\");\n\t\ttitleData.appendChild(titleHighlight);\n\t\tthis.table.modules.localize.bind(\"columns|\" + item.field, function (text) {\n\t\t\ttitleHighlight.innerText = text || item.title;\n\t\t});\n\n\t\tif (item.value instanceof Node) {\n\t\t\tnode_content = document.createElement(\"div\");\n\t\t\tnode_content.appendChild(item.value);\n\t\t\tvalueData.appendChild(node_content);\n\t\t} else {\n\t\t\tvalueData.innerHTML = item.value;\n\t\t}\n\n\t\trow.appendChild(titleData);\n\t\trow.appendChild(valueData);\n\t\tlist.appendChild(row);\n\t}, this);\n\n\treturn Object.keys(data).length ? list : \"\";\n};\n\nTabulator.prototype.registerModule(\"responsiveLayout\", ResponsiveLayout);\n\nvar SelectRow = function SelectRow(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.selecting = false; //flag selecting in progress\n\tthis.lastClickedRow = false; //last clicked row\n\tthis.selectPrev = []; //hold previously selected element for drag drop selection\n\tthis.selectedRows = []; //hold selected rows\n\tthis.headerCheckboxElement = null; // hold header select element\n};\n\nSelectRow.prototype.clearSelectionData = function (silent) {\n\tthis.selecting = false;\n\tthis.lastClickedRow = false;\n\tthis.selectPrev = [];\n\tthis.selectedRows = [];\n\n\tif (!silent) {\n\t\tthis._rowSelectionChanged();\n\t}\n};\n\nSelectRow.prototype.initializeRow = function (row) {\n\tvar self = this,\n\t    element = row.getElement();\n\n\t// trigger end of row selection\n\tvar endSelect = function endSelect() {\n\n\t\tsetTimeout(function () {\n\t\t\tself.selecting = false;\n\t\t}, 50);\n\n\t\tdocument.body.removeEventListener(\"mouseup\", endSelect);\n\t};\n\n\trow.modules.select = { selected: false };\n\n\t//set row selection class\n\tif (self.table.options.selectableCheck.call(this.table, row.getComponent())) {\n\t\telement.classList.add(\"tabulator-selectable\");\n\t\telement.classList.remove(\"tabulator-unselectable\");\n\n\t\tif (self.table.options.selectable && self.table.options.selectable != \"highlight\") {\n\t\t\tif (self.table.options.selectableRangeMode === \"click\") {\n\t\t\t\telement.addEventListener(\"click\", function (e) {\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\tself.lastClickedRow = self.lastClickedRow || row;\n\n\t\t\t\t\t\tvar lastClickedRowIdx = self.table.rowManager.getDisplayRowIndex(self.lastClickedRow);\n\t\t\t\t\t\tvar rowIdx = self.table.rowManager.getDisplayRowIndex(row);\n\n\t\t\t\t\t\tvar fromRowIdx = lastClickedRowIdx <= rowIdx ? lastClickedRowIdx : rowIdx;\n\t\t\t\t\t\tvar toRowIdx = lastClickedRowIdx >= rowIdx ? lastClickedRowIdx : rowIdx;\n\n\t\t\t\t\t\tvar rows = self.table.rowManager.getDisplayRows().slice(0);\n\t\t\t\t\t\tvar toggledRows = rows.splice(fromRowIdx, toRowIdx - fromRowIdx + 1);\n\n\t\t\t\t\t\tif (e.ctrlKey || e.metaKey) {\n\t\t\t\t\t\t\ttoggledRows.forEach(function (toggledRow) {\n\t\t\t\t\t\t\t\tif (toggledRow !== self.lastClickedRow) {\n\n\t\t\t\t\t\t\t\t\tif (self.table.options.selectable !== true && !self.isRowSelected(row)) {\n\t\t\t\t\t\t\t\t\t\tif (self.selectedRows.length < self.table.options.selectable) {\n\t\t\t\t\t\t\t\t\t\t\tself.toggleRow(toggledRow);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tself.toggleRow(toggledRow);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tself.lastClickedRow = row;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tself.deselectRows(undefined, true);\n\n\t\t\t\t\t\t\tif (self.table.options.selectable !== true) {\n\t\t\t\t\t\t\t\tif (toggledRows.length > self.table.options.selectable) {\n\t\t\t\t\t\t\t\t\ttoggledRows = toggledRows.slice(0, self.table.options.selectable);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tself.selectRows(toggledRows);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t} else if (e.ctrlKey || e.metaKey) {\n\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t\tself.lastClickedRow = row;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.deselectRows(undefined, true);\n\t\t\t\t\t\tself.selectRows(row);\n\t\t\t\t\t\tself.lastClickedRow = row;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\telement.addEventListener(\"click\", function (e) {\n\t\t\t\t\tif (!self.table.modExists(\"edit\") || !self.table.modules.edit.getCurrentCell()) {\n\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!self.selecting) {\n\t\t\t\t\t\tself.toggleRow(row);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\telement.addEventListener(\"mousedown\", function (e) {\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tself.table._clearSelection();\n\n\t\t\t\t\t\tself.selecting = true;\n\n\t\t\t\t\t\tself.selectPrev = [];\n\n\t\t\t\t\t\tdocument.body.addEventListener(\"mouseup\", endSelect);\n\t\t\t\t\t\tdocument.body.addEventListener(\"keyup\", endSelect);\n\n\t\t\t\t\t\tself.toggleRow(row);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\telement.addEventListener(\"mouseenter\", function (e) {\n\t\t\t\t\tif (self.selecting) {\n\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\tself.toggleRow(row);\n\n\t\t\t\t\t\tif (self.selectPrev[1] == row) {\n\t\t\t\t\t\t\tself.toggleRow(self.selectPrev[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\telement.addEventListener(\"mouseout\", function (e) {\n\t\t\t\t\tif (self.selecting) {\n\t\t\t\t\t\tself.table._clearSelection();\n\t\t\t\t\t\tself.selectPrev.unshift(row);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t} else {\n\t\telement.classList.add(\"tabulator-unselectable\");\n\t\telement.classList.remove(\"tabulator-selectable\");\n\t}\n};\n\n//toggle row selection\nSelectRow.prototype.toggleRow = function (row) {\n\tif (this.table.options.selectableCheck.call(this.table, row.getComponent())) {\n\t\tif (row.modules.select && row.modules.select.selected) {\n\t\t\tthis._deselectRow(row);\n\t\t} else {\n\t\t\tthis._selectRow(row);\n\t\t}\n\t}\n};\n\n//select a number of rows\nSelectRow.prototype.selectRows = function (rows) {\n\tvar _this84 = this;\n\n\tvar rowMatch;\n\n\tswitch (typeof rows === 'undefined' ? 'undefined' : _typeof(rows)) {\n\t\tcase \"undefined\":\n\t\t\tthis.table.rowManager.rows.forEach(function (row) {\n\t\t\t\t_this84._selectRow(row, true, true);\n\t\t\t});\n\n\t\t\tthis._rowSelectionChanged();\n\t\t\tbreak;\n\n\t\tcase \"string\":\n\n\t\t\trowMatch = this.table.rowManager.findRow(rows);\n\n\t\t\tif (rowMatch) {\n\t\t\t\tthis._selectRow(rowMatch, true, true);\n\t\t\t} else {\n\t\t\t\tthis.table.rowManager.getRows(rows).forEach(function (row) {\n\t\t\t\t\t_this84._selectRow(row, true, true);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._rowSelectionChanged();\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tif (Array.isArray(rows)) {\n\t\t\t\trows.forEach(function (row) {\n\t\t\t\t\t_this84._selectRow(row, true, true);\n\t\t\t\t});\n\n\t\t\t\tthis._rowSelectionChanged();\n\t\t\t} else {\n\t\t\t\tthis._selectRow(rows, false, true);\n\t\t\t}\n\t\t\tbreak;\n\t}\n};\n\n//select an individual row\nSelectRow.prototype._selectRow = function (rowInfo, silent, force) {\n\tvar index;\n\n\t//handle max row count\n\tif (!isNaN(this.table.options.selectable) && this.table.options.selectable !== true && !force) {\n\t\tif (this.selectedRows.length >= this.table.options.selectable) {\n\t\t\tif (this.table.options.selectableRollingSelection) {\n\t\t\t\tthis._deselectRow(this.selectedRows[0]);\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\tvar row = this.table.rowManager.findRow(rowInfo);\n\n\tif (row) {\n\t\tif (this.selectedRows.indexOf(row) == -1) {\n\t\t\trow.getElement().classList.add(\"tabulator-selected\");\n\t\t\tif (!row.modules.select) {\n\t\t\t\trow.modules.select = {};\n\t\t\t}\n\n\t\t\trow.modules.select.selected = true;\n\t\t\tif (row.modules.select.checkboxEl) {\n\t\t\t\trow.modules.select.checkboxEl.checked = true;\n\t\t\t}\n\n\t\t\tthis.selectedRows.push(row);\n\n\t\t\tif (this.table.options.dataTreeSelectPropagate) {\n\t\t\t\tthis.childRowSelection(row, true);\n\t\t\t}\n\n\t\t\tif (!silent) {\n\t\t\t\tthis.table.options.rowSelected.call(this.table, row.getComponent());\n\t\t\t}\n\n\t\t\tthis._rowSelectionChanged(silent);\n\t\t}\n\t} else {\n\t\tif (!silent) {\n\t\t\tconsole.warn(\"Selection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t}\n\t}\n};\n\nSelectRow.prototype.isRowSelected = function (row) {\n\treturn this.selectedRows.indexOf(row) !== -1;\n};\n\n//deselect a number of rows\nSelectRow.prototype.deselectRows = function (rows, silent) {\n\tvar self = this,\n\t    rowCount;\n\n\tif (typeof rows == \"undefined\") {\n\n\t\trowCount = self.selectedRows.length;\n\n\t\tfor (var _i18 = 0; _i18 < rowCount; _i18++) {\n\t\t\tself._deselectRow(self.selectedRows[0], true);\n\t\t}\n\n\t\tself._rowSelectionChanged(silent);\n\t} else {\n\t\tif (Array.isArray(rows)) {\n\t\t\trows.forEach(function (row) {\n\t\t\t\tself._deselectRow(row, true);\n\t\t\t});\n\n\t\t\tself._rowSelectionChanged(silent);\n\t\t} else {\n\t\t\tself._deselectRow(rows, silent);\n\t\t}\n\t}\n};\n\n//deselect an individual row\nSelectRow.prototype._deselectRow = function (rowInfo, silent) {\n\tvar self = this,\n\t    row = self.table.rowManager.findRow(rowInfo),\n\t    index;\n\n\tif (row) {\n\t\tindex = self.selectedRows.findIndex(function (selectedRow) {\n\t\t\treturn selectedRow == row;\n\t\t});\n\n\t\tif (index > -1) {\n\n\t\t\trow.getElement().classList.remove(\"tabulator-selected\");\n\t\t\tif (!row.modules.select) {\n\t\t\t\trow.modules.select = {};\n\t\t\t}\n\n\t\t\trow.modules.select.selected = false;\n\t\t\tif (row.modules.select.checkboxEl) {\n\t\t\t\trow.modules.select.checkboxEl.checked = false;\n\t\t\t}\n\t\t\tself.selectedRows.splice(index, 1);\n\n\t\t\tif (this.table.options.dataTreeSelectPropagate) {\n\t\t\t\tthis.childRowSelection(row, false);\n\t\t\t}\n\n\t\t\tif (!silent) {\n\t\t\t\tself.table.options.rowDeselected.call(this.table, row.getComponent());\n\t\t\t}\n\n\t\t\tself._rowSelectionChanged(silent);\n\t\t}\n\t} else {\n\t\tif (!silent) {\n\t\t\tconsole.warn(\"Deselection Error - No such row found, ignoring selection:\" + rowInfo);\n\t\t}\n\t}\n};\n\nSelectRow.prototype.getSelectedData = function () {\n\tvar data = [];\n\n\tthis.selectedRows.forEach(function (row) {\n\t\tdata.push(row.getData());\n\t});\n\n\treturn data;\n};\n\nSelectRow.prototype.getSelectedRows = function () {\n\n\tvar rows = [];\n\n\tthis.selectedRows.forEach(function (row) {\n\t\trows.push(row.getComponent());\n\t});\n\n\treturn rows;\n};\n\nSelectRow.prototype._rowSelectionChanged = function (silent) {\n\tif (this.headerCheckboxElement) {\n\t\tif (this.selectedRows.length === 0) {\n\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t} else if (this.table.rowManager.rows.length === this.selectedRows.length) {\n\t\t\tthis.headerCheckboxElement.checked = true;\n\t\t\tthis.headerCheckboxElement.indeterminate = false;\n\t\t} else {\n\t\t\tthis.headerCheckboxElement.indeterminate = true;\n\t\t\tthis.headerCheckboxElement.checked = false;\n\t\t}\n\t}\n\n\tif (!silent) {\n\t\tthis.table.options.rowSelectionChanged.call(this.table, this.getSelectedData(), this.getSelectedRows());\n\t}\n};\n\nSelectRow.prototype.registerRowSelectCheckbox = function (row, element) {\n\tif (!row._row.modules.select) {\n\t\trow._row.modules.select = {};\n\t}\n\n\trow._row.modules.select.checkboxEl = element;\n};\n\nSelectRow.prototype.registerHeaderSelectCheckbox = function (element) {\n\tthis.headerCheckboxElement = element;\n};\n\nSelectRow.prototype.childRowSelection = function (row, select) {\n\tvar children = this.table.modules.dataTree.getChildren(row, true);\n\n\tif (select) {\n\t\tfor (var _iterator2 = children, _isArray2 = Array.isArray(_iterator2), _i19 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n\t\t\tvar _ref2;\n\n\t\t\tif (_isArray2) {\n\t\t\t\tif (_i19 >= _iterator2.length) break;\n\t\t\t\t_ref2 = _iterator2[_i19++];\n\t\t\t} else {\n\t\t\t\t_i19 = _iterator2.next();\n\t\t\t\tif (_i19.done) break;\n\t\t\t\t_ref2 = _i19.value;\n\t\t\t}\n\n\t\t\tvar child = _ref2;\n\n\t\t\tthis._selectRow(child, true);\n\t\t}\n\t} else {\n\t\tfor (var _iterator3 = children, _isArray3 = Array.isArray(_iterator3), _i20 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n\t\t\tvar _ref3;\n\n\t\t\tif (_isArray3) {\n\t\t\t\tif (_i20 >= _iterator3.length) break;\n\t\t\t\t_ref3 = _iterator3[_i20++];\n\t\t\t} else {\n\t\t\t\t_i20 = _iterator3.next();\n\t\t\t\tif (_i20.done) break;\n\t\t\t\t_ref3 = _i20.value;\n\t\t\t}\n\n\t\t\tvar _child = _ref3;\n\n\t\t\tthis._deselectRow(_child, true);\n\t\t}\n\t}\n};\n\nTabulator.prototype.registerModule(\"selectRow\", SelectRow);\n\nvar Sort = function Sort(table) {\n\tthis.table = table; //hold Tabulator object\n\tthis.sortList = []; //holder current sort\n\tthis.changed = false; //has the sort changed since last render\n};\n\n//initialize column header for sorting\nSort.prototype.initializeColumn = function (column, content) {\n\tvar self = this,\n\t    sorter = false,\n\t    colEl,\n\t    arrowEl;\n\n\tswitch (_typeof(column.definition.sorter)) {\n\t\tcase \"string\":\n\t\t\tif (self.sorters[column.definition.sorter]) {\n\t\t\t\tsorter = self.sorters[column.definition.sorter];\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Sort Error - No such sorter found: \", column.definition.sorter);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\tsorter = column.definition.sorter;\n\t\t\tbreak;\n\t}\n\n\tcolumn.modules.sort = {\n\t\tsorter: sorter, dir: \"none\",\n\t\tparams: column.definition.sorterParams || {},\n\t\tstartingDir: column.definition.headerSortStartingDir || \"asc\",\n\t\ttristate: typeof column.definition.headerSortTristate !== \"undefined\" ? column.definition.headerSortTristate : this.table.options.headerSortTristate\n\t};\n\n\tif (typeof column.definition.headerSort === \"undefined\" ? this.table.options.headerSort !== false : column.definition.headerSort !== false) {\n\n\t\tcolEl = column.getElement();\n\n\t\tcolEl.classList.add(\"tabulator-sortable\");\n\n\t\tarrowEl = document.createElement(\"div\");\n\t\tarrowEl.classList.add(\"tabulator-col-sorter\");\n\n\t\tif (_typeof(this.table.options.headerSortElement) == \"object\") {\n\t\t\tarrowEl.appendChild(this.table.options.headerSortElement);\n\t\t} else {\n\t\t\tarrowEl.innerHTML = this.table.options.headerSortElement;\n\t\t}\n\n\t\t//create sorter arrow\n\t\tcontent.appendChild(arrowEl);\n\n\t\tcolumn.modules.sort.element = arrowEl;\n\n\t\t//sort on click\n\t\tcolEl.addEventListener(\"click\", function (e) {\n\t\t\tvar dir = \"\",\n\t\t\t    sorters = [],\n\t\t\t    match = false;\n\n\t\t\tif (column.modules.sort) {\n\t\t\t\tif (column.modules.sort.tristate) {\n\t\t\t\t\tif (column.modules.sort.dir == \"none\") {\n\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (column.modules.sort.dir == column.modules.sort.startingDir) {\n\t\t\t\t\t\t\tdir = column.modules.sort.dir == \"asc\" ? \"desc\" : \"asc\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdir = \"none\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tswitch (column.modules.sort.dir) {\n\t\t\t\t\t\tcase \"asc\":\n\t\t\t\t\t\t\tdir = \"desc\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"desc\":\n\t\t\t\t\t\t\tdir = \"asc\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tdir = column.modules.sort.startingDir;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (self.table.options.columnHeaderSortMulti && (e.shiftKey || e.ctrlKey)) {\n\t\t\t\t\tsorters = self.getSort();\n\n\t\t\t\t\tmatch = sorters.findIndex(function (sorter) {\n\t\t\t\t\t\treturn sorter.field === column.getField();\n\t\t\t\t\t});\n\n\t\t\t\t\tif (match > -1) {\n\t\t\t\t\t\tsorters[match].dir = dir;\n\n\t\t\t\t\t\tif (match != sorters.length - 1) {\n\t\t\t\t\t\t\tmatch = sorters.splice(match, 1)[0];\n\t\t\t\t\t\t\tif (dir != \"none\") {\n\t\t\t\t\t\t\t\tsorters.push(match);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (dir != \"none\") {\n\t\t\t\t\t\t\tsorters.push({ column: column, dir: dir });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//add to existing sort\n\t\t\t\t\tself.setSort(sorters);\n\t\t\t\t} else {\n\t\t\t\t\tif (dir == \"none\") {\n\t\t\t\t\t\tself.clear();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//sort by column only\n\t\t\t\t\t\tself.setSort(column, dir);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tself.table.rowManager.sorterRefresh(!self.sortList.length);\n\t\t\t}\n\t\t});\n\t}\n};\n\n//check if the sorters have changed since last use\nSort.prototype.hasChanged = function () {\n\tvar changed = this.changed;\n\tthis.changed = false;\n\treturn changed;\n};\n\n//return current sorters\nSort.prototype.getSort = function () {\n\tvar self = this,\n\t    sorters = [];\n\n\tself.sortList.forEach(function (item) {\n\t\tif (item.column) {\n\t\t\tsorters.push({ column: item.column.getComponent(), field: item.column.getField(), dir: item.dir });\n\t\t}\n\t});\n\n\treturn sorters;\n};\n\n//change sort list and trigger sort\nSort.prototype.setSort = function (sortList, dir) {\n\tvar self = this,\n\t    newSortList = [];\n\n\tif (!Array.isArray(sortList)) {\n\t\tsortList = [{ column: sortList, dir: dir }];\n\t}\n\n\tsortList.forEach(function (item) {\n\t\tvar column;\n\n\t\tcolumn = self.table.columnManager.findColumn(item.column);\n\n\t\tif (column) {\n\t\t\titem.column = column;\n\t\t\tnewSortList.push(item);\n\t\t\tself.changed = true;\n\t\t} else {\n\t\t\tconsole.warn(\"Sort Warning - Sort field does not exist and is being ignored: \", item.column);\n\t\t}\n\t});\n\n\tself.sortList = newSortList;\n\n\tif (this.table.options.persistence && this.table.modExists(\"persistence\", true) && this.table.modules.persistence.config.sort) {\n\t\tthis.table.modules.persistence.save(\"sort\");\n\t}\n};\n\n//clear sorters\nSort.prototype.clear = function () {\n\tthis.setSort([]);\n};\n\n//find appropriate sorter for column\nSort.prototype.findSorter = function (column) {\n\tvar row = this.table.rowManager.activeRows[0],\n\t    sorter = \"string\",\n\t    field,\n\t    value;\n\n\tif (row) {\n\t\trow = row.getData();\n\t\tfield = column.getField();\n\n\t\tif (field) {\n\n\t\t\tvalue = column.getFieldValue(row);\n\n\t\t\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\t\t\t\tcase \"undefined\":\n\t\t\t\t\tsorter = \"string\";\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tsorter = \"boolean\";\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif (!isNaN(value) && value !== \"\") {\n\t\t\t\t\t\tsorter = \"number\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (value.match(/((^[0-9]+[a-z]+)|(^[a-z]+[0-9]+))+$/i)) {\n\t\t\t\t\t\t\tsorter = \"alphanum\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn this.sorters[sorter];\n};\n\n//work through sort list sorting data\nSort.prototype.sort = function (data) {\n\tvar self = this,\n\t    sortList = this.table.options.sortOrderReverse ? self.sortList.slice().reverse() : self.sortList,\n\t    sortListActual = [],\n\t    rowComponents = [],\n\t    lastSort;\n\n\tif (self.table.options.dataSorting) {\n\t\tself.table.options.dataSorting.call(self.table, self.getSort());\n\t}\n\n\tself.clearColumnHeaders();\n\n\tif (!self.table.options.ajaxSorting) {\n\n\t\t//build list of valid sorters and trigger column specific callbacks before sort begins\n\t\tsortList.forEach(function (item, i) {\n\t\t\tvar sortObj = item.column.modules.sort;\n\n\t\t\tif (item.column && sortObj) {\n\n\t\t\t\t//if no sorter has been defined, take a guess\n\t\t\t\tif (!sortObj.sorter) {\n\t\t\t\t\tsortObj.sorter = self.findSorter(item.column);\n\t\t\t\t}\n\n\t\t\t\titem.params = typeof sortObj.params === \"function\" ? sortObj.params(item.column.getComponent(), item.dir) : sortObj.params;\n\n\t\t\t\tsortListActual.push(item);\n\t\t\t}\n\n\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t});\n\n\t\t//sort data\n\t\tif (sortListActual.length) {\n\t\t\tself._sortItems(data, sortListActual);\n\t\t}\n\t} else {\n\t\tsortList.forEach(function (item, i) {\n\t\t\tself.setColumnHeader(item.column, item.dir);\n\t\t});\n\t}\n\n\tif (self.table.options.dataSorted) {\n\t\tdata.forEach(function (row) {\n\t\t\trowComponents.push(row.getComponent());\n\t\t});\n\n\t\tself.table.options.dataSorted.call(self.table, self.getSort(), rowComponents);\n\t}\n};\n\n//clear sort arrows on columns\nSort.prototype.clearColumnHeaders = function () {\n\tthis.table.columnManager.getRealColumns().forEach(function (column) {\n\t\tif (column.modules.sort) {\n\t\t\tcolumn.modules.sort.dir = \"none\";\n\t\t\tcolumn.getElement().setAttribute(\"aria-sort\", \"none\");\n\t\t}\n\t});\n};\n\n//set the column header sort direction\nSort.prototype.setColumnHeader = function (column, dir) {\n\tcolumn.modules.sort.dir = dir;\n\tcolumn.getElement().setAttribute(\"aria-sort\", dir);\n};\n\n//sort each item in sort list\nSort.prototype._sortItems = function (data, sortList) {\n\tvar _this85 = this;\n\n\tvar sorterCount = sortList.length - 1;\n\n\tdata.sort(function (a, b) {\n\t\tvar result;\n\n\t\tfor (var i = sorterCount; i >= 0; i--) {\n\t\t\tvar sortItem = sortList[i];\n\n\t\t\tresult = _this85._sortRow(a, b, sortItem.column, sortItem.dir, sortItem.params);\n\n\t\t\tif (result !== 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t});\n};\n\n//process individual rows for a sort function on active data\nSort.prototype._sortRow = function (a, b, column, dir, params) {\n\tvar el1Comp, el2Comp, colComp;\n\n\t//switch elements depending on search direction\n\tvar el1 = dir == \"asc\" ? a : b;\n\tvar el2 = dir == \"asc\" ? b : a;\n\n\ta = column.getFieldValue(el1.getData());\n\tb = column.getFieldValue(el2.getData());\n\n\ta = typeof a !== \"undefined\" ? a : \"\";\n\tb = typeof b !== \"undefined\" ? b : \"\";\n\n\tel1Comp = el1.getComponent();\n\tel2Comp = el2.getComponent();\n\n\treturn column.modules.sort.sorter.call(this, a, b, el1Comp, el2Comp, column.getComponent(), dir, params);\n};\n\n//default data sorters\nSort.prototype.sorters = {\n\n\t//sort numbers\n\tnumber: function number(a, b, aRow, bRow, column, dir, params) {\n\t\tvar alignEmptyValues = params.alignEmptyValues;\n\t\tvar decimal = params.decimalSeparator;\n\t\tvar thousand = params.thousandSeparator;\n\t\tvar emptyAlign = 0;\n\n\t\ta = String(a);\n\t\tb = String(b);\n\n\t\tif (thousand) {\n\t\t\ta = a.split(thousand).join(\"\");\n\t\t\tb = b.split(thousand).join(\"\");\n\t\t}\n\n\t\tif (decimal) {\n\t\t\ta = a.split(decimal).join(\".\");\n\t\t\tb = b.split(decimal).join(\".\");\n\t\t}\n\n\t\ta = parseFloat(a);\n\t\tb = parseFloat(b);\n\n\t\t//handle non numeric values\n\t\tif (isNaN(a)) {\n\t\t\temptyAlign = isNaN(b) ? 0 : -1;\n\t\t} else if (isNaN(b)) {\n\t\t\temptyAlign = 1;\n\t\t} else {\n\t\t\t//compare valid values\n\t\t\treturn a - b;\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif (alignEmptyValues === \"top\" && dir === \"desc\" || alignEmptyValues === \"bottom\" && dir === \"asc\") {\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\t},\n\n\t//sort strings\n\tstring: function string(a, b, aRow, bRow, column, dir, params) {\n\t\tvar alignEmptyValues = params.alignEmptyValues;\n\t\tvar emptyAlign = 0;\n\t\tvar locale;\n\n\t\t//handle empty values\n\t\tif (!a) {\n\t\t\temptyAlign = !b ? 0 : -1;\n\t\t} else if (!b) {\n\t\t\temptyAlign = 1;\n\t\t} else {\n\t\t\t//compare valid values\n\t\t\tswitch (_typeof(params.locale)) {\n\t\t\t\tcase \"boolean\":\n\t\t\t\t\tif (params.locale) {\n\t\t\t\t\t\tlocale = this.table.modules.localize.getLocale();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"string\":\n\t\t\t\t\tlocale = params.locale;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn String(a).toLowerCase().localeCompare(String(b).toLowerCase(), locale);\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif (alignEmptyValues === \"top\" && dir === \"desc\" || alignEmptyValues === \"bottom\" && dir === \"asc\") {\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\t},\n\n\t//sort date\n\tdate: function date(a, b, aRow, bRow, column, dir, params) {\n\t\tif (!params.format) {\n\t\t\tparams.format = \"DD/MM/YYYY\";\n\t\t}\n\n\t\treturn this.sorters.datetime.call(this, a, b, aRow, bRow, column, dir, params);\n\t},\n\n\t//sort HH:mm formatted times\n\ttime: function time(a, b, aRow, bRow, column, dir, params) {\n\t\tif (!params.format) {\n\t\t\tparams.format = \"HH:mm\";\n\t\t}\n\n\t\treturn this.sorters.datetime.call(this, a, b, aRow, bRow, column, dir, params);\n\t},\n\n\t//sort datetime\n\tdatetime: function datetime(a, b, aRow, bRow, column, dir, params) {\n\t\tvar format = params.format || \"DD/MM/YYYY HH:mm:ss\",\n\t\t    alignEmptyValues = params.alignEmptyValues,\n\t\t    emptyAlign = 0;\n\n\t\tif (typeof moment != \"undefined\") {\n\t\t\ta = moment(a, format);\n\t\t\tb = moment(b, format);\n\n\t\t\tif (!a.isValid()) {\n\t\t\t\temptyAlign = !b.isValid() ? 0 : -1;\n\t\t\t} else if (!b.isValid()) {\n\t\t\t\temptyAlign = 1;\n\t\t\t} else {\n\t\t\t\t//compare valid values\n\t\t\t\treturn a - b;\n\t\t\t}\n\n\t\t\t//fix empty values in position\n\t\t\tif (alignEmptyValues === \"top\" && dir === \"desc\" || alignEmptyValues === \"bottom\" && dir === \"asc\") {\n\t\t\t\temptyAlign *= -1;\n\t\t\t}\n\n\t\t\treturn emptyAlign;\n\t\t} else {\n\t\t\tconsole.error(\"Sort Error - 'datetime' sorter is dependant on moment.js\");\n\t\t}\n\t},\n\n\t//sort booleans\n\tboolean: function boolean(a, b, aRow, bRow, column, dir, params) {\n\t\tvar el1 = a === true || a === \"true\" || a === \"True\" || a === 1 ? 1 : 0;\n\t\tvar el2 = b === true || b === \"true\" || b === \"True\" || b === 1 ? 1 : 0;\n\n\t\treturn el1 - el2;\n\t},\n\n\t//sort if element contains any data\n\tarray: function array(a, b, aRow, bRow, column, dir, params) {\n\t\tvar el1 = 0;\n\t\tvar el2 = 0;\n\t\tvar type = params.type || \"length\";\n\t\tvar alignEmptyValues = params.alignEmptyValues;\n\t\tvar emptyAlign = 0;\n\n\t\tfunction calc(value) {\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"length\":\n\t\t\t\t\treturn value.length;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"sum\":\n\t\t\t\t\treturn value.reduce(function (c, d) {\n\t\t\t\t\t\treturn c + d;\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"max\":\n\t\t\t\t\treturn Math.max.apply(null, value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"min\":\n\t\t\t\t\treturn Math.min.apply(null, value);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"avg\":\n\t\t\t\t\treturn value.reduce(function (c, d) {\n\t\t\t\t\t\treturn c + d;\n\t\t\t\t\t}) / value.length;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t//handle non array values\n\t\tif (!Array.isArray(a)) {\n\t\t\talignEmptyValues = !Array.isArray(b) ? 0 : -1;\n\t\t} else if (!Array.isArray(b)) {\n\t\t\talignEmptyValues = 1;\n\t\t} else {\n\n\t\t\t//compare valid values\n\t\t\tel1 = a ? calc(a) : 0;\n\t\t\tel2 = b ? calc(b) : 0;\n\n\t\t\treturn el1 - el2;\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif (alignEmptyValues === \"top\" && dir === \"desc\" || alignEmptyValues === \"bottom\" && dir === \"asc\") {\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\t},\n\n\t//sort if element contains any data\n\texists: function exists(a, b, aRow, bRow, column, dir, params) {\n\t\tvar el1 = typeof a == \"undefined\" ? 0 : 1;\n\t\tvar el2 = typeof b == \"undefined\" ? 0 : 1;\n\n\t\treturn el1 - el2;\n\t},\n\n\t//sort alpha numeric strings\n\talphanum: function alphanum(as, bs, aRow, bRow, column, dir, params) {\n\t\tvar a,\n\t\t    b,\n\t\t    a1,\n\t\t    b1,\n\t\t    i = 0,\n\t\t    L,\n\t\t    rx = /(\\d+)|(\\D+)/g,\n\t\t    rd = /\\d/;\n\t\tvar alignEmptyValues = params.alignEmptyValues;\n\t\tvar emptyAlign = 0;\n\n\t\t//handle empty values\n\t\tif (!as && as !== 0) {\n\t\t\temptyAlign = !bs && bs !== 0 ? 0 : -1;\n\t\t} else if (!bs && bs !== 0) {\n\t\t\temptyAlign = 1;\n\t\t} else {\n\n\t\t\tif (isFinite(as) && isFinite(bs)) return as - bs;\n\t\t\ta = String(as).toLowerCase();\n\t\t\tb = String(bs).toLowerCase();\n\t\t\tif (a === b) return 0;\n\t\t\tif (!(rd.test(a) && rd.test(b))) return a > b ? 1 : -1;\n\t\t\ta = a.match(rx);\n\t\t\tb = b.match(rx);\n\t\t\tL = a.length > b.length ? b.length : a.length;\n\t\t\twhile (i < L) {\n\t\t\t\ta1 = a[i];\n\t\t\t\tb1 = b[i++];\n\t\t\t\tif (a1 !== b1) {\n\t\t\t\t\tif (isFinite(a1) && isFinite(b1)) {\n\t\t\t\t\t\tif (a1.charAt(0) === \"0\") a1 = \".\" + a1;\n\t\t\t\t\t\tif (b1.charAt(0) === \"0\") b1 = \".\" + b1;\n\t\t\t\t\t\treturn a1 - b1;\n\t\t\t\t\t} else return a1 > b1 ? 1 : -1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn a.length > b.length;\n\t\t}\n\n\t\t//fix empty values in position\n\t\tif (alignEmptyValues === \"top\" && dir === \"desc\" || alignEmptyValues === \"bottom\" && dir === \"asc\") {\n\t\t\temptyAlign *= -1;\n\t\t}\n\n\t\treturn emptyAlign;\n\t}\n};\n\nTabulator.prototype.registerModule(\"sort\", Sort);\n\nvar Validate = function Validate(table) {\n\tthis.table = table;\n\tthis.invalidCells = [];\n};\n\n//validate\nValidate.prototype.initializeColumn = function (column) {\n\tvar self = this,\n\t    config = [],\n\t    validator;\n\n\tif (column.definition.validator) {\n\n\t\tif (Array.isArray(column.definition.validator)) {\n\t\t\tcolumn.definition.validator.forEach(function (item) {\n\t\t\t\tvalidator = self._extractValidator(item);\n\n\t\t\t\tif (validator) {\n\t\t\t\t\tconfig.push(validator);\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tvalidator = this._extractValidator(column.definition.validator);\n\n\t\t\tif (validator) {\n\t\t\t\tconfig.push(validator);\n\t\t\t}\n\t\t}\n\n\t\tcolumn.modules.validate = config.length ? config : false;\n\t}\n};\n\nValidate.prototype._extractValidator = function (value) {\n\tvar type, params, pos;\n\n\tswitch (typeof value === 'undefined' ? 'undefined' : _typeof(value)) {\n\t\tcase \"string\":\n\t\t\tpos = value.indexOf(':');\n\n\t\t\tif (pos > -1) {\n\t\t\t\ttype = value.substring(0, pos);\n\t\t\t\tparams = value.substring(pos + 1);\n\t\t\t} else {\n\t\t\t\ttype = value;\n\t\t\t}\n\n\t\t\treturn this._buildValidator(type, params);\n\t\t\tbreak;\n\n\t\tcase \"function\":\n\t\t\treturn this._buildValidator(value);\n\t\t\tbreak;\n\n\t\tcase \"object\":\n\t\t\treturn this._buildValidator(value.type, value.parameters);\n\t\t\tbreak;\n\t}\n};\n\nValidate.prototype._buildValidator = function (type, params) {\n\n\tvar func = typeof type == \"function\" ? type : this.validators[type];\n\n\tif (!func) {\n\t\tconsole.warn(\"Validator Setup Error - No matching validator found:\", type);\n\t\treturn false;\n\t} else {\n\t\treturn {\n\t\t\ttype: typeof type == \"function\" ? \"function\" : type,\n\t\t\tfunc: func,\n\t\t\tparams: params\n\t\t};\n\t}\n};\n\nValidate.prototype.validate = function (validators, cell, value) {\n\tvar self = this,\n\t    valid = [],\n\t    invalidIndex = this.invalidCells.indexOf(cell);\n\n\tif (validators) {\n\t\tvalidators.forEach(function (item) {\n\t\t\tif (!item.func.call(self, cell.getComponent(), value, item.params)) {\n\t\t\t\tvalid.push({\n\t\t\t\t\ttype: item.type,\n\t\t\t\t\tparameters: item.params\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tvalid = valid.length ? valid : true;\n\n\tif (!cell.modules.validate) {\n\t\tcell.modules.validate = {};\n\t}\n\n\tif (valid === true) {\n\t\tcell.modules.validate.invalid = false;\n\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\n\t\tif (invalidIndex > -1) {\n\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t}\n\t} else {\n\t\tcell.modules.validate.invalid = true;\n\n\t\tif (this.table.options.validationMode !== \"manual\") {\n\t\t\tcell.getElement().classList.add(\"tabulator-validation-fail\");\n\t\t}\n\n\t\tif (invalidIndex == -1) {\n\t\t\tthis.invalidCells.push(cell);\n\t\t}\n\t}\n\n\treturn valid;\n};\n\nValidate.prototype.getInvalidCells = function () {\n\tvar output = [];\n\n\tthis.invalidCells.forEach(function (cell) {\n\t\toutput.push(cell.getComponent());\n\t});\n\n\treturn output;\n};\n\nValidate.prototype.clearValidation = function (cell) {\n\tvar invalidIndex;\n\n\tif (cell.modules.validate && cell.modules.validate.invalid) {\n\n\t\tcell.getElement().classList.remove(\"tabulator-validation-fail\");\n\t\tcell.modules.validate.invalid = false;\n\n\t\tinvalidIndex = this.invalidCells.indexOf(cell);\n\n\t\tif (invalidIndex > -1) {\n\t\t\tthis.invalidCells.splice(invalidIndex, 1);\n\t\t}\n\t}\n};\n\nValidate.prototype.validators = {\n\n\t//is integer\n\tinteger: function integer(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\tvalue = Number(value);\n\t\treturn typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n\t},\n\n\t//is float\n\tfloat: function float(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\tvalue = Number(value);\n\t\treturn typeof value === 'number' && isFinite(value) && value % 1 !== 0;\n\t},\n\n\t//must be a number\n\tnumeric: function numeric(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn !isNaN(value);\n\t},\n\n\t//must be a string\n\tstring: function string(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn isNaN(value);\n\t},\n\n\t//maximum value\n\tmax: function max(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) <= parameters;\n\t},\n\n\t//minimum value\n\tmin: function min(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn parseFloat(value) >= parameters;\n\t},\n\n\t//starts with  value\n\tstarts: function starts(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().startsWith(String(parameters).toLowerCase());\n\t},\n\n\t//ends with  value\n\tends: function ends(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).toLowerCase().endsWith(String(parameters).toLowerCase());\n\t},\n\n\t//minimum string length\n\tminLength: function minLength(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length >= parameters;\n\t},\n\n\t//maximum string length\n\tmaxLength: function maxLength(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn String(value).length <= parameters;\n\t},\n\n\t//in provided value list\n\tin: function _in(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\tif (typeof parameters == \"string\") {\n\t\t\tparameters = parameters.split(\"|\");\n\t\t}\n\n\t\treturn value === \"\" || parameters.indexOf(value) > -1;\n\t},\n\n\t//must match provided regex\n\tregex: function regex(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\tvar reg = new RegExp(parameters);\n\n\t\treturn reg.test(value);\n\t},\n\n\t//value must be unique in this column\n\tunique: function unique(cell, value, parameters) {\n\t\tif (value === \"\" || value === null || typeof value === \"undefined\") {\n\t\t\treturn true;\n\t\t}\n\t\tvar unique = true;\n\n\t\tvar cellData = cell.getData();\n\t\tvar column = cell.getColumn()._getSelf();\n\n\t\tthis.table.rowManager.rows.forEach(function (row) {\n\t\t\tvar data = row.getData();\n\n\t\t\tif (data !== cellData) {\n\t\t\t\tif (value == column.getFieldValue(data)) {\n\t\t\t\t\tunique = false;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn unique;\n\t},\n\n\t//must have a value\n\trequired: function required(cell, value, parameters) {\n\t\treturn value !== \"\" && value !== null && typeof value !== \"undefined\";\n\t}\n};\n\nTabulator.prototype.registerModule(\"validate\", Validate);\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Tabulator);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdGFidWxhdG9yLXRhYmxlcy9kaXN0L2pzL3RhYnVsYXRvci5lczIwMTUuanM/ZTMyNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUE7O0FBRWE7O0FBRWI7O0FBRUEsb0dBQW9HLG1CQUFtQixFQUFFLG1CQUFtQiw4SEFBOEg7O0FBRTFROztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxtREFBbUQ7O0FBRW5EOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUEsbURBQW1EOztBQUVuRDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsc0JBQXNCLDBCQUEwQjs7QUFFaEQ7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUEsRUFBRTtBQUNGOztBQUVBOztBQUVBLG9CQUFvQjs7QUFFcEI7O0FBRUE7O0FBRUEsMkNBQTJDOztBQUUzQyx3QkFBd0I7O0FBRXhCLG1CQUFtQjs7QUFFbkIsMEJBQTBCOztBQUUxQiwwQkFBMEI7O0FBRTFCOztBQUVBO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBLEtBQUs7QUFDTDs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxpREFBaUQsa0NBQWtDOztBQUVuRjs7O0FBR0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTs7O0FBR0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLE1BQU07O0FBRU47QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLE1BQU07O0FBRU47O0FBRUE7QUFDQSxPQUFPOztBQUVQO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsUUFBUTs7QUFFUjs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07O0FBRU47O0FBRUE7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7O0FBR0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQTs7O0FBR0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsS0FBSztBQUNMOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7O0FBR0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7OztBQUdBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHVCQUF1QjtBQUN2QixzQkFBc0I7QUFDdEIsc0JBQXNCO0FBQ3RCLG1CQUFtQjtBQUNuQixpQkFBaUI7QUFDakIscUNBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBLHNCQUFzQjtBQUN0QixvQkFBb0I7QUFDcEIscUJBQXFCOztBQUVyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUI7O0FBRW5CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG1CQUFtQjtBQUNuQix1QkFBdUI7QUFDdkIsc0JBQXNCO0FBQ3RCLDBCQUEwQjtBQUMxQixzQkFBc0I7QUFDdEIsMEJBQTBCO0FBQzFCLHlCQUF5Qjs7QUFFekIscUJBQXFCOztBQUVyQjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUcsR0FBRyxnQkFBZ0I7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRyxHQUFHLGdCQUFnQjs7QUFFdEI7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQsSUFBSTtBQUNKLEdBQUc7QUFDSCw0Q0FBNEM7QUFDNUM7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLGtGQUFrRjtBQUNsRixJQUFJO0FBQ0osR0FBRztBQUNILHlFQUF5RTtBQUN6RTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUIsYUFBYTs7QUFFOUI7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0IsY0FBYzs7QUFFaEM7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLG1CQUFtQixpQkFBaUI7QUFDcEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlDQUFpQztBQUNqQzs7QUFFQTs7QUFFQTtBQUNBLDRCQUE0QjtBQUM1Qjs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSwyQ0FBMkM7QUFDM0MsK0NBQStDO0FBQy9DLDhDQUE4QztBQUM5QywyQkFBMkI7QUFDM0IsaUJBQWlCOztBQUVqQiwwQkFBMEI7QUFDMUIsNkJBQTZCO0FBQzdCLDBCQUEwQjs7QUFFMUIsZ0JBQWdCO0FBQ2hCLHNCQUFzQjtBQUN0QiwwQkFBMEI7O0FBRTFCLHVCQUF1QjtBQUN2QiwyQkFBMkI7O0FBRTNCO0FBQ0E7O0FBRUEseUJBQXlCOztBQUV6QixrQkFBa0I7QUFDbEIscUJBQXFCOztBQUVyQiwyQkFBMkI7QUFDM0IsOEJBQThCOztBQUU5QixxQkFBcUI7QUFDckIsd0JBQXdCOztBQUV4Qiw4QkFBOEI7O0FBRTlCLDJCQUEyQjs7QUFFM0Isa0NBQWtDO0FBQ2xDLGtDQUFrQzs7QUFFbEMsMEJBQTBCO0FBQzFCLDZCQUE2Qjs7QUFFN0IsMkJBQTJCOztBQUUzQiwwQkFBMEI7QUFDMUIsdUNBQXVDO0FBQ3ZDLHlDQUF5QztBQUN6Qzs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLG9EQUFvRCxxQ0FBcUM7QUFDekY7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDBEQUEwRDtBQUMxRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esc0RBQXNELDJGQUEyRjtBQUNqSjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHdCQUF3QixZQUFZO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFLHVCQUF1QjtBQUN6Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxzQkFBc0I7QUFDMUUsR0FBRztBQUNILG9EQUFvRCxzQkFBc0I7QUFDMUUsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxvREFBb0Qsc0JBQXNCO0FBQzFFLEdBQUc7QUFDSCxvREFBb0Qsc0JBQXNCO0FBQzFFLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSw0QkFBNEIsc0JBQXNCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSw2QkFBNkIsc0JBQXNCOztBQUVuRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBLG1CQUFtQjs7QUFFbkI7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSx5QkFBeUIsMkJBQTJCO0FBQ3BEO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsaUJBQWlCLHlEQUF5RDtBQUMxRTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDZCQUE2QixzQkFBc0I7QUFDbkQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCLFdBQVc7QUFDakM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCLHNCQUFzQjtBQUNwRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBLGlCQUFpQjtBQUNqQix3QkFBd0I7QUFDeEIsMkJBQTJCO0FBQzNCLHNCQUFzQjtBQUN0QiwwQkFBMEI7QUFDMUIsZ0NBQWdDOztBQUVoQzs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUcsR0FBRyxnQkFBZ0I7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHLEdBQUcsZ0JBQWdCOztBQUV0QjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0JBQWtCO0FBQ2xCOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0EseUJBQXlCLHVCQUF1QjtBQUNoRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSx5QkFBeUIsUUFBUTtBQUNqQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLCtEQUErRCxxREFBcUQ7QUFDcEg7O0FBRUE7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsa0JBQWtCLGlCQUFpQjtBQUNuQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBLHFCQUFxQjs7QUFFckI7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHLEdBQUcsZ0JBQWdCOztBQUV0QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUcsR0FBRyxnQkFBZ0I7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0RBQXdELGdEQUFnRDtBQUN4Rzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQztBQUNyQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBOztBQUVBOztBQUVBLDJCQUEyQjtBQUMzQix3QkFBd0I7QUFDeEIsMkJBQTJCO0FBQzNCLHFCQUFxQjs7O0FBR3JCLG1CQUFtQjtBQUNuQiwwQkFBMEI7QUFDMUIsNEJBQTRCO0FBQzVCLGtCQUFrQjs7QUFFbEIsbUJBQW1COztBQUVuQjtBQUNBLHNDQUFzQztBQUN0QztBQUNBOztBQUVBLDBDQUEwQztBQUMxQzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsK0NBQStDO0FBQy9DLCtDQUErQztBQUMvQyx1REFBdUQ7O0FBRXZEO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLG1CQUFtQjtBQUNuQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RDtBQUN2RCx5REFBeUQ7QUFDekQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCOztBQUVoQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxVQUFVOztBQUVWO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkIsMkJBQTJCO0FBQzNCOztBQUVBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0Q7QUFDL0QsK0NBQStDO0FBQy9DLDJEQUEyRDtBQUMzRCw2REFBNkQ7QUFDN0QsbUVBQW1FO0FBQ25FLHVEQUF1RDtBQUN2RCxtRUFBbUU7QUFDbkUsaUVBQWlFO0FBQ2pFLDZEQUE2RDs7QUFFN0Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsMkNBQTJDO0FBQzNDLHFDQUFxQzs7QUFFckM7QUFDQSwyQ0FBMkM7QUFDM0MsNkNBQTZDOztBQUU3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLHFDQUFxQztBQUNyQyxpQ0FBaUM7QUFDakMscUNBQXFDO0FBQ3JDLHVEQUF1RDtBQUN2RCx1Q0FBdUM7QUFDdkMsMkNBQTJDO0FBQzNDLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkMscUNBQXFDO0FBQ3JDLG1EQUFtRDs7QUFFbkQ7QUFDQTtBQUNBLDJDQUEyQztBQUMzQyxxREFBcUQ7QUFDckQsK0RBQStEOztBQUUvRDtBQUNBLDJDQUEyQztBQUMzQyx5Q0FBeUM7O0FBRXpDO0FBQ0EsdUNBQXVDO0FBQ3ZDLHFDQUFxQztBQUNyQztBQUNBOztBQUVBO0FBQ0EsNkNBQTZDO0FBQzdDO0FBQ0EsbUNBQW1DOztBQUVuQztBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1Q0FBdUM7QUFDdkMscUNBQXFDOztBQUVyQztBQUNBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQSw2REFBNkQ7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLHFDQUFxQzs7QUFFckM7QUFDQSxtQ0FBbUM7O0FBRW5DO0FBQ0E7QUFDQSxpREFBaUQ7O0FBRWpEO0FBQ0EsdUNBQXVDO0FBQ3ZDLHVDQUF1Qzs7QUFFdkM7QUFDQSxpREFBaUQ7QUFDakQ7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxJQUFJO0FBQ0osd0NBQXdDO0FBQ3hDLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxnRUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EscUZBQXFGLHNCQUFzQjtBQUMzRyxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Qsc0JBQXNCO0FBQ3JGLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSw0Q0FBNEM7O0FBRTVDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0gsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxzQkFBc0I7QUFDeEUsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0Esd0RBQXdEOztBQUV4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsbUJBQW1CLG9CQUFvQjtBQUN2Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0EsSUFBSTtBQUNKOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQSxrREFBa0Q7O0FBRWxELHFCQUFxQjs7QUFFckIsb0JBQW9COztBQUVwQix3QkFBd0I7O0FBRXhCLHVCQUF1Qjs7QUFFdkIsdUJBQXVCOztBQUV2Qiw4QkFBOEI7O0FBRTlCLDBCQUEwQjs7QUFFMUIsd0JBQXdCOztBQUV4QixrQkFBa0I7OztBQUdsQjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLElBQUk7O0FBRUo7O0FBRUE7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsT0FBTzs7QUFFUDtBQUNBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTs7QUFFQTs7QUFFQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCLHlCQUF5QjtBQUN6QixtQkFBbUI7QUFDbkIsb0JBQW9CO0FBQ3BCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSw4RUFBOEU7O0FBRTlFO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQixrRkFBa0Y7QUFDbEY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0VBQWdFOztBQUVoRTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsb0JBQW9CO0FBQ3BCLHFCQUFxQjtBQUNyQixlQUFlO0FBQ2Y7QUFDQSxxQkFBcUI7O0FBRXJCLGlEQUFpRDtBQUNqRCwyQ0FBMkM7QUFDM0M7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsdUJBQXVCO0FBQ3ZCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EseURBQXlELHNCQUFzQjtBQUMvRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsZUFBZSwyQkFBMkI7QUFDMUM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTixLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhCQUE4QixpQkFBaUI7QUFDL0M7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQSw2REFBNkQ7QUFDN0Qsc0VBQXNFO0FBQ3RFO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0EsSUFBSTs7QUFFSjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHdDQUF3Qzs7QUFFeEM7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsbURBQW1EO0FBQ25EO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDhCQUE4QixhQUFhO0FBQzNDOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsdUNBQXVDO0FBQ3ZDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBLG1DQUFtQzs7QUFFbkM7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGdCQUFnQixLQUFLLGFBQWEsTUFBTTtBQUN4QztBQUNBLE1BQU0sMEJBQTBCOztBQUVoQztBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLG9CQUFvQixLQUFLLGFBQWEsTUFBTSw4Q0FBOEMsRUFBRTtBQUM1RjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGVBQWU7QUFDakM7QUFDQSxJQUFJO0FBQ0o7O0FBRUEsaUNBQWlDLGtEQUFrRDs7QUFFbkY7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEIsMEJBQTBCO0FBQzFCLHlCQUF5QjtBQUN6Qiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQjtBQUN4QztBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixzQkFBc0I7QUFDakQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTs7QUFFQTtBQUNBOztBQUVBLG9CQUFvQixxQkFBcUI7QUFDekM7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxnQkFBZ0Isc0JBQXNCO0FBQ3RDO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsZ0JBQWdCLHNCQUFzQjtBQUN0Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBOztBQUVBO0FBQ0EsNkJBQTZCO0FBQzdCOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxnQkFBZ0Isc0JBQXNCO0FBQ3RDOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxnQkFBZ0Isc0JBQXNCO0FBQ3RDO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjs7QUFFQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsT0FBTztBQUNQO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0Q7QUFDaEQsTUFBTTtBQUNOO0FBQ0E7QUFDQSxnREFBZ0Q7O0FBRWhEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFFBQVE7O0FBRVI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsT0FBTzs7QUFFUDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNOztBQUVOO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQ0FBaUMsd0RBQXdEO0FBQ3pGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxvQkFBb0IsV0FBVztBQUMvQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLE1BQU07QUFDTixLQUFLOztBQUVMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCLHNCQUFzQjtBQUN0QyxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ04sS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBOztBQUVBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsTUFBTTs7QUFFTjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxpQ0FBaUMsd0RBQXdEO0FBQ3pGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxnQkFBZ0Isc0JBQXNCO0FBQ3RDLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCLGVBQWU7QUFDaEM7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixzQkFBc0I7QUFDdkMsSUFBSTtBQUNKOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxxQkFBcUIsc0JBQXNCOztBQUUzQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EscUJBQXFCLHFCQUFxQjtBQUMxQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLG9CQUFvQjs7QUFFcEIsc0JBQXNCO0FBQ3RCLHlCQUF5QjtBQUN6QiwrQkFBK0I7O0FBRS9CO0FBQ0EsdUNBQXVDOztBQUV2QyxzQkFBc0I7QUFDdEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQ0FBaUMsaUVBQWlFO0FBQ2xHLElBQUk7QUFDSjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsbUZBQW1GOztBQUVuRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsWUFBWSx5REFBeUQ7QUFDckU7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLHlEQUF5RDtBQUNyRTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLDhDQUE4QyxFQUFFO0FBQ2hEO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EseUdBQXlHO0FBQ3pHO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsaUdBQWlHO0FBQ2pHO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsV0FBVzs7QUFFWDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLHVGQUF1RjtBQUN0Rzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVkseUNBQXlDO0FBQ3JEOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVDQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxZQUFZLHlDQUF5QztBQUNyRDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLCtEQUErRCxFQUFFO0FBQ2hGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkLGFBQWE7QUFDYixhQUFhO0FBQ2IsZUFBZTtBQUNmLGNBQWM7QUFDZCxlQUFlO0FBQ2YsZUFBZTtBQUNmLGVBQWU7QUFDZjs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnRkFBZ0Y7QUFDaEY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrQkFBa0IsRUFBRTs7QUFFcEI7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxHQUFHO0FBQ0gsaUJBQWlCO0FBQ2pCO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxpQkFBaUIsZUFBZTtBQUNoQztBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLE1BQU07O0FBRU47QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWU7O0FBRWY7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBOztBQUVBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNOztBQUVOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxtQkFBbUIsY0FBYztBQUNqQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBLHVCQUF1QjtBQUN2Qjs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRyxHQUFHLGdCQUFnQjs7QUFFdEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUcsR0FBRyxnQkFBZ0I7O0FBRXRCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esa0NBQWtDOztBQUVsQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7O0FBRUE7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBLGdCQUFnQixvQ0FBb0M7QUFDcEQ7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsb0JBQW9COztBQUVwQiw2QkFBNkI7QUFDN0I7QUFDQTtBQUNBLEVBQUUsRUFBRTtBQUNKO0FBQ0E7QUFDQSxFQUFFO0FBQ0YscUJBQXFCO0FBQ3JCO0FBQ0Esa0JBQWtCO0FBQ2xCLHVCQUF1QjtBQUN2Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUUsRUFBRTs7QUFFSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLG9FQUFvRTtBQUNwRTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7O0FBRXBCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CLHFCQUFxQjtBQUN6QztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCLGtCQUFrQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0JBQW9CLHdCQUF3QjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVTtBQUNWOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0Isd0JBQXdCO0FBQzVDO0FBQ0EsYUFBYTs7QUFFYjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0Esb0NBQW9DO0FBQ3BDLE9BQU87QUFDUDtBQUNBO0FBQ0EsUUFBUTtBQUNSLG1EQUFtRDtBQUNuRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUixPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLG9DQUFvQzs7QUFFcEM7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0gsRUFBRSxHQUFHLGdCQUFnQjs7QUFFckI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLCtDQUErQyxjQUFjO0FBQzdEOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSwyQkFBMkI7QUFDM0IsMkJBQTJCO0FBQzNCLHdCQUF3QjtBQUN4QixxQkFBcUI7QUFDckIsb0JBQW9CO0FBQ3BCLHlCQUF5QjtBQUN6QixpQkFBaUI7QUFDakIsNEJBQTRCO0FBQzVCLHlCQUF5QjtBQUN6QixnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNILEVBQUUsR0FBRyxnQkFBZ0I7O0FBRXJCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRSxHQUFHLGdCQUFnQjs7QUFFckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxvQkFBb0I7QUFDcEI7QUFDQSwyQkFBMkI7QUFDM0IsMkJBQTJCO0FBQzNCLHdCQUF3QjtBQUN4QixxQkFBcUI7QUFDckIsb0JBQW9CO0FBQ3BCLHlCQUF5QjtBQUN6Qix3QkFBd0I7QUFDeEIsaUJBQWlCO0FBQ2pCLGlCQUFpQjs7QUFFakI7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0gsRUFBRSxHQUFHLGdCQUFnQjtBQUNyQjtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQix1REFBdUQ7QUFDdkQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxvQkFBb0I7O0FBRXBCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsdUJBQXVCOztBQUV2Qjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBLHNCQUFzQixVQUFVO0FBQ2hDO0FBQ0E7O0FBRUE7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxzQ0FBc0M7QUFDdEM7O0FBRUEsMENBQTBDO0FBQzFDOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EscUNBQXFDLHNCQUFzQjtBQUMzRCxFQUFFOztBQUVGO0FBQ0EseUNBQXlDLHNCQUFzQjtBQUMvRCxFQUFFOztBQUVGO0FBQ0EscUNBQXFDLHNCQUFzQjtBQUMzRCxFQUFFOztBQUVGO0FBQ0EsNENBQTRDLHNCQUFzQjtBQUNsRSxFQUFFOztBQUVGO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQSxzQ0FBc0Msc0JBQXNCO0FBQzVELEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxJQUFJO0FBQ0osR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTs7QUFFQSxxQkFBcUIsYUFBYTtBQUNsQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBLHdDQUF3QyxzQkFBc0I7QUFDOUQsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTs7QUFFSjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsd0JBQXdCLFlBQVk7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsNkZBQTZGO0FBQzdGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHOztBQUVIO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMENBQTBDLHNCQUFzQjtBQUNoRSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0EseUNBQXlDLHNCQUFzQjtBQUMvRDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsMEJBQTBCOztBQUUxQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTs7QUFFQTs7QUFFQSxxRUFBcUU7QUFDckU7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBLHNCQUFzQjtBQUN0QixxQkFBcUI7QUFDckI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxNQUFNO0FBQ047O0FBRUE7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxxREFBcUQsZ0JBQWdCOztBQUVyRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDZEQUE2RCxnQkFBZ0I7O0FBRTdFO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEscUJBQXFCOztBQUVyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxrREFBa0QsZ0JBQWdCO0FBQ2xFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLG9EQUFvRCxnQkFBZ0I7O0FBRXBFO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDREQUE0RCxnQkFBZ0I7O0FBRTVFO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSxxQkFBcUI7O0FBRXJCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxrREFBa0QsZ0JBQWdCO0FBQ2xFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLCtLQUErSztBQUMvSzs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLDhCQUE4QjtBQUM5Qjs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTtBQUNBLG9CQUFvQjtBQUNwQix3QkFBd0I7QUFDeEIsNkJBQTZCO0FBQzdCLHNCQUFzQjtBQUN0Qix3QkFBd0I7QUFDeEIsbUNBQW1DO0FBQ25DOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTs7QUFFQSx1QkFBdUI7O0FBRXZCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLG9CQUFvQixpQkFBaUI7QUFDckM7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esd0pBQXdKO0FBQ3hKOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTtBQUNGLHdKQUF3SjtBQUN4Sjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEIsb0JBQW9CO0FBQ3BCLHNCQUFzQjtBQUN0Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTs7QUFFTjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLHFCQUFxQiwyQkFBMkI7QUFDaEQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCLG1GQUFtRjtBQUNwRztBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGVBQWUsNkJBQTZCO0FBQzVDOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSwyQkFBMkIsUUFBUTtBQUNuQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7QUFDRjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsaUVBQWUsU0FBUyIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy90YWJ1bGF0b3ItdGFibGVzL2Rpc3QvanMvdGFidWxhdG9yLmVzMjAxNS5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIFRhYnVsYXRvciB2NC45LjMgKGMpIE9saXZlciBGb2xrZXJkICovXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmZpbmRJbmRleFxuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleCkge1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsICdmaW5kSW5kZXgnLCB7XG5cblx0XHR2YWx1ZTogZnVuY3Rpb24gdmFsdWUocHJlZGljYXRlKSB7XG5cblx0XHRcdC8vIDEuIExldCBPIGJlID8gVG9PYmplY3QodGhpcyB2YWx1ZSkuXG5cblx0XHRcdGlmICh0aGlzID09IG51bGwpIHtcblxuXHRcdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdcInRoaXNcIiBpcyBudWxsIG9yIG5vdCBkZWZpbmVkJyk7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBvID0gT2JqZWN0KHRoaXMpO1xuXG5cdFx0XHQvLyAyLiBMZXQgbGVuIGJlID8gVG9MZW5ndGgoPyBHZXQoTywgXCJsZW5ndGhcIikpLlxuXG5cdFx0XHR2YXIgbGVuID0gby5sZW5ndGggPj4+IDA7XG5cblx0XHRcdC8vIDMuIElmIElzQ2FsbGFibGUocHJlZGljYXRlKSBpcyBmYWxzZSwgdGhyb3cgYSBUeXBlRXJyb3IgZXhjZXB0aW9uLlxuXG5cdFx0XHRpZiAodHlwZW9mIHByZWRpY2F0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ3ByZWRpY2F0ZSBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gNC4gSWYgdGhpc0FyZyB3YXMgc3VwcGxpZWQsIGxldCBUIGJlIHRoaXNBcmc7IGVsc2UgbGV0IFQgYmUgdW5kZWZpbmVkLlxuXG5cdFx0XHR2YXIgdGhpc0FyZyA9IGFyZ3VtZW50c1sxXTtcblxuXHRcdFx0Ly8gNS4gTGV0IGsgYmUgMC5cblxuXHRcdFx0dmFyIGsgPSAwO1xuXG5cdFx0XHQvLyA2LiBSZXBlYXQsIHdoaWxlIGsgPCBsZW5cblxuXHRcdFx0d2hpbGUgKGsgPCBsZW4pIHtcblxuXHRcdFx0XHQvLyBhLiBMZXQgUGsgYmUgISBUb1N0cmluZyhrKS5cblxuXHRcdFx0XHQvLyBiLiBMZXQga1ZhbHVlIGJlID8gR2V0KE8sIFBrKS5cblxuXHRcdFx0XHQvLyBjLiBMZXQgdGVzdFJlc3VsdCBiZSBUb0Jvb2xlYW4oPyBDYWxsKHByZWRpY2F0ZSwgVCwgwqsga1ZhbHVlLCBrLCBPIMK7KSkuXG5cblx0XHRcdFx0Ly8gZC4gSWYgdGVzdFJlc3VsdCBpcyB0cnVlLCByZXR1cm4gay5cblxuXHRcdFx0XHR2YXIga1ZhbHVlID0gb1trXTtcblxuXHRcdFx0XHRpZiAocHJlZGljYXRlLmNhbGwodGhpc0FyZywga1ZhbHVlLCBrLCBvKSkge1xuXG5cdFx0XHRcdFx0cmV0dXJuIGs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBlLiBJbmNyZWFzZSBrIGJ5IDEuXG5cblx0XHRcdFx0aysrO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyA3LiBSZXR1cm4gLTEuXG5cblx0XHRcdHJldHVybiAtMTtcblx0XHR9XG5cblx0fSk7XG59XG5cbi8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5maW5kXG5cbmlmICghQXJyYXkucHJvdG90eXBlLmZpbmQpIHtcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXkucHJvdG90eXBlLCAnZmluZCcsIHtcblxuXHRcdHZhbHVlOiBmdW5jdGlvbiB2YWx1ZShwcmVkaWNhdGUpIHtcblxuXHRcdFx0Ly8gMS4gTGV0IE8gYmUgPyBUb09iamVjdCh0aGlzIHZhbHVlKS5cblxuXHRcdFx0aWYgKHRoaXMgPT0gbnVsbCkge1xuXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ1widGhpc1wiIGlzIG51bGwgb3Igbm90IGRlZmluZWQnKTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIG8gPSBPYmplY3QodGhpcyk7XG5cblx0XHRcdC8vIDIuIExldCBsZW4gYmUgPyBUb0xlbmd0aCg/IEdldChPLCBcImxlbmd0aFwiKSkuXG5cblx0XHRcdHZhciBsZW4gPSBvLmxlbmd0aCA+Pj4gMDtcblxuXHRcdFx0Ly8gMy4gSWYgSXNDYWxsYWJsZShwcmVkaWNhdGUpIGlzIGZhbHNlLCB0aHJvdyBhIFR5cGVFcnJvciBleGNlcHRpb24uXG5cblx0XHRcdGlmICh0eXBlb2YgcHJlZGljYXRlICE9PSAnZnVuY3Rpb24nKSB7XG5cblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcigncHJlZGljYXRlIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyA0LiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhpc0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuXG5cblx0XHRcdHZhciB0aGlzQXJnID0gYXJndW1lbnRzWzFdO1xuXG5cdFx0XHQvLyA1LiBMZXQgayBiZSAwLlxuXG5cdFx0XHR2YXIgayA9IDA7XG5cblx0XHRcdC8vIDYuIFJlcGVhdCwgd2hpbGUgayA8IGxlblxuXG5cdFx0XHR3aGlsZSAoayA8IGxlbikge1xuXG5cdFx0XHRcdC8vIGEuIExldCBQayBiZSAhIFRvU3RyaW5nKGspLlxuXG5cdFx0XHRcdC8vIGIuIExldCBrVmFsdWUgYmUgPyBHZXQoTywgUGspLlxuXG5cdFx0XHRcdC8vIGMuIExldCB0ZXN0UmVzdWx0IGJlIFRvQm9vbGVhbig/IENhbGwocHJlZGljYXRlLCBULCDCqyBrVmFsdWUsIGssIE8gwrspKS5cblxuXHRcdFx0XHQvLyBkLiBJZiB0ZXN0UmVzdWx0IGlzIHRydWUsIHJldHVybiBrVmFsdWUuXG5cblx0XHRcdFx0dmFyIGtWYWx1ZSA9IG9ba107XG5cblx0XHRcdFx0aWYgKHByZWRpY2F0ZS5jYWxsKHRoaXNBcmcsIGtWYWx1ZSwgaywgbykpIHtcblxuXHRcdFx0XHRcdHJldHVybiBrVmFsdWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBlLiBJbmNyZWFzZSBrIGJ5IDEuXG5cblx0XHRcdFx0aysrO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyA3LiBSZXR1cm4gdW5kZWZpbmVkLlxuXG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHR9KTtcbn1cblxuLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvU3RyaW5nL2luY2x1ZGVzI1BvbHlmaWxsXG5cbmlmICghU3RyaW5nLnByb3RvdHlwZS5pbmNsdWRlcykge1xuXG5cdFN0cmluZy5wcm90b3R5cGUuaW5jbHVkZXMgPSBmdW5jdGlvbiAoc2VhcmNoLCBzdGFydCkge1xuXG5cdFx0J3VzZSBzdHJpY3QnO1xuXG5cdFx0aWYgKHNlYXJjaCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuXG5cdFx0XHR0aHJvdyBUeXBlRXJyb3IoJ2ZpcnN0IGFyZ3VtZW50IG11c3Qgbm90IGJlIGEgUmVnRXhwJyk7XG5cdFx0fVxuXG5cdFx0aWYgKHN0YXJ0ID09PSB1bmRlZmluZWQpIHtcblx0XHRcdHN0YXJ0ID0gMDtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5pbmRleE9mKHNlYXJjaCwgc3RhcnQpICE9PSAtMTtcblx0fTtcbn1cblxuLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmluY2x1ZGVzXG5cbmlmICghQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzKSB7XG5cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5LnByb3RvdHlwZSwgJ2luY2x1ZGVzJywge1xuXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHZhbHVlKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuXG5cdFx0XHRpZiAodGhpcyA9PSBudWxsKSB7XG5cblx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcignXCJ0aGlzXCIgaXMgbnVsbCBvciBub3QgZGVmaW5lZCcpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyAxLiBMZXQgTyBiZSA/IFRvT2JqZWN0KHRoaXMgdmFsdWUpLlxuXG5cdFx0XHR2YXIgbyA9IE9iamVjdCh0aGlzKTtcblxuXHRcdFx0Ly8gMi4gTGV0IGxlbiBiZSA/IFRvTGVuZ3RoKD8gR2V0KE8sIFwibGVuZ3RoXCIpKS5cblxuXHRcdFx0dmFyIGxlbiA9IG8ubGVuZ3RoID4+PiAwO1xuXG5cdFx0XHQvLyAzLiBJZiBsZW4gaXMgMCwgcmV0dXJuIGZhbHNlLlxuXG5cdFx0XHRpZiAobGVuID09PSAwKSB7XG5cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyA0LiBMZXQgbiBiZSA/IFRvSW50ZWdlcihmcm9tSW5kZXgpLlxuXG5cdFx0XHQvLyAgICAoSWYgZnJvbUluZGV4IGlzIHVuZGVmaW5lZCwgdGhpcyBzdGVwIHByb2R1Y2VzIHRoZSB2YWx1ZSAwLilcblxuXHRcdFx0dmFyIG4gPSBmcm9tSW5kZXggfCAwO1xuXG5cdFx0XHQvLyA1LiBJZiBuIOKJpSAwLCB0aGVuXG5cblx0XHRcdC8vICBhLiBMZXQgayBiZSBuLlxuXG5cdFx0XHQvLyA2LiBFbHNlIG4gPCAwLFxuXG5cdFx0XHQvLyAgYS4gTGV0IGsgYmUgbGVuICsgbi5cblxuXHRcdFx0Ly8gIGIuIElmIGsgPCAwLCBsZXQgayBiZSAwLlxuXG5cdFx0XHR2YXIgayA9IE1hdGgubWF4KG4gPj0gMCA/IG4gOiBsZW4gLSBNYXRoLmFicyhuKSwgMCk7XG5cblx0XHRcdGZ1bmN0aW9uIHNhbWVWYWx1ZVplcm8oeCwgeSkge1xuXG5cdFx0XHRcdHJldHVybiB4ID09PSB5IHx8IHR5cGVvZiB4ID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgeSA9PT0gJ251bWJlcicgJiYgaXNOYU4oeCkgJiYgaXNOYU4oeSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIDcuIFJlcGVhdCwgd2hpbGUgayA8IGxlblxuXG5cdFx0XHR3aGlsZSAoayA8IGxlbikge1xuXG5cdFx0XHRcdC8vIGEuIExldCBlbGVtZW50SyBiZSB0aGUgcmVzdWx0IG9mID8gR2V0KE8sICEgVG9TdHJpbmcoaykpLlxuXG5cdFx0XHRcdC8vIGIuIElmIFNhbWVWYWx1ZVplcm8oc2VhcmNoRWxlbWVudCwgZWxlbWVudEspIGlzIHRydWUsIHJldHVybiB0cnVlLlxuXG5cdFx0XHRcdGlmIChzYW1lVmFsdWVaZXJvKG9ba10sIHNlYXJjaEVsZW1lbnQpKSB7XG5cblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIGMuIEluY3JlYXNlIGsgYnkgMS5cblxuXHRcdFx0XHRrKys7XG5cdFx0XHR9XG5cblx0XHRcdC8vIDguIFJldHVybiBmYWxzZVxuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdH0pO1xufVxuXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3QvYXNzaWduI1BvbHlmaWxsXG5cbmlmICh0eXBlb2YgT2JqZWN0LmFzc2lnbiAhPT0gJ2Z1bmN0aW9uJykge1xuXG5cdC8vIE11c3QgYmUgd3JpdGFibGU6IHRydWUsIGVudW1lcmFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IHRydWVcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JqZWN0LCBcImFzc2lnblwiLCB7XG5cblx0XHR2YWx1ZTogZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgdmFyQXJncykge1xuXHRcdFx0Ly8gLmxlbmd0aCBvZiBmdW5jdGlvbiBpcyAyXG5cblx0XHRcdCd1c2Ugc3RyaWN0JztcblxuXHRcdFx0aWYgKHRhcmdldCA9PT0gbnVsbCB8fCB0YXJnZXQgPT09IHVuZGVmaW5lZCkge1xuXG5cdFx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgdG8gPSBPYmplY3QodGFyZ2V0KTtcblxuXHRcdFx0Zm9yICh2YXIgaW5kZXggPSAxOyBpbmRleCA8IGFyZ3VtZW50cy5sZW5ndGg7IGluZGV4KyspIHtcblxuXHRcdFx0XHR2YXIgbmV4dFNvdXJjZSA9IGFyZ3VtZW50c1tpbmRleF07XG5cblx0XHRcdFx0aWYgKG5leHRTb3VyY2UgIT09IG51bGwgJiYgbmV4dFNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XG5cblx0XHRcdFx0XHRmb3IgKHZhciBuZXh0S2V5IGluIG5leHRTb3VyY2UpIHtcblxuXHRcdFx0XHRcdFx0Ly8gQXZvaWQgYnVncyB3aGVuIGhhc093blByb3BlcnR5IGlzIHNoYWRvd2VkXG5cblx0XHRcdFx0XHRcdGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobmV4dFNvdXJjZSwgbmV4dEtleSkpIHtcblxuXHRcdFx0XHRcdFx0XHR0b1tuZXh0S2V5XSA9IG5leHRTb3VyY2VbbmV4dEtleV07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB0bztcblx0XHR9LFxuXG5cdFx0d3JpdGFibGU6IHRydWUsXG5cblx0XHRjb25maWd1cmFibGU6IHRydWVcblxuXHR9KTtcbn1cblxudmFyIENvbHVtbk1hbmFnZXIgPSBmdW5jdGlvbiBDb2x1bW5NYW5hZ2VyKHRhYmxlKSB7XG5cblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgcGFyZW50IHRhYmxlXG5cblx0dGhpcy5ibG9ja0hvelNjcm9sbEV2ZW50ID0gZmFsc2U7XG5cblx0dGhpcy5oZWFkZXJzRWxlbWVudCA9IHRoaXMuY3JlYXRlSGVhZGVyc0VsZW1lbnQoKTtcblxuXHR0aGlzLmVsZW1lbnQgPSB0aGlzLmNyZWF0ZUhlYWRlckVsZW1lbnQoKTsgLy9jb250YWluaW5nIGVsZW1lbnRcblxuXHR0aGlzLnJvd01hbmFnZXIgPSBudWxsOyAvL2hvbGQgcm93IG1hbmFnZXIgb2JqZWN0XG5cblx0dGhpcy5jb2x1bW5zID0gW107IC8vIGNvbHVtbiBkZWZpbml0aW9uIG9iamVjdFxuXG5cdHRoaXMuY29sdW1uc0J5SW5kZXggPSBbXTsgLy9jb2x1bW5zIGJ5IGluZGV4XG5cblx0dGhpcy5jb2x1bW5zQnlGaWVsZCA9IHt9OyAvL2NvbHVtbnMgYnkgZmllbGRcblxuXHR0aGlzLnNjcm9sbExlZnQgPSAwO1xuXG5cdHRoaXMuZWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5oZWFkZXJzRWxlbWVudCwgdGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xufTtcblxuLy8vLy8vLy8vLy8vLy8gU2V0dXAgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy8vLy8vXG5cblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuY3JlYXRlSGVhZGVyc0VsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWhlYWRlcnNcIik7XG5cblx0cmV0dXJuIGVsO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuY3JlYXRlSGVhZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblxuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyXCIpO1xuXG5cdGlmICghdGhpcy50YWJsZS5vcHRpb25zLmhlYWRlclZpc2libGUpIHtcblxuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyLWhpZGRlblwiKTtcblx0fVxuXG5cdHJldHVybiBlbDtcbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdC8vc2Nyb2xsIGJvZHkgYWxvbmcgd2l0aCBoZWFkZXJcblxuXHQvLyBzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbihlKXtcblxuXHQvLyBcdGlmKCFzZWxmLmJsb2NrSG96U2Nyb2xsRXZlbnQpe1xuXG5cdC8vIFx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChzZWxmLmVsZW1lbnQuc2Nyb2xsTGVmdCk7XG5cblx0Ly8gXHR9XG5cblx0Ly8gfSk7XG59O1xuXG4vL2xpbmsgdG8gcm93IG1hbmFnZXJcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuc2V0Um93TWFuYWdlciA9IGZ1bmN0aW9uIChtYW5hZ2VyKSB7XG5cblx0dGhpcy5yb3dNYW5hZ2VyID0gbWFuYWdlcjtcbn07XG5cbi8vcmV0dXJuIGNvbnRhaW5pbmcgZWxlbWVudFxuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5nZXRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXG5cdHJldHVybiB0aGlzLmVsZW1lbnQ7XG59O1xuXG4vL3JldHVybiBoZWFkZXIgY29udGFpbmluZyBlbGVtZW50XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmdldEhlYWRlcnNFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXG5cdHJldHVybiB0aGlzLmhlYWRlcnNFbGVtZW50O1xufTtcblxuLy8gQ29sdW1uTWFuYWdlci5wcm90b3R5cGUudGVtcFNjcm9sbEJsb2NrID0gZnVuY3Rpb24oKXtcblxuLy8gXHRjbGVhclRpbWVvdXQodGhpcy5ibG9ja0hvelNjcm9sbEV2ZW50KTtcblxuLy8gXHR0aGlzLmJsb2NrSG96U2Nyb2xsRXZlbnQgPSBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLmJsb2NrSG96U2Nyb2xsRXZlbnQgPSBmYWxzZTt9LCA1MCk7XG5cbi8vIH1cblxuXG4vL3Njcm9sbCBob3Jpem9udGFsbHkgdG8gbWF0Y2ggdGFibGUgYm9keVxuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5zY3JvbGxIb3Jpem9udGFsID0gZnVuY3Rpb24gKGxlZnQpIHtcblxuXHR2YXIgaG96QWRqdXN0ID0gMCxcblx0ICAgIHNjcm9sbFdpZHRoID0gdGhpcy5lbGVtZW50LnNjcm9sbFdpZHRoIC0gdGhpcy50YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoO1xuXG5cdC8vIHRoaXMudGVtcFNjcm9sbEJsb2NrKCk7XG5cblx0dGhpcy5lbGVtZW50LnNjcm9sbExlZnQgPSBsZWZ0O1xuXG5cdC8vYWRqdXN0IGZvciB2ZXJ0aWNhbCBzY3JvbGxiYXIgbW92aW5nIHRhYmxlIHdoZW4gcHJlc2VudFxuXG5cdGlmIChsZWZ0ID4gc2Nyb2xsV2lkdGgpIHtcblxuXHRcdGhvekFkanVzdCA9IGxlZnQgLSBzY3JvbGxXaWR0aDtcblxuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gLWhvekFkanVzdCArIFwicHhcIjtcblx0fSBlbHNlIHtcblxuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gMDtcblx0fVxuXG5cdC8va2VlcCBmcm96ZW4gY29sdW1ucyBmaXhlZCBpbiBwb3NpdGlvblxuXG5cdC8vdGhpcy5fY2FsY0Zyb3plbkNvbHVtbnNQb3MoaG96QWRqdXN0ICsgMyk7XG5cblxuXHR0aGlzLnNjcm9sbExlZnQgPSBsZWZ0O1xuXG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZyb3plbkNvbHVtbnNcIikpIHtcblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLnNjcm9sbEhvcml6b250YWwoKTtcblx0fVxufTtcblxuLy8vLy8vLy8vLy8vLyBDb2x1bW4gU2V0dXAgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy9cblxuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5nZW5lcmF0ZUNvbHVtbnNGcm9tUm93RGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cblx0dmFyIGNvbHMgPSBbXSxcblx0ICAgIGRlZmluaXRpb25zID0gdGhpcy50YWJsZS5vcHRpb25zLmF1dG9Db2x1bW5zRGVmaW5pdGlvbnMsXG5cdCAgICByb3csXG5cdCAgICBzb3J0ZXI7XG5cblx0aWYgKGRhdGEgJiYgZGF0YS5sZW5ndGgpIHtcblxuXHRcdHJvdyA9IGRhdGFbMF07XG5cblx0XHRmb3IgKHZhciBrZXkgaW4gcm93KSB7XG5cblx0XHRcdHZhciBjb2wgPSB7XG5cblx0XHRcdFx0ZmllbGQ6IGtleSxcblxuXHRcdFx0XHR0aXRsZToga2V5XG5cblx0XHRcdH07XG5cblx0XHRcdHZhciB2YWx1ZSA9IHJvd1trZXldO1xuXG5cdFx0XHRzd2l0Y2ggKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWUpKSB7XG5cblx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXG5cdFx0XHRcdFx0c29ydGVyID0gXCJzdHJpbmdcIjtcblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJib29sZWFuXCI6XG5cblx0XHRcdFx0XHRzb3J0ZXIgPSBcImJvb2xlYW5cIjtcblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblxuXHRcdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuXG5cdFx0XHRcdFx0XHRzb3J0ZXIgPSBcImFycmF5XCI7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0c29ydGVyID0gXCJzdHJpbmdcIjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OlxuXG5cdFx0XHRcdFx0aWYgKCFpc05hTih2YWx1ZSkgJiYgdmFsdWUgIT09IFwiXCIpIHtcblxuXHRcdFx0XHRcdFx0c29ydGVyID0gXCJudW1iZXJcIjtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUubWF0Y2goLygoXlswLTldK1thLXpdKyl8KF5bYS16XStbMC05XSspKSskL2kpKSB7XG5cblx0XHRcdFx0XHRcdFx0c29ydGVyID0gXCJhbHBoYW51bVwiO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHRzb3J0ZXIgPSBcInN0cmluZ1wiO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cblx0XHRcdGNvbC5zb3J0ZXIgPSBzb3J0ZXI7XG5cblx0XHRcdGNvbHMucHVzaChjb2wpO1xuXHRcdH1cblxuXHRcdGlmIChkZWZpbml0aW9ucykge1xuXG5cdFx0XHRzd2l0Y2ggKHR5cGVvZiBkZWZpbml0aW9ucyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZGVmaW5pdGlvbnMpKSB7XG5cblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cblx0XHRcdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucyA9IGRlZmluaXRpb25zLmNhbGwodGhpcy50YWJsZSwgY29scyk7XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cblx0XHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheShkZWZpbml0aW9ucykpIHtcblxuXHRcdFx0XHRcdFx0Y29scy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wpIHtcblxuXHRcdFx0XHRcdFx0XHR2YXIgbWF0Y2ggPSBkZWZpbml0aW9ucy5maW5kKGZ1bmN0aW9uIChkZWYpIHtcblxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBkZWYuZmllbGQgPT09IGNvbC5maWVsZDtcblx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cblx0XHRcdFx0XHRcdFx0XHRPYmplY3QuYXNzaWduKGNvbCwgbWF0Y2gpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRjb2xzLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXG5cdFx0XHRcdFx0XHRcdGlmIChkZWZpbml0aW9uc1tjb2wuZmllbGRdKSB7XG5cblx0XHRcdFx0XHRcdFx0XHRPYmplY3QuYXNzaWduKGNvbCwgZGVmaW5pdGlvbnNbY29sLmZpZWxkXSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5zID0gY29scztcblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMgPSBjb2xzO1xuXHRcdH1cblxuXHRcdHRoaXMuc2V0Q29sdW1ucyh0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucyk7XG5cdH1cbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLnNldENvbHVtbnMgPSBmdW5jdGlvbiAoY29scywgcm93KSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHdoaWxlIChzZWxmLmhlYWRlcnNFbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRzZWxmLmhlYWRlcnNFbGVtZW50LnJlbW92ZUNoaWxkKHNlbGYuaGVhZGVyc0VsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdH1zZWxmLmNvbHVtbnMgPSBbXTtcblxuXHRzZWxmLmNvbHVtbnNCeUluZGV4ID0gW107XG5cblx0c2VsZi5jb2x1bW5zQnlGaWVsZCA9IHt9O1xuXG5cdC8vcmVzZXQgZnJvemVuIGNvbHVtbnNcblxuXHRpZiAoc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Db2x1bW5zXCIpKSB7XG5cblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucy5yZXNldCgpO1xuXHR9XG5cblx0Y29scy5mb3JFYWNoKGZ1bmN0aW9uIChkZWYsIGkpIHtcblxuXHRcdHNlbGYuX2FkZENvbHVtbihkZWYpO1xuXHR9KTtcblxuXHRzZWxmLl9yZUluZGV4Q29sdW1ucygpO1xuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpIHtcblxuXHRcdHNlbGYudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LmluaXRpYWxpemUoKTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveikge1xuXG5cdFx0dGhpcy50YWJsZS52ZG9tSG96LnJlaW5pdGlhbGl6ZShmYWxzZSwgdHJ1ZSk7XG5cdH1cblxuXHRzZWxmLnJlZHJhdyh0cnVlKTtcbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLl9hZGRDb2x1bW4gPSBmdW5jdGlvbiAoZGVmaW5pdGlvbiwgYmVmb3JlLCBuZXh0VG9Db2x1bW4pIHtcblxuXHR2YXIgY29sdW1uID0gbmV3IENvbHVtbihkZWZpbml0aW9uLCB0aGlzKSxcblx0ICAgIGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKSxcblx0ICAgIGluZGV4ID0gbmV4dFRvQ29sdW1uID8gdGhpcy5maW5kQ29sdW1uSW5kZXgobmV4dFRvQ29sdW1uKSA6IG5leHRUb0NvbHVtbjtcblxuXHRpZiAobmV4dFRvQ29sdW1uICYmIGluZGV4ID4gLTEpIHtcblxuXHRcdHZhciBwYXJlbnRJbmRleCA9IHRoaXMuY29sdW1ucy5pbmRleE9mKG5leHRUb0NvbHVtbi5nZXRUb3BDb2x1bW4oKSk7XG5cblx0XHR2YXIgbmV4dEVsID0gbmV4dFRvQ29sdW1uLmdldEVsZW1lbnQoKTtcblxuXHRcdGlmIChiZWZvcmUpIHtcblxuXHRcdFx0dGhpcy5jb2x1bW5zLnNwbGljZShwYXJlbnRJbmRleCwgMCwgY29sdW1uKTtcblxuXHRcdFx0bmV4dEVsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGNvbEVsLCBuZXh0RWwpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHRoaXMuY29sdW1ucy5zcGxpY2UocGFyZW50SW5kZXggKyAxLCAwLCBjb2x1bW4pO1xuXG5cdFx0XHRuZXh0RWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY29sRWwsIG5leHRFbC5uZXh0U2libGluZyk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXG5cdFx0aWYgKGJlZm9yZSkge1xuXG5cdFx0XHR0aGlzLmNvbHVtbnMudW5zaGlmdChjb2x1bW4pO1xuXG5cdFx0XHR0aGlzLmhlYWRlcnNFbGVtZW50Lmluc2VydEJlZm9yZShjb2x1bW4uZ2V0RWxlbWVudCgpLCB0aGlzLmhlYWRlcnNFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHRoaXMuY29sdW1ucy5wdXNoKGNvbHVtbik7XG5cblx0XHRcdHRoaXMuaGVhZGVyc0VsZW1lbnQuYXBwZW5kQ2hpbGQoY29sdW1uLmdldEVsZW1lbnQoKSk7XG5cdFx0fVxuXG5cdFx0Y29sdW1uLmNvbHVtblJlbmRlcmVkKCk7XG5cdH1cblxuXHRyZXR1cm4gY29sdW1uO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXJDb2x1bW5GaWVsZCA9IGZ1bmN0aW9uIChjb2wpIHtcblxuXHRpZiAoY29sLmRlZmluaXRpb24uZmllbGQpIHtcblxuXHRcdHRoaXMuY29sdW1uc0J5RmllbGRbY29sLmRlZmluaXRpb24uZmllbGRdID0gY29sO1xuXHR9XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5yZWdpc3RlckNvbHVtblBvc2l0aW9uID0gZnVuY3Rpb24gKGNvbCkge1xuXG5cdHRoaXMuY29sdW1uc0J5SW5kZXgucHVzaChjb2wpO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuX3JlSW5kZXhDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuXG5cdHRoaXMuY29sdW1uc0J5SW5kZXggPSBbXTtcblxuXHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHRjb2x1bW4ucmVSZWdpc3RlclBvc2l0aW9uKCk7XG5cdH0pO1xufTtcblxuLy9lbnN1cmUgY29sdW1uIGhlYWRlcnMgdGFrZSB1cCB0aGUgY29ycmVjdCBhbW91bnQgb2Ygc3BhY2UgaW4gY29sdW1uIGdyb3Vwc1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5fdmVydGljYWxBbGlnbkhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgbWluSGVpZ2h0ID0gMDtcblxuXHRzZWxmLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHR2YXIgaGVpZ2h0O1xuXG5cdFx0Y29sdW1uLmNsZWFyVmVydGljYWxBbGlnbigpO1xuXG5cdFx0aGVpZ2h0ID0gY29sdW1uLmdldEhlaWdodCgpO1xuXG5cdFx0aWYgKGhlaWdodCA+IG1pbkhlaWdodCkge1xuXG5cdFx0XHRtaW5IZWlnaHQgPSBoZWlnaHQ7XG5cdFx0fVxuXHR9KTtcblxuXHRzZWxmLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHRjb2x1bW4udmVydGljYWxBbGlnbihzZWxmLnRhYmxlLm9wdGlvbnMuY29sdW1uSGVhZGVyVmVydEFsaWduLCBtaW5IZWlnaHQpO1xuXHR9KTtcblxuXHRzZWxmLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIENvbHVtbiBEZXRhaWxzIC8vLy8vLy8vLy8vLy8vLy8vXG5cblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZmluZENvbHVtbiA9IGZ1bmN0aW9uIChzdWJqZWN0KSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdGlmICgodHlwZW9mIHN1YmplY3QgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHN1YmplY3QpKSA9PSBcIm9iamVjdFwiKSB7XG5cblx0XHRpZiAoc3ViamVjdCBpbnN0YW5jZW9mIENvbHVtbikge1xuXG5cdFx0XHQvL3N1YmplY3QgaXMgY29sdW1uIGVsZW1lbnRcblxuXHRcdFx0cmV0dXJuIHN1YmplY3Q7XG5cdFx0fSBlbHNlIGlmIChzdWJqZWN0IGluc3RhbmNlb2YgQ29sdW1uQ29tcG9uZW50KSB7XG5cblx0XHRcdC8vc3ViamVjdCBpcyBwdWJsaWMgY29sdW1uIGNvbXBvbmVudFxuXG5cdFx0XHRyZXR1cm4gc3ViamVjdC5fZ2V0U2VsZigpIHx8IGZhbHNlO1xuXHRcdH0gZWxzZSBpZiAodHlwZW9mIEhUTUxFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIHN1YmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuXG5cdFx0XHQvL3N1YmplY3QgaXMgYSBIVE1MIGVsZW1lbnQgb2YgdGhlIGNvbHVtbiBoZWFkZXJcblxuXHRcdFx0dmFyIG1hdGNoID0gc2VsZi5jb2x1bW5zLmZpbmQoZnVuY3Rpb24gKGNvbHVtbikge1xuXG5cdFx0XHRcdHJldHVybiBjb2x1bW4uZWxlbWVudCA9PT0gc3ViamVjdDtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gbWF0Y2ggfHwgZmFsc2U7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXG5cdFx0Ly9zdWJqZWN0IHNob3VsZCBiZSB0cmVhdGVkIGFzIHRoZSBmaWVsZCBuYW1lIG9mIHRoZSBjb2x1bW5cblxuXHRcdHJldHVybiB0aGlzLmNvbHVtbnNCeUZpZWxkW3N1YmplY3RdIHx8IGZhbHNlO1xuXHR9XG5cblx0Ly9jYXRjaCBhbGwgZm9yIGFueSBvdGhlciB0eXBlIG9mIGlucHV0XG5cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5nZXRDb2x1bW5CeUZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XG5cblx0cmV0dXJuIHRoaXMuY29sdW1uc0J5RmllbGRbZmllbGRdO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0Q29sdW1uc0J5RmllbGRSb290ID0gZnVuY3Rpb24gKHJvb3QpIHtcblx0dmFyIF90aGlzID0gdGhpcztcblxuXHR2YXIgbWF0Y2hlcyA9IFtdO1xuXG5cdE9iamVjdC5rZXlzKHRoaXMuY29sdW1uc0J5RmllbGQpLmZvckVhY2goZnVuY3Rpb24gKGZpZWxkKSB7XG5cblx0XHR2YXIgZmllbGRSb290ID0gZmllbGQuc3BsaXQoXCIuXCIpWzBdO1xuXG5cdFx0aWYgKGZpZWxkUm9vdCA9PT0gcm9vdCkge1xuXG5cdFx0XHRtYXRjaGVzLnB1c2goX3RoaXMuY29sdW1uc0J5RmllbGRbZmllbGRdKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBtYXRjaGVzO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0Q29sdW1uQnlJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuXG5cdHJldHVybiB0aGlzLmNvbHVtbnNCeUluZGV4W2luZGV4XTtcbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmdldEZpcnN0VmlzaWJpbGVDb2x1bW4gPSBmdW5jdGlvbiAoaW5kZXgpIHtcblxuXHR2YXIgaW5kZXggPSB0aGlzLmNvbHVtbnNCeUluZGV4LmZpbmRJbmRleChmdW5jdGlvbiAoY29sKSB7XG5cblx0XHRyZXR1cm4gY29sLnZpc2libGU7XG5cdH0pO1xuXG5cdHJldHVybiBpbmRleCA+IC0xID8gdGhpcy5jb2x1bW5zQnlJbmRleFtpbmRleF0gOiBmYWxzZTtcbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG5cblx0cmV0dXJuIHRoaXMuY29sdW1ucztcbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmZpbmRDb2x1bW5JbmRleCA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRyZXR1cm4gdGhpcy5jb2x1bW5zQnlJbmRleC5maW5kSW5kZXgoZnVuY3Rpb24gKGNvbCkge1xuXG5cdFx0cmV0dXJuIGNvbHVtbiA9PT0gY29sO1xuXHR9KTtcbn07XG5cbi8vcmV0dXJuIGFsbCBjb2x1bW5zIHRoYXQgYXJlIG5vdCBncm91cHNcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0UmVhbENvbHVtbnMgPSBmdW5jdGlvbiAoKSB7XG5cblx0cmV0dXJuIHRoaXMuY29sdW1uc0J5SW5kZXg7XG59O1xuXG4vL3RyYXZlcnMgYWNyb3NzIGNvbHVtbnMgYW5kIGNhbGwgYWN0aW9uXG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLnRyYXZlcnNlID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHNlbGYuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uLCBpKSB7XG5cblx0XHRjYWxsYmFjayhjb2x1bW4sIGkpO1xuXHR9KTtcbn07XG5cbi8vZ2V0IGRlZmludGlvbnMgb2YgYWN0dWFsIGNvbHVtbnNcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0RGVmaW5pdGlvbnMgPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0c2VsZi5jb2x1bW5zQnlJbmRleC5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdGlmICghYWN0aXZlIHx8IGFjdGl2ZSAmJiBjb2x1bW4udmlzaWJsZSkge1xuXG5cdFx0XHRvdXRwdXQucHVzaChjb2x1bW4uZ2V0RGVmaW5pdGlvbigpKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG4vL2dldCBmdWxsIG5lc3RlZCBkZWZpbml0aW9uIHRyZWVcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0RGVmaW5pdGlvblRyZWUgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0c2VsZi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXG5cdFx0b3V0cHV0LnB1c2goY29sdW1uLmdldERlZmluaXRpb24odHJ1ZSkpO1xuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUuZ2V0Q29tcG9uZW50cyA9IGZ1bmN0aW9uIChzdHJ1Y3R1cmVkKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW10sXG5cdCAgICBjb2x1bW5zID0gc3RydWN0dXJlZCA/IHNlbGYuY29sdW1ucyA6IHNlbGYuY29sdW1uc0J5SW5kZXg7XG5cblx0Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdG91dHB1dC5wdXNoKGNvbHVtbi5nZXRDb21wb25lbnQoKSk7XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHtcblxuXHR2YXIgd2lkdGggPSAwO1xuXG5cdHRoaXMuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHRpZiAoY29sdW1uLnZpc2libGUpIHtcblxuXHRcdFx0d2lkdGggKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gd2lkdGg7XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5tb3ZlQ29sdW1uID0gZnVuY3Rpb24gKGZyb20sIHRvLCBhZnRlcikge1xuXG5cdHRoaXMubW92ZUNvbHVtbkFjdHVhbChmcm9tLCB0bywgYWZ0ZXIpO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpIHtcblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LmluaXRpYWxpemUoKTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjKHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0fVxuXG5cdHRvLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZnJvbS5lbGVtZW50LCB0by5lbGVtZW50KTtcblxuXHRpZiAoYWZ0ZXIpIHtcblxuXHRcdHRvLmVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodG8uZWxlbWVudCwgZnJvbS5lbGVtZW50KTtcblx0fVxuXG5cdHRoaXMuX3ZlcnRpY2FsQWxpZ25IZWFkZXJzKCk7XG5cblx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlaW5pdGlhbGl6ZSgpO1xufTtcblxuQ29sdW1uTWFuYWdlci5wcm90b3R5cGUubW92ZUNvbHVtbkFjdHVhbCA9IGZ1bmN0aW9uIChmcm9tLCB0bywgYWZ0ZXIpIHtcblxuXHRpZiAoZnJvbS5wYXJlbnQuaXNHcm91cCkge1xuXG5cdFx0dGhpcy5fbW92ZUNvbHVtbkluQXJyYXkoZnJvbS5wYXJlbnQuY29sdW1ucywgZnJvbSwgdG8sIGFmdGVyKTtcblx0fSBlbHNlIHtcblxuXHRcdHRoaXMuX21vdmVDb2x1bW5JbkFycmF5KHRoaXMuY29sdW1ucywgZnJvbSwgdG8sIGFmdGVyKTtcblx0fVxuXG5cdHRoaXMuX21vdmVDb2x1bW5JbkFycmF5KHRoaXMuY29sdW1uc0J5SW5kZXgsIGZyb20sIHRvLCBhZnRlciwgdHJ1ZSk7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQuaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy52aXJ0dWFsRG9tSG96KSB7XG5cblx0XHR0aGlzLnRhYmxlLnZkb21Ib3oucmVpbml0aWFsaXplKHRydWUpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5Nb3ZlZCkge1xuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbk1vdmVkLmNhbGwodGhpcy50YWJsZSwgZnJvbS5nZXRDb21wb25lbnQoKSwgdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbXBvbmVudHMoKSk7XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgdGhpcy50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5jb2x1bW5zKSB7XG5cblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2Uuc2F2ZShcImNvbHVtbnNcIik7XG5cdH1cbn07XG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLl9tb3ZlQ29sdW1uSW5BcnJheSA9IGZ1bmN0aW9uIChjb2x1bW5zLCBmcm9tLCB0bywgYWZ0ZXIsIHVwZGF0ZVJvd3MpIHtcblx0dmFyIF90aGlzMiA9IHRoaXM7XG5cblx0dmFyIGZyb21JbmRleCA9IGNvbHVtbnMuaW5kZXhPZihmcm9tKSxcblx0ICAgIHRvSW5kZXgsXG5cdCAgICByb3dzID0gW107XG5cblx0aWYgKGZyb21JbmRleCA+IC0xKSB7XG5cblx0XHRjb2x1bW5zLnNwbGljZShmcm9tSW5kZXgsIDEpO1xuXG5cdFx0dG9JbmRleCA9IGNvbHVtbnMuaW5kZXhPZih0byk7XG5cblx0XHRpZiAodG9JbmRleCA+IC0xKSB7XG5cblx0XHRcdGlmIChhZnRlcikge1xuXG5cdFx0XHRcdHRvSW5kZXggPSB0b0luZGV4ICsgMTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHR0b0luZGV4ID0gZnJvbUluZGV4O1xuXHRcdH1cblxuXHRcdGNvbHVtbnMuc3BsaWNlKHRvSW5kZXgsIDAsIGZyb20pO1xuXG5cdFx0aWYgKHVwZGF0ZVJvd3MpIHtcblxuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIsIHRydWUpKSB7XG5cblx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cblx0XHRcdFx0XHRyb3dzID0gcm93cy5jb25jYXQoX3RoaXMyLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZ2V0VHJlZUNoaWxkcmVuKHJvdywgZmFsc2UsIHRydWUpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHJvd3MgPSByb3dzLmNvbmNhdCh0aGlzLnRhYmxlLnJvd01hbmFnZXIucm93cyk7XG5cblx0XHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cblx0XHRcdFx0aWYgKHJvdy5jZWxscy5sZW5ndGgpIHtcblxuXHRcdFx0XHRcdHZhciBjZWxsID0gcm93LmNlbGxzLnNwbGljZShmcm9tSW5kZXgsIDEpWzBdO1xuXG5cdFx0XHRcdFx0cm93LmNlbGxzLnNwbGljZSh0b0luZGV4LCAwLCBjZWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5zY3JvbGxUb0NvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4sIHBvc2l0aW9uLCBpZlZpc2libGUpIHtcblx0dmFyIF90aGlzMyA9IHRoaXM7XG5cblx0dmFyIGxlZnQgPSAwLFxuXHQgICAgb2Zmc2V0ID0gMCxcblx0ICAgIGFkanVzdCA9IDAsXG5cdCAgICBjb2xFbCA9IGNvbHVtbi5nZXRFbGVtZW50KCk7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuXHRcdGlmICh0eXBlb2YgcG9zaXRpb24gPT09IFwidW5kZWZpbmVkXCIpIHtcblxuXHRcdFx0cG9zaXRpb24gPSBfdGhpczMudGFibGUub3B0aW9ucy5zY3JvbGxUb0NvbHVtblBvc2l0aW9uO1xuXHRcdH1cblxuXHRcdGlmICh0eXBlb2YgaWZWaXNpYmxlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cblx0XHRcdGlmVmlzaWJsZSA9IF90aGlzMy50YWJsZS5vcHRpb25zLnNjcm9sbFRvQ29sdW1uSWZWaXNpYmxlO1xuXHRcdH1cblxuXHRcdGlmIChjb2x1bW4udmlzaWJsZSkge1xuXG5cdFx0XHQvL2FsaWduIHRvIGNvcnJlY3QgcG9zaXRpb25cblxuXHRcdFx0c3dpdGNoIChwb3NpdGlvbikge1xuXG5cdFx0XHRcdGNhc2UgXCJtaWRkbGVcIjpcblxuXHRcdFx0XHRjYXNlIFwiY2VudGVyXCI6XG5cblx0XHRcdFx0XHRhZGp1c3QgPSAtX3RoaXMzLmVsZW1lbnQuY2xpZW50V2lkdGggLyAyO1xuXG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSBcInJpZ2h0XCI6XG5cblx0XHRcdFx0XHRhZGp1c3QgPSBjb2xFbC5jbGllbnRXaWR0aCAtIF90aGlzMy5oZWFkZXJzRWxlbWVudC5jbGllbnRXaWR0aDtcblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vY2hlY2sgY29sdW1uIHZpc2liaWxpdHlcblxuXHRcdFx0aWYgKCFpZlZpc2libGUpIHtcblxuXHRcdFx0XHRvZmZzZXQgPSBjb2xFbC5vZmZzZXRMZWZ0O1xuXG5cdFx0XHRcdGlmIChvZmZzZXQgPiAwICYmIG9mZnNldCArIGNvbEVsLm9mZnNldFdpZHRoIDwgX3RoaXMzLmVsZW1lbnQuY2xpZW50V2lkdGgpIHtcblxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL2NhbGN1bGF0ZSBzY3JvbGwgcG9zaXRpb25cblxuXHRcdFx0bGVmdCA9IGNvbEVsLm9mZnNldExlZnQgKyBhZGp1c3Q7XG5cblx0XHRcdGxlZnQgPSBNYXRoLm1heChNYXRoLm1pbihsZWZ0LCBfdGhpczMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbFdpZHRoIC0gX3RoaXMzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCksIDApO1xuXG5cdFx0XHRfdGhpczMudGFibGUucm93TWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXG5cdFx0XHRfdGhpczMuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblxuXHRcdFx0cmVzb2x2ZSgpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGNvbnNvbGUud2FybihcIlNjcm9sbCBFcnJvciAtIENvbHVtbiBub3QgdmlzaWJsZVwiKTtcblxuXHRcdFx0cmVqZWN0KFwiU2Nyb2xsIEVycm9yIC0gQ29sdW1uIG5vdCB2aXNpYmxlXCIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIENlbGwgTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vLy8vL1xuXG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmdlbmVyYXRlQ2VsbHMgPSBmdW5jdGlvbiAocm93KSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHZhciBjZWxscyA9IFtdO1xuXG5cdHNlbGYuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHRjZWxscy5wdXNoKGNvbHVtbi5nZW5lcmF0ZUNlbGwocm93KSk7XG5cdH0pO1xuXG5cdHJldHVybiBjZWxscztcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8gQ29sdW1uIE1hbmFnZW1lbnQgLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5nZXRGbGV4QmFzZVdpZHRoID0gZnVuY3Rpb24gKCkge1xuXG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHRvdGFsV2lkdGggPSBzZWxmLnRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGgsXG5cdCAgICAvL3RhYmxlIGVsZW1lbnQgd2lkdGhcblxuXHRmaXhlZFdpZHRoID0gMDtcblxuXHQvL2FkanVzdCBmb3IgdmVydGljYWwgc2Nyb2xsYmFyIGlmIHByZXNlbnRcblxuXHRpZiAoc2VsZi5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0ID4gc2VsZi5yb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XG5cblx0XHR0b3RhbFdpZHRoIC09IHNlbGYucm93TWFuYWdlci5lbGVtZW50Lm9mZnNldFdpZHRoIC0gc2VsZi5yb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50V2lkdGg7XG5cdH1cblxuXHR0aGlzLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXG5cdFx0dmFyIHdpZHRoLCBtaW5XaWR0aCwgY29sV2lkdGg7XG5cblx0XHRpZiAoY29sdW1uLnZpc2libGUpIHtcblxuXHRcdFx0d2lkdGggPSBjb2x1bW4uZGVmaW5pdGlvbi53aWR0aCB8fCAwO1xuXG5cdFx0XHRtaW5XaWR0aCA9IHR5cGVvZiBjb2x1bW4ubWluV2lkdGggPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYudGFibGUub3B0aW9ucy5jb2x1bW5NaW5XaWR0aCA6IHBhcnNlSW50KGNvbHVtbi5taW5XaWR0aCk7XG5cblx0XHRcdGlmICh0eXBlb2Ygd2lkdGggPT0gXCJzdHJpbmdcIikge1xuXG5cdFx0XHRcdGlmICh3aWR0aC5pbmRleE9mKFwiJVwiKSA+IC0xKSB7XG5cblx0XHRcdFx0XHRjb2xXaWR0aCA9IHRvdGFsV2lkdGggLyAxMDAgKiBwYXJzZUludCh3aWR0aCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRjb2xXaWR0aCA9IHBhcnNlSW50KHdpZHRoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRjb2xXaWR0aCA9IHdpZHRoO1xuXHRcdFx0fVxuXG5cdFx0XHRmaXhlZFdpZHRoICs9IGNvbFdpZHRoID4gbWluV2lkdGggPyBjb2xXaWR0aCA6IG1pbldpZHRoO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGZpeGVkV2lkdGg7XG59O1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5hZGRDb2x1bW4gPSBmdW5jdGlvbiAoZGVmaW5pdGlvbiwgYmVmb3JlLCBuZXh0VG9Db2x1bW4pIHtcblx0dmFyIF90aGlzNCA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuXHRcdHZhciBjb2x1bW4gPSBfdGhpczQuX2FkZENvbHVtbihkZWZpbml0aW9uLCBiZWZvcmUsIG5leHRUb0NvbHVtbik7XG5cblx0XHRfdGhpczQuX3JlSW5kZXhDb2x1bW5zKCk7XG5cblx0XHRpZiAoX3RoaXM0LnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiBfdGhpczQudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0XHRfdGhpczQudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LmluaXRpYWxpemUoKTtcblx0XHR9XG5cblx0XHRpZiAoX3RoaXM0LnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cblx0XHRcdF90aGlzNC50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsYyhfdGhpczQudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0XHR9XG5cblx0XHRfdGhpczQucmVkcmF3KHRydWUpO1xuXG5cdFx0aWYgKF90aGlzNC50YWJsZS5tb2R1bGVzLmxheW91dC5nZXRNb2RlKCkgIT0gXCJmaXRDb2x1bW5zXCIpIHtcblxuXHRcdFx0Y29sdW1uLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0fVxuXG5cdFx0X3RoaXM0Ll92ZXJ0aWNhbEFsaWduSGVhZGVycygpO1xuXG5cdFx0X3RoaXM0LnRhYmxlLnJvd01hbmFnZXIucmVpbml0aWFsaXplKCk7XG5cblx0XHRpZiAoX3RoaXM0LnRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveikge1xuXG5cdFx0XHRfdGhpczQudGFibGUudmRvbUhvei5yZWluaXRpYWxpemUoKTtcblx0XHR9XG5cblx0XHRyZXNvbHZlKGNvbHVtbik7XG5cdH0pO1xufTtcblxuLy9yZW1vdmUgY29sdW1uIGZyb20gc3lzdGVtXG5cbkNvbHVtbk1hbmFnZXIucHJvdG90eXBlLmRlcmVnaXN0ZXJDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0dmFyIGZpZWxkID0gY29sdW1uLmdldEZpZWxkKCksXG5cdCAgICBpbmRleDtcblxuXHQvL3JlbW92ZSBmcm9tIGZpZWxkIGxpc3RcblxuXHRpZiAoZmllbGQpIHtcblxuXHRcdGRlbGV0ZSB0aGlzLmNvbHVtbnNCeUZpZWxkW2ZpZWxkXTtcblx0fVxuXG5cdC8vcmVtb3ZlIGZyb20gaW5kZXggbGlzdFxuXG5cdGluZGV4ID0gdGhpcy5jb2x1bW5zQnlJbmRleC5pbmRleE9mKGNvbHVtbik7XG5cblx0aWYgKGluZGV4ID4gLTEpIHtcblxuXHRcdHRoaXMuY29sdW1uc0J5SW5kZXguc3BsaWNlKGluZGV4LCAxKTtcblx0fVxuXG5cdC8vcmVtb3ZlIGZyb20gY29sdW1uIGxpc3RcblxuXHRpbmRleCA9IHRoaXMuY29sdW1ucy5pbmRleE9mKGNvbHVtbik7XG5cblx0aWYgKGluZGV4ID4gLTEpIHtcblxuXHRcdHRoaXMuY29sdW1ucy5zcGxpY2UoaW5kZXgsIDEpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQuaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0dGhpcy5fdmVydGljYWxBbGlnbkhlYWRlcnMoKTtcblxuXHR0aGlzLnJlZHJhdygpO1xufTtcblxuLy9yZWRyYXcgY29sdW1uc1xuXG5Db2x1bW5NYW5hZ2VyLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAoZm9yY2UpIHtcblxuXHRpZiAoZm9yY2UpIHtcblxuXHRcdGlmIChUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxWaXNpYmxlKHRoaXMuZWxlbWVudCkpIHtcblxuXHRcdFx0dGhpcy5fdmVydGljYWxBbGlnbkhlYWRlcnMoKTtcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVzZXRTY3JvbGwoKTtcblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWluaXRpYWxpemUoKTtcblx0fVxuXG5cdGlmIChbXCJmaXRDb2x1bW5zXCIsIFwiZml0RGF0YVN0cmV0Y2hcIl0uaW5kZXhPZih0aGlzLnRhYmxlLm1vZHVsZXMubGF5b3V0LmdldE1vZGUoKSkgPiAtMSkge1xuXG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmxheW91dC5sYXlvdXQoKTtcblx0fSBlbHNlIHtcblxuXHRcdGlmIChmb3JjZSkge1xuXG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMubGF5b3V0LmxheW91dCgpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpIHtcblxuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Db2x1bW5zXCIpKSB7XG5cblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZnJvemVuQ29sdW1ucy5sYXlvdXQoKTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjKHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0fVxuXG5cdGlmIChmb3JjZSkge1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuY29sdW1ucykge1xuXG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2Uuc2F2ZShcImNvbHVtbnNcIik7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblxuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlZHJhdygpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5yZWRyYXcoKTtcbn07XG5cbi8vcHVibGljIGNvbHVtbiBvYmplY3RcbnZhciBDb2x1bW5Db21wb25lbnQgPSBmdW5jdGlvbiBDb2x1bW5Db21wb25lbnQoY29sdW1uKSB7XG5cdHRoaXMuX2NvbHVtbiA9IGNvbHVtbjtcblx0dGhpcy50eXBlID0gXCJDb2x1bW5Db21wb25lbnRcIjtcbn07XG5cbkNvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUuZ2V0RWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NvbHVtbi5nZXRFbGVtZW50KCk7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldERlZmluaXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9jb2x1bW4uZ2V0RGVmaW5pdGlvbigpO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5nZXRGaWVsZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NvbHVtbi5nZXRGaWVsZCgpO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDZWxscyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGxzID0gW107XG5cblx0dGhpcy5fY29sdW1uLmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRjZWxscy5wdXNoKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHR9KTtcblxuXHRyZXR1cm4gY2VsbHM7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldFZpc2liaWxpdHkgPSBmdW5jdGlvbiAoKSB7XG5cdGNvbnNvbGUud2FybihcImdldFZpc2liaWxpdHkgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIHRoZSBpc1Zpc2libGUgZnVuY3Rpb25cIik7XG5cdHJldHVybiB0aGlzLl9jb2x1bW4udmlzaWJsZTtcbn07XG5cbkNvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUuaXNWaXNpYmxlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLnZpc2libGU7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9jb2x1bW4uaXNHcm91cCkge1xuXHRcdHRoaXMuX2NvbHVtbi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0Y29sdW1uLnNob3coKTtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLl9jb2x1bW4uc2hvdygpO1xuXHR9XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9jb2x1bW4uaXNHcm91cCkge1xuXHRcdHRoaXMuX2NvbHVtbi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0Y29sdW1uLmhpZGUoKTtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLl9jb2x1bW4uaGlkZSgpO1xuXHR9XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLnRvZ2dsZSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX2NvbHVtbi52aXNpYmxlKSB7XG5cdFx0dGhpcy5oaWRlKCk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5zaG93KCk7XG5cdH1cbn07XG5cbkNvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLmRlbGV0ZSgpO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTdWJDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgb3V0cHV0ID0gW107XG5cblx0aWYgKHRoaXMuX2NvbHVtbi5jb2x1bW5zLmxlbmd0aCkge1xuXHRcdHRoaXMuX2NvbHVtbi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0b3V0cHV0LnB1c2goY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldFBhcmVudENvbHVtbiA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NvbHVtbi5wYXJlbnQgaW5zdGFuY2VvZiBDb2x1bW4gPyB0aGlzLl9jb2x1bW4ucGFyZW50LmdldENvbXBvbmVudCgpIDogZmFsc2U7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLl9nZXRTZWxmID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5zY3JvbGxUbyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NvbHVtbi50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbFRvQ29sdW1uKHRoaXMuX2NvbHVtbik7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLnRhYmxlO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5oZWFkZXJGaWx0ZXJGb2N1cyA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX2NvbHVtbi50YWJsZS5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLl9jb2x1bW4udGFibGUubW9kdWxlcy5maWx0ZXIuc2V0SGVhZGVyRmlsdGVyRm9jdXModGhpcy5fY29sdW1uKTtcblx0fVxufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5yZWxvYWRIZWFkZXJGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9jb2x1bW4udGFibGUubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0dGhpcy5fY29sdW1uLnRhYmxlLm1vZHVsZXMuZmlsdGVyLnJlbG9hZEhlYWRlckZpbHRlcih0aGlzLl9jb2x1bW4pO1xuXHR9XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldEhlYWRlckZpbHRlclZhbHVlID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5fY29sdW1uLnRhYmxlLm1vZEV4aXN0cyhcImZpbHRlclwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLl9jb2x1bW4udGFibGUubW9kdWxlcy5maWx0ZXIuZ2V0SGVhZGVyRmlsdGVyVmFsdWUodGhpcy5fY29sdW1uKTtcblx0fVxufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5zZXRIZWFkZXJGaWx0ZXJWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRpZiAodGhpcy5fY29sdW1uLnRhYmxlLm1vZEV4aXN0cyhcImZpbHRlclwiLCB0cnVlKSkge1xuXHRcdHRoaXMuX2NvbHVtbi50YWJsZS5tb2R1bGVzLmZpbHRlci5zZXRIZWFkZXJGaWx0ZXJWYWx1ZSh0aGlzLl9jb2x1bW4sIHZhbHVlKTtcblx0fVxufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5tb3ZlID0gZnVuY3Rpb24gKHRvLCBhZnRlcikge1xuXHR2YXIgdG9Db2x1bW4gPSB0aGlzLl9jb2x1bW4udGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKHRvKTtcblxuXHRpZiAodG9Db2x1bW4pIHtcblx0XHR0aGlzLl9jb2x1bW4udGFibGUuY29sdW1uTWFuYWdlci5tb3ZlQ29sdW1uKHRoaXMuX2NvbHVtbiwgdG9Db2x1bW4sIGFmdGVyKTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCB0b0NvbHVtbik7XG5cdH1cbn07XG5cbkNvbHVtbkNvbXBvbmVudC5wcm90b3R5cGUuZ2V0TmV4dENvbHVtbiA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIG5leHRDb2wgPSB0aGlzLl9jb2x1bW4ubmV4dENvbHVtbigpO1xuXG5cdHJldHVybiBuZXh0Q29sID8gbmV4dENvbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xufTtcblxuQ29sdW1uQ29tcG9uZW50LnByb3RvdHlwZS5nZXRQcmV2Q29sdW1uID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcHJldkNvbCA9IHRoaXMuX2NvbHVtbi5wcmV2Q29sdW1uKCk7XG5cblx0cmV0dXJuIHByZXZDb2wgPyBwcmV2Q29sLmdldENvbXBvbmVudCgpIDogZmFsc2U7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLnVwZGF0ZURlZmluaXRpb24gPSBmdW5jdGlvbiAodXBkYXRlcykge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLnVwZGF0ZURlZmluaXRpb24odXBkYXRlcyk7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLmdldFdpZHRoKCk7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24gKHdpZHRoKSB7XG5cdHZhciByZXN1bHQ7XG5cblx0aWYgKHdpZHRoID09PSB0cnVlKSB7XG5cdFx0cmVzdWx0ID0gdGhpcy5fY29sdW1uLnJlaW5pdGlhbGl6ZVdpZHRoKHRydWUpO1xuXHR9IGVsc2Uge1xuXHRcdHJlc3VsdCA9IHRoaXMuX2NvbHVtbi5zZXRXaWR0aCh3aWR0aCk7XG5cdH1cblxuXHRpZiAodGhpcy5fY29sdW1uLnRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveikge1xuXHRcdHRoaXMuX2NvbHVtbi50YWJsZS52ZG9tSG96LnJlaW5pdGlhbGl6ZSh0cnVlKTtcblx0fVxuXG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG5Db2x1bW5Db21wb25lbnQucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY29sdW1uLnZhbGlkYXRlKCk7XG59O1xuXG52YXIgQ29sdW1uID0gZnVuY3Rpb24gQ29sdW1uKGRlZiwgcGFyZW50KSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHR0aGlzLnRhYmxlID0gcGFyZW50LnRhYmxlO1xuXHR0aGlzLmRlZmluaXRpb24gPSBkZWY7IC8vY29sdW1uIGRlZmluaXRpb25cblx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7IC8vaG9sZCBwYXJlbnQgb2JqZWN0XG5cdHRoaXMudHlwZSA9IFwiY29sdW1uXCI7IC8vdHlwZSBvZiBlbGVtZW50XG5cdHRoaXMuY29sdW1ucyA9IFtdOyAvL2NoaWxkIGNvbHVtbnNcblx0dGhpcy5jZWxscyA9IFtdOyAvL2NlbGxzIGJvdW5kIHRvIHRoaXMgY29sdW1uXG5cdHRoaXMuZWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudCgpOyAvL2NvbHVtbiBoZWFkZXIgZWxlbWVudFxuXHR0aGlzLmNvbnRlbnRFbGVtZW50ID0gZmFsc2U7XG5cdHRoaXMudGl0bGVIb2xkZXJFbGVtZW50ID0gZmFsc2U7XG5cdHRoaXMudGl0bGVFbGVtZW50ID0gZmFsc2U7XG5cdHRoaXMuZ3JvdXBFbGVtZW50ID0gdGhpcy5jcmVhdGVHcm91cEVsZW1lbnQoKTsgLy9jb2x1bW4gZ3JvdXAgaG9sZGVyIGVsZW1lbnRcblx0dGhpcy5pc0dyb3VwID0gZmFsc2U7XG5cdHRoaXMudG9vbHRpcCA9IGZhbHNlOyAvL2hvbGQgY29sdW1uIHRvb2x0aXBcblx0dGhpcy5ob3pBbGlnbiA9IFwiXCI7IC8vaG9yaXpvbnRhbCB0ZXh0IGFsaWdubWVudFxuXHR0aGlzLnZlcnRBbGlnbiA9IFwiXCI7IC8vdmVydCB0ZXh0IGFsaWdubWVudFxuXG5cdC8vbXVsdGkgZGltZW5zaW9uYWwgZmlsZWQgaGFuZGxpbmdcblx0dGhpcy5maWVsZCA9IFwiXCI7XG5cdHRoaXMuZmllbGRTdHJ1Y3R1cmUgPSBcIlwiO1xuXHR0aGlzLmdldEZpZWxkVmFsdWUgPSBcIlwiO1xuXHR0aGlzLnNldEZpZWxkVmFsdWUgPSBcIlwiO1xuXG5cdHRoaXMudGl0bGVGb3JtYXR0ZXJSZW5kZXJlZCA9IGZhbHNlO1xuXG5cdHRoaXMuc2V0RmllbGQodGhpcy5kZWZpbml0aW9uLmZpZWxkKTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmludmFsaWRPcHRpb25XYXJuaW5ncykge1xuXHRcdHRoaXMuY2hlY2tEZWZpbml0aW9uKCk7XG5cdH1cblxuXHR0aGlzLm1vZHVsZXMgPSB7fTsgLy9ob2xkIG1vZHVsZSB2YXJpYWJsZXM7XG5cblx0dGhpcy5jZWxsRXZlbnRzID0ge1xuXHRcdGNlbGxDbGljazogZmFsc2UsXG5cdFx0Y2VsbERibENsaWNrOiBmYWxzZSxcblx0XHRjZWxsQ29udGV4dDogZmFsc2UsXG5cdFx0Y2VsbFRhcDogZmFsc2UsXG5cdFx0Y2VsbERibFRhcDogZmFsc2UsXG5cdFx0Y2VsbFRhcEhvbGQ6IGZhbHNlLFxuXHRcdGNlbGxNb3VzZUVudGVyOiBmYWxzZSxcblx0XHRjZWxsTW91c2VMZWF2ZTogZmFsc2UsXG5cdFx0Y2VsbE1vdXNlT3ZlcjogZmFsc2UsXG5cdFx0Y2VsbE1vdXNlT3V0OiBmYWxzZSxcblx0XHRjZWxsTW91c2VNb3ZlOiBmYWxzZVxuXHR9O1xuXG5cdHRoaXMud2lkdGggPSBudWxsOyAvL2NvbHVtbiB3aWR0aFxuXHR0aGlzLndpZHRoU3R5bGVkID0gXCJcIjsgLy9jb2x1bW4gd2lkdGggcHJlc3R5bGVkIHRvIGltcHJvdmUgcmVuZGVyIGVmZmljaWVuY3lcblx0dGhpcy5tYXhXaWR0aCA9IG51bGw7IC8vY29sdW1uIG1heGltdW0gd2lkdGhcblx0dGhpcy5tYXhXaWR0aFN0eWxlZCA9IFwiXCI7IC8vY29sdW1uIG1heGltdW0gcHJlc3R5bGVkIHRvIGltcHJvdmUgcmVuZGVyIGVmZmljaWVuY3lcblx0dGhpcy5taW5XaWR0aCA9IG51bGw7IC8vY29sdW1uIG1pbmltdW0gd2lkdGhcblx0dGhpcy5taW5XaWR0aFN0eWxlZCA9IFwiXCI7IC8vY29sdW1uIG1pbmltdW0gcHJlc3R5bGVkIHRvIGltcHJvdmUgcmVuZGVyIGVmZmljaWVuY3lcblx0dGhpcy53aWR0aEZpeGVkID0gZmFsc2U7IC8vdXNlciBoYXMgc3BlY2lmaWVkIGEgd2lkdGggZm9yIHRoaXMgY29sdW1uXG5cblx0dGhpcy52aXNpYmxlID0gdHJ1ZTsgLy9kZWZhdWx0IHZpc2libGUgc3RhdGVcblxuXHR0aGlzLmNvbXBvbmVudCA9IG51bGw7XG5cblx0dGhpcy5fbWFwRGVwcmljYXRlZEZ1bmN0aW9uYWxpdHkoKTtcblxuXHQvL2luaXRpYWxpemUgY29sdW1uXG5cdGlmIChkZWYuY29sdW1ucykge1xuXG5cdFx0dGhpcy5pc0dyb3VwID0gdHJ1ZTtcblxuXHRcdGRlZi5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGRlZiwgaSkge1xuXHRcdFx0dmFyIG5ld0NvbCA9IG5ldyBDb2x1bW4oZGVmLCBzZWxmKTtcblx0XHRcdHNlbGYuYXR0YWNoQ29sdW1uKG5ld0NvbCk7XG5cdFx0fSk7XG5cblx0XHRzZWxmLmNoZWNrQ29sdW1uVmlzaWJpbGl0eSgpO1xuXHR9IGVsc2Uge1xuXHRcdHBhcmVudC5yZWdpc3RlckNvbHVtbkZpZWxkKHRoaXMpO1xuXHR9XG5cblx0aWYgKGRlZi5yb3dIYW5kbGUgJiYgdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzICE9PSBmYWxzZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm1vdmVSb3dcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMubW92ZVJvdy5zZXRIYW5kbGUodHJ1ZSk7XG5cdH1cblxuXHR0aGlzLl9idWlsZEhlYWRlcigpO1xuXG5cdHRoaXMuYmluZE1vZHVsZUNvbHVtbnMoKTtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbFwiKTtcblx0ZWwuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImNvbHVtbmhlYWRlclwiKTtcblx0ZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIFwibm9uZVwiKTtcblxuXHRyZXR1cm4gZWw7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLmNyZWF0ZUdyb3VwRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC1ncm91cC1jb2xzXCIpO1xuXG5cdHJldHVybiBlbDtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuY2hlY2tEZWZpbml0aW9uID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXM1ID0gdGhpcztcblxuXHRPYmplY3Qua2V5cyh0aGlzLmRlZmluaXRpb24pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHRcdGlmIChfdGhpczUuZGVmYXVsdE9wdGlvbkxpc3QuaW5kZXhPZihrZXkpID09PSAtMSkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiSW52YWxpZCBjb2x1bW4gZGVmaW5pdGlvbiBvcHRpb24gaW4gJ1wiICsgKF90aGlzNS5maWVsZCB8fCBfdGhpczUuZGVmaW5pdGlvbi50aXRsZSkgKyBcIicgY29sdW1uOlwiLCBrZXkpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLnNldEZpZWxkID0gZnVuY3Rpb24gKGZpZWxkKSB7XG5cdHRoaXMuZmllbGQgPSBmaWVsZDtcblx0dGhpcy5maWVsZFN0cnVjdHVyZSA9IGZpZWxkID8gdGhpcy50YWJsZS5vcHRpb25zLm5lc3RlZEZpZWxkU2VwYXJhdG9yID8gZmllbGQuc3BsaXQodGhpcy50YWJsZS5vcHRpb25zLm5lc3RlZEZpZWxkU2VwYXJhdG9yKSA6IFtmaWVsZF0gOiBbXTtcblx0dGhpcy5nZXRGaWVsZFZhbHVlID0gdGhpcy5maWVsZFN0cnVjdHVyZS5sZW5ndGggPiAxID8gdGhpcy5fZ2V0TmVzdGVkRGF0YSA6IHRoaXMuX2dldEZsYXREYXRhO1xuXHR0aGlzLnNldEZpZWxkVmFsdWUgPSB0aGlzLmZpZWxkU3RydWN0dXJlLmxlbmd0aCA+IDEgPyB0aGlzLl9zZXROZXN0ZWREYXRhIDogdGhpcy5fc2V0RmxhdERhdGE7XG59O1xuXG4vL3JlZ2lzdGVyIGNvbHVtbiBwb3NpdGlvbiB3aXRoIGNvbHVtbiBtYW5hZ2VyXG5Db2x1bW4ucHJvdG90eXBlLnJlZ2lzdGVyQ29sdW1uUG9zaXRpb24gPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHRoaXMucGFyZW50LnJlZ2lzdGVyQ29sdW1uUG9zaXRpb24oY29sdW1uKTtcbn07XG5cbi8vcmVnaXN0ZXIgY29sdW1uIHBvc2l0aW9uIHdpdGggY29sdW1uIG1hbmFnZXJcbkNvbHVtbi5wcm90b3R5cGUucmVnaXN0ZXJDb2x1bW5GaWVsZCA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dGhpcy5wYXJlbnQucmVnaXN0ZXJDb2x1bW5GaWVsZChjb2x1bW4pO1xufTtcblxuLy90cmlnZ2VyIHBvc2l0aW9uIHJlZ2lzdHJhdGlvblxuQ29sdW1uLnByb3RvdHlwZS5yZVJlZ2lzdGVyUG9zaXRpb24gPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLmlzR3JvdXApIHtcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0XHRjb2x1bW4ucmVSZWdpc3RlclBvc2l0aW9uKCk7XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZWdpc3RlckNvbHVtblBvc2l0aW9uKHRoaXMpO1xuXHR9XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLl9tYXBEZXByaWNhdGVkRnVuY3Rpb25hbGl0eSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHR5cGVvZiB0aGlzLmRlZmluaXRpb24uaGlkZUluSHRtbCAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdHRoaXMuZGVmaW5pdGlvbi5odG1sT3V0cHV0ID0gIXRoaXMuZGVmaW5pdGlvbi5oaWRlSW5IdG1sO1xuXHRcdGNvbnNvbGUud2FybihcImhpZGVJbkh0bWwgY29sdW1uIGRlZmluaXRpb24gcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIGh0bWxPdXRwdXRcIik7XG5cdH1cblxuXHRpZiAodHlwZW9mIHRoaXMuZGVmaW5pdGlvbi5hbGlnbiAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdHRoaXMuZGVmaW5pdGlvbi5ob3pBbGlnbiA9IHRoaXMuZGVmaW5pdGlvbi5hbGlnbjtcblx0XHRjb25zb2xlLndhcm4oXCJhbGlnbiBjb2x1bW4gZGVmaW5pdGlvbiBwcm9wZXJ0eSBpcyBkZXByZWNhdGVkLCB5b3Ugc2hvdWxkIG5vdyB1c2UgaG96QWxpZ25cIik7XG5cdH1cblxuXHRpZiAodHlwZW9mIHRoaXMuZGVmaW5pdGlvbi5kb3dubG9hZFRpdGxlICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0dGhpcy5kZWZpbml0aW9uLnRpdGxlRG93bmxvYWQgPSB0aGlzLmRlZmluaXRpb24uZG93bmxvYWRUaXRsZTtcblx0XHRjb25zb2xlLndhcm4oXCJkb3dubG9hZFRpdGxlIGRlZmluaXRpb24gcHJvcGVydHkgaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIHRpdGxlRG93bmxvYWRcIik7XG5cdH1cbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuc2V0VG9vbHRpcCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZGVmID0gc2VsZi5kZWZpbml0aW9uO1xuXG5cdC8vc2V0IGhlYWRlciB0b29sdGlwc1xuXHR2YXIgdG9vbHRpcCA9IGRlZi5oZWFkZXJUb29sdGlwIHx8IGRlZi50b29sdGlwID09PSBmYWxzZSA/IGRlZi5oZWFkZXJUb29sdGlwIDogc2VsZi50YWJsZS5vcHRpb25zLnRvb2x0aXBzSGVhZGVyO1xuXG5cdGlmICh0b29sdGlwKSB7XG5cdFx0aWYgKHRvb2x0aXAgPT09IHRydWUpIHtcblx0XHRcdGlmIChkZWYuZmllbGQpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmJpbmQoXCJjb2x1bW5zfFwiICsgZGVmLmZpZWxkLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRzZWxmLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUgfHwgZGVmLnRpdGxlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZWxmLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgZGVmLnRpdGxlKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHR5cGVvZiB0b29sdGlwID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHR0b29sdGlwID0gdG9vbHRpcChzZWxmLmdldENvbXBvbmVudCgpKTtcblxuXHRcdFx0XHRpZiAodG9vbHRpcCA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHR0b29sdGlwID0gXCJcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRzZWxmLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdG9vbHRpcCk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHNlbGYuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBcIlwiKTtcblx0fVxufTtcblxuLy9idWlsZCBoZWFkZXIgZWxlbWVudFxuQ29sdW1uLnByb3RvdHlwZS5fYnVpbGRIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGRlZiA9IHNlbGYuZGVmaW5pdGlvbjtcblxuXHR3aGlsZSAoc2VsZi5lbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRzZWxmLmVsZW1lbnQucmVtb3ZlQ2hpbGQoc2VsZi5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHR9aWYgKGRlZi5oZWFkZXJWZXJ0aWNhbCkge1xuXHRcdHNlbGYuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC12ZXJ0aWNhbFwiKTtcblxuXHRcdGlmIChkZWYuaGVhZGVyVmVydGljYWwgPT09IFwiZmxpcFwiKSB7XG5cdFx0XHRzZWxmLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdmVydGljYWwtZmxpcFwiKTtcblx0XHR9XG5cdH1cblxuXHRzZWxmLmNvbnRlbnRFbGVtZW50ID0gc2VsZi5fYmluZEV2ZW50cygpO1xuXG5cdHNlbGYuY29udGVudEVsZW1lbnQgPSBzZWxmLl9idWlsZENvbHVtbkhlYWRlckNvbnRlbnQoKTtcblxuXHRzZWxmLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc2VsZi5jb250ZW50RWxlbWVudCk7XG5cblx0aWYgKHNlbGYuaXNHcm91cCkge1xuXHRcdHNlbGYuX2J1aWxkR3JvdXBIZWFkZXIoKTtcblx0fSBlbHNlIHtcblx0XHRzZWxmLl9idWlsZENvbHVtbkhlYWRlcigpO1xuXHR9XG5cblx0c2VsZi5zZXRUb29sdGlwKCk7XG5cblx0Ly9zZXQgcmVzaXphYmxlIGhhbmRsZXNcblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5yZXNpemFibGVDb2x1bW5zICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwicmVzaXplQ29sdW1uc1wiKSkge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5yZXNpemVDb2x1bW5zLmluaXRpYWxpemVDb2x1bW4oXCJoZWFkZXJcIiwgc2VsZiwgc2VsZi5lbGVtZW50KTtcblx0fVxuXG5cdC8vc2V0IHJlc2l6YWJsZSBoYW5kbGVzXG5cdGlmIChkZWYuaGVhZGVyRmlsdGVyICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwiZmlsdGVyXCIpICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdGlmICh0eXBlb2YgZGVmLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyICE9PSBcInVuZGVmaW5lZFwiICYmIGRlZi5maWVsZCkge1xuXHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLmxvY2FsaXplLnNldEhlYWRlckZpbHRlckNvbHVtblBsYWNlaG9sZGVyKGRlZi5maWVsZCwgZGVmLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyKTtcblx0XHR9XG5cblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMuZmlsdGVyLmluaXRpYWxpemVDb2x1bW4oc2VsZik7XG5cdH1cblxuXHQvL3NldCByZXNpemFibGUgaGFuZGxlc1xuXHRpZiAoc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Db2x1bW5zXCIpKSB7XG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMuaW5pdGlhbGl6ZUNvbHVtbihzZWxmKTtcblx0fVxuXG5cdC8vc2V0IG1vdmFibGUgY29sdW1uXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMubW92YWJsZUNvbHVtbnMgJiYgIXNlbGYuaXNHcm91cCAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcIm1vdmVDb2x1bW5cIikpIHtcblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMubW92ZUNvbHVtbi5pbml0aWFsaXplQ29sdW1uKHNlbGYpO1xuXHR9XG5cblx0Ly9zZXQgY2FsY3MgY29sdW1uXG5cdGlmICgoZGVmLnRvcENhbGMgfHwgZGVmLmJvdHRvbUNhbGMpICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuaW5pdGlhbGl6ZUNvbHVtbihzZWxmKTtcblx0fVxuXG5cdC8vaGFuZGxlIHBlcnNpc3RlbmNlXG5cdGlmIChzZWxmLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIpICYmIHNlbGYudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuY29sdW1ucykge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5pbml0aWFsaXplQ29sdW1uKHNlbGYpO1xuXHR9XG5cblx0Ly91cGRhdGUgaGVhZGVyIHRvb2x0aXAgb24gbW91c2UgZW50ZXJcblx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0c2VsZi5zZXRUb29sdGlwKCk7XG5cdH0pO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5fYmluZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBkZWYgPSBzZWxmLmRlZmluaXRpb24sXG5cdCAgICBkYmxUYXAsXG5cdCAgICB0YXBIb2xkLFxuXHQgICAgdGFwO1xuXG5cdC8vc2V0dXAgaGVhZGVyIGNsaWNrIGV2ZW50IGJpbmRpbmdzXG5cdGlmICh0eXBlb2YgZGVmLmhlYWRlckNsaWNrID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGRlZi5oZWFkZXJDbGljayhlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmICh0eXBlb2YgZGVmLmhlYWRlckRibENsaWNrID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGRlZi5oZWFkZXJEYmxDbGljayhlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmICh0eXBlb2YgZGVmLmhlYWRlckNvbnRleHQgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0ZGVmLmhlYWRlckNvbnRleHQoZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvL3NldHVwIGhlYWRlciB0YXAgZXZlbnQgYmluZGluZ3Ncblx0aWYgKHR5cGVvZiBkZWYuaGVhZGVyVGFwID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHRhcCA9IGZhbHNlO1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR0YXAgPSB0cnVlO1xuXHRcdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGlmICh0YXApIHtcblx0XHRcdFx0ZGVmLmhlYWRlclRhcChlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH1cblxuXHRcdFx0dGFwID0gZmFsc2U7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5oZWFkZXJEYmxUYXAgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0ZGJsVGFwID0gbnVsbDtcblxuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblxuXHRcdFx0aWYgKGRibFRhcCkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQoZGJsVGFwKTtcblx0XHRcdFx0ZGJsVGFwID0gbnVsbDtcblxuXHRcdFx0XHRkZWYuaGVhZGVyRGJsVGFwKGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRkYmxUYXAgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQoZGJsVGFwKTtcblx0XHRcdFx0XHRkYmxUYXAgPSBudWxsO1xuXHRcdFx0XHR9LCAzMDApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHR5cGVvZiBkZWYuaGVhZGVyVGFwSG9sZCA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHR0YXBIb2xkID0gbnVsbDtcblxuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRhcEhvbGQpO1xuXG5cdFx0XHR0YXBIb2xkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHRcdFx0dGFwSG9sZCA9IG51bGw7XG5cdFx0XHRcdHRhcCA9IGZhbHNlO1xuXHRcdFx0XHRkZWYuaGVhZGVyVGFwSG9sZChlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0sIDEwMDApO1xuXHRcdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHRcdHRhcEhvbGQgPSBudWxsO1xuXHRcdH0pO1xuXHR9XG5cblx0Ly9zdG9yZSBjb2x1bW4gY2VsbCBjbGljayBldmVudCBiaW5kaW5nc1xuXHRpZiAodHlwZW9mIGRlZi5jZWxsQ2xpY2sgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0c2VsZi5jZWxsRXZlbnRzLmNlbGxDbGljayA9IGRlZi5jZWxsQ2xpY2s7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsRGJsQ2xpY2sgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0c2VsZi5jZWxsRXZlbnRzLmNlbGxEYmxDbGljayA9IGRlZi5jZWxsRGJsQ2xpY2s7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsQ29udGV4dCA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRzZWxmLmNlbGxFdmVudHMuY2VsbENvbnRleHQgPSBkZWYuY2VsbENvbnRleHQ7XG5cdH1cblxuXHQvL3N0b3JlIGNvbHVtbiBtb3VzZSBldmVudCBiaW5kaW5nc1xuXHRpZiAodHlwZW9mIGRlZi5jZWxsTW91c2VFbnRlciA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRzZWxmLmNlbGxFdmVudHMuY2VsbE1vdXNlRW50ZXIgPSBkZWYuY2VsbE1vdXNlRW50ZXI7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsTW91c2VMZWF2ZSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRzZWxmLmNlbGxFdmVudHMuY2VsbE1vdXNlTGVhdmUgPSBkZWYuY2VsbE1vdXNlTGVhdmU7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsTW91c2VPdmVyID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsTW91c2VPdmVyID0gZGVmLmNlbGxNb3VzZU92ZXI7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsTW91c2VPdXQgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0c2VsZi5jZWxsRXZlbnRzLmNlbGxNb3VzZU91dCA9IGRlZi5jZWxsTW91c2VPdXQ7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsTW91c2VNb3ZlID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsTW91c2VNb3ZlID0gZGVmLmNlbGxNb3VzZU1vdmU7XG5cdH1cblxuXHQvL3NldHVwIGNvbHVtbiBjZWxsIHRhcCBldmVudCBiaW5kaW5nc1xuXHRpZiAodHlwZW9mIGRlZi5jZWxsVGFwID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsVGFwID0gZGVmLmNlbGxUYXA7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsRGJsVGFwID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsRGJsVGFwID0gZGVmLmNlbGxEYmxUYXA7XG5cdH1cblxuXHRpZiAodHlwZW9mIGRlZi5jZWxsVGFwSG9sZCA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRzZWxmLmNlbGxFdmVudHMuY2VsbFRhcEhvbGQgPSBkZWYuY2VsbFRhcEhvbGQ7XG5cdH1cblxuXHQvL3NldHVwIGNvbHVtbiBjZWxsIGVkaXQgY2FsbGJhY2tzXG5cdGlmICh0eXBlb2YgZGVmLmNlbGxFZGl0ZWQgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0c2VsZi5jZWxsRXZlbnRzLmNlbGxFZGl0ZWQgPSBkZWYuY2VsbEVkaXRlZDtcblx0fVxuXG5cdGlmICh0eXBlb2YgZGVmLmNlbGxFZGl0aW5nID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsRWRpdGluZyA9IGRlZi5jZWxsRWRpdGluZztcblx0fVxuXG5cdGlmICh0eXBlb2YgZGVmLmNlbGxFZGl0Q2FuY2VsbGVkID09IFwiZnVuY3Rpb25cIikge1xuXHRcdHNlbGYuY2VsbEV2ZW50cy5jZWxsRWRpdENhbmNlbGxlZCA9IGRlZi5jZWxsRWRpdENhbmNlbGxlZDtcblx0fVxufTtcblxuLy9idWlsZCBoZWFkZXIgZWxlbWVudCBmb3IgaGVhZGVyXG5Db2x1bW4ucHJvdG90eXBlLl9idWlsZENvbHVtbkhlYWRlciA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIF90aGlzNiA9IHRoaXM7XG5cblx0dmFyIGRlZiA9IHRoaXMuZGVmaW5pdGlvbixcblx0ICAgIHRhYmxlID0gdGhpcy50YWJsZSxcblx0ICAgIHNvcnRhYmxlO1xuXG5cdC8vc2V0IGNvbHVtbiBzb3J0ZXJcblx0aWYgKHRhYmxlLm1vZEV4aXN0cyhcInNvcnRcIikpIHtcblx0XHR0YWJsZS5tb2R1bGVzLnNvcnQuaW5pdGlhbGl6ZUNvbHVtbih0aGlzLCB0aGlzLnRpdGxlSG9sZGVyRWxlbWVudCk7XG5cdH1cblxuXHQvL3NldCBjb2x1bW4gaGVhZGVyIGNvbnRleHQgbWVudVxuXHRpZiAoKGRlZi5oZWFkZXJDb250ZXh0TWVudSB8fCBkZWYuaGVhZGVyQ2xpY2tNZW51IHx8IGRlZi5oZWFkZXJNZW51KSAmJiB0YWJsZS5tb2RFeGlzdHMoXCJtZW51XCIpKSB7XG5cdFx0dGFibGUubW9kdWxlcy5tZW51LmluaXRpYWxpemVDb2x1bW5IZWFkZXIodGhpcyk7XG5cdH1cblxuXHQvL3NldCBjb2x1bW4gZm9ybWF0dGVyXG5cdGlmICh0YWJsZS5tb2RFeGlzdHMoXCJmb3JtYXRcIikpIHtcblx0XHR0YWJsZS5tb2R1bGVzLmZvcm1hdC5pbml0aWFsaXplQ29sdW1uKHRoaXMpO1xuXHR9XG5cblx0Ly9zZXQgY29sdW1uIGVkaXRvclxuXHRpZiAodHlwZW9mIGRlZi5lZGl0b3IgIT0gXCJ1bmRlZmluZWRcIiAmJiB0YWJsZS5tb2RFeGlzdHMoXCJlZGl0XCIpKSB7XG5cdFx0dGFibGUubW9kdWxlcy5lZGl0LmluaXRpYWxpemVDb2x1bW4odGhpcyk7XG5cdH1cblxuXHQvL3NldCBjb2x1bSB2YWxpZGF0b3Jcblx0aWYgKHR5cGVvZiBkZWYudmFsaWRhdG9yICE9IFwidW5kZWZpbmVkXCIgJiYgdGFibGUubW9kRXhpc3RzKFwidmFsaWRhdGVcIikpIHtcblx0XHR0YWJsZS5tb2R1bGVzLnZhbGlkYXRlLmluaXRpYWxpemVDb2x1bW4odGhpcyk7XG5cdH1cblxuXHQvL3NldCBjb2x1bW4gbXV0YXRvclxuXHRpZiAodGFibGUubW9kRXhpc3RzKFwibXV0YXRvclwiKSkge1xuXHRcdHRhYmxlLm1vZHVsZXMubXV0YXRvci5pbml0aWFsaXplQ29sdW1uKHRoaXMpO1xuXHR9XG5cblx0Ly9zZXQgY29sdW1uIGFjY2Vzc29yXG5cdGlmICh0YWJsZS5tb2RFeGlzdHMoXCJhY2Nlc3NvclwiKSkge1xuXHRcdHRhYmxlLm1vZHVsZXMuYWNjZXNzb3IuaW5pdGlhbGl6ZUNvbHVtbih0aGlzKTtcblx0fVxuXG5cdC8vc2V0IHJlc3Bvdml2ZUxheW91dFxuXHRpZiAoX3R5cGVvZih0YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQpICYmIHRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIikpIHtcblx0XHR0YWJsZS5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQuaW5pdGlhbGl6ZUNvbHVtbih0aGlzKTtcblx0fVxuXG5cdC8vc2V0IGNvbHVtbiB2aXNpYmlsaXR5XG5cdGlmICh0eXBlb2YgZGVmLnZpc2libGUgIT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdGlmIChkZWYudmlzaWJsZSkge1xuXHRcdFx0dGhpcy5zaG93KHRydWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhpZGUodHJ1ZSk7XG5cdFx0fVxuXHR9XG5cblx0Ly9hc2lnbiBhZGRpdGlvbmFsIGNzcyBjbGFzc2VzIHRvIGNvbHVtbiBoZWFkZXJcblx0aWYgKGRlZi5jc3NDbGFzcykge1xuXHRcdHZhciBjbGFzc2VOYW1lcyA9IGRlZi5jc3NDbGFzcy5zcGxpdChcIiBcIik7XG5cdFx0Y2xhc3NlTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoY2xhc3NOYW1lKSB7XG5cdFx0XHRfdGhpczYuZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoZGVmLmZpZWxkKSB7XG5cdFx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInRhYnVsYXRvci1maWVsZFwiLCBkZWYuZmllbGQpO1xuXHR9XG5cblx0Ly9zZXQgbWluIHdpZHRoIGlmIHByZXNlbnRcblx0dGhpcy5zZXRNaW5XaWR0aCh0eXBlb2YgZGVmLm1pbldpZHRoID09IFwidW5kZWZpbmVkXCIgPyB0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uTWluV2lkdGggOiBwYXJzZUludChkZWYubWluV2lkdGgpKTtcblxuXHRpZiAoZGVmLm1heFdpZHRoIHx8IHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5NYXhXaWR0aCkge1xuXHRcdGlmIChkZWYubWF4V2lkdGggIT09IGZhbHNlKSB7XG5cdFx0XHR0aGlzLnNldE1heFdpZHRoKHR5cGVvZiBkZWYubWF4V2lkdGggPT0gXCJ1bmRlZmluZWRcIiA/IHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5NYXhXaWR0aCA6IHBhcnNlSW50KGRlZi5tYXhXaWR0aCkpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMucmVpbml0aWFsaXplV2lkdGgoKTtcblxuXHQvL3NldCB0b29sdGlwIGlmIHByZXNlbnRcblx0dGhpcy50b29sdGlwID0gdGhpcy5kZWZpbml0aW9uLnRvb2x0aXAgfHwgdGhpcy5kZWZpbml0aW9uLnRvb2x0aXAgPT09IGZhbHNlID8gdGhpcy5kZWZpbml0aW9uLnRvb2x0aXAgOiB0aGlzLnRhYmxlLm9wdGlvbnMudG9vbHRpcHM7XG5cblx0Ly9zZXQgb3Jpem9udGFsIHRleHQgYWxpZ25tZW50XG5cdHRoaXMuaG96QWxpZ24gPSB0eXBlb2YgdGhpcy5kZWZpbml0aW9uLmhvekFsaWduID09IFwidW5kZWZpbmVkXCIgPyB0aGlzLnRhYmxlLm9wdGlvbnMuY2VsbEhvekFsaWduIDogdGhpcy5kZWZpbml0aW9uLmhvekFsaWduO1xuXHR0aGlzLnZlcnRBbGlnbiA9IHR5cGVvZiB0aGlzLmRlZmluaXRpb24udmVydEFsaWduID09IFwidW5kZWZpbmVkXCIgPyB0aGlzLnRhYmxlLm9wdGlvbnMuY2VsbFZlcnRBbGlnbiA6IHRoaXMuZGVmaW5pdGlvbi52ZXJ0QWxpZ247XG5cblx0dGhpcy50aXRsZUVsZW1lbnQuc3R5bGUudGV4dEFsaWduID0gdGhpcy5kZWZpbml0aW9uLmhlYWRlckhvekFsaWduIHx8IHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJIb3pBbGlnbjtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuX2J1aWxkQ29sdW1uSGVhZGVyQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGRlZiA9IHRoaXMuZGVmaW5pdGlvbixcblx0ICAgIHRhYmxlID0gdGhpcy50YWJsZTtcblxuXHR2YXIgY29udGVudEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRjb250ZW50RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC1jb250ZW50XCIpO1xuXG5cdHRoaXMudGl0bGVIb2xkZXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0dGhpcy50aXRsZUhvbGRlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtdGl0bGUtaG9sZGVyXCIpO1xuXG5cdGNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMudGl0bGVIb2xkZXJFbGVtZW50KTtcblxuXHR0aGlzLnRpdGxlRWxlbWVudCA9IHRoaXMuX2J1aWxkQ29sdW1uSGVhZGVyVGl0bGUoKTtcblxuXHR0aGlzLnRpdGxlSG9sZGVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLnRpdGxlRWxlbWVudCk7XG5cblx0cmV0dXJuIGNvbnRlbnRFbGVtZW50O1xufTtcblxuLy9idWlsZCB0aXRsZSBlbGVtZW50IG9mIGNvbHVtblxuQ29sdW1uLnByb3RvdHlwZS5fYnVpbGRDb2x1bW5IZWFkZXJUaXRsZSA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZGVmID0gc2VsZi5kZWZpbml0aW9uLFxuXHQgICAgdGFibGUgPSBzZWxmLnRhYmxlLFxuXHQgICAgdGl0bGU7XG5cblx0dmFyIHRpdGxlSG9sZGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdHRpdGxlSG9sZGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC10aXRsZVwiKTtcblxuXHRpZiAoZGVmLmVkaXRhYmxlVGl0bGUpIHtcblx0XHR2YXIgdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXHRcdHRpdGxlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXRpdGxlLWVkaXRvclwiKTtcblxuXHRcdHRpdGxlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR0aXRsZUVsZW1lbnQuZm9jdXMoKTtcblx0XHR9KTtcblxuXHRcdHRpdGxlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGRlZi50aXRsZSA9IHRpdGxlRWxlbWVudC52YWx1ZTtcblx0XHRcdHRhYmxlLm9wdGlvbnMuY29sdW1uVGl0bGVDaGFuZ2VkLmNhbGwoc2VsZi50YWJsZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cblx0XHR0aXRsZUhvbGRlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGl0bGVFbGVtZW50KTtcblxuXHRcdGlmIChkZWYuZmllbGQpIHtcblx0XHRcdHRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcImNvbHVtbnN8XCIgKyBkZWYuZmllbGQsIGZ1bmN0aW9uICh0ZXh0KSB7XG5cdFx0XHRcdHRpdGxlRWxlbWVudC52YWx1ZSA9IHRleHQgfHwgZGVmLnRpdGxlIHx8IFwiJm5ic3A7XCI7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGl0bGVFbGVtZW50LnZhbHVlID0gZGVmLnRpdGxlIHx8IFwiJm5ic3A7XCI7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGlmIChkZWYuZmllbGQpIHtcblx0XHRcdHRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcImNvbHVtbnN8XCIgKyBkZWYuZmllbGQsIGZ1bmN0aW9uICh0ZXh0KSB7XG5cdFx0XHRcdHNlbGYuX2Zvcm1hdENvbHVtbkhlYWRlclRpdGxlKHRpdGxlSG9sZGVyRWxlbWVudCwgdGV4dCB8fCBkZWYudGl0bGUgfHwgXCImbmJzcDtcIik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c2VsZi5fZm9ybWF0Q29sdW1uSGVhZGVyVGl0bGUodGl0bGVIb2xkZXJFbGVtZW50LCBkZWYudGl0bGUgfHwgXCImbmJzcDtcIik7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRpdGxlSG9sZGVyRWxlbWVudDtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuX2Zvcm1hdENvbHVtbkhlYWRlclRpdGxlID0gZnVuY3Rpb24gKGVsLCB0aXRsZSkge1xuXHR2YXIgX3RoaXM3ID0gdGhpcztcblxuXHR2YXIgZm9ybWF0dGVyLCBjb250ZW50cywgcGFyYW1zLCBtb2NrQ2VsbCwgb25SZW5kZXJlZDtcblxuXHRpZiAodGhpcy5kZWZpbml0aW9uLnRpdGxlRm9ybWF0dGVyICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZm9ybWF0XCIpKSB7XG5cblx0XHRmb3JtYXR0ZXIgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZm9ybWF0LmdldEZvcm1hdHRlcih0aGlzLmRlZmluaXRpb24udGl0bGVGb3JtYXR0ZXIpO1xuXG5cdFx0b25SZW5kZXJlZCA9IGZ1bmN0aW9uIG9uUmVuZGVyZWQoY2FsbGJhY2spIHtcblx0XHRcdF90aGlzNy50aXRsZUZvcm1hdHRlclJlbmRlcmVkID0gY2FsbGJhY2s7XG5cdFx0fTtcblxuXHRcdG1vY2tDZWxsID0ge1xuXHRcdFx0Z2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKCkge1xuXHRcdFx0XHRyZXR1cm4gdGl0bGU7XG5cdFx0XHR9LFxuXHRcdFx0Z2V0RWxlbWVudDogZnVuY3Rpb24gZ2V0RWxlbWVudCgpIHtcblx0XHRcdFx0cmV0dXJuIGVsO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRwYXJhbXMgPSB0aGlzLmRlZmluaXRpb24udGl0bGVGb3JtYXR0ZXJQYXJhbXMgfHwge307XG5cblx0XHRwYXJhbXMgPSB0eXBlb2YgcGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBwYXJhbXMoKSA6IHBhcmFtcztcblxuXHRcdGNvbnRlbnRzID0gZm9ybWF0dGVyLmNhbGwodGhpcy50YWJsZS5tb2R1bGVzLmZvcm1hdCwgbW9ja0NlbGwsIHBhcmFtcywgb25SZW5kZXJlZCk7XG5cblx0XHRzd2l0Y2ggKHR5cGVvZiBjb250ZW50cyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoY29udGVudHMpKSB7XG5cdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdGlmIChjb250ZW50cyBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdFx0XHRlbC5hcHBlbmRDaGlsZChjb250ZW50cyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJGb3JtYXQgRXJyb3IgLSBUaXRsZSBmb3JtYXR0ZXIgaGFzIHJldHVybmVkIGEgdHlwZSBvZiBvYmplY3QsIHRoZSBvbmx5IHZhbGlkIGZvcm1hdHRlciBvYmplY3QgcmV0dXJuIGlzIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBmb3JtYXR0ZXIgcmV0dXJuZWQ6XCIsIGNvbnRlbnRzKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdGNhc2UgXCJudWxsXCI6XG5cdFx0XHRcdGVsLmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gY29udGVudHM7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGVsLmlubmVySFRNTCA9IHRpdGxlO1xuXHR9XG59O1xuXG4vL2J1aWxkIGhlYWRlciBlbGVtZW50IGZvciBjb2x1bW4gZ3JvdXBcbkNvbHVtbi5wcm90b3R5cGUuX2J1aWxkR3JvdXBIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczggPSB0aGlzO1xuXG5cdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbC1ncm91cFwiKTtcblx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJjb2x1bW5ncm91cFwiKTtcblx0dGhpcy5lbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtdGl0bGVcIiwgdGhpcy5kZWZpbml0aW9uLnRpdGxlKTtcblxuXHQvL2FzaWduIGFkZGl0aW9uYWwgY3NzIGNsYXNzZXMgdG8gY29sdW1uIGhlYWRlclxuXHRpZiAodGhpcy5kZWZpbml0aW9uLmNzc0NsYXNzKSB7XG5cdFx0dmFyIGNsYXNzZU5hbWVzID0gdGhpcy5kZWZpbml0aW9uLmNzc0NsYXNzLnNwbGl0KFwiIFwiKTtcblx0XHRjbGFzc2VOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChjbGFzc05hbWUpIHtcblx0XHRcdF90aGlzOC5lbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vc2V0IGNvbHVtbiBoZWFkZXIgY29udGV4dCBtZW51XG5cdGlmICgodGhpcy5kZWZpbml0aW9uLmhlYWRlckNvbnRleHRNZW51IHx8IHRoaXMuZGVmaW5pdGlvbi5oZWFkZXJNZW51KSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm1lbnVcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMubWVudS5pbml0aWFsaXplQ29sdW1uSGVhZGVyKHRoaXMpO1xuXHR9XG5cblx0dGhpcy50aXRsZUVsZW1lbnQuc3R5bGUudGV4dEFsaWduID0gdGhpcy5kZWZpbml0aW9uLmhlYWRlckhvekFsaWduIHx8IHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJIb3pBbGlnbjtcblxuXHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5ncm91cEVsZW1lbnQpO1xufTtcblxuLy9mbGF0IGZpZWxkIGxvb2t1cFxuQ29sdW1uLnByb3RvdHlwZS5fZ2V0RmxhdERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRyZXR1cm4gZGF0YVt0aGlzLmZpZWxkXTtcbn07XG5cbi8vbmVzdGVkIGZpZWxkIGxvb2t1cFxuQ29sdW1uLnByb3RvdHlwZS5fZ2V0TmVzdGVkRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBkYXRhT2JqID0gZGF0YSxcblx0ICAgIHN0cnVjdHVyZSA9IHRoaXMuZmllbGRTdHJ1Y3R1cmUsXG5cdCAgICBsZW5ndGggPSBzdHJ1Y3R1cmUubGVuZ3RoLFxuXHQgICAgb3V0cHV0O1xuXG5cdGZvciAodmFyIF9pID0gMDsgX2kgPCBsZW5ndGg7IF9pKyspIHtcblxuXHRcdGRhdGFPYmogPSBkYXRhT2JqW3N0cnVjdHVyZVtfaV1dO1xuXG5cdFx0b3V0cHV0ID0gZGF0YU9iajtcblxuXHRcdGlmICghZGF0YU9iaikge1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbi8vZmxhdCBmaWVsZCBzZXRcbkNvbHVtbi5wcm90b3R5cGUuX3NldEZsYXREYXRhID0gZnVuY3Rpb24gKGRhdGEsIHZhbHVlKSB7XG5cdGlmICh0aGlzLmZpZWxkKSB7XG5cdFx0ZGF0YVt0aGlzLmZpZWxkXSA9IHZhbHVlO1xuXHR9XG59O1xuXG4vL25lc3RlZCBmaWVsZCBzZXRcbkNvbHVtbi5wcm90b3R5cGUuX3NldE5lc3RlZERhdGEgPSBmdW5jdGlvbiAoZGF0YSwgdmFsdWUpIHtcblx0dmFyIGRhdGFPYmogPSBkYXRhLFxuXHQgICAgc3RydWN0dXJlID0gdGhpcy5maWVsZFN0cnVjdHVyZSxcblx0ICAgIGxlbmd0aCA9IHN0cnVjdHVyZS5sZW5ndGg7XG5cblx0Zm9yICh2YXIgX2kyID0gMDsgX2kyIDwgbGVuZ3RoOyBfaTIrKykge1xuXG5cdFx0aWYgKF9pMiA9PSBsZW5ndGggLSAxKSB7XG5cdFx0XHRkYXRhT2JqW3N0cnVjdHVyZVtfaTJdXSA9IHZhbHVlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIWRhdGFPYmpbc3RydWN0dXJlW19pMl1dKSB7XG5cdFx0XHRcdGlmICh0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRkYXRhT2JqW3N0cnVjdHVyZVtfaTJdXSA9IHt9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGRhdGFPYmogPSBkYXRhT2JqW3N0cnVjdHVyZVtfaTJdXTtcblx0XHR9XG5cdH1cbn07XG5cbi8vYXR0YWNoIGNvbHVtbiB0byB0aGlzIGdyb3VwXG5Db2x1bW4ucHJvdG90eXBlLmF0dGFjaENvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdGlmIChzZWxmLmdyb3VwRWxlbWVudCkge1xuXHRcdHNlbGYuY29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0c2VsZi5ncm91cEVsZW1lbnQuYXBwZW5kQ2hpbGQoY29sdW1uLmdldEVsZW1lbnQoKSk7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIFdhcm5pbmcgLSBDb2x1bW4gYmVpbmcgYXR0YWNoZWQgdG8gYW5vdGhlciBjb2x1bW4gaW5zdGVhZCBvZiBjb2x1bW4gZ3JvdXBcIik7XG5cdH1cbn07XG5cbi8vdmVydGljYWxseSBhbGlnbiBoZWFkZXIgaW4gY29sdW1uXG5Db2x1bW4ucHJvdG90eXBlLnZlcnRpY2FsQWxpZ24gPSBmdW5jdGlvbiAoYWxpZ25tZW50LCBoZWlnaHQpIHtcblxuXHQvL2NhbGN1bGF0ZSBoZWlnaHQgb2YgY29sdW1uIGhlYWRlciBhbmQgZ3JvdXAgaG9sZGVyIGVsZW1lbnRcblx0dmFyIHBhcmVudEhlaWdodCA9IHRoaXMucGFyZW50LmlzR3JvdXAgPyB0aGlzLnBhcmVudC5nZXRHcm91cEVsZW1lbnQoKS5jbGllbnRIZWlnaHQgOiBoZWlnaHQgfHwgdGhpcy5wYXJlbnQuZ2V0SGVhZGVyc0VsZW1lbnQoKS5jbGllbnRIZWlnaHQ7XG5cdC8vIHZhciBwYXJlbnRIZWlnaHQgPSB0aGlzLnBhcmVudC5pc0dyb3VwID8gdGhpcy5wYXJlbnQuZ2V0R3JvdXBFbGVtZW50KCkuY2xpZW50SGVpZ2h0IDogdGhpcy5wYXJlbnQuZ2V0SGVhZGVyc0VsZW1lbnQoKS5jbGllbnRIZWlnaHQ7XG5cblx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IHBhcmVudEhlaWdodCArIFwicHhcIjtcblxuXHRpZiAodGhpcy5pc0dyb3VwKSB7XG5cdFx0dGhpcy5ncm91cEVsZW1lbnQuc3R5bGUubWluSGVpZ2h0ID0gcGFyZW50SGVpZ2h0IC0gdGhpcy5jb250ZW50RWxlbWVudC5vZmZzZXRIZWlnaHQgKyBcInB4XCI7XG5cdH1cblxuXHQvL3ZlcnRpY2FsbHkgYWxpZ24gY2VsbCBjb250ZW50c1xuXHRpZiAoIXRoaXMuaXNHcm91cCAmJiBhbGlnbm1lbnQgIT09IFwidG9wXCIpIHtcblx0XHRpZiAoYWxpZ25tZW50ID09PSBcImJvdHRvbVwiKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUucGFkZGluZ1RvcCA9IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgLSB0aGlzLmNvbnRlbnRFbGVtZW50Lm9mZnNldEhlaWdodCArIFwicHhcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLnBhZGRpbmdUb3AgPSAodGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMuY29udGVudEVsZW1lbnQub2Zmc2V0SGVpZ2h0KSAvIDIgKyBcInB4XCI7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGNvbHVtbi52ZXJ0aWNhbEFsaWduKGFsaWdubWVudCk7XG5cdH0pO1xufTtcblxuLy9jbGVhciB2ZXJ0aWNhbCBhbGlnbm1lbmV0XG5Db2x1bW4ucHJvdG90eXBlLmNsZWFyVmVydGljYWxBbGlnbiA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5lbGVtZW50LnN0eWxlLnBhZGRpbmdUb3AgPSBcIlwiO1xuXHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gXCJcIjtcblx0dGhpcy5lbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cdHRoaXMuZ3JvdXBFbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cblx0dGhpcy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGNvbHVtbi5jbGVhclZlcnRpY2FsQWxpZ24oKTtcblx0fSk7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLmJpbmRNb2R1bGVDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuXHQvL2NoZWNrIGlmIHJvd251bSBmb3JtYXR0ZXIgaXMgYmVpbmcgdXNlZCBvbiBhIGNvbHVtblxuXHRpZiAodGhpcy5kZWZpbml0aW9uLmZvcm1hdHRlciA9PSBcInJvd251bVwiKSB7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd051bUNvbHVtbiA9IHRoaXM7XG5cdH1cbn07XG5cbi8vLy8gUmV0cmVpdmUgQ29sdW1uIEluZm9ybWF0aW9uIC8vLy9cblxuLy9yZXR1cm4gY29sdW1uIGhlYWRlciBlbGVtZW50XG5Db2x1bW4ucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmVsZW1lbnQ7XG59O1xuXG4vL3JldHVybiBjb2x1bm0gZ3JvdXAgZWxlbWVudFxuQ29sdW1uLnByb3RvdHlwZS5nZXRHcm91cEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmdyb3VwRWxlbWVudDtcbn07XG5cbi8vcmV0dXJuIGZpZWxkIG5hbWVcbkNvbHVtbi5wcm90b3R5cGUuZ2V0RmllbGQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmZpZWxkO1xufTtcblxuLy9yZXR1cm4gdGhlIGZpcnN0IGNvbHVtbiBpbiBhIGdyb3VwXG5Db2x1bW4ucHJvdG90eXBlLmdldEZpcnN0Q29sdW1uID0gZnVuY3Rpb24gKCkge1xuXHRpZiAoIXRoaXMuaXNHcm91cCkge1xuXHRcdHJldHVybiB0aGlzO1xuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLmNvbHVtbnMubGVuZ3RoKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jb2x1bW5zWzBdLmdldEZpcnN0Q29sdW1uKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cbn07XG5cbi8vcmV0dXJuIHRoZSBsYXN0IGNvbHVtbiBpbiBhIGdyb3VwXG5Db2x1bW4ucHJvdG90eXBlLmdldExhc3RDb2x1bW4gPSBmdW5jdGlvbiAoKSB7XG5cdGlmICghdGhpcy5pc0dyb3VwKSB7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKHRoaXMuY29sdW1ucy5sZW5ndGgpIHtcblx0XHRcdHJldHVybiB0aGlzLmNvbHVtbnNbdGhpcy5jb2x1bW5zLmxlbmd0aCAtIDFdLmdldExhc3RDb2x1bW4oKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxufTtcblxuLy9yZXR1cm4gYWxsIGNvbHVtbnMgaW4gYSBncm91cFxuQ29sdW1uLnByb3RvdHlwZS5nZXRDb2x1bW5zID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5jb2x1bW5zO1xufTtcblxuLy9yZXR1cm4gYWxsIGNvbHVtbnMgaW4gYSBncm91cFxuQ29sdW1uLnByb3RvdHlwZS5nZXRDZWxscyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuY2VsbHM7XG59O1xuXG4vL3JldHJlaXZlIHRoZSB0b3AgY29sdW1uIGluIGEgZ3JvdXAgb2YgY29sdW1uc1xuQ29sdW1uLnByb3RvdHlwZS5nZXRUb3BDb2x1bW4gPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0cmV0dXJuIHRoaXMucGFyZW50LmdldFRvcENvbHVtbigpO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59O1xuXG4vL3JldHVybiBjb2x1bW4gZGVmaW5pdGlvbiBvYmplY3RcbkNvbHVtbi5wcm90b3R5cGUuZ2V0RGVmaW5pdGlvbiA9IGZ1bmN0aW9uICh1cGRhdGVCcmFuY2hlcykge1xuXHR2YXIgY29sRGVmcyA9IFtdO1xuXG5cdGlmICh0aGlzLmlzR3JvdXAgJiYgdXBkYXRlQnJhbmNoZXMpIHtcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0XHRjb2xEZWZzLnB1c2goY29sdW1uLmdldERlZmluaXRpb24odHJ1ZSkpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5kZWZpbml0aW9uLmNvbHVtbnMgPSBjb2xEZWZzO1xuXHR9XG5cblx0cmV0dXJuIHRoaXMuZGVmaW5pdGlvbjtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vIEFjdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuQ29sdW1uLnByb3RvdHlwZS5jaGVja0NvbHVtblZpc2liaWxpdHkgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciB2aXNpYmxlID0gZmFsc2U7XG5cblx0dGhpcy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4udmlzaWJsZSkge1xuXHRcdFx0dmlzaWJsZSA9IHRydWU7XG5cdFx0fVxuXHR9KTtcblxuXHRpZiAodmlzaWJsZSkge1xuXHRcdHRoaXMuc2hvdygpO1xuXHRcdHRoaXMucGFyZW50LnRhYmxlLm9wdGlvbnMuY29sdW1uVmlzaWJpbGl0eUNoYW5nZWQuY2FsbCh0aGlzLnRhYmxlLCB0aGlzLmdldENvbXBvbmVudCgpLCBmYWxzZSk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5oaWRlKCk7XG5cdH1cbn07XG5cbi8vc2hvdyBjb2x1bW5cbkNvbHVtbi5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uIChzaWxlbnQsIHJlc3BvbnNpdmVUb2dnbGUpIHtcblx0aWYgKCF0aGlzLnZpc2libGUpIHtcblx0XHR0aGlzLnZpc2libGUgPSB0cnVlO1xuXG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuXG5cdFx0aWYgKHRoaXMucGFyZW50LmlzR3JvdXApIHtcblx0XHRcdHRoaXMucGFyZW50LmNoZWNrQ29sdW1uVmlzaWJpbGl0eSgpO1xuXHRcdH1cblxuXHRcdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdFx0Y2VsbC5zaG93KCk7XG5cdFx0fSk7XG5cblx0XHRpZiAoIXRoaXMuaXNHcm91cCAmJiB0aGlzLndpZHRoID09PSBudWxsKSB7XG5cdFx0XHR0aGlzLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLl92ZXJ0aWNhbEFsaWduSGVhZGVycygpO1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuY29sdW1ucykge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJjb2x1bW5zXCIpO1xuXHRcdH1cblxuXHRcdGlmICghcmVzcG9uc2l2ZVRvZ2dsZSAmJiB0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZUNvbHVtblZpc2liaWxpdHkodGhpcywgdGhpcy52aXNpYmxlKTtcblx0XHR9XG5cblx0XHRpZiAoIXNpbGVudCkge1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNvbHVtblZpc2liaWxpdHlDaGFuZ2VkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5nZXRDb21wb25lbnQoKSwgdHJ1ZSk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMucGFyZW50LmlzR3JvdXApIHtcblx0XHRcdHRoaXMucGFyZW50Lm1hdGNoQ2hpbGRXaWR0aHMoKTtcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuc2lsZW50ICYmIHRoaXMudGFibGUub3B0aW9ucy52aXJ0dWFsRG9tSG96KSB7XG5cdFx0XHR0aGlzLnRhYmxlLnZkb21Ib3oucmVpbml0aWFsaXplKCk7XG5cdFx0fVxuXHR9XG59O1xuXG4vL2hpZGUgY29sdW1uXG5Db2x1bW4ucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoc2lsZW50LCByZXNwb25zaXZlVG9nZ2xlKSB7XG5cdGlmICh0aGlzLnZpc2libGUpIHtcblx0XHR0aGlzLnZpc2libGUgPSBmYWxzZTtcblxuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuX3ZlcnRpY2FsQWxpZ25IZWFkZXJzKCk7XG5cblx0XHRpZiAodGhpcy5wYXJlbnQuaXNHcm91cCkge1xuXHRcdFx0dGhpcy5wYXJlbnQuY2hlY2tDb2x1bW5WaXNpYmlsaXR5KCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0XHRjZWxsLmhpZGUoKTtcblx0XHR9KTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiB0aGlzLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2UuY29uZmlnLmNvbHVtbnMpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5zYXZlKFwiY29sdW1uc1wiKTtcblx0XHR9XG5cblx0XHRpZiAoIXJlc3BvbnNpdmVUb2dnbGUgJiYgdGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGVDb2x1bW5WaXNpYmlsaXR5KHRoaXMsIHRoaXMudmlzaWJsZSk7XG5cdFx0fVxuXG5cdFx0aWYgKCFzaWxlbnQpIHtcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5WaXNpYmlsaXR5Q2hhbmdlZC5jYWxsKHRoaXMudGFibGUsIHRoaXMuZ2V0Q29tcG9uZW50KCksIGZhbHNlKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5wYXJlbnQuaXNHcm91cCkge1xuXHRcdFx0dGhpcy5wYXJlbnQubWF0Y2hDaGlsZFdpZHRocygpO1xuXHRcdH1cblxuXHRcdGlmICghdGhpcy5zaWxlbnQgJiYgdGhpcy50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdHRoaXMudGFibGUudmRvbUhvei5yZWluaXRpYWxpemUoKTtcblx0XHR9XG5cdH1cbn07XG5cbkNvbHVtbi5wcm90b3R5cGUubWF0Y2hDaGlsZFdpZHRocyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNoaWxkV2lkdGggPSAwO1xuXG5cdGlmICh0aGlzLmNvbnRlbnRFbGVtZW50ICYmIHRoaXMuY29sdW1ucy5sZW5ndGgpIHtcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0XHRpZiAoY29sdW1uLnZpc2libGUpIHtcblx0XHRcdFx0Y2hpbGRXaWR0aCArPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuY29udGVudEVsZW1lbnQuc3R5bGUubWF4V2lkdGggPSBjaGlsZFdpZHRoIC0gMSArIFwicHhcIjtcblxuXHRcdGlmICh0aGlzLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0XHR0aGlzLnBhcmVudC5tYXRjaENoaWxkV2lkdGhzKCk7XG5cdFx0fVxuXHR9XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG5cdHZhciBpbmRleCA9IHRoaXMuY29sdW1ucy5pbmRleE9mKGNoaWxkKTtcblxuXHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdHRoaXMuY29sdW1ucy5zcGxpY2UoaW5kZXgsIDEpO1xuXHR9XG5cblx0aWYgKCF0aGlzLmNvbHVtbnMubGVuZ3RoKSB7XG5cdFx0dGhpcy5kZWxldGUoKTtcblx0fVxufTtcblxuQ29sdW1uLnByb3RvdHlwZS5zZXRXaWR0aCA9IGZ1bmN0aW9uICh3aWR0aCkge1xuXHR0aGlzLndpZHRoRml4ZWQgPSB0cnVlO1xuXHR0aGlzLnNldFdpZHRoQWN0dWFsKHdpZHRoKTtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuc2V0V2lkdGhBY3R1YWwgPSBmdW5jdGlvbiAod2lkdGgpIHtcblx0aWYgKGlzTmFOKHdpZHRoKSkge1xuXHRcdHdpZHRoID0gTWF0aC5mbG9vcih0aGlzLnRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGggLyAxMDAgKiBwYXJzZUludCh3aWR0aCkpO1xuXHR9XG5cblx0d2lkdGggPSBNYXRoLm1heCh0aGlzLm1pbldpZHRoLCB3aWR0aCk7XG5cblx0aWYgKHRoaXMubWF4V2lkdGgpIHtcblx0XHR3aWR0aCA9IE1hdGgubWluKHRoaXMubWF4V2lkdGgsIHdpZHRoKTtcblx0fVxuXG5cdHRoaXMud2lkdGggPSB3aWR0aDtcblx0dGhpcy53aWR0aFN0eWxlZCA9IHdpZHRoID8gd2lkdGggKyBcInB4XCIgOiBcIlwiO1xuXG5cdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGhTdHlsZWQ7XG5cblx0aWYgKCF0aGlzLmlzR3JvdXApIHtcblx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRcdGNlbGwuc2V0V2lkdGgoKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmICh0aGlzLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0dGhpcy5wYXJlbnQubWF0Y2hDaGlsZFdpZHRocygpO1xuXHR9XG5cblx0Ly9zZXQgcmVzaXphYmxlIGhhbmRsZXNcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZnJvemVuQ29sdW1uc1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmxheW91dCgpO1xuXHR9XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLmNoZWNrQ2VsbEhlaWdodHMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciByb3dzID0gW107XG5cblx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0aWYgKGNlbGwucm93LmhlaWdodEluaXRpYWxpemVkKSB7XG5cdFx0XHRpZiAoY2VsbC5yb3cuZ2V0RWxlbWVudCgpLm9mZnNldFBhcmVudCAhPT0gbnVsbCkge1xuXHRcdFx0XHRyb3dzLnB1c2goY2VsbC5yb3cpO1xuXHRcdFx0XHRjZWxsLnJvdy5jbGVhckNlbGxIZWlnaHQoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNlbGwucm93LmhlaWdodEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdHJvdy5jYWxjSGVpZ2h0KCk7XG5cdH0pO1xuXG5cdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0cm93LnNldENlbGxIZWlnaHQoKTtcblx0fSk7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgd2lkdGggPSAwO1xuXG5cdGlmICh0aGlzLmlzR3JvdXApIHtcblx0XHR0aGlzLmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0XHRpZiAoY29sdW1uLnZpc2libGUpIHtcblx0XHRcdFx0d2lkdGggKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0d2lkdGggPSB0aGlzLndpZHRoO1xuXHR9XG5cblx0cmV0dXJuIHdpZHRoO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5zZXRNaW5XaWR0aCA9IGZ1bmN0aW9uIChtaW5XaWR0aCkge1xuXHR0aGlzLm1pbldpZHRoID0gbWluV2lkdGg7XG5cdHRoaXMubWluV2lkdGhTdHlsZWQgPSBtaW5XaWR0aCA/IG1pbldpZHRoICsgXCJweFwiIDogXCJcIjtcblxuXHR0aGlzLmVsZW1lbnQuc3R5bGUubWluV2lkdGggPSB0aGlzLm1pbldpZHRoU3R5bGVkO1xuXG5cdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdGNlbGwuc2V0TWluV2lkdGgoKTtcblx0fSk7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLnNldE1heFdpZHRoID0gZnVuY3Rpb24gKG1heFdpZHRoKSB7XG5cdHRoaXMubWF4V2lkdGggPSBtYXhXaWR0aDtcblx0dGhpcy5tYXhXaWR0aFN0eWxlZCA9IG1heFdpZHRoID8gbWF4V2lkdGggKyBcInB4XCIgOiBcIlwiO1xuXG5cdHRoaXMuZWxlbWVudC5zdHlsZS5tYXhXaWR0aCA9IHRoaXMubWF4V2lkdGhTdHlsZWQ7XG5cblx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0Y2VsbC5zZXRNYXhXaWR0aCgpO1xuXHR9KTtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXM5ID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBpbmRleDtcblxuXHRcdGlmIChfdGhpczkuaXNHcm91cCkge1xuXHRcdFx0X3RoaXM5LmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0XHRcdGNvbHVtbi5kZWxldGUoKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8vY2FuY2VsIGVkaXQgaWYgY29sdW1uIGlzIGN1cnJlbnRseSBiZWluZyBlZGl0ZWRcblx0XHRpZiAoX3RoaXM5LnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikpIHtcblx0XHRcdGlmIChfdGhpczkudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsLmNvbHVtbiA9PT0gX3RoaXM5KSB7XG5cdFx0XHRcdF90aGlzOS50YWJsZS5tb2R1bGVzLmVkaXQuY2FuY2VsRWRpdCgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHZhciBjZWxsQ291bnQgPSBfdGhpczkuY2VsbHMubGVuZ3RoO1xuXG5cdFx0Zm9yICh2YXIgX2kzID0gMDsgX2kzIDwgY2VsbENvdW50OyBfaTMrKykge1xuXHRcdFx0X3RoaXM5LmNlbGxzWzBdLmRlbGV0ZSgpO1xuXHRcdH1cblxuXHRcdGlmIChfdGhpczkuZWxlbWVudC5wYXJlbnROb2RlKSB7XG5cdFx0XHRfdGhpczkuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKF90aGlzOS5lbGVtZW50KTtcblx0XHR9XG5cblx0XHRfdGhpczkuZWxlbWVudCA9IGZhbHNlO1xuXHRcdF90aGlzOS5jb250ZW50RWxlbWVudCA9IGZhbHNlO1xuXHRcdF90aGlzOS50aXRsZUVsZW1lbnQgPSBmYWxzZTtcblx0XHRfdGhpczkuZ3JvdXBFbGVtZW50ID0gZmFsc2U7XG5cblx0XHRpZiAoX3RoaXM5LnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0XHRfdGhpczkucGFyZW50LnJlbW92ZUNoaWxkKF90aGlzOSk7XG5cdFx0fVxuXG5cdFx0X3RoaXM5LnRhYmxlLmNvbHVtbk1hbmFnZXIuZGVyZWdpc3RlckNvbHVtbihfdGhpczkpO1xuXG5cdFx0aWYgKF90aGlzOS50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdF90aGlzOS50YWJsZS52ZG9tSG96LnJlaW5pdGlhbGl6ZSh0cnVlKTtcblx0XHR9XG5cblx0XHRyZXNvbHZlKCk7XG5cdH0pO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5jb2x1bW5SZW5kZXJlZCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMudGl0bGVGb3JtYXR0ZXJSZW5kZXJlZCkge1xuXHRcdHRoaXMudGl0bGVGb3JtYXR0ZXJSZW5kZXJlZCgpO1xuXHR9XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgaW52YWxpZCA9IFtdO1xuXG5cdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdGlmICghY2VsbC52YWxpZGF0ZSgpKSB7XG5cdFx0XHRpbnZhbGlkLnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gaW52YWxpZC5sZW5ndGggPyBpbnZhbGlkIDogdHJ1ZTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8gQ2VsbCBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vLy8vXG5cbi8vZ2VuZXJhdGUgY2VsbCBmb3IgdGhpcyBjb2x1bW5cbkNvbHVtbi5wcm90b3R5cGUuZ2VuZXJhdGVDZWxsID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0dmFyIGNlbGwgPSBuZXcgQ2VsbChzZWxmLCByb3cpO1xuXG5cdHRoaXMuY2VsbHMucHVzaChjZWxsKTtcblxuXHRyZXR1cm4gY2VsbDtcbn07XG5cbkNvbHVtbi5wcm90b3R5cGUubmV4dENvbHVtbiA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGluZGV4ID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW5JbmRleCh0aGlzKTtcblx0cmV0dXJuIGluZGV4ID4gLTEgPyB0aGlzLl9uZXh0VmlzaWJsZUNvbHVtbihpbmRleCArIDEpIDogZmFsc2U7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLl9uZXh0VmlzaWJsZUNvbHVtbiA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHR2YXIgY29sdW1uID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbHVtbkJ5SW5kZXgoaW5kZXgpO1xuXHRyZXR1cm4gIWNvbHVtbiB8fCBjb2x1bW4udmlzaWJsZSA/IGNvbHVtbiA6IHRoaXMuX25leHRWaXNpYmxlQ29sdW1uKGluZGV4ICsgMSk7XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLnByZXZDb2x1bW4gPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBpbmRleCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uSW5kZXgodGhpcyk7XG5cdHJldHVybiBpbmRleCA+IC0xID8gdGhpcy5fcHJldlZpc2libGVDb2x1bW4oaW5kZXggLSAxKSA6IGZhbHNlO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5fcHJldlZpc2libGVDb2x1bW4gPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0dmFyIGNvbHVtbiA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUluZGV4KGluZGV4KTtcblx0cmV0dXJuICFjb2x1bW4gfHwgY29sdW1uLnZpc2libGUgPyBjb2x1bW4gOiB0aGlzLl9wcmV2VmlzaWJsZUNvbHVtbihpbmRleCAtIDEpO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5yZWluaXRpYWxpemVXaWR0aCA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHR0aGlzLndpZHRoRml4ZWQgPSBmYWxzZTtcblxuXHQvL3NldCB3aWR0aCBpZiBwcmVzZW50XG5cdGlmICh0eXBlb2YgdGhpcy5kZWZpbml0aW9uLndpZHRoICE9PSBcInVuZGVmaW5lZFwiICYmICFmb3JjZSkge1xuXHRcdHRoaXMuc2V0V2lkdGgodGhpcy5kZWZpbml0aW9uLndpZHRoKTtcblx0fVxuXG5cdC8vaGlkZSBoZWFkZXIgZmlsdGVycyB0byBwcmV2ZW50IHRoZW0gYWx0ZXJpbmcgY29sdW1uIHdpZHRoXG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZpbHRlclwiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5maWx0ZXIuaGlkZUhlYWRlckZpbHRlckVsZW1lbnRzKCk7XG5cdH1cblxuXHR0aGlzLmZpdFRvRGF0YSgpO1xuXG5cdC8vc2hvdyBoZWFkZXIgZmlsdGVycyBhZ2FpbiBhZnRlciBsYXlvdXQgaXMgY29tcGxldGVcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZmlsdGVyXCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmZpbHRlci5zaG93SGVhZGVyRmlsdGVyRWxlbWVudHMoKTtcblx0fVxufTtcblxuLy9zZXQgY29sdW1uIHdpZHRoIHRvIG1heGltdW0gY2VsbCB3aWR0aFxuQ29sdW1uLnByb3RvdHlwZS5maXRUb0RhdGEgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRpZiAoIXRoaXMud2lkdGhGaXhlZCkge1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IFwiXCI7XG5cblx0XHRzZWxmLmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRcdGNlbGwuY2xlYXJXaWR0aCgpO1xuXHRcdH0pO1xuXHR9XG5cblx0dmFyIG1heFdpZHRoID0gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xuXG5cdGlmICghc2VsZi53aWR0aCB8fCAhdGhpcy53aWR0aEZpeGVkKSB7XG5cdFx0c2VsZi5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0XHR2YXIgd2lkdGggPSBjZWxsLmdldFdpZHRoKCk7XG5cblx0XHRcdGlmICh3aWR0aCA+IG1heFdpZHRoKSB7XG5cdFx0XHRcdG1heFdpZHRoID0gd2lkdGg7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAobWF4V2lkdGgpIHtcblx0XHRcdHNlbGYuc2V0V2lkdGhBY3R1YWwobWF4V2lkdGggKyAxKTtcblx0XHR9XG5cdH1cbn07XG5cbkNvbHVtbi5wcm90b3R5cGUudXBkYXRlRGVmaW5pdGlvbiA9IGZ1bmN0aW9uICh1cGRhdGVzKSB7XG5cdHZhciBfdGhpczEwID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBkZWZpbml0aW9uO1xuXG5cdFx0aWYgKCFfdGhpczEwLmlzR3JvdXApIHtcblx0XHRcdGlmICghX3RoaXMxMC5wYXJlbnQuaXNHcm91cCkge1xuXHRcdFx0XHRkZWZpbml0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMxMC5nZXREZWZpbml0aW9uKCkpO1xuXHRcdFx0XHRkZWZpbml0aW9uID0gT2JqZWN0LmFzc2lnbihkZWZpbml0aW9uLCB1cGRhdGVzKTtcblxuXHRcdFx0XHRfdGhpczEwLnRhYmxlLmNvbHVtbk1hbmFnZXIuYWRkQ29sdW1uKGRlZmluaXRpb24sIGZhbHNlLCBfdGhpczEwKS50aGVuKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdFx0XHRcdGlmIChkZWZpbml0aW9uLmZpZWxkID09IF90aGlzMTAuZmllbGQpIHtcblx0XHRcdFx0XHRcdF90aGlzMTAuZmllbGQgPSBmYWxzZTsgLy9jbGVhaXIgZmllbGQgbmFtZSB0byBwcmV2ZW50IGRlbGV0aW9uIG9mIGR1cGxpY2F0ZSBjb2x1bW4gZnJvbSBhcnJheXNcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRfdGhpczEwLmRlbGV0ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0cmVzb2x2ZShjb2x1bW4uZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIFVwZGF0ZSBFcnJvciAtIFRoZSB1cGRhdGVEZWZpbml0aW9uIGZ1bmN0aW9uIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHVuZ3JvdXBlZCBjb2x1bW5zXCIpO1xuXHRcdFx0XHRyZWplY3QoXCJDb2x1bW4gVXBkYXRlIEVycm9yIC0gVGhlIHVwZGF0ZURlZmluaXRpb24gZnVuY3Rpb24gaXMgb25seSBhdmFpbGFibGUgb24gY29sdW1ucywgbm90IGNvbHVtbiBncm91cHNcIik7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBVcGRhdGUgRXJyb3IgLSBUaGUgdXBkYXRlRGVmaW5pdGlvbiBmdW5jdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSBvbiB1bmdyb3VwZWQgY29sdW1uc1wiKTtcblx0XHRcdHJlamVjdChcIkNvbHVtbiBVcGRhdGUgRXJyb3IgLSBUaGUgdXBkYXRlRGVmaW5pdGlvbiBmdW5jdGlvbiBpcyBvbmx5IGF2YWlsYWJsZSBvbiBjb2x1bW5zLCBub3QgY29sdW1uIGdyb3Vwc1wiKTtcblx0XHR9XG5cdH0pO1xufTtcblxuQ29sdW1uLnByb3RvdHlwZS5kZWxldGVDZWxsID0gZnVuY3Rpb24gKGNlbGwpIHtcblx0dmFyIGluZGV4ID0gdGhpcy5jZWxscy5pbmRleE9mKGNlbGwpO1xuXG5cdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0dGhpcy5jZWxscy5zcGxpY2UoaW5kZXgsIDEpO1xuXHR9XG59O1xuXG5Db2x1bW4ucHJvdG90eXBlLmRlZmF1bHRPcHRpb25MaXN0ID0gW1widGl0bGVcIiwgXCJmaWVsZFwiLCBcImNvbHVtbnNcIiwgXCJ2aXNpYmxlXCIsIFwiYWxpZ25cIiwgXCJob3pBbGlnblwiLCBcInZlcnRBbGlnblwiLCBcIndpZHRoXCIsIFwibWluV2lkdGhcIiwgXCJtYXhXaWR0aFwiLCBcIndpZHRoR3Jvd1wiLCBcIndpZHRoU2hyaW5rXCIsIFwicmVzaXphYmxlXCIsIFwiZnJvemVuXCIsIFwicmVzcG9uc2l2ZVwiLCBcInRvb2x0aXBcIiwgXCJjc3NDbGFzc1wiLCBcInJvd0hhbmRsZVwiLCBcImhpZGVJbkh0bWxcIiwgXCJwcmludFwiLCBcImh0bWxPdXRwdXRcIiwgXCJzb3J0ZXJcIiwgXCJzb3J0ZXJQYXJhbXNcIiwgXCJmb3JtYXR0ZXJcIiwgXCJmb3JtYXR0ZXJQYXJhbXNcIiwgXCJ2YXJpYWJsZUhlaWdodFwiLCBcImVkaXRhYmxlXCIsIFwiZWRpdG9yXCIsIFwiZWRpdG9yUGFyYW1zXCIsIFwidmFsaWRhdG9yXCIsIFwibXV0YXRvclwiLCBcIm11dGF0b3JQYXJhbXNcIiwgXCJtdXRhdG9yRGF0YVwiLCBcIm11dGF0b3JEYXRhUGFyYW1zXCIsIFwibXV0YXRvckVkaXRcIiwgXCJtdXRhdG9yRWRpdFBhcmFtc1wiLCBcIm11dGF0b3JDbGlwYm9hcmRcIiwgXCJtdXRhdG9yQ2xpcGJvYXJkUGFyYW1zXCIsIFwiYWNjZXNzb3JcIiwgXCJhY2Nlc3NvclBhcmFtc1wiLCBcImFjY2Vzc29yRGF0YVwiLCBcImFjY2Vzc29yRGF0YVBhcmFtc1wiLCBcImFjY2Vzc29yRG93bmxvYWRcIiwgXCJhY2Nlc3NvckRvd25sb2FkUGFyYW1zXCIsIFwiYWNjZXNzb3JDbGlwYm9hcmRcIiwgXCJhY2Nlc3NvckNsaXBib2FyZFBhcmFtc1wiLCBcImFjY2Vzc29yUHJpbnRcIiwgXCJhY2Nlc3NvclByaW50UGFyYW1zXCIsIFwiYWNjZXNzb3JIdG1sT3V0cHV0XCIsIFwiYWNjZXNzb3JIdG1sT3V0cHV0UGFyYW1zXCIsIFwiY2xpcGJvYXJkXCIsIFwiZG93bmxvYWRcIiwgXCJkb3dubG9hZFRpdGxlXCIsIFwidG9wQ2FsY1wiLCBcInRvcENhbGNQYXJhbXNcIiwgXCJ0b3BDYWxjRm9ybWF0dGVyXCIsIFwidG9wQ2FsY0Zvcm1hdHRlclBhcmFtc1wiLCBcImJvdHRvbUNhbGNcIiwgXCJib3R0b21DYWxjUGFyYW1zXCIsIFwiYm90dG9tQ2FsY0Zvcm1hdHRlclwiLCBcImJvdHRvbUNhbGNGb3JtYXR0ZXJQYXJhbXNcIiwgXCJjZWxsQ2xpY2tcIiwgXCJjZWxsRGJsQ2xpY2tcIiwgXCJjZWxsQ29udGV4dFwiLCBcImNlbGxUYXBcIiwgXCJjZWxsRGJsVGFwXCIsIFwiY2VsbFRhcEhvbGRcIiwgXCJjZWxsTW91c2VFbnRlclwiLCBcImNlbGxNb3VzZUxlYXZlXCIsIFwiY2VsbE1vdXNlT3ZlclwiLCBcImNlbGxNb3VzZU91dFwiLCBcImNlbGxNb3VzZU1vdmVcIiwgXCJjZWxsRWRpdGluZ1wiLCBcImNlbGxFZGl0ZWRcIiwgXCJjZWxsRWRpdENhbmNlbGxlZFwiLCBcImhlYWRlclNvcnRcIiwgXCJoZWFkZXJTb3J0U3RhcnRpbmdEaXJcIiwgXCJoZWFkZXJTb3J0VHJpc3RhdGVcIiwgXCJoZWFkZXJDbGlja1wiLCBcImhlYWRlckRibENsaWNrXCIsIFwiaGVhZGVyQ29udGV4dFwiLCBcImhlYWRlclRhcFwiLCBcImhlYWRlckRibFRhcFwiLCBcImhlYWRlclRhcEhvbGRcIiwgXCJoZWFkZXJUb29sdGlwXCIsIFwiaGVhZGVyVmVydGljYWxcIiwgXCJoZWFkZXJIb3pBbGlnblwiLCBcImVkaXRhYmxlVGl0bGVcIiwgXCJ0aXRsZUZvcm1hdHRlclwiLCBcInRpdGxlRm9ybWF0dGVyUGFyYW1zXCIsIFwiaGVhZGVyRmlsdGVyXCIsIFwiaGVhZGVyRmlsdGVyUGxhY2Vob2xkZXJcIiwgXCJoZWFkZXJGaWx0ZXJQYXJhbXNcIiwgXCJoZWFkZXJGaWx0ZXJFbXB0eUNoZWNrXCIsIFwiaGVhZGVyRmlsdGVyRnVuY1wiLCBcImhlYWRlckZpbHRlckZ1bmNQYXJhbXNcIiwgXCJoZWFkZXJGaWx0ZXJMaXZlRmlsdGVyXCIsIFwicHJpbnRcIiwgXCJoZWFkZXJDb250ZXh0TWVudVwiLCBcImhlYWRlck1lbnVcIiwgXCJjb250ZXh0TWVudVwiLFxuLy8gXCJoZWFkZXJDbGlja01lbnVcIixcblwiY2xpY2tNZW51XCIsIFwiZm9ybWF0dGVyUHJpbnRcIiwgXCJmb3JtYXR0ZXJQcmludFBhcmFtc1wiLCBcImZvcm1hdHRlckNsaXBib2FyZFwiLCBcImZvcm1hdHRlckNsaXBib2FyZFBhcmFtc1wiLCBcImZvcm1hdHRlckh0bWxPdXRwdXRcIiwgXCJmb3JtYXR0ZXJIdG1sT3V0cHV0UGFyYW1zXCIsIFwidGl0bGVQcmludFwiLCBcInRpdGxlQ2xpcGJvYXJkXCIsIFwidGl0bGVIdG1sT3V0cHV0XCIsIFwidGl0bGVEb3dubG9hZFwiXTtcblxuLy8vLy8vLy8vLy8vLy8vLyBFdmVudCBCaW5kaW5ncyAvLy8vLy8vLy8vLy8vLy8vL1xuXG4vLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5Db2x1bW4ucHJvdG90eXBlLmdldENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKCF0aGlzLmNvbXBvbmVudCkge1xuXHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IENvbHVtbkNvbXBvbmVudCh0aGlzKTtcblx0fVxuXG5cdHJldHVybiB0aGlzLmNvbXBvbmVudDtcbn07XG5cbnZhciBSb3dNYW5hZ2VyID0gZnVuY3Rpb24gUm93TWFuYWdlcih0YWJsZSkge1xuXG5cdHRoaXMudGFibGUgPSB0YWJsZTtcblx0dGhpcy5lbGVtZW50ID0gdGhpcy5jcmVhdGVIb2xkZXJFbGVtZW50KCk7IC8vY29udGFpbmluZyBlbGVtZW50XG5cdHRoaXMudGFibGVFbGVtZW50ID0gdGhpcy5jcmVhdGVUYWJsZUVsZW1lbnQoKTsgLy90YWJsZSBlbGVtZW50XG5cdHRoaXMuaGVpZ2h0Rml4ZXIgPSB0aGlzLmNyZWF0ZVRhYmxlRWxlbWVudCgpOyAvL3RhYmxlIGVsZW1lbnRcblx0dGhpcy5jb2x1bW5NYW5hZ2VyID0gbnVsbDsgLy9ob2xkIGNvbHVtbiBtYW5hZ2VyIG9iamVjdFxuXHR0aGlzLmhlaWdodCA9IDA7IC8vaG9sZCBoZWlnaHQgb2YgdGFibGUgZWxlbWVudFxuXG5cdHRoaXMuZmlyc3RSZW5kZXIgPSBmYWxzZTsgLy9oYW5kbGUgZmlyc3QgcmVuZGVyXG5cdHRoaXMucmVuZGVyTW9kZSA9IFwidmlydHVhbFwiOyAvL2N1cnJlbnQgcmVuZGVyaW5nIG1vZGVcblx0dGhpcy5maXhlZEhlaWdodCA9IGZhbHNlOyAvL2N1cnJlbnQgcmVuZGVyaW5nIG1vZGVcblxuXHR0aGlzLnJvd3MgPSBbXTsgLy9ob2xkIHJvdyBkYXRhIG9iamVjdHNcblx0dGhpcy5hY3RpdmVSb3dzID0gW107IC8vcm93cyBjdXJyZW50bHkgYXZhaWxhYmxlIHRvIG9uIGRpc3BsYXkgaW4gdGhlIHRhYmxlXG5cdHRoaXMuYWN0aXZlUm93c0NvdW50ID0gMDsgLy9jb3VudCBvZiBhY3RpdmUgcm93c1xuXG5cdHRoaXMuZGlzcGxheVJvd3MgPSBbXTsgLy9yb3dzIGN1cnJlbnRseSBvbiBkaXNwbGF5IGluIHRoZSB0YWJsZVxuXHR0aGlzLmRpc3BsYXlSb3dzQ291bnQgPSAwOyAvL2NvdW50IG9mIGRpc3BsYXkgcm93c1xuXG5cdHRoaXMuc2Nyb2xsVG9wID0gMDtcblx0dGhpcy5zY3JvbGxMZWZ0ID0gMDtcblxuXHR0aGlzLnZEb21Sb3dIZWlnaHQgPSAyMDsgLy9hcHByb3hpbWF0aW9uIG9mIHJvdyBoZWlnaHRzIGZvciBwYWRkaW5nXG5cblx0dGhpcy52RG9tVG9wID0gMDsgLy9ob2xkIHBvc2l0aW9uIGZvciBmaXJzdCByZW5kZXJlZCByb3cgaW4gdGhlIHZpcnR1YWwgRE9NXG5cdHRoaXMudkRvbUJvdHRvbSA9IDA7IC8vaG9sZCBwb3NzaXRpb24gZm9yIGxhc3QgcmVuZGVyZWQgcm93IGluIHRoZSB2aXJ0dWFsIERPTVxuXG5cdHRoaXMudkRvbVNjcm9sbFBvc1RvcCA9IDA7IC8vbGFzdCBzY3JvbGwgcG9zaXRpb24gb2YgdGhlIHZEb20gdG9wO1xuXHR0aGlzLnZEb21TY3JvbGxQb3NCb3R0b20gPSAwOyAvL2xhc3Qgc2Nyb2xsIHBvc2l0aW9uIG9mIHRoZSB2RG9tIGJvdHRvbTtcblxuXHR0aGlzLnZEb21Ub3BQYWQgPSAwOyAvL2hvbGQgdmFsdWUgb2YgcGFkZGluZyBmb3IgdG9wIG9mIHZpcnR1YWwgRE9NXG5cdHRoaXMudkRvbUJvdHRvbVBhZCA9IDA7IC8vaG9sZCB2YWx1ZSBvZiBwYWRkaW5nIGZvciBib3R0b20gb2YgdmlydHVhbCBET01cblxuXHR0aGlzLnZEb21NYXhSZW5kZXJDaGFpbiA9IDkwOyAvL3RoZSBtYXhpbXVtIG51bWJlciBvZiBkb20gZWxlbWVudHMgdGhhdCBjYW4gYmUgcmVuZGVyZWQgaW4gMSBnb1xuXG5cdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IDA7IC8vd2luZG93IHJvdyBidWZmZXIgYmVmb3JlIHJlbW92aW5nIGVsZW1lbnRzLCB0byBzbW9vdGggc2Nyb2xsaW5nXG5cblx0dGhpcy52RG9tV2luZG93TWluVG90YWxSb3dzID0gMjA7IC8vbWluaW11bSBudW1iZXIgb2Ygcm93cyB0byBiZSBnZW5lcmF0ZWQgaW4gdmlydHVhbCBkb20gKHByZXZlbnQgYnVmZmVyaW5nIGlzc3VlcyBvbiB0YWJsZXMgd2l0aCB0YWxsIHJvd3MpXG5cdHRoaXMudkRvbVdpbmRvd01pbk1hcmdpblJvd3MgPSA1OyAvL21pbmltdW0gbnVtYmVyIG9mIHJvd3MgdG8gYmUgZ2VuZXJhdGVkIGluIHZpcnR1YWwgZG9tIG1hcmdpblxuXG5cdHRoaXMudkRvbVRvcE5ld1Jvd3MgPSBbXTsgLy9yb3dzIHRvIG5vcm1hbGl6ZSBhZnRlciBhcHBlbmRpbmcgdG8gb3B0aW1pemUgcmVuZGVyIHNwZWVkXG5cdHRoaXMudkRvbUJvdHRvbU5ld1Jvd3MgPSBbXTsgLy9yb3dzIHRvIG5vcm1hbGl6ZSBhZnRlciBhcHBlbmRpbmcgdG8gb3B0aW1pemUgcmVuZGVyIHNwZWVkXG5cblx0dGhpcy5yb3dOdW1Db2x1bW4gPSBmYWxzZTsgLy9ob2xkIGNvbHVtbiBjb21wb25lbnQgZm9yIHJvdyBudW1iZXIgY29sdW1uXG5cblx0dGhpcy5yZWRyYXdCbG9jayA9IGZhbHNlOyAvL3ByZXZlbnQgcmVkcmF3cyB0byBhbGxvdyBtdWx0aXBsZSBkYXRhIG1hbmlwdWxhdGlvbnMgYmVjb3JlIGNvbnRpbnVpbmdcblx0dGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcgPSBmYWxzZTsgLy9zdG9yZSBsYXRlc3QgcmVkcmF3IGZ1bmN0aW9uIGNhbGxzIGZvciB3aGVuIHJlZHJhdyBpcyBuZWVkZWRcblx0dGhpcy5yZWRyYXdCbG9ja1JlZGVySW5Qb3NpdGlvbiA9IGZhbHNlOyAvL3N0b3JlIGxhdGVzdCByZWRyYXcgZnVuY3Rpb24gY2FsbHMgZm9yIHdoZW4gcmVkcmF3IGlzIG5lZWRlZFxufTtcblxuLy8vLy8vLy8vLy8vLy8vLyBTZXR1cCBGdW5jdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy9cblxuUm93TWFuYWdlci5wcm90b3R5cGUuY3JlYXRlSG9sZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXRhYmxlSG9sZGVyXCIpO1xuXHRlbC5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCAwKTtcblxuXHRyZXR1cm4gZWw7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5jcmVhdGVUYWJsZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cblx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10YWJsZVwiKTtcblxuXHRyZXR1cm4gZWw7XG59O1xuXG4vL3JldHVybiBjb250YWluaW5nIGVsZW1lbnRcblJvd01hbmFnZXIucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmVsZW1lbnQ7XG59O1xuXG4vL3JldHVybiB0YWJsZSBlbGVtZW50XG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5nZXRUYWJsZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLnRhYmxlRWxlbWVudDtcbn07XG5cbi8vcmV0dXJuIHBvc2l0aW9uIG9mIHJvdyBpbiB0YWJsZVxuUm93TWFuYWdlci5wcm90b3R5cGUuZ2V0Um93UG9zaXRpb24gPSBmdW5jdGlvbiAocm93LCBhY3RpdmUpIHtcblx0aWYgKGFjdGl2ZSkge1xuXHRcdHJldHVybiB0aGlzLmFjdGl2ZVJvd3MuaW5kZXhPZihyb3cpO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiB0aGlzLnJvd3MuaW5kZXhPZihyb3cpO1xuXHR9XG59O1xuXG4vL2xpbmsgdG8gY29sdW1uIG1hbmFnZXJcblJvd01hbmFnZXIucHJvdG90eXBlLnNldENvbHVtbk1hbmFnZXIgPSBmdW5jdGlvbiAobWFuYWdlcikge1xuXHR0aGlzLmNvbHVtbk1hbmFnZXIgPSBtYW5hZ2VyO1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHNlbGYuc2V0UmVuZGVyTW9kZSgpO1xuXG5cdC8vaW5pdGlhbGl6ZSBtYW5hZ2VyXG5cdHNlbGYuZWxlbWVudC5hcHBlbmRDaGlsZChzZWxmLnRhYmxlRWxlbWVudCk7XG5cblx0c2VsZi5maXJzdFJlbmRlciA9IHRydWU7XG5cblx0Ly9zY3JvbGwgaGVhZGVyIGFsb25nIHdpdGggdGFibGUgYm9keVxuXHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGxlZnQgPSBzZWxmLmVsZW1lbnQuc2Nyb2xsTGVmdDtcblxuXHRcdC8vaGFuZGxlIGhvcml6b250YWwgc2Nyb2xsaW5nXG5cdFx0aWYgKHNlbGYuc2Nyb2xsTGVmdCAhPSBsZWZ0KSB7XG5cdFx0XHRzZWxmLmNvbHVtbk1hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblxuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5ncm91cEJ5KSB7XG5cdFx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5ncm91cFJvd3Muc2Nyb2xsSGVhZGVycyhsZWZ0KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNlbGYudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdFx0XHR9XG5cblx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdH1cblxuXHRcdHNlbGYuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cdH0pO1xuXG5cdC8vaGFuZGxlIHZpcnR1YWwgZG9tIHNjcm9sbGluZ1xuXHRpZiAodGhpcy5yZW5kZXJNb2RlID09PSBcInZpcnR1YWxcIikge1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIHRvcCA9IHNlbGYuZWxlbWVudC5zY3JvbGxUb3A7XG5cdFx0XHR2YXIgZGlyID0gc2VsZi5zY3JvbGxUb3AgPiB0b3A7XG5cblx0XHRcdC8vaGFuZGxlIHZlcmljYWwgc2Nyb2xsaW5nXG5cdFx0XHRpZiAoc2VsZi5zY3JvbGxUb3AgIT0gdG9wKSB7XG5cdFx0XHRcdHNlbGYuc2Nyb2xsVG9wID0gdG9wO1xuXHRcdFx0XHRzZWxmLnNjcm9sbFZlcnRpY2FsKGRpcik7XG5cblx0XHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5hamF4UHJvZ3Jlc3NpdmVMb2FkID09IFwic2Nyb2xsXCIpIHtcblx0XHRcdFx0XHRzZWxmLnRhYmxlLm1vZHVsZXMuYWpheC5uZXh0UGFnZShzZWxmLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gc2VsZi5lbGVtZW50LmNsaWVudEhlaWdodCAtIHRvcCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuc2Nyb2xsVmVydGljYWwodG9wKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbGYuc2Nyb2xsVG9wID0gdG9wO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8gUm93IE1hbmlwdWxhdGlvbiAvLy8vLy8vLy8vLy8vLy8vLy9cblxuUm93TWFuYWdlci5wcm90b3R5cGUuZmluZFJvdyA9IGZ1bmN0aW9uIChzdWJqZWN0KSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRpZiAoKHR5cGVvZiBzdWJqZWN0ID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihzdWJqZWN0KSkgPT0gXCJvYmplY3RcIikge1xuXG5cdFx0aWYgKHN1YmplY3QgaW5zdGFuY2VvZiBSb3cpIHtcblx0XHRcdC8vc3ViamVjdCBpcyByb3cgZWxlbWVudFxuXHRcdFx0cmV0dXJuIHN1YmplY3Q7XG5cdFx0fSBlbHNlIGlmIChzdWJqZWN0IGluc3RhbmNlb2YgUm93Q29tcG9uZW50KSB7XG5cdFx0XHQvL3N1YmplY3QgaXMgcHVibGljIHJvdyBjb21wb25lbnRcblx0XHRcdHJldHVybiBzdWJqZWN0Ll9nZXRTZWxmKCkgfHwgZmFsc2U7XG5cdFx0fSBlbHNlIGlmICh0eXBlb2YgSFRNTEVsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgc3ViamVjdCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG5cdFx0XHQvL3N1YmplY3QgaXMgYSBIVE1MIGVsZW1lbnQgb2YgdGhlIHJvd1xuXHRcdFx0dmFyIG1hdGNoID0gc2VsZi5yb3dzLmZpbmQoZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRyZXR1cm4gcm93LmdldEVsZW1lbnQoKSA9PT0gc3ViamVjdDtcblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gbWF0Y2ggfHwgZmFsc2U7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKHR5cGVvZiBzdWJqZWN0ID09IFwidW5kZWZpbmVkXCIgfHwgc3ViamVjdCA9PT0gbnVsbCkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSBlbHNlIHtcblx0XHQvL3N1YmplY3Qgc2hvdWxkIGJlIHRyZWF0ZWQgYXMgdGhlIGluZGV4IG9mIHRoZSByb3dcblx0XHR2YXIgX21hdGNoID0gc2VsZi5yb3dzLmZpbmQoZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0cmV0dXJuIHJvdy5kYXRhW3NlbGYudGFibGUub3B0aW9ucy5pbmRleF0gPT0gc3ViamVjdDtcblx0XHR9KTtcblxuXHRcdHJldHVybiBfbWF0Y2ggfHwgZmFsc2U7XG5cdH1cblxuXHQvL2NhdGNoIGFsbCBmb3IgYW55IG90aGVyIHR5cGUgb2YgaW5wdXRcblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5nZXRSb3dGcm9tRGF0YU9iamVjdCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBtYXRjaCA9IHRoaXMucm93cy5maW5kKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRyZXR1cm4gcm93LmRhdGEgPT09IGRhdGE7XG5cdH0pO1xuXG5cdHJldHVybiBtYXRjaCB8fCBmYWxzZTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldFJvd0Zyb21Qb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgYWN0aXZlKSB7XG5cdGlmIChhY3RpdmUpIHtcblx0XHRyZXR1cm4gdGhpcy5hY3RpdmVSb3dzW3Bvc2l0aW9uXTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gdGhpcy5yb3dzW3Bvc2l0aW9uXTtcblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuc2Nyb2xsVG9Sb3cgPSBmdW5jdGlvbiAocm93LCBwb3NpdGlvbiwgaWZWaXNpYmxlKSB7XG5cdHZhciBfdGhpczExID0gdGhpcztcblxuXHR2YXIgcm93SW5kZXggPSB0aGlzLmdldERpc3BsYXlSb3dzKCkuaW5kZXhPZihyb3cpLFxuXHQgICAgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpLFxuXHQgICAgcm93VG9wLFxuXHQgICAgb2Zmc2V0ID0gMDtcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmIChyb3dJbmRleCA+IC0xKSB7XG5cblx0XHRcdGlmICh0eXBlb2YgcG9zaXRpb24gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0cG9zaXRpb24gPSBfdGhpczExLnRhYmxlLm9wdGlvbnMuc2Nyb2xsVG9Sb3dQb3NpdGlvbjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHR5cGVvZiBpZlZpc2libGUgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0aWZWaXNpYmxlID0gX3RoaXMxMS50YWJsZS5vcHRpb25zLnNjcm9sbFRvUm93SWZWaXNpYmxlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAocG9zaXRpb24gPT09IFwibmVhcmVzdFwiKSB7XG5cdFx0XHRcdHN3aXRjaCAoX3RoaXMxMS5yZW5kZXJNb2RlKSB7XG5cdFx0XHRcdFx0Y2FzZSBcImNsYXNzaWNcIjpcblx0XHRcdFx0XHRcdHJvd1RvcCA9IFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChyb3dFbCkudG9wO1xuXHRcdFx0XHRcdFx0cG9zaXRpb24gPSBNYXRoLmFicyhfdGhpczExLmVsZW1lbnQuc2Nyb2xsVG9wIC0gcm93VG9wKSA+IE1hdGguYWJzKF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3AgKyBfdGhpczExLmVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gcm93VG9wKSA/IFwiYm90dG9tXCIgOiBcInRvcFwiO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSBcInZpcnR1YWxcIjpcblx0XHRcdFx0XHRcdHBvc2l0aW9uID0gTWF0aC5hYnMoX3RoaXMxMS52RG9tVG9wIC0gcm93SW5kZXgpID4gTWF0aC5hYnMoX3RoaXMxMS52RG9tQm90dG9tIC0gcm93SW5kZXgpID8gXCJib3R0b21cIiA6IFwidG9wXCI7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL2NoZWNrIHJvdyB2aXNpYmlsaXR5XG5cdFx0XHRpZiAoIWlmVmlzaWJsZSkge1xuXHRcdFx0XHRpZiAoVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmVsVmlzaWJsZShyb3dFbCkpIHtcblx0XHRcdFx0XHRvZmZzZXQgPSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxPZmZzZXQocm93RWwpLnRvcCAtIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChfdGhpczExLmVsZW1lbnQpLnRvcDtcblxuXHRcdFx0XHRcdGlmIChvZmZzZXQgPiAwICYmIG9mZnNldCA8IF90aGlzMTEuZWxlbWVudC5jbGllbnRIZWlnaHQgLSByb3dFbC5vZmZzZXRIZWlnaHQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9zY3JvbGwgdG8gcm93XG5cdFx0XHRzd2l0Y2ggKF90aGlzMTEucmVuZGVyTW9kZSkge1xuXHRcdFx0XHRjYXNlIFwiY2xhc3NpY1wiOlxuXHRcdFx0XHRcdF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3AgPSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxPZmZzZXQocm93RWwpLnRvcCAtIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChfdGhpczExLmVsZW1lbnQpLnRvcCArIF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3A7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJ2aXJ0dWFsXCI6XG5cdFx0XHRcdFx0X3RoaXMxMS5fdmlydHVhbFJlbmRlckZpbGwocm93SW5kZXgsIHRydWUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2FsaWduIHRvIGNvcnJlY3QgcG9zaXRpb25cblx0XHRcdHN3aXRjaCAocG9zaXRpb24pIHtcblx0XHRcdFx0Y2FzZSBcIm1pZGRsZVwiOlxuXHRcdFx0XHRjYXNlIFwiY2VudGVyXCI6XG5cblx0XHRcdFx0XHRpZiAoX3RoaXMxMS5lbGVtZW50LnNjcm9sbEhlaWdodCAtIF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3AgPT0gX3RoaXMxMS5lbGVtZW50LmNsaWVudEhlaWdodCkge1xuXHRcdFx0XHRcdFx0X3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCA9IF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3AgKyAocm93RWwub2Zmc2V0VG9wIC0gX3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCkgLSAoX3RoaXMxMS5lbGVtZW50LnNjcm9sbEhlaWdodCAtIHJvd0VsLm9mZnNldFRvcCkgLyAyO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRfdGhpczExLmVsZW1lbnQuc2Nyb2xsVG9wID0gX3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCAtIF90aGlzMTEuZWxlbWVudC5jbGllbnRIZWlnaHQgLyAyO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJib3R0b21cIjpcblxuXHRcdFx0XHRcdGlmIChfdGhpczExLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gX3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCA9PSBfdGhpczExLmVsZW1lbnQuY2xpZW50SGVpZ2h0KSB7XG5cdFx0XHRcdFx0XHRfdGhpczExLmVsZW1lbnQuc2Nyb2xsVG9wID0gX3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCAtIChfdGhpczExLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gcm93RWwub2Zmc2V0VG9wKSArIHJvd0VsLm9mZnNldEhlaWdodDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0X3RoaXMxMS5lbGVtZW50LnNjcm9sbFRvcCA9IF90aGlzMTEuZWxlbWVudC5zY3JvbGxUb3AgLSBfdGhpczExLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgcm93RWwub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXNvbHZlKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlNjcm9sbCBFcnJvciAtIFJvdyBub3QgdmlzaWJsZVwiKTtcblx0XHRcdHJlamVjdChcIlNjcm9sbCBFcnJvciAtIFJvdyBub3QgdmlzaWJsZVwiKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vIERhdGEgSGFuZGxpbmcgLy8vLy8vLy8vLy8vLy8vLy8vXG5cblJvd01hbmFnZXIucHJvdG90eXBlLnNldERhdGEgPSBmdW5jdGlvbiAoZGF0YSwgcmVuZGVySW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpIHtcblx0dmFyIF90aGlzMTIgPSB0aGlzO1xuXG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmIChyZW5kZXJJblBvc2l0aW9uICYmIF90aGlzMTIuZ2V0RGlzcGxheVJvd3MoKS5sZW5ndGgpIHtcblx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbikge1xuXHRcdFx0XHRzZWxmLl9zZXREYXRhQWN0dWFsKGRhdGEsIHRydWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X3RoaXMxMi5yZVJlbmRlckluUG9zaXRpb24oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHNlbGYuX3NldERhdGFBY3R1YWwoZGF0YSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoX3RoaXMxMi50YWJsZS5vcHRpb25zLmF1dG9Db2x1bW5zICYmIGNvbHVtbnNDaGFuZ2VkKSB7XG5cdFx0XHRcdF90aGlzMTIudGFibGUuY29sdW1uTWFuYWdlci5nZW5lcmF0ZUNvbHVtbnNGcm9tUm93RGF0YShkYXRhKTtcblx0XHRcdH1cblx0XHRcdF90aGlzMTIucmVzZXRTY3JvbGwoKTtcblxuXHRcdFx0X3RoaXMxMi5fc2V0RGF0YUFjdHVhbChkYXRhKTtcblx0XHR9XG5cblx0XHRyZXNvbHZlKCk7XG5cdH0pO1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuX3NldERhdGFBY3R1YWwgPSBmdW5jdGlvbiAoZGF0YSwgcmVuZGVySW5Qb3NpdGlvbikge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0c2VsZi50YWJsZS5vcHRpb25zLmRhdGFMb2FkaW5nLmNhbGwodGhpcy50YWJsZSwgZGF0YSk7XG5cblx0dGhpcy5fd2lwZUVsZW1lbnRzKCk7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5oaXN0b3J5ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiaGlzdG9yeVwiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5oaXN0b3J5LmNsZWFyKCk7XG5cdH1cblxuXHRpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwic2VsZWN0Um93XCIpKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LmNsZWFyU2VsZWN0aW9uRGF0YSgpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucmVhY3RpdmVEYXRhICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVhY3RpdmVEYXRhXCIsIHRydWUpKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVhY3RpdmVEYXRhLndhdGNoRGF0YShkYXRhKTtcblx0XHR9XG5cblx0XHRkYXRhLmZvckVhY2goZnVuY3Rpb24gKGRlZiwgaSkge1xuXHRcdFx0aWYgKGRlZiAmJiAodHlwZW9mIGRlZiA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZGVmKSkgPT09IFwib2JqZWN0XCIpIHtcblx0XHRcdFx0dmFyIHJvdyA9IG5ldyBSb3coZGVmLCBzZWxmKTtcblx0XHRcdFx0c2VsZi5yb3dzLnB1c2gocm93KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkRhdGEgTG9hZGluZyBXYXJuaW5nIC0gSW52YWxpZCByb3cgZGF0YSBkZXRlY3RlZCBhbmQgaWdub3JlZCwgZXhwZWN0aW5nIG9iamVjdCBidXQgcmVjZWl2ZWQ6XCIsIGRlZik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRzZWxmLnJlZnJlc2hBY3RpdmVEYXRhKGZhbHNlLCBmYWxzZSwgcmVuZGVySW5Qb3NpdGlvbik7XG5cblx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YUxvYWRlZC5jYWxsKHRoaXMudGFibGUsIGRhdGEpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUuZXJyb3IoXCJEYXRhIExvYWRpbmcgRXJyb3IgLSBVbmFibGUgdG8gcHJvY2VzcyBkYXRhIGR1ZSB0byBpbnZhbGlkIGRhdGEgdHlwZSBcXG5FeHBlY3Rpbmc6IGFycmF5IFxcblJlY2VpdmVkOiBcIiwgdHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGRhdGEpLCBcIlxcbkRhdGE6ICAgICBcIiwgZGF0YSk7XG5cdH1cbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLl93aXBlRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRyb3cud2lwZSgpO1xuXHR9KTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLndpcGUoKTtcblx0fVxuXG5cdHRoaXMucm93cyA9IFtdO1xuXHR0aGlzLmFjdGl2ZVJvd3MgPSBbXTtcblx0dGhpcy5hY3RpdmVSb3dzQ291bnQgPSAwO1xuXHR0aGlzLmRpc3BsYXlSb3dzID0gW107XG5cdHRoaXMuZGlzcGxheVJvd3NDb3VudCA9IDA7XG5cblx0dGhpcy5hZGp1c3RUYWJsZVNpemUoKTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmRlbGV0ZVJvdyA9IGZ1bmN0aW9uIChyb3csIGJsb2NrUmVkcmF3KSB7XG5cdHZhciBhbGxJbmRleCA9IHRoaXMucm93cy5pbmRleE9mKHJvdyksXG5cdCAgICBhY3RpdmVJbmRleCA9IHRoaXMuYWN0aXZlUm93cy5pbmRleE9mKHJvdyk7XG5cblx0aWYgKGFjdGl2ZUluZGV4ID4gLTEpIHtcblx0XHR0aGlzLmFjdGl2ZVJvd3Muc3BsaWNlKGFjdGl2ZUluZGV4LCAxKTtcblx0fVxuXG5cdGlmIChhbGxJbmRleCA+IC0xKSB7XG5cdFx0dGhpcy5yb3dzLnNwbGljZShhbGxJbmRleCwgMSk7XG5cdH1cblxuXHR0aGlzLnNldEFjdGl2ZVJvd3ModGhpcy5hY3RpdmVSb3dzKTtcblxuXHR0aGlzLmRpc3BsYXlSb3dJdGVyYXRvcihmdW5jdGlvbiAocm93cykge1xuXHRcdHZhciBkaXNwbGF5SW5kZXggPSByb3dzLmluZGV4T2Yocm93KTtcblxuXHRcdGlmIChkaXNwbGF5SW5kZXggPiAtMSkge1xuXHRcdFx0cm93cy5zcGxpY2UoZGlzcGxheUluZGV4LCAxKTtcblx0XHR9XG5cdH0pO1xuXG5cdGlmICghYmxvY2tSZWRyYXcpIHtcblx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHR9XG5cblx0dGhpcy5yZWdlbmVyYXRlUm93TnVtYmVycygpO1xuXG5cdHRoaXMudGFibGUub3B0aW9ucy5yb3dEZWxldGVkLmNhbGwodGhpcy50YWJsZSwgcm93LmdldENvbXBvbmVudCgpKTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmRhdGFDaGFuZ2VkKSB7XG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLmRhdGFDaGFuZ2VkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5nZXREYXRhKCkpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZ3JvdXBSb3dzXCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmdyb3VwUm93cy51cGRhdGVHcm91cFJvd3ModHJ1ZSk7XG5cdH0gZWxzZSBpZiAodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0dGhpcy5yZWZyZXNoQWN0aXZlRGF0YShmYWxzZSwgZmFsc2UsIHRydWUpO1xuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbiAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBhZ2VcIikpIHtcblx0XHRcdHRoaXMucmVmcmVzaEFjdGl2ZURhdGEoXCJwYWdlXCIpO1xuXHRcdH1cblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuYWRkUm93ID0gZnVuY3Rpb24gKGRhdGEsIHBvcywgaW5kZXgsIGJsb2NrUmVkcmF3KSB7XG5cblx0dmFyIHJvdyA9IHRoaXMuYWRkUm93QWN0dWFsKGRhdGEsIHBvcywgaW5kZXgsIGJsb2NrUmVkcmF3KTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmhpc3RvcnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJoaXN0b3J5XCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmhpc3RvcnkuYWN0aW9uKFwicm93QWRkXCIsIHJvdywgeyBkYXRhOiBkYXRhLCBwb3M6IHBvcywgaW5kZXg6IGluZGV4IH0pO1xuXHR9XG5cblx0cmV0dXJuIHJvdztcbn07XG5cbi8vYWRkIG11bHRpcGxlIHJvd3NcblJvd01hbmFnZXIucHJvdG90eXBlLmFkZFJvd3MgPSBmdW5jdGlvbiAoZGF0YSwgcG9zLCBpbmRleCkge1xuXHR2YXIgX3RoaXMxMyA9IHRoaXM7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgbGVuZ3RoID0gMCxcblx0ICAgIHJvd3MgPSBbXTtcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHBvcyA9IF90aGlzMTMuZmluZEFkZFJvd1Bvcyhwb3MpO1xuXG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGRhdGEpKSB7XG5cdFx0XHRkYXRhID0gW2RhdGFdO1xuXHRcdH1cblxuXHRcdGxlbmd0aCA9IGRhdGEubGVuZ3RoIC0gMTtcblxuXHRcdGlmICh0eXBlb2YgaW5kZXggPT0gXCJ1bmRlZmluZWRcIiAmJiBwb3MgfHwgdHlwZW9mIGluZGV4ICE9PSBcInVuZGVmaW5lZFwiICYmICFwb3MpIHtcblx0XHRcdGRhdGEucmV2ZXJzZSgpO1xuXHRcdH1cblxuXHRcdGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuXHRcdFx0dmFyIHJvdyA9IHNlbGYuYWRkUm93KGl0ZW0sIHBvcywgaW5kZXgsIHRydWUpO1xuXHRcdFx0cm93cy5wdXNoKHJvdyk7XG5cdFx0fSk7XG5cblx0XHRpZiAoX3RoaXMxMy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgX3RoaXMxMy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHRcdF90aGlzMTMudGFibGUubW9kdWxlcy5ncm91cFJvd3MudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoX3RoaXMxMy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24gJiYgX3RoaXMxMy50YWJsZS5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0XHRfdGhpczEzLnJlZnJlc2hBY3RpdmVEYXRhKGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdF90aGlzMTMucmVSZW5kZXJJblBvc2l0aW9uKCk7XG5cdFx0fVxuXG5cdFx0Ly9yZWNhbGMgY29sdW1uIGNhbGN1bGF0aW9ucyBpZiBwcmVzZW50XG5cdFx0aWYgKF90aGlzMTMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRcdF90aGlzMTMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5yZWNhbGMoX3RoaXMxMy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3MpO1xuXHRcdH1cblxuXHRcdF90aGlzMTMucmVnZW5lcmF0ZVJvd051bWJlcnMoKTtcblx0XHRyZXNvbHZlKHJvd3MpO1xuXHR9KTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmZpbmRBZGRSb3dQb3MgPSBmdW5jdGlvbiAocG9zKSB7XG5cdGlmICh0eXBlb2YgcG9zID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0cG9zID0gdGhpcy50YWJsZS5vcHRpb25zLmFkZFJvd1Bvcztcblx0fVxuXG5cdGlmIChwb3MgPT09IFwicG9zXCIpIHtcblx0XHRwb3MgPSB0cnVlO1xuXHR9XG5cblx0aWYgKHBvcyA9PT0gXCJib3R0b21cIikge1xuXHRcdHBvcyA9IGZhbHNlO1xuXHR9XG5cblx0cmV0dXJuIHBvcztcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmFkZFJvd0FjdHVhbCA9IGZ1bmN0aW9uIChkYXRhLCBwb3MsIGluZGV4LCBibG9ja1JlZHJhdykge1xuXHR2YXIgcm93ID0gZGF0YSBpbnN0YW5jZW9mIFJvdyA/IGRhdGEgOiBuZXcgUm93KGRhdGEgfHwge30sIHRoaXMpLFxuXHQgICAgdG9wID0gdGhpcy5maW5kQWRkUm93UG9zKHBvcyksXG5cdCAgICBhbGxJbmRleCA9IC0xLFxuXHQgICAgYWN0aXZlSW5kZXgsXG5cdCAgICBkaXNwUm93cztcblxuXHRpZiAoIWluZGV4ICYmIHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uICYmIHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uQWRkUm93ID09IFwicGFnZVwiKSB7XG5cdFx0ZGlzcFJvd3MgPSB0aGlzLmdldERpc3BsYXlSb3dzKCk7XG5cblx0XHRpZiAodG9wKSB7XG5cdFx0XHRpZiAoZGlzcFJvd3MubGVuZ3RoKSB7XG5cdFx0XHRcdGluZGV4ID0gZGlzcFJvd3NbMF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodGhpcy5hY3RpdmVSb3dzLmxlbmd0aCkge1xuXHRcdFx0XHRcdGluZGV4ID0gdGhpcy5hY3RpdmVSb3dzW3RoaXMuYWN0aXZlUm93cy5sZW5ndGggLSAxXTtcblx0XHRcdFx0XHR0b3AgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoZGlzcFJvd3MubGVuZ3RoKSB7XG5cdFx0XHRcdGluZGV4ID0gZGlzcFJvd3NbZGlzcFJvd3MubGVuZ3RoIC0gMV07XG5cdFx0XHRcdHRvcCA9IGRpc3BSb3dzLmxlbmd0aCA8IHRoaXMudGFibGUubW9kdWxlcy5wYWdlLmdldFBhZ2VTaXplKCkgPyBmYWxzZSA6IHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHR5cGVvZiBpbmRleCAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdGluZGV4ID0gdGhpcy5maW5kUm93KGluZGV4KTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3MuYXNzaWduUm93VG9Hcm91cChyb3cpO1xuXG5cdFx0dmFyIGdyb3VwUm93cyA9IHJvdy5nZXRHcm91cCgpLnJvd3M7XG5cblx0XHRpZiAoZ3JvdXBSb3dzLmxlbmd0aCA+IDEpIHtcblxuXHRcdFx0aWYgKCFpbmRleCB8fCBpbmRleCAmJiBncm91cFJvd3MuaW5kZXhPZihpbmRleCkgPT0gLTEpIHtcblx0XHRcdFx0aWYgKHRvcCkge1xuXHRcdFx0XHRcdGlmIChncm91cFJvd3NbMF0gIT09IHJvdykge1xuXHRcdFx0XHRcdFx0aW5kZXggPSBncm91cFJvd3NbMF07XG5cdFx0XHRcdFx0XHR0aGlzLl9tb3ZlUm93SW5BcnJheShyb3cuZ2V0R3JvdXAoKS5yb3dzLCByb3csIGluZGV4LCAhdG9wKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKGdyb3VwUm93c1tncm91cFJvd3MubGVuZ3RoIC0gMV0gIT09IHJvdykge1xuXHRcdFx0XHRcdFx0aW5kZXggPSBncm91cFJvd3NbZ3JvdXBSb3dzLmxlbmd0aCAtIDFdO1xuXHRcdFx0XHRcdFx0dGhpcy5fbW92ZVJvd0luQXJyYXkocm93LmdldEdyb3VwKCkucm93cywgcm93LCBpbmRleCwgIXRvcCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9tb3ZlUm93SW5BcnJheShyb3cuZ2V0R3JvdXAoKS5yb3dzLCByb3csIGluZGV4LCAhdG9wKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAoaW5kZXgpIHtcblx0XHRhbGxJbmRleCA9IHRoaXMucm93cy5pbmRleE9mKGluZGV4KTtcblx0fVxuXG5cdGlmIChpbmRleCAmJiBhbGxJbmRleCA+IC0xKSB7XG5cdFx0YWN0aXZlSW5kZXggPSB0aGlzLmFjdGl2ZVJvd3MuaW5kZXhPZihpbmRleCk7XG5cblx0XHR0aGlzLmRpc3BsYXlSb3dJdGVyYXRvcihmdW5jdGlvbiAocm93cykge1xuXHRcdFx0dmFyIGRpc3BsYXlJbmRleCA9IHJvd3MuaW5kZXhPZihpbmRleCk7XG5cblx0XHRcdGlmIChkaXNwbGF5SW5kZXggPiAtMSkge1xuXHRcdFx0XHRyb3dzLnNwbGljZSh0b3AgPyBkaXNwbGF5SW5kZXggOiBkaXNwbGF5SW5kZXggKyAxLCAwLCByb3cpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGFjdGl2ZUluZGV4ID4gLTEpIHtcblx0XHRcdHRoaXMuYWN0aXZlUm93cy5zcGxpY2UodG9wID8gYWN0aXZlSW5kZXggOiBhY3RpdmVJbmRleCArIDEsIDAsIHJvdyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5yb3dzLnNwbGljZSh0b3AgPyBhbGxJbmRleCA6IGFsbEluZGV4ICsgMSwgMCwgcm93KTtcblx0fSBlbHNlIHtcblxuXHRcdGlmICh0b3ApIHtcblxuXHRcdFx0dGhpcy5kaXNwbGF5Um93SXRlcmF0b3IoZnVuY3Rpb24gKHJvd3MpIHtcblx0XHRcdFx0cm93cy51bnNoaWZ0KHJvdyk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5hY3RpdmVSb3dzLnVuc2hpZnQocm93KTtcblx0XHRcdHRoaXMucm93cy51bnNoaWZ0KHJvdyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZGlzcGxheVJvd0l0ZXJhdG9yKGZ1bmN0aW9uIChyb3dzKSB7XG5cdFx0XHRcdHJvd3MucHVzaChyb3cpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuYWN0aXZlUm93cy5wdXNoKHJvdyk7XG5cdFx0XHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMuc2V0QWN0aXZlUm93cyh0aGlzLmFjdGl2ZVJvd3MpO1xuXG5cdHRoaXMudGFibGUub3B0aW9ucy5yb3dBZGRlZC5jYWxsKHRoaXMudGFibGUsIHJvdy5nZXRDb21wb25lbnQoKSk7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5kYXRhQ2hhbmdlZCkge1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5kYXRhQ2hhbmdlZC5jYWxsKHRoaXMudGFibGUsIHRoaXMuZ2V0RGF0YSgpKTtcblx0fVxuXG5cdGlmICghYmxvY2tSZWRyYXcpIHtcblx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHR9XG5cblx0cmV0dXJuIHJvdztcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLm1vdmVSb3cgPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGFmdGVyKSB7XG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuaGlzdG9yeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImhpc3RvcnlcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuaGlzdG9yeS5hY3Rpb24oXCJyb3dNb3ZlXCIsIGZyb20sIHsgcG9zRnJvbTogdGhpcy5nZXRSb3dQb3NpdGlvbihmcm9tKSwgcG9zVG86IHRoaXMuZ2V0Um93UG9zaXRpb24odG8pLCB0bzogdG8sIGFmdGVyOiBhZnRlciB9KTtcblx0fVxuXG5cdHRoaXMubW92ZVJvd0FjdHVhbChmcm9tLCB0bywgYWZ0ZXIpO1xuXG5cdHRoaXMucmVnZW5lcmF0ZVJvd051bWJlcnMoKTtcblxuXHR0aGlzLnRhYmxlLm9wdGlvbnMucm93TW92ZWQuY2FsbCh0aGlzLnRhYmxlLCBmcm9tLmdldENvbXBvbmVudCgpKTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLm1vdmVSb3dBY3R1YWwgPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGFmdGVyKSB7XG5cdHZhciBfdGhpczE0ID0gdGhpcztcblxuXHR0aGlzLl9tb3ZlUm93SW5BcnJheSh0aGlzLnJvd3MsIGZyb20sIHRvLCBhZnRlcik7XG5cdHRoaXMuX21vdmVSb3dJbkFycmF5KHRoaXMuYWN0aXZlUm93cywgZnJvbSwgdG8sIGFmdGVyKTtcblxuXHR0aGlzLmRpc3BsYXlSb3dJdGVyYXRvcihmdW5jdGlvbiAocm93cykge1xuXHRcdF90aGlzMTQuX21vdmVSb3dJbkFycmF5KHJvd3MsIGZyb20sIHRvLCBhZnRlcik7XG5cdH0pO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXG5cdFx0aWYgKCFhZnRlciAmJiB0byBpbnN0YW5jZW9mIEdyb3VwKSB7XG5cdFx0XHR0byA9IHRoaXMudGFibGUucm93TWFuYWdlci5wcmV2RGlzcGxheVJvdyhmcm9tKSB8fCB0bztcblx0XHR9XG5cblx0XHR2YXIgdG9Hcm91cCA9IHRvLmdldEdyb3VwKCk7XG5cdFx0dmFyIGZyb21Hcm91cCA9IGZyb20uZ2V0R3JvdXAoKTtcblxuXHRcdGlmICh0b0dyb3VwID09PSBmcm9tR3JvdXApIHtcblx0XHRcdHRoaXMuX21vdmVSb3dJbkFycmF5KHRvR3JvdXAucm93cywgZnJvbSwgdG8sIGFmdGVyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKGZyb21Hcm91cCkge1xuXHRcdFx0XHRmcm9tR3JvdXAucmVtb3ZlUm93KGZyb20pO1xuXHRcdFx0fVxuXG5cdFx0XHR0b0dyb3VwLmluc2VydFJvdyhmcm9tLCB0bywgYWZ0ZXIpO1xuXHRcdH1cblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuX21vdmVSb3dJbkFycmF5ID0gZnVuY3Rpb24gKHJvd3MsIGZyb20sIHRvLCBhZnRlcikge1xuXHR2YXIgZnJvbUluZGV4LCB0b0luZGV4LCBzdGFydCwgZW5kO1xuXG5cdGlmIChmcm9tICE9PSB0bykge1xuXG5cdFx0ZnJvbUluZGV4ID0gcm93cy5pbmRleE9mKGZyb20pO1xuXG5cdFx0aWYgKGZyb21JbmRleCA+IC0xKSB7XG5cblx0XHRcdHJvd3Muc3BsaWNlKGZyb21JbmRleCwgMSk7XG5cblx0XHRcdHRvSW5kZXggPSByb3dzLmluZGV4T2YodG8pO1xuXG5cdFx0XHRpZiAodG9JbmRleCA+IC0xKSB7XG5cblx0XHRcdFx0aWYgKGFmdGVyKSB7XG5cdFx0XHRcdFx0cm93cy5zcGxpY2UodG9JbmRleCArIDEsIDAsIGZyb20pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJvd3Muc3BsaWNlKHRvSW5kZXgsIDAsIGZyb20pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyb3dzLnNwbGljZShmcm9tSW5kZXgsIDAsIGZyb20pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vcmVzdHlsZSByb3dzXG5cdFx0aWYgKHJvd3MgPT09IHRoaXMuZ2V0RGlzcGxheVJvd3MoKSkge1xuXG5cdFx0XHRzdGFydCA9IGZyb21JbmRleCA8IHRvSW5kZXggPyBmcm9tSW5kZXggOiB0b0luZGV4O1xuXHRcdFx0ZW5kID0gdG9JbmRleCA+IGZyb21JbmRleCA/IHRvSW5kZXggOiBmcm9tSW5kZXggKyAxO1xuXG5cdFx0XHRmb3IgKHZhciBfaTQgPSBzdGFydDsgX2k0IDw9IGVuZDsgX2k0KyspIHtcblx0XHRcdFx0aWYgKHJvd3NbX2k0XSkge1xuXHRcdFx0XHRcdHRoaXMuc3R5bGVSb3cocm93c1tfaTRdLCBfaTQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5jbGVhckRhdGEgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuc2V0RGF0YShbXSk7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5nZXRSb3dJbmRleCA9IGZ1bmN0aW9uIChyb3cpIHtcblx0cmV0dXJuIHRoaXMuZmluZFJvd0luZGV4KHJvdywgdGhpcy5yb3dzKTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldERpc3BsYXlSb3dJbmRleCA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGluZGV4ID0gdGhpcy5nZXREaXNwbGF5Um93cygpLmluZGV4T2Yocm93KTtcblx0cmV0dXJuIGluZGV4ID4gLTEgPyBpbmRleCA6IGZhbHNlO1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUubmV4dERpc3BsYXlSb3cgPSBmdW5jdGlvbiAocm93LCByb3dPbmx5KSB7XG5cdHZhciBpbmRleCA9IHRoaXMuZ2V0RGlzcGxheVJvd0luZGV4KHJvdyksXG5cdCAgICBuZXh0Um93ID0gZmFsc2U7XG5cblx0aWYgKGluZGV4ICE9PSBmYWxzZSAmJiBpbmRleCA8IHRoaXMuZGlzcGxheVJvd3NDb3VudCAtIDEpIHtcblx0XHRuZXh0Um93ID0gdGhpcy5nZXREaXNwbGF5Um93cygpW2luZGV4ICsgMV07XG5cdH1cblxuXHRpZiAobmV4dFJvdyAmJiAoIShuZXh0Um93IGluc3RhbmNlb2YgUm93KSB8fCBuZXh0Um93LnR5cGUgIT0gXCJyb3dcIikpIHtcblx0XHRyZXR1cm4gdGhpcy5uZXh0RGlzcGxheVJvdyhuZXh0Um93LCByb3dPbmx5KTtcblx0fVxuXG5cdHJldHVybiBuZXh0Um93O1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUucHJldkRpc3BsYXlSb3cgPSBmdW5jdGlvbiAocm93LCByb3dPbmx5KSB7XG5cdHZhciBpbmRleCA9IHRoaXMuZ2V0RGlzcGxheVJvd0luZGV4KHJvdyksXG5cdCAgICBwcmV2Um93ID0gZmFsc2U7XG5cblx0aWYgKGluZGV4KSB7XG5cdFx0cHJldlJvdyA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKVtpbmRleCAtIDFdO1xuXHR9XG5cblx0aWYgKHJvd09ubHkgJiYgcHJldlJvdyAmJiAoIShwcmV2Um93IGluc3RhbmNlb2YgUm93KSB8fCBwcmV2Um93LnR5cGUgIT0gXCJyb3dcIikpIHtcblx0XHRyZXR1cm4gdGhpcy5wcmV2RGlzcGxheVJvdyhwcmV2Um93LCByb3dPbmx5KTtcblx0fVxuXG5cdHJldHVybiBwcmV2Um93O1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuZmluZFJvd0luZGV4ID0gZnVuY3Rpb24gKHJvdywgbGlzdCkge1xuXHR2YXIgcm93SW5kZXg7XG5cblx0cm93ID0gdGhpcy5maW5kUm93KHJvdyk7XG5cblx0aWYgKHJvdykge1xuXHRcdHJvd0luZGV4ID0gbGlzdC5pbmRleE9mKHJvdyk7XG5cblx0XHRpZiAocm93SW5kZXggPiAtMSkge1xuXHRcdFx0cmV0dXJuIHJvd0luZGV4O1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbiAoYWN0aXZlLCB0cmFuc2Zvcm0pIHtcblx0dmFyIG91dHB1dCA9IFtdLFxuXHQgICAgcm93cyA9IHRoaXMuZ2V0Um93cyhhY3RpdmUpO1xuXG5cdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0aWYgKHJvdy50eXBlID09IFwicm93XCIpIHtcblx0XHRcdG91dHB1dC5wdXNoKHJvdy5nZXREYXRhKHRyYW5zZm9ybSB8fCBcImRhdGFcIikpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldENvbXBvbmVudHMgPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG5cdHZhciBvdXRwdXQgPSBbXSxcblx0ICAgIHJvd3MgPSB0aGlzLmdldFJvd3MoYWN0aXZlKTtcblxuXHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdG91dHB1dC5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5nZXREYXRhQ291bnQgPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG5cdHZhciByb3dzID0gdGhpcy5nZXRSb3dzKGFjdGl2ZSk7XG5cblx0cmV0dXJuIHJvd3MubGVuZ3RoO1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuX2dlblJlbW90ZVJlcXVlc3QgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczE1ID0gdGhpcztcblxuXHR2YXIgdGFibGUgPSB0aGlzLnRhYmxlLFxuXHQgICAgb3B0aW9ucyA9IHRhYmxlLm9wdGlvbnMsXG5cdCAgICBwYXJhbXMgPSB7fTtcblxuXHRpZiAodGFibGUubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdC8vc2V0IHNvcnQgZGF0YSBpZiBkZWZpbmVkXG5cdFx0aWYgKG9wdGlvbnMuYWpheFNvcnRpbmcpIHtcblx0XHRcdHZhciBzb3J0ZXJzID0gdGhpcy50YWJsZS5tb2R1bGVzLnNvcnQuZ2V0U29ydCgpO1xuXG5cdFx0XHRzb3J0ZXJzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0ZGVsZXRlIGl0ZW0uY29sdW1uO1xuXHRcdFx0fSk7XG5cblx0XHRcdHBhcmFtc1t0aGlzLnRhYmxlLm1vZHVsZXMucGFnZS5wYWdpbmF0aW9uRGF0YVNlbnROYW1lcy5zb3J0ZXJzXSA9IHNvcnRlcnM7XG5cdFx0fVxuXG5cdFx0Ly9zZXQgZmlsdGVyIGRhdGEgaWYgZGVmaW5lZFxuXHRcdGlmIChvcHRpb25zLmFqYXhGaWx0ZXJpbmcpIHtcblx0XHRcdHZhciBmaWx0ZXJzID0gdGhpcy50YWJsZS5tb2R1bGVzLmZpbHRlci5nZXRGaWx0ZXJzKHRydWUsIHRydWUpO1xuXG5cdFx0XHRwYXJhbXNbdGhpcy50YWJsZS5tb2R1bGVzLnBhZ2UucGFnaW5hdGlvbkRhdGFTZW50TmFtZXMuZmlsdGVyc10gPSBmaWx0ZXJzO1xuXHRcdH1cblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5hamF4LnNldFBhcmFtcyhwYXJhbXMsIHRydWUpO1xuXHR9XG5cblx0dGFibGUubW9kdWxlcy5hamF4LnNlbmRSZXF1ZXN0KCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXHRcdF90aGlzMTUuX3NldERhdGFBY3R1YWwoZGF0YSwgdHJ1ZSk7XG5cdH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7fSk7XG59O1xuXG4vL2Nob29zZSB0aGUgcGF0aCB0byByZWZyZXNoIGRhdGEgYWZ0ZXIgYSBmaWx0ZXIgdXBkYXRlXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5maWx0ZXJSZWZyZXNoID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgdGFibGUgPSB0aGlzLnRhYmxlLFxuXHQgICAgb3B0aW9ucyA9IHRhYmxlLm9wdGlvbnMsXG5cdCAgICBsZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xuXG5cdGlmIChvcHRpb25zLmFqYXhGaWx0ZXJpbmcpIHtcblx0XHRpZiAob3B0aW9ucy5wYWdpbmF0aW9uID09IFwicmVtb3RlXCIgJiYgdGFibGUubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdFx0dGFibGUubW9kdWxlcy5wYWdlLnJlc2V0KHRydWUpO1xuXHRcdFx0dGFibGUubW9kdWxlcy5wYWdlLnNldFBhZ2UoMSkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge30pO1xuXHRcdH0gZWxzZSBpZiAob3B0aW9ucy5hamF4UHJvZ3Jlc3NpdmVMb2FkKSB7XG5cdFx0XHR0YWJsZS5tb2R1bGVzLmFqYXgubG9hZERhdGEoKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vYXNzdW1lIGRhdGEgaXMgdXJsLCBtYWtlIGFqYXggY2FsbCB0byB1cmwgdG8gZ2V0IGRhdGFcblx0XHRcdHRoaXMuX2dlblJlbW90ZVJlcXVlc3QoKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZWZyZXNoQWN0aXZlRGF0YShcImZpbHRlclwiKTtcblx0fVxuXG5cdHRoaXMuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcbn07XG5cbi8vY2hvb3NlIHRoZSBwYXRoIHRvIHJlZnJlc2ggZGF0YSBhZnRlciBhIHNvcnRlciB1cGRhdGVcblJvd01hbmFnZXIucHJvdG90eXBlLnNvcnRlclJlZnJlc2ggPSBmdW5jdGlvbiAobG9hZE9yaWduYWxEYXRhKSB7XG5cdHZhciB0YWJsZSA9IHRoaXMudGFibGUsXG5cdCAgICBvcHRpb25zID0gdGhpcy50YWJsZS5vcHRpb25zLFxuXHQgICAgbGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcblxuXHRpZiAob3B0aW9ucy5hamF4U29ydGluZykge1xuXHRcdGlmICgob3B0aW9ucy5wYWdpbmF0aW9uID09IFwicmVtb3RlXCIgfHwgb3B0aW9ucy5wcm9ncmVzc2l2ZUxvYWQpICYmIHRhYmxlLm1vZEV4aXN0cyhcInBhZ2VcIikpIHtcblx0XHRcdHRhYmxlLm1vZHVsZXMucGFnZS5yZXNldCh0cnVlKTtcblx0XHRcdHRhYmxlLm1vZHVsZXMucGFnZS5zZXRQYWdlKDEpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTtcblx0XHR9IGVsc2UgaWYgKG9wdGlvbnMuYWpheFByb2dyZXNzaXZlTG9hZCkge1xuXHRcdFx0dGFibGUubW9kdWxlcy5hamF4LmxvYWREYXRhKCkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge30pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL2Fzc3VtZSBkYXRhIGlzIHVybCwgbWFrZSBhamF4IGNhbGwgdG8gdXJsIHRvIGdldCBkYXRhXG5cdFx0XHR0aGlzLl9nZW5SZW1vdGVSZXF1ZXN0KCk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMucmVmcmVzaEFjdGl2ZURhdGEobG9hZE9yaWduYWxEYXRhID8gXCJmaWx0ZXJcIiA6IFwic29ydFwiKTtcblx0fVxuXG5cdHRoaXMuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLnNjcm9sbEhvcml6b250YWwgPSBmdW5jdGlvbiAobGVmdCkge1xuXHR0aGlzLnNjcm9sbExlZnQgPSBsZWZ0O1xuXHR0aGlzLmVsZW1lbnQuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5KSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmdyb3VwUm93cy5zY3JvbGxIZWFkZXJzKGxlZnQpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3Muc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblx0fVxufTtcblxuLy9zZXQgYWN0aXZlIGRhdGEgc2V0XG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5yZWZyZXNoQWN0aXZlRGF0YSA9IGZ1bmN0aW9uIChzdGFnZSwgc2tpcFN0YWdlLCByZW5kZXJJblBvc2l0aW9uKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHRhYmxlID0gdGhpcy50YWJsZSxcblx0ICAgIGNhc2NhZGVPcmRlciA9IFtcImFsbFwiLCBcImZpbHRlclwiLCBcInNvcnRcIiwgXCJkaXNwbGF5XCIsIFwiZnJlZXplXCIsIFwiZ3JvdXBcIiwgXCJ0cmVlXCIsIFwicGFnZVwiXSxcblx0ICAgIGRpc3BsYXlJbmRleDtcblxuXHRpZiAodGhpcy5yZWRyYXdCbG9jaykge1xuXG5cdFx0aWYgKCF0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyB8fCBjYXNjYWRlT3JkZXIuaW5kZXhPZihzdGFnZSkgPCBjYXNjYWRlT3JkZXIuaW5kZXhPZih0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZy5zdGFnZSkpIHtcblx0XHRcdHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnID0ge1xuXHRcdFx0XHRzdGFnZTogc3RhZ2UsXG5cdFx0XHRcdHNraXBTdGFnZTogc2tpcFN0YWdlLFxuXHRcdFx0XHRyZW5kZXJJblBvc2l0aW9uOiByZW5kZXJJblBvc2l0aW9uXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdHJldHVybjtcblx0fSBlbHNlIHtcblxuXHRcdGlmIChzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikpIHtcblx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5lZGl0LmNhbmNlbEVkaXQoKTtcblx0XHR9XG5cblx0XHRpZiAoIXN0YWdlKSB7XG5cdFx0XHRzdGFnZSA9IFwiYWxsXCI7XG5cdFx0fVxuXG5cdFx0aWYgKHRhYmxlLm9wdGlvbnMuc2VsZWN0YWJsZSAmJiAhdGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUGVyc2lzdGVuY2UgJiYgdGFibGUubW9kRXhpc3RzKFwic2VsZWN0Um93XCIpKSB7XG5cdFx0XHR0YWJsZS5tb2R1bGVzLnNlbGVjdFJvdy5kZXNlbGVjdFJvd3MoKTtcblx0XHR9XG5cblx0XHQvL2Nhc2NhZGUgdGhyb3VnaCBkYXRhIHJlZnJlc2ggc3RhZ2VzXG5cdFx0c3dpdGNoIChzdGFnZSkge1xuXHRcdFx0Y2FzZSBcImFsbFwiOlxuXG5cdFx0XHRjYXNlIFwiZmlsdGVyXCI6XG5cdFx0XHRcdGlmICghc2tpcFN0YWdlKSB7XG5cdFx0XHRcdFx0aWYgKHRhYmxlLm1vZEV4aXN0cyhcImZpbHRlclwiKSkge1xuXHRcdFx0XHRcdFx0c2VsZi5zZXRBY3RpdmVSb3dzKHRhYmxlLm1vZHVsZXMuZmlsdGVyLmZpbHRlcihzZWxmLnJvd3MpKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0c2VsZi5zZXRBY3RpdmVSb3dzKHNlbGYucm93cy5zbGljZSgwKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNraXBTdGFnZSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdGNhc2UgXCJzb3J0XCI6XG5cdFx0XHRcdGlmICghc2tpcFN0YWdlKSB7XG5cdFx0XHRcdFx0aWYgKHRhYmxlLm1vZEV4aXN0cyhcInNvcnRcIikpIHtcblx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMuc29ydC5zb3J0KHRoaXMuYWN0aXZlUm93cyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNraXBTdGFnZSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9yZWdlbmVyYXRlIHJvdyBudW1iZXJzIGZvciByb3cgbnVtYmVyIGZvcm1hdHRlciBpZiBpbiB1c2Vcblx0XHRcdFx0dGhpcy5yZWdlbmVyYXRlUm93TnVtYmVycygpO1xuXG5cdFx0XHQvL2dlbmVyaWMgc3RhZ2UgdG8gYWxsb3cgZm9yIHBpcGVsaW5lIHRyaWdnZXIgYWZ0ZXIgdGhlIGRhdGEgbWFuaXB1bGF0aW9uIHN0YWdlXG5cdFx0XHRjYXNlIFwiZGlzcGxheVwiOlxuXHRcdFx0XHR0aGlzLnJlc2V0RGlzcGxheVJvd3MoKTtcblxuXHRcdFx0Y2FzZSBcImZyZWV6ZVwiOlxuXHRcdFx0XHRpZiAoIXNraXBTdGFnZSkge1xuXHRcdFx0XHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZyb3plblJvd3NcIikpIHtcblx0XHRcdFx0XHRcdGlmICh0YWJsZS5tb2R1bGVzLmZyb3plblJvd3MuaXNGcm96ZW4oKSkge1xuXHRcdFx0XHRcdFx0XHRpZiAoIXRhYmxlLm1vZHVsZXMuZnJvemVuUm93cy5nZXREaXNwbGF5SW5kZXgoKSkge1xuXHRcdFx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMuZnJvemVuUm93cy5zZXREaXNwbGF5SW5kZXgodGhpcy5nZXROZXh0RGlzcGxheUluZGV4KCkpO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0ZGlzcGxheUluZGV4ID0gdGFibGUubW9kdWxlcy5mcm96ZW5Sb3dzLmdldERpc3BsYXlJbmRleCgpO1xuXG5cdFx0XHRcdFx0XHRcdGRpc3BsYXlJbmRleCA9IHNlbGYuc2V0RGlzcGxheVJvd3ModGFibGUubW9kdWxlcy5mcm96ZW5Sb3dzLmdldFJvd3ModGhpcy5nZXREaXNwbGF5Um93cyhkaXNwbGF5SW5kZXggLSAxKSksIGRpc3BsYXlJbmRleCk7XG5cblx0XHRcdFx0XHRcdFx0aWYgKGRpc3BsYXlJbmRleCAhPT0gdHJ1ZSkge1xuXHRcdFx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMuZnJvemVuUm93cy5zZXREaXNwbGF5SW5kZXgoZGlzcGxheUluZGV4KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRza2lwU3RhZ2UgPSBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0aWYgKCFza2lwU3RhZ2UpIHtcblx0XHRcdFx0XHRpZiAodGFibGUub3B0aW9ucy5ncm91cEJ5ICYmIHRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXG5cdFx0XHRcdFx0XHRpZiAoIXRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldERpc3BsYXlJbmRleCgpKSB7XG5cdFx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLnNldERpc3BsYXlJbmRleCh0aGlzLmdldE5leHREaXNwbGF5SW5kZXgoKSk7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGRpc3BsYXlJbmRleCA9IHRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldERpc3BsYXlJbmRleCgpO1xuXG5cdFx0XHRcdFx0XHRkaXNwbGF5SW5kZXggPSBzZWxmLnNldERpc3BsYXlSb3dzKHRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldFJvd3ModGhpcy5nZXREaXNwbGF5Um93cyhkaXNwbGF5SW5kZXggLSAxKSksIGRpc3BsYXlJbmRleCk7XG5cblx0XHRcdFx0XHRcdGlmIChkaXNwbGF5SW5kZXggIT09IHRydWUpIHtcblx0XHRcdFx0XHRcdFx0dGFibGUubW9kdWxlcy5ncm91cFJvd3Muc2V0RGlzcGxheUluZGV4KGRpc3BsYXlJbmRleCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNraXBTdGFnZSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdGNhc2UgXCJ0cmVlXCI6XG5cblx0XHRcdFx0aWYgKCFza2lwU3RhZ2UpIHtcblx0XHRcdFx0XHRpZiAodGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiB0YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiKSkge1xuXHRcdFx0XHRcdFx0aWYgKCF0YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmdldERpc3BsYXlJbmRleCgpKSB7XG5cdFx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuc2V0RGlzcGxheUluZGV4KHRoaXMuZ2V0TmV4dERpc3BsYXlJbmRleCgpKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZGlzcGxheUluZGV4ID0gdGFibGUubW9kdWxlcy5kYXRhVHJlZS5nZXREaXNwbGF5SW5kZXgoKTtcblxuXHRcdFx0XHRcdFx0ZGlzcGxheUluZGV4ID0gc2VsZi5zZXREaXNwbGF5Um93cyh0YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmdldFJvd3ModGhpcy5nZXREaXNwbGF5Um93cyhkaXNwbGF5SW5kZXggLSAxKSksIGRpc3BsYXlJbmRleCk7XG5cblx0XHRcdFx0XHRcdGlmIChkaXNwbGF5SW5kZXggIT09IHRydWUpIHtcblx0XHRcdFx0XHRcdFx0dGFibGUubW9kdWxlcy5kYXRhVHJlZS5zZXREaXNwbGF5SW5kZXgoZGlzcGxheUluZGV4KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2tpcFN0YWdlID0gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGFibGUub3B0aW9ucy5wYWdpbmF0aW9uICYmIHRhYmxlLm1vZEV4aXN0cyhcInBhZ2VcIikgJiYgIXJlbmRlckluUG9zaXRpb24pIHtcblx0XHRcdFx0XHRpZiAodGFibGUubW9kdWxlcy5wYWdlLmdldE1vZGUoKSA9PSBcImxvY2FsXCIpIHtcblx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMucGFnZS5yZXNldCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRjYXNlIFwicGFnZVwiOlxuXHRcdFx0XHRpZiAoIXNraXBTdGFnZSkge1xuXHRcdFx0XHRcdGlmICh0YWJsZS5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGFibGUubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXG5cdFx0XHRcdFx0XHRpZiAoIXRhYmxlLm1vZHVsZXMucGFnZS5nZXREaXNwbGF5SW5kZXgoKSkge1xuXHRcdFx0XHRcdFx0XHR0YWJsZS5tb2R1bGVzLnBhZ2Uuc2V0RGlzcGxheUluZGV4KHRoaXMuZ2V0TmV4dERpc3BsYXlJbmRleCgpKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZGlzcGxheUluZGV4ID0gdGFibGUubW9kdWxlcy5wYWdlLmdldERpc3BsYXlJbmRleCgpO1xuXG5cdFx0XHRcdFx0XHRpZiAodGFibGUubW9kdWxlcy5wYWdlLmdldE1vZGUoKSA9PSBcImxvY2FsXCIpIHtcblx0XHRcdFx0XHRcdFx0dGFibGUubW9kdWxlcy5wYWdlLnNldE1heFJvd3ModGhpcy5nZXREaXNwbGF5Um93cyhkaXNwbGF5SW5kZXggLSAxKS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRkaXNwbGF5SW5kZXggPSBzZWxmLnNldERpc3BsYXlSb3dzKHRhYmxlLm1vZHVsZXMucGFnZS5nZXRSb3dzKHRoaXMuZ2V0RGlzcGxheVJvd3MoZGlzcGxheUluZGV4IC0gMSkpLCBkaXNwbGF5SW5kZXgpO1xuXG5cdFx0XHRcdFx0XHRpZiAoZGlzcGxheUluZGV4ICE9PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdHRhYmxlLm1vZHVsZXMucGFnZS5zZXREaXNwbGF5SW5kZXgoZGlzcGxheUluZGV4KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2tpcFN0YWdlID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmVsVmlzaWJsZShzZWxmLmVsZW1lbnQpKSB7XG5cdFx0XHRpZiAocmVuZGVySW5Qb3NpdGlvbikge1xuXHRcdFx0XHRzZWxmLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRpZiAoc3RhZ2UgPT09IFwiYWxsXCIgJiYgdGhpcy50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLnZkb21Ib3ouZGF0YUNoYW5nZSgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2VsZi5yZW5kZXJUYWJsZSgpO1xuXG5cdFx0XHRcdGlmICh0YWJsZS5vcHRpb25zLmxheW91dENvbHVtbnNPbk5ld0RhdGEpIHtcblx0XHRcdFx0XHRzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIucmVkcmF3KHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cdFx0XHR0YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsYyh0aGlzLmFjdGl2ZVJvd3MpO1xuXHRcdH1cblx0fVxufTtcblxuLy9yZWdlbmVyYXRlIHJvdyBudW1iZXJzIGZvciByb3cgbnVtYmVyIGZvcm1hdHRlciBpZiBpbiB1c2VcblJvd01hbmFnZXIucHJvdG90eXBlLnJlZ2VuZXJhdGVSb3dOdW1iZXJzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXMxNiA9IHRoaXM7XG5cblx0aWYgKHRoaXMucm93TnVtQ29sdW1uKSB7XG5cdFx0dGhpcy5hY3RpdmVSb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChfdGhpczE2LnJvd051bUNvbHVtbik7XG5cblx0XHRcdGlmIChjZWxsKSB7XG5cdFx0XHRcdGNlbGwuX2dlbmVyYXRlQ29udGVudHMoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuc2V0QWN0aXZlUm93cyA9IGZ1bmN0aW9uIChhY3RpdmVSb3dzKSB7XG5cdHRoaXMuYWN0aXZlUm93cyA9IGFjdGl2ZVJvd3M7XG5cdHRoaXMuYWN0aXZlUm93c0NvdW50ID0gdGhpcy5hY3RpdmVSb3dzLmxlbmd0aDtcbn07XG5cbi8vcmVzZXQgZGlzcGxheSByb3dzIGFycmF5XG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5yZXNldERpc3BsYXlSb3dzID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmRpc3BsYXlSb3dzID0gW107XG5cblx0dGhpcy5kaXNwbGF5Um93cy5wdXNoKHRoaXMuYWN0aXZlUm93cy5zbGljZSgwKSk7XG5cblx0dGhpcy5kaXNwbGF5Um93c0NvdW50ID0gdGhpcy5kaXNwbGF5Um93c1swXS5sZW5ndGg7XG5cblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZnJvemVuUm93c1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Sb3dzLnNldERpc3BsYXlJbmRleCgwKTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3Muc2V0RGlzcGxheUluZGV4KDApO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5wYWdlLnNldERpc3BsYXlJbmRleCgwKTtcblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuZ2V0TmV4dERpc3BsYXlJbmRleCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuZGlzcGxheVJvd3MubGVuZ3RoO1xufTtcblxuLy9zZXQgZGlzcGxheSByb3cgcGlwZWxpbmUgZGF0YVxuUm93TWFuYWdlci5wcm90b3R5cGUuc2V0RGlzcGxheVJvd3MgPSBmdW5jdGlvbiAoZGlzcGxheVJvd3MsIGluZGV4KSB7XG5cblx0dmFyIG91dHB1dCA9IHRydWU7XG5cblx0aWYgKGluZGV4ICYmIHR5cGVvZiB0aGlzLmRpc3BsYXlSb3dzW2luZGV4XSAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0dGhpcy5kaXNwbGF5Um93c1tpbmRleF0gPSBkaXNwbGF5Um93cztcblx0XHRvdXRwdXQgPSB0cnVlO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuZGlzcGxheVJvd3MucHVzaChkaXNwbGF5Um93cyk7XG5cdFx0b3V0cHV0ID0gaW5kZXggPSB0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtIDE7XG5cdH1cblxuXHRpZiAoaW5kZXggPT0gdGhpcy5kaXNwbGF5Um93cy5sZW5ndGggLSAxKSB7XG5cdFx0dGhpcy5kaXNwbGF5Um93c0NvdW50ID0gdGhpcy5kaXNwbGF5Um93c1t0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtIDFdLmxlbmd0aDtcblx0fVxuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5nZXREaXNwbGF5Um93cyA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHRpZiAodHlwZW9mIGluZGV4ID09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRyZXR1cm4gdGhpcy5kaXNwbGF5Um93cy5sZW5ndGggPyB0aGlzLmRpc3BsYXlSb3dzW3RoaXMuZGlzcGxheVJvd3MubGVuZ3RoIC0gMV0gOiBbXTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gdGhpcy5kaXNwbGF5Um93c1tpbmRleF0gfHwgW107XG5cdH1cbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldFZpc2libGVSb3dzID0gZnVuY3Rpb24gKHZpZXdhYmxlKSB7XG5cdHZhciB0b3BFZGdlID0gdGhpcy5lbGVtZW50LnNjcm9sbFRvcCxcblx0ICAgIGJvdHRvbUVkZ2UgPSB0aGlzLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgdG9wRWRnZSxcblx0ICAgIHRvcEZvdW5kID0gZmFsc2UsXG5cdCAgICB0b3BSb3cgPSAwLFxuXHQgICAgYm90dG9tUm93ID0gMCxcblx0ICAgIHJvd3MgPSB0aGlzLmdldERpc3BsYXlSb3dzKCk7XG5cblx0aWYgKHZpZXdhYmxlKSB7XG5cblx0XHR0aGlzLmdldERpc3BsYXlSb3dzKCk7XG5cdFx0Zm9yICh2YXIgaSA9IHRoaXMudkRvbVRvcDsgaSA8PSB0aGlzLnZEb21Cb3R0b207IGkrKykge1xuXHRcdFx0aWYgKHJvd3NbaV0pIHtcblx0XHRcdFx0aWYgKCF0b3BGb3VuZCkge1xuXHRcdFx0XHRcdGlmICh0b3BFZGdlIC0gcm93c1tpXS5nZXRFbGVtZW50KCkub2Zmc2V0VG9wID49IDApIHtcblx0XHRcdFx0XHRcdHRvcFJvdyA9IGk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRvcEZvdW5kID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0aWYgKGJvdHRvbUVkZ2UgLSByb3dzW2ldLmdldEVsZW1lbnQoKS5vZmZzZXRUb3AgPj0gMCkge1xuXHRcdFx0XHRcdFx0XHRib3R0b21Sb3cgPSBpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChib3R0b21FZGdlIC0gcm93c1tpXS5nZXRFbGVtZW50KCkub2Zmc2V0VG9wID49IDApIHtcblx0XHRcdFx0XHRcdGJvdHRvbVJvdyA9IGk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHR0b3BSb3cgPSB0aGlzLnZEb21Ub3A7XG5cdFx0Ym90dG9tUm93ID0gdGhpcy52RG9tQm90dG9tO1xuXHR9XG5cblx0cmV0dXJuIHJvd3Muc2xpY2UodG9wUm93LCBib3R0b21Sb3cgKyAxKTtcbn07XG5cbi8vcmVwZWF0IGFjdGlvbiBhY2Nyb3NzIGRpc3BsYXkgcm93c1xuUm93TWFuYWdlci5wcm90b3R5cGUuZGlzcGxheVJvd0l0ZXJhdG9yID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdHRoaXMuZGlzcGxheVJvd3MuZm9yRWFjaChjYWxsYmFjayk7XG5cblx0dGhpcy5kaXNwbGF5Um93c0NvdW50ID0gdGhpcy5kaXNwbGF5Um93c1t0aGlzLmRpc3BsYXlSb3dzLmxlbmd0aCAtIDFdLmxlbmd0aDtcbn07XG5cbi8vcmV0dXJuIG9ubHkgYWN0dWFsIHJvd3MgKG5vdCBncm91cCBoZWFkZXJzIGV0YylcblJvd01hbmFnZXIucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbiAoYWN0aXZlKSB7XG5cdHZhciByb3dzO1xuXG5cdHN3aXRjaCAoYWN0aXZlKSB7XG5cdFx0Y2FzZSBcImFjdGl2ZVwiOlxuXHRcdFx0cm93cyA9IHRoaXMuYWN0aXZlUm93cztcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcImRpc3BsYXlcIjpcblx0XHRcdHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcInZpc2libGVcIjpcblx0XHRcdHJvd3MgPSB0aGlzLmdldFZpc2libGVSb3dzKHRydWUpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwic2VsZWN0ZWRcIjpcblx0XHRcdHJvd3MgPSB0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LnNlbGVjdGVkUm93cztcblx0XHRcdGJyZWFrO1xuXG5cdFx0ZGVmYXVsdDpcblx0XHRcdHJvd3MgPSB0aGlzLnJvd3M7XG5cdH1cblxuXHRyZXR1cm4gcm93cztcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vIFRhYmxlIFJlbmRlcmluZyAvLy8vLy8vLy8vLy8vLy8vL1xuXG4vL3RyaWdnZXIgcmVyZW5kZXIgb2YgdGFibGUgaW4gY3VycmVudCBwb3NpdGlvblxuUm93TWFuYWdlci5wcm90b3R5cGUucmVSZW5kZXJJblBvc2l0aW9uID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG5cdGlmICh0aGlzLmdldFJlbmRlck1vZGUoKSA9PSBcInZpcnR1YWxcIikge1xuXG5cdFx0aWYgKHRoaXMucmVkcmF3QmxvY2spIHtcblx0XHRcdGlmIChjYWxsYmFjaykge1xuXHRcdFx0XHRjYWxsYmFjaygpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZWRyYXdCbG9ja1JlZGVySW5Qb3NpdGlvbiA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBzY3JvbGxUb3AgPSB0aGlzLmVsZW1lbnQuc2Nyb2xsVG9wO1xuXHRcdFx0dmFyIHRvcFJvdyA9IGZhbHNlO1xuXHRcdFx0dmFyIHRvcE9mZnNldCA9IGZhbHNlO1xuXG5cdFx0XHR2YXIgbGVmdCA9IHRoaXMuc2Nyb2xsTGVmdDtcblxuXHRcdFx0dmFyIHJvd3MgPSB0aGlzLmdldERpc3BsYXlSb3dzKCk7XG5cblx0XHRcdGZvciAodmFyIGkgPSB0aGlzLnZEb21Ub3A7IGkgPD0gdGhpcy52RG9tQm90dG9tOyBpKyspIHtcblxuXHRcdFx0XHRpZiAocm93c1tpXSkge1xuXHRcdFx0XHRcdHZhciBkaWZmID0gc2Nyb2xsVG9wIC0gcm93c1tpXS5nZXRFbGVtZW50KCkub2Zmc2V0VG9wO1xuXG5cdFx0XHRcdFx0aWYgKHRvcE9mZnNldCA9PT0gZmFsc2UgfHwgTWF0aC5hYnMoZGlmZikgPCB0b3BPZmZzZXQpIHtcblx0XHRcdFx0XHRcdHRvcE9mZnNldCA9IGRpZmY7XG5cdFx0XHRcdFx0XHR0b3BSb3cgPSBpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0XHRcdGNhbGxiYWNrKCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX3ZpcnR1YWxSZW5kZXJGaWxsKHRvcFJvdyA9PT0gZmFsc2UgPyB0aGlzLmRpc3BsYXlSb3dzQ291bnQgLSAxIDogdG9wUm93LCB0cnVlLCB0b3BPZmZzZXQgfHwgMCk7XG5cblx0XHRcdHRoaXMuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZW5kZXJUYWJsZSgpO1xuXG5cdFx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0XHRjYWxsYmFjaygpO1xuXHRcdH1cblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuc2V0UmVuZGVyTW9kZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnZpcnR1YWxEb20pIHtcblxuXHRcdHRoaXMucmVuZGVyTW9kZSA9IFwidmlydHVhbFwiO1xuXG5cdFx0aWYgKHRoaXMudGFibGUuZWxlbWVudC5jbGllbnRIZWlnaHQgfHwgdGhpcy50YWJsZS5vcHRpb25zLmhlaWdodCkge1xuXHRcdFx0dGhpcy5maXhlZEhlaWdodCA9IHRydWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZml4ZWRIZWlnaHQgPSBmYWxzZTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZW5kZXJNb2RlID0gXCJjbGFzc2ljXCI7XG5cdH1cbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLmdldFJlbmRlck1vZGUgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLnJlbmRlck1vZGU7XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5yZW5kZXJUYWJsZSA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLnRhYmxlLm9wdGlvbnMucmVuZGVyU3RhcnRlZC5jYWxsKHRoaXMudGFibGUpO1xuXG5cdHRoaXMuZWxlbWVudC5zY3JvbGxUb3AgPSAwO1xuXG5cdHN3aXRjaCAodGhpcy5yZW5kZXJNb2RlKSB7XG5cdFx0Y2FzZSBcImNsYXNzaWNcIjpcblx0XHRcdHRoaXMuX3NpbXBsZVJlbmRlcigpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwidmlydHVhbFwiOlxuXHRcdFx0dGhpcy5fdmlydHVhbFJlbmRlckZpbGwoKTtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0aWYgKHRoaXMuZmlyc3RSZW5kZXIpIHtcblx0XHRpZiAodGhpcy5kaXNwbGF5Um93c0NvdW50KSB7XG5cdFx0XHR0aGlzLmZpcnN0UmVuZGVyID0gZmFsc2U7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMubGF5b3V0LmxheW91dCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnJlbmRlckVtcHR5U2Nyb2xsKCk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZnJvemVuQ29sdW1uc1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmxheW91dCgpO1xuXHR9XG5cblx0aWYgKCF0aGlzLmRpc3BsYXlSb3dzQ291bnQpIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBsYWNlaG9sZGVyKSB7XG5cblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wbGFjZWhvbGRlci5zZXRBdHRyaWJ1dGUoXCJ0YWJ1bGF0b3ItcmVuZGVyLW1vZGVcIiwgdGhpcy5yZW5kZXJNb2RlKTtcblxuXHRcdFx0dGhpcy5nZXRFbGVtZW50KCkuYXBwZW5kQ2hpbGQodGhpcy50YWJsZS5vcHRpb25zLnBsYWNlaG9sZGVyKTtcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wbGFjZWhvbGRlci5zdHlsZS53aWR0aCA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRXaWR0aCgpICsgXCJweFwiO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMudGFibGUub3B0aW9ucy5yZW5kZXJDb21wbGV0ZS5jYWxsKHRoaXMudGFibGUpO1xufTtcblxuLy9zaW1wbGUgcmVuZGVyIG9uIGhlaWdodGxlc3MgdGFibGVcblJvd01hbmFnZXIucHJvdG90eXBlLl9zaW1wbGVSZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX2NsZWFyVmlydHVhbERvbSgpO1xuXG5cdGlmICh0aGlzLmRpc3BsYXlSb3dzQ291bnQpIHtcblx0XHR0aGlzLmNoZWNrQ2xhc3NpY01vZGVHcm91cEhlYWRlcldpZHRoKCk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZW5kZXJFbXB0eVNjcm9sbCgpO1xuXHR9XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5jaGVja0NsYXNzaWNNb2RlR3JvdXBIZWFkZXJXaWR0aCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZWxlbWVudCA9IHRoaXMudGFibGVFbGVtZW50LFxuXHQgICAgb25seUdyb3VwSGVhZGVycyA9IHRydWU7XG5cblx0c2VsZi5nZXREaXNwbGF5Um93cygpLmZvckVhY2goZnVuY3Rpb24gKHJvdywgaW5kZXgpIHtcblx0XHRzZWxmLnN0eWxlUm93KHJvdywgaW5kZXgpO1xuXHRcdGVsZW1lbnQuYXBwZW5kQ2hpbGQocm93LmdldEVsZW1lbnQoKSk7XG5cdFx0cm93LmluaXRpYWxpemUodHJ1ZSk7XG5cblx0XHRpZiAocm93LnR5cGUgIT09IFwiZ3JvdXBcIikge1xuXHRcdFx0b25seUdyb3VwSGVhZGVycyA9IGZhbHNlO1xuXHRcdH1cblx0fSk7XG5cblx0aWYgKG9ubHlHcm91cEhlYWRlcnMpIHtcblx0XHRlbGVtZW50LnN0eWxlLm1pbldpZHRoID0gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFdpZHRoKCkgKyBcInB4XCI7XG5cdH0gZWxzZSB7XG5cdFx0ZWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IFwiXCI7XG5cdH1cbn07XG5cbi8vc2hvdyBzY3JvbGxiYXJzIG9uIGVtcHR5IHRhYmxlIGRpdlxuUm93TWFuYWdlci5wcm90b3R5cGUucmVuZGVyRW1wdHlTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucGxhY2Vob2xkZXIpIHtcblx0XHR0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy50YWJsZUVsZW1lbnQuc3R5bGUubWluV2lkdGggPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0XHQvLyB0aGlzLnRhYmxlRWxlbWVudC5zdHlsZS5taW5IZWlnaHQgPSBcIjFweFwiO1xuXHRcdC8vIHRoaXMudGFibGVFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuXHR9XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5fY2xlYXJWaXJ0dWFsRG9tID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZWxlbWVudCA9IHRoaXMudGFibGVFbGVtZW50O1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucGxhY2Vob2xkZXIgJiYgdGhpcy50YWJsZS5vcHRpb25zLnBsYWNlaG9sZGVyLnBhcmVudE5vZGUpIHtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMucGxhY2Vob2xkZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnRhYmxlLm9wdGlvbnMucGxhY2Vob2xkZXIpO1xuXHR9XG5cblx0Ly8gZWxlbWVudC5jaGlsZHJlbi5kZXRhY2goKTtcblx0d2hpbGUgKGVsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcblx0fWVsZW1lbnQuc3R5bGUucGFkZGluZ1RvcCA9IFwiXCI7XG5cdGVsZW1lbnQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiXCI7XG5cdGVsZW1lbnQuc3R5bGUubWluV2lkdGggPSBcIlwiO1xuXHRlbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cdGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdGVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9IFwiXCI7XG5cblx0dGhpcy5zY3JvbGxUb3AgPSAwO1xuXHR0aGlzLnNjcm9sbExlZnQgPSAwO1xuXHR0aGlzLnZEb21Ub3AgPSAwO1xuXHR0aGlzLnZEb21Cb3R0b20gPSAwO1xuXHR0aGlzLnZEb21Ub3BQYWQgPSAwO1xuXHR0aGlzLnZEb21Cb3R0b21QYWQgPSAwO1xufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuc3R5bGVSb3cgPSBmdW5jdGlvbiAocm93LCBpbmRleCkge1xuXHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdGlmIChpbmRleCAlIDIpIHtcblx0XHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1ldmVuXCIpO1xuXHRcdHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itcm93LW9kZFwiKTtcblx0fSBlbHNlIHtcblx0XHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1vZGRcIik7XG5cdFx0cm93RWwuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1yb3ctZXZlblwiKTtcblx0fVxufTtcblxuLy9mdWxsIHZpcnR1YWwgcmVuZGVyXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5fdmlydHVhbFJlbmRlckZpbGwgPSBmdW5jdGlvbiAocG9zaXRpb24sIGZvcmNlTW92ZSwgb2Zmc2V0KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGVsZW1lbnQgPSBzZWxmLnRhYmxlRWxlbWVudCxcblx0ICAgIGhvbGRlciA9IHNlbGYuZWxlbWVudCxcblx0ICAgIHRvcFBhZCA9IDAsXG5cdCAgICByb3dzSGVpZ2h0ID0gMCxcblx0ICAgIHRvcFBhZEhlaWdodCA9IDAsXG5cdCAgICBpID0gMCxcblx0ICAgIG9ubHlHcm91cEhlYWRlcnMgPSB0cnVlLFxuXHQgICAgcm93cyA9IHNlbGYuZ2V0RGlzcGxheVJvd3MoKTtcblxuXHRwb3NpdGlvbiA9IHBvc2l0aW9uIHx8IDA7XG5cblx0b2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cblx0aWYgKCFwb3NpdGlvbikge1xuXHRcdHNlbGYuX2NsZWFyVmlydHVhbERvbSgpO1xuXHR9IGVsc2Uge1xuXHRcdHdoaWxlIChlbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRcdGVsZW1lbnQucmVtb3ZlQ2hpbGQoZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR9IC8vY2hlY2sgaWYgcG9zaXRpb24gaXMgdG9vIGNsb3NlIHRvIGJvdHRvbSBvZiB0YWJsZVxuXHRcdHZhciBoZWlnaHRPY2N1cGllZCA9IChzZWxmLmRpc3BsYXlSb3dzQ291bnQgLSBwb3NpdGlvbiArIDEpICogc2VsZi52RG9tUm93SGVpZ2h0O1xuXG5cdFx0aWYgKGhlaWdodE9jY3VwaWVkIDwgc2VsZi5oZWlnaHQpIHtcblx0XHRcdHBvc2l0aW9uIC09IE1hdGguY2VpbCgoc2VsZi5oZWlnaHQgLSBoZWlnaHRPY2N1cGllZCkgLyBzZWxmLnZEb21Sb3dIZWlnaHQpO1xuXG5cdFx0XHRpZiAocG9zaXRpb24gPCAwKSB7XG5cdFx0XHRcdHBvc2l0aW9uID0gMDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL2NhbGN1bGF0ZSBpbml0aWFsIHBhZFxuXHRcdHRvcFBhZCA9IE1hdGgubWluKE1hdGgubWF4KE1hdGguZmxvb3Ioc2VsZi52RG9tV2luZG93QnVmZmVyIC8gc2VsZi52RG9tUm93SGVpZ2h0KSwgc2VsZi52RG9tV2luZG93TWluTWFyZ2luUm93cyksIHBvc2l0aW9uKTtcblx0XHRwb3NpdGlvbiAtPSB0b3BQYWQ7XG5cdH1cblxuXHRpZiAoc2VsZi5kaXNwbGF5Um93c0NvdW50ICYmIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbFZpc2libGUoc2VsZi5lbGVtZW50KSkge1xuXG5cdFx0c2VsZi52RG9tVG9wID0gcG9zaXRpb247XG5cblx0XHRzZWxmLnZEb21Cb3R0b20gPSBwb3NpdGlvbiAtIDE7XG5cblx0XHR3aGlsZSAoKHJvd3NIZWlnaHQgPD0gc2VsZi5oZWlnaHQgKyBzZWxmLnZEb21XaW5kb3dCdWZmZXIgfHwgaSA8IHNlbGYudkRvbVdpbmRvd01pblRvdGFsUm93cykgJiYgc2VsZi52RG9tQm90dG9tIDwgc2VsZi5kaXNwbGF5Um93c0NvdW50IC0gMSkge1xuXHRcdFx0dmFyIGluZGV4ID0gc2VsZi52RG9tQm90dG9tICsgMSxcblx0XHRcdCAgICByb3cgPSByb3dzW2luZGV4XSxcblx0XHRcdCAgICByb3dIZWlnaHQgPSAwO1xuXG5cdFx0XHRzZWxmLnN0eWxlUm93KHJvdywgaW5kZXgpO1xuXG5cdFx0XHRlbGVtZW50LmFwcGVuZENoaWxkKHJvdy5nZXRFbGVtZW50KCkpO1xuXG5cdFx0XHRyb3cuaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHRpZiAoIXJvdy5oZWlnaHRJbml0aWFsaXplZCkge1xuXHRcdFx0XHRyb3cubm9ybWFsaXplSGVpZ2h0KHRydWUpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBpZighcm93LmluaXRpYWxpemVkKXtcblx0XHRcdC8vIFx0cm93LmluaXRpYWxpemUodHJ1ZSk7XG5cdFx0XHQvLyB9ZWxzZXtcblx0XHRcdC8vIFx0aWYoIXJvdy5oZWlnaHRJbml0aWFsaXplZCl7XG5cdFx0XHQvLyBcdFx0cm93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfVxuXG5cdFx0XHRyb3dIZWlnaHQgPSByb3cuZ2V0SGVpZ2h0KCk7XG5cblx0XHRcdGlmIChpIDwgdG9wUGFkKSB7XG5cdFx0XHRcdHRvcFBhZEhlaWdodCArPSByb3dIZWlnaHQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyb3dzSGVpZ2h0ICs9IHJvd0hlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHJvd0hlaWdodCA+IHRoaXMudkRvbVdpbmRvd0J1ZmZlcikge1xuXHRcdFx0XHR0aGlzLnZEb21XaW5kb3dCdWZmZXIgPSByb3dIZWlnaHQgKiAyO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAocm93LnR5cGUgIT09IFwiZ3JvdXBcIikge1xuXHRcdFx0XHRvbmx5R3JvdXBIZWFkZXJzID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdHNlbGYudkRvbUJvdHRvbSsrO1xuXHRcdFx0aSsrO1xuXHRcdH1cblxuXHRcdGlmICghcG9zaXRpb24pIHtcblx0XHRcdHRoaXMudkRvbVRvcFBhZCA9IDA7XG5cdFx0XHQvL2FkanVzdCByb3doZWlnaHQgdG8gbWF0Y2ggYXZlcmFnZSBvZiByZW5kZXJlZCBlbGVtZW50c1xuXHRcdFx0c2VsZi52RG9tUm93SGVpZ2h0ID0gTWF0aC5mbG9vcigocm93c0hlaWdodCArIHRvcFBhZEhlaWdodCkgLyBpKTtcblx0XHRcdHNlbGYudkRvbUJvdHRvbVBhZCA9IHNlbGYudkRvbVJvd0hlaWdodCAqIChzZWxmLmRpc3BsYXlSb3dzQ291bnQgLSBzZWxmLnZEb21Cb3R0b20gLSAxKTtcblxuXHRcdFx0c2VsZi52RG9tU2Nyb2xsSGVpZ2h0ID0gdG9wUGFkSGVpZ2h0ICsgcm93c0hlaWdodCArIHNlbGYudkRvbUJvdHRvbVBhZCAtIHNlbGYuaGVpZ2h0O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzZWxmLnZEb21Ub3BQYWQgPSAhZm9yY2VNb3ZlID8gc2VsZi5zY3JvbGxUb3AgLSB0b3BQYWRIZWlnaHQgOiBzZWxmLnZEb21Sb3dIZWlnaHQgKiB0aGlzLnZEb21Ub3AgKyBvZmZzZXQ7XG5cdFx0XHRzZWxmLnZEb21Cb3R0b21QYWQgPSBzZWxmLnZEb21Cb3R0b20gPT0gc2VsZi5kaXNwbGF5Um93c0NvdW50IC0gMSA/IDAgOiBNYXRoLm1heChzZWxmLnZEb21TY3JvbGxIZWlnaHQgLSBzZWxmLnZEb21Ub3BQYWQgLSByb3dzSGVpZ2h0IC0gdG9wUGFkSGVpZ2h0LCAwKTtcblx0XHR9XG5cblx0XHRlbGVtZW50LnN0eWxlLnBhZGRpbmdUb3AgPSBzZWxmLnZEb21Ub3BQYWQgKyBcInB4XCI7XG5cdFx0ZWxlbWVudC5zdHlsZS5wYWRkaW5nQm90dG9tID0gc2VsZi52RG9tQm90dG9tUGFkICsgXCJweFwiO1xuXG5cdFx0aWYgKGZvcmNlTW92ZSkge1xuXHRcdFx0dGhpcy5zY3JvbGxUb3AgPSBzZWxmLnZEb21Ub3BQYWQgKyB0b3BQYWRIZWlnaHQgKyBvZmZzZXQgLSAodGhpcy5lbGVtZW50LnNjcm9sbFdpZHRoID4gdGhpcy5lbGVtZW50LmNsaWVudFdpZHRoID8gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodCAtIHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgOiAwKTtcblx0XHR9XG5cblx0XHR0aGlzLnNjcm9sbFRvcCA9IE1hdGgubWluKHRoaXMuc2Nyb2xsVG9wLCB0aGlzLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5oZWlnaHQpO1xuXG5cdFx0Ly9hZGp1c3QgZm9yIGhvcml6b250YWwgc2Nyb2xsYmFyIGlmIHByZXNlbnQgKGFuZCBub3QgYXQgdG9wIG9mIHRhYmxlKVxuXHRcdGlmICh0aGlzLmVsZW1lbnQuc2Nyb2xsV2lkdGggPiB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGggJiYgZm9yY2VNb3ZlKSB7XG5cdFx0XHR0aGlzLnNjcm9sbFRvcCArPSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0IC0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHR9XG5cblx0XHR0aGlzLnZEb21TY3JvbGxQb3NUb3AgPSB0aGlzLnNjcm9sbFRvcDtcblx0XHR0aGlzLnZEb21TY3JvbGxQb3NCb3R0b20gPSB0aGlzLnNjcm9sbFRvcDtcblxuXHRcdGhvbGRlci5zY3JvbGxUb3AgPSB0aGlzLnNjcm9sbFRvcDtcblxuXHRcdGVsZW1lbnQuc3R5bGUubWluV2lkdGggPSBvbmx5R3JvdXBIZWFkZXJzID8gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFdpZHRoKCkgKyBcInB4XCIgOiBcIlwiO1xuXG5cdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5ncm91cEJ5KSB7XG5cdFx0XHRpZiAoc2VsZi50YWJsZS5tb2R1bGVzLmxheW91dC5nZXRNb2RlKCkgIT0gXCJmaXREYXRhRmlsbFwiICYmIHNlbGYuZGlzcGxheVJvd3NDb3VudCA9PSBzZWxmLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmNvdW50R3JvdXBzKCkpIHtcblx0XHRcdFx0c2VsZi50YWJsZUVsZW1lbnQuc3R5bGUubWluV2lkdGggPSBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5yZW5kZXJFbXB0eVNjcm9sbCgpO1xuXHR9XG5cblx0aWYgKCF0aGlzLmZpeGVkSGVpZ2h0KSB7XG5cdFx0dGhpcy5hZGp1c3RUYWJsZVNpemUoKTtcblx0fVxufTtcblxuLy9oYW5kbGUgdmVydGljYWwgc2Nyb2xsaW5nXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5zY3JvbGxWZXJ0aWNhbCA9IGZ1bmN0aW9uIChkaXIpIHtcblx0dmFyIHRvcERpZmYgPSB0aGlzLnNjcm9sbFRvcCAtIHRoaXMudkRvbVNjcm9sbFBvc1RvcDtcblx0dmFyIGJvdHRvbURpZmYgPSB0aGlzLnNjcm9sbFRvcCAtIHRoaXMudkRvbVNjcm9sbFBvc0JvdHRvbTtcblx0dmFyIG1hcmdpbiA9IHRoaXMudkRvbVdpbmRvd0J1ZmZlciAqIDI7XG5cblx0aWYgKC10b3BEaWZmID4gbWFyZ2luIHx8IGJvdHRvbURpZmYgPiBtYXJnaW4pIHtcblx0XHQvL2lmIGJpZyBzY3JvbGwgcmVkcmF3IHRhYmxlO1xuXHRcdHZhciBsZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xuXHRcdHRoaXMuX3ZpcnR1YWxSZW5kZXJGaWxsKE1hdGguZmxvb3IodGhpcy5lbGVtZW50LnNjcm9sbFRvcCAvIHRoaXMuZWxlbWVudC5zY3JvbGxIZWlnaHQgKiB0aGlzLmRpc3BsYXlSb3dzQ291bnQpKTtcblx0XHR0aGlzLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdH0gZWxzZSB7XG5cblx0XHRpZiAoZGlyKSB7XG5cdFx0XHQvL3Njcm9sbGluZyB1cFxuXHRcdFx0aWYgKHRvcERpZmYgPCAwKSB7XG5cblx0XHRcdFx0dGhpcy5fYWRkVG9wUm93KC10b3BEaWZmKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJvdHRvbURpZmYgPCAwKSB7XG5cblx0XHRcdFx0Ly9oaWRlIGJvdHRvbSByb3cgaWYgbmVlZGVkXG5cdFx0XHRcdGlmICh0aGlzLnZEb21TY3JvbGxIZWlnaHQgLSB0aGlzLnNjcm9sbFRvcCA+IHRoaXMudkRvbVdpbmRvd0J1ZmZlcikge1xuXHRcdFx0XHRcdHRoaXMuX3JlbW92ZUJvdHRvbVJvdygtYm90dG9tRGlmZik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zQm90dG9tID0gdGhpcy5zY3JvbGxUb3A7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9zY3JvbGxpbmcgZG93blxuXHRcdFx0aWYgKHRvcERpZmYgPj0gMCkge1xuXG5cdFx0XHRcdC8vaGlkZSB0b3Agcm93IGlmIG5lZWRlZFxuXHRcdFx0XHRpZiAodGhpcy5zY3JvbGxUb3AgPiB0aGlzLnZEb21XaW5kb3dCdWZmZXIpIHtcblxuXHRcdFx0XHRcdHRoaXMuX3JlbW92ZVRvcFJvdyh0b3BEaWZmKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLnZEb21TY3JvbGxQb3NUb3AgPSB0aGlzLnNjcm9sbFRvcDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYm90dG9tRGlmZiA+PSAwKSB7XG5cblx0XHRcdFx0dGhpcy5fYWRkQm90dG9tUm93KGJvdHRvbURpZmYpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuX2FkZFRvcFJvdyA9IGZ1bmN0aW9uICh0b3BEaWZmKSB7XG5cdHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwO1xuXG5cdHZhciB0YWJsZSA9IHRoaXMudGFibGVFbGVtZW50LFxuXHQgICAgcm93cyA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKTtcblxuXHRpZiAodGhpcy52RG9tVG9wKSB7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy52RG9tVG9wIC0gMSxcblx0XHQgICAgdG9wUm93ID0gcm93c1tpbmRleF0sXG5cdFx0ICAgIHRvcFJvd0hlaWdodCA9IHRvcFJvdy5nZXRIZWlnaHQoKSB8fCB0aGlzLnZEb21Sb3dIZWlnaHQ7XG5cblx0XHQvL2hpZGUgdG9wIHJvdyBpZiBuZWVkZWRcblx0XHRpZiAodG9wRGlmZiA+PSB0b3BSb3dIZWlnaHQpIHtcblx0XHRcdHRoaXMuc3R5bGVSb3codG9wUm93LCBpbmRleCk7XG5cdFx0XHR0YWJsZS5pbnNlcnRCZWZvcmUodG9wUm93LmdldEVsZW1lbnQoKSwgdGFibGUuZmlyc3RDaGlsZCk7XG5cdFx0XHRpZiAoIXRvcFJvdy5pbml0aWFsaXplZCB8fCAhdG9wUm93LmhlaWdodEluaXRpYWxpemVkKSB7XG5cdFx0XHRcdHRoaXMudkRvbVRvcE5ld1Jvd3MucHVzaCh0b3BSb3cpO1xuXG5cdFx0XHRcdGlmICghdG9wUm93LmhlaWdodEluaXRpYWxpemVkKSB7XG5cdFx0XHRcdFx0dG9wUm93LmNsZWFyQ2VsbEhlaWdodCgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR0b3BSb3cuaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHR0aGlzLnZEb21Ub3BQYWQgLT0gdG9wUm93SGVpZ2h0O1xuXG5cdFx0XHRpZiAodGhpcy52RG9tVG9wUGFkIDwgMCkge1xuXHRcdFx0XHR0aGlzLnZEb21Ub3BQYWQgPSBpbmRleCAqIHRoaXMudkRvbVJvd0hlaWdodDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFpbmRleCkge1xuXHRcdFx0XHR0aGlzLnZEb21Ub3BQYWQgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHR0YWJsZS5zdHlsZS5wYWRkaW5nVG9wID0gdGhpcy52RG9tVG9wUGFkICsgXCJweFwiO1xuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wIC09IHRvcFJvd0hlaWdodDtcblx0XHRcdHRoaXMudkRvbVRvcC0tO1xuXHRcdH1cblxuXHRcdHRvcERpZmYgPSAtKHRoaXMuc2Nyb2xsVG9wIC0gdGhpcy52RG9tU2Nyb2xsUG9zVG9wKTtcblxuXHRcdGlmICh0b3BSb3cuZ2V0SGVpZ2h0KCkgPiB0aGlzLnZEb21XaW5kb3dCdWZmZXIpIHtcblx0XHRcdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IHRvcFJvdy5nZXRIZWlnaHQoKSAqIDI7XG5cdFx0fVxuXG5cdFx0aWYgKGkgPCB0aGlzLnZEb21NYXhSZW5kZXJDaGFpbiAmJiB0aGlzLnZEb21Ub3AgJiYgdG9wRGlmZiA+PSAocm93c1t0aGlzLnZEb21Ub3AgLSAxXS5nZXRIZWlnaHQoKSB8fCB0aGlzLnZEb21Sb3dIZWlnaHQpKSB7XG5cdFx0XHR0aGlzLl9hZGRUb3BSb3codG9wRGlmZiwgaSArIDEpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9xdWlja05vcm1hbGl6ZVJvd0hlaWdodCh0aGlzLnZEb21Ub3BOZXdSb3dzKTtcblx0XHR9XG5cdH1cbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLl9yZW1vdmVUb3BSb3cgPSBmdW5jdGlvbiAodG9wRGlmZikge1xuXHR2YXIgdGFibGUgPSB0aGlzLnRhYmxlRWxlbWVudCxcblx0ICAgIHRvcFJvdyA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKVt0aGlzLnZEb21Ub3BdLFxuXHQgICAgdG9wUm93SGVpZ2h0ID0gdG9wUm93LmdldEhlaWdodCgpIHx8IHRoaXMudkRvbVJvd0hlaWdodDtcblxuXHRpZiAodG9wRGlmZiA+PSB0b3BSb3dIZWlnaHQpIHtcblxuXHRcdHZhciByb3dFbCA9IHRvcFJvdy5nZXRFbGVtZW50KCk7XG5cdFx0cm93RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3dFbCk7XG5cblx0XHR0aGlzLnZEb21Ub3BQYWQgKz0gdG9wUm93SGVpZ2h0O1xuXHRcdHRhYmxlLnN0eWxlLnBhZGRpbmdUb3AgPSB0aGlzLnZEb21Ub3BQYWQgKyBcInB4XCI7XG5cdFx0dGhpcy52RG9tU2Nyb2xsUG9zVG9wICs9IHRoaXMudkRvbVRvcCA/IHRvcFJvd0hlaWdodCA6IHRvcFJvd0hlaWdodCArIHRoaXMudkRvbVdpbmRvd0J1ZmZlcjtcblx0XHR0aGlzLnZEb21Ub3ArKztcblxuXHRcdHRvcERpZmYgPSB0aGlzLnNjcm9sbFRvcCAtIHRoaXMudkRvbVNjcm9sbFBvc1RvcDtcblxuXHRcdHRoaXMuX3JlbW92ZVRvcFJvdyh0b3BEaWZmKTtcblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUuX2FkZEJvdHRvbVJvdyA9IGZ1bmN0aW9uIChib3R0b21EaWZmKSB7XG5cdHZhciBpID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAwO1xuXG5cdHZhciB0YWJsZSA9IHRoaXMudGFibGVFbGVtZW50LFxuXHQgICAgcm93cyA9IHRoaXMuZ2V0RGlzcGxheVJvd3MoKTtcblxuXHRpZiAodGhpcy52RG9tQm90dG9tIDwgdGhpcy5kaXNwbGF5Um93c0NvdW50IC0gMSkge1xuXHRcdHZhciBpbmRleCA9IHRoaXMudkRvbUJvdHRvbSArIDEsXG5cdFx0ICAgIGJvdHRvbVJvdyA9IHJvd3NbaW5kZXhdLFxuXHRcdCAgICBib3R0b21Sb3dIZWlnaHQgPSBib3R0b21Sb3cuZ2V0SGVpZ2h0KCkgfHwgdGhpcy52RG9tUm93SGVpZ2h0O1xuXG5cdFx0Ly9oaWRlIGJvdHRvbSByb3cgaWYgbmVlZGVkXG5cdFx0aWYgKGJvdHRvbURpZmYgPj0gYm90dG9tUm93SGVpZ2h0KSB7XG5cdFx0XHR0aGlzLnN0eWxlUm93KGJvdHRvbVJvdywgaW5kZXgpO1xuXHRcdFx0dGFibGUuYXBwZW5kQ2hpbGQoYm90dG9tUm93LmdldEVsZW1lbnQoKSk7XG5cblx0XHRcdGlmICghYm90dG9tUm93LmluaXRpYWxpemVkIHx8ICFib3R0b21Sb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0dGhpcy52RG9tQm90dG9tTmV3Um93cy5wdXNoKGJvdHRvbVJvdyk7XG5cblx0XHRcdFx0aWYgKCFib3R0b21Sb3cuaGVpZ2h0SW5pdGlhbGl6ZWQpIHtcblx0XHRcdFx0XHRib3R0b21Sb3cuY2xlYXJDZWxsSGVpZ2h0KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ym90dG9tUm93LmluaXRpYWxpemUoKTtcblxuXHRcdFx0dGhpcy52RG9tQm90dG9tUGFkIC09IGJvdHRvbVJvd0hlaWdodDtcblxuXHRcdFx0aWYgKHRoaXMudkRvbUJvdHRvbVBhZCA8IDAgfHwgaW5kZXggPT0gdGhpcy5kaXNwbGF5Um93c0NvdW50IC0gMSkge1xuXHRcdFx0XHR0aGlzLnZEb21Cb3R0b21QYWQgPSAwO1xuXHRcdFx0fVxuXG5cdFx0XHR0YWJsZS5zdHlsZS5wYWRkaW5nQm90dG9tID0gdGhpcy52RG9tQm90dG9tUGFkICsgXCJweFwiO1xuXHRcdFx0dGhpcy52RG9tU2Nyb2xsUG9zQm90dG9tICs9IGJvdHRvbVJvd0hlaWdodDtcblx0XHRcdHRoaXMudkRvbUJvdHRvbSsrO1xuXHRcdH1cblxuXHRcdGJvdHRvbURpZmYgPSB0aGlzLnNjcm9sbFRvcCAtIHRoaXMudkRvbVNjcm9sbFBvc0JvdHRvbTtcblxuXHRcdGlmIChib3R0b21Sb3cuZ2V0SGVpZ2h0KCkgPiB0aGlzLnZEb21XaW5kb3dCdWZmZXIpIHtcblx0XHRcdHRoaXMudkRvbVdpbmRvd0J1ZmZlciA9IGJvdHRvbVJvdy5nZXRIZWlnaHQoKSAqIDI7XG5cdFx0fVxuXG5cdFx0aWYgKGkgPCB0aGlzLnZEb21NYXhSZW5kZXJDaGFpbiAmJiB0aGlzLnZEb21Cb3R0b20gPCB0aGlzLmRpc3BsYXlSb3dzQ291bnQgLSAxICYmIGJvdHRvbURpZmYgPj0gKHJvd3NbdGhpcy52RG9tQm90dG9tICsgMV0uZ2V0SGVpZ2h0KCkgfHwgdGhpcy52RG9tUm93SGVpZ2h0KSkge1xuXHRcdFx0dGhpcy5fYWRkQm90dG9tUm93KGJvdHRvbURpZmYsIGkgKyAxKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5fcXVpY2tOb3JtYWxpemVSb3dIZWlnaHQodGhpcy52RG9tQm90dG9tTmV3Um93cyk7XG5cdFx0fVxuXHR9XG59O1xuXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5fcmVtb3ZlQm90dG9tUm93ID0gZnVuY3Rpb24gKGJvdHRvbURpZmYpIHtcblx0dmFyIHRhYmxlID0gdGhpcy50YWJsZUVsZW1lbnQsXG5cdCAgICBib3R0b21Sb3cgPSB0aGlzLmdldERpc3BsYXlSb3dzKClbdGhpcy52RG9tQm90dG9tXSxcblx0ICAgIGJvdHRvbVJvd0hlaWdodCA9IGJvdHRvbVJvdy5nZXRIZWlnaHQoKSB8fCB0aGlzLnZEb21Sb3dIZWlnaHQ7XG5cblx0aWYgKGJvdHRvbURpZmYgPj0gYm90dG9tUm93SGVpZ2h0KSB7XG5cblx0XHR2YXIgcm93RWwgPSBib3R0b21Sb3cuZ2V0RWxlbWVudCgpO1xuXG5cdFx0aWYgKHJvd0VsLnBhcmVudE5vZGUpIHtcblx0XHRcdHJvd0VsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocm93RWwpO1xuXHRcdH1cblxuXHRcdHRoaXMudkRvbUJvdHRvbVBhZCArPSBib3R0b21Sb3dIZWlnaHQ7XG5cblx0XHRpZiAodGhpcy52RG9tQm90dG9tUGFkIDwgMCkge1xuXHRcdFx0dGhpcy52RG9tQm90dG9tUGFkID0gMDtcblx0XHR9XG5cblx0XHR0YWJsZS5zdHlsZS5wYWRkaW5nQm90dG9tID0gdGhpcy52RG9tQm90dG9tUGFkICsgXCJweFwiO1xuXHRcdHRoaXMudkRvbVNjcm9sbFBvc0JvdHRvbSAtPSBib3R0b21Sb3dIZWlnaHQ7XG5cdFx0dGhpcy52RG9tQm90dG9tLS07XG5cblx0XHRib3R0b21EaWZmID0gLSh0aGlzLnNjcm9sbFRvcCAtIHRoaXMudkRvbVNjcm9sbFBvc0JvdHRvbSk7XG5cblx0XHR0aGlzLl9yZW1vdmVCb3R0b21Sb3coYm90dG9tRGlmZik7XG5cdH1cbn07XG5cblJvd01hbmFnZXIucHJvdG90eXBlLl9xdWlja05vcm1hbGl6ZVJvd0hlaWdodCA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0cm93LmNhbGNIZWlnaHQoKTtcblx0fSk7XG5cblx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRyb3cuc2V0Q2VsbEhlaWdodCgpO1xuXHR9KTtcblxuXHRyb3dzLmxlbmd0aCA9IDA7XG59O1xuXG4vL25vcm1hbGl6ZSBoZWlnaHQgb2YgYWN0aXZlIHJvd3NcblJvd01hbmFnZXIucHJvdG90eXBlLm5vcm1hbGl6ZUhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5hY3RpdmVSb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdHJvdy5ub3JtYWxpemVIZWlnaHQoKTtcblx0fSk7XG59O1xuXG4vL2FkanVzdCB0aGUgaGVpZ2h0IG9mIHRoZSB0YWJsZSBob2xkZXIgdG8gZml0IGluIHRoZSBUYWJ1bGF0b3IgZWxlbWVudFxuUm93TWFuYWdlci5wcm90b3R5cGUuYWRqdXN0VGFibGVTaXplID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgaW5pdGlhbEhlaWdodCA9IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQsXG5cdCAgICBtb2RFeGlzdHM7XG5cblx0aWYgKHRoaXMucmVuZGVyTW9kZSA9PT0gXCJ2aXJ0dWFsXCIpIHtcblxuXHRcdHZhciBvdGhlckhlaWdodCA9IE1hdGguZmxvb3IodGhpcy5jb2x1bW5NYW5hZ2VyLmdldEVsZW1lbnQoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgKyAodGhpcy50YWJsZS5mb290ZXJNYW5hZ2VyICYmIHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5hY3RpdmUgJiYgIXRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5leHRlcm5hbCA/IHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5nZXRFbGVtZW50KCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IDogMCkpO1xuXG5cdFx0aWYgKHRoaXMuZml4ZWRIZWlnaHQpIHtcblx0XHRcdHRoaXMuZWxlbWVudC5zdHlsZS5taW5IZWlnaHQgPSBcImNhbGMoMTAwJSAtIFwiICsgb3RoZXJIZWlnaHQgKyBcInB4KVwiO1xuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiY2FsYygxMDAlIC0gXCIgKyBvdGhlckhlaWdodCArIFwicHgpXCI7XG5cdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gXCJjYWxjKDEwMCUgLSBcIiArIG90aGVySGVpZ2h0ICsgXCJweClcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHR0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGhpcy50YWJsZS5lbGVtZW50LmNsaWVudEhlaWdodCAtIG90aGVySGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0dGhpcy5lbGVtZW50LnNjcm9sbFRvcCA9IHRoaXMuc2Nyb2xsVG9wO1xuXHRcdH1cblxuXHRcdHRoaXMuaGVpZ2h0ID0gdGhpcy5lbGVtZW50LmNsaWVudEhlaWdodDtcblx0XHR0aGlzLnZEb21XaW5kb3dCdWZmZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMudmlydHVhbERvbUJ1ZmZlciB8fCB0aGlzLmhlaWdodDtcblxuXHRcdC8vY2hlY2sgaWYgdGhlIHRhYmxlIGhhcyBjaGFuZ2VkIHNpemUgd2hlbiBkZWFsaW5nIHdpdGggdmFyaWFibGUgaGVpZ2h0IHRhYmxlc1xuXHRcdGlmICghdGhpcy5maXhlZEhlaWdodCAmJiBpbml0aWFsSGVpZ2h0ICE9IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQpIHtcblx0XHRcdG1vZEV4aXN0cyA9IHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzaXplVGFibGVcIik7XG5cblx0XHRcdGlmIChtb2RFeGlzdHMgJiYgIXRoaXMudGFibGUubW9kdWxlcy5yZXNpemVUYWJsZS5hdXRvUmVzaXplIHx8ICFtb2RFeGlzdHMpIHtcblx0XHRcdFx0dGhpcy5yZWRyYXcoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbi8vcmVuaXRpYWxpemUgYWxsIHJvd3NcblJvd01hbmFnZXIucHJvdG90eXBlLnJlaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdHJvdy5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdH0pO1xufTtcblxuLy9wcmV2ZW50IHRhYmxlIGZyb20gYmVpbmcgcmVkcmF3blxuUm93TWFuYWdlci5wcm90b3R5cGUuYmxvY2tSZWRyYXcgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMucmVkcmF3QmxvY2sgPSB0cnVlO1xuXHR0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyA9IGZhbHNlO1xufTtcblxuLy9yZXN0b3JlIHRhYmxlIHJlZHJhd2luZ1xuUm93TWFuYWdlci5wcm90b3R5cGUucmVzdG9yZVJlZHJhdyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5yZWRyYXdCbG9jayA9IGZhbHNlO1xuXG5cdGlmICh0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZykge1xuXHRcdHRoaXMucmVmcmVzaEFjdGl2ZURhdGEodGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcuc3RhZ2UsIHRoaXMucmVkcmF3QmxvY2tSZXN0b3JlQ29uZmlnLnNraXBTdGFnZSwgdGhpcy5yZWRyYXdCbG9ja1Jlc3RvcmVDb25maWcucmVuZGVySW5Qb3NpdGlvbik7XG5cblx0XHR0aGlzLnJlZHJhd0Jsb2NrUmVzdG9yZUNvbmZpZyA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLnJlZHJhd0Jsb2NrUmVkZXJJblBvc2l0aW9uKSB7XG5cdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMucmVkcmF3QmxvY2tSZWRlckluUG9zaXRpb24gPSBmYWxzZTtcbn07XG5cbi8vcmVkcmF3IHRhYmxlXG5Sb3dNYW5hZ2VyLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAoZm9yY2UpIHtcblx0dmFyIHBvcyA9IDAsXG5cdCAgICBsZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xuXG5cdHRoaXMuYWRqdXN0VGFibGVTaXplKCk7XG5cblx0dGhpcy50YWJsZS50YWJsZVdpZHRoID0gdGhpcy50YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoO1xuXG5cdGlmICghZm9yY2UpIHtcblx0XHRpZiAodGhpcy5yZW5kZXJNb2RlID09IFwiY2xhc3NpY1wiKSB7XG5cblx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSkge1xuXHRcdFx0XHR0aGlzLnJlZnJlc2hBY3RpdmVEYXRhKFwiZ3JvdXBcIiwgZmFsc2UsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX3NpbXBsZVJlbmRlcigpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnJlUmVuZGVySW5Qb3NpdGlvbigpO1xuXHRcdFx0dGhpcy5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXHRcdH1cblxuXHRcdGlmICghdGhpcy5kaXNwbGF5Um93c0NvdW50KSB7XG5cdFx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBsYWNlaG9sZGVyKSB7XG5cdFx0XHRcdHRoaXMuZ2V0RWxlbWVudCgpLmFwcGVuZENoaWxkKHRoaXMudGFibGUub3B0aW9ucy5wbGFjZWhvbGRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMucmVuZGVyVGFibGUoKTtcblx0fVxufTtcblxuUm93TWFuYWdlci5wcm90b3R5cGUucmVzZXRTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0ID0gMDtcblx0dGhpcy5lbGVtZW50LnNjcm9sbFRvcCA9IDA7XG5cblx0aWYgKHRoaXMudGFibGUuYnJvd3NlciA9PT0gXCJpZVwiKSB7XG5cdFx0dmFyIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKTtcblx0XHRldmVudC5pbml0RXZlbnQoXCJzY3JvbGxcIiwgZmFsc2UsIHRydWUpO1xuXHRcdHRoaXMuZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmVsZW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Njcm9sbCcpKTtcblx0fVxufTtcblxudmFyIFZEb21Ib3ogPSBmdW5jdGlvbiBWRG9tSG96KHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTtcblxuXHR0aGlzLmVsZW1lbnQgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIudGFibGVFbGVtZW50O1xuXHR0aGlzLmhvbGRlckVsID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQ7XG5cblx0dGhpcy5sZWZ0Q29sID0gMDtcblx0dGhpcy5yaWdodENvbCA9IDA7XG5cdHRoaXMuc2Nyb2xsTGVmdCA9IDA7XG5cblx0dGhpcy52RG9tU2Nyb2xsUG9zTGVmdCA9IDA7XG5cdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ID0gMDtcblxuXHR0aGlzLnZEb21QYWRMZWZ0ID0gMDtcblx0dGhpcy52RG9tUGFkUmlnaHQgPSAwO1xuXG5cdHRoaXMuZml0RGF0YUNvbEF2ZyA9IDA7XG5cblx0dGhpcy53aW5kb3cgPSAyMDA7IC8vcGl4ZWwgbWFyZ2luIHRvIG1ha2UgY29sdW1uIHZpc2libGUgYmVmb3JlIGl0IGlzIHNob3duIG9uIHNjcmVlblxuXG5cdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuXHR0aGlzLmNvbHVtbnMgPSBbXTtcblxuXHRpZiAodGhpcy5jb21wYXRhYmlsaXR5Q2hlY2soKSkge1xuXHRcdHRoaXMuaW5pdGlhbGl6ZSgpO1xuXHR9XG59O1xuXG5WRG9tSG96LnByb3RvdHlwZS5jb21wYXRhYmlsaXR5Q2hlY2sgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBvcHRpb25zID0gdGhpcy50YWJsZS5vcHRpb25zLFxuXHQgICAgZnJvemVuID0gZmFsc2UsXG5cdCAgICBvayA9IHRydWU7XG5cblx0aWYgKG9wdGlvbnMubGF5b3V0ID09IFwiZml0RGF0YVRhYmxlXCIpIHtcblx0XHRjb25zb2xlLndhcm4oXCJIb3Jpem9udGFsIFZpdHJ1YWwgRE9NIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggZml0RGF0YVRhYmxlIGxheW91dCBtb2RlXCIpO1xuXHRcdG9rID0gZmFsc2U7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0KSB7XG5cdFx0Y29uc29sZS53YXJuKFwiSG9yaXpvbnRhbCBWaXRydWFsIERPTSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHJlc3BvbnNpdmUgY29sdW1uc1wiKTtcblx0XHRvayA9IGZhbHNlO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUucnRsKSB7XG5cdFx0Y29uc29sZS53YXJuKFwiSG9yaXpvbnRhbCBWaXRydWFsIERPTSBpcyBub3QgY3VycmVudGx5IGNvbXBhdGlibGUgd2l0aCBSVEwgdGV4dCBkaXJlY3Rpb25cIik7XG5cdFx0b2sgPSBmYWxzZTtcblx0fVxuXG5cdC8vIGlmKG9wdGlvbnMucm93Rm9ybWF0dGVyKXtcblx0Ly8gXHRjb25zb2xlLndhcm4oXCJIb3Jpem9udGFsIFZpdHJ1YWwgRE9NIGlzIG5vdCBjb21wYXRpYmxlIHdpdGggcm93IGZvcm1hdHRlcnNcIik7XG5cdC8vIFx0b2sgPSBmYWxzZTtcblx0Ly8gfVxuXG5cdGlmIChvcHRpb25zLmNvbHVtbnMpIHtcblx0XHRmcm96ZW4gPSBvcHRpb25zLmNvbHVtbnMuZmluZChmdW5jdGlvbiAoY29sKSB7XG5cdFx0XHRyZXR1cm4gY29sLmZyb3plbjtcblx0XHR9KTtcblxuXHRcdGlmIChmcm96ZW4pIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkhvcml6b250YWwgVml0cnVhbCBET00gaXMgbm90IGNvbXBhdGlibGUgd2l0aCBmcm96ZW4gY29sdW1uc1wiKTtcblx0XHRcdG9rID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCFvaykge1xuXHRcdG9wdGlvbnMudmlydHVhbERvbUhveiA9IGZhbHNlO1xuXHR9XG5cblx0cmV0dXJuIG9rO1xufTtcblxuVkRvbUhvei5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIF90aGlzMTcgPSB0aGlzO1xuXG5cdHRoaXMuaG9sZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGxlZnQgPSBfdGhpczE3LmhvbGRlckVsLnNjcm9sbExlZnQ7XG5cblx0XHRpZiAoX3RoaXMxNy5zY3JvbGxMZWZ0ICE9IGxlZnQpIHtcblx0XHRcdF90aGlzMTcuc2Nyb2xsTGVmdCA9IGxlZnQ7XG5cdFx0XHRfdGhpczE3LnNjcm9sbChsZWZ0IC0gKF90aGlzMTcudkRvbVNjcm9sbFBvc0xlZnQgKyBfdGhpczE3LndpbmRvdykpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5WRG9tSG96LnByb3RvdHlwZS5kZWluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmNvbHVtbnMgPSBbXTtcblxuXHR0aGlzLmxlZnRDb2wgPSAtMTtcblx0dGhpcy5yaWdodENvbCA9IDA7XG5cblx0dGhpcy52RG9tU2Nyb2xsUG9zTGVmdCA9IDA7XG5cdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ID0gMDtcblx0dGhpcy52RG9tUGFkTGVmdCA9IDA7XG5cdHRoaXMudkRvbVBhZFJpZ2h0ID0gMDtcbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmRhdGFDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjaGFuZ2UgPSBmYWxzZSxcblx0ICAgIGNvbGxzV2lkdGggPSAwLFxuXHQgICAgY29sRW5kID0gMCxcblx0ICAgIGdyb3VwLFxuXHQgICAgcm93LFxuXHQgICAgcm93RWw7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5sYXlvdXQgPT09IFwiZml0RGF0YVwiKSB7XG5cdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0aWYgKCFjb2x1bW4uZGVmaW5pdGlvbi53aWR0aCAmJiBjb2x1bW4udmlzaWJsZSkge1xuXHRcdFx0XHRjaGFuZ2UgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGNoYW5nZSkge1xuXHRcdFx0aWYgKGNoYW5nZSAmJiB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5sZW5ndGgpIHtcblx0XHRcdFx0Ly8gdGhpcy50YWJsZS52ZG9tSG96LmRlaW5pdGlhbGl6ZSgpO1xuXG5cdFx0XHRcdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ID0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy5ob2xkZXJFbC5jbGllbnRXaWR0aCArIHRoaXMud2luZG93O1xuXG5cdFx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSkge1xuXHRcdFx0XHRcdGdyb3VwID0gdGhpcy50YWJsZS5tb2R1bGVzLmdyb3VwUm93cy5nZXRHcm91cHMoZmFsc2UpWzBdO1xuXG5cdFx0XHRcdFx0cm93ID0gZ3JvdXAuZ2V0Um93cyhmYWxzZSlbMF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKClbMF07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAocm93KSB7XG5cblx0XHRcdFx0XHRyb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRcdFx0XHRyb3cuZ2VuZXJhdGVDZWxscygpO1xuXG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHJvd0VsKTtcblxuXHRcdFx0XHRcdGZvciAodmFyIGNvbEVuZCA9IDA7IGNvbEVuZCA8IHJvdy5jZWxscy5sZW5ndGg7IGNvbEVuZCsrKSB7XG5cdFx0XHRcdFx0XHR2YXIgY2VsbCA9IHJvdy5jZWxsc1tjb2xFbmRdO1xuXHRcdFx0XHRcdFx0cm93RWwuYXBwZW5kQ2hpbGQoY2VsbC5nZXRFbGVtZW50KCkpO1xuXG5cdFx0XHRcdFx0XHRjZWxsLmNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXG5cdFx0XHRcdFx0XHRjb2xsc1dpZHRoICs9IGNlbGwuY29sdW1uLmdldFdpZHRoKCk7XG5cblx0XHRcdFx0XHRcdGlmIChjb2xsc1dpZHRoID4gdGhpcy52RG9tU2Nyb2xsUG9zUmlnaHQpIHtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3dFbCk7XG5cblx0XHRcdFx0XHR0aGlzLmZpdERhdGFDb2xBdmcgPSBNYXRoLmZsb29yKGNvbGxzV2lkdGggLyAoY29sRW5kICsgMSkpO1xuXG5cdFx0XHRcdFx0Zm9yIChjb2xFbmQ7IGNvbEVuZCA8IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleC5sZW5ndGg7IGNvbEVuZCsrKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXhbY29sRW5kXS5zZXRXaWR0aCh0aGlzLmZpdERhdGFDb2xBdmcpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMucmVpbml0aWFsaXplKGZhbHNlLCB0cnVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmxheW91dCA9PT0gXCJmaXRDb2x1bW5zXCIpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5sYXlvdXQubGF5b3V0KCk7XG5cdFx0XHR0aGlzLnRhYmxlLnZkb21Ib3oucmVpbml0aWFsaXplKGZhbHNlLCB0cnVlKTtcblx0XHR9XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmZpdERhdGFMYXlvdXRPdmVycmlkZSA9IGZ1bmN0aW9uICgpIHtcblx0Zm9yICh2YXIgX2k1ID0gdGhpcy5sZWZ0Q29sOyBfaTUgPD0gdGhpcy5yaWdodENvbDsgX2k1KyspIHtcblx0XHR0aGlzLmNvbHVtbnNbX2k1XS5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHR9XG59O1xuXG5WRG9tSG96LnByb3RvdHlwZS5yZWluaXRpYWxpemUgPSBmdW5jdGlvbiAodXBkYXRlLCBibG9ja1JlZHJhdykge1xuXHR2YXIgX3RoaXMxOCA9IHRoaXM7XG5cblx0dmFyIG9sZCA9IHtcblx0XHRjb2xzOiB0aGlzLmNvbHVtbnMsXG5cdFx0bGVmdENvbDogdGhpcy5sZWZ0Q29sLFxuXHRcdHJpZ2h0Q29sOiB0aGlzLnJpZ2h0Q29sXG5cdH07XG5cblx0aWYgKHVwZGF0ZSAmJiAhdGhpcy5pbml0aWFsaXplZCkge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdHRoaXMuY2xlYXIoKTtcblxuXHR0aGlzLnNjcm9sbExlZnQgPSB0aGlzLmhvbGRlckVsLnNjcm9sbExlZnQ7XG5cblx0dGhpcy52RG9tU2Nyb2xsUG9zTGVmdCA9IHRoaXMuc2Nyb2xsTGVmdCAtIHRoaXMud2luZG93O1xuXHR0aGlzLnZEb21TY3JvbGxQb3NSaWdodCA9IHRoaXMuc2Nyb2xsTGVmdCArIHRoaXMuaG9sZGVyRWwuY2xpZW50V2lkdGggKyB0aGlzLndpbmRvdztcblxuXHR2YXIgY29sUG9zID0gMDtcblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0dmFyIGNvbmZpZyA9IHt9O1xuXG5cdFx0aWYgKGNvbHVtbi52aXNpYmxlKSB7XG5cdFx0XHR2YXIgd2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblxuXHRcdFx0Y29uZmlnLmxlZnRQb3MgPSBjb2xQb3M7XG5cdFx0XHRjb25maWcucmlnaHRQb3MgPSBjb2xQb3MgKyB3aWR0aDtcblxuXHRcdFx0aWYgKGNvbFBvcyArIHdpZHRoID4gX3RoaXMxOC52RG9tU2Nyb2xsUG9zTGVmdCAmJiBjb2xQb3MgPCBfdGhpczE4LnZEb21TY3JvbGxQb3NSaWdodCkge1xuXHRcdFx0XHQvL2NvbHVtbiBpcyB2aXNpYmxlXG5cblx0XHRcdFx0aWYgKF90aGlzMTgubGVmdENvbCA9PSAtMSkge1xuXHRcdFx0XHRcdF90aGlzMTgubGVmdENvbCA9IF90aGlzMTguY29sdW1ucy5sZW5ndGg7XG5cdFx0XHRcdFx0X3RoaXMxOC52RG9tUGFkTGVmdCA9IGNvbFBvcztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdF90aGlzMTgucmlnaHRDb2wgPSBfdGhpczE4LmNvbHVtbnMubGVuZ3RoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gY29sdW1uIGlzIGhpZGRlblxuXHRcdFx0XHRpZiAoX3RoaXMxOC5sZWZ0Q29sICE9PSAtMSkge1xuXHRcdFx0XHRcdF90aGlzMTgudkRvbVBhZFJpZ2h0ICs9IHdpZHRoO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdF90aGlzMTguY29sdW1ucy5wdXNoKGNvbHVtbik7XG5cblx0XHRcdGNvbHVtbi5tb2R1bGVzLnZkb21Ib3ogPSBjb25maWc7XG5cblx0XHRcdGNvbFBvcyArPSB3aWR0aDtcblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMuZWxlbWVudC5zdHlsZS5wYWRkaW5nTGVmdCA9IHRoaXMudkRvbVBhZExlZnQgKyBcInB4XCI7XG5cdHRoaXMuZWxlbWVudC5zdHlsZS5wYWRkaW5nUmlnaHQgPSB0aGlzLnZEb21QYWRSaWdodCArIFwicHhcIjtcblxuXHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuXHRpZiAoIWJsb2NrUmVkcmF3KSB7XG5cdFx0aWYgKCF1cGRhdGUgfHwgdGhpcy5yZWluaXRDaGFuZ2VkKG9sZCkpIHtcblx0XHRcdHRoaXMucmVuaXRpYWxpemVSb3dzKCk7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5ob2xkZXJFbC5zY3JvbGxMZWZ0ID0gdGhpcy5zY3JvbGxMZWZ0O1xufTtcblxuVkRvbUhvei5wcm90b3R5cGUucmVpbml0Q2hhbmdlZCA9IGZ1bmN0aW9uIChvbGQpIHtcblx0dmFyIF90aGlzMTkgPSB0aGlzO1xuXG5cdHZhciBtYXRjaCA9IHRydWU7XG5cblx0aWYgKG9sZC5jb2xzLmxlbmd0aCAhPT0gdGhpcy5jb2x1bW5zLmxlbmd0aCB8fCBvbGQubGVmdENvbCAhPT0gdGhpcy5sZWZ0Q29sIHx8IG9sZC5yaWdodENvbCAhPT0gdGhpcy5yaWdodENvbCkge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cblx0b2xkLmNvbHMuZm9yRWFjaChmdW5jdGlvbiAoY29sLCBpKSB7XG5cdFx0aWYgKGNvbCAhPT0gX3RoaXMxOS5jb2x1bW5zW2ldKSB7XG5cdFx0XHRtYXRjaCA9IGZhbHNlO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuICFtYXRjaDtcbn07XG5cblZEb21Ib3oucHJvdG90eXBlLnJlbml0aWFsaXplUm93cyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIF90aGlzMjAgPSB0aGlzO1xuXG5cdHZhciByb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFZpc2libGVSb3dzKCk7XG5cdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0X3RoaXMyMC5yZWluaXRpYWxpemVSb3cocm93LCB0cnVlKTtcblx0fSk7XG59O1xuXG5WRG9tSG96LnByb3RvdHlwZS5zY3JvbGwgPSBmdW5jdGlvbiAoZGlmZikge1xuXHR0aGlzLnZEb21TY3JvbGxQb3NMZWZ0ICs9IGRpZmY7XG5cdHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0ICs9IGRpZmY7XG5cblx0aWYgKGRpZmYgPiB0aGlzLmhvbGRlckVsLmNsaWVudFdpZHRoICogLjgpIHtcblx0XHR0aGlzLnJlaW5pdGlhbGl6ZSgpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChkaWZmID4gMCkge1xuXHRcdFx0Ly9zY3JvbGwgcmlnaHRcblx0XHRcdHRoaXMuYWRkQ29sUmlnaHQoKTtcblx0XHRcdHRoaXMucmVtb3ZlQ29sTGVmdCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL3Njcm9sbCBsZWZ0XG5cdFx0XHR0aGlzLmFkZENvbExlZnQoKTtcblx0XHRcdHRoaXMucmVtb3ZlQ29sUmlnaHQoKTtcblx0XHR9XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmNvbFBvc2l0aW9uQWRqdXN0ID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGRpZmYpIHtcblx0Zm9yICh2YXIgX2k2ID0gc3RhcnQ7IF9pNiA8IGVuZDsgX2k2KyspIHtcblx0XHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5zW19pNl07XG5cblx0XHRjb2x1bW4ubW9kdWxlcy52ZG9tSG96LmxlZnRQb3MgLT0gZGlmZjtcblx0XHRjb2x1bW4ubW9kdWxlcy52ZG9tSG96LnJpZ2h0UG9zIC09IGRpZmY7XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmFkZENvbFJpZ2h0ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMucmlnaHRDb2wgKyAxXSxcblx0ICAgIHJvd3MsXG5cdCAgICBvbGRXaWR0aCxcblx0ICAgIHdpZHRoRGlmZjtcblxuXHRpZiAoY29sdW1uICYmIGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oubGVmdFBvcyA8PSB0aGlzLnZEb21TY3JvbGxQb3NSaWdodCkge1xuXG5cdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRWaXNpYmxlUm93cygpO1xuXG5cdFx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdGlmIChyb3cudHlwZSAhPT0gXCJncm91cFwiKSB7XG5cdFx0XHRcdHZhciBjZWxsID0gcm93LmdldENlbGwoY29sdW1uKTtcblx0XHRcdFx0cm93LmdldEVsZW1lbnQoKS5hcHBlbmRDaGlsZChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdGNlbGwuY2VsbFJlbmRlcmVkKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAodGhpcy5maXREYXRhQ29sQXZnKSB7XG5cblx0XHRcdG9sZFdpZHRoID0gY29sdW1uLmdldFdpZHRoKCk7XG5cblx0XHRcdGlmIChvbGRXaWR0aCA9PT0gdGhpcy5maXREYXRhQ29sQXZnKSB7XG5cdFx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXG5cdFx0XHRcdHdpZHRoRGlmZiA9IG9sZFdpZHRoIC0gY29sdW1uLmdldFdpZHRoKCk7XG5cblx0XHRcdFx0aWYgKHdpZHRoRGlmZikge1xuXHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oucmlnaHRQb3MgLT0gd2lkdGhEaWZmO1xuXHRcdFx0XHRcdHRoaXMuY29sUG9zaXRpb25BZGp1c3QodGhpcy5yaWdodENvbCArIDEsIHRoaXMuY29sdW1ucy5sZW5ndGgsIHdpZHRoRGlmZik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnJpZ2h0Q29sKys7XG5cblx0XHRpZiAodGhpcy5yaWdodENvbCA+PSB0aGlzLmNvbHVtbnMubGVuZ3RoIC0gMSkge1xuXHRcdFx0dGhpcy52RG9tUGFkUmlnaHQgPSAwO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnZEb21QYWRSaWdodCAtPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHR9XG5cblx0XHR0aGlzLmVsZW1lbnQuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdGhpcy52RG9tUGFkUmlnaHQgKyBcInB4XCI7XG5cblx0XHR0aGlzLmFkZENvbFJpZ2h0KCk7XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmFkZENvbExlZnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbnNbdGhpcy5sZWZ0Q29sIC0gMV0sXG5cdCAgICByb3dzO1xuXG5cdGlmIChjb2x1bW4gJiYgY29sdW1uLm1vZHVsZXMudmRvbUhvei5yaWdodFBvcyA+PSB0aGlzLnZEb21TY3JvbGxQb3NMZWZ0KSB7XG5cdFx0dmFyIHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VmlzaWJsZVJvd3MoKTtcblxuXHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRpZiAocm93LnR5cGUgIT09IFwiZ3JvdXBcIikge1xuXHRcdFx0XHR2YXIgY2VsbCA9IHJvdy5nZXRDZWxsKGNvbHVtbik7XG5cdFx0XHRcdHJvdy5nZXRFbGVtZW50KCkucHJlcGVuZChjZWxsLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdGNlbGwuY2VsbFJlbmRlcmVkKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAoIXRoaXMubGVmdENvbCkge1xuXHRcdFx0dGhpcy52RG9tUGFkTGVmdCA9IDA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudkRvbVBhZExlZnQgLT0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLnBhZGRpbmdMZWZ0ID0gdGhpcy52RG9tUGFkTGVmdCArIFwicHhcIjtcblxuXHRcdHRoaXMubGVmdENvbC0tO1xuXG5cdFx0dGhpcy5hZGRDb2xMZWZ0KCk7XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLnJlbW92ZUNvbFJpZ2h0ID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5zW3RoaXMucmlnaHRDb2xdLFxuXHQgICAgcm93cztcblxuXHRpZiAoY29sdW1uICYmIGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oubGVmdFBvcyA+IHRoaXMudkRvbVNjcm9sbFBvc1JpZ2h0KSB7XG5cdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRWaXNpYmxlUm93cygpO1xuXG5cdFx0Y29sdW1uLm1vZHVsZXMudmRvbUhvei52aXNpYmxlID0gZmFsc2U7XG5cblx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0aWYgKHJvdy50eXBlICE9PSBcImdyb3VwXCIpIHtcblx0XHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLnJlbW92ZUNoaWxkKGNlbGwuZ2V0RWxlbWVudCgpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMudkRvbVBhZFJpZ2h0ICs9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5wYWRkaW5nUmlnaHQgPSB0aGlzLnZEb21QYWRSaWdodCArIFwicHhcIjtcblxuXHRcdHRoaXMucmlnaHRDb2wtLTtcblxuXHRcdHRoaXMucmVtb3ZlQ29sUmlnaHQoKTtcblx0fVxufTtcblxuVkRvbUhvei5wcm90b3R5cGUucmVtb3ZlQ29sTGVmdCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uc1t0aGlzLmxlZnRDb2xdLFxuXHQgICAgcm93cztcblxuXHRpZiAoY29sdW1uICYmIGNvbHVtbi5tb2R1bGVzLnZkb21Ib3oucmlnaHRQb3MgPCB0aGlzLnZEb21TY3JvbGxQb3NMZWZ0KSB7XG5cblx0XHRyb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFZpc2libGVSb3dzKCk7XG5cblx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0aWYgKHJvdy50eXBlICE9PSBcImdyb3VwXCIpIHtcblx0XHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLnJlbW92ZUNoaWxkKGNlbGwuZ2V0RWxlbWVudCgpKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMudkRvbVBhZExlZnQgKz0gY29sdW1uLmdldFdpZHRoKCk7XG5cdFx0dGhpcy5lbGVtZW50LnN0eWxlLnBhZGRpbmdMZWZ0ID0gdGhpcy52RG9tUGFkTGVmdCArIFwicHhcIjtcblxuXHRcdHRoaXMubGVmdENvbCsrO1xuXG5cdFx0dGhpcy5yZW1vdmVDb2xMZWZ0KCk7XG5cdH1cbn07XG5cblZEb21Ib3oucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdGlmIChyb3cudHlwZSAhPT0gXCJncm91cFwiKSB7XG5cdFx0cm93Lm1vZHVsZXMudmRvbUhveiA9IHtcblx0XHRcdGxlZnRDb2w6IHRoaXMubGVmdENvbCxcblx0XHRcdHJpZ2h0Q29sOiB0aGlzLnJpZ2h0Q29sXG5cdFx0fTtcblxuXHRcdGZvciAodmFyIF9pNyA9IHRoaXMubGVmdENvbDsgX2k3IDw9IHRoaXMucmlnaHRDb2w7IF9pNysrKSB7XG5cdFx0XHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5zW19pN107XG5cblx0XHRcdGlmIChjb2x1bW4gJiYgY29sdW1uLnZpc2libGUpIHtcblx0XHRcdFx0dmFyIGNlbGwgPSByb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXG5cdFx0XHRcdHJvdy5nZXRFbGVtZW50KCkuYXBwZW5kQ2hpbGQoY2VsbC5nZXRFbGVtZW50KCkpO1xuXHRcdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuVkRvbUhvei5wcm90b3R5cGUucmVpbml0aWFsaXplUm93ID0gZnVuY3Rpb24gKHJvdywgZm9yY2UpIHtcblx0aWYgKHJvdy50eXBlICE9PSBcImdyb3VwXCIpIHtcblx0XHRpZiAoZm9yY2UgfHwgIXJvdy5tb2R1bGVzLnZkb21Ib3ogfHwgcm93Lm1vZHVsZXMudmRvbUhvei5sZWZ0Q29sICE9PSB0aGlzLmxlZnRDb2wgfHwgcm93Lm1vZHVsZXMudmRvbUhvei5yaWdodENvbCAhPT0gdGhpcy5yaWdodENvbCkge1xuXHRcdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRcdHdoaWxlIChyb3dFbC5maXJzdENoaWxkKSB7XG5cdFx0XHRcdHJvd0VsLnJlbW92ZUNoaWxkKHJvd0VsLmZpcnN0Q2hpbGQpO1xuXHRcdFx0fXRoaXMuaW5pdGlhbGl6ZVJvdyhyb3cpO1xuXHRcdH1cblx0fVxufTtcbi8vcHVibGljIHJvdyBvYmplY3RcbnZhciBSb3dDb21wb25lbnQgPSBmdW5jdGlvbiBSb3dDb21wb25lbnQocm93KSB7XG5cdHRoaXMuX3JvdyA9IHJvdztcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy5nZXREYXRhKHRyYW5zZm9ybSk7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9yb3cuZ2V0RWxlbWVudCgpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5nZXRDZWxscyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGxzID0gW107XG5cblx0dGhpcy5fcm93LmdldENlbGxzKCkuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdGNlbGxzLnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdH0pO1xuXG5cdHJldHVybiBjZWxscztcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q2VsbCA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIGNlbGwgPSB0aGlzLl9yb3cuZ2V0Q2VsbChjb2x1bW4pO1xuXHRyZXR1cm4gY2VsbCA/IGNlbGwuZ2V0Q29tcG9uZW50KCkgOiBmYWxzZTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0SW5kZXggPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9yb3cuZ2V0RGF0YShcImRhdGFcIilbdGhpcy5fcm93LnRhYmxlLm9wdGlvbnMuaW5kZXhdO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uIChhY3RpdmUpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd1Bvc2l0aW9uKHRoaXMuX3JvdywgYWN0aXZlKTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fcm93LmRlbGV0ZSgpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5zY3JvbGxUbyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHRoaXMuX3Jvdyk7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLnBhZ2VUbyA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX3Jvdy50YWJsZS5tb2RFeGlzdHMoXCJwYWdlXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLnBhZ2Uuc2V0UGFnZVRvUm93KHRoaXMuX3Jvdyk7XG5cdH1cbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uICh0bywgYWZ0ZXIpIHtcblx0dGhpcy5fcm93Lm1vdmVUb1Jvdyh0bywgYWZ0ZXIpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHRyZXR1cm4gdGhpcy5fcm93LnVwZGF0ZURhdGEoZGF0YSk7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLm5vcm1hbGl6ZUhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fcm93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLl9yb3cudGFibGUubW9kdWxlcy5zZWxlY3RSb3cuc2VsZWN0Um93cyh0aGlzLl9yb3cpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5kZXNlbGVjdCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LmRlc2VsZWN0Um93cyh0aGlzLl9yb3cpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS50b2dnbGVTZWxlY3QgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLnNlbGVjdFJvdy50b2dnbGVSb3codGhpcy5fcm93KTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuaXNTZWxlY3RlZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLnNlbGVjdFJvdy5pc1Jvd1NlbGVjdGVkKHRoaXMuX3Jvdyk7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLl9nZXRTZWxmID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fcm93O1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy52YWxpZGF0ZSgpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5mcmVlemUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9yb3cudGFibGUubW9kRXhpc3RzKFwiZnJvemVuUm93c1wiLCB0cnVlKSkge1xuXHRcdHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLmZyb3plblJvd3MuZnJlZXplUm93KHRoaXMuX3Jvdyk7XG5cdH1cbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUudW5mcmVlemUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9yb3cudGFibGUubW9kRXhpc3RzKFwiZnJvemVuUm93c1wiLCB0cnVlKSkge1xuXHRcdHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLmZyb3plblJvd3MudW5mcmVlemVSb3codGhpcy5fcm93KTtcblx0fVxufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5pc0Zyb3plbiA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX3Jvdy50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Sb3dzXCIsIHRydWUpKSB7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZnJvemVuUm93cy5yb3dzLmluZGV4T2YodGhpcy5fcm93KTtcblx0XHRyZXR1cm4gaW5kZXggPiAtMTtcblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUudHJlZUNvbGxhcHNlID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5fcm93LnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIsIHRydWUpKSB7XG5cdFx0dGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuY29sbGFwc2VSb3codGhpcy5fcm93KTtcblx0fVxufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS50cmVlRXhwYW5kID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5fcm93LnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIsIHRydWUpKSB7XG5cdFx0dGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZXhwYW5kUm93KHRoaXMuX3Jvdyk7XG5cdH1cbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUudHJlZVRvZ2dsZSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX3Jvdy50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiLCB0cnVlKSkge1xuXHRcdHRoaXMuX3Jvdy50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLnRvZ2dsZVJvdyh0aGlzLl9yb3cpO1xuXHR9XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLmdldFRyZWVQYXJlbnQgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9yb3cudGFibGUubW9kRXhpc3RzKFwiZGF0YVRyZWVcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZ2V0VHJlZVBhcmVudCh0aGlzLl9yb3cpO1xuXHR9XG5cblx0cmV0dXJuIGZhbHNlO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5nZXRUcmVlQ2hpbGRyZW4gPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLl9yb3cudGFibGUubW9kRXhpc3RzKFwiZGF0YVRyZWVcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuZ2V0VHJlZUNoaWxkcmVuKHRoaXMuX3JvdywgdHJ1ZSk7XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLmFkZFRyZWVDaGlsZCA9IGZ1bmN0aW9uIChkYXRhLCBwb3MsIGluZGV4KSB7XG5cdGlmICh0aGlzLl9yb3cudGFibGUubW9kRXhpc3RzKFwiZGF0YVRyZWVcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5fcm93LnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuYWRkVHJlZUNoaWxkUm93KHRoaXMuX3JvdywgZGF0YSwgcG9zLCBpbmRleCk7XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLnJlZm9ybWF0ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fcm93LnJlaW5pdGlhbGl6ZSgpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5nZXRHcm91cCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy5nZXRHcm91cCgpLmdldENvbXBvbmVudCgpO1xufTtcblxuUm93Q29tcG9uZW50LnByb3RvdHlwZS5nZXRUYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy50YWJsZTtcbn07XG5cblJvd0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0TmV4dFJvdyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHJvdyA9IHRoaXMuX3Jvdy5uZXh0Um93KCk7XG5cdHJldHVybiByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiByb3c7XG59O1xuXG5Sb3dDb21wb25lbnQucHJvdG90eXBlLmdldFByZXZSb3cgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciByb3cgPSB0aGlzLl9yb3cucHJldlJvdygpO1xuXHRyZXR1cm4gcm93ID8gcm93LmdldENvbXBvbmVudCgpIDogcm93O1xufTtcblxudmFyIFJvdyA9IGZ1bmN0aW9uIFJvdyhkYXRhLCBwYXJlbnQpIHtcblx0dmFyIHR5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IFwicm93XCI7XG5cblx0dGhpcy50YWJsZSA9IHBhcmVudC50YWJsZTtcblx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdHRoaXMuZGF0YSA9IHt9O1xuXHR0aGlzLnR5cGUgPSB0eXBlOyAvL3R5cGUgb2YgZWxlbWVudFxuXHR0aGlzLmVsZW1lbnQgPSBmYWxzZTtcblx0dGhpcy5tb2R1bGVzID0ge307IC8vaG9sZCBtb2R1bGUgdmFyaWFibGVzO1xuXHR0aGlzLmNlbGxzID0gW107XG5cdHRoaXMuaGVpZ2h0ID0gMDsgLy9ob2xkIGVsZW1lbnQgaGVpZ2h0XG5cdHRoaXMuaGVpZ2h0U3R5bGVkID0gXCJcIjsgLy9ob2xkIGVsZW1lbnQgaGVpZ2h0IHByZXN0eWxlZCB0byBpbXByb3ZlIHJlbmRlciBlZmZpY2llbmN5XG5cdHRoaXMubWFudWFsSGVpZ2h0ID0gZmFsc2U7IC8vdXNlciBoYXMgbWFudWFsbHkgc2V0IHJvdyBoZWlnaHRcblx0dGhpcy5vdXRlckhlaWdodCA9IDA7IC8vaG9sZGUgbGVtZW50cyBvdXRlciBoZWlnaHRcblx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlOyAvL2VsZW1lbnQgaGFzIGJlZW4gcmVuZGVyZWRcblx0dGhpcy5oZWlnaHRJbml0aWFsaXplZCA9IGZhbHNlOyAvL2VsZW1lbnQgaGFzIHJlc2l6ZWQgY2VsbHMgdG8gZml0XG5cblx0dGhpcy5jb21wb25lbnQgPSBudWxsO1xuXG5cdHRoaXMuY3JlYXRlZCA9IGZhbHNlO1xuXG5cdHRoaXMuc2V0RGF0YShkYXRhKTtcbn07XG5cblJvdy5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuXHRpZiAoIXRoaXMuY3JlYXRlZCkge1xuXHRcdHRoaXMuY3JlYXRlZCA9IHRydWU7XG5cdFx0dGhpcy5nZW5lcmF0ZUVsZW1lbnQoKTtcblx0fVxufTtcblxuUm93LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93XCIpO1xuXHRlbC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93XCIpO1xuXG5cdHRoaXMuZWxlbWVudCA9IGVsO1xufTtcblxuUm93LnByb3RvdHlwZS5nZXRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmNyZWF0ZSgpO1xuXHRyZXR1cm4gdGhpcy5lbGVtZW50O1xufTtcblxuUm93LnByb3RvdHlwZS5kZXRhY2hFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5lbGVtZW50ICYmIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKSB7XG5cdFx0dGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcblx0fVxufTtcblxuUm93LnByb3RvdHlwZS5nZW5lcmF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGRibFRhcCxcblx0ICAgIHRhcEhvbGQsXG5cdCAgICB0YXA7XG5cblx0dGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cblx0Ly9zZXQgcm93IHNlbGVjdGlvbiBjaGFyYWN0ZXJpc3RpY3Ncblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlICE9PSBmYWxzZSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcInNlbGVjdFJvd1wiKSkge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5zZWxlY3RSb3cuaW5pdGlhbGl6ZVJvdyh0aGlzKTtcblx0fVxuXG5cdC8vc2V0dXAgbW92YWJsZSByb3dzXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3MgIT09IGZhbHNlICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwibW92ZVJvd1wiKSkge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5tb3ZlUm93LmluaXRpYWxpemVSb3codGhpcyk7XG5cdH1cblxuXHQvL3NldHVwIGRhdGEgdHJlZVxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmRhdGFUcmVlICE9PSBmYWxzZSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIpKSB7XG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmluaXRpYWxpemVSb3codGhpcyk7XG5cdH1cblxuXHQvL3NldHVwIGNvbHVtbiBjb2xhcHNlIGNvbnRhaW5lclxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgPT09IFwiY29sbGFwc2VcIiAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIikpIHtcblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC5pbml0aWFsaXplUm93KHRoaXMpO1xuXHR9XG5cblx0Ly9zZXQgY29sdW1uIG1lbnVcblx0aWYgKChzZWxmLnRhYmxlLm9wdGlvbnMucm93Q29udGV4dE1lbnUgfHwgc2VsZi50YWJsZS5vcHRpb25zLnJvd0NsaWNrTWVudSkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJtZW51XCIpKSB7XG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLm1lbnUuaW5pdGlhbGl6ZVJvdyh0aGlzKTtcblx0fVxuXG5cdC8vaGFuZGxlIHJvdyBjbGljayBldmVudHNcblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5yb3dDbGljaykge1xuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5yb3dDbGljayhlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucm93RGJsQ2xpY2spIHtcblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMucm93RGJsQ2xpY2soZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnJvd0NvbnRleHQpIHtcblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMucm93Q29udGV4dChlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vaGFuZGxlIG1vdXNlIGV2ZW50c1xuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnJvd01vdXNlRW50ZXIpIHtcblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5yb3dNb3VzZUVudGVyKGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5yb3dNb3VzZUxlYXZlKSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMucm93TW91c2VMZWF2ZShlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucm93TW91c2VPdmVyKSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5yb3dNb3VzZU92ZXIoZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnJvd01vdXNlT3V0KSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLnJvd01vdXNlT3V0KGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5yb3dNb3VzZU1vdmUpIHtcblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLnJvd01vdXNlTW92ZShlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucm93VGFwKSB7XG5cblx0XHR0YXAgPSBmYWxzZTtcblxuXHRcdHNlbGYuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dGFwID0gdHJ1ZTtcblx0XHR9LCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRpZiAodGFwKSB7XG5cdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5yb3dUYXAoZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHRcdHRhcCA9IGZhbHNlO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5yb3dEYmxUYXApIHtcblxuXHRcdGRibFRhcCA9IG51bGw7XG5cblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIGZ1bmN0aW9uIChlKSB7XG5cblx0XHRcdGlmIChkYmxUYXApIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KGRibFRhcCk7XG5cdFx0XHRcdGRibFRhcCA9IG51bGw7XG5cblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLnJvd0RibFRhcChlLCBzZWxmLmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0ZGJsVGFwID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0Y2xlYXJUaW1lb3V0KGRibFRhcCk7XG5cdFx0XHRcdFx0ZGJsVGFwID0gbnVsbDtcblx0XHRcdFx0fSwgMzAwKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucm93VGFwSG9sZCkge1xuXG5cdFx0dGFwSG9sZCA9IG51bGw7XG5cblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblxuXHRcdFx0dGFwSG9sZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQodGFwSG9sZCk7XG5cdFx0XHRcdHRhcEhvbGQgPSBudWxsO1xuXHRcdFx0XHR0YXAgPSBmYWxzZTtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLnJvd1RhcEhvbGQoZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9LCAxMDAwKTtcblx0XHR9LCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGFwSG9sZCk7XG5cdFx0XHR0YXBIb2xkID0gbnVsbDtcblx0XHR9KTtcblx0fVxufTtcblxuUm93LnByb3RvdHlwZS5nZW5lcmF0ZUNlbGxzID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmNlbGxzID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdlbmVyYXRlQ2VsbHModGhpcyk7XG59O1xuXG4vL2Z1bmN0aW9ucyB0byBzZXR1cCBvbiBmaXJzdCByZW5kZXJcblJvdy5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHR2YXIgX3RoaXMyMSA9IHRoaXM7XG5cblx0dGhpcy5jcmVhdGUoKTtcblxuXHRpZiAoIXRoaXMuaW5pdGlhbGl6ZWQgfHwgZm9yY2UpIHtcblxuXHRcdHRoaXMuZGVsZXRlQ2VsbHMoKTtcblxuXHRcdHdoaWxlICh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR9IC8vaGFuZGxlIGZyb3plbiBjZWxsc1xuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZyb3plbkNvbHVtbnNcIikpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmxheW91dFJvdyh0aGlzKTtcblx0XHR9XG5cblx0XHR0aGlzLmdlbmVyYXRlQ2VsbHMoKTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveiAmJiB0aGlzLnRhYmxlLnZkb21Ib3ouaW5pdGlhbGl6ZWQpIHtcblx0XHRcdHRoaXMudGFibGUudmRvbUhvei5pbml0aWFsaXplUm93KHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRcdFx0X3RoaXMyMS5lbGVtZW50LmFwcGVuZENoaWxkKGNlbGwuZ2V0RWxlbWVudCgpKTtcblx0XHRcdFx0Y2VsbC5jZWxsUmVuZGVyZWQoKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmIChmb3JjZSkge1xuXHRcdFx0dGhpcy5ub3JtYWxpemVIZWlnaHQoKTtcblx0XHR9XG5cblx0XHQvL3NldHVwIG1vdmFibGUgcm93c1xuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiKSkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmxheW91dFJvdyh0aGlzKTtcblx0XHR9XG5cblx0XHQvL3NldHVwIGNvbHVtbiBjb2xhcHNlIGNvbnRhaW5lclxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCA9PT0gXCJjb2xsYXBzZVwiICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiKSkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQubGF5b3V0Um93KHRoaXMpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucm93Rm9ybWF0dGVyKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMucm93Rm9ybWF0dGVyKHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblxuXHRcdC8vc2V0IHJlc2l6YWJsZSBoYW5kbGVzXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNpemFibGVSb3dzICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzaXplUm93c1wiKSkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlc2l6ZVJvd3MuaW5pdGlhbGl6ZVJvdyh0aGlzKTtcblx0XHR9XG5cblx0XHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblx0fSBlbHNlIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdHRoaXMudGFibGUudmRvbUhvei5yZWluaXRpYWxpemVSb3codGhpcyk7XG5cdFx0fVxuXHR9XG59O1xuXG5Sb3cucHJvdG90eXBlLnJlaW5pdGlhbGl6ZUhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5oZWlnaHRJbml0aWFsaXplZCA9IGZhbHNlO1xuXG5cdGlmICh0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50Lm9mZnNldFBhcmVudCAhPT0gbnVsbCkge1xuXHRcdHRoaXMubm9ybWFsaXplSGVpZ2h0KHRydWUpO1xuXHR9XG59O1xuXG5Sb3cucHJvdG90eXBlLnJlaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChjaGlsZHJlbikge1xuXHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdHRoaXMuaGVpZ2h0SW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuXHRpZiAoIXRoaXMubWFudWFsSGVpZ2h0KSB7XG5cdFx0dGhpcy5oZWlnaHQgPSAwO1xuXHRcdHRoaXMuaGVpZ2h0U3R5bGVkID0gXCJcIjtcblx0fVxuXG5cdGlmICh0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50Lm9mZnNldFBhcmVudCAhPT0gbnVsbCkge1xuXHRcdHRoaXMuaW5pdGlhbGl6ZSh0cnVlKTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiLCB0cnVlKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5kYXRhVHJlZS5nZXRUcmVlQ2hpbGRyZW4odGhpcywgZmFsc2UsIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7XG5cdFx0XHRjaGlsZC5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdFx0fSk7XG5cdH1cbn07XG5cbi8vZ2V0IGhlaWdodHMgd2hlbiBkb2luZyBidWxrIHJvdyBzdHlsZSBjYWxjcyBpbiB2aXJ0dWFsIERPTVxuUm93LnByb3RvdHlwZS5jYWxjSGVpZ2h0ID0gZnVuY3Rpb24gKGZvcmNlKSB7XG5cblx0dmFyIG1heEhlaWdodCA9IDAsXG5cdCAgICBtaW5IZWlnaHQgPSB0aGlzLnRhYmxlLm9wdGlvbnMucmVzaXphYmxlUm93cyA/IHRoaXMuZWxlbWVudC5jbGllbnRIZWlnaHQgOiAwO1xuXG5cdHRoaXMuY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdHZhciBoZWlnaHQgPSBjZWxsLmdldEhlaWdodCgpO1xuXHRcdGlmIChoZWlnaHQgPiBtYXhIZWlnaHQpIHtcblx0XHRcdG1heEhlaWdodCA9IGhlaWdodDtcblx0XHR9XG5cdH0pO1xuXG5cdGlmIChmb3JjZSkge1xuXHRcdHRoaXMuaGVpZ2h0ID0gTWF0aC5tYXgobWF4SGVpZ2h0LCBtaW5IZWlnaHQpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuaGVpZ2h0ID0gdGhpcy5tYW51YWxIZWlnaHQgPyB0aGlzLmhlaWdodCA6IE1hdGgubWF4KG1heEhlaWdodCwgbWluSGVpZ2h0KTtcblx0fVxuXG5cdHRoaXMuaGVpZ2h0U3R5bGVkID0gdGhpcy5oZWlnaHQgPyB0aGlzLmhlaWdodCArIFwicHhcIiA6IFwiXCI7XG5cdHRoaXMub3V0ZXJIZWlnaHQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xufTtcblxuLy9zZXQgb2YgY2VsbHNcblJvdy5wcm90b3R5cGUuc2V0Q2VsbEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0Y2VsbC5zZXRIZWlnaHQoKTtcblx0fSk7XG5cblx0dGhpcy5oZWlnaHRJbml0aWFsaXplZCA9IHRydWU7XG59O1xuXG5Sb3cucHJvdG90eXBlLmNsZWFyQ2VsbEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5jZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0Y2VsbC5jbGVhckhlaWdodCgpO1xuXHR9KTtcbn07XG5cbi8vbm9ybWFsaXplIHRoZSBoZWlnaHQgb2YgZWxlbWVudHMgaW4gdGhlIHJvd1xuUm93LnByb3RvdHlwZS5ub3JtYWxpemVIZWlnaHQgPSBmdW5jdGlvbiAoZm9yY2UpIHtcblxuXHRpZiAoZm9yY2UpIHtcblx0XHR0aGlzLmNsZWFyQ2VsbEhlaWdodCgpO1xuXHR9XG5cblx0dGhpcy5jYWxjSGVpZ2h0KGZvcmNlKTtcblxuXHR0aGlzLnNldENlbGxIZWlnaHQoKTtcbn07XG5cbi8vIFJvdy5wcm90b3R5cGUuc2V0SGVpZ2h0ID0gZnVuY3Rpb24oaGVpZ2h0KXtcbi8vIFx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cbi8vIFx0dGhpcy5zZXRDZWxsSGVpZ2h0KCk7XG4vLyB9O1xuXG4vL3NldCBoZWlnaHQgb2Ygcm93c1xuUm93LnByb3RvdHlwZS5zZXRIZWlnaHQgPSBmdW5jdGlvbiAoaGVpZ2h0LCBmb3JjZSkge1xuXHRpZiAodGhpcy5oZWlnaHQgIT0gaGVpZ2h0IHx8IGZvcmNlKSB7XG5cblx0XHR0aGlzLm1hbnVhbEhlaWdodCA9IHRydWU7XG5cblx0XHR0aGlzLmhlaWdodCA9IGhlaWdodDtcblx0XHR0aGlzLmhlaWdodFN0eWxlZCA9IGhlaWdodCA/IGhlaWdodCArIFwicHhcIiA6IFwiXCI7XG5cblx0XHR0aGlzLnNldENlbGxIZWlnaHQoKTtcblxuXHRcdC8vIHRoaXMub3V0ZXJIZWlnaHQgPSB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKTtcblx0XHR0aGlzLm91dGVySGVpZ2h0ID0gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcblx0fVxufTtcblxuLy9yZXR1cm4gcm93cyBvdXRlciBoZWlnaHRcblJvdy5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5vdXRlckhlaWdodDtcbn07XG5cbi8vcmV0dXJuIHJvd3Mgb3V0ZXIgV2lkdGhcblJvdy5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmVsZW1lbnQub2Zmc2V0V2lkdGg7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIENlbGwgTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vLy8vL1xuXG5Sb3cucHJvdG90eXBlLmRlbGV0ZUNlbGwgPSBmdW5jdGlvbiAoY2VsbCkge1xuXHR2YXIgaW5kZXggPSB0aGlzLmNlbGxzLmluZGV4T2YoY2VsbCk7XG5cblx0aWYgKGluZGV4ID4gLTEpIHtcblx0XHR0aGlzLmNlbGxzLnNwbGljZShpbmRleCwgMSk7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8gRGF0YSBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vLy8vXG5cblJvdy5wcm90b3R5cGUuc2V0RGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm11dGF0b3JcIikpIHtcblx0XHRkYXRhID0gdGhpcy50YWJsZS5tb2R1bGVzLm11dGF0b3IudHJhbnNmb3JtUm93KGRhdGEsIFwiZGF0YVwiKTtcblx0fVxuXG5cdHRoaXMuZGF0YSA9IGRhdGE7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZWFjdGl2ZURhdGEgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZWFjdGl2ZURhdGFcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVhY3RpdmVEYXRhLndhdGNoUm93KHRoaXMpO1xuXHR9XG59O1xuXG4vL3VwZGF0ZSB0aGUgcm93cyBkYXRhXG5Sb3cucHJvdG90eXBlLnVwZGF0ZURhdGEgPSBmdW5jdGlvbiAodXBkYXRlZERhdGEpIHtcblx0dmFyIF90aGlzMjIgPSB0aGlzO1xuXG5cdHZhciB2aXNpYmxlID0gdGhpcy5lbGVtZW50ICYmIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbFZpc2libGUodGhpcy5lbGVtZW50KSxcblx0ICAgIHRlbXBEYXRhID0ge30sXG5cdCAgICBuZXdSb3dEYXRhO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblx0XHRpZiAodHlwZW9mIHVwZGF0ZWREYXRhID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHR1cGRhdGVkRGF0YSA9IEpTT04ucGFyc2UodXBkYXRlZERhdGEpO1xuXHRcdH1cblxuXHRcdGlmIChfdGhpczIyLnRhYmxlLm9wdGlvbnMucmVhY3RpdmVEYXRhICYmIF90aGlzMjIudGFibGUubW9kRXhpc3RzKFwicmVhY3RpdmVEYXRhXCIsIHRydWUpKSB7XG5cdFx0XHRfdGhpczIyLnRhYmxlLm1vZHVsZXMucmVhY3RpdmVEYXRhLmJsb2NrKCk7XG5cdFx0fVxuXG5cdFx0Ly9tdXRhdGUgaW5jb21taW5nIGRhdGEgaWYgbmVlZGVkXG5cdFx0aWYgKF90aGlzMjIudGFibGUubW9kRXhpc3RzKFwibXV0YXRvclwiKSkge1xuXG5cdFx0XHR0ZW1wRGF0YSA9IE9iamVjdC5hc3NpZ24odGVtcERhdGEsIF90aGlzMjIuZGF0YSk7XG5cdFx0XHR0ZW1wRGF0YSA9IE9iamVjdC5hc3NpZ24odGVtcERhdGEsIHVwZGF0ZWREYXRhKTtcblxuXHRcdFx0bmV3Um93RGF0YSA9IF90aGlzMjIudGFibGUubW9kdWxlcy5tdXRhdG9yLnRyYW5zZm9ybVJvdyh0ZW1wRGF0YSwgXCJkYXRhXCIsIHVwZGF0ZWREYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3Um93RGF0YSA9IHVwZGF0ZWREYXRhO1xuXHRcdH1cblxuXHRcdC8vc2V0IGRhdGFcblx0XHRmb3IgKHZhciBhdHRybmFtZSBpbiBuZXdSb3dEYXRhKSB7XG5cdFx0XHRfdGhpczIyLmRhdGFbYXR0cm5hbWVdID0gbmV3Um93RGF0YVthdHRybmFtZV07XG5cdFx0fVxuXG5cdFx0aWYgKF90aGlzMjIudGFibGUub3B0aW9ucy5yZWFjdGl2ZURhdGEgJiYgX3RoaXMyMi50YWJsZS5tb2RFeGlzdHMoXCJyZWFjdGl2ZURhdGFcIiwgdHJ1ZSkpIHtcblx0XHRcdF90aGlzMjIudGFibGUubW9kdWxlcy5yZWFjdGl2ZURhdGEudW5ibG9jaygpO1xuXHRcdH1cblxuXHRcdC8vdXBkYXRlIGFmZmVjdGVkIGNlbGxzIG9ubHlcblx0XHRmb3IgKHZhciBhdHRybmFtZSBpbiB1cGRhdGVkRGF0YSkge1xuXG5cdFx0XHR2YXIgY29sdW1ucyA9IF90aGlzMjIudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5zQnlGaWVsZFJvb3QoYXR0cm5hbWUpO1xuXG5cdFx0XHRjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0XHR2YXIgY2VsbCA9IF90aGlzMjIuZ2V0Q2VsbChjb2x1bW4uZ2V0RmllbGQoKSk7XG5cblx0XHRcdFx0aWYgKGNlbGwpIHtcblx0XHRcdFx0XHR2YXIgdmFsdWUgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShuZXdSb3dEYXRhKTtcblx0XHRcdFx0XHRpZiAoY2VsbC5nZXRWYWx1ZSgpICE9IHZhbHVlKSB7XG5cdFx0XHRcdFx0XHRjZWxsLnNldFZhbHVlUHJvY2Vzc0RhdGEodmFsdWUpO1xuXG5cdFx0XHRcdFx0XHRpZiAodmlzaWJsZSkge1xuXHRcdFx0XHRcdFx0XHRjZWxsLmNlbGxSZW5kZXJlZCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKF90aGlzMjIudGFibGUub3B0aW9ucy5ncm91cFVwZGF0ZU9uQ2VsbEVkaXQgJiYgX3RoaXMyMi50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgX3RoaXMyMi50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHRcdF90aGlzMjIudGFibGUubW9kdWxlcy5ncm91cFJvd3MucmVhc3NpZ25Sb3dUb0dyb3VwKF90aGlzMjIucm93KTtcblx0XHR9XG5cblx0XHQvL1BhcnRpYWwgcmVpbml0aWFsaXphdGlvbiBpZiB2aXNpYmxlXG5cdFx0aWYgKHZpc2libGUpIHtcblx0XHRcdF90aGlzMjIubm9ybWFsaXplSGVpZ2h0KHRydWUpO1xuXG5cdFx0XHRpZiAoX3RoaXMyMi50YWJsZS5vcHRpb25zLnJvd0Zvcm1hdHRlcikge1xuXHRcdFx0XHRfdGhpczIyLnRhYmxlLm9wdGlvbnMucm93Rm9ybWF0dGVyKF90aGlzMjIuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRfdGhpczIyLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0XHRfdGhpczIyLmhlaWdodCA9IDA7XG5cdFx0XHRfdGhpczIyLmhlaWdodFN0eWxlZCA9IFwiXCI7XG5cdFx0fVxuXG5cdFx0aWYgKF90aGlzMjIudGFibGUub3B0aW9ucy5kYXRhVHJlZSAhPT0gZmFsc2UgJiYgX3RoaXMyMi50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiKSAmJiBfdGhpczIyLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUucmVkcmF3TmVlZGVkKHVwZGF0ZWREYXRhKSkge1xuXHRcdFx0X3RoaXMyMi50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmluaXRpYWxpemVSb3coX3RoaXMyMik7XG5cblx0XHRcdGlmICh2aXNpYmxlKSB7XG5cdFx0XHRcdF90aGlzMjIudGFibGUubW9kdWxlcy5kYXRhVHJlZS5sYXlvdXRSb3coX3RoaXMyMik7XG5cdFx0XHRcdF90aGlzMjIudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcInRyZWVcIiwgZmFsc2UsIHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vdGhpcy5yZWluaXRpYWxpemUoKTtcblxuXHRcdF90aGlzMjIudGFibGUub3B0aW9ucy5yb3dVcGRhdGVkLmNhbGwoX3RoaXMyMi50YWJsZSwgX3RoaXMyMi5nZXRDb21wb25lbnQoKSk7XG5cblx0XHRpZiAoX3RoaXMyMi50YWJsZS5vcHRpb25zLmRhdGFDaGFuZ2VkKSB7XG5cdFx0XHRfdGhpczIyLnRhYmxlLm9wdGlvbnMuZGF0YUNoYW5nZWQuY2FsbChfdGhpczIyLnRhYmxlLCBfdGhpczIyLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGF0YSgpKTtcblx0XHR9XG5cblx0XHRyZXNvbHZlKCk7XG5cdH0pO1xufTtcblxuUm93LnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKHRyYW5zZm9ybSkge1xuXHRpZiAodHJhbnNmb3JtKSB7XG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiYWNjZXNzb3JcIikpIHtcblx0XHRcdHJldHVybiB0aGlzLnRhYmxlLm1vZHVsZXMuYWNjZXNzb3IudHJhbnNmb3JtUm93KHRoaXMsIHRyYW5zZm9ybSk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoaXMuZGF0YTtcbn07XG5cblJvdy5wcm90b3R5cGUuZ2V0Q2VsbCA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIG1hdGNoID0gZmFsc2U7XG5cblx0Y29sdW1uID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oY29sdW1uKTtcblxuXHRtYXRjaCA9IHRoaXMuY2VsbHMuZmluZChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdHJldHVybiBjZWxsLmNvbHVtbiA9PT0gY29sdW1uO1xuXHR9KTtcblxuXHRyZXR1cm4gbWF0Y2g7XG59O1xuXG5Sb3cucHJvdG90eXBlLmdldENlbGxJbmRleCA9IGZ1bmN0aW9uIChmaW5kQ2VsbCkge1xuXHRyZXR1cm4gdGhpcy5jZWxscy5maW5kSW5kZXgoZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRyZXR1cm4gY2VsbCA9PT0gZmluZENlbGw7XG5cdH0pO1xufTtcblxuUm93LnByb3RvdHlwZS5maW5kTmV4dEVkaXRhYmxlQ2VsbCA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHR2YXIgbmV4dENlbGwgPSBmYWxzZTtcblxuXHRpZiAoaW5kZXggPCB0aGlzLmNlbGxzLmxlbmd0aCAtIDEpIHtcblx0XHRmb3IgKHZhciBpID0gaW5kZXggKyAxOyBpIDwgdGhpcy5jZWxscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGNlbGwgPSB0aGlzLmNlbGxzW2ldO1xuXG5cdFx0XHRpZiAoY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0ICYmIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbFZpc2libGUoY2VsbC5nZXRFbGVtZW50KCkpKSB7XG5cdFx0XHRcdHZhciBhbGxvd0VkaXQgPSB0cnVlO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRcdGFsbG93RWRpdCA9IGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdC5jaGVjayhjZWxsLmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChhbGxvd0VkaXQpIHtcblx0XHRcdFx0XHRuZXh0Q2VsbCA9IGNlbGw7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gbmV4dENlbGw7XG59O1xuXG5Sb3cucHJvdG90eXBlLmZpbmRQcmV2RWRpdGFibGVDZWxsID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdHZhciBwcmV2Q2VsbCA9IGZhbHNlO1xuXG5cdGlmIChpbmRleCA+IDApIHtcblx0XHRmb3IgKHZhciBpID0gaW5kZXggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0dmFyIGNlbGwgPSB0aGlzLmNlbGxzW2ldLFxuXHRcdFx0ICAgIGFsbG93RWRpdCA9IHRydWU7XG5cblx0XHRcdGlmIChjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQgJiYgVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmVsVmlzaWJsZShjZWxsLmdldEVsZW1lbnQoKSkpIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQuY2hlY2sgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0YWxsb3dFZGl0ID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKGFsbG93RWRpdCkge1xuXHRcdFx0XHRcdHByZXZDZWxsID0gY2VsbDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBwcmV2Q2VsbDtcbn07XG5cblJvdy5wcm90b3R5cGUuZ2V0Q2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmNlbGxzO1xufTtcblxuUm93LnByb3RvdHlwZS5uZXh0Um93ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLm5leHREaXNwbGF5Um93KHRoaXMsIHRydWUpO1xuXHRyZXR1cm4gcm93IHx8IGZhbHNlO1xufTtcblxuUm93LnByb3RvdHlwZS5wcmV2Um93ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgcm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnByZXZEaXNwbGF5Um93KHRoaXMsIHRydWUpO1xuXHRyZXR1cm4gcm93IHx8IGZhbHNlO1xufTtcblxuUm93LnByb3RvdHlwZS5tb3ZlVG9Sb3cgPSBmdW5jdGlvbiAodG8sIGJlZm9yZSkge1xuXHR2YXIgdG9Sb3cgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZmluZFJvdyh0byk7XG5cblx0aWYgKHRvUm93KSB7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLm1vdmVSb3dBY3R1YWwodGhpcywgdG9Sb3csICFiZWZvcmUpO1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImRpc3BsYXlcIiwgZmFsc2UsIHRydWUpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIk1vdmUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIHRvKTtcblx0fVxufTtcblxuUm93LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGludmFsaWQgPSBbXTtcblxuXHR0aGlzLmNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRpZiAoIWNlbGwudmFsaWRhdGUoKSkge1xuXHRcdFx0aW52YWxpZC5wdXNoKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGludmFsaWQubGVuZ3RoID8gaW52YWxpZCA6IHRydWU7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQWN0aW9ucyAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblJvdy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXMyMyA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgaW5kZXgsIHJvd3M7XG5cblx0XHRpZiAoX3RoaXMyMy50YWJsZS5vcHRpb25zLmhpc3RvcnkgJiYgX3RoaXMyMy50YWJsZS5tb2RFeGlzdHMoXCJoaXN0b3J5XCIpKSB7XG5cblx0XHRcdGlmIChfdGhpczIzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiBfdGhpczIzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXHRcdFx0XHRyb3dzID0gX3RoaXMyMy5nZXRHcm91cCgpLnJvd3M7XG5cdFx0XHRcdGluZGV4ID0gcm93cy5pbmRleE9mKF90aGlzMjMpO1xuXG5cdFx0XHRcdGlmIChpbmRleCkge1xuXHRcdFx0XHRcdGluZGV4ID0gcm93c1tpbmRleCAtIDFdO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpbmRleCA9IF90aGlzMjMudGFibGUucm93TWFuYWdlci5nZXRSb3dJbmRleChfdGhpczIzKTtcblxuXHRcdFx0XHRpZiAoaW5kZXgpIHtcblx0XHRcdFx0XHRpbmRleCA9IF90aGlzMjMudGFibGUucm93TWFuYWdlci5yb3dzW2luZGV4IC0gMV07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0X3RoaXMyMy50YWJsZS5tb2R1bGVzLmhpc3RvcnkuYWN0aW9uKFwicm93RGVsZXRlXCIsIF90aGlzMjMsIHsgZGF0YTogX3RoaXMyMy5nZXREYXRhKCksIHBvczogIWluZGV4LCBpbmRleDogaW5kZXggfSk7XG5cdFx0fVxuXG5cdFx0X3RoaXMyMy5kZWxldGVBY3R1YWwoKTtcblxuXHRcdHJlc29sdmUoKTtcblx0fSk7XG59O1xuXG5Sb3cucHJvdG90eXBlLmRlbGV0ZUFjdHVhbCA9IGZ1bmN0aW9uIChibG9ja1JlZHJhdykge1xuXHR2YXIgaW5kZXggPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93SW5kZXgodGhpcyk7XG5cblx0dGhpcy5kZXRhdGNoTW9kdWxlcygpO1xuXG5cdC8vIGlmKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIpKXtcblx0Ly8gXHR0aGlzLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUuY29sbGFwc2VSb3codGhpcywgdHJ1ZSk7XG5cdC8vIH1cblxuXHQvL3JlbW92ZSBhbnkgcmVhY3RpdmUgZGF0YSB3YXRjaGVycyBmcm9tIHJvdyBvYmplY3Rcblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZWFjdGl2ZURhdGEgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZWFjdGl2ZURhdGFcIiwgdHJ1ZSkpIHt9XG5cdC8vIHRoaXMudGFibGUubW9kdWxlcy5yZWFjdGl2ZURhdGEudW53YXRjaFJvdyh0aGlzKTtcblxuXG5cdC8vcmVtb3ZlIGZyb20gZ3JvdXBcblx0aWYgKHRoaXMubW9kdWxlcy5ncm91cCkge1xuXHRcdHRoaXMubW9kdWxlcy5ncm91cC5yZW1vdmVSb3codGhpcyk7XG5cdH1cblxuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZGVsZXRlUm93KHRoaXMsIGJsb2NrUmVkcmF3KTtcblxuXHR0aGlzLmRlbGV0ZUNlbGxzKCk7XG5cblx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xuXHR0aGlzLmhlaWdodEluaXRpYWxpemVkID0gZmFsc2U7XG5cdHRoaXMuZWxlbWVudCA9IGZhbHNlO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiLCB0cnVlKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5kYXRhVHJlZS5yb3dEZWxldGUodGhpcyk7XG5cdH1cblxuXHQvL3JlY2FsYyBjb2x1bW4gY2FsY3VsYXRpb25zIGlmIHByZXNlbnRcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5yZWNhbGNSb3dHcm91cCh0aGlzKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsYyh0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWN0aXZlUm93cyk7XG5cdFx0fVxuXHR9XG59O1xuXG5Sb3cucHJvdG90eXBlLmRldGF0Y2hNb2R1bGVzID0gZnVuY3Rpb24gKCkge1xuXHQvL2Rlc2VsZWN0IHJvdyBpZiBpdCBpcyBzZWxlY3RlZFxuXHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJzZWxlY3RSb3dcIikpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93Ll9kZXNlbGVjdFJvdyh0aGlzLCB0cnVlKTtcblx0fVxuXG5cdC8vY2FuY2VsIGVkaXQgaWYgcm93IGlzIGN1cnJlbnRseSBiZWluZyBlZGl0ZWRcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdGlmICh0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbC5yb3cgPT09IHRoaXMpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmNhbmNlbEVkaXQoKTtcblx0XHR9XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmcm96ZW5Sb3dzXCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmZyb3plblJvd3MuZGV0YWNoUm93KHRoaXMpO1xuXHR9XG59O1xuXG5Sb3cucHJvdG90eXBlLmRlbGV0ZUNlbGxzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgY2VsbENvdW50ID0gdGhpcy5jZWxscy5sZW5ndGg7XG5cblx0Zm9yICh2YXIgX2k4ID0gMDsgX2k4IDwgY2VsbENvdW50OyBfaTgrKykge1xuXHRcdHRoaXMuY2VsbHNbMF0uZGVsZXRlKCk7XG5cdH1cbn07XG5cblJvdy5wcm90b3R5cGUud2lwZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5kZXRhdGNoTW9kdWxlcygpO1xuXHR0aGlzLmRlbGV0ZUNlbGxzKCk7XG5cblx0aWYgKHRoaXMuZWxlbWVudCkge1xuXHRcdHdoaWxlICh0aGlzLmVsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdFx0dGhpcy5lbGVtZW50LnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudC5maXJzdENoaWxkKTtcblx0XHR9aWYgKHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMuZWxlbWVudCA9IGZhbHNlO1xuXHR0aGlzLm1vZHVsZXMgPSB7fTtcbn07XG5cblJvdy5wcm90b3R5cGUuZ2V0R3JvdXAgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLm1vZHVsZXMuZ3JvdXAgfHwgZmFsc2U7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5Sb3cucHJvdG90eXBlLmdldENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKCF0aGlzLmNvbXBvbmVudCkge1xuXHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IFJvd0NvbXBvbmVudCh0aGlzKTtcblx0fVxuXG5cdHJldHVybiB0aGlzLmNvbXBvbmVudDtcbn07XG5cbi8vcHVibGljIHJvdyBvYmplY3RcbnZhciBDZWxsQ29tcG9uZW50ID0gZnVuY3Rpb24gQ2VsbENvbXBvbmVudChjZWxsKSB7XG5cdHRoaXMuX2NlbGwgPSBjZWxsO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9jZWxsLmdldFZhbHVlKCk7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5nZXRPbGRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NlbGwuZ2V0T2xkVmFsdWUoKTtcbn07XG5cbkNlbGxDb21wb25lbnQucHJvdG90eXBlLmdldEluaXRpYWxWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NlbGwuaW5pdGlhbFZhbHVlO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuZ2V0RWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NlbGwuZ2V0RWxlbWVudCgpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY2VsbC5yb3cuZ2V0Q29tcG9uZW50KCk7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5nZXREYXRhID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY2VsbC5yb3cuZ2V0RGF0YSgpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuZ2V0RmllbGQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9jZWxsLmNvbHVtbi5nZXRGaWVsZCgpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q29sdW1uID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY2VsbC5jb2x1bW4uZ2V0Q29tcG9uZW50KCk7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgbXV0YXRlKSB7XG5cdGlmICh0eXBlb2YgbXV0YXRlID09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRtdXRhdGUgPSB0cnVlO1xuXHR9XG5cblx0dGhpcy5fY2VsbC5zZXRWYWx1ZSh2YWx1ZSwgbXV0YXRlKTtcbn07XG5cbkNlbGxDb21wb25lbnQucHJvdG90eXBlLnJlc3RvcmVPbGRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fY2VsbC5zZXRWYWx1ZUFjdHVhbCh0aGlzLl9jZWxsLmdldE9sZFZhbHVlKCkpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUucmVzdG9yZUluaXRpYWxWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fY2VsbC5zZXRWYWx1ZUFjdHVhbCh0aGlzLl9jZWxsLmluaXRpYWxWYWx1ZSk7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5lZGl0ID0gZnVuY3Rpb24gKGZvcmNlKSB7XG5cdHJldHVybiB0aGlzLl9jZWxsLmVkaXQoZm9yY2UpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuY2FuY2VsRWRpdCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fY2VsbC5jYW5jZWxFZGl0KCk7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5pc0VkaXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuICEhdGhpcy5fY2VsbC5tb2R1bGVzLmVkaXQgJiYgdGhpcy5fY2VsbC5tb2R1bGVzLmVkaXQuZWRpdGVkO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuY2xlYXJFZGl0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdGlmIChzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLl9jZWxsLnRhYmxlLm1vZHVsZXMuZWRpdC5jbGVhckVkaXRlZCh0aGlzLl9jZWxsKTtcblx0fVxufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuaXNWYWxpZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NlbGwubW9kdWxlcy52YWxpZGF0ZSA/ICF0aGlzLl9jZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA6IHRydWU7XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2NlbGwudmFsaWRhdGUoKTtcbn07XG5cbkNlbGxDb21wb25lbnQucHJvdG90eXBlLmNsZWFyVmFsaWRhdGlvbiA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuX2NlbGwudGFibGUubW9kRXhpc3RzKFwidmFsaWRhdGVcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLl9jZWxsLnRhYmxlLm1vZHVsZXMudmFsaWRhdGUuY2xlYXJWYWxpZGF0aW9uKHRoaXMuX2NlbGwpO1xuXHR9XG59O1xuXG5DZWxsQ29tcG9uZW50LnByb3RvdHlwZS5uYXYgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9jZWxsLm5hdigpO1xufTtcblxuQ2VsbENvbXBvbmVudC5wcm90b3R5cGUuY2hlY2tIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX2NlbGwuY2hlY2tIZWlnaHQoKTtcbn07XG5cbkNlbGxDb21wb25lbnQucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY2VsbC50YWJsZTtcbn07XG5cbkNlbGxDb21wb25lbnQucHJvdG90eXBlLl9nZXRTZWxmID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fY2VsbDtcbn07XG5cbnZhciBDZWxsID0gZnVuY3Rpb24gQ2VsbChjb2x1bW4sIHJvdykge1xuXG5cdHRoaXMudGFibGUgPSBjb2x1bW4udGFibGU7XG5cdHRoaXMuY29sdW1uID0gY29sdW1uO1xuXHR0aGlzLnJvdyA9IHJvdztcblx0dGhpcy5lbGVtZW50ID0gbnVsbDtcblx0dGhpcy52YWx1ZSA9IG51bGw7XG5cdHRoaXMuaW5pdGlhbFZhbHVlO1xuXHR0aGlzLm9sZFZhbHVlID0gbnVsbDtcblx0dGhpcy5tb2R1bGVzID0ge307XG5cblx0dGhpcy5oZWlnaHQgPSBudWxsO1xuXHR0aGlzLndpZHRoID0gbnVsbDtcblx0dGhpcy5taW5XaWR0aCA9IG51bGw7XG5cblx0dGhpcy5jb21wb25lbnQgPSBudWxsO1xuXG5cdHRoaXMubG9hZGVkID0gZmFsc2U7IC8vdHJhY2sgaWYgdGhlIGNlbGwgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIERPTSB5ZXRcblxuXHR0aGlzLmJ1aWxkKCk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIFNldHVwIEZ1bmN0aW9ucyAvLy8vLy8vLy8vLy8vLy8vL1xuXG4vL2dlbmVyYXRlIGVsZW1lbnRcbkNlbGwucHJvdG90eXBlLmJ1aWxkID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmdlbmVyYXRlRWxlbWVudCgpO1xuXG5cdHRoaXMuc2V0V2lkdGgoKTtcblxuXHR0aGlzLl9jb25maWd1cmVDZWxsKCk7XG5cblx0dGhpcy5zZXRWYWx1ZUFjdHVhbCh0aGlzLmNvbHVtbi5nZXRGaWVsZFZhbHVlKHRoaXMucm93LmRhdGEpKTtcblxuXHR0aGlzLmluaXRpYWxWYWx1ZSA9IHRoaXMudmFsdWU7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5nZW5lcmF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHR0aGlzLmVsZW1lbnQuY2xhc3NOYW1lID0gXCJ0YWJ1bGF0b3ItY2VsbFwiO1xuXHR0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImdyaWRjZWxsXCIpO1xuXHR0aGlzLmVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5fY29uZmlndXJlQ2VsbCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY2VsbEV2ZW50cyA9IHNlbGYuY29sdW1uLmNlbGxFdmVudHMsXG5cdCAgICBlbGVtZW50ID0gc2VsZi5lbGVtZW50LFxuXHQgICAgZmllbGQgPSB0aGlzLmNvbHVtbi5nZXRGaWVsZCgpLFxuXHQgICAgdmVydEFsaWducyA9IHtcblx0XHR0b3A6IFwiZmxleC1zdGFydFwiLFxuXHRcdGJvdHRvbTogXCJmbGV4LWVuZFwiLFxuXHRcdG1pZGRsZTogXCJjZW50ZXJcIlxuXHR9LFxuXHQgICAgaG96QWxpZ25zID0ge1xuXHRcdGxlZnQ6IFwiZmxleC1zdGFydFwiLFxuXHRcdHJpZ2h0OiBcImZsZXgtZW5kXCIsXG5cdFx0Y2VudGVyOiBcImNlbnRlclwiXG5cdH07XG5cblx0Ly9zZXQgdGV4dCBhbGlnbm1lbnRcblx0ZWxlbWVudC5zdHlsZS50ZXh0QWxpZ24gPSBzZWxmLmNvbHVtbi5ob3pBbGlnbjtcblxuXHRpZiAoc2VsZi5jb2x1bW4udmVydEFsaWduKSB7XG5cdFx0ZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtZmxleFwiO1xuXG5cdFx0ZWxlbWVudC5zdHlsZS5hbGlnbkl0ZW1zID0gdmVydEFsaWduc1tzZWxmLmNvbHVtbi52ZXJ0QWxpZ25dIHx8IFwiXCI7XG5cblx0XHRpZiAoc2VsZi5jb2x1bW4uaG96QWxpZ24pIHtcblx0XHRcdGVsZW1lbnQuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSBob3pBbGlnbnNbc2VsZi5jb2x1bW4uaG96QWxpZ25dIHx8IFwiXCI7XG5cdFx0fVxuXHR9XG5cblx0aWYgKGZpZWxkKSB7XG5cdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0YWJ1bGF0b3ItZmllbGRcIiwgZmllbGQpO1xuXHR9XG5cblx0Ly9hZGQgY2xhc3MgdG8gY2VsbCBpZiBuZWVkZWRcblx0aWYgKHNlbGYuY29sdW1uLmRlZmluaXRpb24uY3NzQ2xhc3MpIHtcblx0XHR2YXIgY2xhc3NOYW1lcyA9IHNlbGYuY29sdW1uLmRlZmluaXRpb24uY3NzQ2xhc3Muc3BsaXQoXCIgXCIpO1xuXHRcdGNsYXNzTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoY2xhc3NOYW1lKSB7XG5cdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHR9KTtcblx0fVxuXG5cdC8vdXBkYXRlIHRvb2x0aXAgb24gbW91c2UgZW50ZXJcblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy50b29sdGlwR2VuZXJhdGlvbk1vZGUgPT09IFwiaG92ZXJcIikge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYuX2dlbmVyYXRlVG9vbHRpcCgpO1xuXHRcdH0pO1xuXHR9XG5cblx0c2VsZi5fYmluZENsaWNrRXZlbnRzKGNlbGxFdmVudHMpO1xuXG5cdHNlbGYuX2JpbmRUb3VjaEV2ZW50cyhjZWxsRXZlbnRzKTtcblxuXHRzZWxmLl9iaW5kTW91c2VFdmVudHMoY2VsbEV2ZW50cyk7XG5cblx0aWYgKHNlbGYuY29sdW1uLm1vZHVsZXMuZWRpdCkge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5lZGl0LmJpbmRFZGl0b3Ioc2VsZik7XG5cdH1cblxuXHRpZiAoc2VsZi5jb2x1bW4uZGVmaW5pdGlvbi5yb3dIYW5kbGUgJiYgc2VsZi50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzICE9PSBmYWxzZSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcIm1vdmVSb3dcIikpIHtcblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMubW92ZVJvdy5pbml0aWFsaXplQ2VsbChzZWxmKTtcblx0fVxuXG5cdC8vaGlkZSBjZWxsIGlmIG5vdCB2aXNpYmxlXG5cdGlmICghc2VsZi5jb2x1bW4udmlzaWJsZSkge1xuXHRcdHNlbGYuaGlkZSgpO1xuXHR9XG59O1xuXG5DZWxsLnByb3RvdHlwZS5fYmluZENsaWNrRXZlbnRzID0gZnVuY3Rpb24gKGNlbGxFdmVudHMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZWxlbWVudCA9IHNlbGYuZWxlbWVudDtcblxuXHQvL3NldCBldmVudCBiaW5kaW5nc1xuXHRpZiAoY2VsbEV2ZW50cy5jZWxsQ2xpY2sgfHwgc2VsZi50YWJsZS5vcHRpb25zLmNlbGxDbGljaykge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbENsaWNrKSB7XG5cdFx0XHRcdGNlbGxFdmVudHMuY2VsbENsaWNrLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5jZWxsQ2xpY2spIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxDbGljay5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoY2VsbEV2ZW50cy5jZWxsRGJsQ2xpY2sgfHwgdGhpcy50YWJsZS5vcHRpb25zLmNlbGxEYmxDbGljaykge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbERibENsaWNrKSB7XG5cdFx0XHRcdGNlbGxFdmVudHMuY2VsbERibENsaWNrLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5jZWxsRGJsQ2xpY2spIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxEYmxDbGljay5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblxuXHRcdFx0aWYgKHNlbGYudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdFx0XHRpZiAoc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwgPT09IHNlbGYpIHtcblx0XHRcdFx0XHRyZXR1cm47IC8vcHJldmVudCBpbnN0YW50IHNlbGVjdGlvbiBvZiBlZGl0b3IgY29udGVudFxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0aWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuXHRcdFx0XHRcdC8vIElFXG5cdFx0XHRcdFx0dmFyIHJhbmdlID0gZG9jdW1lbnQuYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcblx0XHRcdFx0XHRyYW5nZS5tb3ZlVG9FbGVtZW50VGV4dChzZWxmLmVsZW1lbnQpO1xuXHRcdFx0XHRcdHJhbmdlLnNlbGVjdCgpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcblx0XHRcdFx0XHR2YXIgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuXHRcdFx0XHRcdHJhbmdlLnNlbGVjdE5vZGUoc2VsZi5lbGVtZW50KTtcblx0XHRcdFx0XHR3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHRcdFx0d2luZG93LmdldFNlbGVjdGlvbigpLmFkZFJhbmdlKHJhbmdlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge31cblx0XHR9KTtcblx0fVxuXG5cdGlmIChjZWxsRXZlbnRzLmNlbGxDb250ZXh0IHx8IHRoaXMudGFibGUub3B0aW9ucy5jZWxsQ29udGV4dCkge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbENvbnRleHQpIHtcblx0XHRcdFx0Y2VsbEV2ZW50cy5jZWxsQ29udGV4dC5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbENvbnRleHQpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxDb250ZXh0LmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufTtcblxuQ2VsbC5wcm90b3R5cGUuX2JpbmRNb3VzZUV2ZW50cyA9IGZ1bmN0aW9uIChjZWxsRXZlbnRzKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGVsZW1lbnQgPSBzZWxmLmVsZW1lbnQ7XG5cblx0aWYgKGNlbGxFdmVudHMuY2VsbE1vdXNlRW50ZXIgfHwgc2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZUVudGVyKSB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dmFyIGNvbXBvbmVudCA9IHNlbGYuZ2V0Q29tcG9uZW50KCk7XG5cblx0XHRcdGlmIChjZWxsRXZlbnRzLmNlbGxNb3VzZUVudGVyKSB7XG5cdFx0XHRcdGNlbGxFdmVudHMuY2VsbE1vdXNlRW50ZXIuY2FsbChzZWxmLnRhYmxlLCBlLCBjb21wb25lbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZUVudGVyKSB7XG5cdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5jZWxsTW91c2VFbnRlci5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoY2VsbEV2ZW50cy5jZWxsTW91c2VMZWF2ZSB8fCBzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbE1vdXNlTGVhdmUpIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbE1vdXNlTGVhdmUpIHtcblx0XHRcdFx0Y2VsbEV2ZW50cy5jZWxsTW91c2VMZWF2ZS5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbE1vdXNlTGVhdmUpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZUxlYXZlLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdGlmIChjZWxsRXZlbnRzLmNlbGxNb3VzZU92ZXIgfHwgc2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZU92ZXIpIHtcblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHZhciBjb21wb25lbnQgPSBzZWxmLmdldENvbXBvbmVudCgpO1xuXG5cdFx0XHRpZiAoY2VsbEV2ZW50cy5jZWxsTW91c2VPdmVyKSB7XG5cdFx0XHRcdGNlbGxFdmVudHMuY2VsbE1vdXNlT3Zlci5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbE1vdXNlT3Zlcikge1xuXHRcdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbE1vdXNlT3Zlci5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoY2VsbEV2ZW50cy5jZWxsTW91c2VPdXQgfHwgc2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZU91dCkge1xuXHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbE1vdXNlT3V0KSB7XG5cdFx0XHRcdGNlbGxFdmVudHMuY2VsbE1vdXNlT3V0LmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5jZWxsTW91c2VPdXQpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZU91dC5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoY2VsbEV2ZW50cy5jZWxsTW91c2VNb3ZlIHx8IHNlbGYudGFibGUub3B0aW9ucy5jZWxsTW91c2VNb3ZlKSB7XG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0aWYgKGNlbGxFdmVudHMuY2VsbE1vdXNlTW92ZSkge1xuXHRcdFx0XHRjZWxsRXZlbnRzLmNlbGxNb3VzZU1vdmUuY2FsbChzZWxmLnRhYmxlLCBlLCBjb21wb25lbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZU1vdmUpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxNb3VzZU1vdmUuY2FsbChzZWxmLnRhYmxlLCBlLCBjb21wb25lbnQpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59O1xuXG5DZWxsLnByb3RvdHlwZS5fYmluZFRvdWNoRXZlbnRzID0gZnVuY3Rpb24gKGNlbGxFdmVudHMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZWxlbWVudCA9IHNlbGYuZWxlbWVudCxcblx0ICAgIGRibFRhcCxcblx0ICAgIHRhcEhvbGQsXG5cdCAgICB0YXA7XG5cblx0aWYgKGNlbGxFdmVudHMuY2VsbFRhcCB8fCB0aGlzLnRhYmxlLm9wdGlvbnMuY2VsbFRhcCkge1xuXHRcdHRhcCA9IGZhbHNlO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dGFwID0gdHJ1ZTtcblx0XHR9LCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKHRhcCkge1xuXHRcdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0XHRpZiAoY2VsbEV2ZW50cy5jZWxsVGFwKSB7XG5cdFx0XHRcdFx0Y2VsbEV2ZW50cy5jZWxsVGFwLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbFRhcCkge1xuXHRcdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5jZWxsVGFwLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0YXAgPSBmYWxzZTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChjZWxsRXZlbnRzLmNlbGxEYmxUYXAgfHwgdGhpcy50YWJsZS5vcHRpb25zLmNlbGxEYmxUYXApIHtcblx0XHRkYmxUYXAgPSBudWxsO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblxuXHRcdFx0aWYgKGRibFRhcCkge1xuXHRcdFx0XHRjbGVhclRpbWVvdXQoZGJsVGFwKTtcblx0XHRcdFx0ZGJsVGFwID0gbnVsbDtcblxuXHRcdFx0XHR2YXIgY29tcG9uZW50ID0gc2VsZi5nZXRDb21wb25lbnQoKTtcblxuXHRcdFx0XHRpZiAoY2VsbEV2ZW50cy5jZWxsRGJsVGFwKSB7XG5cdFx0XHRcdFx0Y2VsbEV2ZW50cy5jZWxsRGJsVGFwLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbERibFRhcCkge1xuXHRcdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy5jZWxsRGJsVGFwLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRkYmxUYXAgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQoZGJsVGFwKTtcblx0XHRcdFx0XHRkYmxUYXAgPSBudWxsO1xuXHRcdFx0XHR9LCAzMDApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0aWYgKGNlbGxFdmVudHMuY2VsbFRhcEhvbGQgfHwgdGhpcy50YWJsZS5vcHRpb25zLmNlbGxUYXBIb2xkKSB7XG5cdFx0dGFwSG9sZCA9IG51bGw7XG5cblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGFwSG9sZCk7XG5cblx0XHRcdHRhcEhvbGQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRhcEhvbGQpO1xuXHRcdFx0XHR0YXBIb2xkID0gbnVsbDtcblx0XHRcdFx0dGFwID0gZmFsc2U7XG5cdFx0XHRcdHZhciBjb21wb25lbnQgPSBzZWxmLmdldENvbXBvbmVudCgpO1xuXG5cdFx0XHRcdGlmIChjZWxsRXZlbnRzLmNlbGxUYXBIb2xkKSB7XG5cdFx0XHRcdFx0Y2VsbEV2ZW50cy5jZWxsVGFwSG9sZC5jYWxsKHNlbGYudGFibGUsIGUsIGNvbXBvbmVudCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmNlbGxUYXBIb2xkKSB7XG5cdFx0XHRcdFx0c2VsZi50YWJsZS5vcHRpb25zLmNlbGxUYXBIb2xkLmNhbGwoc2VsZi50YWJsZSwgZSwgY29tcG9uZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgMTAwMCk7XG5cdFx0fSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHRcdHRhcEhvbGQgPSBudWxsO1xuXHRcdH0pO1xuXHR9XG59O1xuXG4vL2dlbmVyYXRlIGNlbGwgY29udGVudHNcbkNlbGwucHJvdG90eXBlLl9nZW5lcmF0ZUNvbnRlbnRzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgdmFsO1xuXG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZvcm1hdFwiKSkge1xuXHRcdHZhbCA9IHRoaXMudGFibGUubW9kdWxlcy5mb3JtYXQuZm9ybWF0VmFsdWUodGhpcyk7XG5cdH0gZWxzZSB7XG5cdFx0dmFsID0gdGhpcy5lbGVtZW50LmlubmVySFRNTCA9IHRoaXMudmFsdWU7XG5cdH1cblxuXHRzd2l0Y2ggKHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbCkpIHtcblx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRpZiAodmFsIGluc3RhbmNlb2YgTm9kZSkge1xuXG5cdFx0XHRcdC8vY2xlYXIgcHJldmlvdXMgY2VsbCBjb250ZW50c1xuXHRcdFx0XHR3aGlsZSAodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRcdFx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFx0XHR9dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHZhbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmVsZW1lbnQuaW5uZXJIVE1MID0gXCJcIjtcblxuXHRcdFx0XHRpZiAodmFsICE9IG51bGwpIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJGb3JtYXQgRXJyb3IgLSBGb3JtYXR0ZXIgaGFzIHJldHVybmVkIGEgdHlwZSBvZiBvYmplY3QsIHRoZSBvbmx5IHZhbGlkIGZvcm1hdHRlciBvYmplY3QgcmV0dXJuIGlzIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBmb3JtYXR0ZXIgcmV0dXJuZWQ6XCIsIHZhbCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRjYXNlIFwibnVsbFwiOlxuXHRcdFx0dGhpcy5lbGVtZW50LmlubmVySFRNTCA9IFwiXCI7XG5cdFx0XHRicmVhaztcblx0XHRkZWZhdWx0OlxuXHRcdFx0dGhpcy5lbGVtZW50LmlubmVySFRNTCA9IHZhbDtcblx0fVxufTtcblxuQ2VsbC5wcm90b3R5cGUuY2VsbFJlbmRlcmVkID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmb3JtYXRcIikgJiYgdGhpcy50YWJsZS5tb2R1bGVzLmZvcm1hdC5jZWxsUmVuZGVyZWQpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZm9ybWF0LmNlbGxSZW5kZXJlZCh0aGlzKTtcblx0fVxufTtcblxuLy9nZW5lcmF0ZSB0b29sdGlwIHRleHRcbkNlbGwucHJvdG90eXBlLl9nZW5lcmF0ZVRvb2x0aXAgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciB0b29sdGlwID0gdGhpcy5jb2x1bW4udG9vbHRpcDtcblxuXHRpZiAodG9vbHRpcCkge1xuXHRcdGlmICh0b29sdGlwID09PSB0cnVlKSB7XG5cdFx0XHR0b29sdGlwID0gdGhpcy52YWx1ZTtcblx0XHR9IGVsc2UgaWYgKHR5cGVvZiB0b29sdGlwID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0dG9vbHRpcCA9IHRvb2x0aXAodGhpcy5nZXRDb21wb25lbnQoKSk7XG5cblx0XHRcdGlmICh0b29sdGlwID09PSBmYWxzZSkge1xuXHRcdFx0XHR0b29sdGlwID0gXCJcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIHRvb2x0aXAgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHRvb2x0aXAgPSBcIlwiO1xuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCB0b29sdGlwKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgXCJcIik7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vIEdldHRlcnMgLy8vLy8vLy8vLy8vLy8vLy8vLy9cbkNlbGwucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoY29udGFpbmVyT25seSkge1xuXHRpZiAoIXRoaXMubG9hZGVkKSB7XG5cdFx0dGhpcy5sb2FkZWQgPSB0cnVlO1xuXHRcdGlmICghY29udGFpbmVyT25seSkge1xuXHRcdFx0dGhpcy5sYXlvdXRFbGVtZW50KCk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoaXMuZWxlbWVudDtcbn07XG5cbkNlbGwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy52YWx1ZTtcbn07XG5cbkNlbGwucHJvdG90eXBlLmdldE9sZFZhbHVlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5vbGRWYWx1ZTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vIEFjdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuQ2VsbC5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIG11dGF0ZSkge1xuXG5cdHZhciBjaGFuZ2VkID0gdGhpcy5zZXRWYWx1ZVByb2Nlc3NEYXRhKHZhbHVlLCBtdXRhdGUpLFxuXHQgICAgY29tcG9uZW50O1xuXG5cdGlmIChjaGFuZ2VkKSB7XG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5oaXN0b3J5ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiaGlzdG9yeVwiKSkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmhpc3RvcnkuYWN0aW9uKFwiY2VsbEVkaXRcIiwgdGhpcywgeyBvbGRWYWx1ZTogdGhpcy5vbGRWYWx1ZSwgbmV3VmFsdWU6IHRoaXMudmFsdWUgfSk7XG5cdFx0fVxuXG5cdFx0Y29tcG9uZW50ID0gdGhpcy5nZXRDb21wb25lbnQoKTtcblxuXHRcdGlmICh0aGlzLmNvbHVtbi5jZWxsRXZlbnRzLmNlbGxFZGl0ZWQpIHtcblx0XHRcdHRoaXMuY29sdW1uLmNlbGxFdmVudHMuY2VsbEVkaXRlZC5jYWxsKHRoaXMudGFibGUsIGNvbXBvbmVudCk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5ncm91cFVwZGF0ZU9uQ2VsbEVkaXQgJiYgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3MucmVhc3NpZ25Sb3dUb0dyb3VwKHRoaXMucm93KTtcblx0XHR9XG5cblx0XHR0aGlzLmNlbGxSZW5kZXJlZCgpO1xuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLmNlbGxFZGl0ZWQuY2FsbCh0aGlzLnRhYmxlLCBjb21wb25lbnQpO1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5kYXRhQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmRhdGFDaGFuZ2VkLmNhbGwodGhpcy50YWJsZSwgdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERhdGEoKSk7XG5cdFx0fVxuXHR9XG59O1xuXG5DZWxsLnByb3RvdHlwZS5zZXRWYWx1ZVByb2Nlc3NEYXRhID0gZnVuY3Rpb24gKHZhbHVlLCBtdXRhdGUpIHtcblx0dmFyIGNoYW5nZWQgPSBmYWxzZTtcblxuXHRpZiAodGhpcy52YWx1ZSAhPSB2YWx1ZSkge1xuXG5cdFx0Y2hhbmdlZCA9IHRydWU7XG5cblx0XHRpZiAobXV0YXRlKSB7XG5cdFx0XHRpZiAodGhpcy5jb2x1bW4ubW9kdWxlcy5tdXRhdGUpIHtcblx0XHRcdFx0dmFsdWUgPSB0aGlzLnRhYmxlLm1vZHVsZXMubXV0YXRvci50cmFuc2Zvcm1DZWxsKHRoaXMsIHZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHR0aGlzLnNldFZhbHVlQWN0dWFsKHZhbHVlKTtcblxuXHRpZiAoY2hhbmdlZCAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cdFx0aWYgKHRoaXMuY29sdW1uLmRlZmluaXRpb24udG9wQ2FsYyB8fCB0aGlzLmNvbHVtbi5kZWZpbml0aW9uLmJvdHRvbUNhbGMpIHtcblx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXG5cdFx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgPT0gXCJ0YWJsZVwiIHx8IHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyA9PSBcImJvdGhcIikge1xuXHRcdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5yZWNhbGModGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3MpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIpIHtcblx0XHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjUm93R3JvdXAodGhpcy5yb3cpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjKHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gY2hhbmdlZDtcbn07XG5cbkNlbGwucHJvdG90eXBlLnNldFZhbHVlQWN0dWFsID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdHRoaXMub2xkVmFsdWUgPSB0aGlzLnZhbHVlO1xuXG5cdHRoaXMudmFsdWUgPSB2YWx1ZTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnJlYWN0aXZlRGF0YSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInJlYWN0aXZlRGF0YVwiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5yZWFjdGl2ZURhdGEuYmxvY2soKTtcblx0fVxuXG5cdHRoaXMuY29sdW1uLnNldEZpZWxkVmFsdWUodGhpcy5yb3cuZGF0YSwgdmFsdWUpO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucmVhY3RpdmVEYXRhICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVhY3RpdmVEYXRhXCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlYWN0aXZlRGF0YS51bmJsb2NrKCk7XG5cdH1cblxuXHRpZiAodGhpcy5sb2FkZWQpIHtcblx0XHR0aGlzLmxheW91dEVsZW1lbnQoKTtcblx0fVxufTtcblxuQ2VsbC5wcm90b3R5cGUubGF5b3V0RWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fZ2VuZXJhdGVDb250ZW50cygpO1xuXHR0aGlzLl9nZW5lcmF0ZVRvb2x0aXAoKTtcblxuXHQvL3NldCByZXNpemFibGUgaGFuZGxlc1xuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnJlc2l6YWJsZUNvbHVtbnMgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNpemVDb2x1bW5zXCIpICYmIHRoaXMucm93LnR5cGUgPT09IFwicm93XCIpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzaXplQ29sdW1ucy5pbml0aWFsaXplQ29sdW1uKFwiY2VsbFwiLCB0aGlzLmNvbHVtbiwgdGhpcy5lbGVtZW50KTtcblx0fVxuXG5cdGlmICgodGhpcy5jb2x1bW4uZGVmaW5pdGlvbi5jb250ZXh0TWVudSB8fCB0aGlzLmNvbHVtbi5kZWZpbml0aW9uLmNsaWNrTWVudSkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJtZW51XCIpKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLm1lbnUuaW5pdGlhbGl6ZUNlbGwodGhpcyk7XG5cdH1cblxuXHQvL2hhbmRsZSBmcm96ZW4gY2VsbHNcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZnJvemVuQ29sdW1uc1wiKSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmxheW91dEVsZW1lbnQodGhpcy5lbGVtZW50LCB0aGlzLmNvbHVtbik7XG5cdH1cbn07XG5cbkNlbGwucHJvdG90eXBlLnNldFdpZHRoID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLndpZHRoID0gdGhpcy5jb2x1bW4ud2lkdGg7XG5cdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMuY29sdW1uLndpZHRoU3R5bGVkO1xufTtcblxuQ2VsbC5wcm90b3R5cGUuY2xlYXJXaWR0aCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy53aWR0aCA9IFwiXCI7XG5cdHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9IFwiXCI7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMud2lkdGggfHwgdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoO1xufTtcblxuQ2VsbC5wcm90b3R5cGUuc2V0TWluV2lkdGggPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMubWluV2lkdGggPSB0aGlzLmNvbHVtbi5taW5XaWR0aDtcblx0dGhpcy5lbGVtZW50LnN0eWxlLm1pbldpZHRoID0gdGhpcy5jb2x1bW4ubWluV2lkdGhTdHlsZWQ7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5zZXRNYXhXaWR0aCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5tYXhXaWR0aCA9IHRoaXMuY29sdW1uLm1heFdpZHRoO1xuXHR0aGlzLmVsZW1lbnQuc3R5bGUubWF4V2lkdGggPSB0aGlzLmNvbHVtbi5tYXhXaWR0aFN0eWxlZDtcbn07XG5cbkNlbGwucHJvdG90eXBlLmNoZWNrSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuXHQvLyB2YXIgaGVpZ2h0ID0gdGhpcy5lbGVtZW50LmNzcyhcImhlaWdodFwiKTtcblx0dGhpcy5yb3cucmVpbml0aWFsaXplSGVpZ2h0KCk7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5jbGVhckhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5lbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdHRoaXMuaGVpZ2h0ID0gbnVsbDtcbn07XG5cbkNlbGwucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5oZWlnaHQgPSB0aGlzLnJvdy5oZWlnaHQ7XG5cdHRoaXMuZWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLnJvdy5oZWlnaHRTdHlsZWQ7XG59O1xuXG5DZWxsLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmhlaWdodCB8fCB0aGlzLmVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xufTtcblxuQ2VsbC5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSB0aGlzLmNvbHVtbi52ZXJ0QWxpZ24gPyBcImlubGluZS1mbGV4XCIgOiBcIlwiO1xufTtcblxuQ2VsbC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbn07XG5cbkNlbGwucHJvdG90eXBlLmVkaXQgPSBmdW5jdGlvbiAoZm9yY2UpIHtcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5lZGl0Q2VsbCh0aGlzLCBmb3JjZSk7XG5cdH1cbn07XG5cbkNlbGwucHJvdG90eXBlLmNhbmNlbEVkaXQgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIiwgdHJ1ZSkpIHtcblx0XHR2YXIgZWRpdGluZyA9IHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmdldEN1cnJlbnRDZWxsKCk7XG5cblx0XHRpZiAoZWRpdGluZyAmJiBlZGl0aW5nLl9nZXRTZWxmKCkgPT09IHRoaXMpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmNhbmNlbEVkaXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ2FuY2VsIEVkaXRvciBFcnJvciAtIFRoaXMgY2VsbCBpcyBub3QgY3VycmVudGx5IGJlaW5nIGVkaXRlZCBcIik7XG5cdFx0fVxuXHR9XG59O1xuXG5DZWxsLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuY29sdW1uLm1vZHVsZXMudmFsaWRhdGUgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJ2YWxpZGF0ZVwiLCB0cnVlKSkge1xuXHRcdHZhciB2YWxpZCA9IHRoaXMudGFibGUubW9kdWxlcy52YWxpZGF0ZS52YWxpZGF0ZSh0aGlzLmNvbHVtbi5tb2R1bGVzLnZhbGlkYXRlLCB0aGlzLCB0aGlzLmdldFZhbHVlKCkpO1xuXG5cdFx0cmV0dXJuIHZhbGlkID09PSB0cnVlO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG59O1xuXG5DZWxsLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICghdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlZHJhd0Jsb2NrICYmIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlKSB7XG5cdFx0dGhpcy5lbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50KTtcblx0fVxuXG5cdGlmICh0aGlzLm1vZHVsZXMudmFsaWRhdGUgJiYgdGhpcy5tb2R1bGVzLnZhbGlkYXRlLmludmFsaWQpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMudmFsaWRhdGUuY2xlYXJWYWxpZGF0aW9uKHRoaXMpO1xuXHR9XG5cblx0aWYgKHRoaXMubW9kdWxlcy5lZGl0ICYmIHRoaXMubW9kdWxlcy5lZGl0LmVkaXRlZCkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmNsZWFyRWRpdGVkKHRoaXMpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5oaXN0b3J5KSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLmhpc3RvcnkuY2xlYXJDb21wb25lbnRIaXN0b3J5KHRoaXMpO1xuXHR9XG5cblx0dGhpcy5lbGVtZW50ID0gZmFsc2U7XG5cdHRoaXMuY29sdW1uLmRlbGV0ZUNlbGwodGhpcyk7XG5cdHRoaXMucm93LmRlbGV0ZUNlbGwodGhpcyk7XG5cdHRoaXMuY2FsY3MgPSB7fTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8gTmF2aWdhdGlvbiAvLy8vLy8vLy8vLy8vLy8vL1xuXG5DZWxsLnByb3RvdHlwZS5uYXYgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgbmV4dENlbGwgPSBmYWxzZSxcblx0ICAgIGluZGV4ID0gdGhpcy5yb3cuZ2V0Q2VsbEluZGV4KHRoaXMpO1xuXG5cdHJldHVybiB7XG5cdFx0bmV4dDogZnVuY3Rpb24gbmV4dCgpIHtcblx0XHRcdHZhciBuZXh0Q2VsbCA9IHRoaXMucmlnaHQoKSxcblx0XHRcdCAgICBuZXh0Um93O1xuXG5cdFx0XHRpZiAoIW5leHRDZWxsKSB7XG5cdFx0XHRcdG5leHRSb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIubmV4dERpc3BsYXlSb3coc2VsZi5yb3csIHRydWUpO1xuXG5cdFx0XHRcdGlmIChuZXh0Um93KSB7XG5cdFx0XHRcdFx0bmV4dENlbGwgPSBuZXh0Um93LmZpbmROZXh0RWRpdGFibGVDZWxsKC0xKTtcblxuXHRcdFx0XHRcdGlmIChuZXh0Q2VsbCkge1xuXHRcdFx0XHRcdFx0bmV4dENlbGwuZWRpdCgpO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0sXG5cdFx0cHJldjogZnVuY3Rpb24gcHJldigpIHtcblx0XHRcdHZhciBuZXh0Q2VsbCA9IHRoaXMubGVmdCgpLFxuXHRcdFx0ICAgIHByZXZSb3c7XG5cblx0XHRcdGlmICghbmV4dENlbGwpIHtcblx0XHRcdFx0cHJldlJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5wcmV2RGlzcGxheVJvdyhzZWxmLnJvdywgdHJ1ZSk7XG5cblx0XHRcdFx0aWYgKHByZXZSb3cpIHtcblx0XHRcdFx0XHRuZXh0Q2VsbCA9IHByZXZSb3cuZmluZFByZXZFZGl0YWJsZUNlbGwocHJldlJvdy5jZWxscy5sZW5ndGgpO1xuXG5cdFx0XHRcdFx0aWYgKG5leHRDZWxsKSB7XG5cdFx0XHRcdFx0XHRuZXh0Q2VsbC5lZGl0KCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fSxcblx0XHRsZWZ0OiBmdW5jdGlvbiBsZWZ0KCkge1xuXG5cdFx0XHRuZXh0Q2VsbCA9IHNlbGYucm93LmZpbmRQcmV2RWRpdGFibGVDZWxsKGluZGV4KTtcblxuXHRcdFx0aWYgKG5leHRDZWxsKSB7XG5cdFx0XHRcdG5leHRDZWxsLmVkaXQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRyaWdodDogZnVuY3Rpb24gcmlnaHQoKSB7XG5cdFx0XHRuZXh0Q2VsbCA9IHNlbGYucm93LmZpbmROZXh0RWRpdGFibGVDZWxsKGluZGV4KTtcblxuXHRcdFx0aWYgKG5leHRDZWxsKSB7XG5cdFx0XHRcdG5leHRDZWxsLmVkaXQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHR1cDogZnVuY3Rpb24gdXAoKSB7XG5cdFx0XHR2YXIgbmV4dFJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5wcmV2RGlzcGxheVJvdyhzZWxmLnJvdywgdHJ1ZSk7XG5cblx0XHRcdGlmIChuZXh0Um93KSB7XG5cdFx0XHRcdG5leHRSb3cuY2VsbHNbaW5kZXhdLmVkaXQoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGRvd246IGZ1bmN0aW9uIGRvd24oKSB7XG5cdFx0XHR2YXIgbmV4dFJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5uZXh0RGlzcGxheVJvdyhzZWxmLnJvdywgdHJ1ZSk7XG5cblx0XHRcdGlmIChuZXh0Um93KSB7XG5cdFx0XHRcdG5leHRSb3cuY2VsbHNbaW5kZXhdLmVkaXQoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0fTtcbn07XG5cbkNlbGwucHJvdG90eXBlLmdldEluZGV4ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLnJvdy5nZXRDZWxsSW5kZXgodGhpcyk7XG59O1xuXG4vLy8vLy8vLy8vLy8vLy8vIE9iamVjdCBHZW5lcmF0aW9uIC8vLy8vLy8vLy8vLy8vLy8vXG5DZWxsLnByb3RvdHlwZS5nZXRDb21wb25lbnQgPSBmdW5jdGlvbiAoKSB7XG5cblx0aWYgKCF0aGlzLmNvbXBvbmVudCkge1xuXHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IENlbGxDb21wb25lbnQodGhpcyk7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5jb21wb25lbnQ7XG59O1xudmFyIEZvb3Rlck1hbmFnZXIgPSBmdW5jdGlvbiBGb290ZXJNYW5hZ2VyKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTtcblx0dGhpcy5hY3RpdmUgPSBmYWxzZTtcblx0dGhpcy5lbGVtZW50ID0gdGhpcy5jcmVhdGVFbGVtZW50KCk7IC8vY29udGFpbmluZyBlbGVtZW50XG5cdHRoaXMuZXh0ZXJuYWwgPSBmYWxzZTtcblx0dGhpcy5saW5rcyA9IFtdO1xuXG5cdHRoaXMuX2luaXRpYWxpemUoKTtcbn07XG5cbkZvb3Rlck1hbmFnZXIucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cblx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1mb290ZXJcIik7XG5cblx0cmV0dXJuIGVsO1xufTtcblxuRm9vdGVyTWFuYWdlci5wcm90b3R5cGUuX2luaXRpYWxpemUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnQpIHtcblxuXHRcdHN3aXRjaCAoX3R5cGVvZih0aGlzLnRhYmxlLm9wdGlvbnMuZm9vdGVyRWxlbWVudCkpIHtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblxuXHRcdFx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnRbMF0gPT09IFwiPFwiKSB7XG5cdFx0XHRcdFx0dGhpcy5lbGVtZW50LmlubmVySFRNTCA9IHRoaXMudGFibGUub3B0aW9ucy5mb290ZXJFbGVtZW50O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuZXh0ZXJuYWwgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0dGhpcy5lbGVtZW50ID0gdGhpcy50YWJsZS5vcHRpb25zLmZvb3RlckVsZW1lbnQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fVxufTtcblxuRm9vdGVyTWFuYWdlci5wcm90b3R5cGUuZ2V0RWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuZWxlbWVudDtcbn07XG5cbkZvb3Rlck1hbmFnZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBwYXJlbnQpIHtcblx0dGhpcy5hY3RpdmF0ZShwYXJlbnQpO1xuXG5cdHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChlbGVtZW50KTtcblx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xufTtcblxuRm9vdGVyTWFuYWdlci5wcm90b3R5cGUucHJlcGVuZCA9IGZ1bmN0aW9uIChlbGVtZW50LCBwYXJlbnQpIHtcblx0dGhpcy5hY3RpdmF0ZShwYXJlbnQpO1xuXG5cdHRoaXMuZWxlbWVudC5pbnNlcnRCZWZvcmUoZWxlbWVudCwgdGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG59O1xuXG5Gb290ZXJNYW5hZ2VyLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuXHRlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG5cdHRoaXMuZGVhY3RpdmF0ZSgpO1xufTtcblxuRm9vdGVyTWFuYWdlci5wcm90b3R5cGUuZGVhY3RpdmF0ZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHRpZiAoIXRoaXMuZWxlbWVudC5maXJzdENoaWxkIHx8IGZvcmNlKSB7XG5cdFx0aWYgKCF0aGlzLmV4dGVybmFsKSB7XG5cdFx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdH1cblx0XHR0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuXHR9XG5cblx0Ly8gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xufTtcblxuRm9vdGVyTWFuYWdlci5wcm90b3R5cGUuYWN0aXZhdGUgPSBmdW5jdGlvbiAocGFyZW50KSB7XG5cdGlmICghdGhpcy5hY3RpdmUpIHtcblx0XHR0aGlzLmFjdGl2ZSA9IHRydWU7XG5cdFx0aWYgKCF0aGlzLmV4dGVybmFsKSB7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5nZXRFbGVtZW50KCkpO1xuXHRcdFx0dGhpcy50YWJsZS5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJztcblx0XHR9XG5cdH1cblxuXHRpZiAocGFyZW50KSB7XG5cdFx0dGhpcy5saW5rcy5wdXNoKHBhcmVudCk7XG5cdH1cbn07XG5cbkZvb3Rlck1hbmFnZXIucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5saW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7XG5cdFx0bGluay5mb290ZXJSZWRyYXcoKTtcblx0fSk7XG59O1xuXG52YXIgVGFidWxhdG9yID0gZnVuY3Rpb24gVGFidWxhdG9yKGVsZW1lbnQsIG9wdGlvbnMpIHtcblxuXHR0aGlzLm9wdGlvbnMgPSB7fTtcblxuXHR0aGlzLmNvbHVtbk1hbmFnZXIgPSBudWxsOyAvLyBob2xkIENvbHVtbiBNYW5hZ2VyXG5cdHRoaXMucm93TWFuYWdlciA9IG51bGw7IC8vaG9sZCBSb3cgTWFuYWdlclxuXHR0aGlzLmZvb3Rlck1hbmFnZXIgPSBudWxsOyAvL2hvbGRlciBGb290ZXIgTWFuYWdlclxuXHR0aGlzLnZkb21Ib3ogPSBudWxsOyAvL2hvbGRlciBob3Jpem9udGFsIHZpcnR1YWwgZG9tXG5cblxuXHR0aGlzLmJyb3dzZXIgPSBcIlwiOyAvL2hvbGQgY3VycmVudCBicm93c2VyIHR5cGVcblx0dGhpcy5icm93c2VyU2xvdyA9IGZhbHNlOyAvL2hhbmRsZSByZWR1Y2VkIGZ1bmN0aW9uYWxpdHkgZm9yIHNsb3dlciBicm93c2Vyc1xuXHR0aGlzLmJyb3dzZXJNb2JpbGUgPSBmYWxzZTsgLy9jaGVjayBpZiBydW5uaW5nIG9uIG1vYmxlLCBwcmV2ZW50IHJlc2l6ZSBjYW5jZWxsaW5nIGVkaXQgb24ga2V5Ym9hcmQgYXBwZWFyZW5jZVxuXHR0aGlzLnJ0bCA9IGZhbHNlOyAvL2NoZWNrIGlmIHRoZSB0YWJsZSBpcyBpbiBSVEwgbW9kZVxuXG5cdHRoaXMubW9kdWxlcyA9IHt9OyAvL2hvbGQgYWxsIG1vZHVsZXMgYm91bmQgdG8gdGhpcyB0YWJsZVxuXG5cdGlmICh0aGlzLmluaXRpYWxpemVFbGVtZW50KGVsZW1lbnQpKSB7XG5cdFx0dGhpcy5pbml0aWFsaXplT3B0aW9ucyhvcHRpb25zIHx8IHt9KTtcblx0XHR0aGlzLl9jcmVhdGUoKTtcblx0fVxuXG5cdFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMucmVnaXN0ZXIodGhpcyk7IC8vcmVnaXN0ZXIgdGFibGUgZm9yIGluZGVyZGV2aWNlIGNvbW11bmljYXRpb25cbn07XG5cbi8vZGVmYXVsdCBzZXR1cCBvcHRpb25zXG5UYWJ1bGF0b3IucHJvdG90eXBlLmRlZmF1bHRPcHRpb25zID0ge1xuXG5cdGhlaWdodDogZmFsc2UsIC8vaGVpZ2h0IG9mIHRhYnVsYXRvclxuXHRtaW5IZWlnaHQ6IGZhbHNlLCAvL21pbmltdW0gaGVpZ2h0IG9mIHRhYnVsYXRvclxuXHRtYXhIZWlnaHQ6IGZhbHNlLCAvL21heGltdW0gaGVpZ2h0IG9mIHRhYnVsYXRvclxuXG5cdGxheW91dDogXCJmaXREYXRhXCIsIC8vL2xheW91dCB0eXBlIFwiZml0Q29sdW1uc1wiIHwgXCJmaXREYXRhXCJcblx0bGF5b3V0Q29sdW1uc09uTmV3RGF0YTogZmFsc2UsIC8vdXBkYXRlIGNvbHVtbiB3aWR0aHMgb24gc2V0RGF0YVxuXG5cdGNvbHVtbk1pbldpZHRoOiA0MCwgLy9taW5pbXVtIGdsb2JhbCB3aWR0aCBmb3IgYSBjb2x1bW5cblx0Y29sdW1uTWF4V2lkdGg6IGZhbHNlLCAvL21pbmltdW0gZ2xvYmFsIHdpZHRoIGZvciBhIGNvbHVtblxuXHRjb2x1bW5IZWFkZXJWZXJ0QWxpZ246IFwidG9wXCIsIC8vdmVydGljYWwgYWxpZ25tZW50IG9mIGNvbHVtbiBoZWFkZXJzXG5cdGNvbHVtblZlcnRBbGlnbjogZmFsc2UsIC8vIERFUFJFQ0FURUQgLSBMZWZ0IHRvIGFsbG93IHdhcm5pbmdcblxuXHRyZXNpemFibGVDb2x1bW5zOiB0cnVlLCAvL3Jlc2l6YWJsZSBjb2x1bW5zXG5cdHJlc2l6YWJsZVJvd3M6IGZhbHNlLCAvL3Jlc2l6YWJsZSByb3dzXG5cdGF1dG9SZXNpemU6IHRydWUsIC8vYXV0byByZXNpemUgdGFibGVcblxuXHRjb2x1bW5zOiBbXSwgLy9zdG9yZSBmb3IgY29sdW0gaGVhZGVyIGluZm9cblxuXHRjZWxsSG96QWxpZ246IFwiXCIsIC8vaG9yaXpvbnRhbCBhbGlnbiBjb2x1bW5zXG5cdGNlbGxWZXJ0QWxpZ246IFwiXCIsIC8vdmVydGljYWwgYWxpZ24gY29sdW1uc1xuXHRoZWFkZXJIb3pBbGlnbjogXCJcIiwgLy9ob3Jpem9udGFsIGhlYWRlciBhbGlnbm1lbnRcblxuXG5cdGRhdGE6IFtdLCAvL2RlZmF1bHQgc3RhcnRpbmcgZGF0YVxuXG5cdGF1dG9Db2x1bW5zOiBmYWxzZSwgLy9idWlsZCBjb2x1bW5zIGZyb20gZGF0YSByb3cgc3RydWN0dXJlXG5cdGF1dG9Db2x1bW5zRGVmaW5pdGlvbnM6IGZhbHNlLFxuXG5cdHJlYWN0aXZlRGF0YTogZmFsc2UsIC8vZW5hYmxlIGRhdGEgcmVhY3Rpdml0eVxuXG5cdG5lc3RlZEZpZWxkU2VwYXJhdG9yOiBcIi5cIiwgLy9zZXBlcmF0cHIgZm9yIG5lc3RlZCBkYXRhXG5cblx0dG9vbHRpcHM6IGZhbHNlLCAvL1Rvb2wgdGlwIHZhbHVlXG5cdHRvb2x0aXBzSGVhZGVyOiBmYWxzZSwgLy9Ub29sIHRpcCBmb3IgaGVhZGVyc1xuXHR0b29sdGlwR2VuZXJhdGlvbk1vZGU6IFwibG9hZFwiLCAvL3doZW4gdG8gZ2VuZXJhdGUgdG9vbHRpcHNcblxuXHRpbml0aWFsU29ydDogZmFsc2UsIC8vaW5pdGlhbCBzb3J0aW5nIGNyaXRlcmlhXG5cdGluaXRpYWxGaWx0ZXI6IGZhbHNlLCAvL2luaXRpYWwgZmlsdGVyaW5nIGNyaXRlcmlhXG5cdGluaXRpYWxIZWFkZXJGaWx0ZXI6IGZhbHNlLCAvL2luaXRpYWwgaGVhZGVyIGZpbHRlcmluZyBjcml0ZXJpYVxuXG5cdGNvbHVtbkhlYWRlclNvcnRNdWx0aTogdHJ1ZSwgLy9tdWx0aXBsZSBvciBzaW5nbGUgY29sdW1uIHNvcnRpbmdcblxuXHRzb3J0T3JkZXJSZXZlcnNlOiBmYWxzZSwgLy9yZXZlcnNlIGludGVybmFsIHNvcnQgb3JkZXJpbmdcblxuXHRoZWFkZXJTb3J0OiB0cnVlLCAvL3NldCBkZWZhdWx0IGdsb2JhbCBoZWFkZXIgc29ydFxuXHRoZWFkZXJTb3J0VHJpc3RhdGU6IGZhbHNlLCAvL3NldCBkZWZhdWx0IHRyaXN0YXRlIGhlYWRlciBzb3J0aW5nXG5cdGhlYWRlclNvcnRFbGVtZW50OiBcIjxkaXYgY2xhc3M9J3RhYnVsYXRvci1hcnJvdyc+PC9kaXY+XCIsIC8vaGVhZGVyIHNvcnQgZWxlbWVudFxuXG5cdGZvb3RlckVsZW1lbnQ6IGZhbHNlLCAvL2hvbGQgZm9vdGVyIGVsZW1lbnRcblxuXHRpbmRleDogXCJpZFwiLCAvL2ZpbGVkIGZvciByb3cgaW5kZXhcblxuXHR0ZXh0RGlyZWN0aW9uOiBcImF1dG9cIixcblxuXHRrZXliaW5kaW5nczogW10sIC8vYXJyYXkgZm9yIGtleWJpbmRpbmdzXG5cblx0dGFiRW5kTmV3Um93OiBmYWxzZSwgLy9jcmVhdGUgbmV3IHJvdyB3aGVuIHRhYiB0byBlbmQgb2YgdGFibGVcblxuXHRpbnZhbGlkT3B0aW9uV2FybmluZ3M6IHRydWUsIC8vYWxsb3cgdG9nZ2xpbmcgb2YgaW52YWxpZCBvcHRpb24gd2FybmluZ3NcblxuXHRjbGlwYm9hcmQ6IGZhbHNlLCAvL2VuYWJsZSBjbGlwYm9hcmRcblx0Y2xpcGJvYXJkQ29weVN0eWxlZDogdHJ1ZSwgLy9mb3JtYXR0ZWQgdGFibGUgZGF0YVxuXHRjbGlwYm9hcmRDb3B5Q29uZmlnOiBmYWxzZSwgLy9jbGlwYm9hcmQgY29uZmlnXG5cdGNsaXBib2FyZENvcHlGb3JtYXR0ZXI6IGZhbHNlLCAvL0RFUFJJQ0FURUQgLSBSRU1PVkUgaW4gNS4wXG5cdGNsaXBib2FyZENvcHlSb3dSYW5nZTogXCJhY3RpdmVcIiwgLy9yZXN0cmljdCBjbGlwYm9hcmQgdG8gdmlzaWJsZSByb3dzIG9ubHlcblx0Y2xpcGJvYXJkUGFzdGVQYXJzZXI6IFwidGFibGVcIiwgLy9jb252ZXJ0IHBhc3RlZCBjbGlwYm9hcmQgZGF0YSB0byByb3dzXG5cdGNsaXBib2FyZFBhc3RlQWN0aW9uOiBcImluc2VydFwiLCAvL2hvdyB0byBpbnNlcnQgcGFzdGVkIGRhdGEgaW50byB0aGUgdGFibGVcblxuXHRjbGlwYm9hcmRDb3BpZWQ6IGZ1bmN0aW9uIGNsaXBib2FyZENvcGllZCgpIHt9LCAvL2RhdGEgaGFzIGJlZW4gY29waWVkIHRvIHRoZSBjbGlwYm9hcmRcblx0Y2xpcGJvYXJkUGFzdGVkOiBmdW5jdGlvbiBjbGlwYm9hcmRQYXN0ZWQoKSB7fSwgLy9kYXRhIGhhcyBiZWVuIHBhc3RlZCBpbnRvIHRoZSB0YWJsZVxuXHRjbGlwYm9hcmRQYXN0ZUVycm9yOiBmdW5jdGlvbiBjbGlwYm9hcmRQYXN0ZUVycm9yKCkge30sIC8vZGF0YSBoYXMgbm90IHN1Y2Nlc3NmdWxseSBiZWVuIHBhc3RlZCBpbnRvIHRoZSB0YWJsZVxuXG5cdGRvd25sb2FkRGF0YUZvcm1hdHRlcjogZmFsc2UsIC8vZnVuY3Rpb24gdG8gbWFuaXB1bGF0ZSB0YWJsZSBkYXRhIGJlZm9yZSBpdCBpcyBkb3dubG9hZGVkXG5cdGRvd25sb2FkUmVhZHk6IGZ1bmN0aW9uIGRvd25sb2FkUmVhZHkoZGF0YSwgYmxvYikge1xuXHRcdHJldHVybiBibG9iO1xuXHR9LCAvL2Z1bmN0aW9uIHRvIG1hbmlwdWxhdGUgZG93bmxvYWQgZGF0YVxuXHRkb3dubG9hZENvbXBsZXRlOiBmYWxzZSwgLy9mdW5jdGlvbiB0byBtYW5pcHVsYXRlIGRvd25sb2FkIGRhdGFcblx0ZG93bmxvYWRDb25maWc6IHt9LCAvL2Rvd25sb2FkIGNvbmZpZ1xuXHRkb3dubG9hZFJvd1JhbmdlOiBcImFjdGl2ZVwiLCAvL3Jlc3RyaWN0IGRvd25sb2FkIHRvIGFjdGl2ZSByb3dzIG9ubHlcblxuXHRkYXRhVHJlZTogZmFsc2UsIC8vZW5hYmxlIGRhdGEgdHJlZVxuXHRkYXRhVHJlZUZpbHRlcjogdHJ1ZSwgLy9maWx0ZXIgY2hpbGQgcm93c1xuXHRkYXRhVHJlZVNvcnQ6IHRydWUsIC8vc29ydCBjaGlsZCByb3dzXG5cdGRhdGFUcmVlRWxlbWVudENvbHVtbjogZmFsc2UsXG5cdGRhdGFUcmVlQnJhbmNoRWxlbWVudDogdHJ1ZSwgLy9zaG93IGRhdGEgdHJlZSBicmFuY2ggZWxlbWVudFxuXHRkYXRhVHJlZUNoaWxkSW5kZW50OiA5LCAvL2RhdGEgdHJlZSBjaGlsZCBpbmRlbnQgaW4gcHhcblx0ZGF0YVRyZWVDaGlsZEZpZWxkOiBcIl9jaGlsZHJlblwiLCAvL2RhdGEgdHJlIGNvbHVtbiBmaWVsZCB0byBsb29rIGZvciBjaGlsZCByb3dzXG5cdGRhdGFUcmVlQ29sbGFwc2VFbGVtZW50OiBmYWxzZSwgLy9kYXRhIHRyZWUgcm93IGNvbGxhcHNlIGVsZW1lbnRcblx0ZGF0YVRyZWVFeHBhbmRFbGVtZW50OiBmYWxzZSwgLy9kYXRhIHRyZWUgcm93IGV4cGFuZCBlbGVtZW50XG5cdGRhdGFUcmVlU3RhcnRFeHBhbmRlZDogZmFsc2UsXG5cdGRhdGFUcmVlUm93RXhwYW5kZWQ6IGZ1bmN0aW9uIGRhdGFUcmVlUm93RXhwYW5kZWQoKSB7fSwgLy9yb3cgaGFzIGJlZW4gZXhwYW5kZWRcblx0ZGF0YVRyZWVSb3dDb2xsYXBzZWQ6IGZ1bmN0aW9uIGRhdGFUcmVlUm93Q29sbGFwc2VkKCkge30sIC8vcm93IGhhcyBiZWVuIGNvbGxhcHNlZFxuXHRkYXRhVHJlZUNoaWxkQ29sdW1uQ2FsY3M6IGZhbHNlLCAvL2luY2x1ZGUgdmlzaWJsZSBkYXRhIHRyZWUgcm93cyBpbiBjb2x1bW4gY2FsY3VsYXRpb25zXG5cdGRhdGFUcmVlU2VsZWN0UHJvcGFnYXRlOiBmYWxzZSwgLy9zZWxlY2N0aW5nIGEgcGFyZW50IHJvdyBzZWxlY3RzIGl0cyBjaGlsZHJlblxuXG5cdHByaW50QXNIdG1sOiBmYWxzZSwgLy9lbmFibGUgcHJpbnQgYXMgaHRtbFxuXHRwcmludEZvcm1hdHRlcjogZmFsc2UsIC8vcHJpbnRpbmcgcGFnZSBmb3JtYXR0ZXJcblx0cHJpbnRIZWFkZXI6IGZhbHNlLCAvL3BhZ2UgaGVhZGVyIGNvbnRlbnRzXG5cdHByaW50Rm9vdGVyOiBmYWxzZSwgLy9wYWdlIGZvb3RlciBjb250ZW50c1xuXHRwcmludENvcHlTdHlsZTogdHJ1ZSwgLy9ERVBSSUNBVEVEIC0gUkVNT1ZFIGluIDUuMFxuXHRwcmludFN0eWxlZDogdHJ1ZSwgLy9lbmFibGUgcHJpbnQgYXMgaHRtbCBzdHlsaW5nXG5cdHByaW50VmlzaWJsZVJvd3M6IHRydWUsIC8vREVQUklDQVRFRCAtIFJFTU9WRSBpbiA1LjBcblx0cHJpbnRSb3dSYW5nZTogXCJ2aXNpYmxlXCIsIC8vcmVzdHJpY3QgcHJpbnQgdG8gdmlzaWJsZSByb3dzIG9ubHlcblx0cHJpbnRDb25maWc6IHt9LCAvL3ByaW50IGNvbmZpZyBvcHRpb25zXG5cblx0YWRkUm93UG9zOiBcImJvdHRvbVwiLCAvL3Bvc2l0aW9uIHRvIGluc2VydCBibGFuayByb3dzLCB0b3B8Ym90dG9tXG5cblx0c2VsZWN0YWJsZTogXCJoaWdobGlnaHRcIiwgLy9oaWdobGlnaHQgcm93cyBvbiBob3ZlclxuXHRzZWxlY3RhYmxlUmFuZ2VNb2RlOiBcImRyYWdcIiwgLy9oaWdobGlnaHQgcm93cyBvbiBob3ZlclxuXHRzZWxlY3RhYmxlUm9sbGluZ1NlbGVjdGlvbjogdHJ1ZSwgLy9yb2xsIHNlbGVjdGlvbiBvbmNlIG1heGltdW0gbnVtYmVyIG9mIHNlbGVjdGFibGUgcm93cyBpcyByZWFjaGVkXG5cdHNlbGVjdGFibGVQZXJzaXN0ZW5jZTogdHJ1ZSwgLy8gbWFpbnRhaW4gc2VsZWN0aW9uIHdoZW4gdGFibGUgdmlldyBpcyB1cGRhdGVkXG5cdHNlbGVjdGFibGVDaGVjazogZnVuY3Rpb24gc2VsZWN0YWJsZUNoZWNrKGRhdGEsIHJvdykge1xuXHRcdHJldHVybiB0cnVlO1xuXHR9LCAvL2NoZWNrIHdoZWF0aGVyIHJvdyBpcyBzZWxlY3RhYmxlXG5cblx0aGVhZGVyRmlsdGVyTGl2ZUZpbHRlckRlbGF5OiAzMDAsIC8vZGVsYXkgYmVmb3JlIHVwZGF0aW5nIGNvbHVtbiBhZnRlciB1c2VyIHR5cGVzIGluIGhlYWRlciBmaWx0ZXJcblx0aGVhZGVyRmlsdGVyUGxhY2Vob2xkZXI6IGZhbHNlLCAvL3BsYWNlaG9sZGVyIHRleHQgdG8gZGlzcGxheSBpbiBoZWFkZXIgZmlsdGVyc1xuXG5cdGhlYWRlclZpc2libGU6IHRydWUsIC8vaGlkZSBoZWFkZXJcblxuXHRoaXN0b3J5OiBmYWxzZSwgLy9lbmFibGUgZWRpdCBoaXN0b3J5XG5cblx0bG9jYWxlOiBmYWxzZSwgLy9jdXJyZW50IHN5c3RlbSBsYW5ndWFnZVxuXHRsYW5nczoge30sXG5cblx0dmlydHVhbERvbTogdHJ1ZSwgLy9lbmFibGUgRE9NIHZpcnR1YWxpemF0aW9uXG5cdHZpcnR1YWxEb21CdWZmZXI6IDAsIC8vIHNldCB2aXJ0dWFsIERPTSBidWZmZXIgc2l6ZVxuXHR2aXJ0dWFsRG9tSG96OiBmYWxzZSwgLy9lbmFibGUgaG9yaXpvbnRhbCBET00gdmlydHVhbGl6YXRpb25cblxuXHRwZXJzaXN0ZW50TGF5b3V0OiBmYWxzZSwgLy9ERVBSSUNBVEVEIC0gUkVNT1ZFIGluIDUuMFxuXHRwZXJzaXN0ZW50U29ydDogZmFsc2UsIC8vREVQUklDQVRFRCAtIFJFTU9WRSBpbiA1LjBcblx0cGVyc2lzdGVudEZpbHRlcjogZmFsc2UsIC8vREVQUklDQVRFRCAtIFJFTU9WRSBpbiA1LjBcblx0cGVyc2lzdGVuY2VJRDogXCJcIiwgLy9rZXkgZm9yIHBlcnNpc3RlbnQgc3RvcmFnZVxuXHRwZXJzaXN0ZW5jZU1vZGU6IHRydWUsIC8vbW9kZSBmb3Igc3RvcmluZyBwZXJzaXN0ZW5jZSBpbmZvcm1hdGlvblxuXHRwZXJzaXN0ZW5jZVJlYWRlckZ1bmM6IGZhbHNlLCAvL2Z1bmN0aW9uIGZvciBoYW5kbGluZyBwZXJzaXN0ZW5jZSBkYXRhIHJlYWRpbmdcblx0cGVyc2lzdGVuY2VXcml0ZXJGdW5jOiBmYWxzZSwgLy9mdW5jdGlvbiBmb3IgaGFuZGxpbmcgcGVyc2lzdGVuY2UgZGF0YSB3cml0aW5nXG5cblx0cGVyc2lzdGVuY2U6IGZhbHNlLFxuXG5cdHJlc3BvbnNpdmVMYXlvdXQ6IGZhbHNlLCAvL3Jlc3BvbnNpdmUgbGF5b3V0IGZsYWdzXG5cdHJlc3BvbnNpdmVMYXlvdXRDb2xsYXBzZVN0YXJ0T3BlbjogdHJ1ZSwgLy9zdGFydCBzaG93aW5nIGNvbGxhcHNlZCBkYXRhXG5cdHJlc3BvbnNpdmVMYXlvdXRDb2xsYXBzZVVzZUZvcm1hdHRlcnM6IHRydWUsIC8vcmVzcG9uc2l2ZSBsYXlvdXQgY29sbGFwc2UgZm9ybWF0dGVyXG5cdHJlc3BvbnNpdmVMYXlvdXRDb2xsYXBzZUZvcm1hdHRlcjogZmFsc2UsIC8vcmVzcG9uc2l2ZSBsYXlvdXQgY29sbGFwc2UgZm9ybWF0dGVyXG5cblx0cGFnaW5hdGlvbjogZmFsc2UsIC8vc2V0IHBhZ2luYXRpb24gdHlwZVxuXHRwYWdpbmF0aW9uU2l6ZTogZmFsc2UsIC8vc2V0IG51bWJlciBvZiByb3dzIHRvIGEgcGFnZVxuXHRwYWdpbmF0aW9uSW5pdGlhbFBhZ2U6IDEsIC8vaW5pdGFpbCBwYWdlIHRvIHNob3cgb24gbG9hZFxuXHRwYWdpbmF0aW9uQnV0dG9uQ291bnQ6IDUsIC8vIHNldCBjb3VudCBvZiBwYWdlIGJ1dHRvblxuXHRwYWdpbmF0aW9uU2l6ZVNlbGVjdG9yOiBmYWxzZSwgLy9hZGQgcGFnaW5hdGlvbiBzaXplIHNlbGVjdG9yIGVsZW1lbnRcblx0cGFnaW5hdGlvbkVsZW1lbnQ6IGZhbHNlLCAvL2VsZW1lbnQgdG8gaG9sZCBwYWdpbmF0aW9uIG51bWJlcnNcblx0cGFnaW5hdGlvbkRhdGFTZW50OiB7fSwgLy9wYWdpbmF0aW9uIGRhdGEgc2VudCB0byB0aGUgc2VydmVyXG5cdHBhZ2luYXRpb25EYXRhUmVjZWl2ZWQ6IHt9LCAvL3BhZ2luYXRpb24gZGF0YSByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJcblx0cGFnaW5hdGlvbkFkZFJvdzogXCJwYWdlXCIsIC8vYWRkIHJvd3Mgb24gdGFibGUgb3IgcGFnZVxuXG5cdGFqYXhVUkw6IGZhbHNlLCAvL3VybCBmb3IgYWpheCBsb2FkaW5nXG5cdGFqYXhVUkxHZW5lcmF0b3I6IGZhbHNlLFxuXHRhamF4UGFyYW1zOiB7fSwgLy9wYXJhbXMgZm9yIGFqYXggbG9hZGluZ1xuXHRhamF4Q29uZmlnOiBcImdldFwiLCAvL2FqYXggcmVxdWVzdCB0eXBlXG5cdGFqYXhDb250ZW50VHlwZTogXCJmb3JtXCIsIC8vYWpheCByZXF1ZXN0IHR5cGVcblx0YWpheFJlcXVlc3RGdW5jOiBmYWxzZSwgLy9wcm9taXNlIGZ1bmN0aW9uXG5cdGFqYXhMb2FkZXI6IHRydWUsIC8vc2hvdyBsb2FkZXJcblx0YWpheExvYWRlckxvYWRpbmc6IGZhbHNlLCAvL2xvYWRlciBlbGVtZW50XG5cdGFqYXhMb2FkZXJFcnJvcjogZmFsc2UsIC8vbG9hZGVyIGVsZW1lbnRcblx0YWpheEZpbHRlcmluZzogZmFsc2UsXG5cdGFqYXhTb3J0aW5nOiBmYWxzZSxcblx0YWpheFByb2dyZXNzaXZlTG9hZDogZmFsc2UsIC8vcHJvZ3Jlc3NpdmUgbG9hZGluZ1xuXHRhamF4UHJvZ3Jlc3NpdmVMb2FkRGVsYXk6IDAsIC8vZGVsYXkgYmV0d2VlbiByZXF1ZXN0c1xuXHRhamF4UHJvZ3Jlc3NpdmVMb2FkU2Nyb2xsTWFyZ2luOiAwLCAvL21hcmdpbiBiZWZvcmUgc2Nyb2xsIGJlZ2luc1xuXG5cdGdyb3VwQnk6IGZhbHNlLCAvL2VuYWJsZSB0YWJsZSBncm91cGluZyBhbmQgc2V0IGZpZWxkIHRvIGdyb3VwIGJ5XG5cdGdyb3VwU3RhcnRPcGVuOiB0cnVlLCAvL3N0YXJ0aW5nIHN0YXRlIG9mIGdyb3VwXG5cdGdyb3VwVmFsdWVzOiBmYWxzZSxcblx0Z3JvdXBVcGRhdGVPbkNlbGxFZGl0OiBmYWxzZSxcblxuXHRncm91cEhlYWRlcjogZmFsc2UsIC8vaGVhZGVyIGdlbmVyYXRpb24gZnVuY3Rpb25cblx0Z3JvdXBIZWFkZXJQcmludDogbnVsbCxcblx0Z3JvdXBIZWFkZXJDbGlwYm9hcmQ6IG51bGwsXG5cdGdyb3VwSGVhZGVySHRtbE91dHB1dDogbnVsbCxcblx0Z3JvdXBIZWFkZXJEb3dubG9hZDogbnVsbCxcblxuXHRodG1sT3V0cHV0Q29uZmlnOiBmYWxzZSwgLy9odG1sIG91dHlwdSBjb25maWdcblxuXHRtb3ZhYmxlQ29sdW1uczogZmFsc2UsIC8vZW5hYmxlIG1vdmFibGUgY29sdW1uc1xuXG5cdG1vdmFibGVSb3dzOiBmYWxzZSwgLy9lbmFibGUgbW92YWJsZSByb3dzXG5cdG1vdmFibGVSb3dzQ29ubmVjdGVkVGFibGVzOiBmYWxzZSwgLy90YWJsZXMgZm9yIG1vdmFibGUgcm93cyB0byBiZSBjb25uZWN0ZWQgdG9cblx0bW92YWJsZVJvd3NDb25uZWN0ZWRFbGVtZW50czogZmFsc2UsIC8vb3RoZXIgZWxlbWVudHMgZm9yIG1vdmFibGUgcm93cyB0byBiZSBjb25uZWN0ZWQgdG9cblx0bW92YWJsZVJvd3NTZW5kZXI6IGZhbHNlLFxuXHRtb3ZhYmxlUm93c1JlY2VpdmVyOiBcImluc2VydFwiLFxuXHRtb3ZhYmxlUm93c1NlbmRpbmdTdGFydDogZnVuY3Rpb24gbW92YWJsZVJvd3NTZW5kaW5nU3RhcnQoKSB7fSxcblx0bW92YWJsZVJvd3NTZW50OiBmdW5jdGlvbiBtb3ZhYmxlUm93c1NlbnQoKSB7fSxcblx0bW92YWJsZVJvd3NTZW50RmFpbGVkOiBmdW5jdGlvbiBtb3ZhYmxlUm93c1NlbnRGYWlsZWQoKSB7fSxcblx0bW92YWJsZVJvd3NTZW5kaW5nU3RvcDogZnVuY3Rpb24gbW92YWJsZVJvd3NTZW5kaW5nU3RvcCgpIHt9LFxuXHRtb3ZhYmxlUm93c1JlY2VpdmluZ1N0YXJ0OiBmdW5jdGlvbiBtb3ZhYmxlUm93c1JlY2VpdmluZ1N0YXJ0KCkge30sXG5cdG1vdmFibGVSb3dzUmVjZWl2ZWQ6IGZ1bmN0aW9uIG1vdmFibGVSb3dzUmVjZWl2ZWQoKSB7fSxcblx0bW92YWJsZVJvd3NSZWNlaXZlZEZhaWxlZDogZnVuY3Rpb24gbW92YWJsZVJvd3NSZWNlaXZlZEZhaWxlZCgpIHt9LFxuXHRtb3ZhYmxlUm93c1JlY2VpdmluZ1N0b3A6IGZ1bmN0aW9uIG1vdmFibGVSb3dzUmVjZWl2aW5nU3RvcCgpIHt9LFxuXHRtb3ZhYmxlUm93c0VsZW1lbnREcm9wOiBmdW5jdGlvbiBtb3ZhYmxlUm93c0VsZW1lbnREcm9wKCkge30sXG5cblx0c2Nyb2xsVG9Sb3dQb3NpdGlvbjogXCJ0b3BcIixcblx0c2Nyb2xsVG9Sb3dJZlZpc2libGU6IHRydWUsXG5cblx0c2Nyb2xsVG9Db2x1bW5Qb3NpdGlvbjogXCJsZWZ0XCIsXG5cdHNjcm9sbFRvQ29sdW1uSWZWaXNpYmxlOiB0cnVlLFxuXG5cdHJvd0Zvcm1hdHRlcjogZmFsc2UsXG5cdHJvd0Zvcm1hdHRlclByaW50OiBudWxsLFxuXHRyb3dGb3JtYXR0ZXJDbGlwYm9hcmQ6IG51bGwsXG5cdHJvd0Zvcm1hdHRlckh0bWxPdXRwdXQ6IG51bGwsXG5cblx0cGxhY2Vob2xkZXI6IGZhbHNlLFxuXG5cdC8vdGFibGUgYnVpbGRpbmcgY2FsbGJhY2tzXG5cdHRhYmxlQnVpbGRpbmc6IGZ1bmN0aW9uIHRhYmxlQnVpbGRpbmcoKSB7fSxcblx0dGFibGVCdWlsdDogZnVuY3Rpb24gdGFibGVCdWlsdCgpIHt9LFxuXG5cdC8vcmVuZGVyIGNhbGxiYWNrc1xuXHRyZW5kZXJTdGFydGVkOiBmdW5jdGlvbiByZW5kZXJTdGFydGVkKCkge30sXG5cdHJlbmRlckNvbXBsZXRlOiBmdW5jdGlvbiByZW5kZXJDb21wbGV0ZSgpIHt9LFxuXG5cdC8vcm93IGNhbGxiYWNrc1xuXHRyb3dDbGljazogZmFsc2UsXG5cdHJvd0RibENsaWNrOiBmYWxzZSxcblx0cm93Q29udGV4dDogZmFsc2UsXG5cdHJvd1RhcDogZmFsc2UsXG5cdHJvd0RibFRhcDogZmFsc2UsXG5cdHJvd1RhcEhvbGQ6IGZhbHNlLFxuXHRyb3dNb3VzZUVudGVyOiBmYWxzZSxcblx0cm93TW91c2VMZWF2ZTogZmFsc2UsXG5cdHJvd01vdXNlT3ZlcjogZmFsc2UsXG5cdHJvd01vdXNlT3V0OiBmYWxzZSxcblx0cm93TW91c2VNb3ZlOiBmYWxzZSxcblx0cm93Q29udGV4dE1lbnU6IGZhbHNlLFxuXHRyb3dDbGlja01lbnU6IGZhbHNlLFxuXHRyb3dBZGRlZDogZnVuY3Rpb24gcm93QWRkZWQoKSB7fSxcblx0cm93RGVsZXRlZDogZnVuY3Rpb24gcm93RGVsZXRlZCgpIHt9LFxuXHRyb3dNb3ZlZDogZnVuY3Rpb24gcm93TW92ZWQoKSB7fSxcblx0cm93VXBkYXRlZDogZnVuY3Rpb24gcm93VXBkYXRlZCgpIHt9LFxuXHRyb3dTZWxlY3Rpb25DaGFuZ2VkOiBmdW5jdGlvbiByb3dTZWxlY3Rpb25DaGFuZ2VkKCkge30sXG5cdHJvd1NlbGVjdGVkOiBmdW5jdGlvbiByb3dTZWxlY3RlZCgpIHt9LFxuXHRyb3dEZXNlbGVjdGVkOiBmdW5jdGlvbiByb3dEZXNlbGVjdGVkKCkge30sXG5cdHJvd1Jlc2l6ZWQ6IGZ1bmN0aW9uIHJvd1Jlc2l6ZWQoKSB7fSxcblxuXHQvL2NlbGwgY2FsbGJhY2tzXG5cdC8vcm93IGNhbGxiYWNrc1xuXHRjZWxsQ2xpY2s6IGZhbHNlLFxuXHRjZWxsRGJsQ2xpY2s6IGZhbHNlLFxuXHRjZWxsQ29udGV4dDogZmFsc2UsXG5cdGNlbGxUYXA6IGZhbHNlLFxuXHRjZWxsRGJsVGFwOiBmYWxzZSxcblx0Y2VsbFRhcEhvbGQ6IGZhbHNlLFxuXHRjZWxsTW91c2VFbnRlcjogZmFsc2UsXG5cdGNlbGxNb3VzZUxlYXZlOiBmYWxzZSxcblx0Y2VsbE1vdXNlT3ZlcjogZmFsc2UsXG5cdGNlbGxNb3VzZU91dDogZmFsc2UsXG5cdGNlbGxNb3VzZU1vdmU6IGZhbHNlLFxuXHRjZWxsRWRpdGluZzogZnVuY3Rpb24gY2VsbEVkaXRpbmcoKSB7fSxcblx0Y2VsbEVkaXRlZDogZnVuY3Rpb24gY2VsbEVkaXRlZCgpIHt9LFxuXHRjZWxsRWRpdENhbmNlbGxlZDogZnVuY3Rpb24gY2VsbEVkaXRDYW5jZWxsZWQoKSB7fSxcblxuXHQvL2NvbHVtbiBjYWxsYmFja3Ncblx0Y29sdW1uTW92ZWQ6IGZhbHNlLFxuXHRjb2x1bW5SZXNpemVkOiBmdW5jdGlvbiBjb2x1bW5SZXNpemVkKCkge30sXG5cdGNvbHVtblRpdGxlQ2hhbmdlZDogZnVuY3Rpb24gY29sdW1uVGl0bGVDaGFuZ2VkKCkge30sXG5cdGNvbHVtblZpc2liaWxpdHlDaGFuZ2VkOiBmdW5jdGlvbiBjb2x1bW5WaXNpYmlsaXR5Q2hhbmdlZCgpIHt9LFxuXG5cdC8vSFRNTCBpcG9ydCBjYWxsYmFja3Ncblx0aHRtbEltcG9ydGluZzogZnVuY3Rpb24gaHRtbEltcG9ydGluZygpIHt9LFxuXHRodG1sSW1wb3J0ZWQ6IGZ1bmN0aW9uIGh0bWxJbXBvcnRlZCgpIHt9LFxuXG5cdC8vZGF0YSBjYWxsYmFja3Ncblx0ZGF0YUxvYWRpbmc6IGZ1bmN0aW9uIGRhdGFMb2FkaW5nKCkge30sXG5cdGRhdGFMb2FkZWQ6IGZ1bmN0aW9uIGRhdGFMb2FkZWQoKSB7fSxcblx0ZGF0YUVkaXRlZDogZmFsc2UsIC8vREVQUkVDQVRFRFxuXHRkYXRhQ2hhbmdlZDogZmFsc2UsXG5cblx0Ly9hamF4IGNhbGxiYWNrc1xuXHRhamF4UmVxdWVzdGluZzogZnVuY3Rpb24gYWpheFJlcXVlc3RpbmcoKSB7fSxcblx0YWpheFJlc3BvbnNlOiBmYWxzZSxcblx0YWpheEVycm9yOiBmdW5jdGlvbiBhamF4RXJyb3IoKSB7fSxcblxuXHQvL2ZpbHRlcmluZyBjYWxsYmFja3Ncblx0ZGF0YUZpbHRlcmluZzogZmFsc2UsXG5cdGRhdGFGaWx0ZXJlZDogZmFsc2UsXG5cblx0Ly9zb3J0aW5nIGNhbGxiYWNrc1xuXHRkYXRhU29ydGluZzogZnVuY3Rpb24gZGF0YVNvcnRpbmcoKSB7fSxcblx0ZGF0YVNvcnRlZDogZnVuY3Rpb24gZGF0YVNvcnRlZCgpIHt9LFxuXG5cdC8vZ3JvdXBpbmcgY2FsbGJhY2tzXG5cdGdyb3VwVG9nZ2xlRWxlbWVudDogXCJhcnJvd1wiLFxuXHRncm91cENsb3NlZFNob3dDYWxjczogZmFsc2UsXG5cdGRhdGFHcm91cGluZzogZnVuY3Rpb24gZGF0YUdyb3VwaW5nKCkge30sXG5cdGRhdGFHcm91cGVkOiBmYWxzZSxcblx0Z3JvdXBWaXNpYmlsaXR5Q2hhbmdlZDogZnVuY3Rpb24gZ3JvdXBWaXNpYmlsaXR5Q2hhbmdlZCgpIHt9LFxuXHRncm91cENsaWNrOiBmYWxzZSxcblx0Z3JvdXBEYmxDbGljazogZmFsc2UsXG5cdGdyb3VwQ29udGV4dDogZmFsc2UsXG5cdGdyb3VwQ29udGV4dE1lbnU6IGZhbHNlLFxuXHRncm91cENsaWNrTWVudTogZmFsc2UsXG5cdGdyb3VwVGFwOiBmYWxzZSxcblx0Z3JvdXBEYmxUYXA6IGZhbHNlLFxuXHRncm91cFRhcEhvbGQ6IGZhbHNlLFxuXG5cdGNvbHVtbkNhbGNzOiB0cnVlLFxuXG5cdC8vcGFnaW5hdGlvbiBjYWxsYmFja3Ncblx0cGFnZUxvYWRlZDogZnVuY3Rpb24gcGFnZUxvYWRlZCgpIHt9LFxuXG5cdC8vbG9jYWxpemF0aW9uIGNhbGxiYWNrc1xuXHRsb2NhbGl6ZWQ6IGZ1bmN0aW9uIGxvY2FsaXplZCgpIHt9LFxuXG5cdC8vdmFsaWRhdGlvbiBjYWxsYmFja3Ncblx0dmFsaWRhdGlvbk1vZGU6IFwiYmxvY2tpbmdcIixcblx0dmFsaWRhdGlvbkZhaWxlZDogZnVuY3Rpb24gdmFsaWRhdGlvbkZhaWxlZCgpIHt9LFxuXG5cdC8vaGlzdG9yeSBjYWxsYmFja3Ncblx0aGlzdG9yeVVuZG86IGZ1bmN0aW9uIGhpc3RvcnlVbmRvKCkge30sXG5cdGhpc3RvcnlSZWRvOiBmdW5jdGlvbiBoaXN0b3J5UmVkbygpIHt9LFxuXG5cdC8vc2Nyb2xsIGNhbGxiYWNrc1xuXHRzY3JvbGxIb3Jpem9udGFsOiBmdW5jdGlvbiBzY3JvbGxIb3Jpem9udGFsKCkge30sXG5cdHNjcm9sbFZlcnRpY2FsOiBmdW5jdGlvbiBzY3JvbGxWZXJ0aWNhbCgpIHt9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmluaXRpYWxpemVPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblxuXHQvL3dhcm4gdXNlciBpZiBvcHRpb24gaXMgbm90IGF2YWlsYWJsZVxuXHRpZiAob3B0aW9ucy5pbnZhbGlkT3B0aW9uV2FybmluZ3MgIT09IGZhbHNlKSB7XG5cdFx0Zm9yICh2YXIga2V5IGluIG9wdGlvbnMpIHtcblx0XHRcdGlmICh0eXBlb2YgdGhpcy5kZWZhdWx0T3B0aW9uc1trZXldID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkludmFsaWQgdGFibGUgY29uc3RydWN0b3Igb3B0aW9uOlwiLCBrZXkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vYXNzaWduIG9wdGlvbnMgdG8gdGFibGVcblx0Zm9yICh2YXIga2V5IGluIHRoaXMuZGVmYXVsdE9wdGlvbnMpIHtcblx0XHRpZiAoa2V5IGluIG9wdGlvbnMpIHtcblx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gb3B0aW9uc1trZXldO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh0aGlzLmRlZmF1bHRPcHRpb25zW2tleV0pKSB7XG5cdFx0XHRcdHRoaXMub3B0aW9uc1trZXldID0gT2JqZWN0LmFzc2lnbihbXSwgdGhpcy5kZWZhdWx0T3B0aW9uc1trZXldKTtcblx0XHRcdH0gZWxzZSBpZiAoX3R5cGVvZih0aGlzLmRlZmF1bHRPcHRpb25zW2tleV0pID09PSBcIm9iamVjdFwiICYmIHRoaXMuZGVmYXVsdE9wdGlvbnNba2V5XSAhPT0gbnVsbCkge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdE9wdGlvbnNba2V5XSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm9wdGlvbnNba2V5XSA9IHRoaXMuZGVmYXVsdE9wdGlvbnNba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuaW5pdGlhbGl6ZUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuXG5cdGlmICh0eXBlb2YgSFRNTEVsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBlbHNlIGlmICh0eXBlb2YgZWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCk7XG5cblx0XHRpZiAodGhpcy5lbGVtZW50KSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIlRhYnVsYXRvciBDcmVhdGlvbiBFcnJvciAtIG5vIGVsZW1lbnQgZm91bmQgbWF0Y2hpbmcgc2VsZWN0b3I6IFwiLCBlbGVtZW50KTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS5lcnJvcihcIlRhYnVsYXRvciBDcmVhdGlvbiBFcnJvciAtIEludmFsaWQgZWxlbWVudCBwcm92aWRlZDpcIiwgZWxlbWVudCk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJ0bENoZWNrID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsZW1lbnQpO1xuXG5cdHN3aXRjaCAodGhpcy5vcHRpb25zLnRleHREaXJlY3Rpb24pIHtcblx0XHRjYXNlIFwiYXV0b1wiOlxuXHRcdFx0aWYgKHN0eWxlLmRpcmVjdGlvbiAhPT0gXCJydGxcIikge1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH07XG5cblx0XHRjYXNlIFwicnRsXCI6XG5cdFx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ydGxcIik7XG5cdFx0XHR0aGlzLnJ0bCA9IHRydWU7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJsdHJcIjpcblx0XHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWx0clwiKTtcblxuXHRcdGRlZmF1bHQ6XG5cdFx0XHR0aGlzLnJ0bCA9IGZhbHNlO1xuXHR9XG59O1xuXG4vL2NvbnZlcnQgZGVwcmljYXRlZCBmdW5jdGlvbmFsaXR5IHRvIG5ldyBmdW5jdGlvbnNcblRhYnVsYXRvci5wcm90b3R5cGUuX21hcERlcHJpY2F0ZWRGdW5jdGlvbmFsaXR5ID0gZnVuY3Rpb24gKCkge1xuXG5cdC8vbWFwIGRlcHJpY2F0ZWQgcGVyc2lzdGFuY2Ugc2V0dXAgb3B0aW9uc1xuXHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbnRMYXlvdXQgfHwgdGhpcy5vcHRpb25zLnBlcnNpc3RlbnRTb3J0IHx8IHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50RmlsdGVyKSB7XG5cdFx0aWYgKCF0aGlzLm9wdGlvbnMucGVyc2lzdGVuY2UpIHtcblx0XHRcdHRoaXMub3B0aW9ucy5wZXJzaXN0ZW5jZSA9IHt9O1xuXHRcdH1cblx0fVxuXG5cdGlmICh0aGlzLm9wdGlvbnMuZGF0YUVkaXRlZCkge1xuXHRcdGNvbnNvbGUud2FybihcIkRFUFJFQ0FUSU9OIFdBUk5JTkcgLSBkYXRhRWRpdGVkIG9wdGlvbiBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIHRoZSBkYXRhQ2hhbmdlZCBvcHRpb24gaW5zdGVhZFwiKTtcblx0XHR0aGlzLm9wdGlvbnMuZGF0YUNoYW5nZWQgPSB0aGlzLm9wdGlvbnMuZGF0YUVkaXRlZDtcblx0fVxuXG5cdGlmICh0aGlzLm9wdGlvbnMuZG93bmxvYWREYXRhRm9ybWF0dGVyKSB7XG5cdFx0Y29uc29sZS53YXJuKFwiREVQUkVDQVRJT04gV0FSTklORyAtIGRvd25sb2FkRGF0YUZvcm1hdHRlciBvcHRpb24gaGFzIGJlZW4gZGVwcmVjYXRlZFwiKTtcblx0fVxuXG5cdGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmNsaXBib2FyZENvcHlIZWFkZXIgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHR0aGlzLm9wdGlvbnMuY29sdW1uSGVhZGVycyA9IHRoaXMub3B0aW9ucy5jbGlwYm9hcmRDb3B5SGVhZGVyO1xuXHRcdGNvbnNvbGUud2FybihcIkRFUFJFQ0FUSU9OIFdBUk5JTkcgLSBjbGlwYm9hcmRDb3B5SGVhZGVyIG9wdGlvbiBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIHRoZSBjb2x1bW5IZWFkZXJzIHByb3BlcnR5IG9uIHRoZSBjbGlwYm9hcmRDb3B5Q29uZmlnIG9wdGlvblwiKTtcblx0fVxuXG5cdGlmICh0aGlzLm9wdGlvbnMucHJpbnRWaXNpYmxlUm93cyAhPT0gdHJ1ZSkge1xuXHRcdGNvbnNvbGUud2FybihcInByaW50VmlzaWJsZVJvd3Mgb3B0aW9uIGlzIGRlcHJlY2F0ZWQsIHlvdSBzaG91bGQgbm93IHVzZSB0aGUgcHJpbnRSb3dSYW5nZSBvcHRpb25cIik7XG5cblx0XHR0aGlzLm9wdGlvbnMucGVyc2lzdGVuY2UucHJpbnRSb3dSYW5nZSA9IFwiYWN0aXZlXCI7XG5cdH1cblxuXHRpZiAodGhpcy5vcHRpb25zLnByaW50Q29weVN0eWxlICE9PSB0cnVlKSB7XG5cdFx0Y29uc29sZS53YXJuKFwicHJpbnRDb3B5U3R5bGUgb3B0aW9uIGlzIGRlcHJlY2F0ZWQsIHlvdSBzaG91bGQgbm93IHVzZSB0aGUgcHJpbnRTdHlsZWQgb3B0aW9uXCIpO1xuXG5cdFx0dGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlLnByaW50U3R5bGVkID0gdGhpcy5vcHRpb25zLnByaW50Q29weVN0eWxlO1xuXHR9XG5cblx0aWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW50TGF5b3V0KSB7XG5cdFx0Y29uc29sZS53YXJuKFwicGVyc2lzdGVudExheW91dCBvcHRpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIHRoZSBwZXJzaXN0ZW5jZSBvcHRpb25cIik7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlICE9PSB0cnVlICYmIHR5cGVvZiB0aGlzLm9wdGlvbnMucGVyc2lzdGVuY2UuY29sdW1ucyA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0dGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlLmNvbHVtbnMgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdGlmICh0aGlzLm9wdGlvbnMucGVyc2lzdGVudFNvcnQpIHtcblx0XHRjb25zb2xlLndhcm4oXCJwZXJzaXN0ZW50U29ydCBvcHRpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIHRoZSBwZXJzaXN0ZW5jZSBvcHRpb25cIik7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlICE9PSB0cnVlICYmIHR5cGVvZiB0aGlzLm9wdGlvbnMucGVyc2lzdGVuY2Uuc29ydCA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0dGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlLnNvcnQgPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdGlmICh0aGlzLm9wdGlvbnMucGVyc2lzdGVudEZpbHRlcikge1xuXHRcdGNvbnNvbGUud2FybihcInBlcnNpc3RlbnRGaWx0ZXIgb3B0aW9uIGlzIGRlcHJlY2F0ZWQsIHlvdSBzaG91bGQgbm93IHVzZSB0aGUgcGVyc2lzdGVuY2Ugb3B0aW9uXCIpO1xuXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW5jZSAhPT0gdHJ1ZSAmJiB0eXBlb2YgdGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlLmZpbHRlciA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0dGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlLmZpbHRlciA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRoaXMub3B0aW9ucy5jb2x1bW5WZXJ0QWxpZ24pIHtcblx0XHRjb25zb2xlLndhcm4oXCJjb2x1bW5WZXJ0QWxpZ24gb3B0aW9uIGlzIGRlcHJlY2F0ZWQsIHlvdSBzaG91bGQgbm93IHVzZSB0aGUgY29sdW1uSGVhZGVyVmVydEFsaWduIG9wdGlvblwiKTtcblxuXHRcdHRoaXMub3B0aW9ucy5jb2x1bW5IZWFkZXJWZXJ0QWxpZ24gPSB0aGlzLm9wdGlvbnMuY29sdW1uVmVydEFsaWduO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLl9jbGVhclNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0aWYgKHdpbmRvdy5nZXRTZWxlY3Rpb24pIHtcblx0XHRpZiAod2luZG93LmdldFNlbGVjdGlvbigpLmVtcHR5KSB7XG5cdFx0XHQvLyBDaHJvbWVcblx0XHRcdHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5lbXB0eSgpO1xuXHRcdH0gZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcykge1xuXHRcdFx0Ly8gRmlyZWZveFxuXHRcdFx0d2luZG93LmdldFNlbGVjdGlvbigpLnJlbW92ZUFsbFJhbmdlcygpO1xuXHRcdH1cblx0fSBlbHNlIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcblx0XHQvLyBJRT9cblx0XHRkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKTtcblx0fVxuXG5cdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcbn07XG5cbi8vY29uY3JlYXRlIHRhYmxlXG5UYWJ1bGF0b3IucHJvdG90eXBlLl9jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX2NsZWFyT2JqZWN0UG9pbnRlcnMoKTtcblxuXHR0aGlzLl9tYXBEZXByaWNhdGVkRnVuY3Rpb25hbGl0eSgpO1xuXG5cdHRoaXMuYmluZE1vZHVsZXMoKTtcblxuXHR0aGlzLnJ0bENoZWNrKCk7XG5cblx0aWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSBcIlRBQkxFXCIpIHtcblx0XHRpZiAodGhpcy5tb2RFeGlzdHMoXCJodG1sVGFibGVJbXBvcnRcIiwgdHJ1ZSkpIHtcblx0XHRcdHRoaXMubW9kdWxlcy5odG1sVGFibGVJbXBvcnQucGFyc2VUYWJsZSgpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMuY29sdW1uTWFuYWdlciA9IG5ldyBDb2x1bW5NYW5hZ2VyKHRoaXMpO1xuXHR0aGlzLnJvd01hbmFnZXIgPSBuZXcgUm93TWFuYWdlcih0aGlzKTtcblx0dGhpcy5mb290ZXJNYW5hZ2VyID0gbmV3IEZvb3Rlck1hbmFnZXIodGhpcyk7XG5cblx0dGhpcy5jb2x1bW5NYW5hZ2VyLnNldFJvd01hbmFnZXIodGhpcy5yb3dNYW5hZ2VyKTtcblx0dGhpcy5yb3dNYW5hZ2VyLnNldENvbHVtbk1hbmFnZXIodGhpcy5jb2x1bW5NYW5hZ2VyKTtcblxuXHRpZiAodGhpcy5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHR0aGlzLnZkb21Ib3ogPSBuZXcgVkRvbUhveih0aGlzKTtcblx0fVxuXG5cdHRoaXMuX2J1aWxkRWxlbWVudCgpO1xuXG5cdHRoaXMuX2xvYWRJbml0aWFsRGF0YSgpO1xufTtcblxuLy9jbGVhciBwb2ludGVycyB0byBvYmplY3RzIGluIGRlZmF1bHQgY29uZmlnIG9iamVjdFxuVGFidWxhdG9yLnByb3RvdHlwZS5fY2xlYXJPYmplY3RQb2ludGVycyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5vcHRpb25zLmNvbHVtbnMgPSB0aGlzLm9wdGlvbnMuY29sdW1ucy5zbGljZSgwKTtcblxuXHRpZiAoIXRoaXMub3B0aW9ucy5yZWFjdGl2ZURhdGEpIHtcblx0XHR0aGlzLm9wdGlvbnMuZGF0YSA9IHRoaXMub3B0aW9ucy5kYXRhLnNsaWNlKDApO1xuXHR9XG59O1xuXG4vL2J1aWxkIHRhYnVsYXRvciBlbGVtZW50XG5UYWJ1bGF0b3IucHJvdG90eXBlLl9idWlsZEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczI0ID0gdGhpcztcblxuXHR2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcblx0ICAgIG1vZCA9IHRoaXMubW9kdWxlcyxcblx0ICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cblx0b3B0aW9ucy50YWJsZUJ1aWxkaW5nLmNhbGwodGhpcyk7XG5cblx0ZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yXCIpO1xuXHRlbGVtZW50LnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJncmlkXCIpO1xuXG5cdC8vZW1wdHkgZWxlbWVudFxuXHR3aGlsZSAoZWxlbWVudC5maXJzdENoaWxkKSB7XG5cdFx0ZWxlbWVudC5yZW1vdmVDaGlsZChlbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHR9IC8vc2V0IHRhYmxlIGhlaWdodFxuXHRpZiAob3B0aW9ucy5oZWlnaHQpIHtcblx0XHRvcHRpb25zLmhlaWdodCA9IGlzTmFOKG9wdGlvbnMuaGVpZ2h0KSA/IG9wdGlvbnMuaGVpZ2h0IDogb3B0aW9ucy5oZWlnaHQgKyBcInB4XCI7XG5cdFx0ZWxlbWVudC5zdHlsZS5oZWlnaHQgPSBvcHRpb25zLmhlaWdodDtcblx0fVxuXG5cdC8vc2V0IHRhYmxlIG1pbiBoZWlnaHRcblx0aWYgKG9wdGlvbnMubWluSGVpZ2h0ICE9PSBmYWxzZSkge1xuXHRcdG9wdGlvbnMubWluSGVpZ2h0ID0gaXNOYU4ob3B0aW9ucy5taW5IZWlnaHQpID8gb3B0aW9ucy5taW5IZWlnaHQgOiBvcHRpb25zLm1pbkhlaWdodCArIFwicHhcIjtcblx0XHRlbGVtZW50LnN0eWxlLm1pbkhlaWdodCA9IG9wdGlvbnMubWluSGVpZ2h0O1xuXHR9XG5cblx0Ly9zZXQgdGFibGUgbWF4SGVpZ2h0XG5cdGlmIChvcHRpb25zLm1heEhlaWdodCAhPT0gZmFsc2UpIHtcblx0XHRvcHRpb25zLm1heEhlaWdodCA9IGlzTmFOKG9wdGlvbnMubWF4SGVpZ2h0KSA/IG9wdGlvbnMubWF4SGVpZ2h0IDogb3B0aW9ucy5tYXhIZWlnaHQgKyBcInB4XCI7XG5cdFx0ZWxlbWVudC5zdHlsZS5tYXhIZWlnaHQgPSBvcHRpb25zLm1heEhlaWdodDtcblx0fVxuXG5cdHRoaXMuY29sdW1uTWFuYWdlci5pbml0aWFsaXplKCk7XG5cdHRoaXMucm93TWFuYWdlci5pbml0aWFsaXplKCk7XG5cblx0dGhpcy5fZGV0ZWN0QnJvd3NlcigpO1xuXG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImxheW91dFwiLCB0cnVlKSkge1xuXHRcdG1vZC5sYXlvdXQuaW5pdGlhbGl6ZShvcHRpb25zLmxheW91dCk7XG5cdH1cblxuXHQvL3NldCBsb2NhbGl6YXRpb25cblxuXHRtb2QubG9jYWxpemUuaW5pdGlhbGl6ZSgpO1xuXG5cdGlmIChvcHRpb25zLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyICE9PSBmYWxzZSkge1xuXHRcdG1vZC5sb2NhbGl6ZS5zZXRIZWFkZXJGaWx0ZXJQbGFjZWhvbGRlcihvcHRpb25zLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyKTtcblx0fVxuXG5cdGZvciAodmFyIGxvY2FsZSBpbiBvcHRpb25zLmxhbmdzKSB7XG5cdFx0bW9kLmxvY2FsaXplLmluc3RhbGxMYW5nKGxvY2FsZSwgb3B0aW9ucy5sYW5nc1tsb2NhbGVdKTtcblx0fVxuXG5cdG1vZC5sb2NhbGl6ZS5zZXRMb2NhbGUob3B0aW9ucy5sb2NhbGUpO1xuXG5cdC8vY29uZmlndXJlIHBsYWNlaG9sZGVyIGVsZW1lbnRcblx0aWYgKHR5cGVvZiBvcHRpb25zLnBsYWNlaG9sZGVyID09IFwic3RyaW5nXCIpIHtcblxuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wbGFjZWhvbGRlclwiKTtcblxuXHRcdHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0c3Bhbi5pbm5lckhUTUwgPSBvcHRpb25zLnBsYWNlaG9sZGVyO1xuXG5cdFx0ZWwuYXBwZW5kQ2hpbGQoc3Bhbik7XG5cblx0XHRvcHRpb25zLnBsYWNlaG9sZGVyID0gZWw7XG5cdH1cblxuXHQvL2J1aWxkIHRhYmxlIGVsZW1lbnRzXG5cdGVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5jb2x1bW5NYW5hZ2VyLmdldEVsZW1lbnQoKSk7XG5cdGVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5yb3dNYW5hZ2VyLmdldEVsZW1lbnQoKSk7XG5cblx0aWYgKG9wdGlvbnMuZm9vdGVyRWxlbWVudCkge1xuXHRcdHRoaXMuZm9vdGVyTWFuYWdlci5hY3RpdmF0ZSgpO1xuXHR9XG5cblx0aWYgKG9wdGlvbnMucGVyc2lzdGVuY2UgJiYgdGhpcy5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSkge1xuXHRcdG1vZC5wZXJzaXN0ZW5jZS5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5tb3ZhYmxlUm93cyAmJiB0aGlzLm1vZEV4aXN0cyhcIm1vdmVSb3dcIikpIHtcblx0XHRtb2QubW92ZVJvdy5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5hdXRvQ29sdW1ucyAmJiB0aGlzLm9wdGlvbnMuZGF0YSkge1xuXHRcdHRoaXMuY29sdW1uTWFuYWdlci5nZW5lcmF0ZUNvbHVtbnNGcm9tUm93RGF0YSh0aGlzLm9wdGlvbnMuZGF0YSk7XG5cdH1cblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJjb2x1bW5DYWxjc1wiKSkge1xuXHRcdG1vZC5jb2x1bW5DYWxjcy5pbml0aWFsaXplKCk7XG5cdH1cblxuXHR0aGlzLmNvbHVtbk1hbmFnZXIuc2V0Q29sdW1ucyhvcHRpb25zLmNvbHVtbnMpO1xuXG5cdGlmIChvcHRpb25zLmRhdGFUcmVlICYmIHRoaXMubW9kRXhpc3RzKFwiZGF0YVRyZWVcIiwgdHJ1ZSkpIHtcblx0XHRtb2QuZGF0YVRyZWUuaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZnJvemVuUm93c1wiKSkge1xuXHRcdHRoaXMubW9kdWxlcy5mcm96ZW5Sb3dzLmluaXRpYWxpemUoKTtcblx0fVxuXG5cdGlmICgob3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIG1vZC5wZXJzaXN0ZW5jZS5jb25maWcuc29ydCB8fCBvcHRpb25zLmluaXRpYWxTb3J0KSAmJiB0aGlzLm1vZEV4aXN0cyhcInNvcnRcIiwgdHJ1ZSkpIHtcblx0XHR2YXIgc29ydGVycyA9IFtdO1xuXG5cdFx0aWYgKG9wdGlvbnMucGVyc2lzdGVuY2UgJiYgdGhpcy5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiBtb2QucGVyc2lzdGVuY2UuY29uZmlnLnNvcnQpIHtcblx0XHRcdHNvcnRlcnMgPSBtb2QucGVyc2lzdGVuY2UubG9hZChcInNvcnRcIik7XG5cblx0XHRcdGlmIChzb3J0ZXJzID09PSBmYWxzZSAmJiBvcHRpb25zLmluaXRpYWxTb3J0KSB7XG5cdFx0XHRcdHNvcnRlcnMgPSBvcHRpb25zLmluaXRpYWxTb3J0O1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAob3B0aW9ucy5pbml0aWFsU29ydCkge1xuXHRcdFx0c29ydGVycyA9IG9wdGlvbnMuaW5pdGlhbFNvcnQ7XG5cdFx0fVxuXG5cdFx0bW9kLnNvcnQuc2V0U29ydChzb3J0ZXJzKTtcblx0fVxuXG5cdGlmICgob3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIG1vZC5wZXJzaXN0ZW5jZS5jb25maWcuZmlsdGVyIHx8IG9wdGlvbnMuaW5pdGlhbEZpbHRlcikgJiYgdGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR2YXIgZmlsdGVycyA9IFtdO1xuXG5cdFx0aWYgKG9wdGlvbnMucGVyc2lzdGVuY2UgJiYgdGhpcy5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiBtb2QucGVyc2lzdGVuY2UuY29uZmlnLmZpbHRlcikge1xuXHRcdFx0ZmlsdGVycyA9IG1vZC5wZXJzaXN0ZW5jZS5sb2FkKFwiZmlsdGVyXCIpO1xuXG5cdFx0XHRpZiAoZmlsdGVycyA9PT0gZmFsc2UgJiYgb3B0aW9ucy5pbml0aWFsRmlsdGVyKSB7XG5cdFx0XHRcdGZpbHRlcnMgPSBvcHRpb25zLmluaXRpYWxGaWx0ZXI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChvcHRpb25zLmluaXRpYWxGaWx0ZXIpIHtcblx0XHRcdGZpbHRlcnMgPSBvcHRpb25zLmluaXRpYWxGaWx0ZXI7XG5cdFx0fVxuXG5cdFx0bW9kLmZpbHRlci5zZXRGaWx0ZXIoZmlsdGVycyk7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5pbml0aWFsSGVhZGVyRmlsdGVyICYmIHRoaXMubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0b3B0aW9ucy5pbml0aWFsSGVhZGVyRmlsdGVyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblxuXHRcdFx0dmFyIGNvbHVtbiA9IF90aGlzMjQuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGl0ZW0uZmllbGQpO1xuXG5cdFx0XHRpZiAoY29sdW1uKSB7XG5cdFx0XHRcdG1vZC5maWx0ZXIuc2V0SGVhZGVyRmlsdGVyVmFsdWUoY29sdW1uLCBpdGVtLnZhbHVlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGl0ZW0uZmllbGQpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJhamF4XCIpKSB7XG5cdFx0bW9kLmFqYXguaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0aWYgKG9wdGlvbnMucGFnaW5hdGlvbiAmJiB0aGlzLm1vZEV4aXN0cyhcInBhZ2VcIiwgdHJ1ZSkpIHtcblx0XHRtb2QucGFnZS5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAob3B0aW9ucy5ncm91cEJ5ICYmIHRoaXMubW9kRXhpc3RzKFwiZ3JvdXBSb3dzXCIsIHRydWUpKSB7XG5cdFx0bW9kLmdyb3VwUm93cy5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJrZXliaW5kaW5nc1wiKSkge1xuXHRcdG1vZC5rZXliaW5kaW5ncy5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJzZWxlY3RSb3dcIikpIHtcblx0XHRtb2Quc2VsZWN0Um93LmNsZWFyU2VsZWN0aW9uRGF0YSh0cnVlKTtcblx0fVxuXG5cdGlmIChvcHRpb25zLmF1dG9SZXNpemUgJiYgdGhpcy5tb2RFeGlzdHMoXCJyZXNpemVUYWJsZVwiKSkge1xuXHRcdG1vZC5yZXNpemVUYWJsZS5pbml0aWFsaXplKCk7XG5cdH1cblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJjbGlwYm9hcmRcIikpIHtcblx0XHRtb2QuY2xpcGJvYXJkLmluaXRpYWxpemUoKTtcblx0fVxuXG5cdGlmIChvcHRpb25zLnByaW50QXNIdG1sICYmIHRoaXMubW9kRXhpc3RzKFwicHJpbnRcIikpIHtcblx0XHRtb2QucHJpbnQuaW5pdGlhbGl6ZSgpO1xuXHR9XG5cblx0b3B0aW9ucy50YWJsZUJ1aWx0LmNhbGwodGhpcyk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLl9sb2FkSW5pdGlhbERhdGEgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRpZiAoc2VsZi5vcHRpb25zLnBhZ2luYXRpb24gJiYgc2VsZi5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0c2VsZi5tb2R1bGVzLnBhZ2UucmVzZXQodHJ1ZSwgdHJ1ZSk7XG5cblx0XHRpZiAoc2VsZi5vcHRpb25zLnBhZ2luYXRpb24gPT0gXCJsb2NhbFwiKSB7XG5cdFx0XHRpZiAoc2VsZi5vcHRpb25zLmRhdGEubGVuZ3RoKSB7XG5cdFx0XHRcdHNlbGYucm93TWFuYWdlci5zZXREYXRhKHNlbGYub3B0aW9ucy5kYXRhLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoKHNlbGYub3B0aW9ucy5hamF4VVJMIHx8IHNlbGYub3B0aW9ucy5hamF4VVJMR2VuZXJhdG9yKSAmJiBzZWxmLm1vZEV4aXN0cyhcImFqYXhcIikpIHtcblx0XHRcdFx0XHRzZWxmLm1vZHVsZXMuYWpheC5sb2FkRGF0YShmYWxzZSwgdHJ1ZSkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0aWYgKHNlbGYub3B0aW9ucy5wYWdpbmF0aW9uSW5pdGlhbFBhZ2UpIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5tb2R1bGVzLnBhZ2Uuc2V0UGFnZShzZWxmLm9wdGlvbnMucGFnaW5hdGlvbkluaXRpYWxQYWdlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZWxmLnJvd01hbmFnZXIuc2V0RGF0YShzZWxmLm9wdGlvbnMuZGF0YSwgZmFsc2UsIHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzZWxmLm9wdGlvbnMucGFnaW5hdGlvbkluaXRpYWxQYWdlKSB7XG5cdFx0XHRcdHNlbGYubW9kdWxlcy5wYWdlLnNldFBhZ2Uoc2VsZi5vcHRpb25zLnBhZ2luYXRpb25Jbml0aWFsUGFnZSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChzZWxmLm9wdGlvbnMuYWpheFVSTCkge1xuXHRcdFx0XHRzZWxmLm1vZHVsZXMucGFnZS5zZXRQYWdlKHNlbGYub3B0aW9ucy5wYWdpbmF0aW9uSW5pdGlhbFBhZ2UpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbGYucm93TWFuYWdlci5zZXREYXRhKFtdLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGlmIChzZWxmLm9wdGlvbnMuZGF0YS5sZW5ndGgpIHtcblx0XHRcdHNlbGYucm93TWFuYWdlci5zZXREYXRhKHNlbGYub3B0aW9ucy5kYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKChzZWxmLm9wdGlvbnMuYWpheFVSTCB8fCBzZWxmLm9wdGlvbnMuYWpheFVSTEdlbmVyYXRvcikgJiYgc2VsZi5tb2RFeGlzdHMoXCJhamF4XCIpKSB7XG5cdFx0XHRcdHNlbGYubW9kdWxlcy5hamF4LmxvYWREYXRhKGZhbHNlLCB0cnVlKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZWxmLnJvd01hbmFnZXIuc2V0RGF0YShzZWxmLm9wdGlvbnMuZGF0YSwgZmFsc2UsIHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuLy9kZWNvbnN0cnVjdG9yXG5UYWJ1bGF0b3IucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuXG5cdFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMuZGVyZWdpc3Rlcih0aGlzKTsgLy9kZXJlZ2lzdGVyIHRhYmxlIGZyb20gaW5kZXJkZXZpY2UgY29tbXVuaWNhdGlvblxuXG5cdGlmICh0aGlzLm9wdGlvbnMucmVhY3RpdmVEYXRhICYmIHRoaXMubW9kRXhpc3RzKFwicmVhY3RpdmVEYXRhXCIsIHRydWUpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnJlYWN0aXZlRGF0YS51bndhdGNoRGF0YSgpO1xuXHR9XG5cblx0Ly9jbGVhciByb3cgZGF0YVxuXHR0aGlzLnJvd01hbmFnZXIucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRyb3cud2lwZSgpO1xuXHR9KTtcblxuXHR0aGlzLnJvd01hbmFnZXIucm93cyA9IFtdO1xuXHR0aGlzLnJvd01hbmFnZXIuYWN0aXZlUm93cyA9IFtdO1xuXHR0aGlzLnJvd01hbmFnZXIuZGlzcGxheVJvd3MgPSBbXTtcblxuXHQvL2NsZWFyIGV2ZW50IGJpbmRpbmdzXG5cdGlmICh0aGlzLm9wdGlvbnMuYXV0b1Jlc2l6ZSAmJiB0aGlzLm1vZEV4aXN0cyhcInJlc2l6ZVRhYmxlXCIpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnJlc2l6ZVRhYmxlLmNsZWFyQmluZGluZ3MoKTtcblx0fVxuXG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImtleWJpbmRpbmdzXCIpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLmtleWJpbmRpbmdzLmNsZWFyQmluZGluZ3MoKTtcblx0fVxuXG5cdC8vY2xlYXIgRE9NXG5cdHdoaWxlIChlbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdH1lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3JcIik7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLl9kZXRlY3RCcm93c2VyID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IgfHwgd2luZG93Lm9wZXJhO1xuXG5cdGlmICh1YS5pbmRleE9mKFwiVHJpZGVudFwiKSA+IC0xKSB7XG5cdFx0dGhpcy5icm93c2VyID0gXCJpZVwiO1xuXHRcdHRoaXMuYnJvd3NlclNsb3cgPSB0cnVlO1xuXHR9IGVsc2UgaWYgKHVhLmluZGV4T2YoXCJFZGdlXCIpID4gLTEpIHtcblx0XHR0aGlzLmJyb3dzZXIgPSBcImVkZ2VcIjtcblx0XHR0aGlzLmJyb3dzZXJTbG93ID0gdHJ1ZTtcblx0fSBlbHNlIGlmICh1YS5pbmRleE9mKFwiRmlyZWZveFwiKSA+IC0xKSB7XG5cdFx0dGhpcy5icm93c2VyID0gXCJmaXJlZm94XCI7XG5cdFx0dGhpcy5icm93c2VyU2xvdyA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuYnJvd3NlciA9IFwib3RoZXJcIjtcblx0XHR0aGlzLmJyb3dzZXJTbG93ID0gZmFsc2U7XG5cdH1cblxuXHR0aGlzLmJyb3dzZXJNb2JpbGUgPSAvKGFuZHJvaWR8YmJcXGQrfG1lZWdvKS4rbW9iaWxlfGF2YW50Z298YmFkYVxcL3xibGFja2JlcnJ5fGJsYXplcnxjb21wYWx8ZWxhaW5lfGZlbm5lY3xoaXB0b3B8aWVtb2JpbGV8aXAoaG9uZXxvZCl8aXJpc3xraW5kbGV8bGdlIHxtYWVtb3xtaWRwfG1tcHxtb2JpbGUuK2ZpcmVmb3h8bmV0ZnJvbnR8b3BlcmEgbShvYnxpbilpfHBhbG0oIG9zKT98cGhvbmV8cChpeGl8cmUpXFwvfHBsdWNrZXJ8cG9ja2V0fHBzcHxzZXJpZXMoNHw2KTB8c3ltYmlhbnx0cmVvfHVwXFwuKGJyb3dzZXJ8bGluayl8dm9kYWZvbmV8d2FwfHdpbmRvd3MgY2V8eGRhfHhpaW5vfGFuZHJvaWR8aXBhZHxwbGF5Ym9va3xzaWxrL2kudGVzdCh1YSkgfHwgLzEyMDd8NjMxMHw2NTkwfDNnc298NHRocHw1MFsxLTZdaXw3NzBzfDgwMnN8YSB3YXxhYmFjfGFjKGVyfG9vfHNcXC0pfGFpKGtvfHJuKXxhbChhdnxjYXxjbyl8YW1vaXxhbihleHxueXx5dyl8YXB0dXxhcihjaHxnbyl8YXModGV8dXMpfGF0dHd8YXUoZGl8XFwtbXxyIHxzICl8YXZhbnxiZShja3xsbHxucSl8YmkobGJ8cmQpfGJsKGFjfGF6KXxicihlfHYpd3xidW1ifGJ3XFwtKG58dSl8YzU1XFwvfGNhcGl8Y2N3YXxjZG1cXC18Y2VsbHxjaHRtfGNsZGN8Y21kXFwtfGNvKG1wfG5kKXxjcmF3fGRhKGl0fGxsfG5nKXxkYnRlfGRjXFwtc3xkZXZpfGRpY2F8ZG1vYnxkbyhjfHApb3xkcygxMnxcXC1kKXxlbCg0OXxhaSl8ZW0obDJ8dWwpfGVyKGljfGswKXxlc2w4fGV6KFs0LTddMHxvc3x3YXx6ZSl8ZmV0Y3xmbHkoXFwtfF8pfGcxIHV8ZzU2MHxnZW5lfGdmXFwtNXxnXFwtbW98Z28oXFwud3xvZCl8Z3IoYWR8dW4pfGhhaWV8aGNpdHxoZFxcLShtfHB8dCl8aGVpXFwtfGhpKHB0fHRhKXxocCggaXxpcCl8aHNcXC1jfGh0KGMoXFwtfCB8X3xhfGd8cHxzfHQpfHRwKXxodShhd3x0Yyl8aVxcLSgyMHxnb3xtYSl8aTIzMHxpYWMoIHxcXC18XFwvKXxpYnJvfGlkZWF8aWcwMXxpa29tfGltMWt8aW5ub3xpcGFxfGlyaXN8amEodHx2KWF8amJyb3xqZW11fGppZ3N8a2RkaXxrZWppfGtndCggfFxcLyl8a2xvbnxrcHQgfGt3Y1xcLXxreW8oY3xrKXxsZShub3x4aSl8bGcoIGd8XFwvKGt8bHx1KXw1MHw1NHxcXC1bYS13XSl8bGlid3xseW54fG0xXFwtd3xtM2dhfG01MFxcL3xtYSh0ZXx1aXx4byl8bWMoMDF8MjF8Y2EpfG1cXC1jcnxtZShyY3xyaSl8bWkobzh8b2F8dHMpfG1tZWZ8bW8oMDF8MDJ8Yml8ZGV8ZG98dChcXC18IHxvfHYpfHp6KXxtdCg1MHxwMXx2ICl8bXdicHxteXdhfG4xMFswLTJdfG4yMFsyLTNdfG4zMCgwfDIpfG41MCgwfDJ8NSl8bjcoMCgwfDEpfDEwKXxuZSgoY3xtKVxcLXxvbnx0Znx3Znx3Z3x3dCl8bm9rKDZ8aSl8bnpwaHxvMmltfG9wKHRpfHd2KXxvcmFufG93ZzF8cDgwMHxwYW4oYXxkfHQpfHBkeGd8cGcoMTN8XFwtKFsxLThdfGMpKXxwaGlsfHBpcmV8cGwoYXl8dWMpfHBuXFwtMnxwbyhja3xydHxzZSl8cHJveHxwc2lvfHB0XFwtZ3xxYVxcLWF8cWMoMDd8MTJ8MjF8MzJ8NjB8XFwtWzItN118aVxcLSl8cXRla3xyMzgwfHI2MDB8cmFrc3xyaW05fHJvKHZlfHpvKXxzNTVcXC98c2EoZ2V8bWF8bW18bXN8bnl8dmEpfHNjKDAxfGhcXC18b298cFxcLSl8c2RrXFwvfHNlKGMoXFwtfDB8MSl8NDd8bWN8bmR8cmkpfHNnaFxcLXxzaGFyfHNpZShcXC18bSl8c2tcXC0wfHNsKDQ1fGlkKXxzbShhbHxhcnxiM3xpdHx0NSl8c28oZnR8bnkpfHNwKDAxfGhcXC18dlxcLXx2ICl8c3koMDF8bWIpfHQyKDE4fDUwKXx0NigwMHwxMHwxOCl8dGEoZ3R8bGspfHRjbFxcLXx0ZGdcXC18dGVsKGl8bSl8dGltXFwtfHRcXC1tb3x0byhwbHxzaCl8dHMoNzB8bVxcLXxtM3xtNSl8dHhcXC05fHVwKFxcLmJ8ZzF8c2kpfHV0c3R8djQwMHx2NzUwfHZlcml8dmkocmd8dGUpfHZrKDQwfDVbMC0zXXxcXC12KXx2bTQwfHZvZGF8dnVsY3x2eCg1Mnw1M3w2MHw2MXw3MHw4MHw4MXw4M3w4NXw5OCl8dzNjKFxcLXwgKXx3ZWJjfHdoaXR8d2koZyB8bmN8bncpfHdtbGJ8d29udXx4NzAwfHlhc1xcLXx5b3VyfHpldG98enRlXFwtL2kudGVzdCh1YS5zdWJzdHIoMCwgNCkpO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vIERhdGEgSGFuZGxpbmcgLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8vYmxvY2sgdGFibGUgcmVkcmF3aW5nXG5UYWJ1bGF0b3IucHJvdG90eXBlLmJsb2NrUmVkcmF3ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmJsb2NrUmVkcmF3KCk7XG59O1xuXG4vL3Jlc3RvcmUgdGFibGUgcmVkcmF3aW5nXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlc3RvcmVSZWRyYXcgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLnJvd01hbmFnZXIucmVzdG9yZVJlZHJhdygpO1xufTtcblxuLy9sb2NhbCBkYXRhIGZyb20gbG9jYWwgZmlsZVxuVGFidWxhdG9yLnByb3RvdHlwZS5zZXREYXRhRnJvbUxvY2FsRmlsZSA9IGZ1bmN0aW9uIChleHRlbnNpb25zKSB7XG5cdHZhciBfdGhpczI1ID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcblx0XHRpbnB1dC50eXBlID0gXCJmaWxlXCI7XG5cdFx0aW5wdXQuYWNjZXB0ID0gZXh0ZW5zaW9ucyB8fCBcIi5qc29uLGFwcGxpY2F0aW9uL2pzb25cIjtcblxuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHZhciBmaWxlID0gaW5wdXQuZmlsZXNbMF0sXG5cdFx0XHQgICAgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKSxcblx0XHRcdCAgICBkYXRhO1xuXG5cdFx0XHRyZWFkZXIucmVhZEFzVGV4dChmaWxlKTtcblxuXHRcdFx0cmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG5cblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRkYXRhID0gSlNPTi5wYXJzZShyZWFkZXIucmVzdWx0KTtcblx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkZpbGUgTG9hZCBFcnJvciAtIEZpbGUgY29udGVudHMgaXMgaW52YWxpZCBKU09OXCIsIGUpO1xuXHRcdFx0XHRcdHJlamVjdChlKTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfdGhpczI1LnNldERhdGEoZGF0YSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdHJlc29sdmUoZGF0YSk7XG5cdFx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0XHRyZXNvbHZlKGVycik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fTtcblxuXHRcdFx0cmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJGaWxlIExvYWQgRXJyb3IgLSBVbmFibGUgdG8gcmVhZCBmaWxlXCIpO1xuXHRcdFx0XHRyZWplY3QoKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5jbGljaygpO1xuXHR9KTtcbn07XG5cbi8vbG9hZCBkYXRhXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldERhdGEgPSBmdW5jdGlvbiAoZGF0YSwgcGFyYW1zLCBjb25maWcpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiYWpheFwiKSkge1xuXHRcdHRoaXMubW9kdWxlcy5hamF4LmJsb2NrQWN0aXZlUmVxdWVzdCgpO1xuXHR9XG5cblx0cmV0dXJuIHRoaXMuX3NldERhdGEoZGF0YSwgcGFyYW1zLCBjb25maWcsIGZhbHNlLCB0cnVlKTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuX3NldERhdGEgPSBmdW5jdGlvbiAoZGF0YSwgcGFyYW1zLCBjb25maWcsIGluUG9zaXRpb24sIGNvbHVtbnNDaGFuZ2VkKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcblx0XHRpZiAoZGF0YS5pbmRleE9mKFwie1wiKSA9PSAwIHx8IGRhdGEuaW5kZXhPZihcIltcIikgPT0gMCkge1xuXHRcdFx0Ly9kYXRhIGlzIGEganNvbiBlbmNvZGVkIHN0cmluZ1xuXHRcdFx0cmV0dXJuIHNlbGYucm93TWFuYWdlci5zZXREYXRhKEpTT04ucGFyc2UoZGF0YSksIGluUG9zaXRpb24sIGNvbHVtbnNDaGFuZ2VkKTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoc2VsZi5tb2RFeGlzdHMoXCJhamF4XCIsIHRydWUpKSB7XG5cdFx0XHRcdGlmIChwYXJhbXMpIHtcblx0XHRcdFx0XHRzZWxmLm1vZHVsZXMuYWpheC5zZXRQYXJhbXMocGFyYW1zKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChjb25maWcpIHtcblx0XHRcdFx0XHRzZWxmLm1vZHVsZXMuYWpheC5zZXRDb25maWcoY29uZmlnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHNlbGYubW9kdWxlcy5hamF4LnNldFVybChkYXRhKTtcblxuXHRcdFx0XHRpZiAoc2VsZi5vcHRpb25zLnBhZ2luYXRpb24gPT0gXCJyZW1vdGVcIiAmJiBzZWxmLm1vZEV4aXN0cyhcInBhZ2VcIiwgdHJ1ZSkpIHtcblx0XHRcdFx0XHRzZWxmLm1vZHVsZXMucGFnZS5yZXNldCh0cnVlLCB0cnVlKTtcblx0XHRcdFx0XHRyZXR1cm4gc2VsZi5tb2R1bGVzLnBhZ2Uuc2V0UGFnZSgxKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvL2Fzc3VtZSBkYXRhIGlzIHVybCwgbWFrZSBhamF4IGNhbGwgdG8gdXJsIHRvIGdldCBkYXRhXG5cdFx0XHRcdFx0cmV0dXJuIHNlbGYubW9kdWxlcy5hamF4LmxvYWREYXRhKGluUG9zaXRpb24sIGNvbHVtbnNDaGFuZ2VkKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRpZiAoZGF0YSkge1xuXHRcdFx0Ly9hc3VtZSBkYXRhIGlzIGFscmVhZHkgYW4gb2JqZWN0XG5cdFx0XHRyZXR1cm4gc2VsZi5yb3dNYW5hZ2VyLnNldERhdGEoZGF0YSwgaW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vbm8gZGF0YSBwcm92aWRlZCwgY2hlY2sgaWYgYWpheFVSTCBpcyBwcmVzZW50O1xuXHRcdFx0aWYgKHNlbGYubW9kRXhpc3RzKFwiYWpheFwiKSAmJiAoc2VsZi5tb2R1bGVzLmFqYXguZ2V0VXJsIHx8IHNlbGYub3B0aW9ucy5hamF4VVJMR2VuZXJhdG9yKSkge1xuXG5cdFx0XHRcdGlmIChzZWxmLm9wdGlvbnMucGFnaW5hdGlvbiA9PSBcInJlbW90ZVwiICYmIHNlbGYubW9kRXhpc3RzKFwicGFnZVwiLCB0cnVlKSkge1xuXHRcdFx0XHRcdHNlbGYubW9kdWxlcy5wYWdlLnJlc2V0KHRydWUsIHRydWUpO1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLm1vZHVsZXMucGFnZS5zZXRQYWdlKDEpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLm1vZHVsZXMuYWpheC5sb2FkRGF0YShpblBvc2l0aW9uLCBjb2x1bW5zQ2hhbmdlZCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vZW1wdHkgZGF0YVxuXHRcdFx0XHRyZXR1cm4gc2VsZi5yb3dNYW5hZ2VyLnNldERhdGEoW10sIGluUG9zaXRpb24sIGNvbHVtbnNDaGFuZ2VkKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbi8vY2xlYXIgZGF0YVxuVGFidWxhdG9yLnByb3RvdHlwZS5jbGVhckRhdGEgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImFqYXhcIikpIHtcblx0XHR0aGlzLm1vZHVsZXMuYWpheC5ibG9ja0FjdGl2ZVJlcXVlc3QoKTtcblx0fVxuXG5cdHRoaXMucm93TWFuYWdlci5jbGVhckRhdGEoKTtcbn07XG5cbi8vZ2V0IHRhYmxlIGRhdGEgYXJyYXlcblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uIChhY3RpdmUpIHtcblxuXHRpZiAoYWN0aXZlID09PSB0cnVlKSB7XG5cdFx0Y29uc29sZS53YXJuKFwicGFzc2luZyBhIGJvb2xlYW4gdG8gdGhlIGdldERhdGEgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgcGFzcyB0aGUgc3RyaW5nICdhY3RpdmUnXCIpO1xuXHRcdGFjdGl2ZSA9IFwiYWN0aXZlXCI7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldERhdGEoYWN0aXZlKTtcbn07XG5cbi8vZ2V0IHRhYmxlIGRhdGEgYXJyYXkgY291bnRcblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0RGF0YUNvdW50ID0gZnVuY3Rpb24gKGFjdGl2ZSkge1xuXG5cdGlmIChhY3RpdmUgPT09IHRydWUpIHtcblx0XHRjb25zb2xlLndhcm4oXCJwYXNzaW5nIGEgYm9vbGVhbiB0byB0aGUgZ2V0RGF0YUNvdW50IGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQsIHlvdSBzaG91bGQgbm93IHBhc3MgdGhlIHN0cmluZyAnYWN0aXZlJ1wiKTtcblx0XHRhY3RpdmUgPSBcImFjdGl2ZVwiO1xuXHR9XG5cblx0cmV0dXJuIHRoaXMucm93TWFuYWdlci5nZXREYXRhQ291bnQoYWN0aXZlKTtcbn07XG5cbi8vc2VhcmNoIGZvciBzcGVjaWZpYyByb3cgY29tcG9uZW50c1xuVGFidWxhdG9yLnByb3RvdHlwZS5zZWFyY2hSb3dzID0gZnVuY3Rpb24gKGZpZWxkLCB0eXBlLCB2YWx1ZSkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLmZpbHRlci5zZWFyY2goXCJyb3dzXCIsIGZpZWxkLCB0eXBlLCB2YWx1ZSk7XG5cdH1cbn07XG5cbi8vc2VhcmNoIGZvciBzcGVjaWZpYyBkYXRhXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNlYXJjaERhdGEgPSBmdW5jdGlvbiAoZmllbGQsIHR5cGUsIHZhbHVlKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImZpbHRlclwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuZmlsdGVyLnNlYXJjaChcImRhdGFcIiwgZmllbGQsIHR5cGUsIHZhbHVlKTtcblx0fVxufTtcblxuLy9nZXQgdGFibGUgaHRtbFxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRIdG1sID0gZnVuY3Rpb24gKHZpc2libGUsIHN0eWxlLCBjb25maWcpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZXhwb3J0XCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5leHBvcnQuZ2V0SHRtbCh2aXNpYmxlLCBzdHlsZSwgY29uZmlnKTtcblx0fVxufTtcblxuLy9nZXQgcHJpbnQgaHRtbFxuVGFidWxhdG9yLnByb3RvdHlwZS5wcmludCA9IGZ1bmN0aW9uICh2aXNpYmxlLCBzdHlsZSwgY29uZmlnKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcInByaW50XCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5wcmludC5wcmludEZ1bGxzY3JlZW4odmlzaWJsZSwgc3R5bGUsIGNvbmZpZyk7XG5cdH1cbn07XG5cbi8vcmV0cmlldmUgQWpheCBVUkxcblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0QWpheFVybCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiYWpheFwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuYWpheC5nZXRVcmwoKTtcblx0fVxufTtcblxuLy9yZXBsYWNlIGRhdGEsIGtlZXBpbmcgdGFibGUgaW4gcG9zaXRpb24gd2l0aCBzYW1lIHNvcnRcblRhYnVsYXRvci5wcm90b3R5cGUucmVwbGFjZURhdGEgPSBmdW5jdGlvbiAoZGF0YSwgcGFyYW1zLCBjb25maWcpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiYWpheFwiKSkge1xuXHRcdHRoaXMubW9kdWxlcy5hamF4LmJsb2NrQWN0aXZlUmVxdWVzdCgpO1xuXHR9XG5cblx0cmV0dXJuIHRoaXMuX3NldERhdGEoZGF0YSwgcGFyYW1zLCBjb25maWcsIHRydWUpO1xufTtcblxuLy91cGRhdGUgdGFibGUgZGF0YVxuVGFidWxhdG9yLnByb3RvdHlwZS51cGRhdGVEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0dmFyIF90aGlzMjYgPSB0aGlzO1xuXG5cdHZhciBzZWxmID0gdGhpcztcblx0dmFyIHJlc3BvbnNlcyA9IDA7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAoX3RoaXMyNi5tb2RFeGlzdHMoXCJhamF4XCIpKSB7XG5cdFx0XHRfdGhpczI2Lm1vZHVsZXMuYWpheC5ibG9ja0FjdGl2ZVJlcXVlc3QoKTtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdH1cblxuXHRcdGlmIChkYXRhKSB7XG5cdFx0XHRkYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0dmFyIHJvdyA9IHNlbGYucm93TWFuYWdlci5maW5kUm93KGl0ZW1bc2VsZi5vcHRpb25zLmluZGV4XSk7XG5cblx0XHRcdFx0aWYgKHJvdykge1xuXHRcdFx0XHRcdHJlc3BvbnNlcysrO1xuXG5cdFx0XHRcdFx0cm93LnVwZGF0ZURhdGEoaXRlbSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRyZXNwb25zZXMtLTtcblxuXHRcdFx0XHRcdFx0aWYgKCFyZXNwb25zZXMpIHtcblx0XHRcdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVXBkYXRlIEVycm9yIC0gTm8gZGF0YSBwcm92aWRlZFwiKTtcblx0XHRcdHJlamVjdChcIlVwZGF0ZSBFcnJvciAtIE5vIGRhdGEgcHJvdmlkZWRcIik7XG5cdFx0fVxuXHR9KTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuYWRkRGF0YSA9IGZ1bmN0aW9uIChkYXRhLCBwb3MsIGluZGV4KSB7XG5cdHZhciBfdGhpczI3ID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmIChfdGhpczI3Lm1vZEV4aXN0cyhcImFqYXhcIikpIHtcblx0XHRcdF90aGlzMjcubW9kdWxlcy5hamF4LmJsb2NrQWN0aXZlUmVxdWVzdCgpO1xuXHRcdH1cblxuXHRcdGlmICh0eXBlb2YgZGF0YSA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0ZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdFx0fVxuXG5cdFx0aWYgKGRhdGEpIHtcblx0XHRcdF90aGlzMjcucm93TWFuYWdlci5hZGRSb3dzKGRhdGEsIHBvcywgaW5kZXgpLnRoZW4oZnVuY3Rpb24gKHJvd3MpIHtcblx0XHRcdFx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdFx0XHRcdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRcdFx0b3V0cHV0LnB1c2gocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0cmVzb2x2ZShvdXRwdXQpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlVwZGF0ZSBFcnJvciAtIE5vIGRhdGEgcHJvdmlkZWRcIik7XG5cdFx0XHRyZWplY3QoXCJVcGRhdGUgRXJyb3IgLSBObyBkYXRhIHByb3ZpZGVkXCIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vL3VwZGF0ZSB0YWJsZSBkYXRhXG5UYWJ1bGF0b3IucHJvdG90eXBlLnVwZGF0ZU9yQWRkRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBfdGhpczI4ID0gdGhpcztcblxuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICByb3dzID0gW10sXG5cdCAgICByZXNwb25zZXMgPSAwO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0aWYgKF90aGlzMjgubW9kRXhpc3RzKFwiYWpheFwiKSkge1xuXHRcdFx0X3RoaXMyOC5tb2R1bGVzLmFqYXguYmxvY2tBY3RpdmVSZXF1ZXN0KCk7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHR9XG5cblx0XHRpZiAoZGF0YSkge1xuXHRcdFx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdHZhciByb3cgPSBzZWxmLnJvd01hbmFnZXIuZmluZFJvdyhpdGVtW3NlbGYub3B0aW9ucy5pbmRleF0pO1xuXG5cdFx0XHRcdHJlc3BvbnNlcysrO1xuXG5cdFx0XHRcdGlmIChyb3cpIHtcblx0XHRcdFx0XHRyb3cudXBkYXRlRGF0YShpdGVtKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdHJlc3BvbnNlcy0tO1xuXHRcdFx0XHRcdFx0cm93cy5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cblx0XHRcdFx0XHRcdGlmICghcmVzcG9uc2VzKSB7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUocm93cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2VsZi5yb3dNYW5hZ2VyLmFkZFJvd3MoaXRlbSkudGhlbihmdW5jdGlvbiAobmV3Um93cykge1xuXHRcdFx0XHRcdFx0cmVzcG9uc2VzLS07XG5cdFx0XHRcdFx0XHRyb3dzLnB1c2gobmV3Um93c1swXS5nZXRDb21wb25lbnQoKSk7XG5cblx0XHRcdFx0XHRcdGlmICghcmVzcG9uc2VzKSB7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUocm93cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJVcGRhdGUgRXJyb3IgLSBObyBkYXRhIHByb3ZpZGVkXCIpO1xuXHRcdFx0cmVqZWN0KFwiVXBkYXRlIEVycm9yIC0gTm8gZGF0YSBwcm92aWRlZFwiKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLy9nZXQgcm93IG9iamVjdFxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0dmFyIHJvdyA9IHRoaXMucm93TWFuYWdlci5maW5kUm93KGluZGV4KTtcblxuXHRpZiAocm93KSB7XG5cdFx0cmV0dXJuIHJvdy5nZXRDb21wb25lbnQoKTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJGaW5kIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG4vL2dldCByb3cgb2JqZWN0XG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldFJvd0Zyb21Qb3NpdGlvbiA9IGZ1bmN0aW9uIChwb3NpdGlvbiwgYWN0aXZlKSB7XG5cdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZ2V0Um93RnJvbVBvc2l0aW9uKHBvc2l0aW9uLCBhY3RpdmUpO1xuXG5cdGlmIChyb3cpIHtcblx0XHRyZXR1cm4gcm93LmdldENvbXBvbmVudCgpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIkZpbmQgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIHBvc2l0aW9uKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cbi8vZGVsZXRlIHJvdyBmcm9tIHRhYmxlXG5UYWJ1bGF0b3IucHJvdG90eXBlLmRlbGV0ZVJvdyA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHR2YXIgX3RoaXMyOSA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgc2VsZiA9IF90aGlzMjksXG5cdFx0ICAgIGNvdW50ID0gMCxcblx0XHQgICAgc3VjY2Vzc0NvdW50ID0gMCxcblx0XHQgICAgZm91bmRSb3dzID0gW107XG5cblx0XHRmdW5jdGlvbiBkb25lQ2hlY2soKSB7XG5cdFx0XHRjb3VudCsrO1xuXG5cdFx0XHRpZiAoY291bnQgPT0gaW5kZXgubGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChzdWNjZXNzQ291bnQpIHtcblx0XHRcdFx0XHRzZWxmLnJvd01hbmFnZXIucmVSZW5kZXJJblBvc2l0aW9uKCk7XG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGluZGV4KSkge1xuXHRcdFx0aW5kZXggPSBbaW5kZXhdO1xuXHRcdH1cblxuXHRcdC8vZmluZCBtYXRjaGluZyByb3dzXG5cdFx0aW5kZXguZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0dmFyIHJvdyA9IF90aGlzMjkucm93TWFuYWdlci5maW5kUm93KGl0ZW0sIHRydWUpO1xuXG5cdFx0XHRpZiAocm93KSB7XG5cdFx0XHRcdGZvdW5kUm93cy5wdXNoKHJvdyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJEZWxldGUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIGl0ZW0pO1xuXHRcdFx0XHRyZWplY3QoXCJEZWxldGUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmRcIik7XG5cdFx0XHRcdGRvbmVDaGVjaygpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly9zb3J0IHJvd3MgaW50byBjb3JyZWN0IG9yZGVyIHRvIGVuc3VyZSBzbW9vdGggZGVsZXRlIGZyb20gdGFibGVcblx0XHRmb3VuZFJvd3Muc29ydChmdW5jdGlvbiAoYSwgYikge1xuXHRcdFx0cmV0dXJuIF90aGlzMjkucm93TWFuYWdlci5yb3dzLmluZGV4T2YoYSkgPiBfdGhpczI5LnJvd01hbmFnZXIucm93cy5pbmRleE9mKGIpID8gMSA6IC0xO1xuXHRcdH0pO1xuXG5cdFx0Zm91bmRSb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0cm93LmRlbGV0ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzdWNjZXNzQ291bnQrKztcblx0XHRcdFx0ZG9uZUNoZWNrKCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdGRvbmVDaGVjaygpO1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9KTtcbn07XG5cbi8vYWRkIHJvdyB0byB0YWJsZVxuVGFidWxhdG9yLnByb3RvdHlwZS5hZGRSb3cgPSBmdW5jdGlvbiAoZGF0YSwgcG9zLCBpbmRleCkge1xuXHR2YXIgX3RoaXMzMCA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdH1cblxuXHRcdF90aGlzMzAucm93TWFuYWdlci5hZGRSb3dzKGRhdGEsIHBvcywgaW5kZXgpLnRoZW4oZnVuY3Rpb24gKHJvd3MpIHtcblx0XHRcdC8vcmVjYWxjIGNvbHVtbiBjYWxjdWxhdGlvbnMgaWYgcHJlc2VudFxuXHRcdFx0aWYgKF90aGlzMzAubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRcdFx0X3RoaXMzMC5tb2R1bGVzLmNvbHVtbkNhbGNzLnJlY2FsYyhfdGhpczMwLnJvd01hbmFnZXIuYWN0aXZlUm93cyk7XG5cdFx0XHR9XG5cblx0XHRcdHJlc29sdmUocm93c1swXS5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH0pO1xufTtcblxuLy91cGRhdGUgYSByb3cgaWYgaXQgZXhpdHN0cyBvdGhlcndpc2UgY3JlYXRlIGl0XG5UYWJ1bGF0b3IucHJvdG90eXBlLnVwZGF0ZU9yQWRkUm93ID0gZnVuY3Rpb24gKGluZGV4LCBkYXRhKSB7XG5cdHZhciBfdGhpczMxID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciByb3cgPSBfdGhpczMxLnJvd01hbmFnZXIuZmluZFJvdyhpbmRleCk7XG5cblx0XHRpZiAodHlwZW9mIGRhdGEgPT09IFwic3RyaW5nXCIpIHtcblx0XHRcdGRhdGEgPSBKU09OLnBhcnNlKGRhdGEpO1xuXHRcdH1cblxuXHRcdGlmIChyb3cpIHtcblx0XHRcdHJvdy51cGRhdGVEYXRhKGRhdGEpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHQvL3JlY2FsYyBjb2x1bW4gY2FsY3VsYXRpb25zIGlmIHByZXNlbnRcblx0XHRcdFx0aWYgKF90aGlzMzEubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRcdFx0XHRfdGhpczMxLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjKF90aGlzMzEucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlc29sdmUocm93LmdldENvbXBvbmVudCgpKTtcblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cm93ID0gX3RoaXMzMS5yb3dNYW5hZ2VyLmFkZFJvd3MoZGF0YSkudGhlbihmdW5jdGlvbiAocm93cykge1xuXHRcdFx0XHQvL3JlY2FsYyBjb2x1bW4gY2FsY3VsYXRpb25zIGlmIHByZXNlbnRcblx0XHRcdFx0aWYgKF90aGlzMzEubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRcdFx0XHRfdGhpczMxLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjKF90aGlzMzEucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlc29sdmUocm93c1swXS5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8vdXBkYXRlIHJvdyBkYXRhXG5UYWJ1bGF0b3IucHJvdG90eXBlLnVwZGF0ZVJvdyA9IGZ1bmN0aW9uIChpbmRleCwgZGF0YSkge1xuXHR2YXIgX3RoaXMzMiA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgcm93ID0gX3RoaXMzMi5yb3dNYW5hZ2VyLmZpbmRSb3coaW5kZXgpO1xuXG5cdFx0aWYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcblx0XHR9XG5cblx0XHRpZiAocm93KSB7XG5cdFx0XHRyb3cudXBkYXRlRGF0YShkYXRhKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmVzb2x2ZShyb3cuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJVcGRhdGUgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmQ6XCIsIGluZGV4KTtcblx0XHRcdHJlamVjdChcIlVwZGF0ZSBFcnJvciAtIE5vIG1hdGNoaW5nIHJvdyBmb3VuZFwiKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLy9zY3JvbGwgdG8gcm93IGluIERPTVxuVGFidWxhdG9yLnByb3RvdHlwZS5zY3JvbGxUb1JvdyA9IGZ1bmN0aW9uIChpbmRleCwgcG9zaXRpb24sIGlmVmlzaWJsZSkge1xuXHR2YXIgX3RoaXMzMyA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgcm93ID0gX3RoaXMzMy5yb3dNYW5hZ2VyLmZpbmRSb3coaW5kZXgpO1xuXG5cdFx0aWYgKHJvdykge1xuXHRcdFx0X3RoaXMzMy5yb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHJvdywgcG9zaXRpb24sIGlmVmlzaWJsZSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiU2Nyb2xsIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0XHRyZWplY3QoXCJTY3JvbGwgRXJyb3IgLSBObyBtYXRjaGluZyByb3cgZm91bmRcIik7XG5cdFx0fVxuXHR9KTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUubW92ZVJvdyA9IGZ1bmN0aW9uIChmcm9tLCB0bywgYWZ0ZXIpIHtcblx0dmFyIGZyb21Sb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhmcm9tKTtcblxuXHRpZiAoZnJvbVJvdykge1xuXHRcdGZyb21Sb3cubW92ZVRvUm93KHRvLCBhZnRlcik7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiTW92ZSBFcnJvciAtIE5vIG1hdGNoaW5nIHJvdyBmb3VuZDpcIiwgZnJvbSk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uIChhY3RpdmUpIHtcblxuXHRpZiAoYWN0aXZlID09PSB0cnVlKSB7XG5cdFx0Y29uc29sZS53YXJuKFwicGFzc2luZyBhIGJvb2xlYW4gdG8gdGhlIGdldFJvd3MgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgcGFzcyB0aGUgc3RyaW5nICdhY3RpdmUnXCIpO1xuXHRcdGFjdGl2ZSA9IFwiYWN0aXZlXCI7XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5yb3dNYW5hZ2VyLmdldENvbXBvbmVudHMoYWN0aXZlKTtcbn07XG5cbi8vZ2V0IHBvc2l0aW9uIG9mIHJvdyBpbiB0YWJsZVxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRSb3dQb3NpdGlvbiA9IGZ1bmN0aW9uIChpbmRleCwgYWN0aXZlKSB7XG5cdHZhciByb3cgPSB0aGlzLnJvd01hbmFnZXIuZmluZFJvdyhpbmRleCk7XG5cblx0aWYgKHJvdykge1xuXHRcdHJldHVybiB0aGlzLnJvd01hbmFnZXIuZ2V0Um93UG9zaXRpb24ocm93LCBhY3RpdmUpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIlBvc2l0aW9uIEVycm9yIC0gTm8gbWF0Y2hpbmcgcm93IGZvdW5kOlwiLCBpbmRleCk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG4vL2NvcHkgdGFibGUgZGF0YSB0byBjbGlwYm9hcmRcblRhYnVsYXRvci5wcm90b3R5cGUuY29weVRvQ2xpcGJvYXJkID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImNsaXBib2FyZFwiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5jbGlwYm9hcmQuY29weShzZWxlY3Rvcik7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLyBDb2x1bW4gRnVuY3Rpb25zICAvLy8vLy8vLy8vLy8vLy9cblxuVGFidWxhdG9yLnByb3RvdHlwZS5zZXRDb2x1bW5zID0gZnVuY3Rpb24gKGRlZmluaXRpb24pIHtcblx0dGhpcy5jb2x1bW5NYW5hZ2VyLnNldENvbHVtbnMoZGVmaW5pdGlvbik7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoc3RydWN0dXJlZCkge1xuXHRyZXR1cm4gdGhpcy5jb2x1bW5NYW5hZ2VyLmdldENvbXBvbmVudHMoc3RydWN0dXJlZCk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldENvbHVtbiA9IGZ1bmN0aW9uIChmaWVsZCkge1xuXHR2YXIgY29sID0gdGhpcy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdGlmIChjb2wpIHtcblx0XHRyZXR1cm4gY29sLmdldENvbXBvbmVudCgpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIkZpbmQgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0Q29sdW1uRGVmaW5pdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmNvbHVtbk1hbmFnZXIuZ2V0RGVmaW5pdGlvblRyZWUoKTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0Q29sdW1uTGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMucGVyc2lzdGVuY2UucGFyc2VDb2x1bW5zKHRoaXMuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5zKCkpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldENvbHVtbkxheW91dCA9IGZ1bmN0aW9uIChsYXlvdXQpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLmNvbHVtbk1hbmFnZXIuc2V0Q29sdW1ucyh0aGlzLm1vZHVsZXMucGVyc2lzdGVuY2UubWVyZ2VEZWZpbml0aW9uKHRoaXMub3B0aW9ucy5jb2x1bW5zLCBsYXlvdXQpKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNob3dDb2x1bW4gPSBmdW5jdGlvbiAoZmllbGQpIHtcblx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblxuXHRpZiAoY29sdW1uKSB7XG5cdFx0Y29sdW1uLnNob3coKTtcblxuXHRcdGlmICh0aGlzLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCAmJiB0aGlzLm1vZEV4aXN0cyhcInJlc3BvbnNpdmVMYXlvdXRcIiwgdHJ1ZSkpIHtcblx0XHRcdHRoaXMubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gU2hvdyBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgZmllbGQpO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5oaWRlQ29sdW1uID0gZnVuY3Rpb24gKGZpZWxkKSB7XG5cdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cblx0aWYgKGNvbHVtbikge1xuXHRcdGNvbHVtbi5oaWRlKCk7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKSB7XG5cdFx0XHR0aGlzLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEhpZGUgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUudG9nZ2xlQ29sdW1uID0gZnVuY3Rpb24gKGZpZWxkKSB7XG5cdHZhciBjb2x1bW4gPSB0aGlzLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cblx0aWYgKGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4udmlzaWJsZSkge1xuXHRcdFx0Y29sdW1uLmhpZGUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29sdW1uLnNob3coKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIFZpc2liaWxpdHkgVG9nZ2xlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmFkZENvbHVtbiA9IGZ1bmN0aW9uIChkZWZpbml0aW9uLCBiZWZvcmUsIGZpZWxkKSB7XG5cdHZhciBfdGhpczM0ID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBjb2x1bW4gPSBfdGhpczM0LmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbihmaWVsZCk7XG5cblx0XHRfdGhpczM0LmNvbHVtbk1hbmFnZXIuYWRkQ29sdW1uKGRlZmluaXRpb24sIGJlZm9yZSwgY29sdW1uKS50aGVuKGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0XHRcdHJlc29sdmUoY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRyZWplY3QoZXJyKTtcblx0XHR9KTtcblx0fSk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmRlbGV0ZUNvbHVtbiA9IGZ1bmN0aW9uIChmaWVsZCkge1xuXHR2YXIgX3RoaXMzNSA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgY29sdW1uID0gX3RoaXMzNS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0Y29sdW1uLmRlbGV0ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBEZWxldGUgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnVwZGF0ZUNvbHVtbkRlZmluaXRpb24gPSBmdW5jdGlvbiAoZmllbGQsIGRlZmluaXRpb24pIHtcblx0dmFyIF90aGlzMzYgPSB0aGlzO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIGNvbHVtbiA9IF90aGlzMzYuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblxuXHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdGNvbHVtbi51cGRhdGVEZWZpbml0aW9uKGRlZmluaXRpb24pLnRoZW4oZnVuY3Rpb24gKGNvbCkge1xuXHRcdFx0XHRyZXNvbHZlKGNvbCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBVcGRhdGUgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm1vdmVDb2x1bW4gPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGFmdGVyKSB7XG5cdHZhciBmcm9tQ29sdW1uID0gdGhpcy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZnJvbSk7XG5cdHZhciB0b0NvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKHRvKTtcblxuXHRpZiAoZnJvbUNvbHVtbikge1xuXHRcdGlmICh0b0NvbHVtbikge1xuXHRcdFx0dGhpcy5jb2x1bW5NYW5hZ2VyLm1vdmVDb2x1bW4oZnJvbUNvbHVtbiwgdG9Db2x1bW4sIGFmdGVyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiTW92ZSBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgdG9Db2x1bW4pO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmcm9tKTtcblx0fVxufTtcblxuLy9zY3JvbGwgdG8gY29sdW1uIGluIERPTVxuVGFidWxhdG9yLnByb3RvdHlwZS5zY3JvbGxUb0NvbHVtbiA9IGZ1bmN0aW9uIChmaWVsZCwgcG9zaXRpb24sIGlmVmlzaWJsZSkge1xuXHR2YXIgX3RoaXMzNyA9IHRoaXM7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgY29sdW1uID0gX3RoaXMzNy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0X3RoaXMzNy5jb2x1bW5NYW5hZ2VyLnNjcm9sbFRvQ29sdW1uKGNvbHVtbiwgcG9zaXRpb24sIGlmVmlzaWJsZSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiU2Nyb2xsIEVycm9yIC0gTm8gbWF0Y2hpbmcgY29sdW1uIGZvdW5kOlwiLCBmaWVsZCk7XG5cdFx0XHRyZWplY3QoXCJTY3JvbGwgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmRcIik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8vLy8vLy8vLy8vLyBMb2NhbGl6YXRpb24gRnVuY3Rpb25zICAvLy8vLy8vLy8vLy9cblRhYnVsYXRvci5wcm90b3R5cGUuc2V0TG9jYWxlID0gZnVuY3Rpb24gKGxvY2FsZSkge1xuXHR0aGlzLm1vZHVsZXMubG9jYWxpemUuc2V0TG9jYWxlKGxvY2FsZSk7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldExvY2FsZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMubW9kdWxlcy5sb2NhbGl6ZS5nZXRMb2NhbGUoKTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0TGFuZyA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcblx0cmV0dXJuIHRoaXMubW9kdWxlcy5sb2NhbGl6ZS5nZXRMYW5nKGxvY2FsZSk7XG59O1xuXG4vLy8vLy8vLy8vLy8gR2VuZXJhbCBQdWJsaWMgRnVuY3Rpb25zIC8vLy8vLy8vLy8vL1xuXG4vL3JlZHJhdyBsaXN0IHdpdGhvdXQgdXBkYXRpbmcgZGF0YVxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAoZm9yY2UpIHtcblx0dGhpcy5jb2x1bW5NYW5hZ2VyLnJlZHJhdyhmb3JjZSk7XG5cdHRoaXMucm93TWFuYWdlci5yZWRyYXcoZm9yY2UpO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5zZXRIZWlnaHQgPSBmdW5jdGlvbiAoaGVpZ2h0KSB7XG5cblx0aWYgKHRoaXMucm93TWFuYWdlci5yZW5kZXJNb2RlICE9PSBcImNsYXNzaWNcIikge1xuXHRcdHRoaXMub3B0aW9ucy5oZWlnaHQgPSBpc05hTihoZWlnaHQpID8gaGVpZ2h0IDogaGVpZ2h0ICsgXCJweFwiO1xuXHRcdHRoaXMuZWxlbWVudC5zdHlsZS5oZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0O1xuXHRcdHRoaXMucm93TWFuYWdlci5zZXRSZW5kZXJNb2RlKCk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLnJlZHJhdygpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcInNldEhlaWdodCBmdW5jdGlvbiBpcyBub3QgYXZhaWxhYmxlIGluIGNsYXNzaWMgcmVuZGVyIG1vZGVcIik7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLyBTb3J0aW5nIC8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbi8vdHJpZ2dlciBzb3J0XG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldFNvcnQgPSBmdW5jdGlvbiAoc29ydExpc3QsIGRpcikge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJzb3J0XCIsIHRydWUpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnNvcnQuc2V0U29ydChzb3J0TGlzdCwgZGlyKTtcblx0XHR0aGlzLnJvd01hbmFnZXIuc29ydGVyUmVmcmVzaCgpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldFNvcnRlcnMgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcInNvcnRcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLnNvcnQuZ2V0U29ydCgpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmNsZWFyU29ydCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwic29ydFwiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5zb3J0LmNsZWFyKCk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLnNvcnRlclJlZnJlc2goKTtcblx0fVxufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vIEZpbHRlcmluZyAvLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vL3NldCBzdGFuZGFyZCBmaWx0ZXJzXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldEZpbHRlciA9IGZ1bmN0aW9uIChmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcykge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLm1vZHVsZXMuZmlsdGVyLnNldEZpbHRlcihmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcyk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLmZpbHRlclJlZnJlc2goKTtcblx0fVxufTtcblxuLy9zZXQgc3RhbmRhcmQgZmlsdGVyc1xuVGFidWxhdG9yLnByb3RvdHlwZS5yZWZyZXNoRmlsdGVyID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLnJvd01hbmFnZXIuZmlsdGVyUmVmcmVzaCgpO1xuXHR9XG59O1xuXG4vL2FkZCBmaWx0ZXIgdG8gYXJyYXlcblRhYnVsYXRvci5wcm90b3R5cGUuYWRkRmlsdGVyID0gZnVuY3Rpb24gKGZpZWxkLCB0eXBlLCB2YWx1ZSwgcGFyYW1zKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImZpbHRlclwiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5maWx0ZXIuYWRkRmlsdGVyKGZpZWxkLCB0eXBlLCB2YWx1ZSwgcGFyYW1zKTtcblx0XHR0aGlzLnJvd01hbmFnZXIuZmlsdGVyUmVmcmVzaCgpO1xuXHR9XG59O1xuXG4vL2dldCBhbGwgZmlsdGVyc1xuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRGaWx0ZXJzID0gZnVuY3Rpb24gKGFsbCkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLmZpbHRlci5nZXRGaWx0ZXJzKGFsbCk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuc2V0SGVhZGVyRmlsdGVyRm9jdXMgPSBmdW5jdGlvbiAoZmllbGQpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblxuXHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdHRoaXMubW9kdWxlcy5maWx0ZXIuc2V0SGVhZGVyRmlsdGVyRm9jdXMoY29sdW1uKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEZpbHRlciBGb2N1cyBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgZmllbGQpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRIZWFkZXJGaWx0ZXJWYWx1ZSA9IGZ1bmN0aW9uIChmaWVsZCkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR2YXIgY29sdW1uID0gdGhpcy5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW4oZmllbGQpO1xuXG5cdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5maWx0ZXIuZ2V0SGVhZGVyRmlsdGVyVmFsdWUoY29sdW1uKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIEZpbHRlciBFcnJvciAtIE5vIG1hdGNoaW5nIGNvbHVtbiBmb3VuZDpcIiwgZmllbGQpO1xuXHRcdH1cblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5zZXRIZWFkZXJGaWx0ZXJWYWx1ZSA9IGZ1bmN0aW9uIChmaWVsZCwgdmFsdWUpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0dmFyIGNvbHVtbiA9IHRoaXMuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGZpZWxkKTtcblxuXHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdHRoaXMubW9kdWxlcy5maWx0ZXIuc2V0SGVhZGVyRmlsdGVyVmFsdWUoY29sdW1uLCB2YWx1ZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBtYXRjaGluZyBjb2x1bW4gZm91bmQ6XCIsIGZpZWxkKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0SGVhZGVyRmlsdGVycyA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5maWx0ZXIuZ2V0SGVhZGVyRmlsdGVycygpO1xuXHR9XG59O1xuXG4vL3JlbW92ZSBmaWx0ZXIgZnJvbSBhcnJheVxuVGFidWxhdG9yLnByb3RvdHlwZS5yZW1vdmVGaWx0ZXIgPSBmdW5jdGlvbiAoZmllbGQsIHR5cGUsIHZhbHVlKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImZpbHRlclwiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5maWx0ZXIucmVtb3ZlRmlsdGVyKGZpZWxkLCB0eXBlLCB2YWx1ZSk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLmZpbHRlclJlZnJlc2goKTtcblx0fVxufTtcblxuLy9jbGVhciBmaWx0ZXJzXG5UYWJ1bGF0b3IucHJvdG90eXBlLmNsZWFyRmlsdGVyID0gZnVuY3Rpb24gKGFsbCkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJmaWx0ZXJcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLm1vZHVsZXMuZmlsdGVyLmNsZWFyRmlsdGVyKGFsbCk7XG5cdFx0dGhpcy5yb3dNYW5hZ2VyLmZpbHRlclJlZnJlc2goKTtcblx0fVxufTtcblxuLy9jbGVhciBoZWFkZXIgZmlsdGVyc1xuVGFidWxhdG9yLnByb3RvdHlwZS5jbGVhckhlYWRlckZpbHRlciA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZmlsdGVyXCIsIHRydWUpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLmZpbHRlci5jbGVhckhlYWRlckZpbHRlcigpO1xuXHRcdHRoaXMucm93TWFuYWdlci5maWx0ZXJSZWZyZXNoKCk7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLyBzZWxlY3QgLy8vLy8vLy8vLy8vLy8vLy8vLy9cblRhYnVsYXRvci5wcm90b3R5cGUuc2VsZWN0Um93ID0gZnVuY3Rpb24gKHJvd3MpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwic2VsZWN0Um93XCIsIHRydWUpKSB7XG5cdFx0aWYgKHJvd3MgPT09IHRydWUpIHtcblx0XHRcdGNvbnNvbGUud2FybihcInBhc3NpbmcgYSBib29sZWFuIHRvIHRoZSBzZWxlY3RSb3dzZWxlY3RSb3cgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgcGFzcyB0aGUgc3RyaW5nICdhY3RpdmUnXCIpO1xuXHRcdFx0cm93cyA9IFwiYWN0aXZlXCI7XG5cdFx0fVxuXHRcdHRoaXMubW9kdWxlcy5zZWxlY3RSb3cuc2VsZWN0Um93cyhyb3dzKTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5kZXNlbGVjdFJvdyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcInNlbGVjdFJvd1wiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5zZWxlY3RSb3cuZGVzZWxlY3RSb3dzKHJvd3MpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnRvZ2dsZVNlbGVjdFJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwic2VsZWN0Um93XCIsIHRydWUpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnNlbGVjdFJvdy50b2dnbGVSb3cocm93KTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRTZWxlY3RlZFJvd3MgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcInNlbGVjdFJvd1wiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuc2VsZWN0Um93LmdldFNlbGVjdGVkUm93cygpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldFNlbGVjdGVkRGF0YSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwic2VsZWN0Um93XCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5zZWxlY3RSb3cuZ2V0U2VsZWN0ZWREYXRhKCk7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLyB2YWxpZGF0aW9uICAvLy8vLy8vLy8vLy8vLy8vLy8vL1xuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRJbnZhbGlkQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcInZhbGlkYXRlXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy52YWxpZGF0ZS5nZXRJbnZhbGlkQ2VsbHMoKTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5jbGVhckNlbGxWYWxpZGF0aW9uID0gZnVuY3Rpb24gKGNlbGxzKSB7XG5cdHZhciBfdGhpczM4ID0gdGhpcztcblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJ2YWxpZGF0ZVwiLCB0cnVlKSkge1xuXG5cdFx0aWYgKCFjZWxscykge1xuXHRcdFx0Y2VsbHMgPSB0aGlzLm1vZHVsZXMudmFsaWRhdGUuZ2V0SW52YWxpZENlbGxzKCk7XG5cdFx0fVxuXG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KGNlbGxzKSkge1xuXHRcdFx0Y2VsbHMgPSBbY2VsbHNdO1xuXHRcdH1cblxuXHRcdGNlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRcdF90aGlzMzgubW9kdWxlcy52YWxpZGF0ZS5jbGVhclZhbGlkYXRpb24oY2VsbC5fZ2V0U2VsZigpKTtcblx0XHR9KTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS52YWxpZGF0ZSA9IGZ1bmN0aW9uIChjZWxscykge1xuXHR2YXIgb3V0cHV0ID0gW107XG5cblx0Ly9jbGVhciByb3cgZGF0YVxuXHR0aGlzLnJvd01hbmFnZXIucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHR2YXIgdmFsaWQgPSByb3cudmFsaWRhdGUoKTtcblxuXHRcdGlmICh2YWxpZCAhPT0gdHJ1ZSkge1xuXHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdCh2YWxpZCk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0Lmxlbmd0aCA/IG91dHB1dCA6IHRydWU7XG59O1xuXG4vLy8vLy8vLy8vLy8gUGFnaW5hdGlvbiBGdW5jdGlvbnMgIC8vLy8vLy8vLy8vL1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldE1heFBhZ2UgPSBmdW5jdGlvbiAobWF4KSB7XG5cdGlmICh0aGlzLm9wdGlvbnMucGFnaW5hdGlvbiAmJiB0aGlzLm1vZEV4aXN0cyhcInBhZ2VcIikpIHtcblx0XHR0aGlzLm1vZHVsZXMucGFnZS5zZXRNYXhQYWdlKG1heCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldFBhZ2UgPSBmdW5jdGlvbiAocGFnZSkge1xuXHRpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5wYWdlLnNldFBhZ2UocGFnZSk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH0pO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldFBhZ2VUb1JvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIF90aGlzMzkgPSB0aGlzO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0aWYgKF90aGlzMzkub3B0aW9ucy5wYWdpbmF0aW9uICYmIF90aGlzMzkubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdFx0cm93ID0gX3RoaXMzOS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93KTtcblxuXHRcdFx0aWYgKHJvdykge1xuXHRcdFx0XHRfdGhpczM5Lm1vZHVsZXMucGFnZS5zZXRQYWdlVG9Sb3cocm93KS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRyZWplY3QoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZWplY3QoKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVqZWN0KCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuc2V0UGFnZVNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuXHRpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnBhZ2Uuc2V0UGFnZVNpemUoc2l6ZSk7XG5cdFx0dGhpcy5tb2R1bGVzLnBhZ2Uuc2V0UGFnZSgxKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldFBhZ2VTaXplID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy5tb2RFeGlzdHMoXCJwYWdlXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5wYWdlLmdldFBhZ2VTaXplKCk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucHJldmlvdXNQYWdlID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnBhZ2UucHJldmlvdXNQYWdlKCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm5leHRQYWdlID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5vcHRpb25zLnBhZ2luYXRpb24gJiYgdGhpcy5tb2RFeGlzdHMoXCJwYWdlXCIpKSB7XG5cdFx0dGhpcy5tb2R1bGVzLnBhZ2UubmV4dFBhZ2UoKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0UGFnZSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMub3B0aW9ucy5wYWdpbmF0aW9uICYmIHRoaXMubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMucGFnZS5nZXRQYWdlKCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldFBhZ2VNYXggPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm9wdGlvbnMucGFnaW5hdGlvbiAmJiB0aGlzLm1vZEV4aXN0cyhcInBhZ2VcIikpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLnBhZ2UuZ2V0UGFnZU1heCgpO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8gR3JvdXBpbmcgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy8vL1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldEdyb3VwQnkgPSBmdW5jdGlvbiAoZ3JvdXBzKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiLCB0cnVlKSkge1xuXHRcdHRoaXMub3B0aW9ucy5ncm91cEJ5ID0gZ3JvdXBzO1xuXHRcdHRoaXMubW9kdWxlcy5ncm91cFJvd3MuaW5pdGlhbGl6ZSgpO1xuXHRcdHRoaXMucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImRpc3BsYXlcIik7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlICYmIHRoaXMubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgdGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5ncm91cCkge1xuXHRcdFx0dGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJncm91cFwiKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldEdyb3VwVmFsdWVzID0gZnVuY3Rpb24gKGdyb3VwVmFsdWVzKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiLCB0cnVlKSkge1xuXHRcdHRoaXMub3B0aW9ucy5ncm91cFZhbHVlcyA9IGdyb3VwVmFsdWVzO1xuXHRcdHRoaXMubW9kdWxlcy5ncm91cFJvd3MuaW5pdGlhbGl6ZSgpO1xuXHRcdHRoaXMucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImRpc3BsYXlcIik7XG5cblx0XHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlICYmIHRoaXMubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgdGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5ncm91cCkge1xuXHRcdFx0dGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJncm91cFwiKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnNldEdyb3VwU3RhcnRPcGVuID0gZnVuY3Rpb24gKHZhbHVlcykge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJncm91cFJvd3NcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLm9wdGlvbnMuZ3JvdXBTdGFydE9wZW4gPSB2YWx1ZXM7XG5cdFx0dGhpcy5tb2R1bGVzLmdyb3VwUm93cy5pbml0aWFsaXplKCk7XG5cdFx0aWYgKHRoaXMub3B0aW9ucy5ncm91cEJ5KSB7XG5cdFx0XHR0aGlzLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJncm91cFwiKTtcblxuXHRcdFx0aWYgKHRoaXMub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuZ3JvdXApIHtcblx0XHRcdFx0dGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJncm91cFwiKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiR3JvdXBpbmcgVXBkYXRlIC0gY2FudCByZWZyZXNoIHZpZXcsIG5vIGdyb3VwcyBoYXZlIGJlZW4gc2V0XCIpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuc2V0R3JvdXBIZWFkZXIgPSBmdW5jdGlvbiAodmFsdWVzKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiLCB0cnVlKSkge1xuXHRcdHRoaXMub3B0aW9ucy5ncm91cEhlYWRlciA9IHZhbHVlcztcblx0XHR0aGlzLm1vZHVsZXMuZ3JvdXBSb3dzLmluaXRpYWxpemUoKTtcblx0XHRpZiAodGhpcy5vcHRpb25zLmdyb3VwQnkpIHtcblx0XHRcdHRoaXMucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImdyb3VwXCIpO1xuXG5cdFx0XHRpZiAodGhpcy5vcHRpb25zLnBlcnNpc3RlbmNlICYmIHRoaXMubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgdGhpcy5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5ncm91cCkge1xuXHRcdFx0XHR0aGlzLm1vZHVsZXMucGVyc2lzdGVuY2Uuc2F2ZShcImdyb3VwXCIpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJHcm91cGluZyBVcGRhdGUgLSBjYW50IHJlZnJlc2ggdmlldywgbm8gZ3JvdXBzIGhhdmUgYmVlbiBzZXRcIik7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRHcm91cHMgPSBmdW5jdGlvbiAodmFsdWVzKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuZ3JvdXBSb3dzLmdldEdyb3Vwcyh0cnVlKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cbi8vIGdldCBncm91cGVkIHRhYmxlIGRhdGEgaW4gdGhlIHNhbWUgZm9ybWF0IGFzIGdldERhdGEoKVxuVGFidWxhdG9yLnByb3RvdHlwZS5nZXRHcm91cGVkRGF0YSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZ3JvdXBSb3dzXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMub3B0aW9ucy5ncm91cEJ5ID8gdGhpcy5tb2R1bGVzLmdyb3VwUm93cy5nZXRHcm91cGVkRGF0YSgpIDogdGhpcy5nZXREYXRhKCk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0RWRpdGVkQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImVkaXRcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLmVkaXQuZ2V0RWRpdGVkQ2VsbHMoKTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5jbGVhckNlbGxFZGl0ZWQgPSBmdW5jdGlvbiAoY2VsbHMpIHtcblx0dmFyIF90aGlzNDAgPSB0aGlzO1xuXG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImVkaXRcIiwgdHJ1ZSkpIHtcblxuXHRcdGlmICghY2VsbHMpIHtcblx0XHRcdGNlbGxzID0gdGhpcy5tb2R1bGVzLmVkaXQuZ2V0RWRpdGVkQ2VsbHMoKTtcblx0XHR9XG5cblx0XHRpZiAoIUFycmF5LmlzQXJyYXkoY2VsbHMpKSB7XG5cdFx0XHRjZWxscyA9IFtjZWxsc107XG5cdFx0fVxuXG5cdFx0Y2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdFx0X3RoaXM0MC5tb2R1bGVzLmVkaXQuY2xlYXJFZGl0ZWQoY2VsbC5fZ2V0U2VsZigpKTtcblx0XHR9KTtcblx0fVxufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8gQ29sdW1uIENhbGN1bGF0aW9uIEZ1bmN0aW9ucyAvLy8vLy8vLy8vLy8vLy9cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0Q2FsY1Jlc3VsdHMgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5jb2x1bW5DYWxjcy5nZXRSZXN1bHRzKCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlY2FsYyA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjQWxsKHRoaXMucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0fVxufTtcblxuLy8vLy8vLy8vLy8vLy8vIE5hdmlnYXRpb24gTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vL1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm5hdmlnYXRlUHJldiA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJlZGl0XCIsIHRydWUpKSB7XG5cdFx0Y2VsbCA9IHRoaXMubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0aWYgKGNlbGwpIHtcblx0XHRcdHJldHVybiBjZWxsLm5hdigpLnByZXYoKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm5hdmlnYXRlTmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJlZGl0XCIsIHRydWUpKSB7XG5cdFx0Y2VsbCA9IHRoaXMubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0aWYgKGNlbGwpIHtcblx0XHRcdHJldHVybiBjZWxsLm5hdigpLm5leHQoKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm5hdmlnYXRlTGVmdCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJlZGl0XCIsIHRydWUpKSB7XG5cdFx0Y2VsbCA9IHRoaXMubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0aWYgKGNlbGwpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHJldHVybiBjZWxsLm5hdigpLmxlZnQoKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLm5hdmlnYXRlUmlnaHQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjZWxsID0gZmFsc2U7XG5cblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZWRpdFwiLCB0cnVlKSkge1xuXHRcdGNlbGwgPSB0aGlzLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcblxuXHRcdGlmIChjZWxsKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRyZXR1cm4gY2VsbC5uYXYoKS5yaWdodCgpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBmYWxzZTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUubmF2aWdhdGVVcCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJlZGl0XCIsIHRydWUpKSB7XG5cdFx0Y2VsbCA9IHRoaXMubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0aWYgKGNlbGwpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHJldHVybiBjZWxsLm5hdigpLnVwKCk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGZhbHNlO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5uYXZpZ2F0ZURvd24gPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjZWxsID0gZmFsc2U7XG5cblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZWRpdFwiLCB0cnVlKSkge1xuXHRcdGNlbGwgPSB0aGlzLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcblxuXHRcdGlmIChjZWxsKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRyZXR1cm4gY2VsbC5uYXYoKS5kb3duKCk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGZhbHNlO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vIEhpc3RvcnkgTWFuYWdlbWVudCAvLy8vLy8vLy8vLy8vL1xuVGFidWxhdG9yLnByb3RvdHlwZS51bmRvID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5vcHRpb25zLmhpc3RvcnkgJiYgdGhpcy5tb2RFeGlzdHMoXCJoaXN0b3J5XCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5oaXN0b3J5LnVuZG8oKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVkbyA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMub3B0aW9ucy5oaXN0b3J5ICYmIHRoaXMubW9kRXhpc3RzKFwiaGlzdG9yeVwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuaGlzdG9yeS5yZWRvKCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmdldEhpc3RvcnlVbmRvU2l6ZSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMub3B0aW9ucy5oaXN0b3J5ICYmIHRoaXMubW9kRXhpc3RzKFwiaGlzdG9yeVwiLCB0cnVlKSkge1xuXHRcdHJldHVybiB0aGlzLm1vZHVsZXMuaGlzdG9yeS5nZXRIaXN0b3J5VW5kb1NpemUoKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuZ2V0SGlzdG9yeVJlZG9TaXplID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5vcHRpb25zLmhpc3RvcnkgJiYgdGhpcy5tb2RFeGlzdHMoXCJoaXN0b3J5XCIsIHRydWUpKSB7XG5cdFx0cmV0dXJuIHRoaXMubW9kdWxlcy5oaXN0b3J5LmdldEhpc3RvcnlSZWRvU2l6ZSgpO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5jbGVhckhpc3RvcnkgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLm9wdGlvbnMuaGlzdG9yeSAmJiB0aGlzLm1vZEV4aXN0cyhcImhpc3RvcnlcIiwgdHJ1ZSkpIHtcblx0XHRyZXR1cm4gdGhpcy5tb2R1bGVzLmhpc3RvcnkuY2xlYXIoKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLyBEb3dubG9hZCBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vXG5cblRhYnVsYXRvci5wcm90b3R5cGUuZG93bmxvYWQgPSBmdW5jdGlvbiAodHlwZSwgZmlsZW5hbWUsIG9wdGlvbnMsIGFjdGl2ZSkge1xuXHRpZiAodGhpcy5tb2RFeGlzdHMoXCJkb3dubG9hZFwiLCB0cnVlKSkge1xuXHRcdHRoaXMubW9kdWxlcy5kb3dubG9hZC5kb3dubG9hZCh0eXBlLCBmaWxlbmFtZSwgb3B0aW9ucywgYWN0aXZlKTtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5kb3dubG9hZFRvVGFiID0gZnVuY3Rpb24gKHR5cGUsIGZpbGVuYW1lLCBvcHRpb25zLCBhY3RpdmUpIHtcblx0aWYgKHRoaXMubW9kRXhpc3RzKFwiZG93bmxvYWRcIiwgdHJ1ZSkpIHtcblx0XHR0aGlzLm1vZHVsZXMuZG93bmxvYWQuZG93bmxvYWQodHlwZSwgZmlsZW5hbWUsIG9wdGlvbnMsIGFjdGl2ZSwgdHJ1ZSk7XG5cdH1cbn07XG5cbi8vLy8vLy8vLy8vIEludGVyIFRhYmxlIENvbW11bmljYXRpb25zIC8vLy8vLy8vLy8vXG5cblRhYnVsYXRvci5wcm90b3R5cGUudGFibGVDb21tcyA9IGZ1bmN0aW9uICh0YWJsZSwgbW9kdWxlLCBhY3Rpb24sIGRhdGEpIHtcblx0dGhpcy5tb2R1bGVzLmNvbW1zLnJlY2VpdmUodGFibGUsIG1vZHVsZSwgYWN0aW9uLCBkYXRhKTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vIEV4dGVuc2lvbiBNYW5hZ2VtZW50IC8vLy8vLy8vLy8vLy8vXG5cbi8vb2JqZWN0IHRvIGhvbGQgbW9kdWxlXG5UYWJ1bGF0b3IucHJvdG90eXBlLm1vZHVsZUJpbmRpbmdzID0ge307XG5cbi8vZXh0ZW5kIG1vZHVsZVxuVGFidWxhdG9yLnByb3RvdHlwZS5leHRlbmRNb2R1bGUgPSBmdW5jdGlvbiAobmFtZSwgcHJvcGVydHksIHZhbHVlcykge1xuXG5cdGlmIChUYWJ1bGF0b3IucHJvdG90eXBlLm1vZHVsZUJpbmRpbmdzW25hbWVdKSB7XG5cdFx0dmFyIHNvdXJjZSA9IFRhYnVsYXRvci5wcm90b3R5cGUubW9kdWxlQmluZGluZ3NbbmFtZV0ucHJvdG90eXBlW3Byb3BlcnR5XTtcblxuXHRcdGlmIChzb3VyY2UpIHtcblx0XHRcdGlmICgodHlwZW9mIHZhbHVlcyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWVzKSkgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0XHRmb3IgKHZhciBrZXkgaW4gdmFsdWVzKSB7XG5cdFx0XHRcdFx0c291cmNlW2tleV0gPSB2YWx1ZXNba2V5XTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiTW9kdWxlIEVycm9yIC0gSW52YWxpZCB2YWx1ZSB0eXBlLCBpdCBtdXN0IGJlIGFuIG9iamVjdFwiKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiTW9kdWxlIEVycm9yIC0gcHJvcGVydHkgZG9lcyBub3QgZXhpc3Q6XCIsIHByb3BlcnR5KTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiTW9kdWxlIEVycm9yIC0gbW9kdWxlIGRvZXMgbm90IGV4aXN0OlwiLCBuYW1lKTtcblx0fVxufTtcblxuLy9hZGQgbW9kdWxlIHRvIHRhYnVsYXRvclxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uIChuYW1lLCBtb2R1bGUpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXHRUYWJ1bGF0b3IucHJvdG90eXBlLm1vZHVsZUJpbmRpbmdzW25hbWVdID0gbW9kdWxlO1xufTtcblxuLy9lbnN1cmUgdGhhdCBtb2R1bGUgYXJlIGJvdW5kIHRvIGluc3RhbnRpYXRlZCBmdW5jdGlvblxuVGFidWxhdG9yLnByb3RvdHlwZS5iaW5kTW9kdWxlcyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5tb2R1bGVzID0ge307XG5cblx0Zm9yICh2YXIgbmFtZSBpbiBUYWJ1bGF0b3IucHJvdG90eXBlLm1vZHVsZUJpbmRpbmdzKSB7XG5cdFx0dGhpcy5tb2R1bGVzW25hbWVdID0gbmV3IFRhYnVsYXRvci5wcm90b3R5cGUubW9kdWxlQmluZGluZ3NbbmFtZV0odGhpcyk7XG5cdH1cbn07XG5cbi8vQ2hlY2sgZm9yIG1vZHVsZVxuVGFidWxhdG9yLnByb3RvdHlwZS5tb2RFeGlzdHMgPSBmdW5jdGlvbiAocGx1Z2luLCByZXF1aXJlZCkge1xuXHRpZiAodGhpcy5tb2R1bGVzW3BsdWdpbl0pIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBlbHNlIHtcblx0XHRpZiAocmVxdWlyZWQpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJUYWJ1bGF0b3IgTW9kdWxlIE5vdCBJbnN0YWxsZWQ6IFwiICsgcGx1Z2luKTtcblx0XHR9XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMgPSB7XG5cblx0ZWxWaXNpYmxlOiBmdW5jdGlvbiBlbFZpc2libGUoZWwpIHtcblx0XHRyZXR1cm4gIShlbC5vZmZzZXRXaWR0aCA8PSAwICYmIGVsLm9mZnNldEhlaWdodCA8PSAwKTtcblx0fSxcblxuXHRlbE9mZnNldDogZnVuY3Rpb24gZWxPZmZzZXQoZWwpIHtcblx0XHR2YXIgYm94ID0gZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0dG9wOiBib3gudG9wICsgd2luZG93LnBhZ2VZT2Zmc2V0IC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFRvcCxcblx0XHRcdGxlZnQ6IGJveC5sZWZ0ICsgd2luZG93LnBhZ2VYT2Zmc2V0IC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudExlZnRcblx0XHR9O1xuXHR9LFxuXG5cdGRlZXBDbG9uZTogZnVuY3Rpb24gZGVlcENsb25lKG9iaikge1xuXHRcdHZhciBjbG9uZSA9IE9iamVjdC5hc3NpZ24oQXJyYXkuaXNBcnJheShvYmopID8gW10gOiB7fSwgb2JqKTtcblxuXHRcdGZvciAodmFyIGkgaW4gb2JqKSB7XG5cdFx0XHRpZiAob2JqW2ldICE9IG51bGwgJiYgX3R5cGVvZihvYmpbaV0pID09PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRcdGlmIChvYmpbaV0gaW5zdGFuY2VvZiBEYXRlKSB7XG5cdFx0XHRcdFx0Y2xvbmVbaV0gPSBuZXcgRGF0ZShvYmpbaV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNsb25lW2ldID0gdGhpcy5kZWVwQ2xvbmUob2JqW2ldKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gY2xvbmU7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMgPSB7XG5cdHRhYmxlczogW10sXG5cdHJlZ2lzdGVyOiBmdW5jdGlvbiByZWdpc3Rlcih0YWJsZSkge1xuXHRcdFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMudGFibGVzLnB1c2godGFibGUpO1xuXHR9LFxuXHRkZXJlZ2lzdGVyOiBmdW5jdGlvbiBkZXJlZ2lzdGVyKHRhYmxlKSB7XG5cdFx0dmFyIGluZGV4ID0gVGFidWxhdG9yLnByb3RvdHlwZS5jb21tcy50YWJsZXMuaW5kZXhPZih0YWJsZSk7XG5cblx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0VGFidWxhdG9yLnByb3RvdHlwZS5jb21tcy50YWJsZXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9XG5cdH0sXG5cdGxvb2t1cFRhYmxlOiBmdW5jdGlvbiBsb29rdXBUYWJsZShxdWVyeSwgc2lsZW50KSB7XG5cdFx0dmFyIHJlc3VsdHMgPSBbXSxcblx0XHQgICAgbWF0Y2hlcyxcblx0XHQgICAgbWF0Y2g7XG5cblx0XHRpZiAodHlwZW9mIHF1ZXJ5ID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRtYXRjaGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChxdWVyeSk7XG5cblx0XHRcdGlmIChtYXRjaGVzLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRtYXRjaCA9IFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMubWF0Y2hFbGVtZW50KG1hdGNoZXNbaV0pO1xuXG5cdFx0XHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRcdFx0XHRyZXN1bHRzLnB1c2gobWF0Y2gpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAodHlwZW9mIEhUTUxFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiICYmIHF1ZXJ5IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgfHwgcXVlcnkgaW5zdGFuY2VvZiBUYWJ1bGF0b3IpIHtcblx0XHRcdG1hdGNoID0gVGFidWxhdG9yLnByb3RvdHlwZS5jb21tcy5tYXRjaEVsZW1lbnQocXVlcnkpO1xuXG5cdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0cmVzdWx0cy5wdXNoKG1hdGNoKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocXVlcnkpKSB7XG5cdFx0XHRxdWVyeS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdHJlc3VsdHMgPSByZXN1bHRzLmNvbmNhdChUYWJ1bGF0b3IucHJvdG90eXBlLmNvbW1zLmxvb2t1cFRhYmxlKGl0ZW0pKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIXNpbGVudCkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJUYWJsZSBDb25uZWN0aW9uIEVycm9yIC0gSW52YWxpZCBTZWxlY3RvclwiLCBxdWVyeSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdHM7XG5cdH0sXG5cdG1hdGNoRWxlbWVudDogZnVuY3Rpb24gbWF0Y2hFbGVtZW50KGVsZW1lbnQpIHtcblx0XHRyZXR1cm4gVGFidWxhdG9yLnByb3RvdHlwZS5jb21tcy50YWJsZXMuZmluZChmdW5jdGlvbiAodGFibGUpIHtcblx0XHRcdHJldHVybiBlbGVtZW50IGluc3RhbmNlb2YgVGFidWxhdG9yID8gdGFibGUgPT09IGVsZW1lbnQgOiB0YWJsZS5lbGVtZW50ID09PSBlbGVtZW50O1xuXHRcdH0pO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLmZpbmRUYWJsZSA9IGZ1bmN0aW9uIChxdWVyeSkge1xuXHR2YXIgcmVzdWx0cyA9IFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMubG9va3VwVGFibGUocXVlcnksIHRydWUpO1xuXHRyZXR1cm4gQXJyYXkuaXNBcnJheShyZXN1bHRzKSAmJiAhcmVzdWx0cy5sZW5ndGggPyBmYWxzZSA6IHJlc3VsdHM7XG59O1xuXG52YXIgTGF5b3V0ID0gZnVuY3Rpb24gTGF5b3V0KHRhYmxlKSB7XG5cblx0dGhpcy50YWJsZSA9IHRhYmxlO1xuXG5cdHRoaXMubW9kZSA9IG51bGw7XG59O1xuXG4vL2luaXRpYWxpemUgbGF5b3V0IHN5c3RlbVxuXG5MYXlvdXQucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAobGF5b3V0KSB7XG5cblx0aWYgKHRoaXMubW9kZXNbbGF5b3V0XSkge1xuXG5cdFx0dGhpcy5tb2RlID0gbGF5b3V0O1xuXHR9IGVsc2Uge1xuXG5cdFx0Y29uc29sZS53YXJuKFwiTGF5b3V0IEVycm9yIC0gaW52YWxpZCBtb2RlIHNldCwgZGVmYXVsdGluZyB0byAnZml0RGF0YScgOiBcIiArIGxheW91dCk7XG5cblx0XHR0aGlzLm1vZGUgPSAnZml0RGF0YSc7XG5cdH1cblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQuc2V0QXR0cmlidXRlKFwidGFidWxhdG9yLWxheW91dFwiLCB0aGlzLm1vZGUpO1xufTtcblxuTGF5b3V0LnByb3RvdHlwZS5nZXRNb2RlID0gZnVuY3Rpb24gKCkge1xuXG5cdHJldHVybiB0aGlzLm1vZGU7XG59O1xuXG4vL3RyaWdnZXIgdGFibGUgbGF5b3V0XG5cbkxheW91dC5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuXG5cdHRoaXMubW9kZXNbdGhpcy5tb2RlXS5jYWxsKHRoaXMsIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleCk7XG5cblx0aWYgKHRoaXMubW9kZS5pbmRleE9mKFwiZml0RGF0YVwiKSA9PT0gMCAmJiB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiB0aGlzLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2UuY29uZmlnLmNvbHVtbnMpIHtcblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5zYXZlKFwiY29sdW1uc1wiKTtcblx0fVxufTtcblxuLy9sYXlvdXQgcmVuZGVyIGZ1bmN0aW9uc1xuXG5MYXlvdXQucHJvdG90eXBlLm1vZGVzID0ge1xuXG5cdC8vcmVzaXplIGNvbHVtbnMgdG8gZml0IGRhdGEgdGhleSBjb250YWluXG5cblx0XCJmaXREYXRhXCI6IGZ1bmN0aW9uIGZpdERhdGEoY29sdW1ucykge1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy52aXJ0dWFsRG9tSG96KSB7XG5cblx0XHRcdHRoaXMudGFibGUudmRvbUhvei5maXREYXRhTGF5b3V0T3ZlcnJpZGUoKTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXG5cdFx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly9yZXNpemUgY29sdW1ucyB0byBmaXQgZGF0YSB0aGV5IGNvbnRhaW4gYW5kIHN0cmV0Y2ggcm93IHRvIGZpbGwgdGFibGVcblxuXHRcImZpdERhdGFGaWxsXCI6IGZ1bmN0aW9uIGZpdERhdGFGaWxsKGNvbHVtbnMpIHtcblxuXHRcdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cblx0XHRcdGNvbHVtbi5yZWluaXRpYWxpemVXaWR0aCgpO1xuXHRcdH0pO1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC51cGRhdGUoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly9yZXNpemUgY29sdW1ucyB0byBmaXQgZGF0YSB0aGV5IGNvbnRhaW5cblxuXHRcImZpdERhdGFUYWJsZVwiOiBmdW5jdGlvbiBmaXREYXRhVGFibGUoY29sdW1ucykge1xuXG5cdFx0Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdFx0Y29sdW1uLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0fSk7XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKSB7XG5cblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvL3Jlc2l6ZSBjb2x1bW5zIHRvIGZpdCBkYXRhIHRoZSBjb250YWluIGFuZCBzdHJldGNoIGxhc3QgY29sdW1uIHRvIGZpbGwgdGFibGVcblxuXHRcImZpdERhdGFTdHJldGNoXCI6IGZ1bmN0aW9uIGZpdERhdGFTdHJldGNoKGNvbHVtbnMpIHtcblx0XHR2YXIgX3RoaXM0MSA9IHRoaXM7XG5cblx0XHR2YXIgY29sc1dpZHRoID0gMCxcblx0XHQgICAgdGFibGVXaWR0aCA9IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmNsaWVudFdpZHRoLFxuXHRcdCAgICBnYXAgPSAwLFxuXHRcdCAgICBsYXN0Q29sID0gZmFsc2U7XG5cblx0XHRjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbiwgaSkge1xuXG5cdFx0XHRpZiAoIWNvbHVtbi53aWR0aEZpeGVkKSB7XG5cblx0XHRcdFx0Y29sdW1uLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChfdGhpczQxLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dCA/IGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUudmlzaWJsZSA6IGNvbHVtbi52aXNpYmxlKSB7XG5cblx0XHRcdFx0bGFzdENvbCA9IGNvbHVtbjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGNvbHVtbi52aXNpYmxlKSB7XG5cblx0XHRcdFx0Y29sc1dpZHRoICs9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGxhc3RDb2wpIHtcblxuXHRcdFx0Z2FwID0gdGFibGVXaWR0aCAtIGNvbHNXaWR0aCArIGxhc3RDb2wuZ2V0V2lkdGgoKTtcblxuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0XHRcdGxhc3RDb2wuc2V0V2lkdGgoMCk7XG5cblx0XHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQudXBkYXRlKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChnYXAgPiAwKSB7XG5cblx0XHRcdFx0bGFzdENvbC5zZXRXaWR0aChnYXApO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRsYXN0Q29sLnJlaW5pdGlhbGl6ZVdpZHRoKCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicmVzcG9uc2l2ZUxheW91dFwiLCB0cnVlKSkge1xuXG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvL3Jlc2l6ZSBjb2x1bW5zIHRvIGZpdFxuXG5cdFwiZml0Q29sdW1uc1wiOiBmdW5jdGlvbiBmaXRDb2x1bW5zKGNvbHVtbnMpIHtcblxuXHRcdHZhciBzZWxmID0gdGhpcztcblxuXHRcdHZhciB0b3RhbFdpZHRoID0gc2VsZi50YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoOyAvL3RhYmxlIGVsZW1lbnQgd2lkdGhcblxuXHRcdHZhciBmaXhlZFdpZHRoID0gMDsgLy90b3RhbCB3aWR0aCBvZiBjb2x1bW5zIHdpdGggYSBkZWZpbmVkIHdpZHRoXG5cblx0XHR2YXIgZmxleFdpZHRoID0gMDsgLy90b3RhbCB3aWR0aCBhdmFpbGFibGUgdG8gZmxleGlibGUgY29sdW1uc1xuXG5cdFx0dmFyIGZsZXhHcm93VW5pdHMgPSAwOyAvL3RvdGFsIG51bWJlciBvZiB3aWR0aEdyb3cgYmxvY2tzIGFjY3Jvc3MgYWxsIGNvbHVtbnNcblxuXHRcdHZhciBmbGV4Q29sV2lkdGggPSAwOyAvL2Rlc2lyZWQgd2lkdGggb2YgZmxleGlibGUgY29sdW1uc1xuXG5cdFx0dmFyIGZsZXhDb2x1bW5zID0gW107IC8vYXJyYXkgb2YgZmxleGlibGUgd2lkdGggY29sdW1uc1xuXG5cdFx0dmFyIGZpeGVkU2hyaW5rQ29sdW1ucyA9IFtdOyAvL2FycmF5IG9mIGZpeGVkIHdpZHRoIGNvbHVtbnMgdGhhdCBjYW4gc2hyaW5rXG5cblx0XHR2YXIgZmxleFNocmlua1VuaXRzID0gMDsgLy90b3RhbCBudW1iZXIgb2Ygd2lkdGhTaHJpbmsgYmxvY2tzIGFjY3Jvc3MgYWxsIGNvbHVtbnNcblxuXHRcdHZhciBvdmVyZmxvd1dpZHRoID0gMDsgLy9ob3Jpem9udGFsIG92ZXJmbG93IHdpZHRoXG5cblx0XHR2YXIgZ2FwRmlsbCA9IDA7IC8vbnVtYmVyIG9mIHBpeGVscyB0byBiZSBhZGRlZCB0byBmaW5hbCBjb2x1bW4gdG8gY2xvc2UgYW5kIGhhbGYgcGl4ZWwgZ2Fwc1xuXG5cblx0XHRmdW5jdGlvbiBjYWxjV2lkdGgod2lkdGgpIHtcblxuXHRcdFx0dmFyIGNvbFdpZHRoO1xuXG5cdFx0XHRpZiAodHlwZW9mIHdpZHRoID09IFwic3RyaW5nXCIpIHtcblxuXHRcdFx0XHRpZiAod2lkdGguaW5kZXhPZihcIiVcIikgPiAtMSkge1xuXG5cdFx0XHRcdFx0Y29sV2lkdGggPSB0b3RhbFdpZHRoIC8gMTAwICogcGFyc2VJbnQod2lkdGgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0Y29sV2lkdGggPSBwYXJzZUludCh3aWR0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Y29sV2lkdGggPSB3aWR0aDtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGNvbFdpZHRoO1xuXHRcdH1cblxuXHRcdC8vZW5zdXJlIGNvbHVtbnMgcmVzaXplIHRvIHRha2UgdXAgdGhlIGNvcnJlY3QgYW1vdW50IG9mIHNwYWNlXG5cblx0XHRmdW5jdGlvbiBzY2FsZUNvbHVtbnMoY29sdW1ucywgZnJlZVNwYWNlLCBjb2xXaWR0aCwgc2hyaW5rQ29scykge1xuXG5cdFx0XHR2YXIgb3ZlcnNpemVDb2xzID0gW10sXG5cdFx0XHQgICAgb3ZlcnNpemVTcGFjZSA9IDAsXG5cdFx0XHQgICAgcmVtYWluaW5nU3BhY2UgPSAwLFxuXHRcdFx0ICAgIG5leHRDb2xXaWR0aCA9IDAsXG5cdFx0XHQgICAgcmVtYWluaW5nRmxleEdyb3dVbml0cyA9IGZsZXhHcm93VW5pdHMsXG5cdFx0XHQgICAgZ2FwID0gMCxcblx0XHRcdCAgICBjaGFuZ2VVbml0cyA9IDAsXG5cdFx0XHQgICAgdW5kZXJzaXplQ29scyA9IFtdO1xuXG5cdFx0XHRmdW5jdGlvbiBjYWxjR3Jvdyhjb2wpIHtcblxuXHRcdFx0XHRyZXR1cm4gY29sV2lkdGggKiAoY29sLmNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3JvdyB8fCAxKTtcblx0XHRcdH1cblxuXHRcdFx0ZnVuY3Rpb24gY2FsY1Nocmluayhjb2wpIHtcblxuXHRcdFx0XHRyZXR1cm4gY2FsY1dpZHRoKGNvbC53aWR0aCkgLSBjb2xXaWR0aCAqIChjb2wuY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbmsgfHwgMCk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sLCBpKSB7XG5cblx0XHRcdFx0dmFyIHdpZHRoID0gc2hyaW5rQ29scyA/IGNhbGNTaHJpbmsoY29sKSA6IGNhbGNHcm93KGNvbCk7XG5cblx0XHRcdFx0aWYgKGNvbC5jb2x1bW4ubWluV2lkdGggPj0gd2lkdGgpIHtcblxuXHRcdFx0XHRcdG92ZXJzaXplQ29scy5wdXNoKGNvbCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRpZiAoY29sLmNvbHVtbi5tYXhXaWR0aCAmJiBjb2wuY29sdW1uLm1heFdpZHRoIDwgd2lkdGgpIHtcblxuXHRcdFx0XHRcdFx0Y29sLndpZHRoID0gY29sLmNvbHVtbi5tYXhXaWR0aDtcblxuXHRcdFx0XHRcdFx0ZnJlZVNwYWNlIC09IGNvbC5jb2x1bW4ubWF4V2lkdGg7XG5cblx0XHRcdFx0XHRcdHJlbWFpbmluZ0ZsZXhHcm93VW5pdHMgLT0gc2hyaW5rQ29scyA/IGNvbC5jb2x1bW4uZGVmaW5pdGlvbi53aWR0aFNocmluayB8fCAxIDogY29sLmNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3JvdyB8fCAxO1xuXG5cdFx0XHRcdFx0XHRpZiAocmVtYWluaW5nRmxleEdyb3dVbml0cykge1xuXG5cdFx0XHRcdFx0XHRcdGNvbFdpZHRoID0gTWF0aC5mbG9vcihmcmVlU3BhY2UgLyByZW1haW5pbmdGbGV4R3Jvd1VuaXRzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHR1bmRlcnNpemVDb2xzLnB1c2goY29sKTtcblxuXHRcdFx0XHRcdFx0Y2hhbmdlVW5pdHMgKz0gc2hyaW5rQ29scyA/IGNvbC5jb2x1bW4uZGVmaW5pdGlvbi53aWR0aFNocmluayB8fCAxIDogY29sLmNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3JvdyB8fCAxO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChvdmVyc2l6ZUNvbHMubGVuZ3RoKSB7XG5cblx0XHRcdFx0b3ZlcnNpemVDb2xzLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXG5cdFx0XHRcdFx0b3ZlcnNpemVTcGFjZSArPSBzaHJpbmtDb2xzID8gY29sLndpZHRoIC0gY29sLmNvbHVtbi5taW5XaWR0aCA6IGNvbC5jb2x1bW4ubWluV2lkdGg7XG5cblx0XHRcdFx0XHRjb2wud2lkdGggPSBjb2wuY29sdW1uLm1pbldpZHRoO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRyZW1haW5pbmdTcGFjZSA9IGZyZWVTcGFjZSAtIG92ZXJzaXplU3BhY2U7XG5cblx0XHRcdFx0bmV4dENvbFdpZHRoID0gY2hhbmdlVW5pdHMgPyBNYXRoLmZsb29yKHJlbWFpbmluZ1NwYWNlIC8gY2hhbmdlVW5pdHMpIDogcmVtYWluaW5nU3BhY2U7XG5cblx0XHRcdFx0Z2FwID0gcmVtYWluaW5nU3BhY2UgLSBuZXh0Q29sV2lkdGggKiBjaGFuZ2VVbml0cztcblxuXHRcdFx0XHRnYXAgKz0gc2NhbGVDb2x1bW5zKHVuZGVyc2l6ZUNvbHMsIHJlbWFpbmluZ1NwYWNlLCBuZXh0Q29sV2lkdGgsIHNocmlua0NvbHMpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRnYXAgPSBjaGFuZ2VVbml0cyA/IGZyZWVTcGFjZSAtIE1hdGguZmxvb3IoZnJlZVNwYWNlIC8gY2hhbmdlVW5pdHMpICogY2hhbmdlVW5pdHMgOiBmcmVlU3BhY2U7XG5cblx0XHRcdFx0dW5kZXJzaXplQ29scy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdFx0XHRcdGNvbHVtbi53aWR0aCA9IHNocmlua0NvbHMgPyBjYWxjU2hyaW5rKGNvbHVtbikgOiBjYWxjR3Jvdyhjb2x1bW4pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGdhcDtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJyZXNwb25zaXZlTGF5b3V0XCIsIHRydWUpKSB7XG5cblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0LnVwZGF0ZSgpO1xuXHRcdH1cblxuXHRcdC8vYWRqdXN0IGZvciB2ZXJ0aWNhbCBzY3JvbGxiYXIgaWYgcHJlc2VudFxuXG5cdFx0aWYgKHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbEhlaWdodCA+IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LmNsaWVudEhlaWdodCkge1xuXG5cdFx0XHR0b3RhbFdpZHRoIC09IHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50Lm9mZnNldFdpZHRoIC0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50V2lkdGg7XG5cdFx0fVxuXG5cdFx0Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblxuXHRcdFx0dmFyIHdpZHRoLCBtaW5XaWR0aCwgY29sV2lkdGg7XG5cblx0XHRcdGlmIChjb2x1bW4udmlzaWJsZSkge1xuXG5cdFx0XHRcdHdpZHRoID0gY29sdW1uLmRlZmluaXRpb24ud2lkdGg7XG5cblx0XHRcdFx0bWluV2lkdGggPSBwYXJzZUludChjb2x1bW4ubWluV2lkdGgpO1xuXG5cdFx0XHRcdGlmICh3aWR0aCkge1xuXG5cdFx0XHRcdFx0Y29sV2lkdGggPSBjYWxjV2lkdGgod2lkdGgpO1xuXG5cdFx0XHRcdFx0Zml4ZWRXaWR0aCArPSBjb2xXaWR0aCA+IG1pbldpZHRoID8gY29sV2lkdGggOiBtaW5XaWR0aDtcblxuXHRcdFx0XHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbi53aWR0aFNocmluaykge1xuXG5cdFx0XHRcdFx0XHRmaXhlZFNocmlua0NvbHVtbnMucHVzaCh7XG5cblx0XHRcdFx0XHRcdFx0Y29sdW1uOiBjb2x1bW4sXG5cblx0XHRcdFx0XHRcdFx0d2lkdGg6IGNvbFdpZHRoID4gbWluV2lkdGggPyBjb2xXaWR0aCA6IG1pbldpZHRoXG5cblx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRmbGV4U2hyaW5rVW5pdHMgKz0gY29sdW1uLmRlZmluaXRpb24ud2lkdGhTaHJpbms7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0ZmxleENvbHVtbnMucHVzaCh7XG5cblx0XHRcdFx0XHRcdGNvbHVtbjogY29sdW1uLFxuXG5cdFx0XHRcdFx0XHR3aWR0aDogMFxuXG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRmbGV4R3Jvd1VuaXRzICs9IGNvbHVtbi5kZWZpbml0aW9uLndpZHRoR3JvdyB8fCAxO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvL2NhbGN1bGF0ZSBhdmFpbGFibGUgc3BhY2VcblxuXHRcdGZsZXhXaWR0aCA9IHRvdGFsV2lkdGggLSBmaXhlZFdpZHRoO1xuXG5cdFx0Ly9jYWxjdWxhdGUgY29ycmVjdCBjb2x1bW4gc2l6ZVxuXG5cdFx0ZmxleENvbFdpZHRoID0gTWF0aC5mbG9vcihmbGV4V2lkdGggLyBmbGV4R3Jvd1VuaXRzKTtcblxuXHRcdC8vZ2VuZXJhdGUgY29sdW1uIHdpZHRoc1xuXG5cdFx0dmFyIGdhcEZpbGwgPSBzY2FsZUNvbHVtbnMoZmxleENvbHVtbnMsIGZsZXhXaWR0aCwgZmxleENvbFdpZHRoLCBmYWxzZSk7XG5cblx0XHQvL2luY3JlYXNlIHdpZHRoIG9mIGxhc3QgY29sdW1uIHRvIGFjY291bnQgZm9yIHJvdW5kaW5nIGVycm9yc1xuXG5cdFx0aWYgKGZsZXhDb2x1bW5zLmxlbmd0aCAmJiBnYXBGaWxsID4gMCkge1xuXG5cdFx0XHRmbGV4Q29sdW1uc1tmbGV4Q29sdW1ucy5sZW5ndGggLSAxXS53aWR0aCArPSArZ2FwRmlsbDtcblx0XHR9XG5cblx0XHQvL2NhY3VsYXRlIHNwYWNlIGZvciBjb2x1bW5zIHRvIGJlIHNocnVuayBpbnRvXG5cblx0XHRmbGV4Q29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wpIHtcblxuXHRcdFx0ZmxleFdpZHRoIC09IGNvbC53aWR0aDtcblx0XHR9KTtcblxuXHRcdG92ZXJmbG93V2lkdGggPSBNYXRoLmFicyhnYXBGaWxsKSArIGZsZXhXaWR0aDtcblxuXHRcdC8vc2hyaW5rIG92ZXJzaXplIGNvbHVtbnMgaWYgdGhlcmUgaXMgbm8gYXZhaWxhYmxlIHNwYWNlXG5cblx0XHRpZiAob3ZlcmZsb3dXaWR0aCA+IDAgJiYgZmxleFNocmlua1VuaXRzKSB7XG5cblx0XHRcdGdhcEZpbGwgPSBzY2FsZUNvbHVtbnMoZml4ZWRTaHJpbmtDb2x1bW5zLCBvdmVyZmxvd1dpZHRoLCBNYXRoLmZsb29yKG92ZXJmbG93V2lkdGggLyBmbGV4U2hyaW5rVW5pdHMpLCB0cnVlKTtcblx0XHR9XG5cblx0XHQvL2RlY3JlYXNlIHdpZHRoIG9mIGxhc3QgY29sdW1uIHRvIGFjY291bnQgZm9yIHJvdW5kaW5nIGVycm9yc1xuXG5cdFx0aWYgKGZpeGVkU2hyaW5rQ29sdW1ucy5sZW5ndGgpIHtcblxuXHRcdFx0Zml4ZWRTaHJpbmtDb2x1bW5zW2ZpeGVkU2hyaW5rQ29sdW1ucy5sZW5ndGggLSAxXS53aWR0aCAtPSBnYXBGaWxsO1xuXHRcdH1cblxuXHRcdGZsZXhDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXG5cdFx0XHRjb2wuY29sdW1uLnNldFdpZHRoKGNvbC53aWR0aCk7XG5cdFx0fSk7XG5cblx0XHRmaXhlZFNocmlua0NvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7XG5cblx0XHRcdGNvbC5jb2x1bW4uc2V0V2lkdGgoY29sLndpZHRoKTtcblx0XHR9KTtcblx0fVxuXG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwibGF5b3V0XCIsIExheW91dCk7XG52YXIgTG9jYWxpemUgPSBmdW5jdGlvbiBMb2NhbGl6ZSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMubG9jYWxlID0gXCJkZWZhdWx0XCI7IC8vY3VycmVudCBsb2NhbGVcblx0dGhpcy5sYW5nID0gZmFsc2U7IC8vY3VycmVudCBsYW5ndWFnZVxuXHR0aGlzLmJpbmRpbmdzID0ge307IC8vdXBkYXRlIGV2ZW50cyB0byBjYWxsIHdoZW4gbG9jYWxlIGlzIGNoYW5nZWRcblx0dGhpcy5sYW5nTGlzdCA9IHt9O1xufTtcblxuTG9jYWxpemUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMubGFuZ0xpc3QgPSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZGVlcENsb25lKHRoaXMubGFuZ3MpO1xufTtcblxuLy9zZXQgaGVhZGVyIHBsYWNlaG9kZXJcbkxvY2FsaXplLnByb3RvdHlwZS5zZXRIZWFkZXJGaWx0ZXJQbGFjZWhvbGRlciA9IGZ1bmN0aW9uIChwbGFjZWhvbGRlcikge1xuXHR0aGlzLmxhbmdMaXN0LmRlZmF1bHQuaGVhZGVyRmlsdGVycy5kZWZhdWx0ID0gcGxhY2Vob2xkZXI7XG59O1xuXG4vL3NldCBoZWFkZXIgZmlsdGVyIHBsYWNlaG9sZGVyIGJ5IGNvbHVtblxuTG9jYWxpemUucHJvdG90eXBlLnNldEhlYWRlckZpbHRlckNvbHVtblBsYWNlaG9sZGVyID0gZnVuY3Rpb24gKGNvbHVtbiwgcGxhY2Vob2xkZXIpIHtcblx0dGhpcy5sYW5nTGlzdC5kZWZhdWx0LmhlYWRlckZpbHRlcnMuY29sdW1uc1tjb2x1bW5dID0gcGxhY2Vob2xkZXI7XG5cblx0aWYgKHRoaXMubGFuZyAmJiAhdGhpcy5sYW5nLmhlYWRlckZpbHRlcnMuY29sdW1uc1tjb2x1bW5dKSB7XG5cdFx0dGhpcy5sYW5nLmhlYWRlckZpbHRlcnMuY29sdW1uc1tjb2x1bW5dID0gcGxhY2Vob2xkZXI7XG5cdH1cbn07XG5cbi8vc2V0dXAgYSBsYW5nIGRlc2NyaXB0aW9uIG9iamVjdFxuTG9jYWxpemUucHJvdG90eXBlLmluc3RhbGxMYW5nID0gZnVuY3Rpb24gKGxvY2FsZSwgbGFuZykge1xuXHRpZiAodGhpcy5sYW5nTGlzdFtsb2NhbGVdKSB7XG5cdFx0dGhpcy5fc2V0TGFuZ1Byb3AodGhpcy5sYW5nTGlzdFtsb2NhbGVdLCBsYW5nKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmxhbmdMaXN0W2xvY2FsZV0gPSBsYW5nO1xuXHR9XG59O1xuXG5Mb2NhbGl6ZS5wcm90b3R5cGUuX3NldExhbmdQcm9wID0gZnVuY3Rpb24gKGxhbmcsIHZhbHVlcykge1xuXHRmb3IgKHZhciBrZXkgaW4gdmFsdWVzKSB7XG5cdFx0aWYgKGxhbmdba2V5XSAmJiBfdHlwZW9mKGxhbmdba2V5XSkgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0dGhpcy5fc2V0TGFuZ1Byb3AobGFuZ1trZXldLCB2YWx1ZXNba2V5XSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxhbmdba2V5XSA9IHZhbHVlc1trZXldO1xuXHRcdH1cblx0fVxufTtcblxuLy9zZXQgY3VycmVudCBsb2NhbGVcbkxvY2FsaXplLnByb3RvdHlwZS5zZXRMb2NhbGUgPSBmdW5jdGlvbiAoZGVzaXJlZExvY2FsZSkge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0ZGVzaXJlZExvY2FsZSA9IGRlc2lyZWRMb2NhbGUgfHwgXCJkZWZhdWx0XCI7XG5cblx0Ly9maWxsIGluIGFueSBtYXRjaGluZyBsYW5ndWdlIHZhbHVlc1xuXHRmdW5jdGlvbiB0cmF2ZXJzZUxhbmcodHJhbnMsIHBhdGgpIHtcblx0XHRmb3IgKHZhciBwcm9wIGluIHRyYW5zKSB7XG5cdFx0XHRpZiAoX3R5cGVvZih0cmFuc1twcm9wXSkgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0XHRpZiAoIXBhdGhbcHJvcF0pIHtcblx0XHRcdFx0XHRwYXRoW3Byb3BdID0ge307XG5cdFx0XHRcdH1cblx0XHRcdFx0dHJhdmVyc2VMYW5nKHRyYW5zW3Byb3BdLCBwYXRoW3Byb3BdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBhdGhbcHJvcF0gPSB0cmFuc1twcm9wXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvL2RldGVybWluZyBjb3JyZWN0IGxvY2FsZSB0byBsb2FkXG5cdGlmIChkZXNpcmVkTG9jYWxlID09PSB0cnVlICYmIG5hdmlnYXRvci5sYW5ndWFnZSkge1xuXHRcdC8vZ2V0IGxvY2FsIGZyb20gc3lzdGVtXG5cdFx0ZGVzaXJlZExvY2FsZSA9IG5hdmlnYXRvci5sYW5ndWFnZS50b0xvd2VyQ2FzZSgpO1xuXHR9XG5cblx0aWYgKGRlc2lyZWRMb2NhbGUpIHtcblxuXHRcdC8vaWYgbG9jYWxlIGlzIG5vdCBzZXQsIGNoZWNrIGZvciBtYXRjaGluZyB0b3AgbGV2ZWwgbG9jYWxlIGVsc2UgdXNlIGRlZmF1bHRcblx0XHRpZiAoIXNlbGYubGFuZ0xpc3RbZGVzaXJlZExvY2FsZV0pIHtcblx0XHRcdHZhciBwcmVmaXggPSBkZXNpcmVkTG9jYWxlLnNwbGl0KFwiLVwiKVswXTtcblxuXHRcdFx0aWYgKHNlbGYubGFuZ0xpc3RbcHJlZml4XSkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJMb2NhbGl6YXRpb24gRXJyb3IgLSBFeGFjdCBtYXRjaGluZyBsb2NhbGUgbm90IGZvdW5kLCB1c2luZyBjbG9zZXN0IG1hdGNoOiBcIiwgZGVzaXJlZExvY2FsZSwgcHJlZml4KTtcblx0XHRcdFx0ZGVzaXJlZExvY2FsZSA9IHByZWZpeDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkxvY2FsaXphdGlvbiBFcnJvciAtIE1hdGNoaW5nIGxvY2FsZSBub3QgZm91bmQsIHVzaW5nIGRlZmF1bHQ6IFwiLCBkZXNpcmVkTG9jYWxlKTtcblx0XHRcdFx0ZGVzaXJlZExvY2FsZSA9IFwiZGVmYXVsdFwiO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHNlbGYubG9jYWxlID0gZGVzaXJlZExvY2FsZTtcblxuXHQvL2xvYWQgZGVmYXVsdCBsYW5nIHRlbXBsYXRlXG5cdHNlbGYubGFuZyA9IFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5kZWVwQ2xvbmUoc2VsZi5sYW5nTGlzdC5kZWZhdWx0IHx8IHt9KTtcblxuXHRpZiAoZGVzaXJlZExvY2FsZSAhPSBcImRlZmF1bHRcIikge1xuXHRcdHRyYXZlcnNlTGFuZyhzZWxmLmxhbmdMaXN0W2Rlc2lyZWRMb2NhbGVdLCBzZWxmLmxhbmcpO1xuXHR9XG5cblx0c2VsZi50YWJsZS5vcHRpb25zLmxvY2FsaXplZC5jYWxsKHNlbGYudGFibGUsIHNlbGYubG9jYWxlLCBzZWxmLmxhbmcpO1xuXG5cdHNlbGYuX2V4ZWN1dGVCaW5kaW5ncygpO1xufTtcblxuLy9nZXQgY3VycmVudCBsb2NhbGVcbkxvY2FsaXplLnByb3RvdHlwZS5nZXRMb2NhbGUgPSBmdW5jdGlvbiAobG9jYWxlKSB7XG5cdHJldHVybiBzZWxmLmxvY2FsZTtcbn07XG5cbi8vZ2V0IGxhbmcgb2JqZWN0IGZvciBnaXZlbiBsb2NhbCBvciBjdXJyZW50IGlmIG5vbmUgcHJvdmlkZWRcbkxvY2FsaXplLnByb3RvdHlwZS5nZXRMYW5nID0gZnVuY3Rpb24gKGxvY2FsZSkge1xuXHRyZXR1cm4gbG9jYWxlID8gdGhpcy5sYW5nTGlzdFtsb2NhbGVdIDogdGhpcy5sYW5nO1xufTtcblxuLy9nZXQgdGV4dCBmb3IgY3VycmVudCBsb2NhbGVcbkxvY2FsaXplLnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKHBhdGgsIHZhbHVlKSB7XG5cdHZhciBwYXRoID0gdmFsdWUgPyBwYXRoICsgXCJ8XCIgKyB2YWx1ZSA6IHBhdGgsXG5cdCAgICBwYXRoQXJyYXkgPSBwYXRoLnNwbGl0KFwifFwiKSxcblx0ICAgIHRleHQgPSB0aGlzLl9nZXRMYW5nRWxlbWVudChwYXRoQXJyYXksIHRoaXMubG9jYWxlKTtcblxuXHQvLyBpZih0ZXh0ID09PSBmYWxzZSl7XG5cdC8vIFx0Y29uc29sZS53YXJuKFwiTG9jYWxpemF0aW9uIEVycm9yIC0gTWF0Y2hpbmcgbG9jYWxpemVkIHRleHQgbm90IGZvdW5kIGZvciBnaXZlbiBwYXRoOiBcIiwgcGF0aCk7XG5cdC8vIH1cblxuXHRyZXR1cm4gdGV4dCB8fCBcIlwiO1xufTtcblxuLy90cmF2ZXJzZSBsYW5ncyBvYmplY3QgYW5kIGZpbmQgbG9jYWxpemVkIGNvcHlcbkxvY2FsaXplLnByb3RvdHlwZS5fZ2V0TGFuZ0VsZW1lbnQgPSBmdW5jdGlvbiAocGF0aCwgbG9jYWxlKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblx0dmFyIHJvb3QgPSBzZWxmLmxhbmc7XG5cblx0cGF0aC5mb3JFYWNoKGZ1bmN0aW9uIChsZXZlbCkge1xuXHRcdHZhciByb290UGF0aDtcblxuXHRcdGlmIChyb290KSB7XG5cdFx0XHRyb290UGF0aCA9IHJvb3RbbGV2ZWxdO1xuXG5cdFx0XHRpZiAodHlwZW9mIHJvb3RQYXRoICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0cm9vdCA9IHJvb3RQYXRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cm9vdCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHJvb3Q7XG59O1xuXG4vL3NldCB1cGRhdGUgYmluZGluZ1xuTG9jYWxpemUucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAocGF0aCwgY2FsbGJhY2spIHtcblx0aWYgKCF0aGlzLmJpbmRpbmdzW3BhdGhdKSB7XG5cdFx0dGhpcy5iaW5kaW5nc1twYXRoXSA9IFtdO1xuXHR9XG5cblx0dGhpcy5iaW5kaW5nc1twYXRoXS5wdXNoKGNhbGxiYWNrKTtcblxuXHRjYWxsYmFjayh0aGlzLmdldFRleHQocGF0aCksIHRoaXMubGFuZyk7XG59O1xuXG4vL2l0dGVyYXRlIHRocm91Z2ggYmluZGluZ3MgYW5kIHRyaWdnZXIgdXBkYXRlc1xuTG9jYWxpemUucHJvdG90eXBlLl9leGVjdXRlQmluZGluZ3MgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHR2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChwYXRoKSB7XG5cdFx0c2VsZi5iaW5kaW5nc1twYXRoXS5mb3JFYWNoKGZ1bmN0aW9uIChiaW5kaW5nKSB7XG5cdFx0XHRiaW5kaW5nKHNlbGYuZ2V0VGV4dChwYXRoKSwgc2VsZi5sYW5nKTtcblx0XHR9KTtcblx0fTtcblxuXHRmb3IgKHZhciBwYXRoIGluIHNlbGYuYmluZGluZ3MpIHtcblx0XHRfbG9vcChwYXRoKTtcblx0fVxufTtcblxuLy9Mb2NhbGl6ZWQgdGV4dCBsaXN0aW5nc1xuTG9jYWxpemUucHJvdG90eXBlLmxhbmdzID0ge1xuXHRcImRlZmF1bHRcIjogeyAvL2hvbGQgZGVmYXVsdCBsb2NhbGUgdGV4dFxuXHRcdFwiZ3JvdXBzXCI6IHtcblx0XHRcdFwiaXRlbVwiOiBcIml0ZW1cIixcblx0XHRcdFwiaXRlbXNcIjogXCJpdGVtc1wiXG5cdFx0fSxcblx0XHRcImNvbHVtbnNcIjoge30sXG5cdFx0XCJhamF4XCI6IHtcblx0XHRcdFwibG9hZGluZ1wiOiBcIkxvYWRpbmdcIixcblx0XHRcdFwiZXJyb3JcIjogXCJFcnJvclwiXG5cdFx0fSxcblx0XHRcInBhZ2luYXRpb25cIjoge1xuXHRcdFx0XCJwYWdlX3NpemVcIjogXCJQYWdlIFNpemVcIixcblx0XHRcdFwicGFnZV90aXRsZVwiOiBcIlNob3cgUGFnZVwiLFxuXHRcdFx0XCJmaXJzdFwiOiBcIkZpcnN0XCIsXG5cdFx0XHRcImZpcnN0X3RpdGxlXCI6IFwiRmlyc3QgUGFnZVwiLFxuXHRcdFx0XCJsYXN0XCI6IFwiTGFzdFwiLFxuXHRcdFx0XCJsYXN0X3RpdGxlXCI6IFwiTGFzdCBQYWdlXCIsXG5cdFx0XHRcInByZXZcIjogXCJQcmV2XCIsXG5cdFx0XHRcInByZXZfdGl0bGVcIjogXCJQcmV2IFBhZ2VcIixcblx0XHRcdFwibmV4dFwiOiBcIk5leHRcIixcblx0XHRcdFwibmV4dF90aXRsZVwiOiBcIk5leHQgUGFnZVwiLFxuXHRcdFx0XCJhbGxcIjogXCJBbGxcIlxuXHRcdH0sXG5cdFx0XCJoZWFkZXJGaWx0ZXJzXCI6IHtcblx0XHRcdFwiZGVmYXVsdFwiOiBcImZpbHRlciBjb2x1bW4uLi5cIixcblx0XHRcdFwiY29sdW1uc1wiOiB7fVxuXHRcdH1cblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImxvY2FsaXplXCIsIExvY2FsaXplKTtcbnZhciBDb21tcyA9IGZ1bmN0aW9uIENvbW1zKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTtcbn07XG5cbkNvbW1zLnByb3RvdHlwZS5nZXRDb25uZWN0aW9ucyA9IGZ1bmN0aW9uIChzZWxlY3RvcnMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29ubmVjdGlvbnMgPSBbXSxcblx0ICAgIGNvbm5lY3Rpb247XG5cblx0Y29ubmVjdGlvbiA9IFRhYnVsYXRvci5wcm90b3R5cGUuY29tbXMubG9va3VwVGFibGUoc2VsZWN0b3JzKTtcblxuXHRjb25uZWN0aW9uLmZvckVhY2goZnVuY3Rpb24gKGNvbikge1xuXHRcdGlmIChzZWxmLnRhYmxlICE9PSBjb24pIHtcblx0XHRcdGNvbm5lY3Rpb25zLnB1c2goY29uKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBjb25uZWN0aW9ucztcbn07XG5cbkNvbW1zLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24gKHNlbGVjdG9ycywgbW9kdWxlLCBhY3Rpb24sIGRhdGEpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29ubmVjdGlvbnMgPSB0aGlzLmdldENvbm5lY3Rpb25zKHNlbGVjdG9ycyk7XG5cblx0Y29ubmVjdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoY29ubmVjdGlvbikge1xuXHRcdGNvbm5lY3Rpb24udGFibGVDb21tcyhzZWxmLnRhYmxlLmVsZW1lbnQsIG1vZHVsZSwgYWN0aW9uLCBkYXRhKTtcblx0fSk7XG5cblx0aWYgKCFjb25uZWN0aW9ucy5sZW5ndGggJiYgc2VsZWN0b3JzKSB7XG5cdFx0Y29uc29sZS53YXJuKFwiVGFibGUgQ29ubmVjdGlvbiBFcnJvciAtIE5vIHRhYmxlcyBtYXRjaGluZyBzZWxlY3RvciBmb3VuZFwiLCBzZWxlY3RvcnMpO1xuXHR9XG59O1xuXG5Db21tcy5wcm90b3R5cGUucmVjZWl2ZSA9IGZ1bmN0aW9uICh0YWJsZSwgbW9kdWxlLCBhY3Rpb24sIGRhdGEpIHtcblx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKG1vZHVsZSkpIHtcblx0XHRyZXR1cm4gdGhpcy50YWJsZS5tb2R1bGVzW21vZHVsZV0uY29tbXNSZWNlaXZlZCh0YWJsZSwgYWN0aW9uLCBkYXRhKTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJJbnRlci10YWJsZSBDb21tcyBFcnJvciAtIG5vIHN1Y2ggbW9kdWxlOlwiLCBtb2R1bGUpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwiY29tbXNcIiwgQ29tbXMpO1xuXG52YXIgQWNjZXNzb3IgPSBmdW5jdGlvbiBBY2Nlc3Nvcih0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuYWxsb3dlZFR5cGVzID0gW1wiXCIsIFwiZGF0YVwiLCBcImRvd25sb2FkXCIsIFwiY2xpcGJvYXJkXCIsIFwicHJpbnRcIiwgXCJodG1sT3V0cHV0XCJdOyAvL2xpc3Qgb2YgYWNjZXNzb3IgdHlwZXNcbn07XG5cbi8vaW5pdGlhbGl6ZSBjb2x1bW4gYWNjZXNzb3JcbkFjY2Vzc29yLnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBtYXRjaCA9IGZhbHNlLFxuXHQgICAgY29uZmlnID0ge307XG5cblx0dGhpcy5hbGxvd2VkVHlwZXMuZm9yRWFjaChmdW5jdGlvbiAodHlwZSkge1xuXHRcdHZhciBrZXkgPSBcImFjY2Vzc29yXCIgKyAodHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHR5cGUuc2xpY2UoMSkpLFxuXHRcdCAgICBhY2Nlc3NvcjtcblxuXHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbltrZXldKSB7XG5cdFx0XHRhY2Nlc3NvciA9IHNlbGYubG9va3VwQWNjZXNzb3IoY29sdW1uLmRlZmluaXRpb25ba2V5XSk7XG5cblx0XHRcdGlmIChhY2Nlc3Nvcikge1xuXHRcdFx0XHRtYXRjaCA9IHRydWU7XG5cblx0XHRcdFx0Y29uZmlnW2tleV0gPSB7XG5cdFx0XHRcdFx0YWNjZXNzb3I6IGFjY2Vzc29yLFxuXHRcdFx0XHRcdHBhcmFtczogY29sdW1uLmRlZmluaXRpb25ba2V5ICsgXCJQYXJhbXNcIl0gfHwge31cblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGlmIChtYXRjaCkge1xuXHRcdGNvbHVtbi5tb2R1bGVzLmFjY2Vzc29yID0gY29uZmlnO1xuXHR9XG59O1xuXG5BY2Nlc3Nvci5wcm90b3R5cGUubG9va3VwQWNjZXNzb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0dmFyIGFjY2Vzc29yID0gZmFsc2U7XG5cblx0Ly9zZXQgY29sdW1uIGFjY2Vzc29yXG5cdHN3aXRjaCAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRpZiAodGhpcy5hY2Nlc3NvcnNbdmFsdWVdKSB7XG5cdFx0XHRcdGFjY2Vzc29yID0gdGhpcy5hY2Nlc3NvcnNbdmFsdWVdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiQWNjZXNzb3IgRXJyb3IgLSBObyBzdWNoIGFjY2Vzc29yIGZvdW5kLCBpZ25vcmluZzogXCIsIHZhbHVlKTtcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRhY2Nlc3NvciA9IHZhbHVlO1xuXHRcdFx0YnJlYWs7XG5cdH1cblxuXHRyZXR1cm4gYWNjZXNzb3I7XG59O1xuXG4vL2FwcGx5IGFjY2Vzc29yIHRvIHJvd1xuQWNjZXNzb3IucHJvdG90eXBlLnRyYW5zZm9ybVJvdyA9IGZ1bmN0aW9uIChyb3csIHR5cGUpIHtcblx0dmFyIGtleSA9IFwiYWNjZXNzb3JcIiArICh0eXBlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdHlwZS5zbGljZSgxKSksXG5cdCAgICByb3dDb21wb25lbnQgPSByb3cuZ2V0Q29tcG9uZW50KCk7XG5cblx0Ly9jbG9uZSBkYXRhIG9iamVjdCB3aXRoIGRlZXAgY29weSB0byBpc29sYXRlIGludGVybmFsIGRhdGEgZnJvbSByZXR1cm5lZCByZXN1bHRcblx0dmFyIGRhdGEgPSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZGVlcENsb25lKHJvdy5kYXRhIHx8IHt9KTtcblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIudHJhdmVyc2UoZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdHZhciB2YWx1ZSwgYWNjZXNzb3IsIHBhcmFtcywgY29sQ29tcG5lbnQ7XG5cblx0XHRpZiAoY29sdW1uLm1vZHVsZXMuYWNjZXNzb3IpIHtcblxuXHRcdFx0YWNjZXNzb3IgPSBjb2x1bW4ubW9kdWxlcy5hY2Nlc3NvcltrZXldIHx8IGNvbHVtbi5tb2R1bGVzLmFjY2Vzc29yLmFjY2Vzc29yIHx8IGZhbHNlO1xuXG5cdFx0XHRpZiAoYWNjZXNzb3IpIHtcblx0XHRcdFx0dmFsdWUgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShkYXRhKTtcblxuXHRcdFx0XHRpZiAodmFsdWUgIT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdGNvbENvbXBuZW50ID0gY29sdW1uLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHRcdHBhcmFtcyA9IHR5cGVvZiBhY2Nlc3Nvci5wYXJhbXMgPT09IFwiZnVuY3Rpb25cIiA/IGFjY2Vzc29yLnBhcmFtcyh2YWx1ZSwgZGF0YSwgdHlwZSwgY29sQ29tcG5lbnQsIHJvd0NvbXBvbmVudCkgOiBhY2Nlc3Nvci5wYXJhbXM7XG5cdFx0XHRcdFx0Y29sdW1uLnNldEZpZWxkVmFsdWUoZGF0YSwgYWNjZXNzb3IuYWNjZXNzb3IodmFsdWUsIGRhdGEsIHR5cGUsIHBhcmFtcywgY29sQ29tcG5lbnQsIHJvd0NvbXBvbmVudCkpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gZGF0YTtcbn0sXG5cbi8vZGVmYXVsdCBhY2Nlc3NvcnNcbkFjY2Vzc29yLnByb3RvdHlwZS5hY2Nlc3NvcnMgPSB7fTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImFjY2Vzc29yXCIsIEFjY2Vzc29yKTtcbnZhciBBamF4ID0gZnVuY3Rpb24gQWpheCh0YWJsZSkge1xuXG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcblx0dGhpcy5jb25maWcgPSBmYWxzZTsgLy9ob2xkIGNvbmZpZyBvYmplY3QgZm9yIGFqYXggcmVxdWVzdFxuXHR0aGlzLnVybCA9IFwiXCI7IC8vcmVxdWVzdCBVUkxcblx0dGhpcy51cmxHZW5lcmF0b3IgPSBmYWxzZTtcblx0dGhpcy5wYXJhbXMgPSBmYWxzZTsgLy9yZXF1ZXN0IHBhcmFtZXRlcnNcblxuXHR0aGlzLmxvYWRlckVsZW1lbnQgPSB0aGlzLmNyZWF0ZUxvYWRlckVsZW1lbnQoKTsgLy9sb2FkZXIgbWVzc2FnZSBkaXZcblx0dGhpcy5tc2dFbGVtZW50ID0gdGhpcy5jcmVhdGVNc2dFbGVtZW50KCk7IC8vbWVzc2FnZSBlbGVtZW50XG5cdHRoaXMubG9hZGluZ0VsZW1lbnQgPSBmYWxzZTtcblx0dGhpcy5lcnJvckVsZW1lbnQgPSBmYWxzZTtcblx0dGhpcy5sb2FkZXJQcm9taXNlID0gZmFsc2U7XG5cblx0dGhpcy5wcm9ncmVzc2l2ZUxvYWQgPSBmYWxzZTtcblx0dGhpcy5sb2FkaW5nID0gZmFsc2U7XG5cblx0dGhpcy5yZXF1ZXN0T3JkZXIgPSAwOyAvL3ByZXZlbnQgcmVxdWVzdHMgY29tbWluZyBvdXQgb2Ygc2VxdWVuY2UgaWYgb3ZlcnJpZGRlbiBieSBhbm90aGVyIGxvYWQgcmVxdWVzdFxufTtcblxuLy9pbml0aWFsaXplIHNldHVwIG9wdGlvbnNcbkFqYXgucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciB0ZW1wbGF0ZTtcblxuXHR0aGlzLmxvYWRlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5tc2dFbGVtZW50KTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmFqYXhMb2FkZXJMb2FkaW5nKSB7XG5cdFx0aWYgKHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheExvYWRlckxvYWRpbmcgPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0dGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xuXHRcdFx0dGVtcGxhdGUuaW5uZXJIVE1MID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhMb2FkZXJMb2FkaW5nLnRyaW0oKTtcblx0XHRcdHRoaXMubG9hZGluZ0VsZW1lbnQgPSB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0Q2hpbGQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubG9hZGluZ0VsZW1lbnQgPSB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheExvYWRlckxvYWRpbmc7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5sb2FkZXJQcm9taXNlID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhSZXF1ZXN0RnVuYyB8fCB0aGlzLmRlZmF1bHRMb2FkZXJQcm9taXNlO1xuXG5cdHRoaXMudXJsR2VuZXJhdG9yID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhVUkxHZW5lcmF0b3IgfHwgdGhpcy5kZWZhdWx0VVJMR2VuZXJhdG9yO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuYWpheExvYWRlckVycm9yKSB7XG5cdFx0aWYgKHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheExvYWRlckVycm9yID09IFwic3RyaW5nXCIpIHtcblx0XHRcdHRlbXBsYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnKTtcblx0XHRcdHRlbXBsYXRlLmlubmVySFRNTCA9IHRoaXMudGFibGUub3B0aW9ucy5hamF4TG9hZGVyRXJyb3IudHJpbSgpO1xuXHRcdFx0dGhpcy5lcnJvckVsZW1lbnQgPSB0ZW1wbGF0ZS5jb250ZW50LmZpcnN0Q2hpbGQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZXJyb3JFbGVtZW50ID0gdGhpcy50YWJsZS5vcHRpb25zLmFqYXhMb2FkZXJFcnJvcjtcblx0XHR9XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmFqYXhQYXJhbXMpIHtcblx0XHR0aGlzLnNldFBhcmFtcyh0aGlzLnRhYmxlLm9wdGlvbnMuYWpheFBhcmFtcyk7XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmFqYXhDb25maWcpIHtcblx0XHR0aGlzLnNldENvbmZpZyh0aGlzLnRhYmxlLm9wdGlvbnMuYWpheENvbmZpZyk7XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmFqYXhVUkwpIHtcblx0XHR0aGlzLnNldFVybCh0aGlzLnRhYmxlLm9wdGlvbnMuYWpheFVSTCk7XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmFqYXhQcm9ncmVzc2l2ZUxvYWQpIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24pIHtcblx0XHRcdHRoaXMucHJvZ3Jlc3NpdmVMb2FkID0gZmFsc2U7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiUHJvZ3Jlc3NpdmUgTG9hZCBFcnJvciAtIFBhZ2luYXRpb24gYW5kIHByb2dyZXNzaXZlIGxvYWQgY2Fubm90IGJlIHVzZWQgYXQgdGhlIHNhbWUgdGltZVwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwicGFnZVwiKSkge1xuXHRcdFx0XHR0aGlzLnByb2dyZXNzaXZlTG9hZCA9IHRoaXMudGFibGUub3B0aW9ucy5hamF4UHJvZ3Jlc3NpdmVMb2FkO1xuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucGFnZS5pbml0aWFsaXplUHJvZ3Jlc3NpdmUodGhpcy5wcm9ncmVzc2l2ZUxvYWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIlBhZ2luYXRpb24gcGx1Z2luIGlzIHJlcXVpcmVkIGZvciBwcm9ncmVzc2l2ZSBhamF4IGxvYWRpbmdcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5BamF4LnByb3RvdHlwZS5jcmVhdGVMb2FkZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWxvYWRlclwiKTtcblx0cmV0dXJuIGVsO1xufTtcblxuQWpheC5wcm90b3R5cGUuY3JlYXRlTXNnRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWxvYWRlci1tc2dcIik7XG5cdGVsLnNldEF0dHJpYnV0ZShcInJvbGVcIiwgXCJhbGVydFwiKTtcblxuXHRyZXR1cm4gZWw7XG59O1xuXG4vL3NldCBhamF4IHBhcmFtc1xuQWpheC5wcm90b3R5cGUuc2V0UGFyYW1zID0gZnVuY3Rpb24gKHBhcmFtcywgdXBkYXRlKSB7XG5cdGlmICh1cGRhdGUpIHtcblx0XHR0aGlzLnBhcmFtcyA9IHRoaXMucGFyYW1zIHx8IHt9O1xuXG5cdFx0Zm9yICh2YXIga2V5IGluIHBhcmFtcykge1xuXHRcdFx0dGhpcy5wYXJhbXNba2V5XSA9IHBhcmFtc1trZXldO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHR0aGlzLnBhcmFtcyA9IHBhcmFtcztcblx0fVxufTtcblxuQWpheC5wcm90b3R5cGUuZ2V0UGFyYW1zID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5wYXJhbXMgfHwge307XG59O1xuXG4vL2xvYWQgY29uZmlnIG9iamVjdFxuQWpheC5wcm90b3R5cGUuc2V0Q29uZmlnID0gZnVuY3Rpb24gKGNvbmZpZykge1xuXHR0aGlzLl9sb2FkRGVmYXVsdENvbmZpZygpO1xuXG5cdGlmICh0eXBlb2YgY29uZmlnID09IFwic3RyaW5nXCIpIHtcblx0XHR0aGlzLmNvbmZpZy5tZXRob2QgPSBjb25maWc7XG5cdH0gZWxzZSB7XG5cdFx0Zm9yICh2YXIga2V5IGluIGNvbmZpZykge1xuXHRcdFx0dGhpcy5jb25maWdba2V5XSA9IGNvbmZpZ1trZXldO1xuXHRcdH1cblx0fVxufTtcblxuLy9jcmVhdGUgY29uZmlnIG9iamVjdCBmcm9tIGRlZmF1bHRcbkFqYXgucHJvdG90eXBlLl9sb2FkRGVmYXVsdENvbmZpZyA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdGlmICghc2VsZi5jb25maWcgfHwgZm9yY2UpIHtcblxuXHRcdHNlbGYuY29uZmlnID0ge307XG5cblx0XHQvL2xvYWQgYmFzZSBjb25maWcgZnJvbSBkZWZhdWx0c1xuXHRcdGZvciAodmFyIGtleSBpbiBzZWxmLmRlZmF1bHRDb25maWcpIHtcblx0XHRcdHNlbGYuY29uZmlnW2tleV0gPSBzZWxmLmRlZmF1bHRDb25maWdba2V5XTtcblx0XHR9XG5cdH1cbn07XG5cbi8vc2V0IHJlcXVlc3QgdXJsXG5BamF4LnByb3RvdHlwZS5zZXRVcmwgPSBmdW5jdGlvbiAodXJsKSB7XG5cdHRoaXMudXJsID0gdXJsO1xufTtcblxuLy9nZXQgcmVxdWVzdCB1cmxcbkFqYXgucHJvdG90eXBlLmdldFVybCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMudXJsO1xufTtcblxuLy9sc3RhbmRhcmQgbG9hZGluZyBmdW5jdGlvblxuQWpheC5wcm90b3R5cGUubG9hZERhdGEgPSBmdW5jdGlvbiAoaW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdGlmICh0aGlzLnByb2dyZXNzaXZlTG9hZCkge1xuXHRcdHJldHVybiB0aGlzLl9sb2FkRGF0YVByb2dyZXNzaXZlKCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIHRoaXMuX2xvYWREYXRhU3RhbmRhcmQoaW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpO1xuXHR9XG59O1xuXG5BamF4LnByb3RvdHlwZS5uZXh0UGFnZSA9IGZ1bmN0aW9uIChkaWZmKSB7XG5cdHZhciBtYXJnaW47XG5cblx0aWYgKCF0aGlzLmxvYWRpbmcpIHtcblxuXHRcdG1hcmdpbiA9IHRoaXMudGFibGUub3B0aW9ucy5hamF4UHJvZ3Jlc3NpdmVMb2FkU2Nyb2xsTWFyZ2luIHx8IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRFbGVtZW50KCkuY2xpZW50SGVpZ2h0ICogMjtcblxuXHRcdGlmIChkaWZmIDwgbWFyZ2luKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucGFnZS5uZXh0UGFnZSgpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTtcblx0XHR9XG5cdH1cbn07XG5cbkFqYXgucHJvdG90eXBlLmJsb2NrQWN0aXZlUmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5yZXF1ZXN0T3JkZXIrKztcbn07XG5cbkFqYXgucHJvdG90eXBlLl9sb2FkRGF0YVByb2dyZXNzaXZlID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2V0RGF0YShbXSk7XG5cdHJldHVybiB0aGlzLnRhYmxlLm1vZHVsZXMucGFnZS5zZXRQYWdlKDEpO1xufTtcblxuQWpheC5wcm90b3R5cGUuX2xvYWREYXRhU3RhbmRhcmQgPSBmdW5jdGlvbiAoaW5Qb3NpdGlvbiwgY29sdW1uc0NoYW5nZWQpIHtcblx0dmFyIF90aGlzNDIgPSB0aGlzO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0X3RoaXM0Mi5zZW5kUmVxdWVzdChpblBvc2l0aW9uKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRfdGhpczQyLnRhYmxlLnJvd01hbmFnZXIuc2V0RGF0YShkYXRhLCBpblBvc2l0aW9uLCBjb2x1bW5zQ2hhbmdlZCkudGhlbihmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdHJlamVjdChlKTtcblx0XHRcdH0pO1xuXHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRyZWplY3QoZSk7XG5cdFx0fSk7XG5cdH0pO1xufTtcblxuQWpheC5wcm90b3R5cGUuZ2VuZXJhdGVQYXJhbXNMaXN0ID0gZnVuY3Rpb24gKGRhdGEsIHByZWZpeCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBvdXRwdXQgPSBbXTtcblxuXHRwcmVmaXggPSBwcmVmaXggfHwgXCJcIjtcblxuXHRpZiAoQXJyYXkuaXNBcnJheShkYXRhKSkge1xuXHRcdGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuXHRcdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChzZWxmLmdlbmVyYXRlUGFyYW1zTGlzdChpdGVtLCBwcmVmaXggPyBwcmVmaXggKyBcIltcIiArIGkgKyBcIl1cIiA6IGkpKTtcblx0XHR9KTtcblx0fSBlbHNlIGlmICgodHlwZW9mIGRhdGEgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGRhdGEpKSA9PT0gXCJvYmplY3RcIikge1xuXHRcdGZvciAodmFyIGtleSBpbiBkYXRhKSB7XG5cdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KHNlbGYuZ2VuZXJhdGVQYXJhbXNMaXN0KGRhdGFba2V5XSwgcHJlZml4ID8gcHJlZml4ICsgXCJbXCIgKyBrZXkgKyBcIl1cIiA6IGtleSkpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRvdXRwdXQucHVzaCh7IGtleTogcHJlZml4LCB2YWx1ZTogZGF0YSB9KTtcblx0fVxuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5BamF4LnByb3RvdHlwZS5zZXJpYWxpemVQYXJhbXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdHZhciBvdXRwdXQgPSB0aGlzLmdlbmVyYXRlUGFyYW1zTGlzdChwYXJhbXMpLFxuXHQgICAgZW5jb2RlZCA9IFtdO1xuXG5cdG91dHB1dC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0ZW5jb2RlZC5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChpdGVtLmtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChpdGVtLnZhbHVlKSk7XG5cdH0pO1xuXG5cdHJldHVybiBlbmNvZGVkLmpvaW4oXCImXCIpO1xufTtcblxuLy9zZW5kIGFqYXggcmVxdWVzdFxuQWpheC5wcm90b3R5cGUuc2VuZFJlcXVlc3QgPSBmdW5jdGlvbiAoc2lsZW50KSB7XG5cdHZhciBfdGhpczQzID0gdGhpcztcblxuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICB1cmwgPSBzZWxmLnVybCxcblx0ICAgIHJlcXVlc3RObyxcblx0ICAgIGVzYyxcblx0ICAgIHF1ZXJ5O1xuXG5cdHNlbGYucmVxdWVzdE9yZGVyKys7XG5cdHJlcXVlc3RObyA9IHNlbGYucmVxdWVzdE9yZGVyO1xuXG5cdHNlbGYuX2xvYWREZWZhdWx0Q29uZmlnKCk7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmFqYXhSZXF1ZXN0aW5nLmNhbGwoX3RoaXM0My50YWJsZSwgc2VsZi51cmwsIHNlbGYucGFyYW1zKSAhPT0gZmFsc2UpIHtcblxuXHRcdFx0c2VsZi5sb2FkaW5nID0gdHJ1ZTtcblxuXHRcdFx0aWYgKCFzaWxlbnQpIHtcblx0XHRcdFx0c2VsZi5zaG93TG9hZGVyKCk7XG5cdFx0XHR9XG5cblx0XHRcdF90aGlzNDMubG9hZGVyUHJvbWlzZSh1cmwsIHNlbGYuY29uZmlnLCBzZWxmLnBhcmFtcykudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRpZiAocmVxdWVzdE5vID09PSBzZWxmLnJlcXVlc3RPcmRlcikge1xuXHRcdFx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuYWpheFJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0XHRkYXRhID0gc2VsZi50YWJsZS5vcHRpb25zLmFqYXhSZXNwb25zZS5jYWxsKHNlbGYudGFibGUsIHNlbGYudXJsLCBzZWxmLnBhcmFtcywgZGF0YSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJlc29sdmUoZGF0YSk7XG5cblx0XHRcdFx0XHRzZWxmLmhpZGVMb2FkZXIoKTtcblx0XHRcdFx0XHRzZWxmLmxvYWRpbmcgPSBmYWxzZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJBamF4IFJlc3BvbnNlIEJsb2NrZWQgLSBBbiBhY3RpdmUgYWpheCByZXF1ZXN0IHdhcyBibG9ja2VkIGJ5IGFuIGF0dGVtcHQgdG8gY2hhbmdlIHRhYmxlIGRhdGEgd2hpbGUgdGhlIHJlcXVlc3Qgd2FzIGJlaW5nIG1hZGVcIik7XG5cdFx0XHRcdH1cblx0XHRcdH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiQWpheCBMb2FkIEVycm9yOiBcIiwgZXJyb3IpO1xuXHRcdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuYWpheEVycm9yLmNhbGwoc2VsZi50YWJsZSwgZXJyb3IpO1xuXG5cdFx0XHRcdHNlbGYuc2hvd0Vycm9yKCk7XG5cblx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0c2VsZi5oaWRlTG9hZGVyKCk7XG5cdFx0XHRcdH0sIDMwMDApO1xuXG5cdFx0XHRcdHNlbGYubG9hZGluZyA9IGZhbHNlO1xuXG5cdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVqZWN0KCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbkFqYXgucHJvdG90eXBlLnNob3dMb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzaG91bGRMb2FkID0gdHlwZW9mIHRoaXMudGFibGUub3B0aW9ucy5hamF4TG9hZGVyID09PSBcImZ1bmN0aW9uXCIgPyB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheExvYWRlcigpIDogdGhpcy50YWJsZS5vcHRpb25zLmFqYXhMb2FkZXI7XG5cblx0aWYgKHNob3VsZExvYWQpIHtcblxuXHRcdHRoaXMuaGlkZUxvYWRlcigpO1xuXG5cdFx0d2hpbGUgKHRoaXMubXNnRWxlbWVudC5maXJzdENoaWxkKSB7XG5cdFx0XHR0aGlzLm1zZ0VsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5tc2dFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdH10aGlzLm1zZ0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1lcnJvclwiKTtcblx0XHR0aGlzLm1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1sb2FkaW5nXCIpO1xuXG5cdFx0aWYgKHRoaXMubG9hZGluZ0VsZW1lbnQpIHtcblx0XHRcdHRoaXMubXNnRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmxvYWRpbmdFbGVtZW50KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5tc2dFbGVtZW50LmlubmVySFRNTCA9IHRoaXMudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5nZXRUZXh0KFwiYWpheHxsb2FkaW5nXCIpO1xuXHRcdH1cblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmxvYWRlckVsZW1lbnQpO1xuXHR9XG59O1xuXG5BamF4LnByb3RvdHlwZS5zaG93RXJyb3IgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuaGlkZUxvYWRlcigpO1xuXG5cdHdoaWxlICh0aGlzLm1zZ0VsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdHRoaXMubXNnRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLm1zZ0VsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdH10aGlzLm1zZ0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1sb2FkaW5nXCIpO1xuXHR0aGlzLm1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1lcnJvclwiKTtcblxuXHRpZiAodGhpcy5lcnJvckVsZW1lbnQpIHtcblx0XHR0aGlzLm1zZ0VsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5lcnJvckVsZW1lbnQpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMubXNnRWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuZ2V0VGV4dChcImFqYXh8ZXJyb3JcIik7XG5cdH1cblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5sb2FkZXJFbGVtZW50KTtcbn07XG5cbkFqYXgucHJvdG90eXBlLmhpZGVMb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLmxvYWRlckVsZW1lbnQucGFyZW50Tm9kZSkge1xuXHRcdHRoaXMubG9hZGVyRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMubG9hZGVyRWxlbWVudCk7XG5cdH1cbn07XG5cbi8vZGVmYXVsdCBhamF4IGNvbmZpZyBvYmplY3RcbkFqYXgucHJvdG90eXBlLmRlZmF1bHRDb25maWcgPSB7XG5cdG1ldGhvZDogXCJHRVRcIlxufTtcblxuQWpheC5wcm90b3R5cGUuZGVmYXVsdFVSTEdlbmVyYXRvciA9IGZ1bmN0aW9uICh1cmwsIGNvbmZpZywgcGFyYW1zKSB7XG5cblx0aWYgKHVybCkge1xuXHRcdGlmIChwYXJhbXMgJiYgT2JqZWN0LmtleXMocGFyYW1zKS5sZW5ndGgpIHtcblx0XHRcdGlmICghY29uZmlnLm1ldGhvZCB8fCBjb25maWcubWV0aG9kLnRvTG93ZXJDYXNlKCkgPT0gXCJnZXRcIikge1xuXHRcdFx0XHRjb25maWcubWV0aG9kID0gXCJnZXRcIjtcblxuXHRcdFx0XHR1cmwgKz0gKHVybC5pbmNsdWRlcyhcIj9cIikgPyBcIiZcIiA6IFwiP1wiKSArIHRoaXMubW9kdWxlcy5hamF4LnNlcmlhbGl6ZVBhcmFtcyhwYXJhbXMpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiB1cmw7XG59O1xuXG5BamF4LnByb3RvdHlwZS5kZWZhdWx0TG9hZGVyUHJvbWlzZSA9IGZ1bmN0aW9uICh1cmwsIGNvbmZpZywgcGFyYW1zKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGNvbnRlbnRUeXBlO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblx0XHQvL3NldCB1cmxcblx0XHR1cmwgPSBzZWxmLnVybEdlbmVyYXRvci5jYWxsKHNlbGYudGFibGUsIHVybCwgY29uZmlnLCBwYXJhbXMpO1xuXG5cdFx0Ly9zZXQgYm9keSBjb250ZW50IGlmIG5vdCBHRVQgcmVxdWVzdFxuXHRcdGlmIChjb25maWcubWV0aG9kLnRvVXBwZXJDYXNlKCkgIT0gXCJHRVRcIikge1xuXHRcdFx0Y29udGVudFR5cGUgPSBfdHlwZW9mKHNlbGYudGFibGUub3B0aW9ucy5hamF4Q29udGVudFR5cGUpID09PSBcIm9iamVjdFwiID8gc2VsZi50YWJsZS5vcHRpb25zLmFqYXhDb250ZW50VHlwZSA6IHNlbGYuY29udGVudFR5cGVGb3JtYXR0ZXJzW3NlbGYudGFibGUub3B0aW9ucy5hamF4Q29udGVudFR5cGVdO1xuXHRcdFx0aWYgKGNvbnRlbnRUeXBlKSB7XG5cblx0XHRcdFx0Zm9yICh2YXIga2V5IGluIGNvbnRlbnRUeXBlLmhlYWRlcnMpIHtcblx0XHRcdFx0XHRpZiAoIWNvbmZpZy5oZWFkZXJzKSB7XG5cdFx0XHRcdFx0XHRjb25maWcuaGVhZGVycyA9IHt9O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh0eXBlb2YgY29uZmlnLmhlYWRlcnNba2V5XSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdFx0Y29uZmlnLmhlYWRlcnNba2V5XSA9IGNvbnRlbnRUeXBlLmhlYWRlcnNba2V5XTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25maWcuYm9keSA9IGNvbnRlbnRUeXBlLmJvZHkuY2FsbChzZWxmLCB1cmwsIGNvbmZpZywgcGFyYW1zKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkFqYXggRXJyb3IgLSBJbnZhbGlkIGFqYXhDb250ZW50VHlwZSB2YWx1ZTpcIiwgc2VsZi50YWJsZS5vcHRpb25zLmFqYXhDb250ZW50VHlwZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHVybCkge1xuXG5cdFx0XHQvL2NvbmZpZ3VyZSBoZWFkZXJzXG5cdFx0XHRpZiAodHlwZW9mIGNvbmZpZy5oZWFkZXJzID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGNvbmZpZy5oZWFkZXJzID0ge307XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0eXBlb2YgY29uZmlnLmhlYWRlcnMuQWNjZXB0ID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdGNvbmZpZy5oZWFkZXJzLkFjY2VwdCA9IFwiYXBwbGljYXRpb24vanNvblwiO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodHlwZW9mIGNvbmZpZy5oZWFkZXJzW1wiWC1SZXF1ZXN0ZWQtV2l0aFwiXSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRjb25maWcuaGVhZGVyc1tcIlgtUmVxdWVzdGVkLVdpdGhcIl0gPSBcIlhNTEh0dHBSZXF1ZXN0XCI7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0eXBlb2YgY29uZmlnLm1vZGUgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0Y29uZmlnLm1vZGUgPSBcImNvcnNcIjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGNvbmZpZy5tb2RlID09IFwiY29yc1wiKSB7XG5cblx0XHRcdFx0aWYgKHR5cGVvZiBjb25maWcuaGVhZGVyc1tcIkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpblwiXSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdGNvbmZpZy5oZWFkZXJzW1wiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luXCJdID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh0eXBlb2YgY29uZmlnLmNyZWRlbnRpYWxzID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdFx0Y29uZmlnLmNyZWRlbnRpYWxzID0gJ3NhbWUtb3JpZ2luJztcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHR5cGVvZiBjb25maWcuY3JlZGVudGlhbHMgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRjb25maWcuY3JlZGVudGlhbHMgPSAnaW5jbHVkZSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9zZW5kIHJlcXVlc3Rcblx0XHRcdGZldGNoKHVybCwgY29uZmlnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0XHRpZiAocmVzcG9uc2Uub2spIHtcblx0XHRcdFx0XHRyZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdFx0cmVzb2x2ZShkYXRhKTtcblx0XHRcdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJBamF4IExvYWQgRXJyb3IgLSBJbnZhbGlkIEpTT04gcmV0dXJuZWRcIiwgZXJyb3IpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJBamF4IExvYWQgRXJyb3IgLSBDb25uZWN0aW9uIEVycm9yOiBcIiArIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG5cdFx0XHRcdFx0cmVqZWN0KHJlc3BvbnNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJBamF4IExvYWQgRXJyb3IgLSBDb25uZWN0aW9uIEVycm9yOiBcIiwgZXJyb3IpO1xuXHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkFqYXggTG9hZCBFcnJvciAtIE5vIFVSTCBTZXRcIik7XG5cdFx0XHRyZXNvbHZlKFtdKTtcblx0XHR9XG5cdH0pO1xufTtcblxuQWpheC5wcm90b3R5cGUuY29udGVudFR5cGVGb3JtYXR0ZXJzID0ge1xuXHRcImpzb25cIjoge1xuXHRcdGhlYWRlcnM6IHtcblx0XHRcdCdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcblx0XHR9LFxuXHRcdGJvZHk6IGZ1bmN0aW9uIGJvZHkodXJsLCBjb25maWcsIHBhcmFtcykge1xuXHRcdFx0cmV0dXJuIEpTT04uc3RyaW5naWZ5KHBhcmFtcyk7XG5cdFx0fVxuXHR9LFxuXHRcImZvcm1cIjoge1xuXHRcdGhlYWRlcnM6IHt9LFxuXHRcdGJvZHk6IGZ1bmN0aW9uIGJvZHkodXJsLCBjb25maWcsIHBhcmFtcykge1xuXHRcdFx0dmFyIG91dHB1dCA9IHRoaXMuZ2VuZXJhdGVQYXJhbXNMaXN0KHBhcmFtcyksXG5cdFx0XHQgICAgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuXG5cdFx0XHRvdXRwdXQuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRmb3JtLmFwcGVuZChpdGVtLmtleSwgaXRlbS52YWx1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0cmV0dXJuIGZvcm07XG5cdFx0fVxuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwiYWpheFwiLCBBamF4KTtcblxuLy9wdWJsaWMgY2FsYyBvYmplY3RcbnZhciBDYWxjQ29tcG9uZW50ID0gZnVuY3Rpb24gQ2FsY0NvbXBvbmVudChyb3cpIHtcblx0dGhpcy5fcm93ID0gcm93O1xufTtcblxuQ2FsY0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uICh0cmFuc2Zvcm0pIHtcblx0cmV0dXJuIHRoaXMuX3Jvdy5nZXREYXRhKHRyYW5zZm9ybSk7XG59O1xuXG5DYWxjQ29tcG9uZW50LnByb3RvdHlwZS5nZXRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fcm93LmdldEVsZW1lbnQoKTtcbn07XG5cbkNhbGNDb21wb25lbnQucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fcm93LnRhYmxlO1xufTtcblxuQ2FsY0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjZWxscyA9IFtdO1xuXG5cdHRoaXMuX3Jvdy5nZXRDZWxscygpLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRjZWxscy5wdXNoKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHR9KTtcblxuXHRyZXR1cm4gY2VsbHM7XG59O1xuXG5DYWxjQ29tcG9uZW50LnByb3RvdHlwZS5nZXRDZWxsID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgY2VsbCA9IHRoaXMuX3Jvdy5nZXRDZWxsKGNvbHVtbik7XG5cdHJldHVybiBjZWxsID8gY2VsbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xufTtcblxuQ2FsY0NvbXBvbmVudC5wcm90b3R5cGUuX2dldFNlbGYgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9yb3c7XG59O1xuXG52YXIgQ29sdW1uQ2FsY3MgPSBmdW5jdGlvbiBDb2x1bW5DYWxjcyh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMudG9wQ2FsY3MgPSBbXTtcblx0dGhpcy5ib3RDYWxjcyA9IFtdO1xuXHR0aGlzLmdlbkNvbHVtbiA9IGZhbHNlO1xuXHR0aGlzLnRvcEVsZW1lbnQgPSB0aGlzLmNyZWF0ZUVsZW1lbnQoKTtcblx0dGhpcy5ib3RFbGVtZW50ID0gdGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cdHRoaXMudG9wUm93ID0gZmFsc2U7XG5cdHRoaXMuYm90Um93ID0gZmFsc2U7XG5cdHRoaXMudG9wSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0dGhpcy5ib3RJbml0aWFsaXplZCA9IGZhbHNlO1xuXG5cdHRoaXMuaW5pdGlhbGl6ZSgpO1xufTtcblxuQ29sdW1uQ2FsY3MucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItY2FsY3MtaG9sZGVyXCIpO1xuXHRyZXR1cm4gZWw7XG59O1xuXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5nZW5Db2x1bW4gPSBuZXcgQ29sdW1uKHsgZmllbGQ6IFwidmFsdWVcIiB9LCB0aGlzKTtcbn07XG5cbi8vZHVtbXkgZnVuY3Rpb25zIHRvIGhhbmRsZSBiZWluZyBtb2NrIGNvbHVtbiBtYW5hZ2VyXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUucmVnaXN0ZXJDb2x1bW5GaWVsZCA9IGZ1bmN0aW9uICgpIHt9O1xuXG4vL2luaXRpYWxpemUgY29sdW1uIGNhbGNzXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUuaW5pdGlhbGl6ZUNvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIGRlZiA9IGNvbHVtbi5kZWZpbml0aW9uO1xuXG5cdHZhciBjb25maWcgPSB7XG5cdFx0dG9wQ2FsY1BhcmFtczogZGVmLnRvcENhbGNQYXJhbXMgfHwge30sXG5cdFx0Ym90Q2FsY1BhcmFtczogZGVmLmJvdHRvbUNhbGNQYXJhbXMgfHwge31cblx0fTtcblxuXHRpZiAoZGVmLnRvcENhbGMpIHtcblxuXHRcdHN3aXRjaCAoX3R5cGVvZihkZWYudG9wQ2FsYykpIHtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0aWYgKHRoaXMuY2FsY3VsYXRpb25zW2RlZi50b3BDYWxjXSkge1xuXHRcdFx0XHRcdGNvbmZpZy50b3BDYWxjID0gdGhpcy5jYWxjdWxhdGlvbnNbZGVmLnRvcENhbGNdO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBDYWxjIEVycm9yIC0gTm8gc3VjaCBjYWxjdWxhdGlvbiBmb3VuZCwgaWdub3Jpbmc6IFwiLCBkZWYudG9wQ2FsYyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRjb25maWcudG9wQ2FsYyA9IGRlZi50b3BDYWxjO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdH1cblxuXHRcdGlmIChjb25maWcudG9wQ2FsYykge1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3MgPSBjb25maWc7XG5cdFx0XHR0aGlzLnRvcENhbGNzLnB1c2goY29sdW1uKTtcblxuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcImdyb3VwXCIpIHtcblx0XHRcdFx0dGhpcy5pbml0aWFsaXplVG9wUm93KCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKGRlZi5ib3R0b21DYWxjKSB7XG5cdFx0c3dpdGNoIChfdHlwZW9mKGRlZi5ib3R0b21DYWxjKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRpZiAodGhpcy5jYWxjdWxhdGlvbnNbZGVmLmJvdHRvbUNhbGNdKSB7XG5cdFx0XHRcdFx0Y29uZmlnLmJvdENhbGMgPSB0aGlzLmNhbGN1bGF0aW9uc1tkZWYuYm90dG9tQ2FsY107XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ29sdW1uIENhbGMgRXJyb3IgLSBObyBzdWNoIGNhbGN1bGF0aW9uIGZvdW5kLCBpZ25vcmluZzogXCIsIGRlZi5ib3R0b21DYWxjKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdGNvbmZpZy5ib3RDYWxjID0gZGVmLmJvdHRvbUNhbGM7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0fVxuXG5cdFx0aWYgKGNvbmZpZy5ib3RDYWxjKSB7XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5jb2x1bW5DYWxjcyA9IGNvbmZpZztcblx0XHRcdHRoaXMuYm90Q2FsY3MucHVzaChjb2x1bW4pO1xuXG5cdFx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwiZ3JvdXBcIikge1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemVCb3R0b21Sb3coKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5yZW1vdmVDYWxjcyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGNoYW5nZWQgPSBmYWxzZTtcblxuXHRpZiAodGhpcy50b3BJbml0aWFsaXplZCkge1xuXHRcdHRoaXMudG9wSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0XHR0aGlzLnRvcEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnRvcEVsZW1lbnQpO1xuXHRcdGNoYW5nZWQgPSB0cnVlO1xuXHR9XG5cblx0aWYgKHRoaXMuYm90SW5pdGlhbGl6ZWQpIHtcblx0XHR0aGlzLmJvdEluaXRpYWxpemVkID0gZmFsc2U7XG5cdFx0dGhpcy50YWJsZS5mb290ZXJNYW5hZ2VyLnJlbW92ZSh0aGlzLmJvdEVsZW1lbnQpO1xuXHRcdGNoYW5nZWQgPSB0cnVlO1xuXHR9XG5cblx0aWYgKGNoYW5nZWQpIHtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRqdXN0VGFibGVTaXplKCk7XG5cdH1cbn07XG5cbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5pbml0aWFsaXplVG9wUm93ID0gZnVuY3Rpb24gKCkge1xuXHRpZiAoIXRoaXMudG9wSW5pdGlhbGl6ZWQpIHtcblx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0RWxlbWVudCgpLmluc2VydEJlZm9yZSh0aGlzLnRvcEVsZW1lbnQsIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5oZWFkZXJzRWxlbWVudC5uZXh0U2libGluZyk7XG5cdFx0dGhpcy50b3BJbml0aWFsaXplZCA9IHRydWU7XG5cdH1cbn07XG5cbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5pbml0aWFsaXplQm90dG9tUm93ID0gZnVuY3Rpb24gKCkge1xuXHRpZiAoIXRoaXMuYm90SW5pdGlhbGl6ZWQpIHtcblx0XHR0aGlzLnRhYmxlLmZvb3Rlck1hbmFnZXIucHJlcGVuZCh0aGlzLmJvdEVsZW1lbnQpO1xuXHRcdHRoaXMuYm90SW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHR9XG59O1xuXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUuc2Nyb2xsSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChsZWZ0KSB7XG5cdGlmICh0aGlzLmJvdEluaXRpYWxpemVkICYmIHRoaXMuYm90Um93KSB7XG5cdFx0dGhpcy5ib3RSb3cuZ2V0RWxlbWVudCgpLnN0eWxlLm1hcmdpbkxlZnQgPSAtbGVmdCArIFwicHhcIjtcblx0fVxufTtcblxuQ29sdW1uQ2FsY3MucHJvdG90eXBlLnJlY2FsYyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHZhciBkYXRhLCByb3c7XG5cblx0aWYgKHRoaXMudG9wSW5pdGlhbGl6ZWQgfHwgdGhpcy5ib3RJbml0aWFsaXplZCkge1xuXHRcdGRhdGEgPSB0aGlzLnJvd3NUb0RhdGEocm93cyk7XG5cblx0XHRpZiAodGhpcy50b3BJbml0aWFsaXplZCkge1xuXHRcdFx0aWYgKHRoaXMudG9wUm93KSB7XG5cdFx0XHRcdHRoaXMudG9wUm93LmRlbGV0ZUNlbGxzKCk7XG5cdFx0XHR9XG5cblx0XHRcdHJvdyA9IHRoaXMuZ2VuZXJhdGVSb3coXCJ0b3BcIiwgdGhpcy5yb3dzVG9EYXRhKHJvd3MpKTtcblx0XHRcdHRoaXMudG9wUm93ID0gcm93O1xuXHRcdFx0d2hpbGUgKHRoaXMudG9wRWxlbWVudC5maXJzdENoaWxkKSB7XG5cdFx0XHRcdHRoaXMudG9wRWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLnRvcEVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XHR9dGhpcy50b3BFbGVtZW50LmFwcGVuZENoaWxkKHJvdy5nZXRFbGVtZW50KCkpO1xuXHRcdFx0cm93LmluaXRpYWxpemUodHJ1ZSk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuYm90SW5pdGlhbGl6ZWQpIHtcblx0XHRcdGlmICh0aGlzLmJvdFJvdykge1xuXHRcdFx0XHR0aGlzLmJvdFJvdy5kZWxldGVDZWxscygpO1xuXHRcdFx0fVxuXG5cdFx0XHRyb3cgPSB0aGlzLmdlbmVyYXRlUm93KFwiYm90dG9tXCIsIHRoaXMucm93c1RvRGF0YShyb3dzKSk7XG5cdFx0XHR0aGlzLmJvdFJvdyA9IHJvdztcblx0XHRcdHdoaWxlICh0aGlzLmJvdEVsZW1lbnQuZmlyc3RDaGlsZCkge1xuXHRcdFx0XHR0aGlzLmJvdEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5ib3RFbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHRcdFx0fXRoaXMuYm90RWxlbWVudC5hcHBlbmRDaGlsZChyb3cuZ2V0RWxlbWVudCgpKTtcblx0XHRcdHJvdy5pbml0aWFsaXplKHRydWUpO1xuXHRcdH1cblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5hZGp1c3RUYWJsZVNpemUoKTtcblxuXHRcdC8vc2V0IHJlc2l6YWJsZSBoYW5kbGVzXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZnJvemVuQ29sdW1uc1wiKSkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmZyb3plbkNvbHVtbnMubGF5b3V0KCk7XG5cdFx0fVxuXHR9XG59O1xuXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUucmVjYWxjUm93R3JvdXAgPSBmdW5jdGlvbiAocm93KSB7XG5cdHRoaXMucmVjYWxjR3JvdXAodGhpcy50YWJsZS5tb2R1bGVzLmdyb3VwUm93cy5nZXRSb3dHcm91cChyb3cpKTtcbn07XG5cbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5yZWNhbGNBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczQ0ID0gdGhpcztcblxuXHRpZiAodGhpcy50b3BDYWxjcy5sZW5ndGggfHwgdGhpcy5ib3RDYWxjcy5sZW5ndGgpIHtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9PSBcImdyb3VwXCIpIHtcblx0XHRcdHRoaXMucmVjYWxjKHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9PSBcInRhYmxlXCIpIHtcblxuXHRcdFx0dmFyIGdyb3VwcyA9IHRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLmdldENoaWxkR3JvdXBzKCk7XG5cblx0XHRcdGdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdFx0XHRfdGhpczQ0LnJlY2FsY0dyb3VwKGdyb3VwKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxufTtcblxuQ29sdW1uQ2FsY3MucHJvdG90eXBlLnJlY2FsY0dyb3VwID0gZnVuY3Rpb24gKGdyb3VwKSB7XG5cdHZhciBkYXRhLCByb3dEYXRhO1xuXG5cdGlmIChncm91cCkge1xuXHRcdGlmIChncm91cC5jYWxjcykge1xuXHRcdFx0aWYgKGdyb3VwLmNhbGNzLmJvdHRvbSkge1xuXHRcdFx0XHRkYXRhID0gdGhpcy5yb3dzVG9EYXRhKGdyb3VwLnJvd3MpO1xuXHRcdFx0XHRyb3dEYXRhID0gdGhpcy5nZW5lcmF0ZVJvd0RhdGEoXCJib3R0b21cIiwgZGF0YSk7XG5cblx0XHRcdFx0Z3JvdXAuY2FsY3MuYm90dG9tLnVwZGF0ZURhdGEocm93RGF0YSk7XG5cdFx0XHRcdGdyb3VwLmNhbGNzLmJvdHRvbS5yZWluaXRpYWxpemUoKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGdyb3VwLmNhbGNzLnRvcCkge1xuXHRcdFx0XHRkYXRhID0gdGhpcy5yb3dzVG9EYXRhKGdyb3VwLnJvd3MpO1xuXHRcdFx0XHRyb3dEYXRhID0gdGhpcy5nZW5lcmF0ZVJvd0RhdGEoXCJ0b3BcIiwgZGF0YSk7XG5cblx0XHRcdFx0Z3JvdXAuY2FsY3MudG9wLnVwZGF0ZURhdGEocm93RGF0YSk7XG5cdFx0XHRcdGdyb3VwLmNhbGNzLnRvcC5yZWluaXRpYWxpemUoKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbi8vZ2VuZXJhdGUgdG9wIHN0YXRzIHJvd1xuQ29sdW1uQ2FsY3MucHJvdG90eXBlLmdlbmVyYXRlVG9wUm93ID0gZnVuY3Rpb24gKHJvd3MpIHtcblx0cmV0dXJuIHRoaXMuZ2VuZXJhdGVSb3coXCJ0b3BcIiwgdGhpcy5yb3dzVG9EYXRhKHJvd3MpKTtcbn07XG4vL2dlbmVyYXRlIGJvdHRvbSBzdGF0cyByb3dcbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5nZW5lcmF0ZUJvdHRvbVJvdyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHJldHVybiB0aGlzLmdlbmVyYXRlUm93KFwiYm90dG9tXCIsIHRoaXMucm93c1RvRGF0YShyb3dzKSk7XG59O1xuXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUucm93c1RvRGF0YSA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHZhciBfdGhpczQ1ID0gdGhpcztcblxuXHR2YXIgZGF0YSA9IFtdO1xuXG5cdHJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXG5cdFx0aWYgKF90aGlzNDUudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiBfdGhpczQ1LnRhYmxlLm9wdGlvbnMuZGF0YVRyZWVDaGlsZENvbHVtbkNhbGNzKSB7XG5cdFx0XHRpZiAocm93Lm1vZHVsZXMuZGF0YVRyZWUub3Blbikge1xuXHRcdFx0XHR2YXIgY2hpbGRyZW4gPSBfdGhpczQ1LnJvd3NUb0RhdGEoX3RoaXM0NS50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmdldEZpbHRlcmVkVHJlZUNoaWxkcmVuKHJvdykpO1xuXHRcdFx0XHRkYXRhID0gZGF0YS5jb25jYXQoY2hpbGRyZW4pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGRhdGE7XG59O1xuXG4vL2dlbmVyYXRlIHN0YXRzIHJvd1xuQ29sdW1uQ2FsY3MucHJvdG90eXBlLmdlbmVyYXRlUm93ID0gZnVuY3Rpb24gKHBvcywgZGF0YSkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICByb3dEYXRhID0gdGhpcy5nZW5lcmF0ZVJvd0RhdGEocG9zLCBkYXRhKSxcblx0ICAgIHJvdztcblxuXHRpZiAoc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJtdXRhdG9yXCIpKSB7XG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLm11dGF0b3IuZGlzYWJsZSgpO1xuXHR9XG5cblx0cm93ID0gbmV3IFJvdyhyb3dEYXRhLCB0aGlzLCBcImNhbGNcIik7XG5cblx0aWYgKHNlbGYudGFibGUubW9kRXhpc3RzKFwibXV0YXRvclwiKSkge1xuXHRcdHNlbGYudGFibGUubW9kdWxlcy5tdXRhdG9yLmVuYWJsZSgpO1xuXHR9XG5cblx0cm93LmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNhbGNzXCIsIFwidGFidWxhdG9yLWNhbGNzLVwiICsgcG9zKTtcblxuXHRyb3cuY29tcG9uZW50ID0gZmFsc2U7XG5cblx0cm93LmdldENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoIXRoaXMuY29tcG9uZW50KSB7XG5cdFx0XHR0aGlzLmNvbXBvbmVudCA9IG5ldyBDYWxjQ29tcG9uZW50KHRoaXMpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmNvbXBvbmVudDtcblx0fTtcblxuXHRyb3cuZ2VuZXJhdGVDZWxscyA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBjZWxscyA9IFtdO1xuXG5cdFx0c2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXG5cdFx0XHQvL3NldCBmaWVsZCBuYW1lIG9mIG1vY2sgY29sdW1uXG5cdFx0XHRzZWxmLmdlbkNvbHVtbi5zZXRGaWVsZChjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0XHRzZWxmLmdlbkNvbHVtbi5ob3pBbGlnbiA9IGNvbHVtbi5ob3pBbGlnbjtcblxuXHRcdFx0aWYgKGNvbHVtbi5kZWZpbml0aW9uW3BvcyArIFwiQ2FsY0Zvcm1hdHRlclwiXSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImZvcm1hdFwiKSkge1xuXHRcdFx0XHRzZWxmLmdlbkNvbHVtbi5tb2R1bGVzLmZvcm1hdCA9IHtcblx0XHRcdFx0XHRmb3JtYXR0ZXI6IHNlbGYudGFibGUubW9kdWxlcy5mb3JtYXQuZ2V0Rm9ybWF0dGVyKGNvbHVtbi5kZWZpbml0aW9uW3BvcyArIFwiQ2FsY0Zvcm1hdHRlclwiXSksXG5cdFx0XHRcdFx0cGFyYW1zOiBjb2x1bW4uZGVmaW5pdGlvbltwb3MgKyBcIkNhbGNGb3JtYXR0ZXJQYXJhbXNcIl0gfHwge31cblx0XHRcdFx0fTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbGYuZ2VuQ29sdW1uLm1vZHVsZXMuZm9ybWF0ID0ge1xuXHRcdFx0XHRcdGZvcm1hdHRlcjogc2VsZi50YWJsZS5tb2R1bGVzLmZvcm1hdC5nZXRGb3JtYXR0ZXIoXCJwbGFpbnRleHRcIiksXG5cdFx0XHRcdFx0cGFyYW1zOiB7fVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXG5cdFx0XHQvL2Vuc3VyZSBjc3MgY2xhc3MgZGVmaW50aW9uIGlzIHJlcGxpY2F0ZWQgdG8gY2FsY3VsYXRpb24gY2VsbFxuXHRcdFx0c2VsZi5nZW5Db2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcyA9IGNvbHVtbi5kZWZpbml0aW9uLmNzc0NsYXNzO1xuXG5cdFx0XHQvL2dlbmVyYXRlIGNlbGwgYW5kIGFzc2lnbiB0byBjb3JyZWN0IGNvbHVtblxuXHRcdFx0dmFyIGNlbGwgPSBuZXcgQ2VsbChzZWxmLmdlbkNvbHVtbiwgcm93KTtcblx0XHRcdGNlbGwuZ2V0RWxlbWVudCgpO1xuXHRcdFx0Y2VsbC5jb2x1bW4gPSBjb2x1bW47XG5cdFx0XHRjZWxsLnNldFdpZHRoKCk7XG5cblx0XHRcdGNvbHVtbi5jZWxscy5wdXNoKGNlbGwpO1xuXHRcdFx0Y2VsbHMucHVzaChjZWxsKTtcblxuXHRcdFx0aWYgKCFjb2x1bW4udmlzaWJsZSkge1xuXHRcdFx0XHRjZWxsLmhpZGUoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuY2VsbHMgPSBjZWxscztcblx0fTtcblxuXHRyZXR1cm4gcm93O1xufTtcblxuLy9nZW5lcmF0ZSBzdGF0cyByb3dcbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5nZW5lcmF0ZVJvd0RhdGEgPSBmdW5jdGlvbiAocG9zLCBkYXRhKSB7XG5cdHZhciByb3dEYXRhID0ge30sXG5cdCAgICBjYWxjcyA9IHBvcyA9PSBcInRvcFwiID8gdGhpcy50b3BDYWxjcyA6IHRoaXMuYm90Q2FsY3MsXG5cdCAgICB0eXBlID0gcG9zID09IFwidG9wXCIgPyBcInRvcENhbGNcIiA6IFwiYm90Q2FsY1wiLFxuXHQgICAgcGFyYW1zLFxuXHQgICAgcGFyYW1LZXk7XG5cblx0Y2FsY3MuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0dmFyIHZhbHVlcyA9IFtdO1xuXG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzICYmIGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzW3R5cGVdKSB7XG5cdFx0XHRkYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0dmFsdWVzLnB1c2goY29sdW1uLmdldEZpZWxkVmFsdWUoaXRlbSkpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHBhcmFtS2V5ID0gdHlwZSArIFwiUGFyYW1zXCI7XG5cdFx0XHRwYXJhbXMgPSB0eXBlb2YgY29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3NbcGFyYW1LZXldID09PSBcImZ1bmN0aW9uXCIgPyBjb2x1bW4ubW9kdWxlcy5jb2x1bW5DYWxjc1twYXJhbUtleV0odmFsdWVzLCBkYXRhKSA6IGNvbHVtbi5tb2R1bGVzLmNvbHVtbkNhbGNzW3BhcmFtS2V5XTtcblxuXHRcdFx0Y29sdW1uLnNldEZpZWxkVmFsdWUocm93RGF0YSwgY29sdW1uLm1vZHVsZXMuY29sdW1uQ2FsY3NbdHlwZV0odmFsdWVzLCBkYXRhLCBwYXJhbXMpKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiByb3dEYXRhO1xufTtcblxuQ29sdW1uQ2FsY3MucHJvdG90eXBlLmhhc1RvcENhbGNzID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gISF0aGlzLnRvcENhbGNzLmxlbmd0aDtcbn07XG5cbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5oYXNCb3R0b21DYWxjcyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuICEhdGhpcy5ib3RDYWxjcy5sZW5ndGg7XG59O1xuXG4vL2hhbmRsZSB0YWJsZSByZWRyYXdcbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLnRvcFJvdykge1xuXHRcdHRoaXMudG9wUm93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0fVxuXHRpZiAodGhpcy5ib3RSb3cpIHtcblx0XHR0aGlzLmJvdFJvdy5ub3JtYWxpemVIZWlnaHQodHJ1ZSk7XG5cdH1cbn07XG5cbi8vcmV0dXJuIHRoZSBjYWxjdWxhdGVkXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUuZ2V0UmVzdWx0cyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgcmVzdWx0cyA9IHt9LFxuXHQgICAgZ3JvdXBzO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBCeSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImdyb3VwUm93c1wiKSkge1xuXHRcdGdyb3VwcyA9IHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3MuZ2V0R3JvdXBzKHRydWUpO1xuXG5cdFx0Z3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKGdyb3VwKSB7XG5cdFx0XHRyZXN1bHRzW2dyb3VwLmdldEtleSgpXSA9IHNlbGYuZ2V0R3JvdXBSZXN1bHRzKGdyb3VwKTtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHRyZXN1bHRzID0ge1xuXHRcdFx0dG9wOiB0aGlzLnRvcFJvdyA/IHRoaXMudG9wUm93LmdldERhdGEoKSA6IHt9LFxuXHRcdFx0Ym90dG9tOiB0aGlzLmJvdFJvdyA/IHRoaXMuYm90Um93LmdldERhdGEoKSA6IHt9XG5cdFx0fTtcblx0fVxuXG5cdHJldHVybiByZXN1bHRzO1xufTtcblxuLy9nZXQgcmVzdWx0cyBmcm9tIGEgZ3JvdXBcbkNvbHVtbkNhbGNzLnByb3RvdHlwZS5nZXRHcm91cFJlc3VsdHMgPSBmdW5jdGlvbiAoZ3JvdXApIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZ3JvdXBPYmogPSBncm91cC5fZ2V0U2VsZigpLFxuXHQgICAgc3ViR3JvdXBzID0gZ3JvdXAuZ2V0U3ViR3JvdXBzKCksXG5cdCAgICBzdWJHcm91cFJlc3VsdHMgPSB7fSxcblx0ICAgIHJlc3VsdHMgPSB7fTtcblxuXHRzdWJHcm91cHMuZm9yRWFjaChmdW5jdGlvbiAoc3ViZ3JvdXApIHtcblx0XHRzdWJHcm91cFJlc3VsdHNbc3ViZ3JvdXAuZ2V0S2V5KCldID0gc2VsZi5nZXRHcm91cFJlc3VsdHMoc3ViZ3JvdXApO1xuXHR9KTtcblxuXHRyZXN1bHRzID0ge1xuXHRcdHRvcDogZ3JvdXBPYmouY2FsY3MudG9wID8gZ3JvdXBPYmouY2FsY3MudG9wLmdldERhdGEoKSA6IHt9LFxuXHRcdGJvdHRvbTogZ3JvdXBPYmouY2FsY3MuYm90dG9tID8gZ3JvdXBPYmouY2FsY3MuYm90dG9tLmdldERhdGEoKSA6IHt9LFxuXHRcdGdyb3Vwczogc3ViR3JvdXBSZXN1bHRzXG5cdH07XG5cblx0cmV0dXJuIHJlc3VsdHM7XG59O1xuXG4vL2RlZmF1bHQgY2FsY3VsYXRpb25zXG5Db2x1bW5DYWxjcy5wcm90b3R5cGUuY2FsY3VsYXRpb25zID0ge1xuXHRcImF2Z1wiOiBmdW5jdGlvbiBhdmcodmFsdWVzLCBkYXRhLCBjYWxjUGFyYW1zKSB7XG5cdFx0dmFyIG91dHB1dCA9IDAsXG5cdFx0ICAgIHByZWNpc2lvbiA9IHR5cGVvZiBjYWxjUGFyYW1zLnByZWNpc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiA/IGNhbGNQYXJhbXMucHJlY2lzaW9uIDogMjtcblxuXHRcdGlmICh2YWx1ZXMubGVuZ3RoKSB7XG5cdFx0XHRvdXRwdXQgPSB2YWx1ZXMucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiBOdW1iZXIoc3VtKSArIE51bWJlcih2YWx1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0b3V0cHV0ID0gb3V0cHV0IC8gdmFsdWVzLmxlbmd0aDtcblxuXHRcdFx0b3V0cHV0ID0gcHJlY2lzaW9uICE9PSBmYWxzZSA/IG91dHB1dC50b0ZpeGVkKHByZWNpc2lvbikgOiBvdXRwdXQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHBhcnNlRmxvYXQob3V0cHV0KS50b1N0cmluZygpO1xuXHR9LFxuXHRcIm1heFwiOiBmdW5jdGlvbiBtYXgodmFsdWVzLCBkYXRhLCBjYWxjUGFyYW1zKSB7XG5cdFx0dmFyIG91dHB1dCA9IG51bGwsXG5cdFx0ICAgIHByZWNpc2lvbiA9IHR5cGVvZiBjYWxjUGFyYW1zLnByZWNpc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiA/IGNhbGNQYXJhbXMucHJlY2lzaW9uIDogZmFsc2U7XG5cblx0XHR2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcblxuXHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXG5cdFx0XHRpZiAodmFsdWUgPiBvdXRwdXQgfHwgb3V0cHV0ID09PSBudWxsKSB7XG5cdFx0XHRcdG91dHB1dCA9IHZhbHVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIG91dHB1dCAhPT0gbnVsbCA/IHByZWNpc2lvbiAhPT0gZmFsc2UgPyBvdXRwdXQudG9GaXhlZChwcmVjaXNpb24pIDogb3V0cHV0IDogXCJcIjtcblx0fSxcblx0XCJtaW5cIjogZnVuY3Rpb24gbWluKHZhbHVlcywgZGF0YSwgY2FsY1BhcmFtcykge1xuXHRcdHZhciBvdXRwdXQgPSBudWxsLFxuXHRcdCAgICBwcmVjaXNpb24gPSB0eXBlb2YgY2FsY1BhcmFtcy5wcmVjaXNpb24gIT09IFwidW5kZWZpbmVkXCIgPyBjYWxjUGFyYW1zLnByZWNpc2lvbiA6IGZhbHNlO1xuXG5cdFx0dmFsdWVzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cblx0XHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcblxuXHRcdFx0aWYgKHZhbHVlIDwgb3V0cHV0IHx8IG91dHB1dCA9PT0gbnVsbCkge1xuXHRcdFx0XHRvdXRwdXQgPSB2YWx1ZTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBvdXRwdXQgIT09IG51bGwgPyBwcmVjaXNpb24gIT09IGZhbHNlID8gb3V0cHV0LnRvRml4ZWQocHJlY2lzaW9uKSA6IG91dHB1dCA6IFwiXCI7XG5cdH0sXG5cdFwic3VtXCI6IGZ1bmN0aW9uIHN1bSh2YWx1ZXMsIGRhdGEsIGNhbGNQYXJhbXMpIHtcblx0XHR2YXIgb3V0cHV0ID0gMCxcblx0XHQgICAgcHJlY2lzaW9uID0gdHlwZW9mIGNhbGNQYXJhbXMucHJlY2lzaW9uICE9PSBcInVuZGVmaW5lZFwiID8gY2FsY1BhcmFtcy5wcmVjaXNpb24gOiBmYWxzZTtcblxuXHRcdGlmICh2YWx1ZXMubGVuZ3RoKSB7XG5cdFx0XHR2YWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXG5cdFx0XHRcdG91dHB1dCArPSAhaXNOYU4odmFsdWUpID8gTnVtYmVyKHZhbHVlKSA6IDA7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gcHJlY2lzaW9uICE9PSBmYWxzZSA/IG91dHB1dC50b0ZpeGVkKHByZWNpc2lvbikgOiBvdXRwdXQ7XG5cdH0sXG5cdFwiY29uY2F0XCI6IGZ1bmN0aW9uIGNvbmNhdCh2YWx1ZXMsIGRhdGEsIGNhbGNQYXJhbXMpIHtcblx0XHR2YXIgb3V0cHV0ID0gMDtcblxuXHRcdGlmICh2YWx1ZXMubGVuZ3RoKSB7XG5cdFx0XHRvdXRwdXQgPSB2YWx1ZXMucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHZhbHVlKSB7XG5cdFx0XHRcdHJldHVybiBTdHJpbmcoc3VtKSArIFN0cmluZyh2YWx1ZSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9LFxuXHRcImNvdW50XCI6IGZ1bmN0aW9uIGNvdW50KHZhbHVlcywgZGF0YSwgY2FsY1BhcmFtcykge1xuXHRcdHZhciBvdXRwdXQgPSAwO1xuXG5cdFx0aWYgKHZhbHVlcy5sZW5ndGgpIHtcblx0XHRcdHZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRvdXRwdXQrKztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG91dHB1dDtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImNvbHVtbkNhbGNzXCIsIENvbHVtbkNhbGNzKTtcblxudmFyIENsaXBib2FyZCA9IGZ1bmN0aW9uIENsaXBib2FyZCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7XG5cdHRoaXMubW9kZSA9IHRydWU7XG5cblx0dGhpcy5wYXN0ZVBhcnNlciA9IGZ1bmN0aW9uICgpIHt9O1xuXHR0aGlzLnBhc3RlQWN0aW9uID0gZnVuY3Rpb24gKCkge307XG5cdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gZmFsc2U7XG5cdHRoaXMucm93UmFuZ2UgPSBmYWxzZTtcblx0dGhpcy5ibG9ja2VkID0gdHJ1ZTsgLy9ibG9jayBjb3B5IGFjdGlvbnMgbm90IG9yaWdpbmF0aW5nIGZyb20gdGhpcyBjb21tYW5kXG59O1xuXG5DbGlwYm9hcmQucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczQ2ID0gdGhpcztcblxuXHR0aGlzLm1vZGUgPSB0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkO1xuXG5cdHRoaXMucm93UmFuZ2UgPSB0aGlzLnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weVJvd1JhbmdlO1xuXG5cdGlmICh0aGlzLm1vZGUgPT09IHRydWUgfHwgdGhpcy5tb2RlID09PSBcImNvcHlcIikge1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY29weVwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dmFyIHBsYWluLCBodG1sLCBsaXN0O1xuXG5cdFx0XHRpZiAoIV90aGlzNDYuYmxvY2tlZCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0aWYgKF90aGlzNDYuY3VzdG9tU2VsZWN0aW9uKSB7XG5cdFx0XHRcdFx0cGxhaW4gPSBfdGhpczQ2LmN1c3RvbVNlbGVjdGlvbjtcblxuXHRcdFx0XHRcdGlmIChfdGhpczQ2LnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUZvcm1hdHRlcikge1xuXHRcdFx0XHRcdFx0cGxhaW4gPSBfdGhpczQ2LnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weUZvcm1hdHRlcihcInBsYWluXCIsIHBsYWluKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHR2YXIgbGlzdCA9IF90aGlzNDYudGFibGUubW9kdWxlcy5leHBvcnQuZ2VuZXJhdGVFeHBvcnRMaXN0KF90aGlzNDYudGFibGUub3B0aW9ucy5jbGlwYm9hcmRDb3B5Q29uZmlnLCBfdGhpczQ2LnRhYmxlLm9wdGlvbnMuY2xpcGJvYXJkQ29weVN0eWxlZCwgX3RoaXM0Ni5yb3dSYW5nZSwgXCJjbGlwYm9hcmRcIik7XG5cblx0XHRcdFx0XHRodG1sID0gX3RoaXM0Ni50YWJsZS5tb2R1bGVzLmV4cG9ydC5nZW5lcmVhdGVIVE1MVGFibGUobGlzdCk7XG5cdFx0XHRcdFx0cGxhaW4gPSBodG1sID8gX3RoaXM0Ni5nZW5lcmF0ZVBsYWluQ29udGVudChsaXN0KSA6IFwiXCI7XG5cblx0XHRcdFx0XHRpZiAoX3RoaXM0Ni50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlGb3JtYXR0ZXIpIHtcblx0XHRcdFx0XHRcdHBsYWluID0gX3RoaXM0Ni50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlGb3JtYXR0ZXIoXCJwbGFpblwiLCBwbGFpbik7XG5cdFx0XHRcdFx0XHRodG1sID0gX3RoaXM0Ni50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlGb3JtYXR0ZXIoXCJodG1sXCIsIGh0bWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh3aW5kb3cuY2xpcGJvYXJkRGF0YSAmJiB3aW5kb3cuY2xpcGJvYXJkRGF0YS5zZXREYXRhKSB7XG5cdFx0XHRcdFx0d2luZG93LmNsaXBib2FyZERhdGEuc2V0RGF0YSgnVGV4dCcsIHBsYWluKTtcblx0XHRcdFx0fSBlbHNlIGlmIChlLmNsaXBib2FyZERhdGEgJiYgZS5jbGlwYm9hcmREYXRhLnNldERhdGEpIHtcblx0XHRcdFx0XHRlLmNsaXBib2FyZERhdGEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHBsYWluKTtcblx0XHRcdFx0XHRpZiAoaHRtbCkge1xuXHRcdFx0XHRcdFx0ZS5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvaHRtbCcsIGh0bWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIGlmIChlLm9yaWdpbmFsRXZlbnQgJiYgZS5vcmlnaW5hbEV2ZW50LmNsaXBib2FyZERhdGEuc2V0RGF0YSkge1xuXHRcdFx0XHRcdGUub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvcGxhaW4nLCBwbGFpbik7XG5cdFx0XHRcdFx0aWYgKGh0bWwpIHtcblx0XHRcdFx0XHRcdGUub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhLnNldERhdGEoJ3RleHQvaHRtbCcsIGh0bWwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdF90aGlzNDYudGFibGUub3B0aW9ucy5jbGlwYm9hcmRDb3BpZWQuY2FsbChfdGhpczQ2LnRhYmxlLCBwbGFpbiwgaHRtbCk7XG5cblx0XHRcdFx0X3RoaXM0Ni5yZXNldCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHRoaXMubW9kZSA9PT0gdHJ1ZSB8fCB0aGlzLm1vZGUgPT09IFwicGFzdGVcIikge1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicGFzdGVcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdF90aGlzNDYucGFzdGUoZSk7XG5cdFx0fSk7XG5cdH1cblxuXHR0aGlzLnNldFBhc3RlUGFyc2VyKHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRQYXN0ZVBhcnNlcik7XG5cdHRoaXMuc2V0UGFzdGVBY3Rpb24odGhpcy50YWJsZS5vcHRpb25zLmNsaXBib2FyZFBhc3RlQWN0aW9uKTtcbn07XG5cbkNsaXBib2FyZC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuYmxvY2tlZCA9IHRydWU7XG5cdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gZmFsc2U7XG59O1xuXG5DbGlwYm9hcmQucHJvdG90eXBlLmdlbmVyYXRlUGxhaW5Db250ZW50ID0gZnVuY3Rpb24gKGxpc3QpIHtcblx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdGxpc3QuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0dmFyIHJvd0RhdGEgPSBbXTtcblxuXHRcdHJvdy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXHRcdFx0dmFyIHZhbHVlID0gXCJcIjtcblxuXHRcdFx0aWYgKGNvbCkge1xuXG5cdFx0XHRcdGlmIChyb3cudHlwZSA9PT0gXCJncm91cFwiKSB7XG5cdFx0XHRcdFx0Y29sLnZhbHVlID0gY29sLmNvbXBvbmVudC5nZXRLZXkoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChjb2wudmFsdWUgPT09IG51bGwpIHtcblx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c3dpdGNoIChfdHlwZW9mKGNvbC52YWx1ZSkpIHtcblx0XHRcdFx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdFx0XHRcdFx0dmFsdWUgPSBKU09OLnN0cmluZ2lmeShjb2wudmFsdWUpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IGNvbC52YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cm93RGF0YS5wdXNoKHZhbHVlKTtcblx0XHR9KTtcblxuXHRcdG91dHB1dC5wdXNoKHJvd0RhdGEuam9pbihcIlxcdFwiKSk7XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQuam9pbihcIlxcblwiKTtcbn07XG5cbkNsaXBib2FyZC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uIChyYW5nZSwgaW50ZXJuYWwpIHtcblx0dmFyIHJhbmdlLCBzZWwsIHRleHRSYW5nZTtcblx0dGhpcy5ibG9ja2VkID0gZmFsc2U7XG5cdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gZmFsc2U7XG5cblx0aWYgKHRoaXMubW9kZSA9PT0gdHJ1ZSB8fCB0aGlzLm1vZGUgPT09IFwiY29weVwiKSB7XG5cblx0XHR0aGlzLnJvd1JhbmdlID0gcmFuZ2UgfHwgdGhpcy50YWJsZS5vcHRpb25zLmNsaXBib2FyZENvcHlSb3dSYW5nZTtcblxuXHRcdGlmICh0eXBlb2Ygd2luZG93LmdldFNlbGVjdGlvbiAhPSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiBkb2N1bWVudC5jcmVhdGVSYW5nZSAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKCk7XG5cdFx0XHRyYW5nZS5zZWxlY3ROb2RlQ29udGVudHModGhpcy50YWJsZS5lbGVtZW50KTtcblx0XHRcdHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblxuXHRcdFx0aWYgKHNlbC50b1N0cmluZygpICYmIGludGVybmFsKSB7XG5cdFx0XHRcdHRoaXMuY3VzdG9tU2VsZWN0aW9uID0gc2VsLnRvU3RyaW5nKCk7XG5cdFx0XHR9XG5cblx0XHRcdHNlbC5yZW1vdmVBbGxSYW5nZXMoKTtcblx0XHRcdHNlbC5hZGRSYW5nZShyYW5nZSk7XG5cdFx0fSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQuc2VsZWN0aW9uICE9IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHRleHRSYW5nZSA9IGRvY3VtZW50LmJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG5cdFx0XHR0ZXh0UmFuZ2UubW92ZVRvRWxlbWVudFRleHQodGhpcy50YWJsZS5lbGVtZW50KTtcblx0XHRcdHRleHRSYW5nZS5zZWxlY3QoKTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpO1xuXG5cdFx0aWYgKHNlbCkge1xuXHRcdFx0c2VsLnJlbW92ZUFsbFJhbmdlcygpO1xuXHRcdH1cblx0fVxufTtcblxuLy9QQVNURSBFVkVOVCBIQU5ETElOR1xuXG5DbGlwYm9hcmQucHJvdG90eXBlLnNldFBhc3RlQWN0aW9uID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXG5cdHN3aXRjaCAodHlwZW9mIGFjdGlvbiA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoYWN0aW9uKSkge1xuXHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdHRoaXMucGFzdGVBY3Rpb24gPSB0aGlzLnBhc3RlQWN0aW9uc1thY3Rpb25dO1xuXG5cdFx0XHRpZiAoIXRoaXMucGFzdGVBY3Rpb24pIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ2xpcGJvYXJkIEVycm9yIC0gTm8gc3VjaCBwYXN0ZSBhY3Rpb24gZm91bmQ6XCIsIGFjdGlvbik7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0dGhpcy5wYXN0ZUFjdGlvbiA9IGFjdGlvbjtcblx0XHRcdGJyZWFrO1xuXHR9XG59O1xuXG5DbGlwYm9hcmQucHJvdG90eXBlLnNldFBhc3RlUGFyc2VyID0gZnVuY3Rpb24gKHBhcnNlcikge1xuXHRzd2l0Y2ggKHR5cGVvZiBwYXJzZXIgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHBhcnNlcikpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHR0aGlzLnBhc3RlUGFyc2VyID0gdGhpcy5wYXN0ZVBhcnNlcnNbcGFyc2VyXTtcblxuXHRcdFx0aWYgKCF0aGlzLnBhc3RlUGFyc2VyKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkNsaXBib2FyZCBFcnJvciAtIE5vIHN1Y2ggcGFzdGUgcGFyc2VyIGZvdW5kOlwiLCBwYXJzZXIpO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdHRoaXMucGFzdGVQYXJzZXIgPSBwYXJzZXI7XG5cdFx0XHRicmVhaztcblx0fVxufTtcblxuQ2xpcGJvYXJkLnByb3RvdHlwZS5wYXN0ZSA9IGZ1bmN0aW9uIChlKSB7XG5cdHZhciBkYXRhLCByb3dEYXRhLCByb3dzO1xuXG5cdGlmICh0aGlzLmNoZWNrUGFzZU9yaWdpbihlKSkge1xuXG5cdFx0ZGF0YSA9IHRoaXMuZ2V0UGFzdGVEYXRhKGUpO1xuXG5cdFx0cm93RGF0YSA9IHRoaXMucGFzdGVQYXJzZXIuY2FsbCh0aGlzLCBkYXRhKTtcblxuXHRcdGlmIChyb3dEYXRhKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcIm11dGF0b3JcIikpIHtcblx0XHRcdFx0cm93RGF0YSA9IHRoaXMubXV0YXRlRGF0YShyb3dEYXRhKTtcblx0XHRcdH1cblxuXHRcdFx0cm93cyA9IHRoaXMucGFzdGVBY3Rpb24uY2FsbCh0aGlzLCByb3dEYXRhKTtcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5jbGlwYm9hcmRQYXN0ZWQuY2FsbCh0aGlzLnRhYmxlLCBkYXRhLCByb3dEYXRhLCByb3dzKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmNsaXBib2FyZFBhc3RlRXJyb3IuY2FsbCh0aGlzLnRhYmxlLCBkYXRhKTtcblx0XHR9XG5cdH1cbn07XG5cbkNsaXBib2FyZC5wcm90b3R5cGUubXV0YXRlRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIG91dHB1dCA9IFtdO1xuXG5cdGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XG5cdFx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdG91dHB1dC5wdXNoKHNlbGYudGFibGUubW9kdWxlcy5tdXRhdG9yLnRyYW5zZm9ybVJvdyhyb3csIFwiY2xpcGJvYXJkXCIpKTtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHRvdXRwdXQgPSBkYXRhO1xuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkNsaXBib2FyZC5wcm90b3R5cGUuY2hlY2tQYXNlT3JpZ2luID0gZnVuY3Rpb24gKGUpIHtcblx0dmFyIHZhbGlkID0gdHJ1ZTtcblxuXHRpZiAoZS50YXJnZXQudGFnTmFtZSAhPSBcIkRJVlwiIHx8IHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsKSB7XG5cdFx0dmFsaWQgPSBmYWxzZTtcblx0fVxuXG5cdHJldHVybiB2YWxpZDtcbn07XG5cbkNsaXBib2FyZC5wcm90b3R5cGUuZ2V0UGFzdGVEYXRhID0gZnVuY3Rpb24gKGUpIHtcblx0dmFyIGRhdGE7XG5cblx0aWYgKHdpbmRvdy5jbGlwYm9hcmREYXRhICYmIHdpbmRvdy5jbGlwYm9hcmREYXRhLmdldERhdGEpIHtcblx0XHRkYXRhID0gd2luZG93LmNsaXBib2FyZERhdGEuZ2V0RGF0YSgnVGV4dCcpO1xuXHR9IGVsc2UgaWYgKGUuY2xpcGJvYXJkRGF0YSAmJiBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSkge1xuXHRcdGRhdGEgPSBlLmNsaXBib2FyZERhdGEuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuXHR9IGVsc2UgaWYgKGUub3JpZ2luYWxFdmVudCAmJiBlLm9yaWdpbmFsRXZlbnQuY2xpcGJvYXJkRGF0YS5nZXREYXRhKSB7XG5cdFx0ZGF0YSA9IGUub3JpZ2luYWxFdmVudC5jbGlwYm9hcmREYXRhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcblx0fVxuXG5cdHJldHVybiBkYXRhO1xufTtcblxuQ2xpcGJvYXJkLnByb3RvdHlwZS5wYXN0ZVBhcnNlcnMgPSB7XG5cdHRhYmxlOiBmdW5jdGlvbiB0YWJsZShjbGlwYm9hcmQpIHtcblx0XHR2YXIgZGF0YSA9IFtdLFxuXHRcdCAgICBzdWNjZXNzID0gZmFsc2UsXG5cdFx0ICAgIGhlYWRlckZpbmRTdWNjZXNzID0gdHJ1ZSxcblx0XHQgICAgY29sdW1ucyA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zLFxuXHRcdCAgICBjb2x1bW5NYXAgPSBbXSxcblx0XHQgICAgcm93cyA9IFtdO1xuXG5cdFx0Ly9nZXQgZGF0YSBmcm9tIGNsaXBib2FyZCBpbnRvIGFycmF5IG9mIGNvbHVtbnMgYW5kIHJvd3MuXG5cdFx0Y2xpcGJvYXJkID0gY2xpcGJvYXJkLnNwbGl0KFwiXFxuXCIpO1xuXG5cdFx0Y2xpcGJvYXJkLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0ZGF0YS5wdXNoKHJvdy5zcGxpdChcIlxcdFwiKSk7XG5cdFx0fSk7XG5cblx0XHRpZiAoZGF0YS5sZW5ndGggJiYgIShkYXRhLmxlbmd0aCA9PT0gMSAmJiBkYXRhWzBdLmxlbmd0aCA8IDIpKSB7XG5cdFx0XHRzdWNjZXNzID0gdHJ1ZTtcblxuXHRcdFx0Ly9jaGVjayBpZiBoZWFkZXJzIGFyZSBwcmVzZW50IGJ5IHRpdGxlXG5cdFx0XHRkYXRhWzBdLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdHZhciBjb2x1bW4gPSBjb2x1bW5zLmZpbmQoZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZSAmJiBjb2x1bW4uZGVmaW5pdGlvbi50aXRsZSAmJiB2YWx1ZS50cmltKCkgJiYgY29sdW1uLmRlZmluaXRpb24udGl0bGUudHJpbSgpID09PSB2YWx1ZS50cmltKCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdFx0XHRjb2x1bW5NYXAucHVzaChjb2x1bW4pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGhlYWRlckZpbmRTdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvL2NoZWNrIGlmIGNvbHVtbiBoZWFkZXJzIGFyZSBwcmVzZW50IGJ5IGZpZWxkXG5cdFx0XHRpZiAoIWhlYWRlckZpbmRTdWNjZXNzKSB7XG5cdFx0XHRcdGhlYWRlckZpbmRTdWNjZXNzID0gdHJ1ZTtcblx0XHRcdFx0Y29sdW1uTWFwID0gW107XG5cblx0XHRcdFx0ZGF0YVswXS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdFx0XHRcdHZhciBjb2x1bW4gPSBjb2x1bW5zLmZpbmQoZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlICYmIGNvbHVtbi5maWVsZCAmJiB2YWx1ZS50cmltKCkgJiYgY29sdW1uLmZpZWxkLnRyaW0oKSA9PT0gdmFsdWUudHJpbSgpO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0XHRcdFx0Y29sdW1uTWFwLnB1c2goY29sdW1uKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aGVhZGVyRmluZFN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmICghaGVhZGVyRmluZFN1Y2Nlc3MpIHtcblx0XHRcdFx0XHRjb2x1bW5NYXAgPSB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0Ly9yZW1vdmUgaGVhZGVyIHJvdyBpZiBmb3VuZFxuXHRcdFx0aWYgKGhlYWRlckZpbmRTdWNjZXNzKSB7XG5cdFx0XHRcdGRhdGEuc2hpZnQoKTtcblx0XHRcdH1cblxuXHRcdFx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdHZhciByb3cgPSB7fTtcblxuXHRcdFx0XHRpdGVtLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpKSB7XG5cdFx0XHRcdFx0aWYgKGNvbHVtbk1hcFtpXSkge1xuXHRcdFx0XHRcdFx0cm93W2NvbHVtbk1hcFtpXS5maWVsZF0gPSB2YWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdHJvd3MucHVzaChyb3cpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHJldHVybiByb3dzO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG59O1xuXG5DbGlwYm9hcmQucHJvdG90eXBlLnBhc3RlQWN0aW9ucyA9IHtcblx0cmVwbGFjZTogZnVuY3Rpb24gcmVwbGFjZShyb3dzKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUuc2V0RGF0YShyb3dzKTtcblx0fSxcblx0dXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUocm93cykge1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLnVwZGF0ZU9yQWRkRGF0YShyb3dzKTtcblx0fSxcblx0aW5zZXJ0OiBmdW5jdGlvbiBpbnNlcnQocm93cykge1xuXHRcdHJldHVybiB0aGlzLnRhYmxlLmFkZERhdGEocm93cyk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJjbGlwYm9hcmRcIiwgQ2xpcGJvYXJkKTtcblxudmFyIERhdGFUcmVlID0gZnVuY3Rpb24gRGF0YVRyZWUodGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlO1xuXHR0aGlzLmluZGVudCA9IDEwO1xuXHR0aGlzLmZpZWxkID0gXCJcIjtcblx0dGhpcy5jb2xsYXBzZUVsID0gbnVsbDtcblx0dGhpcy5leHBhbmRFbCA9IG51bGw7XG5cdHRoaXMuYnJhbmNoRWwgPSBudWxsO1xuXHR0aGlzLmVsZW1lbnRGaWVsZCA9IGZhbHNlO1xuXG5cdHRoaXMuc3RhcnRPcGVuID0gZnVuY3Rpb24gKCkge307XG5cblx0dGhpcy5kaXNwbGF5SW5kZXggPSAwO1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBkdW1teUVsID0gbnVsbCxcblx0ICAgIGZpcnN0Q29sID0gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldEZpcnN0VmlzaWJpbGVDb2x1bW4oKSxcblx0ICAgIG9wdGlvbnMgPSB0aGlzLnRhYmxlLm9wdGlvbnM7XG5cblx0dGhpcy5maWVsZCA9IG9wdGlvbnMuZGF0YVRyZWVDaGlsZEZpZWxkO1xuXHR0aGlzLmluZGVudCA9IG9wdGlvbnMuZGF0YVRyZWVDaGlsZEluZGVudDtcblx0dGhpcy5lbGVtZW50RmllbGQgPSBvcHRpb25zLmRhdGFUcmVlRWxlbWVudENvbHVtbiB8fCAoZmlyc3RDb2wgPyBmaXJzdENvbC5maWVsZCA6IGZhbHNlKTtcblxuXHRpZiAob3B0aW9ucy5kYXRhVHJlZUJyYW5jaEVsZW1lbnQpIHtcblxuXHRcdGlmIChvcHRpb25zLmRhdGFUcmVlQnJhbmNoRWxlbWVudCA9PT0gdHJ1ZSkge1xuXHRcdFx0dGhpcy5icmFuY2hFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHR0aGlzLmJyYW5jaEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZGF0YS10cmVlLWJyYW5jaFwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHR5cGVvZiBvcHRpb25zLmRhdGFUcmVlQnJhbmNoRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0XHRkdW1teUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0ZHVtbXlFbC5pbm5lckhUTUwgPSBvcHRpb25zLmRhdGFUcmVlQnJhbmNoRWxlbWVudDtcblx0XHRcdFx0dGhpcy5icmFuY2hFbCA9IGR1bW15RWwuZmlyc3RDaGlsZDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuYnJhbmNoRWwgPSBvcHRpb25zLmRhdGFUcmVlQnJhbmNoRWxlbWVudDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAob3B0aW9ucy5kYXRhVHJlZUNvbGxhcHNlRWxlbWVudCkge1xuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucy5kYXRhVHJlZUNvbGxhcHNlRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0ZHVtbXlFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRkdW1teUVsLmlubmVySFRNTCA9IG9wdGlvbnMuZGF0YVRyZWVDb2xsYXBzZUVsZW1lbnQ7XG5cdFx0XHR0aGlzLmNvbGxhcHNlRWwgPSBkdW1teUVsLmZpcnN0Q2hpbGQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29sbGFwc2VFbCA9IG9wdGlvbnMuZGF0YVRyZWVDb2xsYXBzZUVsZW1lbnQ7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMuY29sbGFwc2VFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGhpcy5jb2xsYXBzZUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZGF0YS10cmVlLWNvbnRyb2xcIik7XG5cdFx0dGhpcy5jb2xsYXBzZUVsLnRhYkluZGV4ID0gMDtcblx0XHR0aGlzLmNvbGxhcHNlRWwuaW5uZXJIVE1MID0gXCI8ZGl2IGNsYXNzPSd0YWJ1bGF0b3ItZGF0YS10cmVlLWNvbnRyb2wtY29sbGFwc2UnPjwvZGl2PlwiO1xuXHR9XG5cblx0aWYgKG9wdGlvbnMuZGF0YVRyZWVFeHBhbmRFbGVtZW50KSB7XG5cdFx0aWYgKHR5cGVvZiBvcHRpb25zLmRhdGFUcmVlRXhwYW5kRWxlbWVudCA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0ZHVtbXlFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRkdW1teUVsLmlubmVySFRNTCA9IG9wdGlvbnMuZGF0YVRyZWVFeHBhbmRFbGVtZW50O1xuXHRcdFx0dGhpcy5leHBhbmRFbCA9IGR1bW15RWwuZmlyc3RDaGlsZDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5leHBhbmRFbCA9IG9wdGlvbnMuZGF0YVRyZWVFeHBhbmRFbGVtZW50O1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHR0aGlzLmV4cGFuZEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLmV4cGFuZEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZGF0YS10cmVlLWNvbnRyb2xcIik7XG5cdFx0dGhpcy5leHBhbmRFbC50YWJJbmRleCA9IDA7XG5cdFx0dGhpcy5leHBhbmRFbC5pbm5lckhUTUwgPSBcIjxkaXYgY2xhc3M9J3RhYnVsYXRvci1kYXRhLXRyZWUtY29udHJvbC1leHBhbmQnPjwvZGl2PlwiO1xuXHR9XG5cblx0c3dpdGNoIChfdHlwZW9mKG9wdGlvbnMuZGF0YVRyZWVTdGFydEV4cGFuZGVkKSkge1xuXHRcdGNhc2UgXCJib29sZWFuXCI6XG5cdFx0XHR0aGlzLnN0YXJ0T3BlbiA9IGZ1bmN0aW9uIChyb3csIGluZGV4KSB7XG5cdFx0XHRcdHJldHVybiBvcHRpb25zLmRhdGFUcmVlU3RhcnRFeHBhbmRlZDtcblx0XHRcdH07XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0dGhpcy5zdGFydE9wZW4gPSBvcHRpb25zLmRhdGFUcmVlU3RhcnRFeHBhbmRlZDtcblx0XHRcdGJyZWFrO1xuXG5cdFx0ZGVmYXVsdDpcblx0XHRcdHRoaXMuc3RhcnRPcGVuID0gZnVuY3Rpb24gKHJvdywgaW5kZXgpIHtcblx0XHRcdFx0cmV0dXJuIG9wdGlvbnMuZGF0YVRyZWVTdGFydEV4cGFuZGVkW2luZGV4XTtcblx0XHRcdH07XG5cdFx0XHRicmVhaztcblx0fVxufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBjaGlsZEFycmF5ID0gcm93LmdldERhdGEoKVt0aGlzLmZpZWxkXTtcblx0dmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5KGNoaWxkQXJyYXkpO1xuXG5cdHZhciBjaGlsZHJlbiA9IGlzQXJyYXkgfHwgIWlzQXJyYXkgJiYgKHR5cGVvZiBjaGlsZEFycmF5ID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihjaGlsZEFycmF5KSkgPT09IFwib2JqZWN0XCIgJiYgY2hpbGRBcnJheSAhPT0gbnVsbDtcblxuXHRpZiAoIWNoaWxkcmVuICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmJyYW5jaEVsKSB7XG5cdFx0cm93Lm1vZHVsZXMuZGF0YVRyZWUuYnJhbmNoRWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbCk7XG5cdH1cblxuXHRpZiAoIWNoaWxkcmVuICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlICYmIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCkge1xuXHRcdHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCk7XG5cdH1cblxuXHRyb3cubW9kdWxlcy5kYXRhVHJlZSA9IHtcblx0XHRpbmRleDogcm93Lm1vZHVsZXMuZGF0YVRyZWUgPyByb3cubW9kdWxlcy5kYXRhVHJlZS5pbmRleCA6IDAsXG5cdFx0b3BlbjogY2hpbGRyZW4gPyByb3cubW9kdWxlcy5kYXRhVHJlZSA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLm9wZW4gOiB0aGlzLnN0YXJ0T3Blbihyb3cuZ2V0Q29tcG9uZW50KCksIDApIDogZmFsc2UsXG5cdFx0Y29udHJvbEVsOiByb3cubW9kdWxlcy5kYXRhVHJlZSAmJiBjaGlsZHJlbiA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCA6IGZhbHNlLFxuXHRcdGJyYW5jaEVsOiByb3cubW9kdWxlcy5kYXRhVHJlZSAmJiBjaGlsZHJlbiA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLmJyYW5jaEVsIDogZmFsc2UsXG5cdFx0cGFyZW50OiByb3cubW9kdWxlcy5kYXRhVHJlZSA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudCA6IGZhbHNlLFxuXHRcdGNoaWxkcmVuOiBjaGlsZHJlblxuXHR9O1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmxheW91dFJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGNlbGwgPSB0aGlzLmVsZW1lbnRGaWVsZCA/IHJvdy5nZXRDZWxsKHRoaXMuZWxlbWVudEZpZWxkKSA6IHJvdy5nZXRDZWxscygpWzBdLFxuXHQgICAgZWwgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0ICAgIGNvbmZpZyA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlO1xuXG5cdGlmIChjb25maWcuYnJhbmNoRWwpIHtcblx0XHRpZiAoY29uZmlnLmJyYW5jaEVsLnBhcmVudE5vZGUpIHtcblx0XHRcdGNvbmZpZy5icmFuY2hFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNvbmZpZy5icmFuY2hFbCk7XG5cdFx0fVxuXHRcdGNvbmZpZy5icmFuY2hFbCA9IGZhbHNlO1xuXHR9XG5cblx0aWYgKGNvbmZpZy5jb250cm9sRWwpIHtcblx0XHRpZiAoY29uZmlnLmNvbnRyb2xFbC5wYXJlbnROb2RlKSB7XG5cdFx0XHRjb25maWcuY29udHJvbEVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY29uZmlnLmNvbnRyb2xFbCk7XG5cdFx0fVxuXHRcdGNvbmZpZy5jb250cm9sRWwgPSBmYWxzZTtcblx0fVxuXG5cdHRoaXMuZ2VuZXJhdGVDb250cm9sRWxlbWVudChyb3csIGVsKTtcblxuXHRyb3cuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdHJlZS1sZXZlbC1cIiArIGNvbmZpZy5pbmRleCk7XG5cblx0aWYgKGNvbmZpZy5pbmRleCkge1xuXHRcdGlmICh0aGlzLmJyYW5jaEVsKSB7XG5cdFx0XHRjb25maWcuYnJhbmNoRWwgPSB0aGlzLmJyYW5jaEVsLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdGVsLmluc2VydEJlZm9yZShjb25maWcuYnJhbmNoRWwsIGVsLmZpcnN0Q2hpbGQpO1xuXG5cdFx0XHRpZiAodGhpcy50YWJsZS5ydGwpIHtcblx0XHRcdFx0Y29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpblJpZ2h0ID0gKGNvbmZpZy5icmFuY2hFbC5vZmZzZXRXaWR0aCArIGNvbmZpZy5icmFuY2hFbC5zdHlsZS5tYXJnaW5MZWZ0KSAqIChjb25maWcuaW5kZXggLSAxKSArIGNvbmZpZy5pbmRleCAqIHRoaXMuaW5kZW50ICsgXCJweFwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpbkxlZnQgPSAoY29uZmlnLmJyYW5jaEVsLm9mZnNldFdpZHRoICsgY29uZmlnLmJyYW5jaEVsLnN0eWxlLm1hcmdpblJpZ2h0KSAqIChjb25maWcuaW5kZXggLSAxKSArIGNvbmZpZy5pbmRleCAqIHRoaXMuaW5kZW50ICsgXCJweFwiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmICh0aGlzLnRhYmxlLnJ0bCkge1xuXHRcdFx0XHRlbC5zdHlsZS5wYWRkaW5nUmlnaHQgPSBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1yaWdodCcpKSArIGNvbmZpZy5pbmRleCAqIHRoaXMuaW5kZW50ICsgXCJweFwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWwuc3R5bGUucGFkZGluZ0xlZnQgPSBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbCwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1sZWZ0JykpICsgY29uZmlnLmluZGV4ICogdGhpcy5pbmRlbnQgKyBcInB4XCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuZ2VuZXJhdGVDb250cm9sRWxlbWVudCA9IGZ1bmN0aW9uIChyb3csIGVsKSB7XG5cdHZhciBfdGhpczQ3ID0gdGhpcztcblxuXHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUsXG5cdCAgICBlbCA9IGVsIHx8IHJvdy5nZXRDZWxscygpWzBdLmdldEVsZW1lbnQoKSxcblx0ICAgIG9sZENvbnRyb2wgPSBjb25maWcuY29udHJvbEVsO1xuXG5cdGlmIChjb25maWcuY2hpbGRyZW4gIT09IGZhbHNlKSB7XG5cblx0XHRpZiAoY29uZmlnLm9wZW4pIHtcblx0XHRcdGNvbmZpZy5jb250cm9sRWwgPSB0aGlzLmNvbGxhcHNlRWwuY2xvbmVOb2RlKHRydWUpO1xuXHRcdFx0Y29uZmlnLmNvbnRyb2xFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0X3RoaXM0Ny5jb2xsYXBzZVJvdyhyb3cpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbmZpZy5jb250cm9sRWwgPSB0aGlzLmV4cGFuZEVsLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdGNvbmZpZy5jb250cm9sRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdF90aGlzNDcuZXhwYW5kUm93KHJvdyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRjb25maWcuY29udHJvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cblx0XHRpZiAob2xkQ29udHJvbCAmJiBvbGRDb250cm9sLnBhcmVudE5vZGUgPT09IGVsKSB7XG5cdFx0XHRvbGRDb250cm9sLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKGNvbmZpZy5jb250cm9sRWwsIG9sZENvbnRyb2wpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRlbC5pbnNlcnRCZWZvcmUoY29uZmlnLmNvbnRyb2xFbCwgZWwuZmlyc3RDaGlsZCk7XG5cdFx0fVxuXHR9XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuc2V0RGlzcGxheUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdHRoaXMuZGlzcGxheUluZGV4ID0gaW5kZXg7XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuZ2V0RGlzcGxheUluZGV4ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5kaXNwbGF5SW5kZXg7XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHZhciBfdGhpczQ4ID0gdGhpcztcblxuXHR2YXIgb3V0cHV0ID0gW107XG5cblx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3csIGkpIHtcblx0XHR2YXIgY29uZmlnLCBjaGlsZHJlbjtcblxuXHRcdG91dHB1dC5wdXNoKHJvdyk7XG5cblx0XHRpZiAocm93IGluc3RhbmNlb2YgUm93KSB7XG5cblx0XHRcdHJvdy5jcmVhdGUoKTtcblxuXHRcdFx0Y29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUuY2hpbGRyZW47XG5cblx0XHRcdGlmICghY29uZmlnLmluZGV4ICYmIGNvbmZpZy5jaGlsZHJlbiAhPT0gZmFsc2UpIHtcblx0XHRcdFx0Y2hpbGRyZW4gPSBfdGhpczQ4LmdldENoaWxkcmVuKHJvdyk7XG5cblx0XHRcdFx0Y2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcblx0XHRcdFx0XHRjaGlsZC5jcmVhdGUoKTtcblx0XHRcdFx0XHRvdXRwdXQucHVzaChjaGlsZCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkRhdGFUcmVlLnByb3RvdHlwZS5nZXRDaGlsZHJlbiA9IGZ1bmN0aW9uIChyb3csIGFsbENoaWxkcmVuKSB7XG5cdHZhciBfdGhpczQ5ID0gdGhpcztcblxuXHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUsXG5cdCAgICBjaGlsZHJlbiA9IFtdLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0aWYgKGNvbmZpZy5jaGlsZHJlbiAhPT0gZmFsc2UgJiYgKGNvbmZpZy5vcGVuIHx8IGFsbENoaWxkcmVuKSkge1xuXHRcdGlmICghQXJyYXkuaXNBcnJheShjb25maWcuY2hpbGRyZW4pKSB7XG5cdFx0XHRjb25maWcuY2hpbGRyZW4gPSB0aGlzLmdlbmVyYXRlQ2hpbGRyZW4ocm93KTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmaWx0ZXJcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlRmlsdGVyKSB7XG5cdFx0XHRjaGlsZHJlbiA9IHRoaXMudGFibGUubW9kdWxlcy5maWx0ZXIuZmlsdGVyKGNvbmZpZy5jaGlsZHJlbik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoaWxkcmVuID0gY29uZmlnLmNoaWxkcmVuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInNvcnRcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlU29ydCkge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLnNvcnQuc29ydChjaGlsZHJlbik7XG5cdFx0fVxuXG5cdFx0Y2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcblx0XHRcdG91dHB1dC5wdXNoKGNoaWxkKTtcblxuXHRcdFx0dmFyIHN1YkNoaWxkcmVuID0gX3RoaXM0OS5nZXRDaGlsZHJlbihjaGlsZCk7XG5cblx0XHRcdHN1YkNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHN1Yikge1xuXHRcdFx0XHRvdXRwdXQucHVzaChzdWIpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmdlbmVyYXRlQ2hpbGRyZW4gPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBfdGhpczUwID0gdGhpcztcblxuXHR2YXIgY2hpbGRyZW4gPSBbXTtcblxuXHR2YXIgY2hpbGRBcnJheSA9IHJvdy5nZXREYXRhKClbdGhpcy5maWVsZF07XG5cblx0aWYgKCFBcnJheS5pc0FycmF5KGNoaWxkQXJyYXkpKSB7XG5cdFx0Y2hpbGRBcnJheSA9IFtjaGlsZEFycmF5XTtcblx0fVxuXG5cdGNoaWxkQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGREYXRhKSB7XG5cdFx0dmFyIGNoaWxkUm93ID0gbmV3IFJvdyhjaGlsZERhdGEgfHwge30sIF90aGlzNTAudGFibGUucm93TWFuYWdlcik7XG5cblx0XHRjaGlsZFJvdy5jcmVhdGUoKTtcblxuXHRcdGNoaWxkUm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXggPSByb3cubW9kdWxlcy5kYXRhVHJlZS5pbmRleCArIDE7XG5cdFx0Y2hpbGRSb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQgPSByb3c7XG5cblx0XHRpZiAoY2hpbGRSb3cubW9kdWxlcy5kYXRhVHJlZS5jaGlsZHJlbikge1xuXHRcdFx0Y2hpbGRSb3cubW9kdWxlcy5kYXRhVHJlZS5vcGVuID0gX3RoaXM1MC5zdGFydE9wZW4oY2hpbGRSb3cuZ2V0Q29tcG9uZW50KCksIGNoaWxkUm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXgpO1xuXHRcdH1cblx0XHRjaGlsZHJlbi5wdXNoKGNoaWxkUm93KTtcblx0fSk7XG5cblx0cmV0dXJuIGNoaWxkcmVuO1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmV4cGFuZFJvdyA9IGZ1bmN0aW9uIChyb3csIHNpbGVudCkge1xuXHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWU7XG5cblx0aWYgKGNvbmZpZy5jaGlsZHJlbiAhPT0gZmFsc2UpIHtcblx0XHRjb25maWcub3BlbiA9IHRydWU7XG5cblx0XHRyb3cucmVpbml0aWFsaXplKCk7XG5cblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJ0cmVlXCIsIGZhbHNlLCB0cnVlKTtcblxuXHRcdHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZVJvd0V4cGFuZGVkKHJvdy5nZXRDb21wb25lbnQoKSwgcm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXgpO1xuXHR9XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuY29sbGFwc2VSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBjb25maWcgPSByb3cubW9kdWxlcy5kYXRhVHJlZTtcblxuXHRpZiAoY29uZmlnLmNoaWxkcmVuICE9PSBmYWxzZSkge1xuXHRcdGNvbmZpZy5vcGVuID0gZmFsc2U7XG5cblx0XHRyb3cucmVpbml0aWFsaXplKCk7XG5cblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJ0cmVlXCIsIGZhbHNlLCB0cnVlKTtcblxuXHRcdHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZVJvd0NvbGxhcHNlZChyb3cuZ2V0Q29tcG9uZW50KCksIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmluZGV4KTtcblx0fVxufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLnRvZ2dsZVJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGNvbmZpZyA9IHJvdy5tb2R1bGVzLmRhdGFUcmVlO1xuXG5cdGlmIChjb25maWcuY2hpbGRyZW4gIT09IGZhbHNlKSB7XG5cdFx0aWYgKGNvbmZpZy5vcGVuKSB7XG5cdFx0XHR0aGlzLmNvbGxhcHNlUm93KHJvdyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZXhwYW5kUm93KHJvdyk7XG5cdFx0fVxuXHR9XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuZ2V0VHJlZVBhcmVudCA9IGZ1bmN0aW9uIChyb3cpIHtcblx0cmV0dXJuIHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudCA/IHJvdy5tb2R1bGVzLmRhdGFUcmVlLnBhcmVudC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmdldEZpbHRlcmVkVHJlZUNoaWxkcmVuID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUsXG5cdCAgICBvdXRwdXQgPSBbXSxcblx0ICAgIGNoaWxkcmVuO1xuXG5cdGlmIChjb25maWcuY2hpbGRyZW4pIHtcblxuXHRcdGlmICghQXJyYXkuaXNBcnJheShjb25maWcuY2hpbGRyZW4pKSB7XG5cdFx0XHRjb25maWcuY2hpbGRyZW4gPSB0aGlzLmdlbmVyYXRlQ2hpbGRyZW4ocm93KTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJmaWx0ZXJcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlRmlsdGVyKSB7XG5cdFx0XHRjaGlsZHJlbiA9IHRoaXMudGFibGUubW9kdWxlcy5maWx0ZXIuZmlsdGVyKGNvbmZpZy5jaGlsZHJlbik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoaWxkcmVuID0gY29uZmlnLmNoaWxkcmVuO1xuXHRcdH1cblxuXHRcdGNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkUm93KSB7XG5cdFx0XHRpZiAoY2hpbGRSb3cgaW5zdGFuY2VvZiBSb3cpIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goY2hpbGRSb3cpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkRhdGFUcmVlLnByb3RvdHlwZS5yb3dEZWxldGUgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBwYXJlbnQgPSByb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQsXG5cdCAgICBjaGlsZEluZGV4O1xuXG5cdGlmIChwYXJlbnQpIHtcblx0XHRjaGlsZEluZGV4ID0gdGhpcy5maW5kQ2hpbGRJbmRleChyb3csIHBhcmVudCk7XG5cblx0XHRpZiAoY2hpbGRJbmRleCAhPT0gZmFsc2UpIHtcblx0XHRcdHBhcmVudC5kYXRhW3RoaXMuZmllbGRdLnNwbGljZShjaGlsZEluZGV4LCAxKTtcblx0XHR9XG5cblx0XHRpZiAoIXBhcmVudC5kYXRhW3RoaXMuZmllbGRdLmxlbmd0aCkge1xuXHRcdFx0ZGVsZXRlIHBhcmVudC5kYXRhW3RoaXMuZmllbGRdO1xuXHRcdH1cblxuXHRcdHRoaXMuaW5pdGlhbGl6ZVJvdyhwYXJlbnQpO1xuXHRcdHRoaXMubGF5b3V0Um93KHBhcmVudCk7XG5cdH1cblxuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJ0cmVlXCIsIGZhbHNlLCB0cnVlKTtcbn07XG5cbkRhdGFUcmVlLnByb3RvdHlwZS5hZGRUcmVlQ2hpbGRSb3cgPSBmdW5jdGlvbiAocm93LCBkYXRhLCB0b3AsIGluZGV4KSB7XG5cdHZhciBjaGlsZEluZGV4ID0gZmFsc2U7XG5cblx0aWYgKHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiKSB7XG5cdFx0ZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG5cdH1cblxuXHRpZiAoIUFycmF5LmlzQXJyYXkocm93LmRhdGFbdGhpcy5maWVsZF0pKSB7XG5cdFx0cm93LmRhdGFbdGhpcy5maWVsZF0gPSBbXTtcblxuXHRcdHJvdy5tb2R1bGVzLmRhdGFUcmVlLm9wZW4gPSB0aGlzLnN0YXJ0T3Blbihyb3cuZ2V0Q29tcG9uZW50KCksIHJvdy5tb2R1bGVzLmRhdGFUcmVlLmluZGV4KTtcblx0fVxuXG5cdGlmICh0eXBlb2YgaW5kZXggIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRjaGlsZEluZGV4ID0gdGhpcy5maW5kQ2hpbGRJbmRleChpbmRleCwgcm93KTtcblxuXHRcdGlmIChjaGlsZEluZGV4ICE9PSBmYWxzZSkge1xuXHRcdFx0cm93LmRhdGFbdGhpcy5maWVsZF0uc3BsaWNlKHRvcCA/IGNoaWxkSW5kZXggOiBjaGlsZEluZGV4ICsgMSwgMCwgZGF0YSk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKGNoaWxkSW5kZXggPT09IGZhbHNlKSB7XG5cdFx0aWYgKHRvcCkge1xuXHRcdFx0cm93LmRhdGFbdGhpcy5maWVsZF0udW5zaGlmdChkYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cm93LmRhdGFbdGhpcy5maWVsZF0ucHVzaChkYXRhKTtcblx0XHR9XG5cdH1cblxuXHR0aGlzLmluaXRpYWxpemVSb3cocm93KTtcblx0dGhpcy5sYXlvdXRSb3cocm93KTtcblxuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJ0cmVlXCIsIGZhbHNlLCB0cnVlKTtcbn07XG5cbkRhdGFUcmVlLnByb3RvdHlwZS5maW5kQ2hpbGRJbmRleCA9IGZ1bmN0aW9uIChzdWJqZWN0LCBwYXJlbnQpIHtcblx0dmFyIF90aGlzNTEgPSB0aGlzO1xuXG5cdHZhciBtYXRjaCA9IGZhbHNlO1xuXG5cdGlmICgodHlwZW9mIHN1YmplY3QgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHN1YmplY3QpKSA9PSBcIm9iamVjdFwiKSB7XG5cblx0XHRpZiAoc3ViamVjdCBpbnN0YW5jZW9mIFJvdykge1xuXHRcdFx0Ly9zdWJqZWN0IGlzIHJvdyBlbGVtZW50XG5cdFx0XHRtYXRjaCA9IHN1YmplY3QuZGF0YTtcblx0XHR9IGVsc2UgaWYgKHN1YmplY3QgaW5zdGFuY2VvZiBSb3dDb21wb25lbnQpIHtcblx0XHRcdC8vc3ViamVjdCBpcyBwdWJsaWMgcm93IGNvbXBvbmVudFxuXHRcdFx0bWF0Y2ggPSBzdWJqZWN0Ll9nZXRTZWxmKCkuZGF0YTtcblx0XHR9IGVsc2UgaWYgKHR5cGVvZiBIVE1MRWxlbWVudCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBzdWJqZWN0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcblx0XHRcdGlmIChwYXJlbnQubW9kdWxlcy5kYXRhVHJlZSkge1xuXHRcdFx0XHRtYXRjaCA9IHBhcmVudC5tb2R1bGVzLmRhdGFUcmVlLmNoaWxkcmVuLmZpbmQoZnVuY3Rpb24gKGNoaWxkUm93KSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNoaWxkUm93IGluc3RhbmNlb2YgUm93ID8gY2hpbGRSb3cuZWxlbWVudCA9PT0gc3ViamVjdCA6IGZhbHNlO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0XHRtYXRjaCA9IG1hdGNoLmRhdGE7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSBpZiAodHlwZW9mIHN1YmplY3QgPT0gXCJ1bmRlZmluZWRcIiB8fCBzdWJqZWN0ID09PSBudWxsKSB7XG5cdFx0bWF0Y2ggPSBmYWxzZTtcblx0fSBlbHNlIHtcblx0XHQvL3N1YmplY3Qgc2hvdWxkIGJlIHRyZWF0ZWQgYXMgdGhlIGluZGV4IG9mIHRoZSByb3dcblx0XHRtYXRjaCA9IHBhcmVudC5kYXRhW3RoaXMuZmllbGRdLmZpbmQoZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0cmV0dXJuIHJvdy5kYXRhW190aGlzNTEudGFibGUub3B0aW9ucy5pbmRleF0gPT0gc3ViamVjdDtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChtYXRjaCkge1xuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkocGFyZW50LmRhdGFbdGhpcy5maWVsZF0pKSB7XG5cdFx0XHRtYXRjaCA9IHBhcmVudC5kYXRhW3RoaXMuZmllbGRdLmluZGV4T2YobWF0Y2gpO1xuXHRcdH1cblxuXHRcdGlmIChtYXRjaCA9PSAtMSkge1xuXHRcdFx0bWF0Y2ggPSBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHQvL2NhdGNoIGFsbCBmb3IgYW55IG90aGVyIHR5cGUgb2YgaW5wdXRcblxuXHRyZXR1cm4gbWF0Y2g7XG59O1xuXG5EYXRhVHJlZS5wcm90b3R5cGUuZ2V0VHJlZUNoaWxkcmVuID0gZnVuY3Rpb24gKHJvdywgY29tcG9uZW50LCByZWN1cnNlKSB7XG5cdHZhciBfdGhpczUyID0gdGhpcztcblxuXHR2YXIgY29uZmlnID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUsXG5cdCAgICBvdXRwdXQgPSBbXTtcblxuXHRpZiAoY29uZmlnLmNoaWxkcmVuKSB7XG5cblx0XHRpZiAoIUFycmF5LmlzQXJyYXkoY29uZmlnLmNoaWxkcmVuKSkge1xuXHRcdFx0Y29uZmlnLmNoaWxkcmVuID0gdGhpcy5nZW5lcmF0ZUNoaWxkcmVuKHJvdyk7XG5cdFx0fVxuXG5cdFx0Y29uZmlnLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkUm93KSB7XG5cdFx0XHRpZiAoY2hpbGRSb3cgaW5zdGFuY2VvZiBSb3cpIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goY29tcG9uZW50ID8gY2hpbGRSb3cuZ2V0Q29tcG9uZW50KCkgOiBjaGlsZFJvdyk7XG5cblx0XHRcdFx0aWYgKHJlY3Vyc2UpIHtcblx0XHRcdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KF90aGlzNTIuZ2V0VHJlZUNoaWxkcmVuKGNoaWxkUm93LCBjb21wb25lbnQsIHJlY3Vyc2UpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkRhdGFUcmVlLnByb3RvdHlwZS5jaGVja0ZvclJlc3R5bGUgPSBmdW5jdGlvbiAoY2VsbCkge1xuXHRpZiAoIWNlbGwucm93LmNlbGxzLmluZGV4T2YoY2VsbCkpIHtcblx0XHRjZWxsLnJvdy5yZWluaXRpYWxpemUoKTtcblx0fVxufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLmdldENoaWxkRmllbGQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmZpZWxkO1xufTtcblxuRGF0YVRyZWUucHJvdG90eXBlLnJlZHJhd05lZWRlZCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHJldHVybiAodGhpcy5maWVsZCA/IHR5cGVvZiBkYXRhW3RoaXMuZmllbGRdICE9PSBcInVuZGVmaW5lZFwiIDogZmFsc2UpIHx8ICh0aGlzLmVsZW1lbnRGaWVsZCA/IHR5cGVvZiBkYXRhW3RoaXMuZWxlbWVudEZpZWxkXSAhPT0gXCJ1bmRlZmluZWRcIiA6IGZhbHNlKTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJkYXRhVHJlZVwiLCBEYXRhVHJlZSk7XG5cbnZhciBEb3dubG9hZCA9IGZ1bmN0aW9uIERvd25sb2FkKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcbn07XG5cbi8vdHJpZ2dlciBmaWxlIGRvd25sb2FkXG5Eb3dubG9hZC5wcm90b3R5cGUuZG93bmxvYWQgPSBmdW5jdGlvbiAodHlwZSwgZmlsZW5hbWUsIG9wdGlvbnMsIHJhbmdlLCBpbnRlcmNlcHRDYWxsYmFjaykge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBkb3dubG9hZEZ1bmMgPSBmYWxzZTtcblxuXHRmdW5jdGlvbiBidWlsZExpbmsoZGF0YSwgbWltZSkge1xuXHRcdGlmIChpbnRlcmNlcHRDYWxsYmFjaykge1xuXHRcdFx0aWYgKGludGVyY2VwdENhbGxiYWNrID09PSB0cnVlKSB7XG5cdFx0XHRcdHNlbGYudHJpZ2dlckRvd25sb2FkKGRhdGEsIG1pbWUsIHR5cGUsIGZpbGVuYW1lLCB0cnVlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGludGVyY2VwdENhbGxiYWNrKGRhdGEpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRzZWxmLnRyaWdnZXJEb3dubG9hZChkYXRhLCBtaW1lLCB0eXBlLCBmaWxlbmFtZSk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKHR5cGVvZiB0eXBlID09IFwiZnVuY3Rpb25cIikge1xuXHRcdGRvd25sb2FkRnVuYyA9IHR5cGU7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKHNlbGYuZG93bmxvYWRlcnNbdHlwZV0pIHtcblx0XHRcdGRvd25sb2FkRnVuYyA9IHNlbGYuZG93bmxvYWRlcnNbdHlwZV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkRvd25sb2FkIEVycm9yIC0gTm8gc3VjaCBkb3dubG9hZCB0eXBlIGZvdW5kOiBcIiwgdHlwZSk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKGRvd25sb2FkRnVuYykge1xuXHRcdHZhciBsaXN0ID0gdGhpcy5nZW5lcmF0ZUV4cG9ydExpc3QocmFuZ2UpO1xuXG5cdFx0ZG93bmxvYWRGdW5jLmNhbGwodGhpcy50YWJsZSwgbGlzdCwgb3B0aW9ucyB8fCB7fSwgYnVpbGRMaW5rKTtcblx0fVxufTtcblxuRG93bmxvYWQucHJvdG90eXBlLmdlbmVyYXRlRXhwb3J0TGlzdCA9IGZ1bmN0aW9uIChyYW5nZSkge1xuXHR2YXIgbGlzdCA9IHRoaXMudGFibGUubW9kdWxlcy5leHBvcnQuZ2VuZXJhdGVFeHBvcnRMaXN0KHRoaXMudGFibGUub3B0aW9ucy5kb3dubG9hZENvbmZpZywgZmFsc2UsIHJhbmdlIHx8IHRoaXMudGFibGUub3B0aW9ucy5kb3dubG9hZFJvd1JhbmdlLCBcImRvd25sb2FkXCIpO1xuXG5cdC8vYXNzaWduIGdyb3VwIGhlYWRlciBmb3JtYXR0ZXJcblx0dmFyIGdyb3VwSGVhZGVyID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwSGVhZGVyRG93bmxvYWQ7XG5cblx0aWYgKGdyb3VwSGVhZGVyICYmICFBcnJheS5pc0FycmF5KGdyb3VwSGVhZGVyKSkge1xuXHRcdGdyb3VwSGVhZGVyID0gW2dyb3VwSGVhZGVyXTtcblx0fVxuXG5cdGxpc3QuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0dmFyIGdyb3VwO1xuXG5cdFx0aWYgKHJvdy50eXBlID09PSBcImdyb3VwXCIpIHtcblx0XHRcdGdyb3VwID0gcm93LmNvbHVtbnNbMF07XG5cblx0XHRcdGlmIChncm91cEhlYWRlciAmJiBncm91cEhlYWRlcltyb3cuaW5kZW50XSkge1xuXHRcdFx0XHRncm91cC52YWx1ZSA9IGdyb3VwSGVhZGVyW3Jvdy5pbmRlbnRdKGdyb3VwLnZhbHVlLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXRSb3dDb3VudCgpLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXREYXRhKCksIHJvdy5jb21wb25lbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGxpc3Q7XG59O1xuXG5Eb3dubG9hZC5wcm90b3R5cGUudHJpZ2dlckRvd25sb2FkID0gZnVuY3Rpb24gKGRhdGEsIG1pbWUsIHR5cGUsIGZpbGVuYW1lLCBuZXdUYWIpIHtcblx0dmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyksXG5cdCAgICBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7IHR5cGU6IG1pbWUgfSksXG5cdCAgICBmaWxlbmFtZSA9IGZpbGVuYW1lIHx8IFwiVGFidWxhdG9yLlwiICsgKHR5cGVvZiB0eXBlID09PSBcImZ1bmN0aW9uXCIgPyBcInR4dFwiIDogdHlwZSk7XG5cblx0YmxvYiA9IHRoaXMudGFibGUub3B0aW9ucy5kb3dubG9hZFJlYWR5LmNhbGwodGhpcy50YWJsZSwgZGF0YSwgYmxvYik7XG5cblx0aWYgKGJsb2IpIHtcblxuXHRcdGlmIChuZXdUYWIpIHtcblx0XHRcdHdpbmRvdy5vcGVuKHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKSB7XG5cdFx0XHRcdG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iKGJsb2IsIGZpbGVuYW1lKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYikpO1xuXG5cdFx0XHRcdC8vc2V0IGZpbGUgdGl0bGVcblx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgZmlsZW5hbWUpO1xuXG5cdFx0XHRcdC8vdHJpZ2dlciBkb3dubG9hZFxuXHRcdFx0XHRlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cdFx0XHRcdGVsZW1lbnQuY2xpY2soKTtcblxuXHRcdFx0XHQvL3JlbW92ZSB0ZW1wb3JhcnkgbGluayBlbGVtZW50XG5cdFx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5kb3dubG9hZENvbXBsZXRlKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuZG93bmxvYWRDb21wbGV0ZSgpO1xuXHRcdH1cblx0fVxufTtcblxuRG93bmxvYWQucHJvdG90eXBlLmNvbW1zUmVjZWl2ZWQgPSBmdW5jdGlvbiAodGFibGUsIGFjdGlvbiwgZGF0YSkge1xuXHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdGNhc2UgXCJpbnRlcmNlcHRcIjpcblx0XHRcdHRoaXMuZG93bmxvYWQoZGF0YS50eXBlLCBcIlwiLCBkYXRhLm9wdGlvbnMsIGRhdGEuYWN0aXZlLCBkYXRhLmludGVyY2VwdCk7XG5cdFx0XHRicmVhaztcblx0fVxufTtcblxuLy9kb3dubG9hZGVyc1xuRG93bmxvYWQucHJvdG90eXBlLmRvd25sb2FkZXJzID0ge1xuXHRjc3Y6IGZ1bmN0aW9uIGNzdihsaXN0LCBvcHRpb25zLCBzZXRGaWxlQ29udGVudHMpIHtcblx0XHR2YXIgZGVsaW1pdGVyID0gb3B0aW9ucyAmJiBvcHRpb25zLmRlbGltaXRlciA/IG9wdGlvbnMuZGVsaW1pdGVyIDogXCIsXCIsXG5cdFx0ICAgIGZpbGVDb250ZW50cyA9IFtdLFxuXHRcdCAgICBoZWFkZXJzID0gW107XG5cblx0XHRsaXN0LmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0dmFyIGl0ZW0gPSBbXTtcblxuXHRcdFx0c3dpdGNoIChyb3cudHlwZSkge1xuXHRcdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJEb3dubG9hZCBXYXJuaW5nIC0gQ1NWIGRvd25sb2FkZXIgY2Fubm90IHByb2Nlc3Mgcm93IGdyb3Vwc1wiKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwiY2FsY1wiOlxuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkRvd25sb2FkIFdhcm5pbmcgLSBDU1YgZG93bmxvYWRlciBjYW5ub3QgcHJvY2VzcyBjb2x1bW4gY2FsY3VsYXRpb25zXCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJoZWFkZXJcIjpcblx0XHRcdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wsIGkpIHtcblx0XHRcdFx0XHRcdGlmIChjb2wgJiYgY29sLmRlcHRoID09PSAxKSB7XG5cdFx0XHRcdFx0XHRcdGhlYWRlcnNbaV0gPSB0eXBlb2YgY29sLnZhbHVlID09IFwidW5kZWZpbmVkXCIgfHwgY29sLnZhbHVlID09PSBudWxsID8gXCJcIiA6ICdcIicgKyBTdHJpbmcoY29sLnZhbHVlKS5zcGxpdCgnXCInKS5qb2luKCdcIlwiJykgKyAnXCInO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJyb3dcIjpcblx0XHRcdFx0XHRyb3cuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wpIHtcblxuXHRcdFx0XHRcdFx0aWYgKGNvbCkge1xuXG5cdFx0XHRcdFx0XHRcdHN3aXRjaCAoX3R5cGVvZihjb2wudmFsdWUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0XHRcdFx0XHRcdFx0Y29sLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoY29sLnZhbHVlKTtcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgXCJudWxsXCI6XG5cdFx0XHRcdFx0XHRcdFx0XHRjb2wudmFsdWUgPSBcIlwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRpdGVtLnB1c2goJ1wiJyArIFN0cmluZyhjb2wudmFsdWUpLnNwbGl0KCdcIicpLmpvaW4oJ1wiXCInKSArICdcIicpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0ZmlsZUNvbnRlbnRzLnB1c2goaXRlbS5qb2luKGRlbGltaXRlcikpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGhlYWRlcnMubGVuZ3RoKSB7XG5cdFx0XHRmaWxlQ29udGVudHMudW5zaGlmdChoZWFkZXJzLmpvaW4oZGVsaW1pdGVyKSk7XG5cdFx0fVxuXG5cdFx0ZmlsZUNvbnRlbnRzID0gZmlsZUNvbnRlbnRzLmpvaW4oXCJcXG5cIik7XG5cblx0XHRpZiAob3B0aW9ucy5ib20pIHtcblx0XHRcdGZpbGVDb250ZW50cyA9ICdcXHVGRUZGJyArIGZpbGVDb250ZW50cztcblx0XHR9XG5cblx0XHRzZXRGaWxlQ29udGVudHMoZmlsZUNvbnRlbnRzLCBcInRleHQvY3N2XCIpO1xuXHR9LFxuXG5cdGpzb246IGZ1bmN0aW9uIGpzb24obGlzdCwgb3B0aW9ucywgc2V0RmlsZUNvbnRlbnRzKSB7XG5cdFx0dmFyIGZpbGVDb250ZW50cyA9IFtdO1xuXG5cdFx0bGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdHZhciBpdGVtID0ge307XG5cblx0XHRcdHN3aXRjaCAocm93LnR5cGUpIHtcblx0XHRcdFx0Y2FzZSBcImhlYWRlclwiOlxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkRvd25sb2FkIFdhcm5pbmcgLSBKU09OIGRvd25sb2FkZXIgY2Fubm90IHByb2Nlc3Mgcm93IGdyb3Vwc1wiKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwiY2FsY1wiOlxuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkRvd25sb2FkIFdhcm5pbmcgLSBKU09OIGRvd25sb2FkZXIgY2Fubm90IHByb2Nlc3MgY29sdW1uIGNhbGN1bGF0aW9uc1wiKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwicm93XCI6XG5cdFx0XHRcdFx0cm93LmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7XG5cdFx0XHRcdFx0XHRpZiAoY29sKSB7XG5cdFx0XHRcdFx0XHRcdGl0ZW1bY29sLmNvbXBvbmVudC5nZXRGaWVsZCgpXSA9IGNvbC52YWx1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGZpbGVDb250ZW50cy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZmlsZUNvbnRlbnRzID0gSlNPTi5zdHJpbmdpZnkoZmlsZUNvbnRlbnRzLCBudWxsLCAnXFx0Jyk7XG5cblx0XHRzZXRGaWxlQ29udGVudHMoZmlsZUNvbnRlbnRzLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG5cdH0sXG5cblx0cGRmOiBmdW5jdGlvbiBwZGYobGlzdCwgb3B0aW9ucywgc2V0RmlsZUNvbnRlbnRzKSB7XG5cdFx0dmFyIGhlYWRlciA9IFtdLFxuXHRcdCAgICBib2R5ID0gW10sXG5cdFx0ICAgIGF1dG9UYWJsZVBhcmFtcyA9IHt9LFxuXHRcdCAgICByb3dHcm91cFN0eWxlcyA9IG9wdGlvbnMucm93R3JvdXBTdHlsZXMgfHwge1xuXHRcdFx0Zm9udFN0eWxlOiBcImJvbGRcIixcblx0XHRcdGZvbnRTaXplOiAxMixcblx0XHRcdGNlbGxQYWRkaW5nOiA2LFxuXHRcdFx0ZmlsbENvbG9yOiAyMjBcblx0XHR9LFxuXHRcdCAgICByb3dDYWxjU3R5bGVzID0gb3B0aW9ucy5yb3dDYWxjU3R5bGVzIHx8IHtcblx0XHRcdGZvbnRTdHlsZTogXCJib2xkXCIsXG5cdFx0XHRmb250U2l6ZTogMTAsXG5cdFx0XHRjZWxsUGFkZGluZzogNCxcblx0XHRcdGZpbGxDb2xvcjogMjMyXG5cdFx0fSxcblx0XHQgICAganNQREZQYXJhbXMgPSBvcHRpb25zLmpzUERGIHx8IHt9LFxuXHRcdCAgICB0aXRsZSA9IG9wdGlvbnMgJiYgb3B0aW9ucy50aXRsZSA/IG9wdGlvbnMudGl0bGUgOiBcIlwiO1xuXG5cdFx0aWYgKCFqc1BERlBhcmFtcy5vcmllbnRhdGlvbikge1xuXHRcdFx0anNQREZQYXJhbXMub3JpZW50YXRpb24gPSBvcHRpb25zLm9yaWVudGF0aW9uIHx8IFwibGFuZHNjYXBlXCI7XG5cdFx0fVxuXG5cdFx0aWYgKCFqc1BERlBhcmFtcy51bml0KSB7XG5cdFx0XHRqc1BERlBhcmFtcy51bml0ID0gXCJwdFwiO1xuXHRcdH1cblxuXHRcdC8vcGFyc2Ugcm93IGxpc3Rcblx0XHRsaXN0LmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0dmFyIGl0ZW0gPSB7fTtcblxuXHRcdFx0c3dpdGNoIChyb3cudHlwZSkge1xuXHRcdFx0XHRjYXNlIFwiaGVhZGVyXCI6XG5cdFx0XHRcdFx0aGVhZGVyLnB1c2gocGFyc2VSb3cocm93KSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSBcImdyb3VwXCI6XG5cdFx0XHRcdFx0Ym9keS5wdXNoKHBhcnNlUm93KHJvdywgcm93R3JvdXBTdHlsZXMpKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwiY2FsY1wiOlxuXHRcdFx0XHRcdGJvZHkucHVzaChwYXJzZVJvdyhyb3csIHJvd0NhbGNTdHlsZXMpKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwicm93XCI6XG5cdFx0XHRcdFx0Ym9keS5wdXNoKHBhcnNlUm93KHJvdykpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZnVuY3Rpb24gcGFyc2VSb3cocm93LCBzdHlsZXMpIHtcblx0XHRcdHZhciByb3dEYXRhID0gW107XG5cblx0XHRcdHJvdy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXHRcdFx0XHR2YXIgY2VsbDtcblxuXHRcdFx0XHRpZiAoY29sKSB7XG5cdFx0XHRcdFx0c3dpdGNoIChfdHlwZW9mKGNvbC52YWx1ZSkpIHtcblx0XHRcdFx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdFx0XHRcdFx0Y29sLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkoY29sLnZhbHVlKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0XHRcdGNhc2UgXCJudWxsXCI6XG5cdFx0XHRcdFx0XHRcdGNvbC52YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGNlbGwgPSB7XG5cdFx0XHRcdFx0XHRjb250ZW50OiBjb2wudmFsdWUsXG5cdFx0XHRcdFx0XHRjb2xTcGFuOiBjb2wud2lkdGgsXG5cdFx0XHRcdFx0XHRyb3dTcGFuOiBjb2wuaGVpZ2h0XG5cdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdGlmIChzdHlsZXMpIHtcblx0XHRcdFx0XHRcdGNlbGwuc3R5bGVzID0gc3R5bGVzO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJvd0RhdGEucHVzaChjZWxsKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyb3dEYXRhLnB1c2goXCJcIik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRyZXR1cm4gcm93RGF0YTtcblx0XHR9XG5cblx0XHQvL2NvbmZpZ3VyZSBQREZcblx0XHR2YXIgZG9jID0gbmV3IGpzUERGKGpzUERGUGFyYW1zKTsgLy9zZXQgZG9jdW1lbnQgdG8gbGFuZHNjYXBlLCBiZXR0ZXIgZm9yIG1vc3QgdGFibGVzXG5cblx0XHRpZiAob3B0aW9ucyAmJiBvcHRpb25zLmF1dG9UYWJsZSkge1xuXHRcdFx0aWYgKHR5cGVvZiBvcHRpb25zLmF1dG9UYWJsZSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdGF1dG9UYWJsZVBhcmFtcyA9IG9wdGlvbnMuYXV0b1RhYmxlKGRvYykgfHwge307XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhdXRvVGFibGVQYXJhbXMgPSBvcHRpb25zLmF1dG9UYWJsZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodGl0bGUpIHtcblx0XHRcdGF1dG9UYWJsZVBhcmFtcy5hZGRQYWdlQ29udGVudCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdGRvYy50ZXh0KHRpdGxlLCA0MCwgMzApO1xuXHRcdFx0fTtcblx0XHR9XG5cblx0XHRhdXRvVGFibGVQYXJhbXMuaGVhZCA9IGhlYWRlcjtcblx0XHRhdXRvVGFibGVQYXJhbXMuYm9keSA9IGJvZHk7XG5cblx0XHRkb2MuYXV0b1RhYmxlKGF1dG9UYWJsZVBhcmFtcyk7XG5cblx0XHRpZiAob3B0aW9ucyAmJiBvcHRpb25zLmRvY3VtZW50UHJvY2Vzc2luZykge1xuXHRcdFx0b3B0aW9ucy5kb2N1bWVudFByb2Nlc3NpbmcoZG9jKTtcblx0XHR9XG5cblx0XHRzZXRGaWxlQ29udGVudHMoZG9jLm91dHB1dChcImFycmF5YnVmZmVyXCIpLCBcImFwcGxpY2F0aW9uL3BkZlwiKTtcblx0fSxcblxuXHR4bHN4OiBmdW5jdGlvbiB4bHN4KGxpc3QsIG9wdGlvbnMsIHNldEZpbGVDb250ZW50cykge1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHQgICAgc2hlZXROYW1lID0gb3B0aW9ucy5zaGVldE5hbWUgfHwgXCJTaGVldDFcIixcblx0XHQgICAgd29ya2Jvb2sgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCksXG5cdFx0ICAgIG91dHB1dDtcblxuXHRcdHdvcmtib29rLlNoZWV0TmFtZXMgPSBbXTtcblx0XHR3b3JrYm9vay5TaGVldHMgPSB7fTtcblxuXHRcdGZ1bmN0aW9uIGdlbmVyYXRlU2hlZXQoKSB7XG5cdFx0XHR2YXIgcm93cyA9IFtdLFxuXHRcdFx0ICAgIG1lcmdlcyA9IFtdLFxuXHRcdFx0ICAgIHdvcmtzaGVldCA9IHt9LFxuXHRcdFx0ICAgIHJhbmdlID0geyBzOiB7IGM6IDAsIHI6IDAgfSwgZTogeyBjOiBsaXN0WzBdID8gbGlzdFswXS5jb2x1bW5zLnJlZHVjZShmdW5jdGlvbiAoYSwgYikge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGEgKyAoYiAmJiBiLndpZHRoID8gYi53aWR0aCA6IDEpO1xuXHRcdFx0XHRcdH0sIDApIDogMCwgcjogbGlzdC5sZW5ndGggfSB9O1xuXG5cdFx0XHQvL3BhcnNlIHJvdyBsaXN0XG5cdFx0XHRsaXN0LmZvckVhY2goZnVuY3Rpb24gKHJvdywgaSkge1xuXHRcdFx0XHR2YXIgcm93RGF0YSA9IFtdO1xuXG5cdFx0XHRcdHJvdy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCwgaikge1xuXG5cdFx0XHRcdFx0aWYgKGNvbCkge1xuXHRcdFx0XHRcdFx0cm93RGF0YS5wdXNoKCEoY29sLnZhbHVlIGluc3RhbmNlb2YgRGF0ZSkgJiYgX3R5cGVvZihjb2wudmFsdWUpID09PSBcIm9iamVjdFwiID8gSlNPTi5zdHJpbmdpZnkoY29sLnZhbHVlKSA6IGNvbC52YWx1ZSk7XG5cblx0XHRcdFx0XHRcdGlmIChjb2wud2lkdGggPiAxIHx8IGNvbC5oZWlnaHQgPiAtMSkge1xuXHRcdFx0XHRcdFx0XHRtZXJnZXMucHVzaCh7IHM6IHsgcjogaSwgYzogaiB9LCBlOiB7IHI6IGkgKyBjb2wuaGVpZ2h0IC0gMSwgYzogaiArIGNvbC53aWR0aCAtIDEgfSB9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cm93RGF0YS5wdXNoKFwiXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0cm93cy5wdXNoKHJvd0RhdGEpO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vY29udmVydCByb3dzIHRvIHdvcmtzaGVldFxuXHRcdFx0WExTWC51dGlscy5zaGVldF9hZGRfYW9hKHdvcmtzaGVldCwgcm93cyk7XG5cblx0XHRcdHdvcmtzaGVldFsnIXJlZiddID0gWExTWC51dGlscy5lbmNvZGVfcmFuZ2UocmFuZ2UpO1xuXG5cdFx0XHRpZiAobWVyZ2VzLmxlbmd0aCkge1xuXHRcdFx0XHR3b3Jrc2hlZXRbXCIhbWVyZ2VzXCJdID0gbWVyZ2VzO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gd29ya3NoZWV0O1xuXHRcdH1cblxuXHRcdGlmIChvcHRpb25zLnNoZWV0T25seSkge1xuXHRcdFx0c2V0RmlsZUNvbnRlbnRzKGdlbmVyYXRlU2hlZXQoKSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMuc2hlZXRzKSB7XG5cdFx0XHRmb3IgKHZhciBzaGVldCBpbiBvcHRpb25zLnNoZWV0cykge1xuXG5cdFx0XHRcdGlmIChvcHRpb25zLnNoZWV0c1tzaGVldF0gPT09IHRydWUpIHtcblx0XHRcdFx0XHR3b3JrYm9vay5TaGVldE5hbWVzLnB1c2goc2hlZXQpO1xuXHRcdFx0XHRcdHdvcmtib29rLlNoZWV0c1tzaGVldF0gPSBnZW5lcmF0ZVNoZWV0KCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHR3b3JrYm9vay5TaGVldE5hbWVzLnB1c2goc2hlZXQpO1xuXG5cdFx0XHRcdFx0dGhpcy5tb2R1bGVzLmNvbW1zLnNlbmQob3B0aW9ucy5zaGVldHNbc2hlZXRdLCBcImRvd25sb2FkXCIsIFwiaW50ZXJjZXB0XCIsIHtcblx0XHRcdFx0XHRcdHR5cGU6IFwieGxzeFwiLFxuXHRcdFx0XHRcdFx0b3B0aW9uczogeyBzaGVldE9ubHk6IHRydWUgfSxcblx0XHRcdFx0XHRcdGFjdGl2ZTogc2VsZi5hY3RpdmUsXG5cdFx0XHRcdFx0XHRpbnRlcmNlcHQ6IGZ1bmN0aW9uIGludGVyY2VwdChkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdHdvcmtib29rLlNoZWV0c1tzaGVldF0gPSBkYXRhO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHdvcmtib29rLlNoZWV0TmFtZXMucHVzaChzaGVldE5hbWUpO1xuXHRcdFx0d29ya2Jvb2suU2hlZXRzW3NoZWV0TmFtZV0gPSBnZW5lcmF0ZVNoZWV0KCk7XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMuZG9jdW1lbnRQcm9jZXNzaW5nKSB7XG5cdFx0XHR3b3JrYm9vayA9IG9wdGlvbnMuZG9jdW1lbnRQcm9jZXNzaW5nKHdvcmtib29rKTtcblx0XHR9XG5cblx0XHQvL2NvbnZlcnQgd29ya2Jvb2sgdG8gYmluYXJ5IGFycmF5XG5cdFx0ZnVuY3Rpb24gczJhYihzKSB7XG5cdFx0XHR2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKHMubGVuZ3RoKTtcblx0XHRcdHZhciB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkoYnVmKTtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpICE9IHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdFx0dmlld1tpXSA9IHMuY2hhckNvZGVBdChpKSAmIDB4RkY7XG5cdFx0XHR9cmV0dXJuIGJ1Zjtcblx0XHR9XG5cblx0XHRvdXRwdXQgPSBYTFNYLndyaXRlKHdvcmtib29rLCB7IGJvb2tUeXBlOiAneGxzeCcsIGJvb2tTU1Q6IHRydWUsIHR5cGU6ICdiaW5hcnknIH0pO1xuXG5cdFx0c2V0RmlsZUNvbnRlbnRzKHMyYWIob3V0cHV0KSwgXCJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW1cIik7XG5cdH0sXG5cblx0aHRtbDogZnVuY3Rpb24gaHRtbChsaXN0LCBvcHRpb25zLCBzZXRGaWxlQ29udGVudHMpIHtcblx0XHRpZiAodGhpcy5tb2RFeGlzdHMoXCJleHBvcnRcIiwgdHJ1ZSkpIHtcblx0XHRcdHNldEZpbGVDb250ZW50cyh0aGlzLm1vZHVsZXMuZXhwb3J0LmdlbmVyZWF0ZUhUTUxUYWJsZShsaXN0KSwgXCJ0ZXh0L2h0bWxcIik7XG5cdFx0fVxuXHR9XG5cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJkb3dubG9hZFwiLCBEb3dubG9hZCk7XG5cbnZhciBFZGl0ID0gZnVuY3Rpb24gRWRpdCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuY3VycmVudENlbGwgPSBmYWxzZTsgLy9ob2xkIGN1cnJlbnRseSBlZGl0aW5nIGNlbGxcblx0dGhpcy5tb3VzZUNsaWNrID0gZmFsc2U7IC8vaG9sZCBtb3VzZWRvd24gc3RhdGUgdG8gcHJldmVudCBjbGljayBiaW5kaW5nIGJlaW5nIG92ZXJyaWRlbiBieSBlZGl0b3Igb3BlbmluZ1xuXHR0aGlzLnJlY3Vyc2lvbkJsb2NrID0gZmFsc2U7IC8vcHJldmVudCBmb2N1cyByZWN1cnNpb25cblx0dGhpcy5pbnZhbGlkRWRpdCA9IGZhbHNlO1xuXHR0aGlzLmVkaXRlZENlbGxzID0gW107XG59O1xuXG4vL2luaXRpYWxpemUgY29sdW1uIGVkaXRvclxuRWRpdC5wcm90b3R5cGUuaW5pdGlhbGl6ZUNvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29uZmlnID0ge1xuXHRcdGVkaXRvcjogZmFsc2UsXG5cdFx0YmxvY2tlZDogZmFsc2UsXG5cdFx0Y2hlY2s6IGNvbHVtbi5kZWZpbml0aW9uLmVkaXRhYmxlLFxuXHRcdHBhcmFtczogY29sdW1uLmRlZmluaXRpb24uZWRpdG9yUGFyYW1zIHx8IHt9XG5cdH07XG5cblx0Ly9zZXQgY29sdW1uIGVkaXRvclxuXHRzd2l0Y2ggKF90eXBlb2YoY29sdW1uLmRlZmluaXRpb24uZWRpdG9yKSkge1xuXHRcdGNhc2UgXCJzdHJpbmdcIjpcblxuXHRcdFx0aWYgKGNvbHVtbi5kZWZpbml0aW9uLmVkaXRvciA9PT0gXCJ0aWNrXCIpIHtcblx0XHRcdFx0Y29sdW1uLmRlZmluaXRpb24uZWRpdG9yID0gXCJ0aWNrQ3Jvc3NcIjtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiREVQUkVDQVRJT04gV0FSTklORyAtIHRoZSB0aWNrIGVkaXRvciBoYXMgYmVlbiBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIHRoZSB0aWNrQ3Jvc3MgZWRpdG9yXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2VsZi5lZGl0b3JzW2NvbHVtbi5kZWZpbml0aW9uLmVkaXRvcl0pIHtcblx0XHRcdFx0Y29uZmlnLmVkaXRvciA9IHNlbGYuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3JdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiRWRpdG9yIEVycm9yIC0gTm8gc3VjaCBlZGl0b3IgZm91bmQ6IFwiLCBjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IpO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdGNvbmZpZy5lZGl0b3IgPSBjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3I7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJib29sZWFuXCI6XG5cblx0XHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IgPT09IHRydWUpIHtcblxuXHRcdFx0XHRpZiAodHlwZW9mIGNvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlciAhPT0gXCJmdW5jdGlvblwiKSB7XG5cblx0XHRcdFx0XHRpZiAoY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyID09PSBcInRpY2tcIikge1xuXHRcdFx0XHRcdFx0Y29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyID0gXCJ0aWNrQ3Jvc3NcIjtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkRFUFJFQ0FUSU9OIFdBUk5JTkcgLSB0aGUgdGljayBlZGl0b3IgaGFzIGJlZW4gZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSB0aGUgdGlja0Nyb3NzIGVkaXRvclwiKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoc2VsZi5lZGl0b3JzW2NvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlcl0pIHtcblx0XHRcdFx0XHRcdGNvbmZpZy5lZGl0b3IgPSBzZWxmLmVkaXRvcnNbY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uZmlnLmVkaXRvciA9IHNlbGYuZWRpdG9yc1tcImlucHV0XCJdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJFZGl0b3IgRXJyb3IgLSBDYW5ub3QgYXV0byBsb29rdXAgZWRpdG9yIGZvciBhIGN1c3RvbSBmb3JtYXR0ZXI6IFwiLCBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0fVxuXG5cdGlmIChjb25maWcuZWRpdG9yKSB7XG5cdFx0Y29sdW1uLm1vZHVsZXMuZWRpdCA9IGNvbmZpZztcblx0fVxufTtcblxuRWRpdC5wcm90b3R5cGUuZ2V0Q3VycmVudENlbGwgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmN1cnJlbnRDZWxsID8gdGhpcy5jdXJyZW50Q2VsbC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xufTtcblxuRWRpdC5wcm90b3R5cGUuY2xlYXJFZGl0b3IgPSBmdW5jdGlvbiAoY2FuY2VsKSB7XG5cdHZhciBjZWxsID0gdGhpcy5jdXJyZW50Q2VsbCxcblx0ICAgIGNlbGxFbDtcblxuXHR0aGlzLmludmFsaWRFZGl0ID0gZmFsc2U7XG5cblx0aWYgKGNlbGwpIHtcblx0XHR0aGlzLmN1cnJlbnRDZWxsID0gZmFsc2U7XG5cblx0XHRjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQoKTtcblxuXHRcdGlmIChjYW5jZWwpIHtcblx0XHRcdGNlbGwudmFsaWRhdGUoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y2VsbEVsLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItdmFsaWRhdGlvbi1mYWlsXCIpO1xuXHRcdH1cblxuXHRcdGNlbGxFbC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWVkaXRpbmdcIik7XG5cdFx0d2hpbGUgKGNlbGxFbC5maXJzdENoaWxkKSB7XG5cdFx0XHRjZWxsRWwucmVtb3ZlQ2hpbGQoY2VsbEVsLmZpcnN0Q2hpbGQpO1xuXHRcdH1jZWxsLnJvdy5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1yb3ctZWRpdGluZ1wiKTtcblx0fVxufTtcblxuRWRpdC5wcm90b3R5cGUuY2FuY2VsRWRpdCA9IGZ1bmN0aW9uICgpIHtcblxuXHRpZiAodGhpcy5jdXJyZW50Q2VsbCkge1xuXHRcdHZhciBjZWxsID0gdGhpcy5jdXJyZW50Q2VsbDtcblx0XHR2YXIgY29tcG9uZW50ID0gdGhpcy5jdXJyZW50Q2VsbC5nZXRDb21wb25lbnQoKTtcblxuXHRcdHRoaXMuY2xlYXJFZGl0b3IodHJ1ZSk7XG5cdFx0Y2VsbC5zZXRWYWx1ZUFjdHVhbChjZWxsLmdldFZhbHVlKCkpO1xuXHRcdGNlbGwuY2VsbFJlbmRlcmVkKCk7XG5cblx0XHRpZiAoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IgPT0gXCJ0ZXh0YXJlYVwiIHx8IGNlbGwuY29sdW1uLmRlZmluaXRpb24udmFyaWFibGVIZWlnaHQpIHtcblx0XHRcdGNlbGwucm93Lm5vcm1hbGl6ZUhlaWdodCh0cnVlKTtcblx0XHR9XG5cblx0XHRpZiAoY2VsbC5jb2x1bW4uY2VsbEV2ZW50cy5jZWxsRWRpdENhbmNlbGxlZCkge1xuXHRcdFx0Y2VsbC5jb2x1bW4uY2VsbEV2ZW50cy5jZWxsRWRpdENhbmNlbGxlZC5jYWxsKHRoaXMudGFibGUsIGNvbXBvbmVudCk7XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLmNlbGxFZGl0Q2FuY2VsbGVkLmNhbGwodGhpcy50YWJsZSwgY29tcG9uZW50KTtcblx0fVxufTtcblxuLy9yZXR1cm4gYSBmb3JtYXR0ZWQgdmFsdWUgZm9yIGEgY2VsbFxuRWRpdC5wcm90b3R5cGUuYmluZEVkaXRvciA9IGZ1bmN0aW9uIChjZWxsKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQodHJ1ZSk7XG5cblx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLCAwKTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmICghZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YWJ1bGF0b3ItZWRpdGluZ1wiKSkge1xuXHRcdFx0ZWxlbWVudC5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG5cdFx0fVxuXHR9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoZS5idXR0b24gPT09IDIpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c2VsZi5tb3VzZUNsaWNrID0gdHJ1ZTtcblx0XHR9XG5cdH0pO1xuXG5cdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKCFzZWxmLnJlY3Vyc2lvbkJsb2NrKSB7XG5cdFx0XHRzZWxmLmVkaXQoY2VsbCwgZSwgZmFsc2UpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5FZGl0LnByb3RvdHlwZS5mb2N1c0NlbGxOb0V2ZW50ID0gZnVuY3Rpb24gKGNlbGwsIGJsb2NrKSB7XG5cdHRoaXMucmVjdXJzaW9uQmxvY2sgPSB0cnVlO1xuXHRpZiAoIShibG9jayAmJiB0aGlzLnRhYmxlLmJyb3dzZXIgPT09IFwiaWVcIikpIHtcblx0XHRjZWxsLmdldEVsZW1lbnQoKS5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG5cdH1cblx0dGhpcy5yZWN1cnNpb25CbG9jayA9IGZhbHNlO1xufTtcblxuRWRpdC5wcm90b3R5cGUuZWRpdENlbGwgPSBmdW5jdGlvbiAoY2VsbCwgZm9yY2VFZGl0KSB7XG5cdHRoaXMuZm9jdXNDZWxsTm9FdmVudChjZWxsKTtcblx0dGhpcy5lZGl0KGNlbGwsIGZhbHNlLCBmb3JjZUVkaXQpO1xufTtcblxuRWRpdC5wcm90b3R5cGUuZm9jdXNTY3JvbGxBZGp1c3QgPSBmdW5jdGlvbiAoY2VsbCkge1xuXHRpZiAodGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PSBcInZpcnR1YWxcIikge1xuXHRcdHZhciB0b3BFZGdlID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wLFxuXHRcdCAgICBib3R0b21FZGdlID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wLFxuXHRcdCAgICByb3dFbCA9IGNlbGwucm93LmdldEVsZW1lbnQoKSxcblx0XHQgICAgb2Zmc2V0ID0gcm93RWwub2Zmc2V0VG9wO1xuXG5cdFx0aWYgKHJvd0VsLm9mZnNldFRvcCA8IHRvcEVkZ2UpIHtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbFRvcCAtPSB0b3BFZGdlIC0gcm93RWwub2Zmc2V0VG9wO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAocm93RWwub2Zmc2V0VG9wICsgcm93RWwub2Zmc2V0SGVpZ2h0ID4gYm90dG9tRWRnZSkge1xuXHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3AgKz0gcm93RWwub2Zmc2V0VG9wICsgcm93RWwub2Zmc2V0SGVpZ2h0IC0gYm90dG9tRWRnZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR2YXIgbGVmdEVkZ2UgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0LFxuXHRcdCAgICByaWdodEVkZ2UgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCArIHRoaXMudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbExlZnQsXG5cdFx0ICAgIGNlbGxFbCA9IGNlbGwuZ2V0RWxlbWVudCgpLFxuXHRcdCAgICBvZmZzZXQgPSBjZWxsRWwub2Zmc2V0TGVmdDtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImZyb3plbkNvbHVtbnNcIikpIHtcblx0XHRcdGxlZnRFZGdlICs9IHBhcnNlSW50KHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLmxlZnRNYXJnaW4pO1xuXHRcdFx0cmlnaHRFZGdlIC09IHBhcnNlSW50KHRoaXMudGFibGUubW9kdWxlcy5mcm96ZW5Db2x1bW5zLnJpZ2h0TWFyZ2luKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdGxlZnRFZGdlIC09IHBhcnNlSW50KHRoaXMudGFibGUudmRvbUhvei52RG9tUGFkTGVmdCk7XG5cdFx0XHRyaWdodEVkZ2UgLT0gcGFyc2VJbnQodGhpcy50YWJsZS52ZG9tSG96LnZEb21QYWRMZWZ0KTtcblx0XHR9XG5cblx0XHRpZiAoY2VsbEVsLm9mZnNldExlZnQgPCBsZWZ0RWRnZSkge1xuXG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0IC09IGxlZnRFZGdlIC0gY2VsbEVsLm9mZnNldExlZnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChjZWxsRWwub2Zmc2V0TGVmdCArIGNlbGxFbC5vZmZzZXRXaWR0aCA+IHJpZ2h0RWRnZSkge1xuXHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0ICs9IGNlbGxFbC5vZmZzZXRMZWZ0ICsgY2VsbEVsLm9mZnNldFdpZHRoIC0gcmlnaHRFZGdlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuRWRpdC5wcm90b3R5cGUuZWRpdCA9IGZ1bmN0aW9uIChjZWxsLCBlLCBmb3JjZUVkaXQpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgYWxsb3dFZGl0ID0gdHJ1ZSxcblx0ICAgIHJlbmRlcmVkID0gZnVuY3Rpb24gcmVuZGVyZWQoKSB7fSxcblx0ICAgIGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0ICAgIGNlbGxFZGl0b3IsXG5cdCAgICBjb21wb25lbnQsXG5cdCAgICBwYXJhbXM7XG5cblx0Ly9wcmV2ZW50IGVkaXRpbmcgaWYgYW5vdGhlciBjZWxsIGlzIHJlZnVzaW5nIHRvIGxlYXZlIGZvY3VzIChlZy4gdmFsaWRhdGlvbiBmYWlsKVxuXHRpZiAodGhpcy5jdXJyZW50Q2VsbCkge1xuXHRcdGlmICghdGhpcy5pbnZhbGlkRWRpdCkge1xuXHRcdFx0dGhpcy5jYW5jZWxFZGl0KCk7XG5cdFx0fVxuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vaGFuZGxlIHN1Y2Nlc3NmdWxsIHZhbHVlIGNoYW5nZVxuXHRmdW5jdGlvbiBzdWNjZXNzKHZhbHVlKSB7XG5cdFx0aWYgKHNlbGYuY3VycmVudENlbGwgPT09IGNlbGwpIHtcblx0XHRcdHZhciB2YWxpZCA9IHRydWU7XG5cblx0XHRcdGlmIChjZWxsLmNvbHVtbi5tb2R1bGVzLnZhbGlkYXRlICYmIHNlbGYudGFibGUubW9kRXhpc3RzKFwidmFsaWRhdGVcIikgJiYgc2VsZi50YWJsZS5vcHRpb25zLnZhbGlkYXRpb25Nb2RlICE9IFwibWFudWFsXCIpIHtcblx0XHRcdFx0dmFsaWQgPSBzZWxmLnRhYmxlLm1vZHVsZXMudmFsaWRhdGUudmFsaWRhdGUoY2VsbC5jb2x1bW4ubW9kdWxlcy52YWxpZGF0ZSwgY2VsbCwgdmFsdWUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodmFsaWQgPT09IHRydWUgfHwgc2VsZi50YWJsZS5vcHRpb25zLnZhbGlkYXRpb25Nb2RlID09PSBcImhpZ2hsaWdodFwiKSB7XG5cdFx0XHRcdHNlbGYuY2xlYXJFZGl0b3IoKTtcblxuXHRcdFx0XHRpZiAoIWNlbGwubW9kdWxlcy5lZGl0KSB7XG5cdFx0XHRcdFx0Y2VsbC5tb2R1bGVzLmVkaXQgPSB7fTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNlbGwubW9kdWxlcy5lZGl0LmVkaXRlZCA9IHRydWU7XG5cblx0XHRcdFx0aWYgKHNlbGYuZWRpdGVkQ2VsbHMuaW5kZXhPZihjZWxsKSA9PSAtMSkge1xuXHRcdFx0XHRcdHNlbGYuZWRpdGVkQ2VsbHMucHVzaChjZWxsKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNlbGwuc2V0VmFsdWUodmFsdWUsIHRydWUpO1xuXG5cdFx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJkYXRhVHJlZVwiKSkge1xuXHRcdFx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5kYXRhVHJlZS5jaGVja0ZvclJlc3R5bGUoY2VsbCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodmFsaWQgIT09IHRydWUpIHtcblx0XHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdmFsaWRhdGlvbi1mYWlsXCIpO1xuXHRcdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy52YWxpZGF0aW9uRmFpbGVkLmNhbGwoc2VsZi50YWJsZSwgY2VsbC5nZXRDb21wb25lbnQoKSwgdmFsdWUsIHZhbGlkKTtcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNlbGYuaW52YWxpZEVkaXQgPSB0cnVlO1xuXHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItdmFsaWRhdGlvbi1mYWlsXCIpO1xuXHRcdFx0XHRzZWxmLmZvY3VzQ2VsbE5vRXZlbnQoY2VsbCwgdHJ1ZSk7XG5cdFx0XHRcdHJlbmRlcmVkKCk7XG5cdFx0XHRcdHNlbGYudGFibGUub3B0aW9ucy52YWxpZGF0aW9uRmFpbGVkLmNhbGwoc2VsZi50YWJsZSwgY2VsbC5nZXRDb21wb25lbnQoKSwgdmFsdWUsIHZhbGlkKTtcblxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGNvbnNvbGUud2FybihcIkVkaXQgU3VjY2VzcyBFcnJvciAtIGNhbm5vdCBjYWxsIHN1Y2Nlc3Mgb24gYSBjZWxsIHRoYXQgaXMgbm8gbG9uZ2VyIGJlaW5nIGVkaXRlZFwiKTtcblx0XHR9XG5cdH1cblxuXHQvL2hhbmRsZSBhYm9ydGVkIGVkaXRcblx0ZnVuY3Rpb24gY2FuY2VsKCkge1xuXHRcdGlmIChzZWxmLmN1cnJlbnRDZWxsID09PSBjZWxsKSB7XG5cdFx0XHRzZWxmLmNhbmNlbEVkaXQoKTtcblxuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImRhdGFUcmVlXCIpKSB7XG5cdFx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5kYXRhVHJlZS5jaGVja0ZvclJlc3R5bGUoY2VsbCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGNvbnNvbGUud2FybihcIkVkaXQgU3VjY2VzcyBFcnJvciAtIGNhbm5vdCBjYWxsIGNhbmNlbCBvbiBhIGNlbGwgdGhhdCBpcyBubyBsb25nZXIgYmVpbmcgZWRpdGVkXCIpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG9uUmVuZGVyZWQoY2FsbGJhY2spIHtcblx0XHRyZW5kZXJlZCA9IGNhbGxiYWNrO1xuXHR9XG5cblx0aWYgKCFjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQuYmxvY2tlZCkge1xuXHRcdGlmIChlKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH1cblxuXHRcdHN3aXRjaCAoX3R5cGVvZihjZWxsLmNvbHVtbi5tb2R1bGVzLmVkaXQuY2hlY2spKSB7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0YWxsb3dFZGl0ID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrKGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcblx0XHRcdFx0YWxsb3dFZGl0ID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LmNoZWNrO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHRpZiAoYWxsb3dFZGl0IHx8IGZvcmNlRWRpdCkge1xuXG5cdFx0XHRzZWxmLmNhbmNlbEVkaXQoKTtcblxuXHRcdFx0c2VsZi5jdXJyZW50Q2VsbCA9IGNlbGw7XG5cblx0XHRcdHRoaXMuZm9jdXNTY3JvbGxBZGp1c3QoY2VsbCk7XG5cblx0XHRcdGNvbXBvbmVudCA9IGNlbGwuZ2V0Q29tcG9uZW50KCk7XG5cblx0XHRcdGlmICh0aGlzLm1vdXNlQ2xpY2spIHtcblx0XHRcdFx0dGhpcy5tb3VzZUNsaWNrID0gZmFsc2U7XG5cblx0XHRcdFx0aWYgKGNlbGwuY29sdW1uLmNlbGxFdmVudHMuY2VsbENsaWNrKSB7XG5cdFx0XHRcdFx0Y2VsbC5jb2x1bW4uY2VsbEV2ZW50cy5jZWxsQ2xpY2suY2FsbCh0aGlzLnRhYmxlLCBlLCBjb21wb25lbnQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChjZWxsLmNvbHVtbi5jZWxsRXZlbnRzLmNlbGxFZGl0aW5nKSB7XG5cdFx0XHRcdGNlbGwuY29sdW1uLmNlbGxFdmVudHMuY2VsbEVkaXRpbmcuY2FsbCh0aGlzLnRhYmxlLCBjb21wb25lbnQpO1xuXHRcdFx0fVxuXG5cdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuY2VsbEVkaXRpbmcuY2FsbCh0aGlzLnRhYmxlLCBjb21wb25lbnQpO1xuXG5cdFx0XHRwYXJhbXMgPSB0eXBlb2YgY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LnBhcmFtcyhjb21wb25lbnQpIDogY2VsbC5jb2x1bW4ubW9kdWxlcy5lZGl0LnBhcmFtcztcblxuXHRcdFx0Y2VsbEVkaXRvciA9IGNlbGwuY29sdW1uLm1vZHVsZXMuZWRpdC5lZGl0b3IuY2FsbChzZWxmLCBjb21wb25lbnQsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgcGFyYW1zKTtcblxuXHRcdFx0Ly9pZiBlZGl0b3IgcmV0dXJuZWQsIGFkZCB0byBET00sIGlmIGZhbHNlLCBhYm9ydCBlZGl0XG5cdFx0XHRpZiAoY2VsbEVkaXRvciAhPT0gZmFsc2UpIHtcblxuXHRcdFx0XHRpZiAoY2VsbEVkaXRvciBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdGluZ1wiKTtcblx0XHRcdFx0XHRjZWxsLnJvdy5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1yb3ctZWRpdGluZ1wiKTtcblx0XHRcdFx0XHR3aGlsZSAoZWxlbWVudC5maXJzdENoaWxkKSB7XG5cdFx0XHRcdFx0XHRlbGVtZW50LnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0fWVsZW1lbnQuYXBwZW5kQ2hpbGQoY2VsbEVkaXRvcik7XG5cblx0XHRcdFx0XHQvL3RyaWdnZXIgb25SZW5kZXJlZCBDYWxsYmFja1xuXHRcdFx0XHRcdHJlbmRlcmVkKCk7XG5cblx0XHRcdFx0XHQvL3ByZXZlbnQgZWRpdGluZyBmcm9tIHRyaWdnZXJpbmcgcm93Q2xpY2sgZXZlbnRcblx0XHRcdFx0XHR2YXIgY2hpbGRyZW4gPSBlbGVtZW50LmNoaWxkcmVuO1xuXG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0Y2hpbGRyZW5baV0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiRWRpdCBFcnJvciAtIEVkaXRvciBzaG91bGQgcmV0dXJuIGFuIGluc3RhbmNlIG9mIE5vZGUsIHRoZSBlZGl0b3IgcmV0dXJuZWQ6XCIsIGNlbGxFZGl0b3IpO1xuXHRcdFx0XHRcdGVsZW1lbnQuYmx1cigpO1xuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudC5ibHVyKCk7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMubW91c2VDbGljayA9IGZhbHNlO1xuXHRcdFx0ZWxlbWVudC5ibHVyKCk7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMubW91c2VDbGljayA9IGZhbHNlO1xuXHRcdGVsZW1lbnQuYmx1cigpO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuRWRpdC5wcm90b3R5cGUubWFza0lucHV0ID0gZnVuY3Rpb24gKGVsLCBvcHRpb25zKSB7XG5cdHZhciBtYXNrID0gb3B0aW9ucy5tYXNrLFxuXHQgICAgbWFza0xldHRlciA9IHR5cGVvZiBvcHRpb25zLm1hc2tMZXR0ZXJDaGFyICE9PSBcInVuZGVmaW5lZFwiID8gb3B0aW9ucy5tYXNrTGV0dGVyQ2hhciA6IFwiQVwiLFxuXHQgICAgbWFza051bWJlciA9IHR5cGVvZiBvcHRpb25zLm1hc2tOdW1iZXJDaGFyICE9PSBcInVuZGVmaW5lZFwiID8gb3B0aW9ucy5tYXNrTnVtYmVyQ2hhciA6IFwiOVwiLFxuXHQgICAgbWFza1dpbGRjYXJkID0gdHlwZW9mIG9wdGlvbnMubWFza1dpbGRjYXJkQ2hhciAhPT0gXCJ1bmRlZmluZWRcIiA/IG9wdGlvbnMubWFza1dpbGRjYXJkQ2hhciA6IFwiKlwiLFxuXHQgICAgc3VjY2VzcyA9IGZhbHNlO1xuXG5cdGZ1bmN0aW9uIGZpbGxTeW1ib2xzKGluZGV4KSB7XG5cdFx0dmFyIHN5bWJvbCA9IG1hc2tbaW5kZXhdO1xuXHRcdGlmICh0eXBlb2Ygc3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIHN5bWJvbCAhPT0gbWFza1dpbGRjYXJkICYmIHN5bWJvbCAhPT0gbWFza0xldHRlciAmJiBzeW1ib2wgIT09IG1hc2tOdW1iZXIpIHtcblx0XHRcdGVsLnZhbHVlID0gZWwudmFsdWUgKyBcIlwiICsgc3ltYm9sO1xuXHRcdFx0ZmlsbFN5bWJvbHMoaW5kZXggKyAxKTtcblx0XHR9XG5cdH1cblxuXHRlbC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBpbmRleCA9IGVsLnZhbHVlLmxlbmd0aCxcblx0XHQgICAgY2hhciA9IGUua2V5O1xuXG5cdFx0aWYgKGUua2V5Q29kZSA+IDQ2KSB7XG5cdFx0XHRpZiAoaW5kZXggPj0gbWFzay5sZW5ndGgpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRzdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHN3aXRjaCAobWFza1tpbmRleF0pIHtcblx0XHRcdFx0XHRjYXNlIG1hc2tMZXR0ZXI6XG5cdFx0XHRcdFx0XHRpZiAoY2hhci50b1VwcGVyQ2FzZSgpID09IGNoYXIudG9Mb3dlckNhc2UoKSkge1xuXHRcdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdHN1Y2Nlc3MgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0XHRjYXNlIG1hc2tOdW1iZXI6XG5cdFx0XHRcdFx0XHRpZiAoaXNOYU4oY2hhcikpIHtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHRzdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBtYXNrV2lsZGNhcmQ6XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRpZiAoY2hhciAhPT0gbWFza1tpbmRleF0pIHtcblx0XHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHRzdWNjZXNzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRzdWNjZXNzID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRyZXR1cm47XG5cdH0pO1xuXG5cdGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmIChlLmtleUNvZGUgPiA0Nikge1xuXHRcdFx0aWYgKG9wdGlvbnMubWFza0F1dG9GaWxsKSB7XG5cdFx0XHRcdGZpbGxTeW1ib2xzKGVsLnZhbHVlLmxlbmd0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRpZiAoIWVsLnBsYWNlaG9sZGVyKSB7XG5cdFx0ZWwucGxhY2Vob2xkZXIgPSBtYXNrO1xuXHR9XG5cblx0aWYgKG9wdGlvbnMubWFza0F1dG9GaWxsKSB7XG5cdFx0ZmlsbFN5bWJvbHMoZWwudmFsdWUubGVuZ3RoKTtcblx0fVxufTtcblxuRWRpdC5wcm90b3R5cGUuZ2V0RWRpdGVkQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBvdXRwdXQgPSBbXTtcblxuXHR0aGlzLmVkaXRlZENlbGxzLmZvckVhY2goZnVuY3Rpb24gKGNlbGwpIHtcblx0XHRvdXRwdXQucHVzaChjZWxsLmdldENvbXBvbmVudCgpKTtcblx0fSk7XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkVkaXQucHJvdG90eXBlLmNsZWFyRWRpdGVkID0gZnVuY3Rpb24gKGNlbGwpIHtcblx0dmFyIGVkaXRJbmRleDtcblxuXHRpZiAoY2VsbC5tb2R1bGVzLmVkaXQgJiYgY2VsbC5tb2R1bGVzLmVkaXQuZWRpdGVkKSB7XG5cdFx0Y2VsbC5tb2R1bGVzLmVkaXQuZWRpdGVkID0gZmFsc2U7XG5cblx0XHRpZiAoY2VsbC5tb2R1bGVzLnZhbGlkYXRlKSB7XG5cdFx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXG5cdGVkaXRJbmRleCA9IHRoaXMuZWRpdGVkQ2VsbHMuaW5kZXhPZihjZWxsKTtcblxuXHRpZiAoZWRpdEluZGV4ID4gLTEpIHtcblx0XHR0aGlzLmVkaXRlZENlbGxzLnNwbGljZShlZGl0SW5kZXgsIDEpO1xuXHR9XG59O1xuXG4vL2RlZmF1bHQgZGF0YSBlZGl0b3JzXG5FZGl0LnByb3RvdHlwZS5lZGl0b3JzID0ge1xuXG5cdC8vaW5wdXQgZWxlbWVudFxuXHRpbnB1dDogZnVuY3Rpb24gaW5wdXQoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpIHtcblxuXHRcdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHRcdHZhciBjZWxsVmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdFx0ICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBlZGl0b3JQYXJhbXMuc2VhcmNoID8gXCJzZWFyY2hcIiA6IFwidGV4dFwiKTtcblxuXHRcdGlucHV0LnN0eWxlLnBhZGRpbmcgPSBcIjRweFwiO1xuXHRcdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdFx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cblx0XHRpZiAoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIF90eXBlb2YoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSA9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdGlmIChrZXkuY2hhckF0KDApID09IFwiK1wiKSB7XG5cdFx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW2tleV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aW5wdXQudmFsdWUgPSB0eXBlb2YgY2VsbFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gY2VsbFZhbHVlIDogXCJcIjtcblxuXHRcdG9uUmVuZGVyZWQoZnVuY3Rpb24gKCkge1xuXHRcdFx0aW5wdXQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBvbkNoYW5nZShlKSB7XG5cdFx0XHRpZiAoKGNlbGxWYWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgY2VsbFZhbHVlID09PSBcInVuZGVmaW5lZFwiKSAmJiBpbnB1dC52YWx1ZSAhPT0gXCJcIiB8fCBpbnB1dC52YWx1ZSAhPT0gY2VsbFZhbHVlKSB7XG5cdFx0XHRcdGlmIChzdWNjZXNzKGlucHV0LnZhbHVlKSkge1xuXHRcdFx0XHRcdGNlbGxWYWx1ZSA9IGlucHV0LnZhbHVlOyAvL3BlcnNpc3QgdmFsdWUgaWYgc3VjY2Vzc2Z1bGx5IHZhbGlkYXRlZCBpbmNhc2UgZWRpdG9yIGlzIHVzZWQgYXMgaGVhZGVyIGZpbHRlclxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjYW5jZWwoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gYmx1ciBvciBjaGFuZ2Vcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIG9uQ2hhbmdlKTtcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBvbkNoYW5nZSk7XG5cblx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gZW50ZXJcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c3dpdGNoIChlLmtleUNvZGUpIHtcblx0XHRcdFx0Ly8gY2FzZSA5OlxuXHRcdFx0XHRjYXNlIDEzOlxuXHRcdFx0XHRcdG9uQ2hhbmdlKGUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAzNTpcblx0XHRcdFx0Y2FzZSAzNjpcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKGVkaXRvclBhcmFtcy5tYXNrKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5tYXNrSW5wdXQoaW5wdXQsIGVkaXRvclBhcmFtcyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGlucHV0O1xuXHR9LFxuXG5cdC8vcmVzaXphYmxlIHRleHQgYXJlYSBlbGVtZW50XG5cdHRleHRhcmVhOiBmdW5jdGlvbiB0ZXh0YXJlYShjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIGVkaXRvclBhcmFtcykge1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHQgICAgY2VsbFZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRcdCAgICB2ZXJ0TmF2ID0gZWRpdG9yUGFyYW1zLnZlcnRpY2FsTmF2aWdhdGlvbiB8fCBcImh5YnJpZFwiLFxuXHRcdCAgICB2YWx1ZSA9IFN0cmluZyhjZWxsVmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIGNlbGxWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGNlbGxWYWx1ZSA6IFwiXCIpLFxuXHRcdCAgICBjb3VudCA9ICh2YWx1ZS5tYXRjaCgvKD86XFxyXFxufFxccnxcXG4pL2cpIHx8IFtdKS5sZW5ndGggKyAxLFxuXHRcdCAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0YXJlYVwiKSxcblx0XHQgICAgc2Nyb2xsSGVpZ2h0ID0gMDtcblxuXHRcdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHRcdGlucHV0LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cdFx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiMnB4XCI7XG5cdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0XHRpbnB1dC5zdHlsZS5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblx0XHRpbnB1dC5zdHlsZS53aGl0ZVNwYWNlID0gXCJwcmUtd3JhcFwiO1xuXHRcdGlucHV0LnN0eWxlLnJlc2l6ZSA9IFwibm9uZVwiO1xuXG5cdFx0aWYgKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyAmJiBfdHlwZW9mKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcykgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0Zm9yICh2YXIga2V5IGluIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcykge1xuXHRcdFx0XHRpZiAoa2V5LmNoYXJBdCgwKSA9PSBcIitcIikge1xuXHRcdFx0XHRcdGtleSA9IGtleS5zbGljZSgxKTtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBpbnB1dC5nZXRBdHRyaWJ1dGUoa2V5KSArIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1tcIitcIiArIGtleV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlucHV0LnZhbHVlID0gdmFsdWU7XG5cblx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblx0XHRcdGlucHV0LmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTtcblx0XHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXG5cdFx0XHRpbnB1dC5zY3JvbGxIZWlnaHQ7XG5cdFx0XHRpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XG5cdFx0XHRjZWxsLmdldFJvdygpLm5vcm1hbGl6ZUhlaWdodCgpO1xuXHRcdH0pO1xuXG5cdFx0ZnVuY3Rpb24gb25DaGFuZ2UoZSkge1xuXG5cdFx0XHRpZiAoKGNlbGxWYWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgY2VsbFZhbHVlID09PSBcInVuZGVmaW5lZFwiKSAmJiBpbnB1dC52YWx1ZSAhPT0gXCJcIiB8fCBpbnB1dC52YWx1ZSAhPT0gY2VsbFZhbHVlKSB7XG5cblx0XHRcdFx0aWYgKHN1Y2Nlc3MoaW5wdXQudmFsdWUpKSB7XG5cdFx0XHRcdFx0Y2VsbFZhbHVlID0gaW5wdXQudmFsdWU7IC8vcGVyc2lzdCB2YWx1ZSBpZiBzdWNjZXNzZnVsbHkgdmFsaWRhdGVkIGluY2FzZSBlZGl0b3IgaXMgdXNlZCBhcyBoZWFkZXIgZmlsdGVyXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRjZWxsLmdldFJvdygpLm5vcm1hbGl6ZUhlaWdodCgpO1xuXHRcdFx0XHR9LCAzMDApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGJsdXIgb3IgY2hhbmdlXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBvbkNoYW5nZSk7XG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgb25DaGFuZ2UpO1xuXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCJcIjtcblxuXHRcdFx0dmFyIGhlaWdodE5vdyA9IGlucHV0LnNjcm9sbEhlaWdodDtcblxuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0Tm93ICsgXCJweFwiO1xuXG5cdFx0XHRpZiAoaGVpZ2h0Tm93ICE9IHNjcm9sbEhlaWdodCkge1xuXHRcdFx0XHRzY3JvbGxIZWlnaHQgPSBoZWlnaHROb3c7XG5cdFx0XHRcdGNlbGwuZ2V0Um93KCkubm9ybWFsaXplSGVpZ2h0KCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXG5cdFx0XHRzd2l0Y2ggKGUua2V5Q29kZSkge1xuXHRcdFx0XHRjYXNlIDI3OlxuXHRcdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgMzg6XG5cdFx0XHRcdFx0Ly91cCBhcnJvd1xuXHRcdFx0XHRcdGlmICh2ZXJ0TmF2ID09IFwiZWRpdG9yXCIgfHwgdmVydE5hdiA9PSBcImh5YnJpZFwiICYmIGlucHV0LnNlbGVjdGlvblN0YXJ0KSB7XG5cdFx0XHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDQwOlxuXHRcdFx0XHRcdC8vZG93biBhcnJvd1xuXHRcdFx0XHRcdGlmICh2ZXJ0TmF2ID09IFwiZWRpdG9yXCIgfHwgdmVydE5hdiA9PSBcImh5YnJpZFwiICYmIGlucHV0LnNlbGVjdGlvblN0YXJ0ICE9PSBpbnB1dC52YWx1ZS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDM1OlxuXHRcdFx0XHRjYXNlIDM2OlxuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAoZWRpdG9yUGFyYW1zLm1hc2spIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5lZGl0Lm1hc2tJbnB1dChpbnB1dCwgZWRpdG9yUGFyYW1zKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gaW5wdXQ7XG5cdH0sXG5cblx0Ly9pbnB1dCBlbGVtZW50IHdpdGggdHlwZSBvZiBudW1iZXJcblx0bnVtYmVyOiBmdW5jdGlvbiBudW1iZXIoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpIHtcblxuXHRcdHZhciBjZWxsVmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdFx0ICAgIHZlcnROYXYgPSBlZGl0b3JQYXJhbXMudmVydGljYWxOYXZpZ2F0aW9uIHx8IFwiZWRpdG9yXCIsXG5cdFx0ICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcIm51bWJlclwiKTtcblxuXHRcdGlmICh0eXBlb2YgZWRpdG9yUGFyYW1zLm1heCAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJtYXhcIiwgZWRpdG9yUGFyYW1zLm1heCk7XG5cdFx0fVxuXG5cdFx0aWYgKHR5cGVvZiBlZGl0b3JQYXJhbXMubWluICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShcIm1pblwiLCBlZGl0b3JQYXJhbXMubWluKTtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIGVkaXRvclBhcmFtcy5zdGVwICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShcInN0ZXBcIiwgZWRpdG9yUGFyYW1zLnN0ZXApO1xuXHRcdH1cblxuXHRcdC8vY3JlYXRlIGFuZCBzdHlsZSBpbnB1dFxuXHRcdGlucHV0LnN0eWxlLnBhZGRpbmcgPSBcIjRweFwiO1xuXHRcdGlucHV0LnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XG5cdFx0aW5wdXQuc3R5bGUuYm94U2l6aW5nID0gXCJib3JkZXItYm94XCI7XG5cblx0XHRpZiAoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIF90eXBlb2YoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSA9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdGlmIChrZXkuY2hhckF0KDApID09IFwiK1wiKSB7XG5cdFx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW2tleV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aW5wdXQudmFsdWUgPSBjZWxsVmFsdWU7XG5cblx0XHR2YXIgYmx1ckZ1bmMgPSBmdW5jdGlvbiBibHVyRnVuYyhlKSB7XG5cdFx0XHRvbkNoYW5nZSgpO1xuXHRcdH07XG5cblx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblx0XHRcdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyXG5cdFx0XHRpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiYmx1clwiLCBibHVyRnVuYyk7XG5cblx0XHRcdGlucHV0LmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTtcblx0XHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXG5cdFx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gYmx1clxuXHRcdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgYmx1ckZ1bmMpO1xuXHRcdH0pO1xuXG5cdFx0ZnVuY3Rpb24gb25DaGFuZ2UoKSB7XG5cdFx0XHR2YXIgdmFsdWUgPSBpbnB1dC52YWx1ZTtcblxuXHRcdFx0aWYgKCFpc05hTih2YWx1ZSkgJiYgdmFsdWUgIT09IFwiXCIpIHtcblx0XHRcdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodmFsdWUgIT09IGNlbGxWYWx1ZSkge1xuXHRcdFx0XHRpZiAoc3VjY2Vzcyh2YWx1ZSkpIHtcblx0XHRcdFx0XHRjZWxsVmFsdWUgPSB2YWx1ZTsgLy9wZXJzaXN0IHZhbHVlIGlmIHN1Y2Nlc3NmdWxseSB2YWxpZGF0ZWQgaW5jYXNlIGVkaXRvciBpcyB1c2VkIGFzIGhlYWRlciBmaWx0ZXJcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9zdWJtaXQgbmV3IHZhbHVlIG9uIGVudGVyXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHN3aXRjaCAoZS5rZXlDb2RlKSB7XG5cdFx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdFx0Ly8gY2FzZSA5OlxuXHRcdFx0XHRcdG9uQ2hhbmdlKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAyNzpcblx0XHRcdFx0XHRjYW5jZWwoKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDM4OiAvL3VwIGFycm93XG5cdFx0XHRcdGNhc2UgNDA6XG5cdFx0XHRcdFx0Ly9kb3duIGFycm93XG5cdFx0XHRcdFx0aWYgKHZlcnROYXYgPT0gXCJlZGl0b3JcIikge1xuXHRcdFx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgMzU6XG5cdFx0XHRcdGNhc2UgMzY6XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlmIChlZGl0b3JQYXJhbXMubWFzaykge1xuXHRcdFx0dGhpcy50YWJsZS5tb2R1bGVzLmVkaXQubWFza0lucHV0KGlucHV0LCBlZGl0b3JQYXJhbXMpO1xuXHRcdH1cblxuXHRcdHJldHVybiBpbnB1dDtcblx0fSxcblxuXHQvL2lucHV0IGVsZW1lbnQgd2l0aCB0eXBlIG9mIG51bWJlclxuXHRyYW5nZTogZnVuY3Rpb24gcmFuZ2UoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpIHtcblxuXHRcdHZhciBjZWxsVmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdFx0ICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInJhbmdlXCIpO1xuXG5cdFx0aWYgKHR5cGVvZiBlZGl0b3JQYXJhbXMubWF4ICE9IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdGlucHV0LnNldEF0dHJpYnV0ZShcIm1heFwiLCBlZGl0b3JQYXJhbXMubWF4KTtcblx0XHR9XG5cblx0XHRpZiAodHlwZW9mIGVkaXRvclBhcmFtcy5taW4gIT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwibWluXCIsIGVkaXRvclBhcmFtcy5taW4pO1xuXHRcdH1cblxuXHRcdGlmICh0eXBlb2YgZWRpdG9yUGFyYW1zLnN0ZXAgIT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwic3RlcFwiLCBlZGl0b3JQYXJhbXMuc3RlcCk7XG5cdFx0fVxuXG5cdFx0Ly9jcmVhdGUgYW5kIHN0eWxlIGlucHV0XG5cdFx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cdFx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0XHRpbnB1dC5zdHlsZS5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblxuXHRcdGlmIChlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgX3R5cGVvZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdGZvciAodmFyIGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0aWYgKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpIHtcblx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpbnB1dC52YWx1ZSA9IGNlbGxWYWx1ZTtcblxuXHRcdG9uUmVuZGVyZWQoZnVuY3Rpb24gKCkge1xuXHRcdFx0aW5wdXQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBvbkNoYW5nZSgpIHtcblx0XHRcdHZhciB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuXG5cdFx0XHRpZiAoIWlzTmFOKHZhbHVlKSAmJiB2YWx1ZSAhPT0gXCJcIikge1xuXHRcdFx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh2YWx1ZSAhPSBjZWxsVmFsdWUpIHtcblx0XHRcdFx0aWYgKHN1Y2Nlc3ModmFsdWUpKSB7XG5cdFx0XHRcdFx0Y2VsbFZhbHVlID0gdmFsdWU7IC8vcGVyc2lzdCB2YWx1ZSBpZiBzdWNjZXNzZnVsbHkgdmFsaWRhdGVkIGluY2FzZSBlZGl0b3IgaXMgdXNlZCBhcyBoZWFkZXIgZmlsdGVyXG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vc3VibWl0IG5ldyB2YWx1ZSBvbiBibHVyXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdG9uQ2hhbmdlKCk7XG5cdFx0fSk7XG5cblx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gZW50ZXJcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c3dpdGNoIChlLmtleUNvZGUpIHtcblx0XHRcdFx0Y2FzZSAxMzpcblx0XHRcdFx0XHQvLyBjYXNlIDk6XG5cdFx0XHRcdFx0b25DaGFuZ2UoKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDI3OlxuXHRcdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGlucHV0O1xuXHR9LFxuXG5cdC8vc2VsZWN0XG5cdHNlbGVjdDogZnVuY3Rpb24gc2VsZWN0KGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKSB7XG5cdFx0dmFyIF90aGlzNTMgPSB0aGlzO1xuXG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdCAgICBjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0XHQgICAgaW5pdGlhbFZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRcdCAgICB2ZXJ0TmF2ID0gZWRpdG9yUGFyYW1zLnZlcnRpY2FsTmF2aWdhdGlvbiB8fCBcImVkaXRvclwiLFxuXHRcdCAgICBpbml0aWFsRGlzcGxheVZhbHVlID0gdHlwZW9mIGluaXRpYWxWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiB8fCBpbml0aWFsVmFsdWUgPT09IG51bGwgPyBBcnJheS5pc0FycmF5KGluaXRpYWxWYWx1ZSkgPyBpbml0aWFsVmFsdWUgOiBbaW5pdGlhbFZhbHVlXSA6IHR5cGVvZiBlZGl0b3JQYXJhbXMuZGVmYXVsdFZhbHVlICE9PSBcInVuZGVmaW5lZFwiID8gZWRpdG9yUGFyYW1zLmRlZmF1bHRWYWx1ZSA6IFtdLFxuXHRcdCAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0XHQgICAgbGlzdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0XHQgICAgbXVsdGlzZWxlY3QgPSBlZGl0b3JQYXJhbXMubXVsdGlzZWxlY3QsXG5cdFx0ICAgIGRhdGFJdGVtcyA9IFtdLFxuXHRcdCAgICBjdXJyZW50SXRlbSA9IHt9LFxuXHRcdCAgICBkaXNwbGF5SXRlbXMgPSBbXSxcblx0XHQgICAgY3VycmVudEl0ZW1zID0gW10sXG5cdFx0ICAgIGJsdXJhYmxlID0gdHJ1ZSxcblx0XHQgICAgYmxvY2tMaXN0U2hvdyA9IGZhbHNlLFxuXHRcdCAgICBzZWFyY2hXb3JkID0gXCJcIixcblx0XHQgICAgc2VhcmNoV29yZFRpbWVvdXQgPSBudWxsO1xuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZWRpdG9yUGFyYW1zKSB8fCAhQXJyYXkuaXNBcnJheShlZGl0b3JQYXJhbXMpICYmICh0eXBlb2YgZWRpdG9yUGFyYW1zID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihlZGl0b3JQYXJhbXMpKSA9PT0gXCJvYmplY3RcIiAmJiAhZWRpdG9yUGFyYW1zLnZhbHVlcykge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiREVQUkVDQVRJT04gV0FSTklORyAtIHZhbHVlcyBmb3IgdGhlIHNlbGVjdCBlZGl0b3IgbXVzdCBub3cgYmUgcGFzc2VkIGludG8gdGhlIHZhbHVlcyBwcm9wZXJ0eSBvZiB0aGUgZWRpdG9yUGFyYW1zIG9iamVjdCwgbm90IGFzIHRoZSBlZGl0b3JQYXJhbXMgb2JqZWN0XCIpO1xuXHRcdFx0ZWRpdG9yUGFyYW1zID0geyB2YWx1ZXM6IGVkaXRvclBhcmFtcyB9O1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGdldFVuaXF1ZUNvbHVtblZhbHVlcyhmaWVsZCkge1xuXHRcdFx0dmFyIG91dHB1dCA9IHt9LFxuXHRcdFx0ICAgIGRhdGEgPSBzZWxmLnRhYmxlLmdldERhdGEoKSxcblx0XHRcdCAgICBjb2x1bW47XG5cblx0XHRcdGlmIChmaWVsZCkge1xuXHRcdFx0XHRjb2x1bW4gPSBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1uQnlGaWVsZChmaWVsZCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb2x1bW4gPSBjZWxsLmdldENvbHVtbigpLl9nZXRTZWxmKCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdFx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdFx0XHR2YXIgdmFsID0gY29sdW1uLmdldEZpZWxkVmFsdWUocm93KTtcblxuXHRcdFx0XHRcdGlmICh2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiB2YWwgIT09IFwiXCIpIHtcblx0XHRcdFx0XHRcdG91dHB1dFt2YWxdID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwidW5hYmxlIHRvIGZpbmQgbWF0Y2hpbmcgY29sdW1uIHRvIGNyZWF0ZSBzZWxlY3QgbG9va3VwIGxpc3Q6XCIsIGZpZWxkKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIE9iamVjdC5rZXlzKG91dHB1dCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcGFyc2VJdGVtcyhpbnB1dFZhbHVlcywgY3VyZW50VmFsdWVzKSB7XG5cdFx0XHR2YXIgZGF0YUxpc3QgPSBbXTtcblx0XHRcdHZhciBkaXNwbGF5TGlzdCA9IFtdO1xuXG5cdFx0XHRmdW5jdGlvbiBwcm9jZXNzQ29tcGxleExpc3RJdGVtKGl0ZW0pIHtcblx0XHRcdFx0dmFyIGl0ZW0gPSB7XG5cdFx0XHRcdFx0bGFiZWw6IGl0ZW0ubGFiZWwsXG5cdFx0XHRcdFx0dmFsdWU6IGl0ZW0udmFsdWUsXG5cdFx0XHRcdFx0aXRlbVBhcmFtczogaXRlbS5pdGVtUGFyYW1zLFxuXHRcdFx0XHRcdGVsZW1lbnRBdHRyaWJ1dGVzOiBpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzLFxuXHRcdFx0XHRcdGVsZW1lbnQ6IGZhbHNlXG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gaWYoaXRlbS52YWx1ZSA9PT0gY3VyZW50VmFsdWUgfHwgKCFpc05hTihwYXJzZUZsb2F0KGl0ZW0udmFsdWUpKSAmJiAhaXNOYU4ocGFyc2VGbG9hdChpdGVtLnZhbHVlKSkgJiYgcGFyc2VGbG9hdChpdGVtLnZhbHVlKSA9PT0gcGFyc2VGbG9hdChjdXJlbnRWYWx1ZSkpKXtcblx0XHRcdFx0Ly8gXHRzZXRDdXJyZW50SXRlbShpdGVtKTtcblx0XHRcdFx0Ly8gfVxuXG5cdFx0XHRcdGlmIChjdXJlbnRWYWx1ZXMuaW5kZXhPZihpdGVtLnZhbHVlKSA+IC0xKSB7XG5cdFx0XHRcdFx0c2V0SXRlbShpdGVtKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGRhdGFMaXN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdGRpc3BsYXlMaXN0LnB1c2goaXRlbSk7XG5cblx0XHRcdFx0cmV0dXJuIGl0ZW07XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0eXBlb2YgaW5wdXRWYWx1ZXMgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdGlucHV0VmFsdWVzID0gaW5wdXRWYWx1ZXMoY2VsbCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChBcnJheS5pc0FycmF5KGlucHV0VmFsdWVzKSkge1xuXHRcdFx0XHRpbnB1dFZhbHVlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdFx0XHRcdHZhciBpdGVtO1xuXG5cdFx0XHRcdFx0aWYgKCh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHZhbHVlKSkgPT09IFwib2JqZWN0XCIpIHtcblxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlLm9wdGlvbnMpIHtcblx0XHRcdFx0XHRcdFx0aXRlbSA9IHtcblx0XHRcdFx0XHRcdFx0XHRsYWJlbDogdmFsdWUubGFiZWwsXG5cdFx0XHRcdFx0XHRcdFx0Z3JvdXA6IHRydWUsXG5cdFx0XHRcdFx0XHRcdFx0aXRlbVBhcmFtczogdmFsdWUuaXRlbVBhcmFtcyxcblx0XHRcdFx0XHRcdFx0XHRlbGVtZW50QXR0cmlidXRlczogdmFsdWUuZWxlbWVudEF0dHJpYnV0ZXMsXG5cdFx0XHRcdFx0XHRcdFx0ZWxlbWVudDogZmFsc2Vcblx0XHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0XHRkaXNwbGF5TGlzdC5wdXNoKGl0ZW0pO1xuXG5cdFx0XHRcdFx0XHRcdHZhbHVlLm9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRcdFx0XHRcdHByb2Nlc3NDb21wbGV4TGlzdEl0ZW0oaXRlbSk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0cHJvY2Vzc0NvbXBsZXhMaXN0SXRlbSh2YWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0aXRlbSA9IHtcblx0XHRcdFx0XHRcdFx0bGFiZWw6IHZhbHVlLFxuXHRcdFx0XHRcdFx0XHR2YWx1ZTogdmFsdWUsXG5cdFx0XHRcdFx0XHRcdGVsZW1lbnQ6IGZhbHNlXG5cdFx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0XHQvLyBpZihpdGVtLnZhbHVlID09PSBjdXJlbnRWYWx1ZSB8fCAoIWlzTmFOKHBhcnNlRmxvYXQoaXRlbS52YWx1ZSkpICYmICFpc05hTihwYXJzZUZsb2F0KGl0ZW0udmFsdWUpKSAmJiBwYXJzZUZsb2F0KGl0ZW0udmFsdWUpID09PSBwYXJzZUZsb2F0KGN1cmVudFZhbHVlKSkpe1xuXHRcdFx0XHRcdFx0Ly8gXHRzZXRDdXJyZW50SXRlbShpdGVtKTtcblx0XHRcdFx0XHRcdC8vIH1cblxuXHRcdFx0XHRcdFx0aWYgKGN1cmVudFZhbHVlcy5pbmRleE9mKGl0ZW0udmFsdWUpID4gLTEpIHtcblx0XHRcdFx0XHRcdFx0c2V0SXRlbShpdGVtKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0ZGF0YUxpc3QucHVzaChpdGVtKTtcblx0XHRcdFx0XHRcdGRpc3BsYXlMaXN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGZvciAodmFyIGtleSBpbiBpbnB1dFZhbHVlcykge1xuXHRcdFx0XHRcdHZhciBpdGVtID0ge1xuXHRcdFx0XHRcdFx0bGFiZWw6IGlucHV0VmFsdWVzW2tleV0sXG5cdFx0XHRcdFx0XHR2YWx1ZToga2V5LFxuXHRcdFx0XHRcdFx0ZWxlbWVudDogZmFsc2Vcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0Ly8gaWYoaXRlbS52YWx1ZSA9PT0gY3VyZW50VmFsdWUgfHwgKCFpc05hTihwYXJzZUZsb2F0KGl0ZW0udmFsdWUpKSAmJiAhaXNOYU4ocGFyc2VGbG9hdChpdGVtLnZhbHVlKSkgJiYgcGFyc2VGbG9hdChpdGVtLnZhbHVlKSA9PT0gcGFyc2VGbG9hdChjdXJlbnRWYWx1ZSkpKXtcblx0XHRcdFx0XHQvLyBcdHNldEN1cnJlbnRJdGVtKGl0ZW0pO1xuXHRcdFx0XHRcdC8vIH1cblxuXHRcdFx0XHRcdGlmIChjdXJlbnRWYWx1ZXMuaW5kZXhPZihpdGVtLnZhbHVlKSA+IC0xKSB7XG5cdFx0XHRcdFx0XHRzZXRJdGVtKGl0ZW0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGRhdGFMaXN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdFx0ZGlzcGxheUxpc3QucHVzaChpdGVtKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZWRpdG9yUGFyYW1zLnNvcnRWYWx1ZXNMaXN0KSB7XG5cdFx0XHRcdGRhdGFMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0XHRcdFx0XHRyZXR1cm4gYS5sYWJlbCA8IGIubGFiZWwgPyAtMSA6IGEubGFiZWwgPiBiLmxhYmVsID8gMSA6IDA7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGRpc3BsYXlMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0XHRcdFx0XHRyZXR1cm4gYS5sYWJlbCA8IGIubGFiZWwgPyAtMSA6IGEubGFiZWwgPiBiLmxhYmVsID8gMSA6IDA7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChlZGl0b3JQYXJhbXMuc29ydFZhbHVlc0xpc3QgIT09IFwiYXNjXCIpIHtcblx0XHRcdFx0XHRkYXRhTGlzdC5yZXZlcnNlKCk7XG5cdFx0XHRcdFx0ZGlzcGxheUxpc3QucmV2ZXJzZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGRhdGFJdGVtcyA9IGRhdGFMaXN0O1xuXHRcdFx0ZGlzcGxheUl0ZW1zID0gZGlzcGxheUxpc3Q7XG5cblx0XHRcdGZpbGxMaXN0KCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZmlsbExpc3QoKSB7XG5cdFx0XHR3aGlsZSAobGlzdEVsLmZpcnN0Q2hpbGQpIHtcblx0XHRcdFx0bGlzdEVsLnJlbW92ZUNoaWxkKGxpc3RFbC5maXJzdENoaWxkKTtcblx0XHRcdH1kaXNwbGF5SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXG5cdFx0XHRcdHZhciBlbCA9IGl0ZW0uZWxlbWVudDtcblxuXHRcdFx0XHRpZiAoIWVsKSB7XG5cdFx0XHRcdFx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHRcdGl0ZW0ubGFiZWwgPSBlZGl0b3JQYXJhbXMubGlzdEl0ZW1Gb3JtYXR0ZXIgPyBlZGl0b3JQYXJhbXMubGlzdEl0ZW1Gb3JtYXR0ZXIoaXRlbS52YWx1ZSwgaXRlbS5sYWJlbCwgY2VsbCwgZWwsIGl0ZW0uaXRlbVBhcmFtcykgOiBpdGVtLmxhYmVsO1xuXHRcdFx0XHRcdGlmIChpdGVtLmdyb3VwKSB7XG5cdFx0XHRcdFx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXQtc2VsZWN0LWxpc3QtZ3JvdXBcIik7XG5cdFx0XHRcdFx0XHRlbC50YWJJbmRleCA9IDA7XG5cdFx0XHRcdFx0XHRlbC5pbm5lckhUTUwgPSBpdGVtLmxhYmVsID09PSBcIlwiID8gXCImbmJzcDtcIiA6IGl0ZW0ubGFiZWw7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdC1zZWxlY3QtbGlzdC1pdGVtXCIpO1xuXHRcdFx0XHRcdFx0ZWwudGFiSW5kZXggPSAwO1xuXHRcdFx0XHRcdFx0ZWwuaW5uZXJIVE1MID0gaXRlbS5sYWJlbCA9PT0gXCJcIiA/IFwiJm5ic3A7XCIgOiBpdGVtLmxhYmVsO1xuXG5cdFx0XHRcdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRibG9ja0xpc3RTaG93ID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0XHRibG9ja0xpc3RTaG93ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdH0sIDEwKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBzZXRDdXJyZW50SXRlbShpdGVtKTtcblx0XHRcdFx0XHRcdFx0Ly8gY2hvb3NlSXRlbSgpO1xuXHRcdFx0XHRcdFx0XHRpZiAobXVsdGlzZWxlY3QpIHtcblx0XHRcdFx0XHRcdFx0XHR0b2dnbGVJdGVtKGl0ZW0pO1xuXHRcdFx0XHRcdFx0XHRcdGlucHV0LmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0Y2hvb3NlSXRlbShpdGVtKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdC8vIGlmKGl0ZW0gPT09IGN1cnJlbnRJdGVtKXtcblx0XHRcdFx0XHRcdC8vIFx0ZWwuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdC8vIH1cblxuXHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRJdGVtcy5pbmRleE9mKGl0ZW0pID4gLTEpIHtcblx0XHRcdFx0XHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoaXRlbS5lbGVtZW50QXR0cmlidXRlcyAmJiBfdHlwZW9mKGl0ZW0uZWxlbWVudEF0dHJpYnV0ZXMpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIGtleSBpbiBpdGVtLmVsZW1lbnRBdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChrZXkuY2hhckF0KDApID09IFwiK1wiKSB7XG5cdFx0XHRcdFx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShrZXksIGlucHV0LmdldEF0dHJpYnV0ZShrZXkpICsgaXRlbS5lbGVtZW50QXR0cmlidXRlc1tcIitcIiArIGtleV0pO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShrZXksIGl0ZW0uZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRibHVyYWJsZSA9IGZhbHNlO1xuXG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0Ymx1cmFibGUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0fSwgMTApO1xuXHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0aXRlbS5lbGVtZW50ID0gZWw7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRsaXN0RWwuYXBwZW5kQ2hpbGQoZWwpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gc2V0Q3VycmVudEl0ZW0oaXRlbSwgYWN0aXZlKSB7XG5cblx0XHRcdGlmICghbXVsdGlzZWxlY3QgJiYgY3VycmVudEl0ZW0gJiYgY3VycmVudEl0ZW0uZWxlbWVudCkge1xuXHRcdFx0XHRjdXJyZW50SXRlbS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChjdXJyZW50SXRlbSAmJiBjdXJyZW50SXRlbS5lbGVtZW50KSB7XG5cdFx0XHRcdGN1cnJlbnRJdGVtLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImZvY3VzZWRcIik7XG5cdFx0XHR9XG5cblx0XHRcdGN1cnJlbnRJdGVtID0gaXRlbTtcblxuXHRcdFx0aWYgKGl0ZW0uZWxlbWVudCkge1xuXHRcdFx0XHRpdGVtLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImZvY3VzZWRcIik7XG5cdFx0XHRcdGlmIChhY3RpdmUpIHtcblx0XHRcdFx0XHRpdGVtLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXRlbSAmJiBpdGVtLmVsZW1lbnQgJiYgaXRlbS5lbGVtZW50LnNjcm9sbEludG9WaWV3KSB7XG5cdFx0XHRcdGl0ZW0uZWxlbWVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJywgYmxvY2s6ICduZWFyZXN0JywgaW5saW5lOiAnc3RhcnQnIH0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIGZ1bmN0aW9uIGNob29zZUl0ZW0oKXtcblx0XHQvLyBcdGhpZGVMaXN0KCk7XG5cblx0XHQvLyBcdGlmKGluaXRpYWxWYWx1ZSAhPT0gY3VycmVudEl0ZW0udmFsdWUpe1xuXHRcdC8vIFx0XHRpbml0aWFsVmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcblx0XHQvLyBcdFx0c3VjY2VzcyhjdXJyZW50SXRlbS52YWx1ZSk7XG5cdFx0Ly8gXHR9ZWxzZXtcblx0XHQvLyBcdFx0Y2FuY2VsKCk7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfVxuXG5cdFx0ZnVuY3Rpb24gc2V0SXRlbShpdGVtKSB7XG5cdFx0XHR2YXIgaW5kZXggPSBjdXJyZW50SXRlbXMuaW5kZXhPZihpdGVtKTtcblxuXHRcdFx0aWYgKGluZGV4ID09IC0xKSB7XG5cdFx0XHRcdGN1cnJlbnRJdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdFx0XHRzZXRDdXJyZW50SXRlbShpdGVtLCB0cnVlKTtcblx0XHRcdH1cblxuXHRcdFx0ZmlsbElucHV0KCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdW5zZXRJdGVtKGluZGV4KSB7XG5cdFx0XHR2YXIgaXRlbSA9IGN1cnJlbnRJdGVtc1tpbmRleF07XG5cblx0XHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHRcdGN1cnJlbnRJdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHRpZiAoaXRlbS5lbGVtZW50KSB7XG5cdFx0XHRcdFx0aXRlbS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiB0b2dnbGVJdGVtKGl0ZW0pIHtcblx0XHRcdGlmICghaXRlbSkge1xuXHRcdFx0XHRpdGVtID0gY3VycmVudEl0ZW07XG5cdFx0XHR9XG5cblx0XHRcdHZhciBpbmRleCA9IGN1cnJlbnRJdGVtcy5pbmRleE9mKGl0ZW0pO1xuXG5cdFx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0XHR1bnNldEl0ZW0oaW5kZXgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKG11bHRpc2VsZWN0ICE9PSB0cnVlICYmIGN1cnJlbnRJdGVtcy5sZW5ndGggPj0gbXVsdGlzZWxlY3QpIHtcblx0XHRcdFx0XHR1bnNldEl0ZW0oMCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZXRJdGVtKGl0ZW0pO1xuXHRcdFx0fVxuXG5cdFx0XHRmaWxsSW5wdXQoKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjaG9vc2VJdGVtKGl0ZW0pIHtcblx0XHRcdGhpZGVMaXN0KCk7XG5cblx0XHRcdGlmICghaXRlbSkge1xuXHRcdFx0XHRpdGVtID0gY3VycmVudEl0ZW07XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpdGVtKSB7XG5cdFx0XHRcdGlucHV0LnZhbHVlID0gaXRlbS5sYWJlbDtcblx0XHRcdFx0c3VjY2VzcyhpdGVtLnZhbHVlKTtcblx0XHRcdH1cblxuXHRcdFx0aW5pdGlhbERpc3BsYXlWYWx1ZSA9IFtpdGVtLnZhbHVlXTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjaG9vc2VJdGVtcyhzaWxlbnQpIHtcblx0XHRcdGlmICghc2lsZW50KSB7XG5cdFx0XHRcdGhpZGVMaXN0KCk7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBvdXRwdXQgPSBbXTtcblxuXHRcdFx0Y3VycmVudEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goaXRlbS52YWx1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aW5pdGlhbERpc3BsYXlWYWx1ZSA9IG91dHB1dDtcblxuXHRcdFx0c3VjY2VzcyhvdXRwdXQpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGZpbGxJbnB1dCgpIHtcblx0XHRcdHZhciBvdXRwdXQgPSBbXTtcblxuXHRcdFx0Y3VycmVudEl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goaXRlbS5sYWJlbCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aW5wdXQudmFsdWUgPSBvdXRwdXQuam9pbihcIiwgXCIpO1xuXG5cdFx0XHRpZiAoc2VsZi5jdXJyZW50Q2VsbCA9PT0gZmFsc2UpIHtcblx0XHRcdFx0Y2hvb3NlSXRlbXModHJ1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdW5zZXRJdGVtcygpIHtcblxuXHRcdFx0dmFyIGxlbiA9IGN1cnJlbnRJdGVtcy5sZW5ndGg7XG5cblx0XHRcdGZvciAodmFyIF9pOSA9IDA7IF9pOSA8IGxlbjsgX2k5KyspIHtcblx0XHRcdFx0dW5zZXRJdGVtKDApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNhbmNlbEl0ZW0oKSB7XG5cdFx0XHRoaWRlTGlzdCgpO1xuXHRcdFx0Y2FuY2VsKCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gc2hvd0xpc3QoKSB7XG5cdFx0XHRjdXJyZW50SXRlbXMgPSBbXTtcblxuXHRcdFx0aWYgKCFsaXN0RWwucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRpZiAoZWRpdG9yUGFyYW1zLnZhbHVlcyA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRcdHBhcnNlSXRlbXMoZ2V0VW5pcXVlQ29sdW1uVmFsdWVzKCksIGluaXRpYWxEaXNwbGF5VmFsdWUpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiBlZGl0b3JQYXJhbXMudmFsdWVzID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdFx0cGFyc2VJdGVtcyhnZXRVbmlxdWVDb2x1bW5WYWx1ZXMoZWRpdG9yUGFyYW1zLnZhbHVlcyksIGluaXRpYWxEaXNwbGF5VmFsdWUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHBhcnNlSXRlbXMoZWRpdG9yUGFyYW1zLnZhbHVlcyB8fCBbXSwgaW5pdGlhbERpc3BsYXlWYWx1ZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgb2Zmc2V0ID0gVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmVsT2Zmc2V0KGNlbGxFbCk7XG5cblx0XHRcdFx0bGlzdEVsLnN0eWxlLm1pbldpZHRoID0gY2VsbEVsLm9mZnNldFdpZHRoICsgXCJweFwiO1xuXG5cdFx0XHRcdGxpc3RFbC5zdHlsZS50b3AgPSBvZmZzZXQudG9wICsgY2VsbEVsLm9mZnNldEhlaWdodCArIFwicHhcIjtcblx0XHRcdFx0bGlzdEVsLnN0eWxlLmxlZnQgPSBvZmZzZXQubGVmdCArIFwicHhcIjtcblxuXHRcdFx0XHRsaXN0RWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdGJsdXJhYmxlID0gZmFsc2U7XG5cblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdGJsdXJhYmxlID0gdHJ1ZTtcblx0XHRcdFx0XHR9LCAxMCk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobGlzdEVsKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBoaWRlTGlzdCgpIHtcblx0XHRcdGlmIChsaXN0RWwucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRsaXN0RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChsaXN0RWwpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZW1vdmVTY3JvbGxMaXN0ZW5lcigpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlbW92ZVNjcm9sbExpc3RlbmVyKCkge1xuXHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjYW5jZWxJdGVtKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzY3JvbGxUb3ZhbHVlKGNoYXIpIHtcblxuXHRcdFx0Y2xlYXJUaW1lb3V0KHNlYXJjaFdvcmRUaW1lb3V0KTtcblxuXHRcdFx0dmFyIGNoYXJhY3RlciA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQua2V5Q29kZSkudG9Mb3dlckNhc2UoKTtcblx0XHRcdHNlYXJjaFdvcmQgKz0gY2hhcmFjdGVyLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdHZhciBtYXRjaCA9IGRhdGFJdGVtcy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdHJldHVybiB0eXBlb2YgaXRlbS5sYWJlbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBpdGVtLmxhYmVsLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChzZWFyY2hXb3JkKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0c2V0Q3VycmVudEl0ZW0obWF0Y2gsICFtdWx0aXNlbGVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdHNlYXJjaFdvcmRUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHNlYXJjaFdvcmQgPSBcIlwiO1xuXHRcdFx0fSwgODAwKTtcblx0XHR9XG5cblx0XHQvL3N0eWxlIGlucHV0XG5cdFx0aW5wdXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInRleHRcIik7XG5cblx0XHRpbnB1dC5zdHlsZS5wYWRkaW5nID0gXCI0cHhcIjtcblx0XHRpbnB1dC5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuXHRcdGlucHV0LnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcdGlucHV0LnN0eWxlLmN1cnNvciA9IFwiZGVmYXVsdFwiO1xuXHRcdGlucHV0LnJlYWRPbmx5ID0gdGhpcy5jdXJyZW50Q2VsbCAhPSBmYWxzZTtcblxuXHRcdGlmIChlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgX3R5cGVvZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdGZvciAodmFyIGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0aWYgKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpIHtcblx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpbnB1dC52YWx1ZSA9IHR5cGVvZiBpbml0aWFsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgfHwgaW5pdGlhbFZhbHVlID09PSBudWxsID8gaW5pdGlhbFZhbHVlIDogXCJcIjtcblxuXHRcdC8vIGlmKGVkaXRvclBhcmFtcy52YWx1ZXMgPT09IHRydWUpe1xuXHRcdC8vIFx0cGFyc2VJdGVtcyhnZXRVbmlxdWVDb2x1bW5WYWx1ZXMoKSwgaW5pdGlhbFZhbHVlKTtcblx0XHQvLyB9ZWxzZSBpZih0eXBlb2YgZWRpdG9yUGFyYW1zLnZhbHVlcyA9PT0gXCJzdHJpbmdcIil7XG5cdFx0Ly8gXHRwYXJzZUl0ZW1zKGdldFVuaXF1ZUNvbHVtblZhbHVlcyhlZGl0b3JQYXJhbXMudmFsdWVzKSwgaW5pdGlhbFZhbHVlKTtcblx0XHQvLyB9ZWxzZXtcblx0XHQvLyBcdHBhcnNlSXRlbXMoZWRpdG9yUGFyYW1zLnZhbHVlcyB8fCBbXSwgaW5pdGlhbFZhbHVlKTtcblx0XHQvLyB9XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwic2VhcmNoXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRpZiAoIWlucHV0LnZhbHVlKSB7XG5cdFx0XHRcdHVuc2V0SXRlbXMoKTtcblx0XHRcdFx0Y2hvb3NlSXRlbXMoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vYWxsb3cga2V5IGJhc2VkIG5hdmlnYXRpb25cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dmFyIGluZGV4O1xuXG5cdFx0XHRzd2l0Y2ggKGUua2V5Q29kZSkge1xuXHRcdFx0XHRjYXNlIDM4OlxuXHRcdFx0XHRcdC8vdXAgYXJyb3dcblx0XHRcdFx0XHRpbmRleCA9IGRhdGFJdGVtcy5pbmRleE9mKGN1cnJlbnRJdGVtKTtcblxuXHRcdFx0XHRcdGlmICh2ZXJ0TmF2ID09IFwiZWRpdG9yXCIgfHwgdmVydE5hdiA9PSBcImh5YnJpZFwiICYmIGluZGV4KSB7XG5cdFx0XHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdFx0XHRcdFx0aWYgKGluZGV4ID4gMCkge1xuXHRcdFx0XHRcdFx0XHRzZXRDdXJyZW50SXRlbShkYXRhSXRlbXNbaW5kZXggLSAxXSwgIW11bHRpc2VsZWN0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSA0MDpcblx0XHRcdFx0XHQvL2Rvd24gYXJyb3dcblx0XHRcdFx0XHRpbmRleCA9IGRhdGFJdGVtcy5pbmRleE9mKGN1cnJlbnRJdGVtKTtcblxuXHRcdFx0XHRcdGlmICh2ZXJ0TmF2ID09IFwiZWRpdG9yXCIgfHwgdmVydE5hdiA9PSBcImh5YnJpZFwiICYmIGluZGV4IDwgZGF0YUl0ZW1zLmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0XHRpZiAoaW5kZXggPCBkYXRhSXRlbXMubGVuZ3RoIC0gMSkge1xuXHRcdFx0XHRcdFx0XHRpZiAoaW5kZXggPT0gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRzZXRDdXJyZW50SXRlbShkYXRhSXRlbXNbMF0sICFtdWx0aXNlbGVjdCk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0c2V0Q3VycmVudEl0ZW0oZGF0YUl0ZW1zW2luZGV4ICsgMV0sICFtdWx0aXNlbGVjdCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAzNzogLy9sZWZ0IGFycm93XG5cdFx0XHRcdGNhc2UgMzk6XG5cdFx0XHRcdFx0Ly9yaWdodCBhcnJvd1xuXHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAxMzpcblx0XHRcdFx0XHQvL2VudGVyXG5cdFx0XHRcdFx0Ly8gY2hvb3NlSXRlbSgpO1xuXG5cdFx0XHRcdFx0aWYgKG11bHRpc2VsZWN0KSB7XG5cdFx0XHRcdFx0XHR0b2dnbGVJdGVtKCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNob29zZUl0ZW0oKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDI3OlxuXHRcdFx0XHRcdC8vZXNjYXBlXG5cdFx0XHRcdFx0Y2FuY2VsSXRlbSgpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgOTpcblx0XHRcdFx0XHQvL3RhYlxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0aWYgKHNlbGYuY3VycmVudENlbGwgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGUua2V5Q29kZSA+PSAzOCAmJiBlLmtleUNvZGUgPD0gOTApIHtcblx0XHRcdFx0XHRcdHNjcm9sbFRvdmFsdWUoZS5rZXlDb2RlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGJsdXJhYmxlKSB7XG5cdFx0XHRcdGlmIChtdWx0aXNlbGVjdCkge1xuXHRcdFx0XHRcdGNob29zZUl0ZW1zKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2FuY2VsSXRlbSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGlmICghYmxvY2tMaXN0U2hvdykge1xuXHRcdFx0XHRzaG93TGlzdCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly9zdHlsZSBsaXN0IGVsZW1lbnRcblx0XHRsaXN0RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXQtc2VsZWN0LWxpc3RcIik7XG5cblx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblx0XHRcdGlucHV0LnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXHRcdFx0aW5wdXQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuXHRcdH0pO1xuXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRfdGhpczUzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGNhbmNlbEl0ZW0pO1xuXHRcdH0sIDEwKTtcblxuXHRcdHJldHVybiBpbnB1dDtcblx0fSxcblxuXHQvL2F1dG9jb21wbGV0ZVxuXHRhdXRvY29tcGxldGU6IGZ1bmN0aW9uIGF1dG9jb21wbGV0ZShjZWxsLCBvblJlbmRlcmVkLCBzdWNjZXNzLCBjYW5jZWwsIGVkaXRvclBhcmFtcykge1xuXHRcdHZhciBfdGhpczU0ID0gdGhpcztcblxuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHQgICAgY2VsbEVsID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdFx0ICAgIGluaXRpYWxWYWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0XHQgICAgdmVydE5hdiA9IGVkaXRvclBhcmFtcy52ZXJ0aWNhbE5hdmlnYXRpb24gfHwgXCJlZGl0b3JcIixcblx0XHQgICAgaW5pdGlhbERpc3BsYXlWYWx1ZSA9IHR5cGVvZiBpbml0aWFsVmFsdWUgIT09IFwidW5kZWZpbmVkXCIgfHwgaW5pdGlhbFZhbHVlID09PSBudWxsID8gaW5pdGlhbFZhbHVlIDogdHlwZW9mIGVkaXRvclBhcmFtcy5kZWZhdWx0VmFsdWUgIT09IFwidW5kZWZpbmVkXCIgPyBlZGl0b3JQYXJhbXMuZGVmYXVsdFZhbHVlIDogXCJcIixcblx0XHQgICAgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksXG5cdFx0ICAgIGxpc3RFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0ICAgIGFsbEl0ZW1zID0gW10sXG5cdFx0ICAgIGRpc3BsYXlJdGVtcyA9IFtdLFxuXHRcdCAgICB2YWx1ZXMgPSBbXSxcblx0XHQgICAgY3VycmVudEl0ZW0gPSBmYWxzZSxcblx0XHQgICAgYmx1cmFibGUgPSB0cnVlLFxuXHRcdCAgICB1bmlxdWVDb2x1bW5WYWx1ZXMgPSBmYWxzZTtcblxuXHRcdC8vc3R5bGUgaW5wdXRcblx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwic2VhcmNoXCIpO1xuXG5cdFx0aW5wdXQuc3R5bGUucGFkZGluZyA9IFwiNHB4XCI7XG5cdFx0aW5wdXQuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcblx0XHRpbnB1dC5zdHlsZS5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblxuXHRcdGlmIChlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgX3R5cGVvZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdGZvciAodmFyIGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0aWYgKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpIHtcblx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL3N0eWxlIGxpc3QgZWxlbWVudFxuXHRcdGxpc3RFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWVkaXQtc2VsZWN0LWxpc3RcIik7XG5cblx0XHRsaXN0RWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Ymx1cmFibGUgPSBmYWxzZTtcblxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGJsdXJhYmxlID0gdHJ1ZTtcblx0XHRcdH0sIDEwKTtcblx0XHR9KTtcblxuXHRcdGZ1bmN0aW9uIGdlblVuaXF1ZUNvbHVtblZhbHVlcygpIHtcblx0XHRcdGlmIChlZGl0b3JQYXJhbXMudmFsdWVzID09PSB0cnVlKSB7XG5cdFx0XHRcdHVuaXF1ZUNvbHVtblZhbHVlcyA9IGdldFVuaXF1ZUNvbHVtblZhbHVlcygpO1xuXHRcdFx0fSBlbHNlIGlmICh0eXBlb2YgZWRpdG9yUGFyYW1zLnZhbHVlcyA9PT0gXCJzdHJpbmdcIikge1xuXHRcdFx0XHR1bmlxdWVDb2x1bW5WYWx1ZXMgPSBnZXRVbmlxdWVDb2x1bW5WYWx1ZXMoZWRpdG9yUGFyYW1zLnZhbHVlcyk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0VW5pcXVlQ29sdW1uVmFsdWVzKGZpZWxkKSB7XG5cdFx0XHR2YXIgb3V0cHV0ID0ge30sXG5cdFx0XHQgICAgZGF0YSA9IHNlbGYudGFibGUuZ2V0RGF0YSgpLFxuXHRcdFx0ICAgIGNvbHVtbjtcblxuXHRcdFx0aWYgKGZpZWxkKSB7XG5cdFx0XHRcdGNvbHVtbiA9IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUZpZWxkKGZpZWxkKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbHVtbiA9IGNlbGwuZ2V0Q29sdW1uKCkuX2dldFNlbGYoKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0XHRkYXRhLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRcdHZhciB2YWwgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShyb3cpO1xuXG5cdFx0XHRcdFx0aWYgKHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsICE9PSBcInVuZGVmaW5lZFwiICYmIHZhbCAhPT0gXCJcIikge1xuXHRcdFx0XHRcdFx0b3V0cHV0W3ZhbF0gPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0aWYgKGVkaXRvclBhcmFtcy5zb3J0VmFsdWVzTGlzdCkge1xuXHRcdFx0XHRcdGlmIChlZGl0b3JQYXJhbXMuc29ydFZhbHVlc0xpc3QgPT0gXCJhc2NcIikge1xuXHRcdFx0XHRcdFx0b3V0cHV0ID0gT2JqZWN0LmtleXMob3V0cHV0KS5zb3J0KCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG91dHB1dCA9IE9iamVjdC5rZXlzKG91dHB1dCkuc29ydCgpLnJldmVyc2UoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0b3V0cHV0ID0gT2JqZWN0LmtleXMob3V0cHV0KTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwidW5hYmxlIHRvIGZpbmQgbWF0Y2hpbmcgY29sdW1uIHRvIGNyZWF0ZSBhdXRvY29tcGxldGUgbG9va3VwIGxpc3Q6XCIsIGZpZWxkKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIG91dHB1dDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBmaWx0ZXJMaXN0KHRlcm0sIGludGlhbExvYWQpIHtcblx0XHRcdHZhciBtYXRjaGVzID0gW10sXG5cdFx0XHQgICAgdmFsdWVzLFxuXHRcdFx0ICAgIGl0ZW1zLFxuXHRcdFx0ICAgIHNlYXJjaEVsO1xuXG5cdFx0XHQvL2xvb2t1cCBiYXNlIHZhbHVlcyBsaXN0XG5cdFx0XHRpZiAodW5pcXVlQ29sdW1uVmFsdWVzKSB7XG5cdFx0XHRcdHZhbHVlcyA9IHVuaXF1ZUNvbHVtblZhbHVlcztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhbHVlcyA9IGVkaXRvclBhcmFtcy52YWx1ZXMgfHwgW107XG5cdFx0XHR9XG5cblx0XHRcdGlmIChlZGl0b3JQYXJhbXMuc2VhcmNoRnVuYykge1xuXHRcdFx0XHRtYXRjaGVzID0gZWRpdG9yUGFyYW1zLnNlYXJjaEZ1bmModGVybSwgdmFsdWVzKTtcblxuXHRcdFx0XHRpZiAobWF0Y2hlcyBpbnN0YW5jZW9mIFByb21pc2UpIHtcblxuXHRcdFx0XHRcdGFkZE5vdGljZSh0eXBlb2YgZWRpdG9yUGFyYW1zLnNlYXJjaGluZ1BsYWNlaG9sZGVyICE9PSBcInVuZGVmaW5lZFwiID8gZWRpdG9yUGFyYW1zLnNlYXJjaGluZ1BsYWNlaG9sZGVyIDogXCJTZWFyY2hpbmcuLi5cIik7XG5cblx0XHRcdFx0XHRtYXRjaGVzLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuXHRcdFx0XHRcdFx0ZmlsbExpc3RJZk5vdEVtcHR5KHBhcnNlSXRlbXMocmVzdWx0KSwgaW50aWFsTG9hZCk7XG5cdFx0XHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5lcnIoXCJlcnJvciBpbiBhdXRvY29tcGxldGUgc2VhcmNoIHByb21pc2U6XCIsIGVycik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZmlsbExpc3RJZk5vdEVtcHR5KHBhcnNlSXRlbXMobWF0Y2hlcyksIGludGlhbExvYWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpdGVtcyA9IHBhcnNlSXRlbXModmFsdWVzKTtcblxuXHRcdFx0XHRpZiAodGVybSA9PT0gXCJcIikge1xuXHRcdFx0XHRcdGlmIChlZGl0b3JQYXJhbXMuc2hvd0xpc3RPbkVtcHR5KSB7XG5cdFx0XHRcdFx0XHRtYXRjaGVzID0gaXRlbXM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0XHRcdGlmIChpdGVtLnZhbHVlICE9PSBudWxsIHx8IHR5cGVvZiBpdGVtLnZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChTdHJpbmcoaXRlbS52YWx1ZSkudG9Mb3dlckNhc2UoKS5pbmRleE9mKFN0cmluZyh0ZXJtKS50b0xvd2VyQ2FzZSgpKSA+IC0xIHx8IFN0cmluZyhpdGVtLnRpdGxlKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoU3RyaW5nKHRlcm0pLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRtYXRjaGVzLnB1c2goaXRlbSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZpbGxMaXN0SWZOb3RFbXB0eShtYXRjaGVzLCBpbnRpYWxMb2FkKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBhZGROb3RpY2Uobm90aWNlKSB7XG5cdFx0XHR2YXIgc2VhcmNoRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdFx0XHRjbGVhckxpc3QoKTtcblxuXHRcdFx0aWYgKG5vdGljZSAhPT0gZmFsc2UpIHtcblx0XHRcdFx0c2VhcmNoRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1lZGl0LXNlbGVjdC1saXN0LW5vdGljZVwiKTtcblx0XHRcdFx0c2VhcmNoRWwudGFiSW5kZXggPSAwO1xuXG5cdFx0XHRcdGlmIChub3RpY2UgaW5zdGFuY2VvZiBOb2RlKSB7XG5cdFx0XHRcdFx0c2VhcmNoRWwuYXBwZW5kQ2hpbGQobm90aWNlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZWFyY2hFbC5pbm5lckhUTUwgPSBub3RpY2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRsaXN0RWwuYXBwZW5kQ2hpbGQoc2VhcmNoRWwpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHBhcnNlSXRlbXMoaW5wdXRWYWx1ZXMpIHtcblx0XHRcdHZhciBpdGVtTGlzdCA9IFtdO1xuXG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheShpbnB1dFZhbHVlcykpIHtcblx0XHRcdFx0aW5wdXRWYWx1ZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcblxuXHRcdFx0XHRcdHZhciBpdGVtID0ge307XG5cblx0XHRcdFx0XHRpZiAoKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWUpKSA9PT0gXCJvYmplY3RcIikge1xuXHRcdFx0XHRcdFx0aXRlbS50aXRsZSA9IGVkaXRvclBhcmFtcy5saXN0SXRlbUZvcm1hdHRlciA/IGVkaXRvclBhcmFtcy5saXN0SXRlbUZvcm1hdHRlcih2YWx1ZS52YWx1ZSwgdmFsdWUubGFiZWwpIDogdmFsdWUubGFiZWw7XG5cdFx0XHRcdFx0XHRpdGVtLnZhbHVlID0gdmFsdWUudmFsdWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGl0ZW0udGl0bGUgPSBlZGl0b3JQYXJhbXMubGlzdEl0ZW1Gb3JtYXR0ZXIgPyBlZGl0b3JQYXJhbXMubGlzdEl0ZW1Gb3JtYXR0ZXIodmFsdWUsIHZhbHVlKSA6IHZhbHVlO1xuXHRcdFx0XHRcdFx0aXRlbS52YWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGl0ZW1MaXN0LnB1c2goaXRlbSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Zm9yICh2YXIga2V5IGluIGlucHV0VmFsdWVzKSB7XG5cdFx0XHRcdFx0dmFyIGl0ZW0gPSB7XG5cdFx0XHRcdFx0XHR0aXRsZTogZWRpdG9yUGFyYW1zLmxpc3RJdGVtRm9ybWF0dGVyID8gZWRpdG9yUGFyYW1zLmxpc3RJdGVtRm9ybWF0dGVyKGtleSwgaW5wdXRWYWx1ZXNba2V5XSkgOiBpbnB1dFZhbHVlc1trZXldLFxuXHRcdFx0XHRcdFx0dmFsdWU6IGtleVxuXHRcdFx0XHRcdH07XG5cblx0XHRcdFx0XHRpdGVtTGlzdC5wdXNoKGl0ZW0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBpdGVtTGlzdDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjbGVhckxpc3QoKSB7XG5cdFx0XHR3aGlsZSAobGlzdEVsLmZpcnN0Q2hpbGQpIHtcblx0XHRcdFx0bGlzdEVsLnJlbW92ZUNoaWxkKGxpc3RFbC5maXJzdENoaWxkKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBmaWxsTGlzdElmTm90RW1wdHkoaXRlbXMsIGludGlhbExvYWQpIHtcblx0XHRcdGlmIChpdGVtcy5sZW5ndGgpIHtcblx0XHRcdFx0ZmlsbExpc3QoaXRlbXMsIGludGlhbExvYWQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKGVkaXRvclBhcmFtcy5lbXB0eVBsYWNlaG9sZGVyKSB7XG5cdFx0XHRcdFx0YWRkTm90aWNlKGVkaXRvclBhcmFtcy5lbXB0eVBsYWNlaG9sZGVyKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGZpbGxMaXN0KGl0ZW1zLCBpbnRpYWxMb2FkKSB7XG5cdFx0XHR2YXIgY3VycmVudCA9IGZhbHNlO1xuXG5cdFx0XHRjbGVhckxpc3QoKTtcblxuXHRcdFx0ZGlzcGxheUl0ZW1zID0gaXRlbXM7XG5cblx0XHRcdGRpc3BsYXlJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRcdHZhciBlbCA9IGl0ZW0uZWxlbWVudDtcblxuXHRcdFx0XHRpZiAoIWVsKSB7XG5cdFx0XHRcdFx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZWRpdC1zZWxlY3QtbGlzdC1pdGVtXCIpO1xuXHRcdFx0XHRcdGVsLnRhYkluZGV4ID0gMDtcblx0XHRcdFx0XHRlbC5pbm5lckhUTUwgPSBpdGVtLnRpdGxlO1xuXG5cdFx0XHRcdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0XHRzZXRDdXJyZW50SXRlbShpdGVtKTtcblx0XHRcdFx0XHRcdGNob29zZUl0ZW0oKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdGJsdXJhYmxlID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRibHVyYWJsZSA9IHRydWU7XG5cdFx0XHRcdFx0XHR9LCAxMCk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRpdGVtLmVsZW1lbnQgPSBlbDtcblxuXHRcdFx0XHRcdGlmIChpbnRpYWxMb2FkICYmIGl0ZW0udmFsdWUgPT0gaW5pdGlhbFZhbHVlKSB7XG5cdFx0XHRcdFx0XHRpbnB1dC52YWx1ZSA9IGl0ZW0udGl0bGU7XG5cdFx0XHRcdFx0XHRpdGVtLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdGN1cnJlbnQgPSB0cnVlO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChpdGVtID09PSBjdXJyZW50SXRlbSkge1xuXHRcdFx0XHRcdFx0aXRlbS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG5cdFx0XHRcdFx0XHRjdXJyZW50ID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRsaXN0RWwuYXBwZW5kQ2hpbGQoZWwpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGlmICghY3VycmVudCkge1xuXHRcdFx0XHRzZXRDdXJyZW50SXRlbShmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2hvb3NlSXRlbSgpIHtcblx0XHRcdGhpZGVMaXN0KCk7XG5cblx0XHRcdGlmIChjdXJyZW50SXRlbSkge1xuXHRcdFx0XHRpZiAoaW5pdGlhbFZhbHVlICE9PSBjdXJyZW50SXRlbS52YWx1ZSkge1xuXHRcdFx0XHRcdGluaXRpYWxWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuXHRcdFx0XHRcdGlucHV0LnZhbHVlID0gY3VycmVudEl0ZW0udGl0bGU7XG5cdFx0XHRcdFx0c3VjY2VzcyhjdXJyZW50SXRlbS52YWx1ZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y2FuY2VsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChlZGl0b3JQYXJhbXMuZnJlZXRleHQpIHtcblx0XHRcdFx0XHRpbml0aWFsVmFsdWUgPSBpbnB1dC52YWx1ZTtcblx0XHRcdFx0XHRzdWNjZXNzKGlucHV0LnZhbHVlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoZWRpdG9yUGFyYW1zLmFsbG93RW1wdHkgJiYgaW5wdXQudmFsdWUgPT09IFwiXCIpIHtcblx0XHRcdFx0XHRcdGluaXRpYWxWYWx1ZSA9IGlucHV0LnZhbHVlO1xuXHRcdFx0XHRcdFx0c3VjY2VzcyhpbnB1dC52YWx1ZSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHNob3dMaXN0KCkge1xuXHRcdFx0aWYgKCFsaXN0RWwucGFyZW50Tm9kZSkge1xuXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic2hvd1wiLCBpbml0aWFsRGlzcGxheVZhbHVlKTtcblx0XHRcdFx0d2hpbGUgKGxpc3RFbC5maXJzdENoaWxkKSB7XG5cdFx0XHRcdFx0bGlzdEVsLnJlbW92ZUNoaWxkKGxpc3RFbC5maXJzdENoaWxkKTtcblx0XHRcdFx0fXZhciBvZmZzZXQgPSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxPZmZzZXQoY2VsbEVsKTtcblxuXHRcdFx0XHRsaXN0RWwuc3R5bGUubWluV2lkdGggPSBjZWxsRWwub2Zmc2V0V2lkdGggKyBcInB4XCI7XG5cblx0XHRcdFx0bGlzdEVsLnN0eWxlLnRvcCA9IG9mZnNldC50b3AgKyBjZWxsRWwub2Zmc2V0SGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0XHRsaXN0RWwuc3R5bGUubGVmdCA9IG9mZnNldC5sZWZ0ICsgXCJweFwiO1xuXHRcdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpc3RFbCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gc2V0Q3VycmVudEl0ZW0oaXRlbSwgc2hvd0lucHV0VmFsdWUpIHtcblx0XHRcdGlmIChjdXJyZW50SXRlbSAmJiBjdXJyZW50SXRlbS5lbGVtZW50KSB7XG5cdFx0XHRcdGN1cnJlbnRJdGVtLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcblx0XHRcdH1cblxuXHRcdFx0Y3VycmVudEl0ZW0gPSBpdGVtO1xuXG5cdFx0XHRpZiAoaXRlbSAmJiBpdGVtLmVsZW1lbnQpIHtcblx0XHRcdFx0aXRlbS5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpdGVtICYmIGl0ZW0uZWxlbWVudCAmJiBpdGVtLmVsZW1lbnQuc2Nyb2xsSW50b1ZpZXcpIHtcblx0XHRcdFx0aXRlbS5lbGVtZW50LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnLCBibG9jazogJ25lYXJlc3QnLCBpbmxpbmU6ICdzdGFydCcgfSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaGlkZUxpc3QoKSB7XG5cdFx0XHRpZiAobGlzdEVsLnBhcmVudE5vZGUpIHtcblx0XHRcdFx0bGlzdEVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobGlzdEVsKTtcblx0XHRcdH1cblxuXHRcdFx0cmVtb3ZlU2Nyb2xsTGlzdGVuZXIoKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjYW5jZWxJdGVtKCkge1xuXHRcdFx0aGlkZUxpc3QoKTtcblx0XHRcdGNhbmNlbCgpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJlbW92ZVNjcm9sbExpc3RlbmVyKCkge1xuXHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjYW5jZWxJdGVtKTtcblx0XHR9XG5cblx0XHQvL2FsbG93IGtleSBiYXNlZCBuYXZpZ2F0aW9uXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHZhciBpbmRleDtcblxuXHRcdFx0c3dpdGNoIChlLmtleUNvZGUpIHtcblx0XHRcdFx0Y2FzZSAzODpcblx0XHRcdFx0XHQvL3VwIGFycm93XG5cdFx0XHRcdFx0aW5kZXggPSBkaXNwbGF5SXRlbXMuaW5kZXhPZihjdXJyZW50SXRlbSk7XG5cblx0XHRcdFx0XHRpZiAodmVydE5hdiA9PSBcImVkaXRvclwiIHx8IHZlcnROYXYgPT0gXCJoeWJyaWRcIiAmJiBpbmRleCkge1xuXHRcdFx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0XHRcdGlmIChpbmRleCA+IDApIHtcblx0XHRcdFx0XHRcdFx0c2V0Q3VycmVudEl0ZW0oZGlzcGxheUl0ZW1zW2luZGV4IC0gMV0pO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0c2V0Q3VycmVudEl0ZW0oZmFsc2UpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDQwOlxuXHRcdFx0XHRcdC8vZG93biBhcnJvd1xuXG5cdFx0XHRcdFx0aW5kZXggPSBkaXNwbGF5SXRlbXMuaW5kZXhPZihjdXJyZW50SXRlbSk7XG5cblx0XHRcdFx0XHRpZiAodmVydE5hdiA9PSBcImVkaXRvclwiIHx8IHZlcnROYXYgPT0gXCJoeWJyaWRcIiAmJiBpbmRleCA8IGRpc3BsYXlJdGVtcy5sZW5ndGggLSAxKSB7XG5cblx0XHRcdFx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRcdFx0XHRpZiAoaW5kZXggPCBkaXNwbGF5SXRlbXMubGVuZ3RoIC0gMSkge1xuXHRcdFx0XHRcdFx0XHRpZiAoaW5kZXggPT0gLTEpIHtcblx0XHRcdFx0XHRcdFx0XHRzZXRDdXJyZW50SXRlbShkaXNwbGF5SXRlbXNbMF0pO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHNldEN1cnJlbnRJdGVtKGRpc3BsYXlJdGVtc1tpbmRleCArIDFdKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDM3OiAvL2xlZnQgYXJyb3dcblx0XHRcdFx0Y2FzZSAzOTpcblx0XHRcdFx0XHQvL3JpZ2h0IGFycm93XG5cdFx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdC8vIGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDEzOlxuXHRcdFx0XHRcdC8vZW50ZXJcblx0XHRcdFx0XHRjaG9vc2VJdGVtKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAyNzpcblx0XHRcdFx0XHQvL2VzY2FwZVxuXHRcdFx0XHRcdGNhbmNlbEl0ZW0oKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDM2OiAvL2hvbWVcblx0XHRcdFx0Y2FzZSAzNTpcblx0XHRcdFx0XHQvL2VuZFxuXHRcdFx0XHRcdC8vcHJldmVudCB0YWJsZSBuYXZpZ2F0aW9uIHdoaWxlIHVzaW5nIGlucHV0IGVsZW1lbnRcblx0XHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGZ1bmN0aW9uIChlKSB7XG5cblx0XHRcdHN3aXRjaCAoZS5rZXlDb2RlKSB7XG5cdFx0XHRcdGNhc2UgMzg6IC8vdXAgYXJyb3dcblx0XHRcdFx0Y2FzZSAzNzogLy9sZWZ0IGFycm93XG5cdFx0XHRcdGNhc2UgMzk6IC8vdXAgYXJyb3dcblx0XHRcdFx0Y2FzZSA0MDogLy9yaWdodCBhcnJvd1xuXHRcdFx0XHRjYXNlIDEzOiAvL2VudGVyXG5cdFx0XHRcdGNhc2UgMjc6XG5cdFx0XHRcdFx0Ly9lc2NhcGVcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdGZpbHRlckxpc3QoaW5wdXQudmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcInNlYXJjaFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0ZmlsdGVyTGlzdChpbnB1dC52YWx1ZSk7XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGJsdXJhYmxlKSB7XG5cdFx0XHRcdGNob29zZUl0ZW0oKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dmFyIHZhbHVlID0gaW5pdGlhbERpc3BsYXlWYWx1ZTtcblx0XHRcdGdlblVuaXF1ZUNvbHVtblZhbHVlcygpO1xuXHRcdFx0c2hvd0xpc3QoKTtcblx0XHRcdGlucHV0LnZhbHVlID0gdmFsdWU7XG5cdFx0XHRmaWx0ZXJMaXN0KHZhbHVlLCB0cnVlKTtcblx0XHR9KTtcblxuXHRcdG9uUmVuZGVyZWQoZnVuY3Rpb24gKCkge1xuXHRcdFx0aW5wdXQuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XG5cdFx0XHRpbnB1dC5mb2N1cyh7IHByZXZlbnRTY3JvbGw6IHRydWUgfSk7XG5cdFx0fSk7XG5cblx0XHRpZiAoZWRpdG9yUGFyYW1zLm1hc2spIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5lZGl0Lm1hc2tJbnB1dChpbnB1dCwgZWRpdG9yUGFyYW1zKTtcblx0XHR9XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdF90aGlzNTQudGFibGUucm93TWFuYWdlci5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgY2FuY2VsSXRlbSk7XG5cdFx0fSwgMTApO1xuXG5cdFx0Z2VuVW5pcXVlQ29sdW1uVmFsdWVzKCk7XG5cdFx0aW5wdXQudmFsdWUgPSBpbml0aWFsRGlzcGxheVZhbHVlO1xuXHRcdGZpbHRlckxpc3QoaW5pdGlhbERpc3BsYXlWYWx1ZSwgdHJ1ZSk7XG5cblx0XHRyZXR1cm4gaW5wdXQ7XG5cdH0sXG5cblx0Ly9zdGFyIHJhdGluZ1xuXHRzdGFyOiBmdW5jdGlvbiBzdGFyKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKSB7XG5cdFx0dmFyIHNlbGYgPSB0aGlzLFxuXHRcdCAgICBlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdFx0ICAgIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRcdCAgICBtYXhTdGFycyA9IGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzdmdcIikubGVuZ3RoIHx8IDUsXG5cdFx0ICAgIHNpemUgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3ZnXCIpWzBdID8gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInN2Z1wiKVswXS5nZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiKSA6IDE0LFxuXHRcdCAgICBzdGFycyA9IFtdLFxuXHRcdCAgICBzdGFyc0hvbGRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0ICAgIHN0YXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgXCJzdmdcIik7XG5cblx0XHQvL2NoYW5nZSBzdGFyIHR5cGVcblx0XHRmdW5jdGlvbiBzdGFyQ2hhbmdlKHZhbCkge1xuXHRcdFx0c3RhcnMuZm9yRWFjaChmdW5jdGlvbiAoc3RhciwgaSkge1xuXHRcdFx0XHRpZiAoaSA8IHZhbCkge1xuXHRcdFx0XHRcdGlmIChzZWxmLnRhYmxlLmJyb3dzZXIgPT0gXCJpZVwiKSB7XG5cdFx0XHRcdFx0XHRzdGFyLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwidGFidWxhdG9yLXN0YXItYWN0aXZlXCIpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzdGFyLmNsYXNzTGlzdC5yZXBsYWNlKFwidGFidWxhdG9yLXN0YXItaW5hY3RpdmVcIiwgXCJ0YWJ1bGF0b3Itc3Rhci1hY3RpdmVcIik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0c3Rhci5pbm5lckhUTUwgPSAnPHBvbHlnb24gZmlsbD1cIiM0ODhDRTlcIiBzdHJva2U9XCIjMDE0QUFFXCIgc3Ryb2tlLXdpZHRoPVwiMzcuNjE1MlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS1taXRlcmxpbWl0PVwiMTBcIiBwb2ludHM9XCIyNTkuMjE2LDI5Ljk0MiAzMzAuMjcsMTczLjkxOSA0ODkuMTYsMTk3LjAwNyAzNzQuMTg1LDMwOS4wOCA0MDEuMzMsNDY3LjMxIDI1OS4yMTYsMzkyLjYxMiAxMTcuMTA0LDQ2Ny4zMSAxNDQuMjUsMzA5LjA4IDI5LjI3NCwxOTcuMDA3IDE4OC4xNjUsMTczLjkxOSBcIi8+Jztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoc2VsZi50YWJsZS5icm93c2VyID09IFwiaWVcIikge1xuXHRcdFx0XHRcdFx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInRhYnVsYXRvci1zdGFyLWluYWN0aXZlXCIpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzdGFyLmNsYXNzTGlzdC5yZXBsYWNlKFwidGFidWxhdG9yLXN0YXItYWN0aXZlXCIsIFwidGFidWxhdG9yLXN0YXItaW5hY3RpdmVcIik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0c3Rhci5pbm5lckhUTUwgPSAnPHBvbHlnb24gZmlsbD1cIiMwMTAxNTVcIiBzdHJva2U9XCIjNjg2ODY4XCIgc3Ryb2tlLXdpZHRoPVwiMzcuNjE1MlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZS1taXRlcmxpbWl0PVwiMTBcIiBwb2ludHM9XCIyNTkuMjE2LDI5Ljk0MiAzMzAuMjcsMTczLjkxOSA0ODkuMTYsMTk3LjAwNyAzNzQuMTg1LDMwOS4wOCA0MDEuMzMsNDY3LjMxIDI1OS4yMTYsMzkyLjYxMiAxMTcuMTA0LDQ2Ny4zMSAxNDQuMjUsMzA5LjA4IDI5LjI3NCwxOTcuMDA3IDE4OC4xNjUsMTczLjkxOSBcIi8+Jztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly9idWlsZCBzdGFyc1xuXHRcdGZ1bmN0aW9uIGJ1aWxkU3RhcihpKSB7XG5cblx0XHRcdHZhciBzdGFySG9sZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0XHR2YXIgbmV4dFN0YXIgPSBzdGFyLmNsb25lTm9kZSh0cnVlKTtcblxuXHRcdFx0c3RhcnMucHVzaChuZXh0U3Rhcik7XG5cblx0XHRcdHN0YXJIb2xkZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0c3RhckNoYW5nZShpKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRzdGFySG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRzdGFySG9sZGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRzdWNjZXNzKGkpO1xuXHRcdFx0XHRlbGVtZW50LmJsdXIoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRzdGFySG9sZGVyLmFwcGVuZENoaWxkKG5leHRTdGFyKTtcblx0XHRcdHN0YXJzSG9sZGVyLmFwcGVuZENoaWxkKHN0YXJIb2xkZXIpO1xuXHRcdH1cblxuXHRcdC8vaGFuZGxlIGtleWJvYXJkIG5hdmlnYXRpb24gdmFsdWUgY2hhbmdlXG5cdFx0ZnVuY3Rpb24gY2hhbmdlVmFsdWUodmFsKSB7XG5cdFx0XHR2YWx1ZSA9IHZhbDtcblx0XHRcdHN0YXJDaGFuZ2UodmFsKTtcblx0XHR9XG5cblx0XHQvL3N0eWxlIGNlbGxcblx0XHRlbGVtZW50LnN0eWxlLndoaXRlU3BhY2UgPSBcIm5vd3JhcFwiO1xuXHRcdGVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuXHRcdGVsZW1lbnQuc3R5bGUudGV4dE92ZXJmbG93ID0gXCJlbGxpcHNpc1wiO1xuXG5cdFx0Ly9zdHlsZSBob2xkaW5nIGVsZW1lbnRcblx0XHRzdGFyc0hvbGRlci5zdHlsZS52ZXJ0aWNhbEFsaWduID0gXCJtaWRkbGVcIjtcblx0XHRzdGFyc0hvbGRlci5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0XHRzdGFyc0hvbGRlci5zdHlsZS5wYWRkaW5nID0gXCI0cHhcIjtcblxuXHRcdC8vc3R5bGUgc3RhclxuXHRcdHN0YXIuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgc2l6ZSk7XG5cdFx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgc2l6ZSk7XG5cdFx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIFwiMCAwIDUxMiA1MTJcIik7XG5cdFx0c3Rhci5zZXRBdHRyaWJ1dGUoXCJ4bWw6c3BhY2VcIiwgXCJwcmVzZXJ2ZVwiKTtcblx0XHRzdGFyLnN0eWxlLnBhZGRpbmcgPSBcIjAgMXB4XCI7XG5cblx0XHRpZiAoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzICYmIF90eXBlb2YoZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSA9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzKSB7XG5cdFx0XHRcdGlmIChrZXkuY2hhckF0KDApID09IFwiK1wiKSB7XG5cdFx0XHRcdFx0a2V5ID0ga2V5LnNsaWNlKDEpO1xuXHRcdFx0XHRcdHN0YXJzSG9sZGVyLnNldEF0dHJpYnV0ZShrZXksIHN0YXJzSG9sZGVyLmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c3RhcnNIb2xkZXIuc2V0QXR0cmlidXRlKGtleSwgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW2tleV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9jcmVhdGUgY29ycmVjdCBudW1iZXIgb2Ygc3RhcnNcblx0XHRmb3IgKHZhciBpID0gMTsgaSA8PSBtYXhTdGFyczsgaSsrKSB7XG5cdFx0XHRidWlsZFN0YXIoaSk7XG5cdFx0fVxuXG5cdFx0Ly9lbnN1cmUgdmFsdWUgZG9lcyBub3QgZXhjZWVkIG51bWJlciBvZiBzdGFyc1xuXHRcdHZhbHVlID0gTWF0aC5taW4ocGFyc2VJbnQodmFsdWUpLCBtYXhTdGFycyk7XG5cblx0XHQvLyBzZXQgaW5pdGlhbCBzdHlsaW5nIG9mIHN0YXJzXG5cdFx0c3RhckNoYW5nZSh2YWx1ZSk7XG5cblx0XHRzdGFyc0hvbGRlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzdGFyQ2hhbmdlKDApO1xuXHRcdH0pO1xuXG5cdFx0c3RhcnNIb2xkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzdWNjZXNzKDApO1xuXHRcdH0pO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y2FuY2VsKCk7XG5cdFx0fSk7XG5cblx0XHQvL2FsbG93IGtleSBiYXNlZCBuYXZpZ2F0aW9uXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c3dpdGNoIChlLmtleUNvZGUpIHtcblx0XHRcdFx0Y2FzZSAzOTpcblx0XHRcdFx0XHQvL3JpZ2h0IGFycm93XG5cdFx0XHRcdFx0Y2hhbmdlVmFsdWUodmFsdWUgKyAxKTtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDM3OlxuXHRcdFx0XHRcdC8vbGVmdCBhcnJvd1xuXHRcdFx0XHRcdGNoYW5nZVZhbHVlKHZhbHVlIC0gMSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAxMzpcblx0XHRcdFx0XHQvL2VudGVyXG5cdFx0XHRcdFx0c3VjY2Vzcyh2YWx1ZSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAyNzpcblx0XHRcdFx0XHQvL2VzY2FwZVxuXHRcdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHN0YXJzSG9sZGVyO1xuXHR9LFxuXG5cdC8vZHJhZ2dhYmxlIHByb2dyZXNzIGJhclxuXHRwcm9ncmVzczogZnVuY3Rpb24gcHJvZ3Jlc3MoY2VsbCwgb25SZW5kZXJlZCwgc3VjY2VzcywgY2FuY2VsLCBlZGl0b3JQYXJhbXMpIHtcblx0XHR2YXIgZWxlbWVudCA9IGNlbGwuZ2V0RWxlbWVudCgpLFxuXHRcdCAgICBtYXggPSB0eXBlb2YgZWRpdG9yUGFyYW1zLm1heCA9PT0gXCJ1bmRlZmluZWRcIiA/IGVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJkaXZcIilbMF0uZ2V0QXR0cmlidXRlKFwibWF4XCIpIHx8IDEwMCA6IGVkaXRvclBhcmFtcy5tYXgsXG5cdFx0ICAgIG1pbiA9IHR5cGVvZiBlZGl0b3JQYXJhbXMubWluID09PSBcInVuZGVmaW5lZFwiID8gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImRpdlwiKVswXS5nZXRBdHRyaWJ1dGUoXCJtaW5cIikgfHwgMCA6IGVkaXRvclBhcmFtcy5taW4sXG5cdFx0ICAgIHBlcmNlbnQgPSAobWF4IC0gbWluKSAvIDEwMCxcblx0XHQgICAgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCkgfHwgMCxcblx0XHQgICAgaGFuZGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0XHQgICAgYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSxcblx0XHQgICAgbW91c2VEcmFnLFxuXHRcdCAgICBtb3VzZURyYWdXaWR0aDtcblxuXHRcdC8vc2V0IG5ldyB2YWx1ZVxuXHRcdGZ1bmN0aW9uIHVwZGF0ZVZhbHVlKCkge1xuXHRcdFx0dmFyIHN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCwgbnVsbCk7XG5cblx0XHRcdHZhciBjYWxjVmFsID0gcGVyY2VudCAqIE1hdGgucm91bmQoYmFyLm9mZnNldFdpZHRoIC8gKChlbGVtZW50LmNsaWVudFdpZHRoIC0gcGFyc2VJbnQoc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcInBhZGRpbmctbGVmdFwiKSkgLSBwYXJzZUludChzdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKFwicGFkZGluZy1yaWdodFwiKSkpIC8gMTAwKSkgKyBtaW47XG5cdFx0XHRzdWNjZXNzKGNhbGNWYWwpO1xuXHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbm93XCIsIGNhbGNWYWwpO1xuXHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblx0XHR9XG5cblx0XHQvL3N0eWxlIGhhbmRsZVxuXHRcdGhhbmRsZS5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblx0XHRoYW5kbGUuc3R5bGUucmlnaHQgPSBcIjBcIjtcblx0XHRoYW5kbGUuc3R5bGUudG9wID0gXCIwXCI7XG5cdFx0aGFuZGxlLnN0eWxlLmJvdHRvbSA9IFwiMFwiO1xuXHRcdGhhbmRsZS5zdHlsZS53aWR0aCA9IFwiNXB4XCI7XG5cdFx0aGFuZGxlLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJvZ3Jlc3MtaGFuZGxlXCIpO1xuXG5cdFx0Ly9zdHlsZSBiYXJcblx0XHRiYXIuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XG5cdFx0YmFyLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiO1xuXHRcdC8vIGJhci5zdHlsZS50b3AgPSBcIjhweFwiO1xuXHRcdC8vIGJhci5zdHlsZS5ib3R0b20gPSBcIjhweFwiO1xuXHRcdC8vIGJhci5zdHlsZS5sZWZ0ID0gXCI0cHhcIjtcblx0XHQvLyBiYXIuc3R5bGUubWFyZ2luUmlnaHQgPSBcIjRweFwiO1xuXHRcdGJhci5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblx0XHRiYXIuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjNDg4Q0U5XCI7XG5cdFx0YmFyLnN0eWxlLm1heFdpZHRoID0gXCIxMDAlXCI7XG5cdFx0YmFyLnN0eWxlLm1pbldpZHRoID0gXCIwJVwiO1xuXG5cdFx0aWYgKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcyAmJiBfdHlwZW9mKGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcykgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0Zm9yICh2YXIga2V5IGluIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlcykge1xuXHRcdFx0XHRpZiAoa2V5LmNoYXJBdCgwKSA9PSBcIitcIikge1xuXHRcdFx0XHRcdGtleSA9IGtleS5zbGljZSgxKTtcblx0XHRcdFx0XHRiYXIuc2V0QXR0cmlidXRlKGtleSwgYmFyLmdldEF0dHJpYnV0ZShrZXkpICsgZWRpdG9yUGFyYW1zLmVsZW1lbnRBdHRyaWJ1dGVzW1wiK1wiICsga2V5XSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YmFyLnNldEF0dHJpYnV0ZShrZXksIGVkaXRvclBhcmFtcy5lbGVtZW50QXR0cmlidXRlc1trZXldKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vc3R5bGUgY2VsbFxuXHRcdGVsZW1lbnQuc3R5bGUucGFkZGluZyA9IFwiNHB4IDRweFwiO1xuXG5cdFx0Ly9tYWtlIHN1cmUgdmFsdWUgaXMgaW4gcmFuZ2Vcblx0XHR2YWx1ZSA9IE1hdGgubWluKHBhcnNlRmxvYXQodmFsdWUpLCBtYXgpO1xuXHRcdHZhbHVlID0gTWF0aC5tYXgocGFyc2VGbG9hdCh2YWx1ZSksIG1pbik7XG5cblx0XHQvL3dvcmtvdXQgcGVyY2VudGFnZVxuXHRcdHZhbHVlID0gTWF0aC5yb3VuZCgodmFsdWUgLSBtaW4pIC8gcGVyY2VudCk7XG5cdFx0Ly8gYmFyLnN0eWxlLnJpZ2h0ID0gdmFsdWUgKyBcIiVcIjtcblx0XHRiYXIuc3R5bGUud2lkdGggPSB2YWx1ZSArIFwiJVwiO1xuXG5cdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbWluXCIsIG1pbik7XG5cdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbWF4XCIsIG1heCk7XG5cblx0XHRiYXIuYXBwZW5kQ2hpbGQoaGFuZGxlKTtcblxuXHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRtb3VzZURyYWcgPSBlLnNjcmVlblg7XG5cdFx0XHRtb3VzZURyYWdXaWR0aCA9IGJhci5vZmZzZXRXaWR0aDtcblx0XHR9KTtcblxuXHRcdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGhhbmRsZS5zdHlsZS5jdXJzb3IgPSBcImV3LXJlc2l6ZVwiO1xuXHRcdH0pO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRpZiAobW91c2VEcmFnKSB7XG5cdFx0XHRcdGJhci5zdHlsZS53aWR0aCA9IG1vdXNlRHJhZ1dpZHRoICsgZS5zY3JlZW5YIC0gbW91c2VEcmFnICsgXCJweFwiO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKG1vdXNlRHJhZykge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRcdG1vdXNlRHJhZyA9IGZhbHNlO1xuXHRcdFx0XHRtb3VzZURyYWdXaWR0aCA9IGZhbHNlO1xuXG5cdFx0XHRcdHVwZGF0ZVZhbHVlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvL2FsbG93IGtleSBiYXNlZCBuYXZpZ2F0aW9uXG5cdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c3dpdGNoIChlLmtleUNvZGUpIHtcblx0XHRcdFx0Y2FzZSAzOTpcblx0XHRcdFx0XHQvL3JpZ2h0IGFycm93XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGJhci5zdHlsZS53aWR0aCA9IGJhci5jbGllbnRXaWR0aCArIGVsZW1lbnQuY2xpZW50V2lkdGggLyAxMDAgKyBcInB4XCI7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAzNzpcblx0XHRcdFx0XHQvL2xlZnQgYXJyb3dcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0YmFyLnN0eWxlLndpZHRoID0gYmFyLmNsaWVudFdpZHRoIC0gZWxlbWVudC5jbGllbnRXaWR0aCAvIDEwMCArIFwicHhcIjtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIDk6IC8vdGFiXG5cdFx0XHRcdGNhc2UgMTM6XG5cdFx0XHRcdFx0Ly9lbnRlclxuXHRcdFx0XHRcdHVwZGF0ZVZhbHVlKCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSAyNzpcblx0XHRcdFx0XHQvL2VzY2FwZVxuXHRcdFx0XHRcdGNhbmNlbCgpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGNhbmNlbCgpO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGJhcjtcblx0fSxcblxuXHQvL2NoZWNrYm94XG5cdHRpY2tDcm9zczogZnVuY3Rpb24gdGlja0Nyb3NzKGNlbGwsIG9uUmVuZGVyZWQsIHN1Y2Nlc3MsIGNhbmNlbCwgZWRpdG9yUGFyYW1zKSB7XG5cdFx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRcdCAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0XHQgICAgdHJpc3RhdGUgPSBlZGl0b3JQYXJhbXMudHJpc3RhdGUsXG5cdFx0ICAgIGluZGV0ZXJtVmFsdWUgPSB0eXBlb2YgZWRpdG9yUGFyYW1zLmluZGV0ZXJtaW5hdGVWYWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiA/IG51bGwgOiBlZGl0b3JQYXJhbXMuaW5kZXRlcm1pbmF0ZVZhbHVlLFxuXHRcdCAgICBpbmRldGVybVN0YXRlID0gZmFsc2U7XG5cblx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiY2hlY2tib3hcIik7XG5cdFx0aW5wdXQuc3R5bGUubWFyZ2luVG9wID0gXCI1cHhcIjtcblx0XHRpbnB1dC5zdHlsZS5ib3hTaXppbmcgPSBcImJvcmRlci1ib3hcIjtcblxuXHRcdGlmIChlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMgJiYgX3R5cGVvZihlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdGZvciAodmFyIGtleSBpbiBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXMpIHtcblx0XHRcdFx0aWYgKGtleS5jaGFyQXQoMCkgPT0gXCIrXCIpIHtcblx0XHRcdFx0XHRrZXkgPSBrZXkuc2xpY2UoMSk7XG5cdFx0XHRcdFx0aW5wdXQuc2V0QXR0cmlidXRlKGtleSwgaW5wdXQuZ2V0QXR0cmlidXRlKGtleSkgKyBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNbXCIrXCIgKyBrZXldKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpbnB1dC5zZXRBdHRyaWJ1dGUoa2V5LCBlZGl0b3JQYXJhbXMuZWxlbWVudEF0dHJpYnV0ZXNba2V5XSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpbnB1dC52YWx1ZSA9IHZhbHVlO1xuXG5cdFx0aWYgKHRyaXN0YXRlICYmICh0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIgfHwgdmFsdWUgPT09IGluZGV0ZXJtVmFsdWUgfHwgdmFsdWUgPT09IFwiXCIpKSB7XG5cdFx0XHRpbmRldGVybVN0YXRlID0gdHJ1ZTtcblx0XHRcdGlucHV0LmluZGV0ZXJtaW5hdGUgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLnRhYmxlLmJyb3dzZXIgIT0gXCJmaXJlZm94XCIpIHtcblx0XHRcdC8vcHJldmVudCBibHVyIGlzc3VlIG9uIG1hYyBmaXJlZm94XG5cdFx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0aW5wdXQuZm9jdXMoeyBwcmV2ZW50U2Nyb2xsOiB0cnVlIH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aW5wdXQuY2hlY2tlZCA9IHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBcInRydWVcIiB8fCB2YWx1ZSA9PT0gXCJUcnVlXCIgfHwgdmFsdWUgPT09IDE7XG5cblx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblx0XHRcdGlucHV0LmZvY3VzKCk7XG5cdFx0fSk7XG5cblx0XHRmdW5jdGlvbiBzZXRWYWx1ZShibHVyKSB7XG5cdFx0XHRpZiAodHJpc3RhdGUpIHtcblx0XHRcdFx0aWYgKCFibHVyKSB7XG5cdFx0XHRcdFx0aWYgKGlucHV0LmNoZWNrZWQgJiYgIWluZGV0ZXJtU3RhdGUpIHtcblx0XHRcdFx0XHRcdGlucHV0LmNoZWNrZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGlucHV0LmluZGV0ZXJtaW5hdGUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0aW5kZXRlcm1TdGF0ZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRyZXR1cm4gaW5kZXRlcm1WYWx1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aW5kZXRlcm1TdGF0ZSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGlucHV0LmNoZWNrZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChpbmRldGVybVN0YXRlKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gaW5kZXRlcm1WYWx1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGlucHV0LmNoZWNrZWQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gaW5wdXQuY2hlY2tlZDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gYmx1clxuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHN1Y2Nlc3Moc2V0VmFsdWUoKSk7XG5cdFx0fSk7XG5cblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c3VjY2VzcyhzZXRWYWx1ZSh0cnVlKSk7XG5cdFx0fSk7XG5cblx0XHQvL3N1Ym1pdCBuZXcgdmFsdWUgb24gZW50ZXJcblx0XHRpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGUua2V5Q29kZSA9PSAxMykge1xuXHRcdFx0XHRzdWNjZXNzKHNldFZhbHVlKCkpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGUua2V5Q29kZSA9PSAyNykge1xuXHRcdFx0XHRjYW5jZWwoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBpbnB1dDtcblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImVkaXRcIiwgRWRpdCk7XG5cbnZhciBFeHBvcnRSb3cgPSBmdW5jdGlvbiBFeHBvcnRSb3codHlwZSwgY29sdW1ucywgY29tcG9uZW50LCBpbmRlbnQpIHtcblx0dGhpcy50eXBlID0gdHlwZTtcblx0dGhpcy5jb2x1bW5zID0gY29sdW1ucztcblx0dGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQgfHwgZmFsc2U7XG5cdHRoaXMuaW5kZW50ID0gaW5kZW50IHx8IDA7XG59O1xuXG52YXIgRXhwb3J0Q29sdW1uID0gZnVuY3Rpb24gRXhwb3J0Q29sdW1uKHZhbHVlLCBjb21wb25lbnQsIHdpZHRoLCBoZWlnaHQsIGRlcHRoKSB7XG5cdHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0dGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQgfHwgZmFsc2U7XG5cdHRoaXMud2lkdGggPSB3aWR0aDtcblx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdHRoaXMuZGVwdGggPSBkZXB0aDtcbn07XG5cbnZhciBFeHBvcnQgPSBmdW5jdGlvbiBFeHBvcnQodGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLmNvbmZpZyA9IHt9O1xuXHR0aGlzLmNsb25lVGFibGVTdHlsZSA9IHRydWU7XG5cdHRoaXMuY29sVmlzUHJvcCA9IFwiXCI7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmdlbmVyYXRlRXhwb3J0TGlzdCA9IGZ1bmN0aW9uIChjb25maWcsIHN0eWxlLCByYW5nZSwgY29sVmlzUHJvcCkge1xuXHR0aGlzLmNsb25lVGFibGVTdHlsZSA9IHN0eWxlO1xuXHR0aGlzLmNvbmZpZyA9IGNvbmZpZyB8fCB7fTtcblx0dGhpcy5jb2xWaXNQcm9wID0gY29sVmlzUHJvcDtcblxuXHR2YXIgaGVhZGVycyA9IHRoaXMuY29uZmlnLmNvbHVtbkhlYWRlcnMgIT09IGZhbHNlID8gdGhpcy5oZWFkZXJzVG9FeHBvcnRSb3dzKHRoaXMuZ2VuZXJhdGVDb2x1bW5Hcm91cEhlYWRlcnMoKSkgOiBbXTtcblx0dmFyIGJvZHkgPSB0aGlzLmJvZHlUb0V4cG9ydFJvd3ModGhpcy5yb3dMb29rdXAocmFuZ2UpKTtcblxuXHRyZXR1cm4gaGVhZGVycy5jb25jYXQoYm9keSk7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmdlbmVyZWF0ZVRhYmxlID0gZnVuY3Rpb24gKGNvbmZpZywgc3R5bGUsIHJhbmdlLCBjb2xWaXNQcm9wKSB7XG5cdHZhciBsaXN0ID0gdGhpcy5nZW5lcmF0ZUV4cG9ydExpc3QoY29uZmlnLCBzdHlsZSwgcmFuZ2UsIGNvbFZpc1Byb3ApO1xuXG5cdHJldHVybiB0aGlzLmdlbmVyZWF0ZVRhYmxlRWxlbWVudChsaXN0KTtcbn07XG5cbkV4cG9ydC5wcm90b3R5cGUucm93TG9va3VwID0gZnVuY3Rpb24gKHJhbmdlKSB7XG5cdHZhciBfdGhpczU1ID0gdGhpcztcblxuXHR2YXIgcm93cyA9IFtdO1xuXG5cdGlmICh0eXBlb2YgcmFuZ2UgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0cmFuZ2UuY2FsbCh0aGlzLnRhYmxlKS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdHJvdyA9IF90aGlzNTUudGFibGUucm93TWFuYWdlci5maW5kUm93KHJvdyk7XG5cblx0XHRcdGlmIChyb3cpIHtcblx0XHRcdFx0cm93cy5wdXNoKHJvdyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0c3dpdGNoIChyYW5nZSkge1xuXHRcdFx0Y2FzZSB0cnVlOlxuXHRcdFx0Y2FzZSBcInZpc2libGVcIjpcblx0XHRcdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5nZXRWaXNpYmxlUm93cyh0cnVlKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJhbGxcIjpcblx0XHRcdFx0cm93cyA9IHRoaXMudGFibGUucm93TWFuYWdlci5yb3dzO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInNlbGVjdGVkXCI6XG5cdFx0XHRcdHJvd3MgPSB0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LnNlbGVjdGVkUm93cztcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJhY3RpdmVcIjpcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbikge1xuXHRcdFx0XHRcdHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3ModGhpcy50YWJsZS5yb3dNYW5hZ2VyLmRpc3BsYXlSb3dzLmxlbmd0aCAtIDIpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJvd3MgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKTtcblx0XHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBPYmplY3QuYXNzaWduKFtdLCByb3dzKTtcbn07XG5cbkV4cG9ydC5wcm90b3R5cGUuZ2VuZXJhdGVDb2x1bW5Hcm91cEhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczU2ID0gdGhpcztcblxuXHR2YXIgb3V0cHV0ID0gW107XG5cblx0dmFyIGNvbHVtbnMgPSB0aGlzLmNvbmZpZy5jb2x1bW5Hcm91cHMgIT09IGZhbHNlID8gdGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnMgOiB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXg7XG5cblx0Y29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0XHR2YXIgY29sRGF0YSA9IF90aGlzNTYucHJvY2Vzc0NvbHVtbkdyb3VwKGNvbHVtbik7XG5cblx0XHRpZiAoY29sRGF0YSkge1xuXHRcdFx0b3V0cHV0LnB1c2goY29sRGF0YSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuRXhwb3J0LnByb3RvdHlwZS5wcm9jZXNzQ29sdW1uR3JvdXAgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHZhciBfdGhpczU3ID0gdGhpcztcblxuXHR2YXIgc3ViR3JvdXBzID0gY29sdW1uLmNvbHVtbnMsXG5cdCAgICBtYXhEZXB0aCA9IDAsXG5cdCAgICB0aXRsZSA9IGNvbHVtbi5kZWZpbml0aW9uW1widGl0bGVcIiArICh0aGlzLmNvbFZpc1Byb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0aGlzLmNvbFZpc1Byb3Auc2xpY2UoMSkpXSB8fCBjb2x1bW4uZGVmaW5pdGlvbi50aXRsZTtcblxuXHR2YXIgZ3JvdXBEYXRhID0ge1xuXHRcdHRpdGxlOiB0aXRsZSxcblx0XHRjb2x1bW46IGNvbHVtbixcblx0XHRkZXB0aDogMVxuXHR9O1xuXG5cdGlmIChzdWJHcm91cHMubGVuZ3RoKSB7XG5cdFx0Z3JvdXBEYXRhLnN1Ykdyb3VwcyA9IFtdO1xuXHRcdGdyb3VwRGF0YS53aWR0aCA9IDA7XG5cblx0XHRzdWJHcm91cHMuZm9yRWFjaChmdW5jdGlvbiAoc3ViR3JvdXApIHtcblx0XHRcdHZhciBzdWJHcm91cERhdGEgPSBfdGhpczU3LnByb2Nlc3NDb2x1bW5Hcm91cChzdWJHcm91cCk7XG5cblx0XHRcdGlmIChzdWJHcm91cERhdGEpIHtcblx0XHRcdFx0Z3JvdXBEYXRhLndpZHRoICs9IHN1Ykdyb3VwRGF0YS53aWR0aDtcblx0XHRcdFx0Z3JvdXBEYXRhLnN1Ykdyb3Vwcy5wdXNoKHN1Ykdyb3VwRGF0YSk7XG5cblx0XHRcdFx0aWYgKHN1Ykdyb3VwRGF0YS5kZXB0aCA+IG1heERlcHRoKSB7XG5cdFx0XHRcdFx0bWF4RGVwdGggPSBzdWJHcm91cERhdGEuZGVwdGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGdyb3VwRGF0YS5kZXB0aCArPSBtYXhEZXB0aDtcblxuXHRcdGlmICghZ3JvdXBEYXRhLndpZHRoKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLmNvbHVtblZpc0NoZWNrKGNvbHVtbikpIHtcblx0XHRcdGdyb3VwRGF0YS53aWR0aCA9IDE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZ3JvdXBEYXRhO1xufTtcblxuRXhwb3J0LnByb3RvdHlwZS5jb2x1bW5WaXNDaGVjayA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0cmV0dXJuIGNvbHVtbi5kZWZpbml0aW9uW3RoaXMuY29sVmlzUHJvcF0gIT09IGZhbHNlICYmIChjb2x1bW4udmlzaWJsZSB8fCAhY29sdW1uLnZpc2libGUgJiYgY29sdW1uLmRlZmluaXRpb25bdGhpcy5jb2xWaXNQcm9wXSk7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmhlYWRlcnNUb0V4cG9ydFJvd3MgPSBmdW5jdGlvbiAoY29sdW1ucykge1xuXHR2YXIgaGVhZGVycyA9IFtdLFxuXHQgICAgaGVhZGVyRGVwdGggPSAwLFxuXHQgICAgZXhwb3J0Um93cyA9IFtdO1xuXG5cdGZ1bmN0aW9uIHBhcnNlQ29sdW1uR3JvdXAoY29sdW1uLCBsZXZlbCkge1xuXG5cdFx0dmFyIGRlcHRoID0gaGVhZGVyRGVwdGggLSBsZXZlbDtcblxuXHRcdGlmICh0eXBlb2YgaGVhZGVyc1tsZXZlbF0gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdGhlYWRlcnNbbGV2ZWxdID0gW107XG5cdFx0fVxuXG5cdFx0Y29sdW1uLmhlaWdodCA9IGNvbHVtbi5zdWJHcm91cHMgPyAxIDogZGVwdGggLSBjb2x1bW4uZGVwdGggKyAxO1xuXG5cdFx0aGVhZGVyc1tsZXZlbF0ucHVzaChjb2x1bW4pO1xuXG5cdFx0aWYgKGNvbHVtbi5oZWlnaHQgPiAxKSB7XG5cdFx0XHRmb3IgKHZhciBfaTEwID0gMTsgX2kxMCA8IGNvbHVtbi5oZWlnaHQ7IF9pMTArKykge1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgaGVhZGVyc1tsZXZlbCArIF9pMTBdID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRcdFx0aGVhZGVyc1tsZXZlbCArIF9pMTBdID0gW107XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRoZWFkZXJzW2xldmVsICsgX2kxMF0ucHVzaChmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKGNvbHVtbi53aWR0aCA+IDEpIHtcblx0XHRcdGZvciAodmFyIF9pMTEgPSAxOyBfaTExIDwgY29sdW1uLndpZHRoOyBfaTExKyspIHtcblx0XHRcdFx0aGVhZGVyc1tsZXZlbF0ucHVzaChmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKGNvbHVtbi5zdWJHcm91cHMpIHtcblx0XHRcdGNvbHVtbi5zdWJHcm91cHMuZm9yRWFjaChmdW5jdGlvbiAoc3ViR3JvdXApIHtcblx0XHRcdFx0cGFyc2VDb2x1bW5Hcm91cChzdWJHcm91cCwgbGV2ZWwgKyAxKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdC8vY2FsY3VsYXRlIG1heGltdW0gaGVhZGVyIGRlYnRoXG5cdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5kZXB0aCA+IGhlYWRlckRlcHRoKSB7XG5cdFx0XHRoZWFkZXJEZXB0aCA9IGNvbHVtbi5kZXB0aDtcblx0XHR9XG5cdH0pO1xuXG5cdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0cGFyc2VDb2x1bW5Hcm91cChjb2x1bW4sIDApO1xuXHR9KTtcblxuXHRoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24gKGhlYWRlcikge1xuXHRcdHZhciBjb2x1bW5zID0gW107XG5cblx0XHRoZWFkZXIuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7XG5cdFx0XHRpZiAoY29sKSB7XG5cdFx0XHRcdGNvbHVtbnMucHVzaChuZXcgRXhwb3J0Q29sdW1uKGNvbC50aXRsZSwgY29sLmNvbHVtbi5nZXRDb21wb25lbnQoKSwgY29sLndpZHRoLCBjb2wuaGVpZ2h0LCBjb2wuZGVwdGgpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbHVtbnMucHVzaChudWxsKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdGV4cG9ydFJvd3MucHVzaChuZXcgRXhwb3J0Um93KFwiaGVhZGVyXCIsIGNvbHVtbnMpKTtcblx0fSk7XG5cblx0cmV0dXJuIGV4cG9ydFJvd3M7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmJvZHlUb0V4cG9ydFJvd3MgPSBmdW5jdGlvbiAocm93cykge1xuXHR2YXIgX3RoaXM1OCA9IHRoaXM7XG5cblx0dmFyIGNvbHVtbnMgPSBbXTtcblx0dmFyIGV4cG9ydFJvd3MgPSBbXTtcblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0aWYgKF90aGlzNTguY29sdW1uVmlzQ2hlY2soY29sdW1uKSkge1xuXHRcdFx0Y29sdW1ucy5wdXNoKGNvbHVtbi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fVxuXHR9KTtcblxuXHRpZiAodGhpcy5jb25maWcuY29sdW1uQ2FsY3MgIT09IGZhbHNlICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikpIHtcblx0XHRpZiAodGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnRvcEluaXRpYWxpemVkKSB7XG5cdFx0XHRyb3dzLnVuc2hpZnQodGhpcy50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLnRvcFJvdyk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5ib3RJbml0aWFsaXplZCkge1xuXHRcdFx0cm93cy5wdXNoKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5ib3RSb3cpO1xuXHRcdH1cblx0fVxuXG5cdHJvd3MgPSByb3dzLmZpbHRlcihmdW5jdGlvbiAocm93KSB7XG5cdFx0c3dpdGNoIChyb3cudHlwZSkge1xuXHRcdFx0Y2FzZSBcImdyb3VwXCI6XG5cdFx0XHRcdHJldHVybiBfdGhpczU4LmNvbmZpZy5yb3dHcm91cHMgIT09IGZhbHNlO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImNhbGNcIjpcblx0XHRcdFx0cmV0dXJuIF90aGlzNTguY29uZmlnLmNvbHVtbkNhbGNzICE9PSBmYWxzZTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJyb3dcIjpcblx0XHRcdFx0cmV0dXJuICEoX3RoaXM1OC50YWJsZS5vcHRpb25zLmRhdGFUcmVlICYmIF90aGlzNTguY29uZmlnLmRhdGFUcmVlID09PSBmYWxzZSAmJiByb3cubW9kdWxlcy5kYXRhVHJlZS5wYXJlbnQpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSk7XG5cblx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3csIGkpIHtcblx0XHR2YXIgcm93RGF0YSA9IHJvdy5nZXREYXRhKF90aGlzNTguY29sVmlzUHJvcCk7XG5cdFx0dmFyIGV4cG9ydENvbHMgPSBbXTtcblx0XHR2YXIgaW5kZW50ID0gMDtcblxuXHRcdHN3aXRjaCAocm93LnR5cGUpIHtcblx0XHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0XHRpbmRlbnQgPSByb3cubGV2ZWw7XG5cdFx0XHRcdGV4cG9ydENvbHMucHVzaChuZXcgRXhwb3J0Q29sdW1uKHJvdy5rZXksIHJvdy5nZXRDb21wb25lbnQoKSwgY29sdW1ucy5sZW5ndGgsIDEpKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJjYWxjXCI6XG5cdFx0XHRjYXNlIFwicm93XCI6XG5cdFx0XHRcdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7XG5cdFx0XHRcdFx0ZXhwb3J0Q29scy5wdXNoKG5ldyBFeHBvcnRDb2x1bW4oY29sLl9jb2x1bW4uZ2V0RmllbGRWYWx1ZShyb3dEYXRhKSwgY29sLCAxLCAxKSk7XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGlmIChfdGhpczU4LnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUgJiYgX3RoaXM1OC5jb25maWcuZGF0YVRyZWUgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0aW5kZW50ID0gcm93Lm1vZHVsZXMuZGF0YVRyZWUuaW5kZXg7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdFx0ZXhwb3J0Um93cy5wdXNoKG5ldyBFeHBvcnRSb3cocm93LnR5cGUsIGV4cG9ydENvbHMsIHJvdy5nZXRDb21wb25lbnQoKSwgaW5kZW50KSk7XG5cdH0pO1xuXG5cdHJldHVybiBleHBvcnRSb3dzO1xufTtcblxuRXhwb3J0LnByb3RvdHlwZS5nZW5lcmVhdGVUYWJsZUVsZW1lbnQgPSBmdW5jdGlvbiAobGlzdCkge1xuXHR2YXIgX3RoaXM1OSA9IHRoaXM7XG5cblx0dmFyIHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRhYmxlXCIpLFxuXHQgICAgaGVhZGVyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhlYWRcIiksXG5cdCAgICBib2R5RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGJvZHlcIiksXG5cdCAgICBzdHlsZXMgPSB0aGlzLmxvb2t1cFRhYmxlU3R5bGVzKCksXG5cdCAgICByb3dGb3JtYXR0ZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnNbXCJyb3dGb3JtYXR0ZXJcIiArICh0aGlzLmNvbFZpc1Byb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0aGlzLmNvbFZpc1Byb3Auc2xpY2UoMSkpXSxcblx0ICAgIHNldHVwID0ge307XG5cblx0c2V0dXAucm93Rm9ybWF0dGVyID0gcm93Rm9ybWF0dGVyICE9PSBudWxsID8gcm93Rm9ybWF0dGVyIDogdGhpcy50YWJsZS5vcHRpb25zLnJvd0Zvcm1hdHRlcjtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmRhdGFUcmVlICYmIHRoaXMuY29uZmlnLmRhdGFUcmVlICE9PSBmYWxzZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cdFx0c2V0dXAudHJlZUVsZW1lbnRGaWVsZCA9IHRoaXMudGFibGUubW9kdWxlcy5kYXRhVHJlZS5lbGVtZW50RmllbGQ7XG5cdH1cblxuXHQvL2Fzc2lnbiBncm91cCBoZWFkZXIgZm9ybWF0dGVyXG5cdHNldHVwLmdyb3VwSGVhZGVyID0gdGhpcy50YWJsZS5vcHRpb25zW1wiZ3JvdXBIZWFkZXJcIiArICh0aGlzLmNvbFZpc1Byb3AuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0aGlzLmNvbFZpc1Byb3Auc2xpY2UoMSkpXTtcblxuXHRpZiAoc2V0dXAuZ3JvdXBIZWFkZXIgJiYgIUFycmF5LmlzQXJyYXkoc2V0dXAuZ3JvdXBIZWFkZXIpKSB7XG5cdFx0c2V0dXAuZ3JvdXBIZWFkZXIgPSBbc2V0dXAuZ3JvdXBIZWFkZXJdO1xuXHR9XG5cblx0dGFibGUuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC10YWJsZVwiKTtcblxuXHR0aGlzLm1hcEVsZW1lbnRTdHlsZXModGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldEhlYWRlcnNFbGVtZW50KCksIGhlYWRlckVsLCBbXCJib3JkZXItdG9wXCIsIFwiYm9yZGVyLWxlZnRcIiwgXCJib3JkZXItcmlnaHRcIiwgXCJib3JkZXItYm90dG9tXCIsIFwiYmFja2dyb3VuZC1jb2xvclwiLCBcImNvbG9yXCIsIFwiZm9udC13ZWlnaHRcIiwgXCJmb250LWZhbWlseVwiLCBcImZvbnQtc2l6ZVwiXSk7XG5cblx0aWYgKGxpc3QubGVuZ3RoID4gMTAwMCkge1xuXHRcdGNvbnNvbGUud2FybihcIkl0IG1heSB0YWtlIGEgbG9uZyB0aW1lIHRvIHJlbmRlciBhbiBIVE1MIHRhYmxlIHdpdGggbW9yZSB0aGFuIDEwMDAgcm93c1wiKTtcblx0fVxuXG5cdGxpc3QuZm9yRWFjaChmdW5jdGlvbiAocm93LCBpKSB7XG5cdFx0c3dpdGNoIChyb3cudHlwZSkge1xuXHRcdFx0Y2FzZSBcImhlYWRlclwiOlxuXHRcdFx0XHRoZWFkZXJFbC5hcHBlbmRDaGlsZChfdGhpczU5LmdlbmVyZWF0ZUhlYWRlckVsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0Ym9keUVsLmFwcGVuZENoaWxkKF90aGlzNTkuZ2VuZXJlYXRlR3JvdXBFbGVtZW50KHJvdywgc2V0dXAsIHN0eWxlcykpO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcImNhbGNcIjpcblx0XHRcdFx0Ym9keUVsLmFwcGVuZENoaWxkKF90aGlzNTkuZ2VuZXJlYXRlQ2FsY0VsZW1lbnQocm93LCBzZXR1cCwgc3R5bGVzKSk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwicm93XCI6XG5cdFx0XHRcdHZhciByb3dFbCA9IF90aGlzNTkuZ2VuZXJlYXRlUm93RWxlbWVudChyb3csIHNldHVwLCBzdHlsZXMpO1xuXHRcdFx0XHRfdGhpczU5Lm1hcEVsZW1lbnRTdHlsZXMoaSAlIDIgJiYgc3R5bGVzLmV2ZW5Sb3cgPyBzdHlsZXMuZXZlblJvdyA6IHN0eWxlcy5vZGRSb3csIHJvd0VsLCBbXCJib3JkZXItdG9wXCIsIFwiYm9yZGVyLWxlZnRcIiwgXCJib3JkZXItcmlnaHRcIiwgXCJib3JkZXItYm90dG9tXCIsIFwiY29sb3JcIiwgXCJmb250LXdlaWdodFwiLCBcImZvbnQtZmFtaWx5XCIsIFwiZm9udC1zaXplXCIsIFwiYmFja2dyb3VuZC1jb2xvclwiXSk7XG5cdFx0XHRcdGJvZHlFbC5hcHBlbmRDaGlsZChyb3dFbCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSk7XG5cblx0aWYgKGhlYWRlckVsLmlubmVySFRNTCkge1xuXHRcdHRhYmxlLmFwcGVuZENoaWxkKGhlYWRlckVsKTtcblx0fVxuXG5cdHRhYmxlLmFwcGVuZENoaWxkKGJvZHlFbCk7XG5cblx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKHRoaXMudGFibGUuZWxlbWVudCwgdGFibGUsIFtcImJvcmRlci10b3BcIiwgXCJib3JkZXItbGVmdFwiLCBcImJvcmRlci1yaWdodFwiLCBcImJvcmRlci1ib3R0b21cIl0pO1xuXHRyZXR1cm4gdGFibGU7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmxvb2t1cFRhYmxlU3R5bGVzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc3R5bGVzID0ge307XG5cblx0Ly9sb29rdXAgcm93IHN0eWxlc1xuXHRpZiAodGhpcy5jbG9uZVRhYmxlU3R5bGUgJiYgd2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcblx0XHRzdHlsZXMub2RkUm93ID0gdGhpcy50YWJsZS5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFidWxhdG9yLXJvdy1vZGQ6bm90KC50YWJ1bGF0b3ItZ3JvdXApOm5vdCgudGFidWxhdG9yLWNhbGNzKVwiKTtcblx0XHRzdHlsZXMuZXZlblJvdyA9IHRoaXMudGFibGUuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhYnVsYXRvci1yb3ctZXZlbjpub3QoLnRhYnVsYXRvci1ncm91cCk6bm90KC50YWJ1bGF0b3ItY2FsY3MpXCIpO1xuXHRcdHN0eWxlcy5jYWxjUm93ID0gdGhpcy50YWJsZS5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFidWxhdG9yLXJvdy50YWJ1bGF0b3ItY2FsY3NcIik7XG5cdFx0c3R5bGVzLmZpcnN0Um93ID0gdGhpcy50YWJsZS5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFidWxhdG9yLXJvdzpub3QoLnRhYnVsYXRvci1ncm91cCk6bm90KC50YWJ1bGF0b3ItY2FsY3MpXCIpO1xuXHRcdHN0eWxlcy5maXJzdEdyb3VwID0gdGhpcy50YWJsZS5lbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0YWJ1bGF0b3ItZ3JvdXBcIilbMF07XG5cblx0XHRpZiAoc3R5bGVzLmZpcnN0Um93KSB7XG5cdFx0XHRzdHlsZXMuc3R5bGVDZWxscyA9IHN0eWxlcy5maXJzdFJvdy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwidGFidWxhdG9yLWNlbGxcIik7XG5cdFx0XHRzdHlsZXMuZmlyc3RDZWxsID0gc3R5bGVzLnN0eWxlQ2VsbHNbMF07XG5cdFx0XHRzdHlsZXMubGFzdENlbGwgPSBzdHlsZXMuc3R5bGVDZWxsc1tzdHlsZXMuc3R5bGVDZWxscy5sZW5ndGggLSAxXTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gc3R5bGVzO1xufTtcblxuRXhwb3J0LnByb3RvdHlwZS5nZW5lcmVhdGVIZWFkZXJFbGVtZW50ID0gZnVuY3Rpb24gKHJvdywgc2V0dXAsIHN0eWxlcykge1xuXHR2YXIgX3RoaXM2MCA9IHRoaXM7XG5cblx0dmFyIHJvd0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xuXG5cdHJvdy5jb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdHZhciBjZWxsRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhcIik7XG5cdFx0XHR2YXIgY2xhc3NOYW1lcyA9IGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5kZWZpbml0aW9uLmNzc0NsYXNzID8gY29sdW1uLmNvbXBvbmVudC5fY29sdW1uLmRlZmluaXRpb24uY3NzQ2xhc3Muc3BsaXQoXCIgXCIpIDogW107XG5cblx0XHRcdGNlbGxFbC5jb2xTcGFuID0gY29sdW1uLndpZHRoO1xuXHRcdFx0Y2VsbEVsLnJvd1NwYW4gPSBjb2x1bW4uaGVpZ2h0O1xuXG5cdFx0XHRjZWxsRWwuaW5uZXJIVE1MID0gY29sdW1uLnZhbHVlO1xuXG5cdFx0XHRpZiAoX3RoaXM2MC5jbG9uZVRhYmxlU3R5bGUpIHtcblx0XHRcdFx0Y2VsbEVsLnN0eWxlLmJveFNpemluZyA9IFwiYm9yZGVyLWJveFwiO1xuXHRcdFx0fVxuXG5cdFx0XHRjbGFzc05hbWVzLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xuXHRcdFx0XHRjZWxsRWwuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXHRcdFx0fSk7XG5cblx0XHRcdF90aGlzNjAubWFwRWxlbWVudFN0eWxlcyhjb2x1bW4uY29tcG9uZW50LmdldEVsZW1lbnQoKSwgY2VsbEVsLCBbXCJ0ZXh0LWFsaWduXCIsIFwiYm9yZGVyLXRvcFwiLCBcImJvcmRlci1sZWZ0XCIsIFwiYm9yZGVyLXJpZ2h0XCIsIFwiYm9yZGVyLWJvdHRvbVwiLCBcImJhY2tncm91bmQtY29sb3JcIiwgXCJjb2xvclwiLCBcImZvbnQtd2VpZ2h0XCIsIFwiZm9udC1mYW1pbHlcIiwgXCJmb250LXNpemVcIl0pO1xuXHRcdFx0X3RoaXM2MC5tYXBFbGVtZW50U3R5bGVzKGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5jb250ZW50RWxlbWVudCwgY2VsbEVsLCBbXCJwYWRkaW5nLXRvcFwiLCBcInBhZGRpbmctbGVmdFwiLCBcInBhZGRpbmctcmlnaHRcIiwgXCJwYWRkaW5nLWJvdHRvbVwiXSk7XG5cblx0XHRcdGlmIChjb2x1bW4uY29tcG9uZW50Ll9jb2x1bW4udmlzaWJsZSkge1xuXHRcdFx0XHRfdGhpczYwLm1hcEVsZW1lbnRTdHlsZXMoY29sdW1uLmNvbXBvbmVudC5nZXRFbGVtZW50KCksIGNlbGxFbCwgW1wid2lkdGhcIl0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5kZWZpbml0aW9uLndpZHRoKSB7XG5cdFx0XHRcdFx0Y2VsbEVsLnN0eWxlLndpZHRoID0gY29sdW1uLmNvbXBvbmVudC5fY29sdW1uLmRlZmluaXRpb24ud2lkdGggKyBcInB4XCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5wYXJlbnQpIHtcblx0XHRcdFx0X3RoaXM2MC5tYXBFbGVtZW50U3R5bGVzKGNvbHVtbi5jb21wb25lbnQuX2NvbHVtbi5wYXJlbnQuZ3JvdXBFbGVtZW50LCBjZWxsRWwsIFtcImJvcmRlci10b3BcIl0pO1xuXHRcdFx0fVxuXG5cdFx0XHRyb3dFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHJvd0VsO1xufTtcblxuRXhwb3J0LnByb3RvdHlwZS5nZW5lcmVhdGVHcm91cEVsZW1lbnQgPSBmdW5jdGlvbiAocm93LCBzZXR1cCwgc3R5bGVzKSB7XG5cblx0dmFyIHJvd0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpLFxuXHQgICAgY2VsbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpLFxuXHQgICAgZ3JvdXAgPSByb3cuY29sdW1uc1swXTtcblxuXHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXByaW50LXRhYmxlLXJvd1wiKTtcblxuXHRpZiAoc2V0dXAuZ3JvdXBIZWFkZXIgJiYgc2V0dXAuZ3JvdXBIZWFkZXJbcm93LmluZGVudF0pIHtcblx0XHRncm91cC52YWx1ZSA9IHNldHVwLmdyb3VwSGVhZGVyW3Jvdy5pbmRlbnRdKGdyb3VwLnZhbHVlLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXRSb3dDb3VudCgpLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXREYXRhKCksIHJvdy5jb21wb25lbnQpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChzZXR1cC5ncm91cEhlYWRlciA9PT0gZmFsc2UpIHtcblx0XHRcdGdyb3VwLnZhbHVlID0gZ3JvdXAudmFsdWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGdyb3VwLnZhbHVlID0gcm93LmNvbXBvbmVudC5fZ3JvdXAuZ2VuZXJhdG9yKGdyb3VwLnZhbHVlLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXRSb3dDb3VudCgpLCByb3cuY29tcG9uZW50Ll9ncm91cC5nZXREYXRhKCksIHJvdy5jb21wb25lbnQpO1xuXHRcdH1cblx0fVxuXG5cdGNlbGxFbC5jb2xTcGFuID0gZ3JvdXAud2lkdGg7XG5cdGNlbGxFbC5pbm5lckhUTUwgPSBncm91cC52YWx1ZTtcblxuXHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXByaW50LXRhYmxlLWdyb3VwXCIpO1xuXHRyb3dFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLWxldmVsLVwiICsgcm93LmluZGVudCk7XG5cblx0aWYgKGdyb3VwLmNvbXBvbmVudC5pc1Zpc2libGUoKSkge1xuXHRcdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZ3JvdXAtdmlzaWJsZVwiKTtcblx0fVxuXG5cdHRoaXMubWFwRWxlbWVudFN0eWxlcyhzdHlsZXMuZmlyc3RHcm91cCwgcm93RWwsIFtcImJvcmRlci10b3BcIiwgXCJib3JkZXItbGVmdFwiLCBcImJvcmRlci1yaWdodFwiLCBcImJvcmRlci1ib3R0b21cIiwgXCJjb2xvclwiLCBcImZvbnQtd2VpZ2h0XCIsIFwiZm9udC1mYW1pbHlcIiwgXCJmb250LXNpemVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yXCJdKTtcblx0dGhpcy5tYXBFbGVtZW50U3R5bGVzKHN0eWxlcy5maXJzdEdyb3VwLCBjZWxsRWwsIFtcInBhZGRpbmctdG9wXCIsIFwicGFkZGluZy1sZWZ0XCIsIFwicGFkZGluZy1yaWdodFwiLCBcInBhZGRpbmctYm90dG9tXCJdKTtcblxuXHRyb3dFbC5hcHBlbmRDaGlsZChjZWxsRWwpO1xuXG5cdHJldHVybiByb3dFbDtcbn07XG5cbkV4cG9ydC5wcm90b3R5cGUuZ2VuZXJlYXRlQ2FsY0VsZW1lbnQgPSBmdW5jdGlvbiAocm93LCBzZXR1cCwgc3R5bGVzKSB7XG5cdHZhciByb3dFbCA9IHRoaXMuZ2VuZXJlYXRlUm93RWxlbWVudChyb3csIHNldHVwLCBzdHlsZXMpO1xuXG5cdHJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtdGFibGUtY2FsY3NcIik7XG5cdHRoaXMubWFwRWxlbWVudFN0eWxlcyhzdHlsZXMuY2FsY1Jvdywgcm93RWwsIFtcImJvcmRlci10b3BcIiwgXCJib3JkZXItbGVmdFwiLCBcImJvcmRlci1yaWdodFwiLCBcImJvcmRlci1ib3R0b21cIiwgXCJjb2xvclwiLCBcImZvbnQtd2VpZ2h0XCIsIFwiZm9udC1mYW1pbHlcIiwgXCJmb250LXNpemVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yXCJdKTtcblxuXHRyZXR1cm4gcm93RWw7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmdlbmVyZWF0ZVJvd0VsZW1lbnQgPSBmdW5jdGlvbiAocm93LCBzZXR1cCwgc3R5bGVzKSB7XG5cdHZhciBfdGhpczYxID0gdGhpcztcblxuXHR2YXIgcm93RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJcIik7XG5cblx0cm93RWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC10YWJsZS1yb3dcIik7XG5cblx0cm93LmNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sKSB7XG5cblx0XHRpZiAoY29sKSB7XG5cdFx0XHR2YXIgY2VsbEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpLFxuXHRcdFx0ICAgIGNvbHVtbiA9IGNvbC5jb21wb25lbnQuX2NvbHVtbixcblx0XHRcdCAgICB2YWx1ZSA9IGNvbC52YWx1ZTtcblxuXHRcdFx0dmFyIGNlbGxXcmFwcGVyID0ge1xuXHRcdFx0XHRtb2R1bGVzOiB7fSxcblx0XHRcdFx0Z2V0VmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlKCkge1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0RmllbGQ6IGZ1bmN0aW9uIGdldEZpZWxkKCkge1xuXHRcdFx0XHRcdHJldHVybiBjb2x1bW4uZGVmaW5pdGlvbi5maWVsZDtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0RWxlbWVudDogZnVuY3Rpb24gZ2V0RWxlbWVudCgpIHtcblx0XHRcdFx0XHRyZXR1cm4gY2VsbEVsO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRnZXRDb2x1bW46IGZ1bmN0aW9uIGdldENvbHVtbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gY29sdW1uLmdldENvbXBvbmVudCgpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRnZXREYXRhOiBmdW5jdGlvbiBnZXREYXRhKCkge1xuXHRcdFx0XHRcdHJldHVybiByb3cuY29tcG9uZW50LmdldERhdGEoKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0Z2V0Um93OiBmdW5jdGlvbiBnZXRSb3coKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJvdy5jb21wb25lbnQ7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGdldENvbXBvbmVudDogZnVuY3Rpb24gZ2V0Q29tcG9uZW50KCkge1xuXHRcdFx0XHRcdHJldHVybiBjZWxsV3JhcHBlcjtcblx0XHRcdFx0fSxcblx0XHRcdFx0Y29sdW1uOiBjb2x1bW5cblx0XHRcdH07XG5cblx0XHRcdHZhciBjbGFzc05hbWVzID0gY29sdW1uLmRlZmluaXRpb24uY3NzQ2xhc3MgPyBjb2x1bW4uZGVmaW5pdGlvbi5jc3NDbGFzcy5zcGxpdChcIiBcIikgOiBbXTtcblxuXHRcdFx0Y2xhc3NOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChjbGFzc05hbWUpIHtcblx0XHRcdFx0Y2VsbEVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoX3RoaXM2MS50YWJsZS5tb2RFeGlzdHMoXCJmb3JtYXRcIikgJiYgX3RoaXM2MS5jb25maWcuZm9ybWF0Q2VsbHMgIT09IGZhbHNlKSB7XG5cdFx0XHRcdHZhbHVlID0gX3RoaXM2MS50YWJsZS5tb2R1bGVzLmZvcm1hdC5mb3JtYXRFeHBvcnRWYWx1ZShjZWxsV3JhcHBlciwgX3RoaXM2MS5jb2xWaXNQcm9wKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHN3aXRjaCAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpIHtcblx0XHRcdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJudWxsXCI6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdFx0Y2VsbEVsLmFwcGVuZENoaWxkKHZhbHVlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNlbGxFbC5pbm5lckhUTUwgPSB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHN0eWxlcy5maXJzdENlbGwpIHtcblx0XHRcdFx0X3RoaXM2MS5tYXBFbGVtZW50U3R5bGVzKHN0eWxlcy5maXJzdENlbGwsIGNlbGxFbCwgW1wicGFkZGluZy10b3BcIiwgXCJwYWRkaW5nLWxlZnRcIiwgXCJwYWRkaW5nLXJpZ2h0XCIsIFwicGFkZGluZy1ib3R0b21cIiwgXCJib3JkZXItdG9wXCIsIFwiYm9yZGVyLWxlZnRcIiwgXCJib3JkZXItcmlnaHRcIiwgXCJib3JkZXItYm90dG9tXCIsIFwiY29sb3JcIiwgXCJmb250LXdlaWdodFwiLCBcImZvbnQtZmFtaWx5XCIsIFwiZm9udC1zaXplXCJdKTtcblxuXHRcdFx0XHRpZiAoY29sdW1uLmRlZmluaXRpb24uYWxpZ24pIHtcblx0XHRcdFx0XHRjZWxsRWwuc3R5bGUudGV4dEFsaWduID0gY29sdW1uLmRlZmluaXRpb24uYWxpZ247XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKF90aGlzNjEudGFibGUub3B0aW9ucy5kYXRhVHJlZSAmJiBfdGhpczYxLmNvbmZpZy5kYXRhVHJlZSAhPT0gZmFsc2UpIHtcblx0XHRcdFx0aWYgKHNldHVwLnRyZWVFbGVtZW50RmllbGQgJiYgc2V0dXAudHJlZUVsZW1lbnRGaWVsZCA9PSBjb2x1bW4uZmllbGQgfHwgIXNldHVwLnRyZWVFbGVtZW50RmllbGQgJiYgaSA9PSAwKSB7XG5cdFx0XHRcdFx0aWYgKHJvdy5jb21wb25lbnQuX3Jvdy5tb2R1bGVzLmRhdGFUcmVlLmNvbnRyb2xFbCkge1xuXHRcdFx0XHRcdFx0Y2VsbEVsLmluc2VydEJlZm9yZShyb3cuY29tcG9uZW50Ll9yb3cubW9kdWxlcy5kYXRhVHJlZS5jb250cm9sRWwuY2xvbmVOb2RlKHRydWUpLCBjZWxsRWwuZmlyc3RDaGlsZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChyb3cuY29tcG9uZW50Ll9yb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbCkge1xuXHRcdFx0XHRcdFx0Y2VsbEVsLmluc2VydEJlZm9yZShyb3cuY29tcG9uZW50Ll9yb3cubW9kdWxlcy5kYXRhVHJlZS5icmFuY2hFbC5jbG9uZU5vZGUodHJ1ZSksIGNlbGxFbC5maXJzdENoaWxkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cm93RWwuYXBwZW5kQ2hpbGQoY2VsbEVsKTtcblxuXHRcdFx0aWYgKGNlbGxXcmFwcGVyLm1vZHVsZXMuZm9ybWF0ICYmIGNlbGxXcmFwcGVyLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkQ2FsbGJhY2spIHtcblx0XHRcdFx0Y2VsbFdyYXBwZXIubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjaygpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoc2V0dXAucm93Rm9ybWF0dGVyICYmIF90aGlzNjEuY29uZmlnLmZvcm1hdENlbGxzICE9PSBmYWxzZSkge1xuXHRcdFx0XHRzZXR1cC5yb3dGb3JtYXR0ZXIocm93LmNvbXBvbmVudCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gcm93RWw7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmdlbmVyZWF0ZUhUTUxUYWJsZSA9IGZ1bmN0aW9uIChsaXN0KSB7XG5cdHZhciBob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdGhvbGRlci5hcHBlbmRDaGlsZCh0aGlzLmdlbmVyZWF0ZVRhYmxlRWxlbWVudChsaXN0KSk7XG5cblx0cmV0dXJuIGhvbGRlci5pbm5lckhUTUw7XG59O1xuXG5FeHBvcnQucHJvdG90eXBlLmdldEh0bWwgPSBmdW5jdGlvbiAodmlzaWJsZSwgc3R5bGUsIGNvbmZpZywgY29sVmlzUHJvcCkge1xuXHR2YXIgbGlzdCA9IHRoaXMuZ2VuZXJhdGVFeHBvcnRMaXN0KGNvbmZpZyB8fCB0aGlzLnRhYmxlLm9wdGlvbnMuaHRtbE91dHB1dENvbmZpZywgc3R5bGUsIHZpc2libGUsIGNvbFZpc1Byb3AgfHwgXCJodG1sT3V0cHV0XCIpO1xuXG5cdHJldHVybiB0aGlzLmdlbmVyZWF0ZUhUTUxUYWJsZShsaXN0KTtcbn07XG5cbkV4cG9ydC5wcm90b3R5cGUubWFwRWxlbWVudFN0eWxlcyA9IGZ1bmN0aW9uIChmcm9tLCB0bywgcHJvcHMpIHtcblx0aWYgKHRoaXMuY2xvbmVUYWJsZVN0eWxlICYmIGZyb20gJiYgdG8pIHtcblxuXHRcdHZhciBsb29rdXAgPSB7XG5cdFx0XHRcImJhY2tncm91bmQtY29sb3JcIjogXCJiYWNrZ3JvdW5kQ29sb3JcIixcblx0XHRcdFwiY29sb3JcIjogXCJmb250Q29sb3JcIixcblx0XHRcdFwid2lkdGhcIjogXCJ3aWR0aFwiLFxuXHRcdFx0XCJmb250LXdlaWdodFwiOiBcImZvbnRXZWlnaHRcIixcblx0XHRcdFwiZm9udC1mYW1pbHlcIjogXCJmb250RmFtaWx5XCIsXG5cdFx0XHRcImZvbnQtc2l6ZVwiOiBcImZvbnRTaXplXCIsXG5cdFx0XHRcInRleHQtYWxpZ25cIjogXCJ0ZXh0QWxpZ25cIixcblx0XHRcdFwiYm9yZGVyLXRvcFwiOiBcImJvcmRlclRvcFwiLFxuXHRcdFx0XCJib3JkZXItbGVmdFwiOiBcImJvcmRlckxlZnRcIixcblx0XHRcdFwiYm9yZGVyLXJpZ2h0XCI6IFwiYm9yZGVyUmlnaHRcIixcblx0XHRcdFwiYm9yZGVyLWJvdHRvbVwiOiBcImJvcmRlckJvdHRvbVwiLFxuXHRcdFx0XCJwYWRkaW5nLXRvcFwiOiBcInBhZGRpbmdUb3BcIixcblx0XHRcdFwicGFkZGluZy1sZWZ0XCI6IFwicGFkZGluZ0xlZnRcIixcblx0XHRcdFwicGFkZGluZy1yaWdodFwiOiBcInBhZGRpbmdSaWdodFwiLFxuXHRcdFx0XCJwYWRkaW5nLWJvdHRvbVwiOiBcInBhZGRpbmdCb3R0b21cIlxuXHRcdH07XG5cblx0XHRpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcblx0XHRcdHZhciBmcm9tU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShmcm9tKTtcblxuXHRcdFx0cHJvcHMuZm9yRWFjaChmdW5jdGlvbiAocHJvcCkge1xuXHRcdFx0XHR0by5zdHlsZVtsb29rdXBbcHJvcF1dID0gZnJvbVN0eWxlLmdldFByb3BlcnR5VmFsdWUocHJvcCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJleHBvcnRcIiwgRXhwb3J0KTtcblxudmFyIEZpbHRlciA9IGZ1bmN0aW9uIEZpbHRlcih0YWJsZSkge1xuXG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3RcblxuXHR0aGlzLmZpbHRlckxpc3QgPSBbXTsgLy9ob2xkIGZpbHRlciBsaXN0XG5cdHRoaXMuaGVhZGVyRmlsdGVycyA9IHt9OyAvL2hvbGQgY29sdW1uIGZpbHRlcnNcblx0dGhpcy5oZWFkZXJGaWx0ZXJDb2x1bW5zID0gW107IC8vaG9sZCBjb2x1bW5zIHRoYXQgdXNlIGhlYWRlciBmaWx0ZXJzXG5cblx0dGhpcy5wcmV2SGVhZGVyRmlsdGVyQ2hhbmdlQ2hlY2sgPSBcIlwiO1xuXHR0aGlzLnByZXZIZWFkZXJGaWx0ZXJDaGFuZ2VDaGVjayA9IFwie31cIjtcblxuXHR0aGlzLmNoYW5nZWQgPSBmYWxzZTsgLy9oYXMgZmlsdGVyaW5nIGNoYW5nZWQgc2luY2UgbGFzdCByZW5kZXJcbn07XG5cbi8vaW5pdGlhbGl6ZSBjb2x1bW4gaGVhZGVyIGZpbHRlclxuRmlsdGVyLnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbiwgdmFsdWUpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZmllbGQgPSBjb2x1bW4uZ2V0RmllbGQoKSxcblx0ICAgIHBhcmFtcztcblxuXHQvL2hhbmRsZSBzdWNjZXNzZnVsbCB2YWx1ZSBjaGFuZ2Vcblx0ZnVuY3Rpb24gc3VjY2Vzcyh2YWx1ZSkge1xuXHRcdHZhciBmaWx0ZXJUeXBlID0gY29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPT0gXCJpbnB1dFwiICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9PSBcInRleHRcIiB8fCBjb2x1bW4ubW9kdWxlcy5maWx0ZXIudGFnVHlwZSA9PSBcInRleHRhcmVhXCIgPyBcInBhcnRpYWxcIiA6IFwibWF0Y2hcIixcblx0XHQgICAgdHlwZSA9IFwiXCIsXG5cdFx0ICAgIGZpbHRlckNoYW5nZUNoZWNrID0gXCJcIixcblx0XHQgICAgZmlsdGVyRnVuYztcblxuXHRcdGlmICh0eXBlb2YgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnByZXZTdWNjZXNzID09PSBcInVuZGVmaW5lZFwiIHx8IGNvbHVtbi5tb2R1bGVzLmZpbHRlci5wcmV2U3VjY2VzcyAhPT0gdmFsdWUpIHtcblxuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLnByZXZTdWNjZXNzID0gdmFsdWU7XG5cblx0XHRcdGlmICghY29sdW1uLm1vZHVsZXMuZmlsdGVyLmVtcHR5RnVuYyh2YWx1ZSkpIHtcblx0XHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlID0gdmFsdWU7XG5cblx0XHRcdFx0c3dpdGNoIChfdHlwZW9mKGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmMpKSB7XG5cdFx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdFx0aWYgKHNlbGYuZmlsdGVyc1tjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJGdW5jXSkge1xuXHRcdFx0XHRcdFx0XHR0eXBlID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuYztcblx0XHRcdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uIGZpbHRlckZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBwYXJhbXMgPSBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJGdW5jUGFyYW1zIHx8IHt9O1xuXHRcdFx0XHRcdFx0XHRcdHZhciBmaWVsZFZhbCA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXG5cdFx0XHRcdFx0XHRcdFx0cGFyYW1zID0gdHlwZW9mIHBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gcGFyYW1zKHZhbHVlLCBmaWVsZFZhbCwgZGF0YSkgOiBwYXJhbXM7XG5cblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gc2VsZi5maWx0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmNdKHZhbHVlLCBmaWVsZFZhbCwgZGF0YSwgcGFyYW1zKTtcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkhlYWRlciBGaWx0ZXIgRXJyb3IgLSBNYXRjaGluZyBmaWx0ZXIgZnVuY3Rpb24gbm90IGZvdW5kOiBcIiwgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuYyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uIGZpbHRlckZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgcGFyYW1zID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRnVuY1BhcmFtcyB8fCB7fTtcblx0XHRcdFx0XHRcdFx0dmFyIGZpZWxkVmFsID0gY29sdW1uLmdldEZpZWxkVmFsdWUoZGF0YSk7XG5cblx0XHRcdFx0XHRcdFx0cGFyYW1zID0gdHlwZW9mIHBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gcGFyYW1zKHZhbHVlLCBmaWVsZFZhbCwgZGF0YSkgOiBwYXJhbXM7XG5cblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckZ1bmModmFsdWUsIGZpZWxkVmFsLCBkYXRhLCBwYXJhbXMpO1xuXHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0dHlwZSA9IGZpbHRlckZ1bmM7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICghZmlsdGVyRnVuYykge1xuXHRcdFx0XHRcdHN3aXRjaCAoZmlsdGVyVHlwZSkge1xuXHRcdFx0XHRcdFx0Y2FzZSBcInBhcnRpYWxcIjpcblx0XHRcdFx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uIGZpbHRlckZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBjb2xWYWwgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShkYXRhKTtcblxuXHRcdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgY29sVmFsICE9PSAndW5kZWZpbmVkJyAmJiBjb2xWYWwgIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBTdHJpbmcoY29sVmFsKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpKSA+IC0xO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR0eXBlID0gXCJsaWtlXCI7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRmaWx0ZXJGdW5jID0gZnVuY3Rpb24gZmlsdGVyRnVuYyhkYXRhKSB7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpID09IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR0eXBlID0gXCI9XCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2VsZi5oZWFkZXJGaWx0ZXJzW2ZpZWxkXSA9IHsgdmFsdWU6IHZhbHVlLCBmdW5jOiBmaWx0ZXJGdW5jLCB0eXBlOiB0eXBlLCBwYXJhbXM6IHBhcmFtcyB8fCB7fSB9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGVsZXRlIHNlbGYuaGVhZGVyRmlsdGVyc1tmaWVsZF07XG5cdFx0XHR9XG5cblx0XHRcdGZpbHRlckNoYW5nZUNoZWNrID0gSlNPTi5zdHJpbmdpZnkoc2VsZi5oZWFkZXJGaWx0ZXJzKTtcblxuXHRcdFx0aWYgKHNlbGYucHJldkhlYWRlckZpbHRlckNoYW5nZUNoZWNrICE9PSBmaWx0ZXJDaGFuZ2VDaGVjaykge1xuXHRcdFx0XHRzZWxmLnByZXZIZWFkZXJGaWx0ZXJDaGFuZ2VDaGVjayA9IGZpbHRlckNoYW5nZUNoZWNrO1xuXG5cdFx0XHRcdHNlbGYuY2hhbmdlZCA9IHRydWU7XG5cdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5maWx0ZXJSZWZyZXNoKCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIgPSB7XG5cdFx0c3VjY2Vzczogc3VjY2Vzcyxcblx0XHRhdHRyVHlwZTogZmFsc2UsXG5cdFx0dGFnVHlwZTogZmFsc2UsXG5cdFx0ZW1wdHlGdW5jOiBmYWxzZVxuXHR9O1xuXG5cdHRoaXMuZ2VuZXJhdGVIZWFkZXJGaWx0ZXJFbGVtZW50KGNvbHVtbik7XG59O1xuXG5GaWx0ZXIucHJvdG90eXBlLmdlbmVyYXRlSGVhZGVyRmlsdGVyRWxlbWVudCA9IGZ1bmN0aW9uIChjb2x1bW4sIGluaXRpYWxWYWx1ZSwgcmVpbml0aWFsaXplKSB7XG5cdHZhciBfdGhpczYyID0gdGhpcztcblxuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBzdWNjZXNzID0gY29sdW1uLm1vZHVsZXMuZmlsdGVyLnN1Y2Nlc3MsXG5cdCAgICBmaWVsZCA9IGNvbHVtbi5nZXRGaWVsZCgpLFxuXHQgICAgZmlsdGVyRWxlbWVudCxcblx0ICAgIGVkaXRvcixcblx0ICAgIGVkaXRvckVsZW1lbnQsXG5cdCAgICBjZWxsV3JhcHBlcixcblx0ICAgIHR5cGluZ1RpbWVyLFxuXHQgICAgc2VhcmNoVHJpZ2dlcixcblx0ICAgIHBhcmFtcztcblxuXHQvL2hhbmRsZSBhYm9ydGVkIGVkaXRcblx0ZnVuY3Rpb24gY2FuY2VsKCkge31cblxuXHRpZiAoY29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQgJiYgY29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQucGFyZW50Tm9kZSkge1xuXHRcdGNvbHVtbi5jb250ZW50RWxlbWVudC5yZW1vdmVDaGlsZChjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudC5wYXJlbnROb2RlKTtcblx0fVxuXG5cdGlmIChmaWVsZCkge1xuXG5cdFx0Ly9zZXQgZW1wdHkgdmFsdWUgZnVuY3Rpb25cblx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIuZW1wdHlGdW5jID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyRW1wdHlDaGVjayB8fCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdHJldHVybiAhdmFsdWUgJiYgdmFsdWUgIT09IFwiMFwiICYmIHZhbHVlICE9PSAwO1xuXHRcdH07XG5cblx0XHRmaWx0ZXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRmaWx0ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyLWZpbHRlclwiKTtcblxuXHRcdC8vc2V0IGNvbHVtbiBlZGl0b3Jcblx0XHRzd2l0Y2ggKF90eXBlb2YoY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRpZiAoc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJdKSB7XG5cdFx0XHRcdFx0ZWRpdG9yID0gc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJdO1xuXG5cdFx0XHRcdFx0aWYgKChjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXIgPT09IFwidGlja1wiIHx8IGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlciA9PT0gXCJ0aWNrQ3Jvc3NcIikgJiYgIWNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlckVtcHR5Q2hlY2spIHtcblx0XHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5lbXB0eUZ1bmMgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlICE9PSB0cnVlICYmIHZhbHVlICE9PSBmYWxzZTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIkZpbHRlciBFcnJvciAtIENhbm5vdCBidWlsZCBoZWFkZXIgZmlsdGVyLCBObyBzdWNoIGVkaXRvciBmb3VuZDogXCIsIGNvbHVtbi5kZWZpbml0aW9uLmVkaXRvcik7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRlZGl0b3IgPSBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXI7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0XHRpZiAoY29sdW1uLm1vZHVsZXMuZWRpdCAmJiBjb2x1bW4ubW9kdWxlcy5lZGl0LmVkaXRvcikge1xuXHRcdFx0XHRcdGVkaXRvciA9IGNvbHVtbi5tb2R1bGVzLmVkaXQuZWRpdG9yO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgJiYgc2VsZi50YWJsZS5tb2R1bGVzLmVkaXQuZWRpdG9yc1tjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXJdKSB7XG5cdFx0XHRcdFx0XHRlZGl0b3IgPSBzZWxmLnRhYmxlLm1vZHVsZXMuZWRpdC5lZGl0b3JzW2NvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlcl07XG5cblx0XHRcdFx0XHRcdGlmICgoY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyID09PSBcInRpY2tcIiB8fCBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXIgPT09IFwidGlja0Nyb3NzXCIpICYmICFjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJFbXB0eUNoZWNrKSB7XG5cdFx0XHRcdFx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5lbXB0eUZ1bmMgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsdWUgIT09IHRydWUgJiYgdmFsdWUgIT09IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlZGl0b3IgPSBzZWxmLnRhYmxlLm1vZHVsZXMuZWRpdC5lZGl0b3JzW1wiaW5wdXRcIl07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdGlmIChlZGl0b3IpIHtcblxuXHRcdFx0Y2VsbFdyYXBwZXIgPSB7XG5cdFx0XHRcdGdldFZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZSgpIHtcblx0XHRcdFx0XHRyZXR1cm4gdHlwZW9mIGluaXRpYWxWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGluaXRpYWxWYWx1ZSA6IFwiXCI7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGdldEZpZWxkOiBmdW5jdGlvbiBnZXRGaWVsZCgpIHtcblx0XHRcdFx0XHRyZXR1cm4gY29sdW1uLmRlZmluaXRpb24uZmllbGQ7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGdldEVsZW1lbnQ6IGZ1bmN0aW9uIGdldEVsZW1lbnQoKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGZpbHRlckVsZW1lbnQ7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGdldENvbHVtbjogZnVuY3Rpb24gZ2V0Q29sdW1uKCkge1xuXHRcdFx0XHRcdHJldHVybiBjb2x1bW4uZ2V0Q29tcG9uZW50KCk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGdldFJvdzogZnVuY3Rpb24gZ2V0Um93KCkge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRub3JtYWxpemVIZWlnaHQ6IGZ1bmN0aW9uIG5vcm1hbGl6ZUhlaWdodCgpIHt9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0cGFyYW1zID0gY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyUGFyYW1zIHx8IHt9O1xuXG5cdFx0XHRwYXJhbXMgPSB0eXBlb2YgcGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBwYXJhbXMuY2FsbChzZWxmLnRhYmxlKSA6IHBhcmFtcztcblxuXHRcdFx0ZWRpdG9yRWxlbWVudCA9IGVkaXRvci5jYWxsKHRoaXMudGFibGUubW9kdWxlcy5lZGl0LCBjZWxsV3JhcHBlciwgZnVuY3Rpb24gKCkge30sIHN1Y2Nlc3MsIGNhbmNlbCwgcGFyYW1zKTtcblxuXHRcdFx0aWYgKCFlZGl0b3JFbGVtZW50KSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkZpbHRlciBFcnJvciAtIENhbm5vdCBhZGQgZmlsdGVyIHRvIFwiICsgZmllbGQgKyBcIiBjb2x1bW4sIGVkaXRvciByZXR1cm5lZCBhIHZhbHVlIG9mIGZhbHNlXCIpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGlmICghKGVkaXRvckVsZW1lbnQgaW5zdGFuY2VvZiBOb2RlKSkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJGaWx0ZXIgRXJyb3IgLSBDYW5ub3QgYWRkIGZpbHRlciB0byBcIiArIGZpZWxkICsgXCIgY29sdW1uLCBlZGl0b3Igc2hvdWxkIHJldHVybiBhbiBpbnN0YW5jZSBvZiBOb2RlLCB0aGUgZWRpdG9yIHJldHVybmVkOlwiLCBlZGl0b3JFbGVtZW50KTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvL3NldCBQbGFjZWhvbGRlciBUZXh0XG5cdFx0XHRpZiAoZmllbGQpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmJpbmQoXCJoZWFkZXJGaWx0ZXJzfGNvbHVtbnN8XCIgKyBjb2x1bW4uZGVmaW5pdGlvbi5maWVsZCwgZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJwbGFjZWhvbGRlclwiLCB0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIgJiYgdmFsdWUgPyB2YWx1ZSA6IHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5nZXRUZXh0KFwiaGVhZGVyRmlsdGVyc3xkZWZhdWx0XCIpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZWxmLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcImhlYWRlckZpbHRlcnN8ZGVmYXVsdFwiLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdFx0XHRlZGl0b3JFbGVtZW50LnNldEF0dHJpYnV0ZShcInBsYWNlaG9sZGVyXCIsIHR5cGVvZiBzZWxmLmNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyICE9PSBcInVuZGVmaW5lZFwiICYmIHNlbGYuY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyUGxhY2Vob2xkZXIgPyBzZWxmLmNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlclBsYWNlaG9sZGVyIDogdmFsdWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0Ly9mb2N1cyBvbiBlbGVtZW50IG9uIGNsaWNrXG5cdFx0XHRlZGl0b3JFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRlZGl0b3JFbGVtZW50LmZvY3VzKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0dmFyIGxlZnQgPSBfdGhpczYyLnRhYmxlLmNvbHVtbk1hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0O1xuXG5cdFx0XHRcdGlmIChsZWZ0ICE9PSBfdGhpczYyLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0KSB7XG5cdFx0XHRcdFx0X3RoaXM2Mi50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdFx0XHRcdFx0X3RoaXM2Mi50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHQvL2xpdmUgdXBkYXRlIGZpbHRlcnMgYXMgdXNlciB0eXBlc1xuXHRcdFx0dHlwaW5nVGltZXIgPSBmYWxzZTtcblxuXHRcdFx0c2VhcmNoVHJpZ2dlciA9IGZ1bmN0aW9uIHNlYXJjaFRyaWdnZXIoZSkge1xuXHRcdFx0XHRpZiAodHlwaW5nVGltZXIpIHtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQodHlwaW5nVGltZXIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dHlwaW5nVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRzdWNjZXNzKGVkaXRvckVsZW1lbnQudmFsdWUpO1xuXHRcdFx0XHR9LCBzZWxmLnRhYmxlLm9wdGlvbnMuaGVhZGVyRmlsdGVyTGl2ZUZpbHRlckRlbGF5KTtcblx0XHRcdH07XG5cblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50ID0gZWRpdG9yRWxlbWVudDtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9IGVkaXRvckVsZW1lbnQuaGFzQXR0cmlidXRlKFwidHlwZVwiKSA/IGVkaXRvckVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKS50b0xvd2VyQ2FzZSgpIDogXCJcIjtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci50YWdUeXBlID0gZWRpdG9yRWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cblx0XHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXJMaXZlRmlsdGVyICE9PSBmYWxzZSkge1xuXG5cdFx0XHRcdGlmICghKGNvbHVtbi5kZWZpbml0aW9uLmhlYWRlckZpbHRlciA9PT0gJ2F1dG9jb21wbGV0ZScgfHwgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyRmlsdGVyID09PSAndGlja0Nyb3NzJyB8fCAoY29sdW1uLmRlZmluaXRpb24uZWRpdG9yID09PSAnYXV0b2NvbXBsZXRlJyB8fCBjb2x1bW4uZGVmaW5pdGlvbi5lZGl0b3IgPT09ICd0aWNrQ3Jvc3MnKSAmJiBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJGaWx0ZXIgPT09IHRydWUpKSB7XG5cdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgc2VhcmNoVHJpZ2dlcik7XG5cdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic2VhcmNoXCIsIHNlYXJjaFRyaWdnZXIpO1xuXG5cdFx0XHRcdFx0Ly91cGRhdGUgbnVtYmVyIGZpbHRlcmVkIGNvbHVtbnMgb24gY2hhbmdlXG5cdFx0XHRcdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9PSBcIm51bWJlclwiKSB7XG5cdFx0XHRcdFx0XHRlZGl0b3JFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdFx0c3VjY2VzcyhlZGl0b3JFbGVtZW50LnZhbHVlKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vY2hhbmdlIHRleHQgaW5wdXRzIHRvIHNlYXJjaCBpbnB1dHMgdG8gYWxsb3cgZm9yIGNsZWFyaW5nIG9mIGZpZWxkXG5cdFx0XHRcdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZpbHRlci5hdHRyVHlwZSA9PSBcInRleHRcIiAmJiB0aGlzLnRhYmxlLmJyb3dzZXIgIT09IFwiaWVcIikge1xuXHRcdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwic2VhcmNoXCIpO1xuXHRcdFx0XHRcdFx0Ly8gZWRpdG9yRWxlbWVudC5vZmYoXCJjaGFuZ2UgYmx1clwiKTsgLy9wcmV2ZW50IGJsdXIgZnJvbSB0cmlnZ2VyaW5nIGZpbHRlciBhbmQgcHJldmVudGluZyBzZWxlY3Rpb24gY2xpY2tcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL3ByZXZlbnQgaW5wdXQgYW5kIHNlbGVjdCBlbGVtZW50cyBmcm9tIHByb3BlZ2F0aW5nIGNsaWNrIHRvIGNvbHVtbiBzb3J0ZXJzIGV0Y1xuXHRcdFx0XHRpZiAoY29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPT0gXCJpbnB1dFwiIHx8IGNvbHVtbi5tb2R1bGVzLmZpbHRlci50YWdUeXBlID09IFwic2VsZWN0XCIgfHwgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnRhZ1R5cGUgPT0gXCJ0ZXh0YXJlYVwiKSB7XG5cdFx0XHRcdFx0ZWRpdG9yRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGZpbHRlckVsZW1lbnQuYXBwZW5kQ2hpbGQoZWRpdG9yRWxlbWVudCk7XG5cblx0XHRcdGNvbHVtbi5jb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZChmaWx0ZXJFbGVtZW50KTtcblxuXHRcdFx0aWYgKCFyZWluaXRpYWxpemUpIHtcblx0XHRcdFx0c2VsZi5oZWFkZXJGaWx0ZXJDb2x1bW5zLnB1c2goY29sdW1uKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gQ2Fubm90IGFkZCBoZWFkZXIgZmlsdGVyLCBjb2x1bW4gaGFzIG5vIGZpZWxkIHNldDpcIiwgY29sdW1uLmRlZmluaXRpb24udGl0bGUpO1xuXHR9XG59O1xuXG4vL2hpZGUgYWxsIGhlYWRlciBmaWx0ZXIgZWxlbWVudHMgKHVzZWQgdG8gZW5zdXJlIGNvcnJlY3QgY29sdW1uIHdpZHRocyBpbiBcImZpdERhdGFcIiBsYXlvdXQgbW9kZSlcbkZpbHRlci5wcm90b3R5cGUuaGlkZUhlYWRlckZpbHRlckVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmhlYWRlckZpbHRlckNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZpbHRlciAmJiBjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudCkge1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR9XG5cdH0pO1xufTtcblxuLy9zaG93IGFsbCBoZWFkZXIgZmlsdGVyIGVsZW1lbnRzICh1c2VkIHRvIGVuc3VyZSBjb3JyZWN0IGNvbHVtbiB3aWR0aHMgaW4gXCJmaXREYXRhXCIgbGF5b3V0IG1vZGUpXG5GaWx0ZXIucHJvdG90eXBlLnNob3dIZWFkZXJGaWx0ZXJFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5oZWFkZXJGaWx0ZXJDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4ubW9kdWxlcy5maWx0ZXIgJiYgY29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQpIHtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJztcblx0XHR9XG5cdH0pO1xufTtcblxuLy9wcm9ncmFtYXRpY2FsbHkgc2V0IGZvY3VzIG9mIGhlYWRlciBmaWx0ZXJcbkZpbHRlci5wcm90b3R5cGUuc2V0SGVhZGVyRmlsdGVyRm9jdXMgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdGlmIChjb2x1bW4ubW9kdWxlcy5maWx0ZXIgJiYgY29sdW1uLm1vZHVsZXMuZmlsdGVyLmhlYWRlckVsZW1lbnQpIHtcblx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudC5mb2N1cygpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRm9jdXMgRXJyb3IgLSBObyBoZWFkZXIgZmlsdGVyIHNldCBvbiBjb2x1bW46XCIsIGNvbHVtbi5nZXRGaWVsZCgpKTtcblx0fVxufTtcblxuLy9wcm9ncmFtbWF0aWNhbGx5IGdldCB2YWx1ZSBvZiBoZWFkZXIgZmlsdGVyXG5GaWx0ZXIucHJvdG90eXBlLmdldEhlYWRlckZpbHRlclZhbHVlID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHRpZiAoY29sdW1uLm1vZHVsZXMuZmlsdGVyICYmIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50KSB7XG5cdFx0cmV0dXJuIGNvbHVtbi5tb2R1bGVzLmZpbHRlci5oZWFkZXJFbGVtZW50LnZhbHVlO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBoZWFkZXIgZmlsdGVyIHNldCBvbiBjb2x1bW46XCIsIGNvbHVtbi5nZXRGaWVsZCgpKTtcblx0fVxufTtcblxuLy9wcm9ncmFtYXRpY2FsbHkgc2V0IHZhbHVlIG9mIGhlYWRlciBmaWx0ZXJcbkZpbHRlci5wcm90b3R5cGUuc2V0SGVhZGVyRmlsdGVyVmFsdWUgPSBmdW5jdGlvbiAoY29sdW1uLCB2YWx1ZSkge1xuXHRpZiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZpbHRlciAmJiBjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudCkge1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUhlYWRlckZpbHRlckVsZW1lbnQoY29sdW1uLCB2YWx1ZSwgdHJ1ZSk7XG5cdFx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIuc3VjY2Vzcyh2YWx1ZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkNvbHVtbiBGaWx0ZXIgRXJyb3IgLSBObyBoZWFkZXIgZmlsdGVyIHNldCBvbiBjb2x1bW46XCIsIGNvbHVtbi5nZXRGaWVsZCgpKTtcblx0XHR9XG5cdH1cbn07XG5cbkZpbHRlci5wcm90b3R5cGUucmVsb2FkSGVhZGVyRmlsdGVyID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHRpZiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZpbHRlciAmJiBjb2x1bW4ubW9kdWxlcy5maWx0ZXIuaGVhZGVyRWxlbWVudCkge1xuXHRcdFx0dGhpcy5nZW5lcmF0ZUhlYWRlckZpbHRlckVsZW1lbnQoY29sdW1uLCBjb2x1bW4ubW9kdWxlcy5maWx0ZXIudmFsdWUsIHRydWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJDb2x1bW4gRmlsdGVyIEVycm9yIC0gTm8gaGVhZGVyIGZpbHRlciBzZXQgb24gY29sdW1uOlwiLCBjb2x1bW4uZ2V0RmllbGQoKSk7XG5cdFx0fVxuXHR9XG59O1xuXG4vL2NoZWNrIGlmIHRoZSBmaWx0ZXJzIGhhcyBjaGFuZ2VkIHNpbmNlIGxhc3QgdXNlXG5GaWx0ZXIucHJvdG90eXBlLmhhc0NoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjaGFuZ2VkID0gdGhpcy5jaGFuZ2VkO1xuXHR0aGlzLmNoYW5nZWQgPSBmYWxzZTtcblx0cmV0dXJuIGNoYW5nZWQ7XG59O1xuXG4vL3NldCBzdGFuZGFyZCBmaWx0ZXJzXG5GaWx0ZXIucHJvdG90eXBlLnNldEZpbHRlciA9IGZ1bmN0aW9uIChmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcykge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0c2VsZi5maWx0ZXJMaXN0ID0gW107XG5cblx0aWYgKCFBcnJheS5pc0FycmF5KGZpZWxkKSkge1xuXHRcdGZpZWxkID0gW3sgZmllbGQ6IGZpZWxkLCB0eXBlOiB0eXBlLCB2YWx1ZTogdmFsdWUsIHBhcmFtczogcGFyYW1zIH1dO1xuXHR9XG5cblx0c2VsZi5hZGRGaWx0ZXIoZmllbGQpO1xufTtcblxuLy9hZGQgZmlsdGVyIHRvIGFycmF5XG5GaWx0ZXIucHJvdG90eXBlLmFkZEZpbHRlciA9IGZ1bmN0aW9uIChmaWVsZCwgdHlwZSwgdmFsdWUsIHBhcmFtcykge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0aWYgKCFBcnJheS5pc0FycmF5KGZpZWxkKSkge1xuXHRcdGZpZWxkID0gW3sgZmllbGQ6IGZpZWxkLCB0eXBlOiB0eXBlLCB2YWx1ZTogdmFsdWUsIHBhcmFtczogcGFyYW1zIH1dO1xuXHR9XG5cblx0ZmllbGQuZm9yRWFjaChmdW5jdGlvbiAoZmlsdGVyKSB7XG5cblx0XHRmaWx0ZXIgPSBzZWxmLmZpbmRGaWx0ZXIoZmlsdGVyKTtcblxuXHRcdGlmIChmaWx0ZXIpIHtcblx0XHRcdHNlbGYuZmlsdGVyTGlzdC5wdXNoKGZpbHRlcik7XG5cblx0XHRcdHNlbGYuY2hhbmdlZCA9IHRydWU7XG5cdFx0fVxuXHR9KTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgdGhpcy50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5maWx0ZXIpIHtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2Uuc2F2ZShcImZpbHRlclwiKTtcblx0fVxufTtcblxuRmlsdGVyLnByb3RvdHlwZS5maW5kRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBjb2x1bW47XG5cblx0aWYgKEFycmF5LmlzQXJyYXkoZmlsdGVyKSkge1xuXHRcdHJldHVybiB0aGlzLmZpbmRTdWJGaWx0ZXJzKGZpbHRlcik7XG5cdH1cblxuXHR2YXIgZmlsdGVyRnVuYyA9IGZhbHNlO1xuXG5cdGlmICh0eXBlb2YgZmlsdGVyLmZpZWxkID09IFwiZnVuY3Rpb25cIikge1xuXHRcdGZpbHRlckZ1bmMgPSBmdW5jdGlvbiBmaWx0ZXJGdW5jKGRhdGEpIHtcblx0XHRcdHJldHVybiBmaWx0ZXIuZmllbGQoZGF0YSwgZmlsdGVyLnR5cGUgfHwge30pOyAvLyBwYXNzIHBhcmFtcyB0byBjdXN0b20gZmlsdGVyIGZ1bmN0aW9uXG5cdFx0fTtcblx0fSBlbHNlIHtcblxuXHRcdGlmIChzZWxmLmZpbHRlcnNbZmlsdGVyLnR5cGVdKSB7XG5cblx0XHRcdGNvbHVtbiA9IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUZpZWxkKGZpbHRlci5maWVsZCk7XG5cblx0XHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uIGZpbHRlckZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLmZpbHRlcnNbZmlsdGVyLnR5cGVdKGZpbHRlci52YWx1ZSwgY29sdW1uLmdldEZpZWxkVmFsdWUoZGF0YSksIGRhdGEsIGZpbHRlci5wYXJhbXMgfHwge30pO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZmlsdGVyRnVuYyA9IGZ1bmN0aW9uIGZpbHRlckZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdHJldHVybiBzZWxmLmZpbHRlcnNbZmlsdGVyLnR5cGVdKGZpbHRlci52YWx1ZSwgZGF0YVtmaWx0ZXIuZmllbGRdLCBkYXRhLCBmaWx0ZXIucGFyYW1zIHx8IHt9KTtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gTm8gc3VjaCBmaWx0ZXIgdHlwZSBmb3VuZCwgaWdub3Jpbmc6IFwiLCBmaWx0ZXIudHlwZSk7XG5cdFx0fVxuXHR9XG5cblx0ZmlsdGVyLmZ1bmMgPSBmaWx0ZXJGdW5jO1xuXG5cdHJldHVybiBmaWx0ZXIuZnVuYyA/IGZpbHRlciA6IGZhbHNlO1xufTtcblxuRmlsdGVyLnByb3RvdHlwZS5maW5kU3ViRmlsdGVycyA9IGZ1bmN0aW9uIChmaWx0ZXJzKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIG91dHB1dCA9IFtdO1xuXG5cdGZpbHRlcnMuZm9yRWFjaChmdW5jdGlvbiAoZmlsdGVyKSB7XG5cdFx0ZmlsdGVyID0gc2VsZi5maW5kRmlsdGVyKGZpbHRlcik7XG5cblx0XHRpZiAoZmlsdGVyKSB7XG5cdFx0XHRvdXRwdXQucHVzaChmaWx0ZXIpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIG91dHB1dC5sZW5ndGggPyBvdXRwdXQgOiBmYWxzZTtcbn07XG5cbi8vZ2V0IGFsbCBmaWx0ZXJzXG5GaWx0ZXIucHJvdG90eXBlLmdldEZpbHRlcnMgPSBmdW5jdGlvbiAoYWxsLCBhamF4KSB7XG5cdHZhciBvdXRwdXQgPSBbXTtcblxuXHRpZiAoYWxsKSB7XG5cdFx0b3V0cHV0ID0gdGhpcy5nZXRIZWFkZXJGaWx0ZXJzKCk7XG5cdH1cblxuXHRpZiAoYWpheCkge1xuXHRcdG91dHB1dC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRpZiAodHlwZW9mIGl0ZW0udHlwZSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0aXRlbS50eXBlID0gXCJmdW5jdGlvblwiO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdCh0aGlzLmZpbHRlcnNUb0FycmF5KHRoaXMuZmlsdGVyTGlzdCwgYWpheCkpO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG4vL2ZpbHRlciB0byBPYmplY3RcbkZpbHRlci5wcm90b3R5cGUuZmlsdGVyc1RvQXJyYXkgPSBmdW5jdGlvbiAoZmlsdGVyTGlzdCwgYWpheCkge1xuXHR2YXIgX3RoaXM2MyA9IHRoaXM7XG5cblx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdGZpbHRlckxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZmlsdGVyKSB7XG5cdFx0dmFyIGl0ZW07XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXIpKSB7XG5cdFx0XHRvdXRwdXQucHVzaChfdGhpczYzLmZpbHRlcnNUb0FycmF5KGZpbHRlciwgYWpheCkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpdGVtID0geyBmaWVsZDogZmlsdGVyLmZpZWxkLCB0eXBlOiBmaWx0ZXIudHlwZSwgdmFsdWU6IGZpbHRlci52YWx1ZSB9O1xuXG5cdFx0XHRpZiAoYWpheCkge1xuXHRcdFx0XHRpZiAodHlwZW9mIGl0ZW0udHlwZSA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0XHRpdGVtLnR5cGUgPSBcImZ1bmN0aW9uXCI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0b3V0cHV0LnB1c2goaXRlbSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuLy9nZXQgYWxsIGZpbHRlcnNcbkZpbHRlci5wcm90b3R5cGUuZ2V0SGVhZGVyRmlsdGVycyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0Zm9yICh2YXIga2V5IGluIHRoaXMuaGVhZGVyRmlsdGVycykge1xuXHRcdG91dHB1dC5wdXNoKHsgZmllbGQ6IGtleSwgdHlwZTogdGhpcy5oZWFkZXJGaWx0ZXJzW2tleV0udHlwZSwgdmFsdWU6IHRoaXMuaGVhZGVyRmlsdGVyc1trZXldLnZhbHVlIH0pO1xuXHR9XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbi8vcmVtb3ZlIGZpbHRlciBmcm9tIGFycmF5XG5GaWx0ZXIucHJvdG90eXBlLnJlbW92ZUZpbHRlciA9IGZ1bmN0aW9uIChmaWVsZCwgdHlwZSwgdmFsdWUpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdGlmICghQXJyYXkuaXNBcnJheShmaWVsZCkpIHtcblx0XHRmaWVsZCA9IFt7IGZpZWxkOiBmaWVsZCwgdHlwZTogdHlwZSwgdmFsdWU6IHZhbHVlIH1dO1xuXHR9XG5cblx0ZmllbGQuZm9yRWFjaChmdW5jdGlvbiAoZmlsdGVyKSB7XG5cdFx0dmFyIGluZGV4ID0gLTE7XG5cblx0XHRpZiAoX3R5cGVvZihmaWx0ZXIuZmllbGQpID09IFwib2JqZWN0XCIpIHtcblx0XHRcdGluZGV4ID0gc2VsZi5maWx0ZXJMaXN0LmZpbmRJbmRleChmdW5jdGlvbiAoZWxlbWVudCkge1xuXHRcdFx0XHRyZXR1cm4gZmlsdGVyID09PSBlbGVtZW50O1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGluZGV4ID0gc2VsZi5maWx0ZXJMaXN0LmZpbmRJbmRleChmdW5jdGlvbiAoZWxlbWVudCkge1xuXHRcdFx0XHRyZXR1cm4gZmlsdGVyLmZpZWxkID09PSBlbGVtZW50LmZpZWxkICYmIGZpbHRlci50eXBlID09PSBlbGVtZW50LnR5cGUgJiYgZmlsdGVyLnZhbHVlID09PSBlbGVtZW50LnZhbHVlO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKGluZGV4ID4gLTEpIHtcblx0XHRcdHNlbGYuZmlsdGVyTGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0c2VsZi5jaGFuZ2VkID0gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gTm8gbWF0Y2hpbmcgZmlsdGVyIHR5cGUgZm91bmQsIGlnbm9yaW5nOiBcIiwgZmlsdGVyLnR5cGUpO1xuXHRcdH1cblx0fSk7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuZmlsdGVyKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJmaWx0ZXJcIik7XG5cdH1cbn07XG5cbi8vY2xlYXIgZmlsdGVyc1xuRmlsdGVyLnByb3RvdHlwZS5jbGVhckZpbHRlciA9IGZ1bmN0aW9uIChhbGwpIHtcblx0dGhpcy5maWx0ZXJMaXN0ID0gW107XG5cblx0aWYgKGFsbCkge1xuXHRcdHRoaXMuY2xlYXJIZWFkZXJGaWx0ZXIoKTtcblx0fVxuXG5cdHRoaXMuY2hhbmdlZCA9IHRydWU7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuZmlsdGVyKSB7XG5cdFx0dGhpcy50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJmaWx0ZXJcIik7XG5cdH1cbn07XG5cbi8vY2xlYXIgaGVhZGVyIGZpbHRlcnNcbkZpbHRlci5wcm90b3R5cGUuY2xlYXJIZWFkZXJGaWx0ZXIgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHR0aGlzLmhlYWRlckZpbHRlcnMgPSB7fTtcblx0c2VsZi5wcmV2SGVhZGVyRmlsdGVyQ2hhbmdlQ2hlY2sgPSBcInt9XCI7XG5cblx0dGhpcy5oZWFkZXJGaWx0ZXJDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGlmICh0eXBlb2YgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRkZWxldGUgY29sdW1uLm1vZHVsZXMuZmlsdGVyLnZhbHVlO1xuXHRcdH1cblx0XHRjb2x1bW4ubW9kdWxlcy5maWx0ZXIucHJldlN1Y2Nlc3MgPSB1bmRlZmluZWQ7XG5cdFx0c2VsZi5yZWxvYWRIZWFkZXJGaWx0ZXIoY29sdW1uKTtcblx0fSk7XG5cblx0dGhpcy5jaGFuZ2VkID0gdHJ1ZTtcbn07XG5cbi8vc2VhcmNoIGRhdGEgYW5kIHJldHVybiBtYXRjaGluZyByb3dzXG5GaWx0ZXIucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uIChzZWFyY2hUeXBlLCBmaWVsZCwgdHlwZSwgdmFsdWUpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgYWN0aXZlUm93cyA9IFtdLFxuXHQgICAgZmlsdGVyTGlzdCA9IFtdO1xuXG5cdGlmICghQXJyYXkuaXNBcnJheShmaWVsZCkpIHtcblx0XHRmaWVsZCA9IFt7IGZpZWxkOiBmaWVsZCwgdHlwZTogdHlwZSwgdmFsdWU6IHZhbHVlIH1dO1xuXHR9XG5cblx0ZmllbGQuZm9yRWFjaChmdW5jdGlvbiAoZmlsdGVyKSB7XG5cdFx0ZmlsdGVyID0gc2VsZi5maW5kRmlsdGVyKGZpbHRlcik7XG5cblx0XHRpZiAoZmlsdGVyKSB7XG5cdFx0XHRmaWx0ZXJMaXN0LnB1c2goZmlsdGVyKTtcblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMudGFibGUucm93TWFuYWdlci5yb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdHZhciBtYXRjaCA9IHRydWU7XG5cblx0XHRmaWx0ZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKGZpbHRlcikge1xuXHRcdFx0aWYgKCFzZWxmLmZpbHRlclJlY3Vyc2UoZmlsdGVyLCByb3cuZ2V0RGF0YSgpKSkge1xuXHRcdFx0XHRtYXRjaCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRhY3RpdmVSb3dzLnB1c2goc2VhcmNoVHlwZSA9PT0gXCJkYXRhXCIgPyByb3cuZ2V0RGF0YShcImRhdGFcIikgOiByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGFjdGl2ZVJvd3M7XG59O1xuXG4vL2ZpbHRlciByb3cgYXJyYXlcbkZpbHRlci5wcm90b3R5cGUuZmlsdGVyID0gZnVuY3Rpb24gKHJvd0xpc3QsIGZpbHRlcnMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgYWN0aXZlUm93cyA9IFtdLFxuXHQgICAgYWN0aXZlUm93Q29tcG9uZW50cyA9IFtdO1xuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YUZpbHRlcmluZykge1xuXHRcdHNlbGYudGFibGUub3B0aW9ucy5kYXRhRmlsdGVyaW5nLmNhbGwoc2VsZi50YWJsZSwgc2VsZi5nZXRGaWx0ZXJzKCkpO1xuXHR9XG5cblx0aWYgKCFzZWxmLnRhYmxlLm9wdGlvbnMuYWpheEZpbHRlcmluZyAmJiAoc2VsZi5maWx0ZXJMaXN0Lmxlbmd0aCB8fCBPYmplY3Qua2V5cyhzZWxmLmhlYWRlckZpbHRlcnMpLmxlbmd0aCkpIHtcblxuXHRcdHJvd0xpc3QuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRpZiAoc2VsZi5maWx0ZXJSb3cocm93KSkge1xuXHRcdFx0XHRhY3RpdmVSb3dzLnB1c2gocm93KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHRhY3RpdmVSb3dzID0gcm93TGlzdC5zbGljZSgwKTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YUZpbHRlcmVkKSB7XG5cblx0XHRhY3RpdmVSb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0YWN0aXZlUm93Q29tcG9uZW50cy5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cblx0XHRzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YUZpbHRlcmVkLmNhbGwoc2VsZi50YWJsZSwgc2VsZi5nZXRGaWx0ZXJzKCksIGFjdGl2ZVJvd0NvbXBvbmVudHMpO1xuXHR9XG5cblx0cmV0dXJuIGFjdGl2ZVJvd3M7XG59O1xuXG4vL2ZpbHRlciBpbmRpdmlkdWFsIHJvd1xuRmlsdGVyLnByb3RvdHlwZS5maWx0ZXJSb3cgPSBmdW5jdGlvbiAocm93LCBmaWx0ZXJzKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIG1hdGNoID0gdHJ1ZSxcblx0ICAgIGRhdGEgPSByb3cuZ2V0RGF0YSgpO1xuXG5cdHNlbGYuZmlsdGVyTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmaWx0ZXIpIHtcblx0XHRpZiAoIXNlbGYuZmlsdGVyUmVjdXJzZShmaWx0ZXIsIGRhdGEpKSB7XG5cdFx0XHRtYXRjaCA9IGZhbHNlO1xuXHRcdH1cblx0fSk7XG5cblx0Zm9yICh2YXIgZmllbGQgaW4gc2VsZi5oZWFkZXJGaWx0ZXJzKSB7XG5cdFx0aWYgKCFzZWxmLmhlYWRlckZpbHRlcnNbZmllbGRdLmZ1bmMoZGF0YSkpIHtcblx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIG1hdGNoO1xufTtcblxuRmlsdGVyLnByb3RvdHlwZS5maWx0ZXJSZWN1cnNlID0gZnVuY3Rpb24gKGZpbHRlciwgZGF0YSkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBtYXRjaCA9IGZhbHNlO1xuXG5cdGlmIChBcnJheS5pc0FycmF5KGZpbHRlcikpIHtcblx0XHRmaWx0ZXIuZm9yRWFjaChmdW5jdGlvbiAoc3ViRmlsdGVyKSB7XG5cdFx0XHRpZiAoc2VsZi5maWx0ZXJSZWN1cnNlKHN1YkZpbHRlciwgZGF0YSkpIHtcblx0XHRcdFx0bWF0Y2ggPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdG1hdGNoID0gZmlsdGVyLmZ1bmMoZGF0YSk7XG5cdH1cblxuXHRyZXR1cm4gbWF0Y2g7XG59O1xuXG4vL2xpc3Qgb2YgYXZhaWxhYmxlIGZpbHRlcnNcbkZpbHRlci5wcm90b3R5cGUuZmlsdGVycyA9IHtcblxuXHQvL2VxdWFsIHRvXG5cdFwiPVwiOiBmdW5jdGlvbiBfKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpIHtcblx0XHRyZXR1cm4gcm93VmFsID09IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0fSxcblxuXHQvL2xlc3MgdGhhblxuXHRcIjxcIjogZnVuY3Rpb24gXyhmaWx0ZXJWYWwsIHJvd1ZhbCwgcm93RGF0YSwgZmlsdGVyUGFyYW1zKSB7XG5cdFx0cmV0dXJuIHJvd1ZhbCA8IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0fSxcblxuXHQvL2xlc3MgdGhhbiBvciBlcXVhbCB0b1xuXHRcIjw9XCI6IGZ1bmN0aW9uIF8oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcykge1xuXHRcdHJldHVybiByb3dWYWwgPD0gZmlsdGVyVmFsID8gdHJ1ZSA6IGZhbHNlO1xuXHR9LFxuXG5cdC8vZ3JlYXRlciB0aGFuXG5cdFwiPlwiOiBmdW5jdGlvbiBfKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpIHtcblx0XHRyZXR1cm4gcm93VmFsID4gZmlsdGVyVmFsID8gdHJ1ZSA6IGZhbHNlO1xuXHR9LFxuXG5cdC8vZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvXG5cdFwiPj1cIjogZnVuY3Rpb24gXyhmaWx0ZXJWYWwsIHJvd1ZhbCwgcm93RGF0YSwgZmlsdGVyUGFyYW1zKSB7XG5cdFx0cmV0dXJuIHJvd1ZhbCA+PSBmaWx0ZXJWYWwgPyB0cnVlIDogZmFsc2U7XG5cdH0sXG5cblx0Ly9ub3QgZXF1YWwgdG9cblx0XCIhPVwiOiBmdW5jdGlvbiBfKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpIHtcblx0XHRyZXR1cm4gcm93VmFsICE9IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0fSxcblxuXHRcInJlZ2V4XCI6IGZ1bmN0aW9uIHJlZ2V4KGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpIHtcblxuXHRcdGlmICh0eXBlb2YgZmlsdGVyVmFsID09IFwic3RyaW5nXCIpIHtcblx0XHRcdGZpbHRlclZhbCA9IG5ldyBSZWdFeHAoZmlsdGVyVmFsKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmlsdGVyVmFsLnRlc3Qocm93VmFsKTtcblx0fSxcblxuXHQvL2NvbnRhaW5zIHRoZSBzdHJpbmdcblx0XCJsaWtlXCI6IGZ1bmN0aW9uIGxpa2UoZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcykge1xuXHRcdGlmIChmaWx0ZXJWYWwgPT09IG51bGwgfHwgdHlwZW9mIGZpbHRlclZhbCA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0cmV0dXJuIHJvd1ZhbCA9PT0gZmlsdGVyVmFsID8gdHJ1ZSA6IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAodHlwZW9mIHJvd1ZhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgcm93VmFsICE9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiBTdHJpbmcocm93VmFsKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoZmlsdGVyVmFsLnRvTG93ZXJDYXNlKCkpID4gLTE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vY29udGFpbnMgdGhlIGtleXdvcmRzXG5cdFwia2V5d29yZHNcIjogZnVuY3Rpb24ga2V5d29yZHMoZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcykge1xuXHRcdHZhciBrZXl3b3JkcyA9IGZpbHRlclZhbC50b0xvd2VyQ2FzZSgpLnNwbGl0KHR5cGVvZiBmaWx0ZXJQYXJhbXMuc2VwYXJhdG9yID09PSBcInVuZGVmaW5lZFwiID8gXCIgXCIgOiBmaWx0ZXJQYXJhbXMuc2VwYXJhdG9yKSxcblx0XHQgICAgdmFsdWUgPSBTdHJpbmcocm93VmFsID09PSBudWxsIHx8IHR5cGVvZiByb3dWYWwgPT09IFwidW5kZWZpbmVkXCIgPyBcIlwiIDogcm93VmFsKS50b0xvd2VyQ2FzZSgpLFxuXHRcdCAgICBtYXRjaGVzID0gW107XG5cblx0XHRrZXl3b3Jkcy5mb3JFYWNoKGZ1bmN0aW9uIChrZXl3b3JkKSB7XG5cdFx0XHRpZiAodmFsdWUuaW5jbHVkZXMoa2V5d29yZCkpIHtcblx0XHRcdFx0bWF0Y2hlcy5wdXNoKHRydWUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGZpbHRlclBhcmFtcy5tYXRjaEFsbCA/IG1hdGNoZXMubGVuZ3RoID09PSBrZXl3b3Jkcy5sZW5ndGggOiAhIW1hdGNoZXMubGVuZ3RoO1xuXHR9LFxuXG5cdC8vc3RhcnRzIHdpdGggdGhlIHN0cmluZ1xuXHRcInN0YXJ0c1wiOiBmdW5jdGlvbiBzdGFydHMoZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcykge1xuXHRcdGlmIChmaWx0ZXJWYWwgPT09IG51bGwgfHwgdHlwZW9mIGZpbHRlclZhbCA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0cmV0dXJuIHJvd1ZhbCA9PT0gZmlsdGVyVmFsID8gdHJ1ZSA6IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAodHlwZW9mIHJvd1ZhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgcm93VmFsICE9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiBTdHJpbmcocm93VmFsKS50b0xvd2VyQ2FzZSgpLnN0YXJ0c1dpdGgoZmlsdGVyVmFsLnRvTG93ZXJDYXNlKCkpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvL2VuZHMgd2l0aCB0aGUgc3RyaW5nXG5cdFwiZW5kc1wiOiBmdW5jdGlvbiBlbmRzKGZpbHRlclZhbCwgcm93VmFsLCByb3dEYXRhLCBmaWx0ZXJQYXJhbXMpIHtcblx0XHRpZiAoZmlsdGVyVmFsID09PSBudWxsIHx8IHR5cGVvZiBmaWx0ZXJWYWwgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHJldHVybiByb3dWYWwgPT09IGZpbHRlclZhbCA/IHRydWUgOiBmYWxzZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHR5cGVvZiByb3dWYWwgIT09ICd1bmRlZmluZWQnICYmIHJvd1ZhbCAhPT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm4gU3RyaW5nKHJvd1ZhbCkudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChmaWx0ZXJWYWwudG9Mb3dlckNhc2UoKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vaW4gYXJyYXlcblx0XCJpblwiOiBmdW5jdGlvbiBfaW4oZmlsdGVyVmFsLCByb3dWYWwsIHJvd0RhdGEsIGZpbHRlclBhcmFtcykge1xuXHRcdGlmIChBcnJheS5pc0FycmF5KGZpbHRlclZhbCkpIHtcblx0XHRcdHJldHVybiBmaWx0ZXJWYWwubGVuZ3RoID8gZmlsdGVyVmFsLmluZGV4T2Yocm93VmFsKSA+IC0xIDogdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRmlsdGVyIEVycm9yIC0gZmlsdGVyIHZhbHVlIGlzIG5vdCBhbiBhcnJheTpcIiwgZmlsdGVyVmFsKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJmaWx0ZXJcIiwgRmlsdGVyKTtcblxudmFyIEZvcm1hdCA9IGZ1bmN0aW9uIEZvcm1hdCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG59O1xuXG4vL2luaXRpYWxpemUgY29sdW1uIGZvcm1hdHRlclxuRm9ybWF0LnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHRjb2x1bW4ubW9kdWxlcy5mb3JtYXQgPSB0aGlzLmxvb2t1cEZvcm1hdHRlcihjb2x1bW4sIFwiXCIpO1xuXG5cdGlmICh0eXBlb2YgY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyUHJpbnQgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRjb2x1bW4ubW9kdWxlcy5mb3JtYXQucHJpbnQgPSB0aGlzLmxvb2t1cEZvcm1hdHRlcihjb2x1bW4sIFwiUHJpbnRcIik7XG5cdH1cblxuXHRpZiAodHlwZW9mIGNvbHVtbi5kZWZpbml0aW9uLmZvcm1hdHRlckNsaXBib2FyZCAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdGNvbHVtbi5tb2R1bGVzLmZvcm1hdC5jbGlwYm9hcmQgPSB0aGlzLmxvb2t1cEZvcm1hdHRlcihjb2x1bW4sIFwiQ2xpcGJvYXJkXCIpO1xuXHR9XG5cblx0aWYgKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5mb3JtYXR0ZXJIdG1sT3V0cHV0ICE9PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0Y29sdW1uLm1vZHVsZXMuZm9ybWF0Lmh0bWxPdXRwdXQgPSB0aGlzLmxvb2t1cEZvcm1hdHRlcihjb2x1bW4sIFwiSHRtbE91dHB1dFwiKTtcblx0fVxufTtcblxuRm9ybWF0LnByb3RvdHlwZS5sb29rdXBGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoY29sdW1uLCB0eXBlKSB7XG5cdHZhciBjb25maWcgPSB7IHBhcmFtczogY29sdW1uLmRlZmluaXRpb25bXCJmb3JtYXR0ZXJcIiArIHR5cGUgKyBcIlBhcmFtc1wiXSB8fCB7fSB9LFxuXHQgICAgZm9ybWF0dGVyID0gY29sdW1uLmRlZmluaXRpb25bXCJmb3JtYXR0ZXJcIiArIHR5cGVdO1xuXG5cdC8vc2V0IGNvbHVtbiBmb3JtYXR0ZXJcblx0c3dpdGNoICh0eXBlb2YgZm9ybWF0dGVyID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihmb3JtYXR0ZXIpKSB7XG5cdFx0Y2FzZSBcInN0cmluZ1wiOlxuXG5cdFx0XHRpZiAoZm9ybWF0dGVyID09PSBcInRpY2tcIikge1xuXHRcdFx0XHRmb3JtYXR0ZXIgPSBcInRpY2tDcm9zc1wiO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgY29uZmlnLnBhcmFtcy5jcm9zc0VsZW1lbnQgPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdGNvbmZpZy5wYXJhbXMuY3Jvc3NFbGVtZW50ID0gZmFsc2U7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJERVBSRUNBVElPTiBXQVJOSU5HIC0gdGhlIHRpY2sgZm9ybWF0dGVyIGhhcyBiZWVuIGRlcHJlY2F0ZWQsIHBsZWFzZSB1c2UgdGhlIHRpY2tDcm9zcyBmb3JtYXR0ZXIgd2l0aCB0aGUgY3Jvc3NFbGVtZW50IHBhcmFtIHNldCB0byBmYWxzZVwiKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMuZm9ybWF0dGVyc1tmb3JtYXR0ZXJdKSB7XG5cdFx0XHRcdGNvbmZpZy5mb3JtYXR0ZXIgPSB0aGlzLmZvcm1hdHRlcnNbZm9ybWF0dGVyXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIkZvcm1hdHRlciBFcnJvciAtIE5vIHN1Y2ggZm9ybWF0dGVyIGZvdW5kOiBcIiwgZm9ybWF0dGVyKTtcblx0XHRcdFx0Y29uZmlnLmZvcm1hdHRlciA9IHRoaXMuZm9ybWF0dGVycy5wbGFpbnRleHQ7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0Y29uZmlnLmZvcm1hdHRlciA9IGZvcm1hdHRlcjtcblx0XHRcdGJyZWFrO1xuXG5cdFx0ZGVmYXVsdDpcblx0XHRcdGNvbmZpZy5mb3JtYXR0ZXIgPSB0aGlzLmZvcm1hdHRlcnMucGxhaW50ZXh0O1xuXHRcdFx0YnJlYWs7XG5cdH1cblxuXHRyZXR1cm4gY29uZmlnO1xufTtcblxuRm9ybWF0LnByb3RvdHlwZS5jZWxsUmVuZGVyZWQgPSBmdW5jdGlvbiAoY2VsbCkge1xuXHRpZiAoY2VsbC5tb2R1bGVzLmZvcm1hdCAmJiBjZWxsLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkQ2FsbGJhY2sgJiYgIWNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWQpIHtcblx0XHRjZWxsLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkQ2FsbGJhY2soKTtcblx0XHRjZWxsLm1vZHVsZXMuZm9ybWF0LnJlbmRlcmVkID0gdHJ1ZTtcblx0fVxufTtcblxuLy9yZXR1cm4gYSBmb3JtYXR0ZWQgdmFsdWUgZm9yIGEgY2VsbFxuRm9ybWF0LnByb3RvdHlwZS5mb3JtYXRWYWx1ZSA9IGZ1bmN0aW9uIChjZWxsKSB7XG5cdHZhciBjb21wb25lbnQgPSBjZWxsLmdldENvbXBvbmVudCgpLFxuXHQgICAgcGFyYW1zID0gdHlwZW9mIGNlbGwuY29sdW1uLm1vZHVsZXMuZm9ybWF0LnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gY2VsbC5jb2x1bW4ubW9kdWxlcy5mb3JtYXQucGFyYW1zKGNvbXBvbmVudCkgOiBjZWxsLmNvbHVtbi5tb2R1bGVzLmZvcm1hdC5wYXJhbXM7XG5cblx0ZnVuY3Rpb24gb25SZW5kZXJlZChjYWxsYmFjaykge1xuXHRcdGlmICghY2VsbC5tb2R1bGVzLmZvcm1hdCkge1xuXHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdCA9IHt9O1xuXHRcdH1cblxuXHRcdGNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdGNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWQgPSBmYWxzZTtcblx0fVxuXG5cdHJldHVybiBjZWxsLmNvbHVtbi5tb2R1bGVzLmZvcm1hdC5mb3JtYXR0ZXIuY2FsbCh0aGlzLCBjb21wb25lbnQsIHBhcmFtcywgb25SZW5kZXJlZCk7XG59O1xuXG5Gb3JtYXQucHJvdG90eXBlLmZvcm1hdEV4cG9ydFZhbHVlID0gZnVuY3Rpb24gKGNlbGwsIHR5cGUpIHtcblx0dmFyIGZvcm1hdHRlciA9IGNlbGwuY29sdW1uLm1vZHVsZXMuZm9ybWF0W3R5cGVdLFxuXHQgICAgcGFyYW1zO1xuXG5cdGlmIChmb3JtYXR0ZXIpIHtcblx0XHR2YXIgb25SZW5kZXJlZCA9IGZ1bmN0aW9uIG9uUmVuZGVyZWQoY2FsbGJhY2spIHtcblx0XHRcdGlmICghY2VsbC5tb2R1bGVzLmZvcm1hdCkge1xuXHRcdFx0XHRjZWxsLm1vZHVsZXMuZm9ybWF0ID0ge307XG5cdFx0XHR9XG5cblx0XHRcdGNlbGwubW9kdWxlcy5mb3JtYXQucmVuZGVyZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdFx0Y2VsbC5tb2R1bGVzLmZvcm1hdC5yZW5kZXJlZCA9IGZhbHNlO1xuXHRcdH07XG5cblx0XHRwYXJhbXMgPSB0eXBlb2YgZm9ybWF0dGVyLnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gZm9ybWF0dGVyLnBhcmFtcyhjb21wb25lbnQpIDogZm9ybWF0dGVyLnBhcmFtcztcblxuXHRcdHJldHVybiBmb3JtYXR0ZXIuZm9ybWF0dGVyLmNhbGwodGhpcywgY2VsbC5nZXRDb21wb25lbnQoKSwgcGFyYW1zLCBvblJlbmRlcmVkKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gdGhpcy5mb3JtYXRWYWx1ZShjZWxsKTtcblx0fVxufTtcblxuRm9ybWF0LnByb3RvdHlwZS5zYW5pdGl6ZUhUTUwgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0aWYgKHZhbHVlKSB7XG5cdFx0dmFyIGVudGl0eU1hcCA9IHtcblx0XHRcdCcmJzogJyZhbXA7Jyxcblx0XHRcdCc8JzogJyZsdDsnLFxuXHRcdFx0Jz4nOiAnJmd0OycsXG5cdFx0XHQnXCInOiAnJnF1b3Q7Jyxcblx0XHRcdFwiJ1wiOiAnJiMzOTsnLFxuXHRcdFx0Jy8nOiAnJiN4MkY7Jyxcblx0XHRcdCdgJzogJyYjeDYwOycsXG5cdFx0XHQnPSc6ICcmI3gzRDsnXG5cdFx0fTtcblxuXHRcdHJldHVybiBTdHJpbmcodmFsdWUpLnJlcGxhY2UoL1smPD5cIidgPVxcL10vZywgZnVuY3Rpb24gKHMpIHtcblx0XHRcdHJldHVybiBlbnRpdHlNYXBbc107XG5cdFx0fSk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9XG59O1xuXG5Gb3JtYXQucHJvdG90eXBlLmVtcHR5VG9TcGFjZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRyZXR1cm4gdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiIHx8IHZhbHVlID09PSBcIlwiID8gXCImbmJzcDtcIiA6IHZhbHVlO1xufTtcblxuLy9nZXQgZm9ybWF0dGVyIGZvciBjZWxsXG5Gb3JtYXQucHJvdG90eXBlLmdldEZvcm1hdHRlciA9IGZ1bmN0aW9uIChmb3JtYXR0ZXIpIHtcblx0dmFyIGZvcm1hdHRlcjtcblxuXHRzd2l0Y2ggKHR5cGVvZiBmb3JtYXR0ZXIgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGZvcm1hdHRlcikpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRpZiAodGhpcy5mb3JtYXR0ZXJzW2Zvcm1hdHRlcl0pIHtcblx0XHRcdFx0Zm9ybWF0dGVyID0gdGhpcy5mb3JtYXR0ZXJzW2Zvcm1hdHRlcl07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJGb3JtYXR0ZXIgRXJyb3IgLSBObyBzdWNoIGZvcm1hdHRlciBmb3VuZDogXCIsIGZvcm1hdHRlcik7XG5cdFx0XHRcdGZvcm1hdHRlciA9IHRoaXMuZm9ybWF0dGVycy5wbGFpbnRleHQ7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0Zm9ybWF0dGVyID0gZm9ybWF0dGVyO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRkZWZhdWx0OlxuXHRcdFx0Zm9ybWF0dGVyID0gdGhpcy5mb3JtYXR0ZXJzLnBsYWludGV4dDtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0cmV0dXJuIGZvcm1hdHRlcjtcbn07XG5cbi8vZGVmYXVsdCBkYXRhIGZvcm1hdHRlcnNcbkZvcm1hdC5wcm90b3R5cGUuZm9ybWF0dGVycyA9IHtcblx0Ly9wbGFpbiB0ZXh0IHZhbHVlXG5cdHBsYWludGV4dDogZnVuY3Rpb24gcGxhaW50ZXh0KGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHJldHVybiB0aGlzLmVtcHR5VG9TcGFjZSh0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpKTtcblx0fSxcblxuXHQvL2h0bWwgdGV4dCB2YWx1ZVxuXHRodG1sOiBmdW5jdGlvbiBodG1sKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHJldHVybiBjZWxsLmdldFZhbHVlKCk7XG5cdH0sXG5cblx0Ly9tdWx0aWxpbmUgdGV4dCBhcmVhXG5cdHRleHRhcmVhOiBmdW5jdGlvbiB0ZXh0YXJlYShjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpIHtcblx0XHRjZWxsLmdldEVsZW1lbnQoKS5zdHlsZS53aGl0ZVNwYWNlID0gXCJwcmUtd3JhcFwiO1xuXHRcdHJldHVybiB0aGlzLmVtcHR5VG9TcGFjZSh0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpKTtcblx0fSxcblxuXHQvL2N1cnJlbmN5IGZvcm1hdHRpbmdcblx0bW9uZXk6IGZ1bmN0aW9uIG1vbmV5KGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciBmbG9hdFZhbCA9IHBhcnNlRmxvYXQoY2VsbC5nZXRWYWx1ZSgpKSxcblx0XHQgICAgbnVtYmVyLFxuXHRcdCAgICBpbnRlZ2VyLFxuXHRcdCAgICBkZWNpbWFsLFxuXHRcdCAgICByZ3g7XG5cblx0XHR2YXIgZGVjaW1hbFN5bSA9IGZvcm1hdHRlclBhcmFtcy5kZWNpbWFsIHx8IFwiLlwiO1xuXHRcdHZhciB0aG91c2FuZFN5bSA9IGZvcm1hdHRlclBhcmFtcy50aG91c2FuZCB8fCBcIixcIjtcblx0XHR2YXIgc3ltYm9sID0gZm9ybWF0dGVyUGFyYW1zLnN5bWJvbCB8fCBcIlwiO1xuXHRcdHZhciBhZnRlciA9ICEhZm9ybWF0dGVyUGFyYW1zLnN5bWJvbEFmdGVyO1xuXHRcdHZhciBwcmVjaXNpb24gPSB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLnByZWNpc2lvbiAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy5wcmVjaXNpb24gOiAyO1xuXG5cdFx0aWYgKGlzTmFOKGZsb2F0VmFsKSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZW1wdHlUb1NwYWNlKHRoaXMuc2FuaXRpemVIVE1MKGNlbGwuZ2V0VmFsdWUoKSkpO1xuXHRcdH1cblxuXHRcdG51bWJlciA9IHByZWNpc2lvbiAhPT0gZmFsc2UgPyBmbG9hdFZhbC50b0ZpeGVkKHByZWNpc2lvbikgOiBmbG9hdFZhbDtcblx0XHRudW1iZXIgPSBTdHJpbmcobnVtYmVyKS5zcGxpdChcIi5cIik7XG5cblx0XHRpbnRlZ2VyID0gbnVtYmVyWzBdO1xuXHRcdGRlY2ltYWwgPSBudW1iZXIubGVuZ3RoID4gMSA/IGRlY2ltYWxTeW0gKyBudW1iZXJbMV0gOiBcIlwiO1xuXG5cdFx0cmd4ID0gLyhcXGQrKShcXGR7M30pLztcblxuXHRcdHdoaWxlIChyZ3gudGVzdChpbnRlZ2VyKSkge1xuXHRcdFx0aW50ZWdlciA9IGludGVnZXIucmVwbGFjZShyZ3gsIFwiJDFcIiArIHRob3VzYW5kU3ltICsgXCIkMlwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gYWZ0ZXIgPyBpbnRlZ2VyICsgZGVjaW1hbCArIHN5bWJvbCA6IHN5bWJvbCArIGludGVnZXIgKyBkZWNpbWFsO1xuXHR9LFxuXG5cdC8vY2xpY2thYmxlIGFuY2hvciB0YWdcblx0bGluazogZnVuY3Rpb24gbGluayhjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpIHtcblx0XHR2YXIgdmFsdWUgPSBjZWxsLmdldFZhbHVlKCksXG5cdFx0ICAgIHVybFByZWZpeCA9IGZvcm1hdHRlclBhcmFtcy51cmxQcmVmaXggfHwgXCJcIixcblx0XHQgICAgZG93bmxvYWQgPSBmb3JtYXR0ZXJQYXJhbXMuZG93bmxvYWQsXG5cdFx0ICAgIGxhYmVsID0gdmFsdWUsXG5cdFx0ICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIiksXG5cdFx0ICAgIGRhdGE7XG5cblx0XHRpZiAoZm9ybWF0dGVyUGFyYW1zLmxhYmVsRmllbGQpIHtcblx0XHRcdGRhdGEgPSBjZWxsLmdldERhdGEoKTtcblx0XHRcdGxhYmVsID0gZGF0YVtmb3JtYXR0ZXJQYXJhbXMubGFiZWxGaWVsZF07XG5cdFx0fVxuXG5cdFx0aWYgKGZvcm1hdHRlclBhcmFtcy5sYWJlbCkge1xuXHRcdFx0c3dpdGNoIChfdHlwZW9mKGZvcm1hdHRlclBhcmFtcy5sYWJlbCkpIHtcblx0XHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRcdGxhYmVsID0gZm9ybWF0dGVyUGFyYW1zLmxhYmVsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdGxhYmVsID0gZm9ybWF0dGVyUGFyYW1zLmxhYmVsKGNlbGwpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChsYWJlbCkge1xuXHRcdFx0aWYgKGZvcm1hdHRlclBhcmFtcy51cmxGaWVsZCkge1xuXHRcdFx0XHRkYXRhID0gY2VsbC5nZXREYXRhKCk7XG5cdFx0XHRcdHZhbHVlID0gZGF0YVtmb3JtYXR0ZXJQYXJhbXMudXJsRmllbGRdO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZm9ybWF0dGVyUGFyYW1zLnVybCkge1xuXHRcdFx0XHRzd2l0Y2ggKF90eXBlb2YoZm9ybWF0dGVyUGFyYW1zLnVybCkpIHtcblx0XHRcdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdFx0XHR2YWx1ZSA9IGZvcm1hdHRlclBhcmFtcy51cmw7XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdFx0dmFsdWUgPSBmb3JtYXR0ZXJQYXJhbXMudXJsKGNlbGwpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0ZWwuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCB1cmxQcmVmaXggKyB2YWx1ZSk7XG5cblx0XHRcdGlmIChmb3JtYXR0ZXJQYXJhbXMudGFyZ2V0KSB7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBmb3JtYXR0ZXJQYXJhbXMudGFyZ2V0KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGZvcm1hdHRlclBhcmFtcy5kb3dubG9hZCkge1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgZG93bmxvYWQgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRcdFx0ZG93bmxvYWQgPSBkb3dubG9hZChjZWxsKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRkb3dubG9hZCA9IGRvd25sb2FkID09PSB0cnVlID8gXCJcIiA6IGRvd25sb2FkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlKFwiZG93bmxvYWRcIiwgZG93bmxvYWQpO1xuXHRcdFx0fVxuXG5cdFx0XHRlbC5pbm5lckhUTUwgPSB0aGlzLmVtcHR5VG9TcGFjZSh0aGlzLnNhbml0aXplSFRNTChsYWJlbCkpO1xuXG5cdFx0XHRyZXR1cm4gZWw7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBcIiZuYnNwO1wiO1xuXHRcdH1cblx0fSxcblxuXHQvL2ltYWdlIGVsZW1lbnRcblx0aW1hZ2U6IGZ1bmN0aW9uIGltYWdlKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiksXG5cdFx0ICAgIHNyYyA9IGNlbGwuZ2V0VmFsdWUoKTtcblxuXHRcdGlmIChmb3JtYXR0ZXJQYXJhbXMudXJsUHJlZml4KSB7XG5cdFx0XHRzcmMgPSBmb3JtYXR0ZXJQYXJhbXMudXJsUHJlZml4ICsgY2VsbC5nZXRWYWx1ZSgpO1xuXHRcdH1cblxuXHRcdGlmIChmb3JtYXR0ZXJQYXJhbXMudXJsU3VmZml4KSB7XG5cdFx0XHRzcmMgPSBzcmMgKyBmb3JtYXR0ZXJQYXJhbXMudXJsU3VmZml4O1xuXHRcdH1cblxuXHRcdGVsLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xuXG5cdFx0c3dpdGNoIChfdHlwZW9mKGZvcm1hdHRlclBhcmFtcy5oZWlnaHQpKSB7XG5cdFx0XHRjYXNlIFwibnVtYmVyXCI6XG5cdFx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGZvcm1hdHRlclBhcmFtcy5oZWlnaHQgKyBcInB4XCI7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGZvcm1hdHRlclBhcmFtcy5oZWlnaHQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdHN3aXRjaCAoX3R5cGVvZihmb3JtYXR0ZXJQYXJhbXMud2lkdGgpKSB7XG5cdFx0XHRjYXNlIFwibnVtYmVyXCI6XG5cdFx0XHRcdGVsLnN0eWxlLndpZHRoID0gZm9ybWF0dGVyUGFyYW1zLndpZHRoICsgXCJweFwiO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRlbC5zdHlsZS53aWR0aCA9IGZvcm1hdHRlclBhcmFtcy53aWR0aDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xuXHRcdFx0Y2VsbC5nZXRSb3coKS5ub3JtYWxpemVIZWlnaHQoKTtcblx0XHR9KTtcblxuXHRcdHJldHVybiBlbDtcblx0fSxcblxuXHQvL3RpY2sgb3IgY3Jvc3Ncblx0dGlja0Nyb3NzOiBmdW5jdGlvbiB0aWNrQ3Jvc3MoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpLFxuXHRcdCAgICBlbGVtZW50ID0gY2VsbC5nZXRFbGVtZW50KCksXG5cdFx0ICAgIGVtcHR5ID0gZm9ybWF0dGVyUGFyYW1zLmFsbG93RW1wdHksXG5cdFx0ICAgIHRydXRoeSA9IGZvcm1hdHRlclBhcmFtcy5hbGxvd1RydXRoeSxcblx0XHQgICAgdGljayA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMudGlja0VsZW1lbnQgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMudGlja0VsZW1lbnQgOiAnPHN2ZyBlbmFibGUtYmFja2dyb3VuZD1cIm5ldyAwIDAgMjQgMjRcIiBoZWlnaHQ9XCIxNFwiIHdpZHRoPVwiMTRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgeG1sOnNwYWNlPVwicHJlc2VydmVcIiA+PHBhdGggZmlsbD1cIiMyREMyMTRcIiBjbGlwLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0yMS42NTIsMy4yMTFjLTAuMjkzLTAuMjk1LTAuNzctMC4yOTUtMS4wNjEsMEw5LjQxLDE0LjM0ICBjLTAuMjkzLDAuMjk3LTAuNzcxLDAuMjk3LTEuMDYyLDBMMy40NDksOS4zNTFDMy4zMDQsOS4yMDMsMy4xMTQsOS4xMywyLjkyMyw5LjEyOUMyLjczLDkuMTI4LDIuNTM0LDkuMjAxLDIuMzg3LDkuMzUxICBsLTIuMTY1LDEuOTQ2QzAuMDc4LDExLjQ0NSwwLDExLjYzLDAsMTEuODIzYzAsMC4xOTQsMC4wNzgsMC4zOTcsMC4yMjMsMC41NDRsNC45NCw1LjE4NGMwLjI5MiwwLjI5NiwwLjc3MSwwLjc3NiwxLjA2MiwxLjA3ICBsMi4xMjQsMi4xNDFjMC4yOTIsMC4yOTMsMC43NjksMC4yOTMsMS4wNjIsMGwxNC4zNjYtMTQuMzRjMC4yOTMtMC4yOTQsMC4yOTMtMC43NzcsMC0xLjA3MUwyMS42NTIsMy4yMTF6XCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiLz48L3N2Zz4nLFxuXHRcdCAgICBjcm9zcyA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuY3Jvc3NFbGVtZW50ICE9PSBcInVuZGVmaW5lZFwiID8gZm9ybWF0dGVyUGFyYW1zLmNyb3NzRWxlbWVudCA6ICc8c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPVwibmV3IDAgMCAyNCAyNFwiIGhlaWdodD1cIjE0XCIgd2lkdGg9XCIxNFwiICB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgeG1sOnNwYWNlPVwicHJlc2VydmVcIiA+PHBhdGggZmlsbD1cIiNDRTE1MTVcIiBkPVwiTTIyLjI0NSw0LjAxNWMwLjMxMywwLjMxMywwLjMxMywwLjgyNiwwLDEuMTM5bC02LjI3Niw2LjI3Yy0wLjMxMywwLjMxMi0wLjMxMywwLjgyNiwwLDEuMTRsNi4yNzMsNi4yNzIgIGMwLjMxMywwLjMxMywwLjMxMywwLjgyNiwwLDEuMTRsLTIuMjg1LDIuMjc3Yy0wLjMxNCwwLjMxMi0wLjgyOCwwLjMxMi0xLjE0MiwwbC02LjI3MS02LjI3MWMtMC4zMTMtMC4zMTMtMC44MjgtMC4zMTMtMS4xNDEsMCAgbC02LjI3Niw2LjI2N2MtMC4zMTMsMC4zMTMtMC44MjgsMC4zMTMtMS4xNDEsMGwtMi4yODItMi4yOGMtMC4zMTMtMC4zMTMtMC4zMTMtMC44MjYsMC0xLjE0bDYuMjc4LTYuMjY5ICBjMC4zMTMtMC4zMTIsMC4zMTMtMC44MjYsMC0xLjE0TDEuNzA5LDUuMTQ3Yy0wLjMxNC0wLjMxMy0wLjMxNC0wLjgyNywwLTEuMTRsMi4yODQtMi4yNzhDNC4zMDgsMS40MTcsNC44MjEsMS40MTcsNS4xMzUsMS43MyAgTDExLjQwNSw4YzAuMzE0LDAuMzE0LDAuODI4LDAuMzE0LDEuMTQxLDAuMDAxbDYuMjc2LTYuMjY3YzAuMzEyLTAuMzEyLDAuODI2LTAuMzEyLDEuMTQxLDBMMjIuMjQ1LDQuMDE1elwiLz48L3N2Zz4nO1xuXG5cdFx0aWYgKHRydXRoeSAmJiB2YWx1ZSB8fCB2YWx1ZSA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gXCJ0cnVlXCIgfHwgdmFsdWUgPT09IFwiVHJ1ZVwiIHx8IHZhbHVlID09PSAxIHx8IHZhbHVlID09PSBcIjFcIikge1xuXHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNoZWNrZWRcIiwgdHJ1ZSk7XG5cdFx0XHRyZXR1cm4gdGljayB8fCBcIlwiO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoZW1wdHkgJiYgKHZhbHVlID09PSBcIm51bGxcIiB8fCB2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpKSB7XG5cdFx0XHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1jaGVja2VkXCIsIFwibWl4ZWRcIik7XG5cdFx0XHRcdHJldHVybiBcIlwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWNoZWNrZWRcIiwgZmFsc2UpO1xuXHRcdFx0XHRyZXR1cm4gY3Jvc3MgfHwgXCJcIjtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0ZGF0ZXRpbWU6IGZ1bmN0aW9uIGRhdGV0aW1lKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciBpbnB1dEZvcm1hdCA9IGZvcm1hdHRlclBhcmFtcy5pbnB1dEZvcm1hdCB8fCBcIllZWVktTU0tREQgaGg6bW06c3NcIjtcblx0XHR2YXIgb3V0cHV0Rm9ybWF0ID0gZm9ybWF0dGVyUGFyYW1zLm91dHB1dEZvcm1hdCB8fCBcIkREL01NL1lZWVkgaGg6bW06c3NcIjtcblx0XHR2YXIgaW52YWxpZCA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuaW52YWxpZFBsYWNlaG9sZGVyICE9PSBcInVuZGVmaW5lZFwiID8gZm9ybWF0dGVyUGFyYW1zLmludmFsaWRQbGFjZWhvbGRlciA6IFwiXCI7XG5cdFx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpO1xuXG5cdFx0dmFyIG5ld0RhdGV0aW1lID0gbW9tZW50KHZhbHVlLCBpbnB1dEZvcm1hdCk7XG5cblx0XHRpZiAobmV3RGF0ZXRpbWUuaXNWYWxpZCgpKSB7XG5cdFx0XHRyZXR1cm4gZm9ybWF0dGVyUGFyYW1zLnRpbWV6b25lID8gbmV3RGF0ZXRpbWUudHooZm9ybWF0dGVyUGFyYW1zLnRpbWV6b25lKS5mb3JtYXQob3V0cHV0Rm9ybWF0KSA6IG5ld0RhdGV0aW1lLmZvcm1hdChvdXRwdXRGb3JtYXQpO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmIChpbnZhbGlkID09PSB0cnVlKSB7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gZWxzZSBpZiAodHlwZW9mIGludmFsaWQgPT09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRyZXR1cm4gaW52YWxpZCh2YWx1ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gaW52YWxpZDtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0ZGF0ZXRpbWVkaWZmOiBmdW5jdGlvbiBkYXRldGltZShjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpIHtcblx0XHR2YXIgaW5wdXRGb3JtYXQgPSBmb3JtYXR0ZXJQYXJhbXMuaW5wdXRGb3JtYXQgfHwgXCJZWVlZLU1NLUREIGhoOm1tOnNzXCI7XG5cdFx0dmFyIGludmFsaWQgPSB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLmludmFsaWRQbGFjZWhvbGRlciAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy5pbnZhbGlkUGxhY2Vob2xkZXIgOiBcIlwiO1xuXHRcdHZhciBzdWZmaXggPSB0eXBlb2YgZm9ybWF0dGVyUGFyYW1zLnN1ZmZpeCAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy5zdWZmaXggOiBmYWxzZTtcblx0XHR2YXIgdW5pdCA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMudW5pdCAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy51bml0IDogdW5kZWZpbmVkO1xuXHRcdHZhciBodW1hbml6ZSA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuaHVtYW5pemUgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuaHVtYW5pemUgOiBmYWxzZTtcblx0XHR2YXIgZGF0ZSA9IHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuZGF0ZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcm1hdHRlclBhcmFtcy5kYXRlIDogbW9tZW50KCk7XG5cdFx0dmFyIHZhbHVlID0gY2VsbC5nZXRWYWx1ZSgpO1xuXG5cdFx0dmFyIG5ld0RhdGV0aW1lID0gbW9tZW50KHZhbHVlLCBpbnB1dEZvcm1hdCk7XG5cblx0XHRpZiAobmV3RGF0ZXRpbWUuaXNWYWxpZCgpKSB7XG5cdFx0XHRpZiAoaHVtYW5pemUpIHtcblx0XHRcdFx0cmV0dXJuIG1vbWVudC5kdXJhdGlvbihuZXdEYXRldGltZS5kaWZmKGRhdGUpKS5odW1hbml6ZShzdWZmaXgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIG5ld0RhdGV0aW1lLmRpZmYoZGF0ZSwgdW5pdCkgKyAoc3VmZml4ID8gXCIgXCIgKyBzdWZmaXggOiBcIlwiKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoaW52YWxpZCA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGVsc2UgaWYgKHR5cGVvZiBpbnZhbGlkID09PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0cmV0dXJuIGludmFsaWQodmFsdWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIGludmFsaWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8vc2VsZWN0XG5cdGxvb2t1cDogZnVuY3Rpb24gbG9va3VwKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciB2YWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKTtcblxuXHRcdGlmICh0eXBlb2YgZm9ybWF0dGVyUGFyYW1zW3ZhbHVlXSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0Y29uc29sZS53YXJuKCdNaXNzaW5nIGRpc3BsYXkgdmFsdWUgZm9yICcgKyB2YWx1ZSk7XG5cdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZvcm1hdHRlclBhcmFtc1t2YWx1ZV07XG5cdH0sXG5cblx0Ly9zdGFyIHJhdGluZ1xuXHRzdGFyOiBmdW5jdGlvbiBzdGFyKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciB2YWx1ZSA9IGNlbGwuZ2V0VmFsdWUoKSxcblx0XHQgICAgZWxlbWVudCA9IGNlbGwuZ2V0RWxlbWVudCgpLFxuXHRcdCAgICBtYXhTdGFycyA9IGZvcm1hdHRlclBhcmFtcyAmJiBmb3JtYXR0ZXJQYXJhbXMuc3RhcnMgPyBmb3JtYXR0ZXJQYXJhbXMuc3RhcnMgOiA1LFxuXHRcdCAgICBzdGFycyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHRcdCAgICBzdGFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIFwic3ZnXCIpLFxuXHRcdCAgICBzdGFyQWN0aXZlID0gJzxwb2x5Z29uIGZpbGw9XCIjRkZFQTAwXCIgc3Ryb2tlPVwiI0MxQUI2MFwiIHN0cm9rZS13aWR0aD1cIjM3LjYxNTJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBzdHJva2UtbWl0ZXJsaW1pdD1cIjEwXCIgcG9pbnRzPVwiMjU5LjIxNiwyOS45NDIgMzMwLjI3LDE3My45MTkgNDg5LjE2LDE5Ny4wMDcgMzc0LjE4NSwzMDkuMDggNDAxLjMzLDQ2Ny4zMSAyNTkuMjE2LDM5Mi42MTIgMTE3LjEwNCw0NjcuMzEgMTQ0LjI1LDMwOS4wOCAyOS4yNzQsMTk3LjAwNyAxODguMTY1LDE3My45MTkgXCIvPicsXG5cdFx0ICAgIHN0YXJJbmFjdGl2ZSA9ICc8cG9seWdvbiBmaWxsPVwiI0QyRDJEMlwiIHN0cm9rZT1cIiM2ODY4NjhcIiBzdHJva2Utd2lkdGg9XCIzNy42MTUyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlLW1pdGVybGltaXQ9XCIxMFwiIHBvaW50cz1cIjI1OS4yMTYsMjkuOTQyIDMzMC4yNywxNzMuOTE5IDQ4OS4xNiwxOTcuMDA3IDM3NC4xODUsMzA5LjA4IDQwMS4zMyw0NjcuMzEgMjU5LjIxNiwzOTIuNjEyIDExNy4xMDQsNDY3LjMxIDE0NC4yNSwzMDkuMDggMjkuMjc0LDE5Ny4wMDcgMTg4LjE2NSwxNzMuOTE5IFwiLz4nO1xuXG5cdFx0Ly9zdHlsZSBzdGFycyBob2xkZXJcblx0XHRzdGFycy5zdHlsZS52ZXJ0aWNhbEFsaWduID0gXCJtaWRkbGVcIjtcblxuXHRcdC8vc3R5bGUgc3RhclxuXHRcdHN0YXIuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgXCIxNFwiKTtcblx0XHRzdGFyLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBcIjE0XCIpO1xuXHRcdHN0YXIuc2V0QXR0cmlidXRlKFwidmlld0JveFwiLCBcIjAgMCA1MTIgNTEyXCIpO1xuXHRcdHN0YXIuc2V0QXR0cmlidXRlKFwieG1sOnNwYWNlXCIsIFwicHJlc2VydmVcIik7XG5cdFx0c3Rhci5zdHlsZS5wYWRkaW5nID0gXCIwIDFweFwiO1xuXG5cdFx0dmFsdWUgPSB2YWx1ZSAmJiAhaXNOYU4odmFsdWUpID8gcGFyc2VJbnQodmFsdWUpIDogMDtcblxuXHRcdHZhbHVlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4odmFsdWUsIG1heFN0YXJzKSk7XG5cblx0XHRmb3IgKHZhciBpID0gMTsgaSA8PSBtYXhTdGFyczsgaSsrKSB7XG5cdFx0XHR2YXIgbmV4dFN0YXIgPSBzdGFyLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdG5leHRTdGFyLmlubmVySFRNTCA9IGkgPD0gdmFsdWUgPyBzdGFyQWN0aXZlIDogc3RhckluYWN0aXZlO1xuXG5cdFx0XHRzdGFycy5hcHBlbmRDaGlsZChuZXh0U3Rhcik7XG5cdFx0fVxuXG5cdFx0ZWxlbWVudC5zdHlsZS53aGl0ZVNwYWNlID0gXCJub3dyYXBcIjtcblx0XHRlbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIjtcblx0XHRlbGVtZW50LnN0eWxlLnRleHRPdmVyZmxvdyA9IFwiZWxsaXBzaXNcIjtcblxuXHRcdGVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCB2YWx1ZSk7XG5cblx0XHRyZXR1cm4gc3RhcnM7XG5cdH0sXG5cblx0dHJhZmZpYzogZnVuY3Rpb24gdHJhZmZpYyhjZWxsLCBmb3JtYXR0ZXJQYXJhbXMsIG9uUmVuZGVyZWQpIHtcblx0XHR2YXIgdmFsdWUgPSB0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpIHx8IDAsXG5cdFx0ICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIiksXG5cdFx0ICAgIG1heCA9IGZvcm1hdHRlclBhcmFtcyAmJiBmb3JtYXR0ZXJQYXJhbXMubWF4ID8gZm9ybWF0dGVyUGFyYW1zLm1heCA6IDEwMCxcblx0XHQgICAgbWluID0gZm9ybWF0dGVyUGFyYW1zICYmIGZvcm1hdHRlclBhcmFtcy5taW4gPyBmb3JtYXR0ZXJQYXJhbXMubWluIDogMCxcblx0XHQgICAgY29sb3JzID0gZm9ybWF0dGVyUGFyYW1zICYmIHR5cGVvZiBmb3JtYXR0ZXJQYXJhbXMuY29sb3IgIT09IFwidW5kZWZpbmVkXCIgPyBmb3JtYXR0ZXJQYXJhbXMuY29sb3IgOiBbXCJyZWRcIiwgXCJvcmFuZ2VcIiwgXCJncmVlblwiXSxcblx0XHQgICAgY29sb3IgPSBcIiM2NjY2NjZcIixcblx0XHQgICAgcGVyY2VudCxcblx0XHQgICAgcGVyY2VudFZhbHVlO1xuXG5cdFx0aWYgKGlzTmFOKHZhbHVlKSB8fCB0eXBlb2YgY2VsbC5nZXRWYWx1ZSgpID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci10cmFmZmljLWxpZ2h0XCIpO1xuXG5cdFx0Ly9tYWtlIHN1cmUgdmFsdWUgaXMgaW4gcmFuZ2Vcblx0XHRwZXJjZW50VmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKSA8PSBtYXggPyBwYXJzZUZsb2F0KHZhbHVlKSA6IG1heDtcblx0XHRwZXJjZW50VmFsdWUgPSBwYXJzZUZsb2F0KHBlcmNlbnRWYWx1ZSkgPj0gbWluID8gcGFyc2VGbG9hdChwZXJjZW50VmFsdWUpIDogbWluO1xuXG5cdFx0Ly93b3Jrb3V0IHBlcmNlbnRhZ2Vcblx0XHRwZXJjZW50ID0gKG1heCAtIG1pbikgLyAxMDA7XG5cdFx0cGVyY2VudFZhbHVlID0gTWF0aC5yb3VuZCgocGVyY2VudFZhbHVlIC0gbWluKSAvIHBlcmNlbnQpO1xuXG5cdFx0Ly9zZXQgY29sb3Jcblx0XHRzd2l0Y2ggKHR5cGVvZiBjb2xvcnMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGNvbG9ycykpIHtcblx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0Y29sb3IgPSBjb2xvcnM7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdGNvbG9yID0gY29sb3JzKHZhbHVlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwib2JqZWN0XCI6XG5cdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KGNvbG9ycykpIHtcblx0XHRcdFx0XHR2YXIgdW5pdCA9IDEwMCAvIGNvbG9ycy5sZW5ndGg7XG5cdFx0XHRcdFx0dmFyIGluZGV4ID0gTWF0aC5mbG9vcihwZXJjZW50VmFsdWUgLyB1bml0KTtcblxuXHRcdFx0XHRcdGluZGV4ID0gTWF0aC5taW4oaW5kZXgsIGNvbG9ycy5sZW5ndGggLSAxKTtcblx0XHRcdFx0XHRpbmRleCA9IE1hdGgubWF4KGluZGV4LCAwKTtcblx0XHRcdFx0XHRjb2xvciA9IGNvbG9yc1tpbmRleF07XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHR9XG5cblx0XHRlbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcblxuXHRcdHJldHVybiBlbDtcblx0fSxcblxuXHQvL3Byb2dyZXNzIGJhclxuXHRwcm9ncmVzczogZnVuY3Rpb24gcHJvZ3Jlc3MoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0Ly9wcm9ncmVzcyBiYXJcblx0XHR2YXIgdmFsdWUgPSB0aGlzLnNhbml0aXplSFRNTChjZWxsLmdldFZhbHVlKCkpIHx8IDAsXG5cdFx0ICAgIGVsZW1lbnQgPSBjZWxsLmdldEVsZW1lbnQoKSxcblx0XHQgICAgbWF4ID0gZm9ybWF0dGVyUGFyYW1zICYmIGZvcm1hdHRlclBhcmFtcy5tYXggPyBmb3JtYXR0ZXJQYXJhbXMubWF4IDogMTAwLFxuXHRcdCAgICBtaW4gPSBmb3JtYXR0ZXJQYXJhbXMgJiYgZm9ybWF0dGVyUGFyYW1zLm1pbiA/IGZvcm1hdHRlclBhcmFtcy5taW4gOiAwLFxuXHRcdCAgICBsZWdlbmRBbGlnbiA9IGZvcm1hdHRlclBhcmFtcyAmJiBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kQWxpZ24gPyBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kQWxpZ24gOiBcImNlbnRlclwiLFxuXHRcdCAgICBwZXJjZW50LFxuXHRcdCAgICBwZXJjZW50VmFsdWUsXG5cdFx0ICAgIGNvbG9yLFxuXHRcdCAgICBsZWdlbmQsXG5cdFx0ICAgIGxlZ2VuZENvbG9yLFxuXHRcdCAgICB0b3AsXG5cdFx0ICAgIGxlZnQsXG5cdFx0ICAgIHJpZ2h0LFxuXHRcdCAgICBib3R0b207XG5cblx0XHQvL21ha2Ugc3VyZSB2YWx1ZSBpcyBpbiByYW5nZVxuXHRcdHBlcmNlbnRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpIDw9IG1heCA/IHBhcnNlRmxvYXQodmFsdWUpIDogbWF4O1xuXHRcdHBlcmNlbnRWYWx1ZSA9IHBhcnNlRmxvYXQocGVyY2VudFZhbHVlKSA+PSBtaW4gPyBwYXJzZUZsb2F0KHBlcmNlbnRWYWx1ZSkgOiBtaW47XG5cblx0XHQvL3dvcmtvdXQgcGVyY2VudGFnZVxuXHRcdHBlcmNlbnQgPSAobWF4IC0gbWluKSAvIDEwMDtcblx0XHRwZXJjZW50VmFsdWUgPSBNYXRoLnJvdW5kKChwZXJjZW50VmFsdWUgLSBtaW4pIC8gcGVyY2VudCk7XG5cblx0XHQvL3NldCBiYXIgY29sb3Jcblx0XHRzd2l0Y2ggKF90eXBlb2YoZm9ybWF0dGVyUGFyYW1zLmNvbG9yKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRjb2xvciA9IGZvcm1hdHRlclBhcmFtcy5jb2xvcjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0Y29sb3IgPSBmb3JtYXR0ZXJQYXJhbXMuY29sb3IodmFsdWUpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoZm9ybWF0dGVyUGFyYW1zLmNvbG9yKSkge1xuXHRcdFx0XHRcdHZhciB1bml0ID0gMTAwIC8gZm9ybWF0dGVyUGFyYW1zLmNvbG9yLmxlbmd0aDtcblx0XHRcdFx0XHR2YXIgaW5kZXggPSBNYXRoLmZsb29yKHBlcmNlbnRWYWx1ZSAvIHVuaXQpO1xuXG5cdFx0XHRcdFx0aW5kZXggPSBNYXRoLm1pbihpbmRleCwgZm9ybWF0dGVyUGFyYW1zLmNvbG9yLmxlbmd0aCAtIDEpO1xuXHRcdFx0XHRcdGluZGV4ID0gTWF0aC5tYXgoaW5kZXgsIDApO1xuXHRcdFx0XHRcdGNvbG9yID0gZm9ybWF0dGVyUGFyYW1zLmNvbG9yW2luZGV4XTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y29sb3IgPSBcIiMyREMyMTRcIjtcblx0XHR9XG5cblx0XHQvL2dlbmVyYXRlIGxlZ2VuZFxuXHRcdHN3aXRjaCAoX3R5cGVvZihmb3JtYXR0ZXJQYXJhbXMubGVnZW5kKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRsZWdlbmQgPSBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRsZWdlbmQgPSBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kKHZhbHVlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYm9vbGVhblwiOlxuXHRcdFx0XHRsZWdlbmQgPSB2YWx1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRsZWdlbmQgPSBmYWxzZTtcblx0XHR9XG5cblx0XHQvL3NldCBsZWdlbmQgY29sb3Jcblx0XHRzd2l0Y2ggKF90eXBlb2YoZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRsZWdlbmRDb2xvciA9IGZvcm1hdHRlclBhcmFtcy5sZWdlbmRDb2xvcjtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0bGVnZW5kQ29sb3IgPSBmb3JtYXR0ZXJQYXJhbXMubGVnZW5kQ29sb3IodmFsdWUpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yKSkge1xuXHRcdFx0XHRcdHZhciB1bml0ID0gMTAwIC8gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yLmxlbmd0aDtcblx0XHRcdFx0XHR2YXIgaW5kZXggPSBNYXRoLmZsb29yKHBlcmNlbnRWYWx1ZSAvIHVuaXQpO1xuXG5cdFx0XHRcdFx0aW5kZXggPSBNYXRoLm1pbihpbmRleCwgZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yLmxlbmd0aCAtIDEpO1xuXHRcdFx0XHRcdGluZGV4ID0gTWF0aC5tYXgoaW5kZXgsIDApO1xuXHRcdFx0XHRcdGxlZ2VuZENvbG9yID0gZm9ybWF0dGVyUGFyYW1zLmxlZ2VuZENvbG9yW2luZGV4XTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGxlZ2VuZENvbG9yID0gXCIjMDAwXCI7XG5cdFx0fVxuXG5cdFx0ZWxlbWVudC5zdHlsZS5taW5XaWR0aCA9IFwiMzBweFwiO1xuXHRcdGVsZW1lbnQuc3R5bGUucG9zaXRpb24gPSBcInJlbGF0aXZlXCI7XG5cblx0XHRlbGVtZW50LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgcGVyY2VudFZhbHVlKTtcblxuXHRcdHZhciBiYXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0YmFyRWwuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XG5cdFx0YmFyRWwuc3R5bGUucG9zaXRpb24gPSBcInJlbGF0aXZlXCI7XG5cdFx0YmFyRWwuc3R5bGUud2lkdGggPSBwZXJjZW50VmFsdWUgKyBcIiVcIjtcblx0XHRiYXJFbC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcblx0XHRiYXJFbC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblxuXHRcdGJhckVsLnNldEF0dHJpYnV0ZSgnZGF0YS1tYXgnLCBtYXgpO1xuXHRcdGJhckVsLnNldEF0dHJpYnV0ZSgnZGF0YS1taW4nLCBtaW4pO1xuXG5cdFx0aWYgKGxlZ2VuZCkge1xuXHRcdFx0dmFyIGxlZ2VuZEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdGxlZ2VuZEVsLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHRcdFx0bGVnZW5kRWwuc3R5bGUudG9wID0gXCI0cHhcIjtcblx0XHRcdGxlZ2VuZEVsLnN0eWxlLmxlZnQgPSAwO1xuXHRcdFx0bGVnZW5kRWwuc3R5bGUudGV4dEFsaWduID0gbGVnZW5kQWxpZ247XG5cdFx0XHRsZWdlbmRFbC5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xuXHRcdFx0bGVnZW5kRWwuc3R5bGUuY29sb3IgPSBsZWdlbmRDb2xvcjtcblx0XHRcdGxlZ2VuZEVsLmlubmVySFRNTCA9IGxlZ2VuZDtcblx0XHR9XG5cblx0XHRvblJlbmRlcmVkKGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Ly9oYW5kbGUgY3VzdG9tIGVsZW1lbnQgbmVlZGVkIGlmIGZvcm1hdHRlciBpcyB0byBiZSBpbmNsdWRlZCBpbiBwcmludGVkL2Rvd25sb2FkZWQgb3V0cHV0XG5cdFx0XHRpZiAoIShjZWxsIGluc3RhbmNlb2YgQ2VsbENvbXBvbmVudCkpIHtcblx0XHRcdFx0dmFyIGhvbGRlckVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0aG9sZGVyRWwuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cdFx0XHRcdGhvbGRlckVsLnN0eWxlLnRvcCA9IFwiNHB4XCI7XG5cdFx0XHRcdGhvbGRlckVsLnN0eWxlLmJvdHRvbSA9IFwiNHB4XCI7XG5cdFx0XHRcdGhvbGRlckVsLnN0eWxlLmxlZnQgPSBcIjRweFwiO1xuXHRcdFx0XHRob2xkZXJFbC5zdHlsZS5yaWdodCA9IFwiNHB4XCI7XG5cblx0XHRcdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChob2xkZXJFbCk7XG5cblx0XHRcdFx0ZWxlbWVudCA9IGhvbGRlckVsO1xuXHRcdFx0fVxuXG5cdFx0XHRlbGVtZW50LmFwcGVuZENoaWxkKGJhckVsKTtcblxuXHRcdFx0aWYgKGxlZ2VuZCkge1xuXHRcdFx0XHRlbGVtZW50LmFwcGVuZENoaWxkKGxlZ2VuZEVsKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBcIlwiO1xuXHR9LFxuXG5cdC8vYmFja2dyb3VuZCBjb2xvclxuXHRjb2xvcjogZnVuY3Rpb24gY29sb3IoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0Y2VsbC5nZXRFbGVtZW50KCkuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5zYW5pdGl6ZUhUTUwoY2VsbC5nZXRWYWx1ZSgpKTtcblx0XHRyZXR1cm4gXCJcIjtcblx0fSxcblxuXHQvL3RpY2sgaWNvblxuXHRidXR0b25UaWNrOiBmdW5jdGlvbiBidXR0b25UaWNrKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHJldHVybiAnPHN2ZyBlbmFibGUtYmFja2dyb3VuZD1cIm5ldyAwIDAgMjQgMjRcIiBoZWlnaHQ9XCIxNFwiIHdpZHRoPVwiMTRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgeG1sOnNwYWNlPVwicHJlc2VydmVcIiA+PHBhdGggZmlsbD1cIiMyREMyMTRcIiBjbGlwLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0yMS42NTIsMy4yMTFjLTAuMjkzLTAuMjk1LTAuNzctMC4yOTUtMS4wNjEsMEw5LjQxLDE0LjM0ICBjLTAuMjkzLDAuMjk3LTAuNzcxLDAuMjk3LTEuMDYyLDBMMy40NDksOS4zNTFDMy4zMDQsOS4yMDMsMy4xMTQsOS4xMywyLjkyMyw5LjEyOUMyLjczLDkuMTI4LDIuNTM0LDkuMjAxLDIuMzg3LDkuMzUxICBsLTIuMTY1LDEuOTQ2QzAuMDc4LDExLjQ0NSwwLDExLjYzLDAsMTEuODIzYzAsMC4xOTQsMC4wNzgsMC4zOTcsMC4yMjMsMC41NDRsNC45NCw1LjE4NGMwLjI5MiwwLjI5NiwwLjc3MSwwLjc3NiwxLjA2MiwxLjA3ICBsMi4xMjQsMi4xNDFjMC4yOTIsMC4yOTMsMC43NjksMC4yOTMsMS4wNjIsMGwxNC4zNjYtMTQuMzRjMC4yOTMtMC4yOTQsMC4yOTMtMC43NzcsMC0xLjA3MUwyMS42NTIsMy4yMTF6XCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiLz48L3N2Zz4nO1xuXHR9LFxuXG5cdC8vY3Jvc3MgaWNvblxuXHRidXR0b25Dcm9zczogZnVuY3Rpb24gYnV0dG9uQ3Jvc3MoY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0cmV0dXJuICc8c3ZnIGVuYWJsZS1iYWNrZ3JvdW5kPVwibmV3IDAgMCAyNCAyNFwiIGhlaWdodD1cIjE0XCIgd2lkdGg9XCIxNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB4bWw6c3BhY2U9XCJwcmVzZXJ2ZVwiID48cGF0aCBmaWxsPVwiI0NFMTUxNVwiIGQ9XCJNMjIuMjQ1LDQuMDE1YzAuMzEzLDAuMzEzLDAuMzEzLDAuODI2LDAsMS4xMzlsLTYuMjc2LDYuMjdjLTAuMzEzLDAuMzEyLTAuMzEzLDAuODI2LDAsMS4xNGw2LjI3Myw2LjI3MiAgYzAuMzEzLDAuMzEzLDAuMzEzLDAuODI2LDAsMS4xNGwtMi4yODUsMi4yNzdjLTAuMzE0LDAuMzEyLTAuODI4LDAuMzEyLTEuMTQyLDBsLTYuMjcxLTYuMjcxYy0wLjMxMy0wLjMxMy0wLjgyOC0wLjMxMy0xLjE0MSwwICBsLTYuMjc2LDYuMjY3Yy0wLjMxMywwLjMxMy0wLjgyOCwwLjMxMy0xLjE0MSwwbC0yLjI4Mi0yLjI4Yy0wLjMxMy0wLjMxMy0wLjMxMy0wLjgyNiwwLTEuMTRsNi4yNzgtNi4yNjkgIGMwLjMxMy0wLjMxMiwwLjMxMy0wLjgyNiwwLTEuMTRMMS43MDksNS4xNDdjLTAuMzE0LTAuMzEzLTAuMzE0LTAuODI3LDAtMS4xNGwyLjI4NC0yLjI3OEM0LjMwOCwxLjQxNyw0LjgyMSwxLjQxNyw1LjEzNSwxLjczICBMMTEuNDA1LDhjMC4zMTQsMC4zMTQsMC44MjgsMC4zMTQsMS4xNDEsMC4wMDFsNi4yNzYtNi4yNjdjMC4zMTItMC4zMTIsMC44MjYtMC4zMTIsMS4xNDEsMEwyMi4yNDUsNC4wMTV6XCIvPjwvc3ZnPic7XG5cdH0sXG5cblx0Ly9jdXJyZW50IHJvdyBudW1iZXJcblx0cm93bnVtOiBmdW5jdGlvbiByb3dudW0oY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0cmV0dXJuIHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzLmluZGV4T2YoY2VsbC5nZXRSb3coKS5fZ2V0U2VsZigpKSArIDE7XG5cdH0sXG5cblx0Ly9yb3cgaGFuZGxlXG5cdGhhbmRsZTogZnVuY3Rpb24gaGFuZGxlKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdGNlbGwuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93LWhhbmRsZVwiKTtcblx0XHRyZXR1cm4gXCI8ZGl2IGNsYXNzPSd0YWJ1bGF0b3Itcm93LWhhbmRsZS1ib3gnPjxkaXYgY2xhc3M9J3RhYnVsYXRvci1yb3ctaGFuZGxlLWJhcic+PC9kaXY+PGRpdiBjbGFzcz0ndGFidWxhdG9yLXJvdy1oYW5kbGUtYmFyJz48L2Rpdj48ZGl2IGNsYXNzPSd0YWJ1bGF0b3Itcm93LWhhbmRsZS1iYXInPjwvZGl2PjwvZGl2PlwiO1xuXHR9LFxuXG5cdHJlc3BvbnNpdmVDb2xsYXBzZTogZnVuY3Rpb24gcmVzcG9uc2l2ZUNvbGxhcHNlKGNlbGwsIGZvcm1hdHRlclBhcmFtcywgb25SZW5kZXJlZCkge1xuXHRcdHZhciBzZWxmID0gdGhpcyxcblx0XHQgICAgb3BlbiA9IGZhbHNlLFxuXHRcdCAgICBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0ICAgIGNvbmZpZyA9IGNlbGwuZ2V0Um93KCkuX3Jvdy5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQ7XG5cblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJlc3BvbnNpdmUtY29sbGFwc2UtdG9nZ2xlXCIpO1xuXHRcdGVsLmlubmVySFRNTCA9IFwiPHNwYW4gY2xhc3M9J3RhYnVsYXRvci1yZXNwb25zaXZlLWNvbGxhcHNlLXRvZ2dsZS1vcGVuJz4rPC9zcGFuPjxzcGFuIGNsYXNzPSd0YWJ1bGF0b3ItcmVzcG9uc2l2ZS1jb2xsYXBzZS10b2dnbGUtY2xvc2UnPi08L3NwYW4+XCI7XG5cblx0XHRjZWxsLmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1oYW5kbGVcIik7XG5cblx0XHRmdW5jdGlvbiB0b2dnbGVMaXN0KGlzT3Blbikge1xuXHRcdFx0dmFyIGNvbGxhcHNlRWwgPSBjb25maWcuZWxlbWVudDtcblxuXHRcdFx0Y29uZmlnLm9wZW4gPSBpc09wZW47XG5cblx0XHRcdGlmIChjb2xsYXBzZUVsKSB7XG5cblx0XHRcdFx0aWYgKGNvbmZpZy5vcGVuKSB7XG5cdFx0XHRcdFx0ZWwuY2xhc3NMaXN0LmFkZChcIm9wZW5cIik7XG5cdFx0XHRcdFx0Y29sbGFwc2VFbC5zdHlsZS5kaXNwbGF5ID0gJyc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcIm9wZW5cIik7XG5cdFx0XHRcdFx0Y29sbGFwc2VFbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHRcdFx0dG9nZ2xlTGlzdCghY29uZmlnLm9wZW4pO1xuXHRcdH0pO1xuXG5cdFx0dG9nZ2xlTGlzdChjb25maWcub3Blbik7XG5cblx0XHRyZXR1cm4gZWw7XG5cdH0sXG5cblx0cm93U2VsZWN0aW9uOiBmdW5jdGlvbiByb3dTZWxlY3Rpb24oY2VsbCwgZm9ybWF0dGVyUGFyYW1zLCBvblJlbmRlcmVkKSB7XG5cdFx0dmFyIF90aGlzNjQgPSB0aGlzO1xuXG5cdFx0dmFyIGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuXG5cdFx0Y2hlY2tib3gudHlwZSA9ICdjaGVja2JveCc7XG5cblx0XHRpZiAodGhpcy50YWJsZS5tb2RFeGlzdHMoXCJzZWxlY3RSb3dcIiwgdHJ1ZSkpIHtcblxuXHRcdFx0Y2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKHR5cGVvZiBjZWxsLmdldFJvdyA9PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHZhciByb3cgPSBjZWxsLmdldFJvdygpO1xuXG5cdFx0XHRcdGlmIChyb3cgaW5zdGFuY2VvZiBSb3dDb21wb25lbnQpIHtcblxuXHRcdFx0XHRcdGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdHJvdy50b2dnbGVTZWxlY3QoKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGNoZWNrYm94LmNoZWNrZWQgPSByb3cuaXNTZWxlY3RlZCAmJiByb3cuaXNTZWxlY3RlZCgpO1xuXHRcdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5zZWxlY3RSb3cucmVnaXN0ZXJSb3dTZWxlY3RDaGVja2JveChyb3csIGNoZWNrYm94KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjaGVja2JveCA9IFwiXCI7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRpZiAoX3RoaXM2NC50YWJsZS5tb2R1bGVzLnNlbGVjdFJvdy5zZWxlY3RlZFJvd3MubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRfdGhpczY0LnRhYmxlLmRlc2VsZWN0Um93KCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdF90aGlzNjQudGFibGUuc2VsZWN0Um93KGZvcm1hdHRlclBhcmFtcy5yb3dSYW5nZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuc2VsZWN0Um93LnJlZ2lzdGVySGVhZGVyU2VsZWN0Q2hlY2tib3goY2hlY2tib3gpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gY2hlY2tib3g7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJmb3JtYXRcIiwgRm9ybWF0KTtcblxudmFyIEZyb3plbkNvbHVtbnMgPSBmdW5jdGlvbiBGcm96ZW5Db2x1bW5zKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcblx0dGhpcy5sZWZ0Q29sdW1ucyA9IFtdO1xuXHR0aGlzLnJpZ2h0Q29sdW1ucyA9IFtdO1xuXHR0aGlzLmxlZnRNYXJnaW4gPSAwO1xuXHR0aGlzLnJpZ2h0TWFyZ2luID0gMDtcblx0dGhpcy5yaWdodFBhZGRpbmcgPSAwO1xuXHR0aGlzLmluaXRpYWxpemF0aW9uTW9kZSA9IFwibGVmdFwiO1xuXHR0aGlzLmFjdGl2ZSA9IGZhbHNlO1xuXHR0aGlzLnNjcm9sbEVuZFRpbWVyID0gZmFsc2U7XG59O1xuXG4vL3Jlc2V0IGluaXRpYWwgc3RhdGVcbkZyb3plbkNvbHVtbnMucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmluaXRpYWxpemF0aW9uTW9kZSA9IFwibGVmdFwiO1xuXHR0aGlzLmxlZnRDb2x1bW5zID0gW107XG5cdHRoaXMucmlnaHRDb2x1bW5zID0gW107XG5cdHRoaXMubGVmdE1hcmdpbiA9IDA7XG5cdHRoaXMucmlnaHRNYXJnaW4gPSAwO1xuXHR0aGlzLnJpZ2h0TWFyZ2luID0gMDtcblx0dGhpcy5hY3RpdmUgPSBmYWxzZTtcblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuaGVhZGVyc0VsZW1lbnQuc3R5bGUubWFyZ2luTGVmdCA9IDA7XG5cdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5lbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodCA9IDA7XG59O1xuXG4vL2luaXRpYWxpemUgc3BlY2lmaWMgY29sdW1uXG5Gcm96ZW5Db2x1bW5zLnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgY29uZmlnID0geyBtYXJnaW46IDAsIGVkZ2U6IGZhbHNlIH07XG5cblx0aWYgKCFjb2x1bW4uaXNHcm91cCkge1xuXG5cdFx0aWYgKHRoaXMuZnJvemVuQ2hlY2soY29sdW1uKSkge1xuXG5cdFx0XHRjb25maWcucG9zaXRpb24gPSB0aGlzLmluaXRpYWxpemF0aW9uTW9kZTtcblxuXHRcdFx0aWYgKHRoaXMuaW5pdGlhbGl6YXRpb25Nb2RlID09IFwibGVmdFwiKSB7XG5cdFx0XHRcdHRoaXMubGVmdENvbHVtbnMucHVzaChjb2x1bW4pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yaWdodENvbHVtbnMudW5zaGlmdChjb2x1bW4pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmFjdGl2ZSA9IHRydWU7XG5cblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbiA9IGNvbmZpZztcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5pbml0aWFsaXphdGlvbk1vZGUgPSBcInJpZ2h0XCI7XG5cdFx0fVxuXHR9XG59O1xuXG5Gcm96ZW5Db2x1bW5zLnByb3RvdHlwZS5mcm96ZW5DaGVjayA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIGZyb3plbiA9IGZhbHNlO1xuXG5cdGlmIChjb2x1bW4ucGFyZW50LmlzR3JvdXAgJiYgY29sdW1uLmRlZmluaXRpb24uZnJvemVuKSB7XG5cdFx0Y29uc29sZS53YXJuKFwiRnJvemVuIENvbHVtbiBFcnJvciAtIFBhcmVudCBjb2x1bW4gZ3JvdXAgbXVzdCBiZSBmcm96ZW4sIG5vdCBpbmRpdmlkdWFsIGNvbHVtbnMgb3Igc3ViIGNvbHVtbiBncm91cHNcIik7XG5cdH1cblxuXHRpZiAoY29sdW1uLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0cmV0dXJuIHRoaXMuZnJvemVuQ2hlY2soY29sdW1uLnBhcmVudCk7XG5cdH0gZWxzZSB7XG5cdFx0cmV0dXJuIGNvbHVtbi5kZWZpbml0aW9uLmZyb3plbjtcblx0fVxuXG5cdHJldHVybiBmcm96ZW47XG59O1xuXG4vL3F1aWNrIGxheW91dCB0byBzbW9vdGggaG9yaXpvbnRhbCBzY3JvbGxpbmdcbkZyb3plbkNvbHVtbnMucHJvdG90eXBlLnNjcm9sbEhvcml6b250YWwgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczY1ID0gdGhpcztcblxuXHR2YXIgcm93cztcblxuXHRpZiAodGhpcy5hY3RpdmUpIHtcblx0XHRjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxFbmRUaW1lcik7XG5cblx0XHQvL2xheW91dCBhbGwgcm93cyBhZnRlciBzY3JvbGwgaXMgY29tcGxldGVcblx0XHR0aGlzLnNjcm9sbEVuZFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRfdGhpczY1LmxheW91dCgpO1xuXHRcdH0sIDEwMCk7XG5cblx0XHRyb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFZpc2libGVSb3dzKCk7XG5cblx0XHR0aGlzLmNhbGNNYXJnaW5zKCk7XG5cblx0XHR0aGlzLmxheW91dENvbHVtblBvc2l0aW9uKCk7XG5cblx0XHR0aGlzLmxheW91dENhbGNSb3dzKCk7XG5cblx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0aWYgKHJvdy50eXBlID09PSBcInJvd1wiKSB7XG5cdFx0XHRcdF90aGlzNjUubGF5b3V0Um93KHJvdyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIudGFibGVFbGVtZW50LnN0eWxlLm1hcmdpblJpZ2h0ID0gdGhpcy5yaWdodE1hcmdpbjtcblx0fVxufTtcblxuLy9jYWxjdWxhdGUgbWFyZ2lucyBmb3Igcm93c1xuRnJvemVuQ29sdW1ucy5wcm90b3R5cGUuY2FsY01hcmdpbnMgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMubGVmdE1hcmdpbiA9IHRoaXMuX2NhbGNTcGFjZSh0aGlzLmxlZnRDb2x1bW5zLCB0aGlzLmxlZnRDb2x1bW5zLmxlbmd0aCkgKyBcInB4XCI7XG5cdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5oZWFkZXJzRWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gdGhpcy5sZWZ0TWFyZ2luO1xuXG5cdHRoaXMucmlnaHRNYXJnaW4gPSB0aGlzLl9jYWxjU3BhY2UodGhpcy5yaWdodENvbHVtbnMsIHRoaXMucmlnaHRDb2x1bW5zLmxlbmd0aCkgKyBcInB4XCI7XG5cdHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5lbGVtZW50LnN0eWxlLnBhZGRpbmdSaWdodCA9IHRoaXMucmlnaHRNYXJnaW47XG5cblx0Ly9jYWxjdWxhdGUgcmlnaHQgZnJvemVuIGNvbHVtbnNcblx0dGhpcy5yaWdodFBhZGRpbmcgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRXaWR0aCArIHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5zY3JvbGxMZWZ0O1xufTtcblxuLy9sYXlvdXQgY2FsY3VsYXRpb24gcm93c1xuRnJvemVuQ29sdW1ucy5wcm90b3R5cGUubGF5b3V0Q2FsY1Jvd3MgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cdFx0aWYgKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy50b3BJbml0aWFsaXplZCAmJiB0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MudG9wUm93KSB7XG5cdFx0XHR0aGlzLmxheW91dFJvdyh0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MudG9wUm93KTtcblx0XHR9XG5cdFx0aWYgKHRoaXMudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5ib3RJbml0aWFsaXplZCAmJiB0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuYm90Um93KSB7XG5cdFx0XHR0aGlzLmxheW91dFJvdyh0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuYm90Um93KTtcblx0XHR9XG5cdH1cbn07XG5cbi8vY2FsY3VsYXRlIGNvbHVtbiBwb3NpdGlvbnMgYW5kIGxheW91dCBoZWFkZXJzXG5Gcm96ZW5Db2x1bW5zLnByb3RvdHlwZS5sYXlvdXRDb2x1bW5Qb3NpdGlvbiA9IGZ1bmN0aW9uIChhbGxDZWxscykge1xuXHR2YXIgX3RoaXM2NiA9IHRoaXM7XG5cblx0dmFyIGxlZnRQYXJlbnRzID0gW107XG5cblx0dGhpcy5sZWZ0Q29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4sIGkpIHtcblx0XHRjb2x1bW4ubW9kdWxlcy5mcm96ZW4ubWFyZ2luID0gX3RoaXM2Ni5fY2FsY1NwYWNlKF90aGlzNjYubGVmdENvbHVtbnMsIGkpICsgX3RoaXM2Ni50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbExlZnQgKyBcInB4XCI7XG5cblx0XHRpZiAoaSA9PSBfdGhpczY2LmxlZnRDb2x1bW5zLmxlbmd0aCAtIDEpIHtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlID0gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZnJvemVuLmVkZ2UgPSBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoY29sdW1uLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0XHR2YXIgcGFyZW50RWwgPSBfdGhpczY2LmdldENvbEdyb3VwUGFyZW50RWxlbWVudChjb2x1bW4pO1xuXHRcdFx0aWYgKCFsZWZ0UGFyZW50cy5pbmNsdWRlcyhwYXJlbnRFbCkpIHtcblx0XHRcdFx0X3RoaXM2Ni5sYXlvdXRFbGVtZW50KHBhcmVudEVsLCBjb2x1bW4pO1xuXHRcdFx0XHRsZWZ0UGFyZW50cy5wdXNoKHBhcmVudEVsKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlKSB7XG5cdFx0XHRcdHBhcmVudEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZnJvemVuLVwiICsgY29sdW1uLm1vZHVsZXMuZnJvemVuLnBvc2l0aW9uKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0X3RoaXM2Ni5sYXlvdXRFbGVtZW50KGNvbHVtbi5nZXRFbGVtZW50KCksIGNvbHVtbik7XG5cdFx0fVxuXG5cdFx0aWYgKGFsbENlbGxzKSB7XG5cdFx0XHRjb2x1bW4uY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdFx0XHRfdGhpczY2LmxheW91dEVsZW1lbnQoY2VsbC5nZXRFbGVtZW50KHRydWUpLCBjb2x1bW4pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblxuXHR0aGlzLnJpZ2h0Q29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4sIGkpIHtcblx0XHRjb2x1bW4ubW9kdWxlcy5mcm96ZW4ubWFyZ2luID0gX3RoaXM2Ni5yaWdodFBhZGRpbmcgLSBfdGhpczY2Ll9jYWxjU3BhY2UoX3RoaXM2Ni5yaWdodENvbHVtbnMsIGkgKyAxKSArIFwicHhcIjtcblxuXHRcdGlmIChpID09IF90aGlzNjYucmlnaHRDb2x1bW5zLmxlbmd0aCAtIDEpIHtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlID0gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29sdW1uLm1vZHVsZXMuZnJvemVuLmVkZ2UgPSBmYWxzZTtcblx0XHR9XG5cblx0XHRpZiAoY29sdW1uLnBhcmVudC5pc0dyb3VwKSB7XG5cdFx0XHRfdGhpczY2LmxheW91dEVsZW1lbnQoX3RoaXM2Ni5nZXRDb2xHcm91cFBhcmVudEVsZW1lbnQoY29sdW1uKSwgY29sdW1uKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0X3RoaXM2Ni5sYXlvdXRFbGVtZW50KGNvbHVtbi5nZXRFbGVtZW50KCksIGNvbHVtbik7XG5cdFx0fVxuXG5cdFx0aWYgKGFsbENlbGxzKSB7XG5cdFx0XHRjb2x1bW4uY2VsbHMuZm9yRWFjaChmdW5jdGlvbiAoY2VsbCkge1xuXHRcdFx0XHRfdGhpczY2LmxheW91dEVsZW1lbnQoY2VsbC5nZXRFbGVtZW50KHRydWUpLCBjb2x1bW4pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbkZyb3plbkNvbHVtbnMucHJvdG90eXBlLmdldENvbEdyb3VwUGFyZW50RWxlbWVudCA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0cmV0dXJuIGNvbHVtbi5wYXJlbnQuaXNHcm91cCA/IHRoaXMuZ2V0Q29sR3JvdXBQYXJlbnRFbGVtZW50KGNvbHVtbi5wYXJlbnQpIDogY29sdW1uLmdldEVsZW1lbnQoKTtcbn07XG5cbi8vbGF5b3V0IGNvbHVtbnMgYXBwcm9wcm9wcmlhdGx5XG5Gcm96ZW5Db2x1bW5zLnByb3RvdHlwZS5sYXlvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHJpZ2h0TWFyZ2luID0gMDtcblxuXHRpZiAoc2VsZi5hY3RpdmUpIHtcblxuXHRcdC8vY2FsY3VsYXRlIHJvdyBwYWRkaW5nXG5cdFx0dGhpcy5jYWxjTWFyZ2lucygpO1xuXG5cdFx0Ly8gc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmFjdGl2ZVJvd3MuZm9yRWFjaChmdW5jdGlvbihyb3cpe1xuXHRcdC8vIFx0c2VsZi5sYXlvdXRSb3cocm93KTtcblx0XHQvLyB9KTtcblxuXHRcdC8vIGlmKHNlbGYudGFibGUub3B0aW9ucy5kYXRhVHJlZSl7XG5cdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCkuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRpZiAocm93LnR5cGUgPT09IFwicm93XCIpIHtcblx0XHRcdFx0c2VsZi5sYXlvdXRSb3cocm93KTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHQvLyB9XG5cblx0XHR0aGlzLmxheW91dENhbGNSb3dzKCk7XG5cblx0XHQvL2NhbGN1bGF0ZSBsZWZ0IGNvbHVtbnNcblx0XHR0aGlzLmxheW91dENvbHVtblBvc2l0aW9uKHRydWUpO1xuXG5cdFx0Ly8gaWYodGFibGVIb2xkZXIuc2Nyb2xsSGVpZ2h0ID4gdGFibGVIb2xkZXIuY2xpZW50SGVpZ2h0KXtcblx0XHQvLyBcdHJpZ2h0TWFyZ2luIC09IHRhYmxlSG9sZGVyLm9mZnNldFdpZHRoIC0gdGFibGVIb2xkZXIuY2xpZW50V2lkdGg7XG5cdFx0Ly8gfVxuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnRhYmxlRWxlbWVudC5zdHlsZS5tYXJnaW5SaWdodCA9IHRoaXMucmlnaHRNYXJnaW47XG5cdH1cbn07XG5cbkZyb3plbkNvbHVtbnMucHJvdG90eXBlLmxheW91dFJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIF90aGlzNjcgPSB0aGlzO1xuXG5cdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0cm93RWwuc3R5bGUucGFkZGluZ0xlZnQgPSB0aGlzLmxlZnRNYXJnaW47XG5cdC8vIHJvd0VsLnN0eWxlLnBhZGRpbmdSaWdodCA9IHRoaXMucmlnaHRNYXJnaW4gKyBcInB4XCI7XG5cblx0dGhpcy5sZWZ0Q29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0XHR2YXIgY2VsbCA9IHJvdy5nZXRDZWxsKGNvbHVtbik7XG5cblx0XHRpZiAoY2VsbCkge1xuXHRcdFx0X3RoaXM2Ny5sYXlvdXRFbGVtZW50KGNlbGwuZ2V0RWxlbWVudCh0cnVlKSwgY29sdW1uKTtcblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMucmlnaHRDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdHZhciBjZWxsID0gcm93LmdldENlbGwoY29sdW1uKTtcblxuXHRcdGlmIChjZWxsKSB7XG5cdFx0XHRfdGhpczY3LmxheW91dEVsZW1lbnQoY2VsbC5nZXRFbGVtZW50KHRydWUpLCBjb2x1bW4pO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Gcm96ZW5Db2x1bW5zLnByb3RvdHlwZS5sYXlvdXRFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGNvbHVtbikge1xuXG5cdGlmIChjb2x1bW4ubW9kdWxlcy5mcm96ZW4pIHtcblx0XHRlbGVtZW50LnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXHRcdGVsZW1lbnQuc3R5bGUubGVmdCA9IGNvbHVtbi5tb2R1bGVzLmZyb3plbi5tYXJnaW47XG5cblx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZnJvemVuXCIpO1xuXG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLmZyb3plbi5lZGdlKSB7XG5cdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZnJvemVuLVwiICsgY29sdW1uLm1vZHVsZXMuZnJvemVuLnBvc2l0aW9uKTtcblx0XHR9XG5cdH1cbn07XG5cbkZyb3plbkNvbHVtbnMucHJvdG90eXBlLl9jYWxjU3BhY2UgPSBmdW5jdGlvbiAoY29sdW1ucywgaW5kZXgpIHtcblx0dmFyIHdpZHRoID0gMDtcblxuXHRmb3IgKHZhciBfaTEyID0gMDsgX2kxMiA8IGluZGV4OyBfaTEyKyspIHtcblx0XHRpZiAoY29sdW1uc1tfaTEyXS52aXNpYmxlKSB7XG5cdFx0XHR3aWR0aCArPSBjb2x1bW5zW19pMTJdLmdldFdpZHRoKCk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHdpZHRoO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImZyb3plbkNvbHVtbnNcIiwgRnJvemVuQ29sdW1ucyk7XG52YXIgRnJvemVuUm93cyA9IGZ1bmN0aW9uIEZyb3plblJvd3ModGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLnRvcEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHR0aGlzLnJvd3MgPSBbXTtcblx0dGhpcy5kaXNwbGF5SW5kZXggPSAwOyAvL2luZGV4IGluIGRpc3BsYXkgcGlwZWxpbmVcbn07XG5cbkZyb3plblJvd3MucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMucm93cyA9IFtdO1xuXG5cdHRoaXMudG9wRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWZyb3plbi1yb3dzLWhvbGRlclwiKTtcblxuXHQvLyB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZWxlbWVudC5hcHBlbmQodGhpcy50b3BFbGVtZW50KTtcblx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldEVsZW1lbnQoKS5pbnNlcnRCZWZvcmUodGhpcy50b3BFbGVtZW50LCB0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuaGVhZGVyc0VsZW1lbnQubmV4dFNpYmxpbmcpO1xufTtcblxuRnJvemVuUm93cy5wcm90b3R5cGUuc2V0RGlzcGxheUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdHRoaXMuZGlzcGxheUluZGV4ID0gaW5kZXg7XG59O1xuXG5Gcm96ZW5Sb3dzLnByb3RvdHlwZS5nZXREaXNwbGF5SW5kZXggPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmRpc3BsYXlJbmRleDtcbn07XG5cbkZyb3plblJvd3MucHJvdG90eXBlLmlzRnJvemVuID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gISF0aGlzLnJvd3MubGVuZ3RoO1xufTtcblxuLy9maWx0ZXIgZnJvemVuIHJvd3Mgb3V0IG9mIGRpc3BsYXkgZGF0YVxuRnJvemVuUm93cy5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGZyb3plbiA9IFtdLFxuXHQgICAgb3V0cHV0ID0gcm93cy5zbGljZSgwKTtcblxuXHR0aGlzLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0dmFyIGluZGV4ID0gb3V0cHV0LmluZGV4T2Yocm93KTtcblxuXHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHRvdXRwdXQuc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Gcm96ZW5Sb3dzLnByb3RvdHlwZS5mcmVlemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdGlmICghcm93Lm1vZHVsZXMuZnJvemVuKSB7XG5cdFx0cm93Lm1vZHVsZXMuZnJvemVuID0gdHJ1ZTtcblx0XHR0aGlzLnRvcEVsZW1lbnQuYXBwZW5kQ2hpbGQocm93LmdldEVsZW1lbnQoKSk7XG5cdFx0cm93LmluaXRpYWxpemUoKTtcblx0XHRyb3cubm9ybWFsaXplSGVpZ2h0KCk7XG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xuXG5cdFx0dGhpcy5yb3dzLnB1c2gocm93KTtcblxuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcImRpc3BsYXlcIik7XG5cblx0XHR0aGlzLnN0eWxlUm93cygpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIkZyZWV6ZSBFcnJvciAtIFJvdyBpcyBhbHJlYWR5IGZyb3plblwiKTtcblx0fVxufTtcblxuRnJvemVuUm93cy5wcm90b3R5cGUudW5mcmVlemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBpbmRleCA9IHRoaXMucm93cy5pbmRleE9mKHJvdyk7XG5cblx0aWYgKHJvdy5tb2R1bGVzLmZyb3plbikge1xuXG5cdFx0cm93Lm1vZHVsZXMuZnJvemVuID0gZmFsc2U7XG5cblx0XHR0aGlzLmRldGFjaFJvdyhyb3cpO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmFkanVzdFRhYmxlU2l6ZSgpO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJlZnJlc2hBY3RpdmVEYXRhKFwiZGlzcGxheVwiKTtcblxuXHRcdGlmICh0aGlzLnJvd3MubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLnN0eWxlUm93cygpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJGcmVlemUgRXJyb3IgLSBSb3cgaXMgYWxyZWFkeSB1bmZyb3plblwiKTtcblx0fVxufTtcblxuRnJvemVuUm93cy5wcm90b3R5cGUuZGV0YWNoUm93ID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgaW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZihyb3cpO1xuXG5cdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRyb3dFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvd0VsKTtcblxuXHRcdHRoaXMucm93cy5zcGxpY2UoaW5kZXgsIDEpO1xuXHR9XG59O1xuXG5Gcm96ZW5Sb3dzLnByb3RvdHlwZS5zdHlsZVJvd3MgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHR0aGlzLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93LCBpKSB7XG5cdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLnN0eWxlUm93KHJvdywgaSk7XG5cdH0pO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImZyb3plblJvd3NcIiwgRnJvemVuUm93cyk7XG5cbi8vcHVibGljIGdyb3VwIG9iamVjdFxudmFyIEdyb3VwQ29tcG9uZW50ID0gZnVuY3Rpb24gR3JvdXBDb21wb25lbnQoZ3JvdXApIHtcblx0dGhpcy5fZ3JvdXAgPSBncm91cDtcblx0dGhpcy50eXBlID0gXCJHcm91cENvbXBvbmVudFwiO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldEtleSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwLmtleTtcbn07XG5cbkdyb3VwQ29tcG9uZW50LnByb3RvdHlwZS5nZXRGaWVsZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwLmZpZWxkO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9ncm91cC5lbGVtZW50O1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLl9ncm91cC5nZXRSb3dzKHRydWUpO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldFN1Ykdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwLmdldFN1Ykdyb3Vwcyh0cnVlKTtcbn07XG5cbkdyb3VwQ29tcG9uZW50LnByb3RvdHlwZS5nZXRQYXJlbnRHcm91cCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwLnBhcmVudCA/IHRoaXMuX2dyb3VwLnBhcmVudC5nZXRDb21wb25lbnQoKSA6IGZhbHNlO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldFZpc2liaWxpdHkgPSBmdW5jdGlvbiAoKSB7XG5cdGNvbnNvbGUud2FybihcImdldFZpc2liaWxpdHkgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZCwgeW91IHNob3VsZCBub3cgdXNlIHRoZSBpc1Zpc2libGUgZnVuY3Rpb25cIik7XG5cdHJldHVybiB0aGlzLl9ncm91cC52aXNpYmxlO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmlzVmlzaWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwLnZpc2libGU7XG59O1xuXG5Hcm91cENvbXBvbmVudC5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fZ3JvdXAuc2hvdygpO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX2dyb3VwLmhpZGUoKTtcbn07XG5cbkdyb3VwQ29tcG9uZW50LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuX2dyb3VwLnRvZ2dsZVZpc2liaWxpdHkoKTtcbn07XG5cbkdyb3VwQ29tcG9uZW50LnByb3RvdHlwZS5fZ2V0U2VsZiA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuX2dyb3VwO1xufTtcblxuR3JvdXBDb21wb25lbnQucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5fZ3JvdXAuZ3JvdXBNYW5hZ2VyLnRhYmxlO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8gR3JvdXAgRnVuY3Rpb25zIC8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgR3JvdXAgPSBmdW5jdGlvbiBHcm91cChncm91cE1hbmFnZXIsIHBhcmVudCwgbGV2ZWwsIGtleSwgZmllbGQsIGdlbmVyYXRvciwgb2xkR3JvdXApIHtcblxuXHR0aGlzLmdyb3VwTWFuYWdlciA9IGdyb3VwTWFuYWdlcjtcblx0dGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdHRoaXMua2V5ID0ga2V5O1xuXHR0aGlzLmxldmVsID0gbGV2ZWw7XG5cdHRoaXMuZmllbGQgPSBmaWVsZDtcblx0dGhpcy5oYXNTdWJHcm91cHMgPSBsZXZlbCA8IGdyb3VwTWFuYWdlci5ncm91cElETG9va3Vwcy5sZW5ndGggLSAxO1xuXHR0aGlzLmFkZFJvdyA9IHRoaXMuaGFzU3ViR3JvdXBzID8gdGhpcy5fYWRkUm93VG9Hcm91cCA6IHRoaXMuX2FkZFJvdztcblx0dGhpcy50eXBlID0gXCJncm91cFwiOyAvL3R5cGUgb2YgZWxlbWVudFxuXHR0aGlzLm9sZCA9IG9sZEdyb3VwO1xuXHR0aGlzLnJvd3MgPSBbXTtcblx0dGhpcy5ncm91cHMgPSBbXTtcblx0dGhpcy5ncm91cExpc3QgPSBbXTtcblx0dGhpcy5nZW5lcmF0b3IgPSBnZW5lcmF0b3I7XG5cdHRoaXMuZWxlbWVudENvbnRlbnRzID0gZmFsc2U7XG5cdHRoaXMuaGVpZ2h0ID0gMDtcblx0dGhpcy5vdXRlckhlaWdodCA9IDA7XG5cdHRoaXMuaW5pdGlhbGl6ZWQgPSBmYWxzZTtcblx0dGhpcy5jYWxjcyA9IHt9O1xuXHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdHRoaXMubW9kdWxlcyA9IHt9O1xuXHR0aGlzLmFycm93RWxlbWVudCA9IGZhbHNlO1xuXG5cdHRoaXMudmlzaWJsZSA9IG9sZEdyb3VwID8gb2xkR3JvdXAudmlzaWJsZSA6IHR5cGVvZiBncm91cE1hbmFnZXIuc3RhcnRPcGVuW2xldmVsXSAhPT0gXCJ1bmRlZmluZWRcIiA/IGdyb3VwTWFuYWdlci5zdGFydE9wZW5bbGV2ZWxdIDogZ3JvdXBNYW5hZ2VyLnN0YXJ0T3BlblswXTtcblxuXHR0aGlzLmNvbXBvbmVudCA9IG51bGw7XG5cblx0dGhpcy5jcmVhdGVFbGVtZW50cygpO1xuXHR0aGlzLmFkZEJpbmRpbmdzKCk7XG5cblx0dGhpcy5jcmVhdGVWYWx1ZUdyb3VwcygpO1xufTtcblxuR3JvdXAucHJvdG90eXBlLndpcGUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLmdyb3VwTGlzdC5sZW5ndGgpIHtcblx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdFx0Z3JvdXAud2lwZSgpO1xuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuZWxlbWVudCA9IGZhbHNlO1xuXHRcdHRoaXMuYXJyb3dFbGVtZW50ID0gZmFsc2U7XG5cdFx0dGhpcy5lbGVtZW50Q29udGVudHMgPSBmYWxzZTtcblx0fVxufTtcblxuR3JvdXAucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgYXJyb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRhcnJvdy5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWFycm93XCIpO1xuXG5cdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvd1wiKTtcblx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItZ3JvdXBcIik7XG5cdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLWxldmVsLVwiICsgdGhpcy5sZXZlbCk7XG5cdHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwicm93Z3JvdXBcIik7XG5cblx0dGhpcy5hcnJvd0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHR0aGlzLmFycm93RWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLXRvZ2dsZVwiKTtcblx0dGhpcy5hcnJvd0VsZW1lbnQuYXBwZW5kQ2hpbGQoYXJyb3cpO1xuXG5cdC8vc2V0dXAgbW92YWJsZSByb3dzXG5cdGlmICh0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzICE9PSBmYWxzZSAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2RFeGlzdHMoXCJtb3ZlUm93XCIpKSB7XG5cdFx0dGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5tb3ZlUm93LmluaXRpYWxpemVHcm91cEhlYWRlcih0aGlzKTtcblx0fVxufTtcblxuR3JvdXAucHJvdG90eXBlLmNyZWF0ZVZhbHVlR3JvdXBzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXM2OCA9IHRoaXM7XG5cblx0dmFyIGxldmVsID0gdGhpcy5sZXZlbCArIDE7XG5cdGlmICh0aGlzLmdyb3VwTWFuYWdlci5hbGxvd2VkVmFsdWVzICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLmFsbG93ZWRWYWx1ZXNbbGV2ZWxdKSB7XG5cdFx0dGhpcy5ncm91cE1hbmFnZXIuYWxsb3dlZFZhbHVlc1tsZXZlbF0uZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRcdF90aGlzNjguX2NyZWF0ZUdyb3VwKHZhbHVlLCBsZXZlbCk7XG5cdFx0fSk7XG5cdH1cbn07XG5cbkdyb3VwLnByb3RvdHlwZS5hZGRCaW5kaW5ncyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZGJsVGFwLFxuXHQgICAgdGFwSG9sZCxcblx0ICAgIHRhcCxcblx0ICAgIHRvZ2dsZUVsZW1lbnQ7XG5cblx0Ly9oYW5kbGUgZ3JvdXAgY2xpY2sgZXZlbnRzXG5cdGlmIChzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwQ2xpY2spIHtcblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwQ2xpY2suY2FsbChzZWxmLmdyb3VwTWFuYWdlci50YWJsZSwgZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoc2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cERibENsaWNrKSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkYmxjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cERibENsaWNrLmNhbGwoc2VsZi5ncm91cE1hbmFnZXIudGFibGUsIGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHNlbGYuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBDb250ZXh0KSB7XG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0c2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cENvbnRleHQuY2FsbChzZWxmLmdyb3VwTWFuYWdlci50YWJsZSwgZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoKHNlbGYuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBDb250ZXh0TWVudSB8fCBzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwQ2xpY2tNZW51KSAmJiBzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5tb2RFeGlzdHMoXCJtZW51XCIpKSB7XG5cdFx0c2VsZi5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5tZW51LmluaXRpYWxpemVHcm91cC5jYWxsKHNlbGYuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMubWVudSwgc2VsZik7XG5cdH1cblxuXHRpZiAoc2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFRhcCkge1xuXG5cdFx0dGFwID0gZmFsc2U7XG5cblx0XHRzZWxmLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHRhcCA9IHRydWU7XG5cdFx0fSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKHRhcCkge1xuXHRcdFx0XHRzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwVGFwKGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXG5cdFx0XHR0YXAgPSBmYWxzZTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwRGJsVGFwKSB7XG5cblx0XHRkYmxUYXAgPSBudWxsO1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXG5cdFx0XHRpZiAoZGJsVGFwKSB7XG5cdFx0XHRcdGNsZWFyVGltZW91dChkYmxUYXApO1xuXHRcdFx0XHRkYmxUYXAgPSBudWxsO1xuXG5cdFx0XHRcdHNlbGYuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBEYmxUYXAoZSwgc2VsZi5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGRibFRhcCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChkYmxUYXApO1xuXHRcdFx0XHRcdGRibFRhcCA9IG51bGw7XG5cdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoc2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFRhcEhvbGQpIHtcblxuXHRcdHRhcEhvbGQgPSBudWxsO1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGFwSG9sZCk7XG5cblx0XHRcdHRhcEhvbGQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHRhcEhvbGQpO1xuXHRcdFx0XHR0YXBIb2xkID0gbnVsbDtcblx0XHRcdFx0dGFwID0gZmFsc2U7XG5cdFx0XHRcdHNlbGYuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBUYXBIb2xkKGUsIHNlbGYuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fSwgMTAwMCk7XG5cdFx0fSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0c2VsZi5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRhcEhvbGQpO1xuXHRcdFx0dGFwSG9sZCA9IG51bGw7XG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoc2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFRvZ2dsZUVsZW1lbnQpIHtcblx0XHR0b2dnbGVFbGVtZW50ID0gc2VsZi5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFRvZ2dsZUVsZW1lbnQgPT0gXCJhcnJvd1wiID8gc2VsZi5hcnJvd0VsZW1lbnQgOiBzZWxmLmVsZW1lbnQ7XG5cblx0XHR0b2dnbGVFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cdFx0XHRzZWxmLnRvZ2dsZVZpc2liaWxpdHkoKTtcblx0XHR9KTtcblx0fVxufTtcblxuR3JvdXAucHJvdG90eXBlLl9jcmVhdGVHcm91cCA9IGZ1bmN0aW9uIChncm91cElELCBsZXZlbCkge1xuXHR2YXIgZ3JvdXBLZXkgPSBsZXZlbCArIFwiX1wiICsgZ3JvdXBJRDtcblx0dmFyIGdyb3VwID0gbmV3IEdyb3VwKHRoaXMuZ3JvdXBNYW5hZ2VyLCB0aGlzLCBsZXZlbCwgZ3JvdXBJRCwgdGhpcy5ncm91cE1hbmFnZXIuZ3JvdXBJRExvb2t1cHNbbGV2ZWxdLmZpZWxkLCB0aGlzLmdyb3VwTWFuYWdlci5oZWFkZXJHZW5lcmF0b3JbbGV2ZWxdIHx8IHRoaXMuZ3JvdXBNYW5hZ2VyLmhlYWRlckdlbmVyYXRvclswXSwgdGhpcy5vbGQgPyB0aGlzLm9sZC5ncm91cHNbZ3JvdXBLZXldIDogZmFsc2UpO1xuXG5cdHRoaXMuZ3JvdXBzW2dyb3VwS2V5XSA9IGdyb3VwO1xuXHR0aGlzLmdyb3VwTGlzdC5wdXNoKGdyb3VwKTtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5fYWRkUm93VG9Hcm91cCA9IGZ1bmN0aW9uIChyb3cpIHtcblxuXHR2YXIgbGV2ZWwgPSB0aGlzLmxldmVsICsgMTtcblxuXHRpZiAodGhpcy5oYXNTdWJHcm91cHMpIHtcblx0XHR2YXIgZ3JvdXBJRCA9IHRoaXMuZ3JvdXBNYW5hZ2VyLmdyb3VwSURMb29rdXBzW2xldmVsXS5mdW5jKHJvdy5nZXREYXRhKCkpLFxuXHRcdCAgICBncm91cEtleSA9IGxldmVsICsgXCJfXCIgKyBncm91cElEO1xuXG5cdFx0aWYgKHRoaXMuZ3JvdXBNYW5hZ2VyLmFsbG93ZWRWYWx1ZXMgJiYgdGhpcy5ncm91cE1hbmFnZXIuYWxsb3dlZFZhbHVlc1tsZXZlbF0pIHtcblx0XHRcdGlmICh0aGlzLmdyb3Vwc1tncm91cEtleV0pIHtcblx0XHRcdFx0dGhpcy5ncm91cHNbZ3JvdXBLZXldLmFkZFJvdyhyb3cpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIXRoaXMuZ3JvdXBzW2dyb3VwS2V5XSkge1xuXHRcdFx0XHR0aGlzLl9jcmVhdGVHcm91cChncm91cElELCBsZXZlbCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuZ3JvdXBzW2dyb3VwS2V5XS5hZGRSb3cocm93KTtcblx0XHR9XG5cdH1cbn07XG5cbkdyb3VwLnByb3RvdHlwZS5fYWRkUm93ID0gZnVuY3Rpb24gKHJvdykge1xuXHR0aGlzLnJvd3MucHVzaChyb3cpO1xuXHRyb3cubW9kdWxlcy5ncm91cCA9IHRoaXM7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuaW5zZXJ0Um93ID0gZnVuY3Rpb24gKHJvdywgdG8sIGFmdGVyKSB7XG5cdHZhciBkYXRhID0gdGhpcy5jb25mb3JtUm93RGF0YSh7fSk7XG5cblx0cm93LnVwZGF0ZURhdGEoZGF0YSk7XG5cblx0dmFyIHRvSW5kZXggPSB0aGlzLnJvd3MuaW5kZXhPZih0byk7XG5cblx0aWYgKHRvSW5kZXggPiAtMSkge1xuXHRcdGlmIChhZnRlcikge1xuXHRcdFx0dGhpcy5yb3dzLnNwbGljZSh0b0luZGV4ICsgMSwgMCwgcm93KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5yb3dzLnNwbGljZSh0b0luZGV4LCAwLCByb3cpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRpZiAoYWZ0ZXIpIHtcblx0XHRcdHRoaXMucm93cy5wdXNoKHJvdyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucm93cy51bnNoaWZ0KHJvdyk7XG5cdFx0fVxuXHR9XG5cblx0cm93Lm1vZHVsZXMuZ3JvdXAgPSB0aGlzO1xuXG5cdHRoaXMuZ2VuZXJhdGVHcm91cEhlYWRlckNvbnRlbnRzKCk7XG5cblx0aWYgKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgIT0gXCJ0YWJsZVwiKSB7XG5cdFx0dGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5yZWNhbGNHcm91cCh0aGlzKTtcblx0fVxuXG5cdHRoaXMuZ3JvdXBNYW5hZ2VyLnVwZGF0ZUdyb3VwUm93cyh0cnVlKTtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5zY3JvbGxIZWFkZXIgPSBmdW5jdGlvbiAobGVmdCkge1xuXHR0aGlzLmFycm93RWxlbWVudC5zdHlsZS5tYXJnaW5MZWZ0ID0gbGVmdDtcblxuXHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuXHRcdGNoaWxkLnNjcm9sbEhlYWRlcihsZWZ0KTtcblx0fSk7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuZ2V0Um93SW5kZXggPSBmdW5jdGlvbiAocm93KSB7fTtcblxuLy91cGRhdGUgcm93IGRhdGEgdG8gbWF0Y2ggZ3JvdXBpbmcgY29udHJhaW50c1xuR3JvdXAucHJvdG90eXBlLmNvbmZvcm1Sb3dEYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0aWYgKHRoaXMuZmllbGQpIHtcblx0XHRkYXRhW3RoaXMuZmllbGRdID0gdGhpcy5rZXk7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiRGF0YSBDb25mb3JtaW5nIEVycm9yIC0gQ2Fubm90IGNvbmZvcm0gcm93IGRhdGEgdG8gbWF0Y2ggbmV3IGdyb3VwIGFzIGdyb3VwQnkgaXMgYSBmdW5jdGlvblwiKTtcblx0fVxuXG5cdGlmICh0aGlzLnBhcmVudCkge1xuXHRcdGRhdGEgPSB0aGlzLnBhcmVudC5jb25mb3JtUm93RGF0YShkYXRhKTtcblx0fVxuXG5cdHJldHVybiBkYXRhO1xufTtcblxuR3JvdXAucHJvdG90eXBlLnJlbW92ZVJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGluZGV4ID0gdGhpcy5yb3dzLmluZGV4T2Yocm93KTtcblx0dmFyIGVsID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdHRoaXMucm93cy5zcGxpY2UoaW5kZXgsIDEpO1xuXHR9XG5cblx0aWYgKCF0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwVmFsdWVzICYmICF0aGlzLnJvd3MubGVuZ3RoKSB7XG5cdFx0aWYgKHRoaXMucGFyZW50KSB7XG5cdFx0XHR0aGlzLnBhcmVudC5yZW1vdmVHcm91cCh0aGlzKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5ncm91cE1hbmFnZXIucmVtb3ZlR3JvdXAodGhpcyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHR9IGVsc2Uge1xuXG5cdFx0aWYgKGVsLnBhcmVudE5vZGUpIHtcblx0XHRcdGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpO1xuXHRcdH1cblxuXHRcdHRoaXMuZ2VuZXJhdGVHcm91cEhlYWRlckNvbnRlbnRzKCk7XG5cblx0XHRpZiAodGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikgJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIpIHtcblx0XHRcdHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVjYWxjR3JvdXAodGhpcyk7XG5cdFx0fVxuXHR9XG59O1xuXG5Hcm91cC5wcm90b3R5cGUucmVtb3ZlR3JvdXAgPSBmdW5jdGlvbiAoZ3JvdXApIHtcblx0dmFyIGdyb3VwS2V5ID0gZ3JvdXAubGV2ZWwgKyBcIl9cIiArIGdyb3VwLmtleSxcblx0ICAgIGluZGV4O1xuXG5cdGlmICh0aGlzLmdyb3Vwc1tncm91cEtleV0pIHtcblx0XHRkZWxldGUgdGhpcy5ncm91cHNbZ3JvdXBLZXldO1xuXG5cdFx0aW5kZXggPSB0aGlzLmdyb3VwTGlzdC5pbmRleE9mKGdyb3VwKTtcblxuXHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHR0aGlzLmdyb3VwTGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdH1cblxuXHRcdGlmICghdGhpcy5ncm91cExpc3QubGVuZ3RoKSB7XG5cdFx0XHRpZiAodGhpcy5wYXJlbnQpIHtcblx0XHRcdFx0dGhpcy5wYXJlbnQucmVtb3ZlR3JvdXAodGhpcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmdyb3VwTWFuYWdlci5yZW1vdmVHcm91cCh0aGlzKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbkdyb3VwLnByb3RvdHlwZS5nZXRIZWFkZXJzQW5kUm93cyA9IGZ1bmN0aW9uIChub0NhbGMpIHtcblx0dmFyIG91dHB1dCA9IFtdO1xuXG5cdG91dHB1dC5wdXNoKHRoaXMpO1xuXG5cdHRoaXMuX3Zpc1NldCgpO1xuXG5cdGlmICh0aGlzLnZpc2libGUpIHtcblx0XHRpZiAodGhpcy5ncm91cExpc3QubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdFx0XHRvdXRwdXQgPSBvdXRwdXQuY29uY2F0KGdyb3VwLmdldEhlYWRlcnNBbmRSb3dzKG5vQ2FsYykpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICghbm9DYWxjICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuY29sdW1uQ2FsY3MgIT0gXCJ0YWJsZVwiICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpICYmIHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuaGFzVG9wQ2FsY3MoKSkge1xuXHRcdFx0XHRpZiAodGhpcy5jYWxjcy50b3ApIHtcblx0XHRcdFx0XHR0aGlzLmNhbGNzLnRvcC5kZXRhY2hFbGVtZW50KCk7XG5cdFx0XHRcdFx0dGhpcy5jYWxjcy50b3AuZGVsZXRlQ2VsbHMoKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuY2FsY3MudG9wID0gdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5nZW5lcmF0ZVRvcFJvdyh0aGlzLnJvd3MpO1xuXHRcdFx0XHRvdXRwdXQucHVzaCh0aGlzLmNhbGNzLnRvcCk7XG5cdFx0XHR9XG5cblx0XHRcdG91dHB1dCA9IG91dHB1dC5jb25jYXQodGhpcy5yb3dzKTtcblxuXHRcdFx0aWYgKCFub0NhbGMgJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIgJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikgJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5oYXNCb3R0b21DYWxjcygpKSB7XG5cdFx0XHRcdGlmICh0aGlzLmNhbGNzLmJvdHRvbSkge1xuXHRcdFx0XHRcdHRoaXMuY2FsY3MuYm90dG9tLmRldGFjaEVsZW1lbnQoKTtcblx0XHRcdFx0XHR0aGlzLmNhbGNzLmJvdHRvbS5kZWxldGVDZWxscygpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5jYWxjcy5ib3R0b20gPSB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmdlbmVyYXRlQm90dG9tUm93KHRoaXMucm93cyk7XG5cdFx0XHRcdG91dHB1dC5wdXNoKHRoaXMuY2FsY3MuYm90dG9tKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0aWYgKCF0aGlzLmdyb3VwTGlzdC5sZW5ndGggJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIpIHtcblxuXHRcdFx0aWYgKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpKSB7XG5cblx0XHRcdFx0aWYgKCFub0NhbGMgJiYgdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5oYXNUb3BDYWxjcygpKSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMuY2FsY3MudG9wKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNhbGNzLnRvcC5kZXRhY2hFbGVtZW50KCk7XG5cdFx0XHRcdFx0XHR0aGlzLmNhbGNzLnRvcC5kZWxldGVDZWxscygpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwQ2xvc2VkU2hvd0NhbGNzKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNhbGNzLnRvcCA9IHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MuZ2VuZXJhdGVUb3BSb3codGhpcy5yb3dzKTtcblx0XHRcdFx0XHRcdG91dHB1dC5wdXNoKHRoaXMuY2FsY3MudG9wKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoIW5vQ2FsYyAmJiB0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5tb2R1bGVzLmNvbHVtbkNhbGNzLmhhc0JvdHRvbUNhbGNzKCkpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5jYWxjcy5ib3R0b20pIHtcblx0XHRcdFx0XHRcdHRoaXMuY2FsY3MuYm90dG9tLmRldGFjaEVsZW1lbnQoKTtcblx0XHRcdFx0XHRcdHRoaXMuY2FsY3MuYm90dG9tLmRlbGV0ZUNlbGxzKCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLm9wdGlvbnMuZ3JvdXBDbG9zZWRTaG93Q2FsY3MpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2FsY3MuYm90dG9tID0gdGhpcy5ncm91cE1hbmFnZXIudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5nZW5lcmF0ZUJvdHRvbVJvdyh0aGlzLnJvd3MpO1xuXHRcdFx0XHRcdFx0b3V0cHV0LnB1c2godGhpcy5jYWxjcy5ib3R0b20pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uICh2aXNpYmxlLCB0cmFuc2Zvcm0pIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0dGhpcy5fdmlzU2V0KCk7XG5cblx0aWYgKCF2aXNpYmxlIHx8IHZpc2libGUgJiYgdGhpcy52aXNpYmxlKSB7XG5cdFx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0b3V0cHV0LnB1c2gocm93LmdldERhdGEodHJhbnNmb3JtIHx8IFwiZGF0YVwiKSk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuLy8gR3JvdXAucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbigpe1xuLy8gXHR0aGlzLl92aXNTZXQoKTtcblxuLy8gXHRyZXR1cm4gdGhpcy52aXNpYmxlID8gdGhpcy5yb3dzIDogW107XG4vLyB9O1xuXG5Hcm91cC5wcm90b3R5cGUuZ2V0Um93Q291bnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjb3VudCA9IDA7XG5cblx0aWYgKHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aCkge1xuXHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24gKGdyb3VwKSB7XG5cdFx0XHRjb3VudCArPSBncm91cC5nZXRSb3dDb3VudCgpO1xuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdGNvdW50ID0gdGhpcy5yb3dzLmxlbmd0aDtcblx0fVxuXHRyZXR1cm4gY291bnQ7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUudG9nZ2xlVmlzaWJpbGl0eSA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMudmlzaWJsZSkge1xuXHRcdHRoaXMuaGlkZSgpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuc2hvdygpO1xuXHR9XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy52aXNpYmxlID0gZmFsc2U7XG5cblx0aWYgKHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLnJvd01hbmFnZXIuZ2V0UmVuZGVyTW9kZSgpID09IFwiY2xhc3NpY1wiICYmICF0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLnBhZ2luYXRpb24pIHtcblxuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWdyb3VwLXZpc2libGVcIik7XG5cblx0XHRpZiAodGhpcy5ncm91cExpc3QubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXG5cdFx0XHRcdHZhciByb3dzID0gZ3JvdXAuZ2V0SGVhZGVyc0FuZFJvd3MoKTtcblxuXHRcdFx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRcdHJvdy5kZXRhY2hFbGVtZW50KCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyb3dFbCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLnNldERpc3BsYXlSb3dzKHRoaXMuZ3JvdXBNYW5hZ2VyLnVwZGF0ZUdyb3VwUm93cygpLCB0aGlzLmdyb3VwTWFuYWdlci5nZXREaXNwbGF5SW5kZXgoKSk7XG5cblx0XHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLmNoZWNrQ2xhc3NpY01vZGVHcm91cEhlYWRlcldpZHRoKCk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHR9XG5cblx0dGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5ncm91cFZpc2liaWxpdHlDaGFuZ2VkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5nZXRDb21wb25lbnQoKSwgZmFsc2UpO1xufTtcblxuR3JvdXAucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRzZWxmLnZpc2libGUgPSB0cnVlO1xuXG5cdGlmICh0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5yb3dNYW5hZ2VyLmdldFJlbmRlck1vZGUoKSA9PSBcImNsYXNzaWNcIiAmJiAhdGhpcy5ncm91cE1hbmFnZXIudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uKSB7XG5cblx0XHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ncm91cC12aXNpYmxlXCIpO1xuXG5cdFx0dmFyIHByZXYgPSBzZWxmLmdldEVsZW1lbnQoKTtcblxuXHRcdGlmICh0aGlzLmdyb3VwTGlzdC5sZW5ndGgpIHtcblx0XHRcdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24gKGdyb3VwKSB7XG5cdFx0XHRcdHZhciByb3dzID0gZ3JvdXAuZ2V0SGVhZGVyc0FuZFJvd3MoKTtcblxuXHRcdFx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRcdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdFx0cHJldi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyb3dFbCwgcHJldi5uZXh0U2libGluZyk7XG5cdFx0XHRcdFx0cm93LmluaXRpYWxpemUoKTtcblx0XHRcdFx0XHRwcmV2ID0gcm93RWw7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNlbGYucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdFx0dmFyIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblx0XHRcdFx0cHJldi5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyb3dFbCwgcHJldi5uZXh0U2libGluZyk7XG5cdFx0XHRcdHJvdy5pbml0aWFsaXplKCk7XG5cdFx0XHRcdHByZXYgPSByb3dFbDtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLnJvd01hbmFnZXIuc2V0RGlzcGxheVJvd3ModGhpcy5ncm91cE1hbmFnZXIudXBkYXRlR3JvdXBSb3dzKCksIHRoaXMuZ3JvdXBNYW5hZ2VyLmdldERpc3BsYXlJbmRleCgpKTtcblxuXHRcdHRoaXMuZ3JvdXBNYW5hZ2VyLnRhYmxlLnJvd01hbmFnZXIuY2hlY2tDbGFzc2ljTW9kZUdyb3VwSGVhZGVyV2lkdGgoKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLmdyb3VwTWFuYWdlci51cGRhdGVHcm91cFJvd3ModHJ1ZSk7XG5cdH1cblxuXHR0aGlzLmdyb3VwTWFuYWdlci50YWJsZS5vcHRpb25zLmdyb3VwVmlzaWJpbGl0eUNoYW5nZWQuY2FsbCh0aGlzLnRhYmxlLCB0aGlzLmdldENvbXBvbmVudCgpLCB0cnVlKTtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5fdmlzU2V0ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZGF0YSA9IFtdO1xuXG5cdGlmICh0eXBlb2YgdGhpcy52aXNpYmxlID09IFwiZnVuY3Rpb25cIikge1xuXG5cdFx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy52aXNpYmxlID0gdGhpcy52aXNpYmxlKHRoaXMua2V5LCB0aGlzLmdldFJvd0NvdW50KCksIGRhdGEsIHRoaXMuZ2V0Q29tcG9uZW50KCkpO1xuXHR9XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuZ2V0Um93R3JvdXAgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBtYXRjaCA9IGZhbHNlO1xuXHRpZiAodGhpcy5ncm91cExpc3QubGVuZ3RoKSB7XG5cdFx0dGhpcy5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZ3JvdXApIHtcblx0XHRcdHZhciByZXN1bHQgPSBncm91cC5nZXRSb3dHcm91cChyb3cpO1xuXG5cdFx0XHRpZiAocmVzdWx0KSB7XG5cdFx0XHRcdG1hdGNoID0gcmVzdWx0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLnJvd3MuZmluZChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0cmV0dXJuIGl0ZW0gPT09IHJvdztcblx0XHR9KSkge1xuXHRcdFx0bWF0Y2ggPSB0aGlzO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBtYXRjaDtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5nZXRTdWJHcm91cHMgPSBmdW5jdGlvbiAoY29tcG9uZW50KSB7XG5cdHZhciBvdXRwdXQgPSBbXTtcblxuXHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChjaGlsZCkge1xuXHRcdG91dHB1dC5wdXNoKGNvbXBvbmVudCA/IGNoaWxkLmdldENvbXBvbmVudCgpIDogY2hpbGQpO1xuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuR3JvdXAucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbiAoY29tcG9tZW50KSB7XG5cdHZhciBvdXRwdXQgPSBbXTtcblxuXHR0aGlzLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0b3V0cHV0LnB1c2goY29tcG9tZW50ID8gcm93LmdldENvbXBvbmVudCgpIDogcm93KTtcblx0fSk7XG5cblx0cmV0dXJuIG91dHB1dDtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5nZW5lcmF0ZUdyb3VwSGVhZGVyQ29udGVudHMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBkYXRhID0gW107XG5cblx0dGhpcy5yb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdGRhdGEucHVzaChyb3cuZ2V0RGF0YSgpKTtcblx0fSk7XG5cblx0dGhpcy5lbGVtZW50Q29udGVudHMgPSB0aGlzLmdlbmVyYXRvcih0aGlzLmtleSwgdGhpcy5nZXRSb3dDb3VudCgpLCBkYXRhLCB0aGlzLmdldENvbXBvbmVudCgpKTtcblxuXHR3aGlsZSAodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpIHtcblx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xuXHR9aWYgKHR5cGVvZiB0aGlzLmVsZW1lbnRDb250ZW50cyA9PT0gXCJzdHJpbmdcIikge1xuXHRcdHRoaXMuZWxlbWVudC5pbm5lckhUTUwgPSB0aGlzLmVsZW1lbnRDb250ZW50cztcblx0fSBlbHNlIHtcblx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50Q29udGVudHMpO1xuXHR9XG5cblx0dGhpcy5lbGVtZW50Lmluc2VydEJlZm9yZSh0aGlzLmFycm93RWxlbWVudCwgdGhpcy5lbGVtZW50LmZpcnN0Q2hpbGQpO1xufTtcblxuR3JvdXAucHJvdG90eXBlLmdldFBhdGggPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBwYXRoID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTtcblxuXHRwYXRoLnVuc2hpZnQodGhpcy5rZXkpO1xuXHRpZiAodGhpcy5wYXJlbnQpIHtcblx0XHR0aGlzLnBhcmVudC5nZXRQYXRoKHBhdGgpO1xuXHR9XG5cdHJldHVybiBwYXRoO1xufTtcbi8vLy8vLy8vLy8vLy8vIFN0YW5kYXJkIFJvdyBGdW5jdGlvbnMgLy8vLy8vLy8vLy8vLy9cblxuR3JvdXAucHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuYWRkQmluZGluZ3NkID0gZmFsc2U7XG5cblx0dGhpcy5fdmlzU2V0KCk7XG5cblx0aWYgKHRoaXMudmlzaWJsZSkge1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWdyb3VwLXZpc2libGVcIik7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItZ3JvdXAtdmlzaWJsZVwiKTtcblx0fVxuXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoOyArK2kpIHtcblx0XHR0aGlzLmVsZW1lbnQuY2hpbGROb2Rlc1tpXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudC5jaGlsZE5vZGVzW2ldKTtcblx0fVxuXG5cdHRoaXMuZ2VuZXJhdGVHcm91cEhlYWRlckNvbnRlbnRzKCk7XG5cblx0Ly8gdGhpcy5hZGRCaW5kaW5ncygpO1xuXG5cdHJldHVybiB0aGlzLmVsZW1lbnQ7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuZGV0YWNoRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKHRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQucGFyZW50Tm9kZSkge1xuXHRcdHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuZWxlbWVudCk7XG5cdH1cbn07XG5cbi8vbm9ybWFsaXplIHRoZSBoZWlnaHQgb2YgZWxlbWVudHMgaW4gdGhlIHJvd1xuR3JvdXAucHJvdG90eXBlLm5vcm1hbGl6ZUhlaWdodCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5zZXRIZWlnaHQodGhpcy5lbGVtZW50LmNsaWVudEhlaWdodCk7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHRpZiAoIXRoaXMuaW5pdGlhbGl6ZWQgfHwgZm9yY2UpIHtcblx0XHR0aGlzLm5vcm1hbGl6ZUhlaWdodCgpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXHR9XG59O1xuXG5Hcm91cC5wcm90b3R5cGUucmVpbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmluaXRpYWxpemVkID0gZmFsc2U7XG5cdHRoaXMuaGVpZ2h0ID0gMDtcblxuXHRpZiAoVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmVsVmlzaWJsZSh0aGlzLmVsZW1lbnQpKSB7XG5cdFx0dGhpcy5pbml0aWFsaXplKHRydWUpO1xuXHR9XG59O1xuXG5Hcm91cC5wcm90b3R5cGUuc2V0SGVpZ2h0ID0gZnVuY3Rpb24gKGhlaWdodCkge1xuXHRpZiAodGhpcy5oZWlnaHQgIT0gaGVpZ2h0KSB7XG5cdFx0dGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG5cdFx0dGhpcy5vdXRlckhlaWdodCA9IHRoaXMuZWxlbWVudC5vZmZzZXRIZWlnaHQ7XG5cdH1cbn07XG5cbi8vcmV0dXJuIHJvd3Mgb3V0ZXIgaGVpZ2h0XG5Hcm91cC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5vdXRlckhlaWdodDtcbn07XG5cbkdyb3VwLnByb3RvdHlwZS5nZXRHcm91cCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXM7XG59O1xuXG5Hcm91cC5wcm90b3R5cGUucmVpbml0aWFsaXplSGVpZ2h0ID0gZnVuY3Rpb24gKCkge307XG5Hcm91cC5wcm90b3R5cGUuY2FsY0hlaWdodCA9IGZ1bmN0aW9uICgpIHt9O1xuR3JvdXAucHJvdG90eXBlLnNldENlbGxIZWlnaHQgPSBmdW5jdGlvbiAoKSB7fTtcbkdyb3VwLnByb3RvdHlwZS5jbGVhckNlbGxIZWlnaHQgPSBmdW5jdGlvbiAoKSB7fTtcblxuLy8vLy8vLy8vLy8vLy8vLyBPYmplY3QgR2VuZXJhdGlvbiAvLy8vLy8vLy8vLy8vLy8vL1xuR3JvdXAucHJvdG90eXBlLmdldENvbXBvbmVudCA9IGZ1bmN0aW9uICgpIHtcblx0aWYgKCF0aGlzLmNvbXBvbmVudCkge1xuXHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IEdyb3VwQ29tcG9uZW50KHRoaXMpO1xuXHR9XG5cblx0cmV0dXJuIHRoaXMuY29tcG9uZW50O1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vIEdyb3VwIFJvdyBFeHRlbnNpb24gLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgR3JvdXBSb3dzID0gZnVuY3Rpb24gR3JvdXBSb3dzKHRhYmxlKSB7XG5cblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXG5cdHRoaXMuZ3JvdXBJRExvb2t1cHMgPSBmYWxzZTsgLy9lbmFibGUgdGFibGUgZ3JvdXBpbmcgYW5kIHNldCBmaWVsZCB0byBncm91cCBieVxuXHR0aGlzLnN0YXJ0T3BlbiA9IFtmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XTsgLy9zdGFydGluZyBzdGF0ZSBvZiBncm91cFxuXHR0aGlzLmhlYWRlckdlbmVyYXRvciA9IFtmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1dO1xuXHR0aGlzLmdyb3VwTGlzdCA9IFtdOyAvL29yZGVyZWQgbGlzdCBvZiBncm91cHNcblx0dGhpcy5hbGxvd2VkVmFsdWVzID0gZmFsc2U7XG5cdHRoaXMuZ3JvdXBzID0ge307IC8vaG9sZCByb3cgZ3JvdXBzXG5cdHRoaXMuZGlzcGxheUluZGV4ID0gMDsgLy9pbmRleCBpbiBkaXNwbGF5IHBpcGVsaW5lXG59O1xuXG4vL2luaXRpYWxpemUgZ3JvdXAgY29uZmlndXJhdGlvblxuR3JvdXBSb3dzLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBncm91cEJ5ID0gc2VsZi50YWJsZS5vcHRpb25zLmdyb3VwQnksXG5cdCAgICBzdGFydE9wZW4gPSBzZWxmLnRhYmxlLm9wdGlvbnMuZ3JvdXBTdGFydE9wZW4sXG5cdCAgICBncm91cEhlYWRlciA9IHNlbGYudGFibGUub3B0aW9ucy5ncm91cEhlYWRlcjtcblxuXHR0aGlzLmFsbG93ZWRWYWx1ZXMgPSBzZWxmLnRhYmxlLm9wdGlvbnMuZ3JvdXBWYWx1ZXM7XG5cblx0aWYgKEFycmF5LmlzQXJyYXkoZ3JvdXBCeSkgJiYgQXJyYXkuaXNBcnJheShncm91cEhlYWRlcikgJiYgZ3JvdXBCeS5sZW5ndGggPiBncm91cEhlYWRlci5sZW5ndGgpIHtcblx0XHRjb25zb2xlLndhcm4oXCJFcnJvciBjcmVhdGluZyBncm91cCBoZWFkZXJzLCBncm91cEhlYWRlciBhcnJheSBpcyBzaG9ydGVyIHRoYW4gZ3JvdXBCeSBhcnJheVwiKTtcblx0fVxuXG5cdHNlbGYuaGVhZGVyR2VuZXJhdG9yID0gW2Z1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gXCJcIjtcblx0fV07XG5cdHRoaXMuc3RhcnRPcGVuID0gW2Z1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1dOyAvL3N0YXJ0aW5nIHN0YXRlIG9mIGdyb3VwXG5cblx0c2VsZi50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmJpbmQoXCJncm91cHN8aXRlbVwiLCBmdW5jdGlvbiAobGFuZ1ZhbHVlLCBsYW5nKSB7XG5cdFx0c2VsZi5oZWFkZXJHZW5lcmF0b3JbMF0gPSBmdW5jdGlvbiAodmFsdWUsIGNvdW50LCBkYXRhKSB7XG5cdFx0XHQvL2hlYWRlciBsYXlvdXQgZnVuY3Rpb25cblx0XHRcdHJldHVybiAodHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiID8gXCJcIiA6IHZhbHVlKSArIFwiPHNwYW4+KFwiICsgY291bnQgKyBcIiBcIiArIChjb3VudCA9PT0gMSA/IGxhbmdWYWx1ZSA6IGxhbmcuZ3JvdXBzLml0ZW1zKSArIFwiKTwvc3Bhbj5cIjtcblx0XHR9O1xuXHR9KTtcblxuXHR0aGlzLmdyb3VwSURMb29rdXBzID0gW107XG5cblx0aWYgKEFycmF5LmlzQXJyYXkoZ3JvdXBCeSkgfHwgZ3JvdXBCeSkge1xuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNvbHVtbkNhbGNzXCIpICYmIHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5DYWxjcyAhPSBcInRhYmxlXCIgJiYgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwiYm90aFwiKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY29sdW1uQ2FsY3MucmVtb3ZlQ2FsY3MoKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiY29sdW1uQ2FsY3NcIikgJiYgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbkNhbGNzICE9IFwiZ3JvdXBcIikge1xuXG5cdFx0XHR2YXIgY29scyA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5nZXRSZWFsQ29sdW1ucygpO1xuXG5cdFx0XHRjb2xzLmZvckVhY2goZnVuY3Rpb24gKGNvbCkge1xuXHRcdFx0XHRpZiAoY29sLmRlZmluaXRpb24udG9wQ2FsYykge1xuXHRcdFx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5pbml0aWFsaXplVG9wUm93KCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoY29sLmRlZmluaXRpb24uYm90dG9tQ2FsYykge1xuXHRcdFx0XHRcdHNlbGYudGFibGUubW9kdWxlcy5jb2x1bW5DYWxjcy5pbml0aWFsaXplQm90dG9tUm93KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXG5cdGlmICghQXJyYXkuaXNBcnJheShncm91cEJ5KSkge1xuXHRcdGdyb3VwQnkgPSBbZ3JvdXBCeV07XG5cdH1cblxuXHRncm91cEJ5LmZvckVhY2goZnVuY3Rpb24gKGdyb3VwLCBpKSB7XG5cdFx0dmFyIGxvb2t1cEZ1bmMsIGNvbHVtbjtcblxuXHRcdGlmICh0eXBlb2YgZ3JvdXAgPT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHRsb29rdXBGdW5jID0gZ3JvdXA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbHVtbiA9IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUZpZWxkKGdyb3VwKTtcblxuXHRcdFx0aWYgKGNvbHVtbikge1xuXHRcdFx0XHRsb29rdXBGdW5jID0gZnVuY3Rpb24gbG9va3VwRnVuYyhkYXRhKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRGaWVsZFZhbHVlKGRhdGEpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bG9va3VwRnVuYyA9IGZ1bmN0aW9uIGxvb2t1cEZ1bmMoZGF0YSkge1xuXHRcdFx0XHRcdHJldHVybiBkYXRhW2dyb3VwXTtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRzZWxmLmdyb3VwSURMb29rdXBzLnB1c2goe1xuXHRcdFx0ZmllbGQ6IHR5cGVvZiBncm91cCA9PT0gXCJmdW5jdGlvblwiID8gZmFsc2UgOiBncm91cCxcblx0XHRcdGZ1bmM6IGxvb2t1cEZ1bmMsXG5cdFx0XHR2YWx1ZXM6IHNlbGYuYWxsb3dlZFZhbHVlcyA/IHNlbGYuYWxsb3dlZFZhbHVlc1tpXSA6IGZhbHNlXG5cdFx0fSk7XG5cdH0pO1xuXG5cdGlmIChzdGFydE9wZW4pIHtcblxuXHRcdGlmICghQXJyYXkuaXNBcnJheShzdGFydE9wZW4pKSB7XG5cdFx0XHRzdGFydE9wZW4gPSBbc3RhcnRPcGVuXTtcblx0XHR9XG5cblx0XHRzdGFydE9wZW4uZm9yRWFjaChmdW5jdGlvbiAobGV2ZWwpIHtcblx0XHRcdGxldmVsID0gdHlwZW9mIGxldmVsID09IFwiZnVuY3Rpb25cIiA/IGxldmVsIDogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH07XG5cdFx0fSk7XG5cblx0XHRzZWxmLnN0YXJ0T3BlbiA9IHN0YXJ0T3Blbjtcblx0fVxuXG5cdGlmIChncm91cEhlYWRlcikge1xuXHRcdHNlbGYuaGVhZGVyR2VuZXJhdG9yID0gQXJyYXkuaXNBcnJheShncm91cEhlYWRlcikgPyBncm91cEhlYWRlciA6IFtncm91cEhlYWRlcl07XG5cdH1cblxuXHR0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcbn07XG5cbkdyb3VwUm93cy5wcm90b3R5cGUuc2V0RGlzcGxheUluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdHRoaXMuZGlzcGxheUluZGV4ID0gaW5kZXg7XG59O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLmdldERpc3BsYXlJbmRleCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuZGlzcGxheUluZGV4O1xufTtcblxuLy9yZXR1cm4gYXBwcm9wcmlhdGUgcm93cyB3aXRoIGdyb3VwIGhlYWRlcnNcbkdyb3VwUm93cy5wcm90b3R5cGUuZ2V0Um93cyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdGlmICh0aGlzLmdyb3VwSURMb29rdXBzLmxlbmd0aCkge1xuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLmRhdGFHcm91cGluZy5jYWxsKHRoaXMudGFibGUpO1xuXG5cdFx0dGhpcy5nZW5lcmF0ZUdyb3Vwcyhyb3dzKTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YUdyb3VwZWQpIHtcblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5kYXRhR3JvdXBlZC5jYWxsKHRoaXMudGFibGUsIHRoaXMuZ2V0R3JvdXBzKHRydWUpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy51cGRhdGVHcm91cFJvd3MoKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gcm93cy5zbGljZSgwKTtcblx0fVxufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5nZXRHcm91cHMgPSBmdW5jdGlvbiAoY29tcG9tZW50KSB7XG5cdHZhciBncm91cENvbXBvbmVudHMgPSBbXTtcblxuXHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdGdyb3VwQ29tcG9uZW50cy5wdXNoKGNvbXBvbWVudCA/IGdyb3VwLmdldENvbXBvbmVudCgpIDogZ3JvdXApO1xuXHR9KTtcblxuXHRyZXR1cm4gZ3JvdXBDb21wb25lbnRzO1xufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5nZXRDaGlsZEdyb3VwcyA9IGZ1bmN0aW9uIChncm91cCkge1xuXHR2YXIgX3RoaXM2OSA9IHRoaXM7XG5cblx0dmFyIGdyb3VwQ29tcG9uZW50cyA9IFtdO1xuXG5cdGlmICghZ3JvdXApIHtcblx0XHRncm91cCA9IHRoaXM7XG5cdH1cblxuXHRncm91cC5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGQpIHtcblx0XHRpZiAoY2hpbGQuZ3JvdXBMaXN0Lmxlbmd0aCkge1xuXHRcdFx0Z3JvdXBDb21wb25lbnRzID0gZ3JvdXBDb21wb25lbnRzLmNvbmNhdChfdGhpczY5LmdldENoaWxkR3JvdXBzKGNoaWxkKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGdyb3VwQ29tcG9uZW50cy5wdXNoKGNoaWxkKTtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBncm91cENvbXBvbmVudHM7XG59O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLndpcGUgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24gKGdyb3VwKSB7XG5cdFx0Z3JvdXAud2lwZSgpO1xuXHR9KTtcbn07XG5cbkdyb3VwUm93cy5wcm90b3R5cGUucHVsbEdyb3VwTGlzdERhdGEgPSBmdW5jdGlvbiAoZ3JvdXBMaXN0KSB7XG5cdHZhciBzZWxmID0gdGhpcztcblx0dmFyIGdyb3VwTGlzdERhdGEgPSBbXTtcblxuXHRncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZ3JvdXApIHtcblx0XHR2YXIgZ3JvdXBIZWFkZXIgPSB7fTtcblx0XHRncm91cEhlYWRlci5sZXZlbCA9IDA7XG5cdFx0Z3JvdXBIZWFkZXIucm93Q291bnQgPSAwO1xuXHRcdGdyb3VwSGVhZGVyLmhlYWRlckNvbnRlbnQgPSBcIlwiO1xuXHRcdHZhciBjaGlsZERhdGEgPSBbXTtcblxuXHRcdGlmIChncm91cC5oYXNTdWJHcm91cHMpIHtcblx0XHRcdGNoaWxkRGF0YSA9IHNlbGYucHVsbEdyb3VwTGlzdERhdGEoZ3JvdXAuZ3JvdXBMaXN0KTtcblxuXHRcdFx0Z3JvdXBIZWFkZXIubGV2ZWwgPSBncm91cC5sZXZlbDtcblx0XHRcdGdyb3VwSGVhZGVyLnJvd0NvdW50ID0gY2hpbGREYXRhLmxlbmd0aCAtIGdyb3VwLmdyb3VwTGlzdC5sZW5ndGg7IC8vIGRhdGEgbGVuZ3RoIG1pbnVzIG51bWJlciBvZiBzdWItaGVhZGVyc1xuXHRcdFx0Z3JvdXBIZWFkZXIuaGVhZGVyQ29udGVudCA9IGdyb3VwLmdlbmVyYXRvcihncm91cC5rZXksIGdyb3VwSGVhZGVyLnJvd0NvdW50LCBncm91cC5yb3dzLCBncm91cCk7XG5cblx0XHRcdGdyb3VwTGlzdERhdGEucHVzaChncm91cEhlYWRlcik7XG5cdFx0XHRncm91cExpc3REYXRhID0gZ3JvdXBMaXN0RGF0YS5jb25jYXQoY2hpbGREYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Z3JvdXBIZWFkZXIubGV2ZWwgPSBncm91cC5sZXZlbDtcblx0XHRcdGdyb3VwSGVhZGVyLmhlYWRlckNvbnRlbnQgPSBncm91cC5nZW5lcmF0b3IoZ3JvdXAua2V5LCBncm91cC5yb3dzLmxlbmd0aCwgZ3JvdXAucm93cywgZ3JvdXApO1xuXHRcdFx0Z3JvdXBIZWFkZXIucm93Q291bnQgPSBncm91cC5nZXRSb3dzKCkubGVuZ3RoO1xuXG5cdFx0XHRncm91cExpc3REYXRhLnB1c2goZ3JvdXBIZWFkZXIpO1xuXG5cdFx0XHRncm91cC5nZXRSb3dzKCkuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRcdGdyb3VwTGlzdERhdGEucHVzaChyb3cuZ2V0RGF0YShcImRhdGFcIikpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gZ3JvdXBMaXN0RGF0YTtcbn07XG5cbkdyb3VwUm93cy5wcm90b3R5cGUuZ2V0R3JvdXBlZERhdGEgPSBmdW5jdGlvbiAoKSB7XG5cblx0cmV0dXJuIHRoaXMucHVsbEdyb3VwTGlzdERhdGEodGhpcy5ncm91cExpc3QpO1xufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5nZXRSb3dHcm91cCA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIG1hdGNoID0gZmFsc2U7XG5cblx0dGhpcy5ncm91cExpc3QuZm9yRWFjaChmdW5jdGlvbiAoZ3JvdXApIHtcblx0XHR2YXIgcmVzdWx0ID0gZ3JvdXAuZ2V0Um93R3JvdXAocm93KTtcblxuXHRcdGlmIChyZXN1bHQpIHtcblx0XHRcdG1hdGNoID0gcmVzdWx0O1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIG1hdGNoO1xufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5jb3VudEdyb3VwcyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuZ3JvdXBMaXN0Lmxlbmd0aDtcbn07XG5cbkdyb3VwUm93cy5wcm90b3R5cGUuZ2VuZXJhdGVHcm91cHMgPSBmdW5jdGlvbiAocm93cykge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBvbGRHcm91cHMgPSBzZWxmLmdyb3VwcztcblxuXHRzZWxmLmdyb3VwcyA9IHt9O1xuXHRzZWxmLmdyb3VwTGlzdCA9IFtdO1xuXG5cdGlmICh0aGlzLmFsbG93ZWRWYWx1ZXMgJiYgdGhpcy5hbGxvd2VkVmFsdWVzWzBdKSB7XG5cdFx0dGhpcy5hbGxvd2VkVmFsdWVzWzBdLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRzZWxmLmNyZWF0ZUdyb3VwKHZhbHVlLCAwLCBvbGRHcm91cHMpO1xuXHRcdH0pO1xuXG5cdFx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdHNlbGYuYXNzaWduUm93VG9FeGlzdGluZ0dyb3VwKHJvdywgb2xkR3JvdXBzKTtcblx0XHR9KTtcblx0fSBlbHNlIHtcblx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0c2VsZi5hc3NpZ25Sb3dUb0dyb3VwKHJvdywgb2xkR3JvdXBzKTtcblx0XHR9KTtcblx0fVxufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5jcmVhdGVHcm91cCA9IGZ1bmN0aW9uIChncm91cElELCBsZXZlbCwgb2xkR3JvdXBzKSB7XG5cdHZhciBncm91cEtleSA9IGxldmVsICsgXCJfXCIgKyBncm91cElELFxuXHQgICAgZ3JvdXA7XG5cblx0b2xkR3JvdXBzID0gb2xkR3JvdXBzIHx8IFtdO1xuXG5cdGdyb3VwID0gbmV3IEdyb3VwKHRoaXMsIGZhbHNlLCBsZXZlbCwgZ3JvdXBJRCwgdGhpcy5ncm91cElETG9va3Vwc1swXS5maWVsZCwgdGhpcy5oZWFkZXJHZW5lcmF0b3JbMF0sIG9sZEdyb3Vwc1tncm91cEtleV0pO1xuXG5cdHRoaXMuZ3JvdXBzW2dyb3VwS2V5XSA9IGdyb3VwO1xuXHR0aGlzLmdyb3VwTGlzdC5wdXNoKGdyb3VwKTtcbn07XG5cbi8vIEdyb3VwUm93cy5wcm90b3R5cGUuYXNzaWduUm93VG9Hcm91cCA9IGZ1bmN0aW9uKHJvdywgb2xkR3JvdXBzKXtcbi8vIFx0dmFyIGdyb3VwSUQgPSB0aGlzLmdyb3VwSURMb29rdXBzWzBdLmZ1bmMocm93LmdldERhdGEoKSksXG4vLyBcdGdyb3VwS2V5ID0gXCIwX1wiICsgZ3JvdXBJRDtcblxuLy8gXHRpZighdGhpcy5ncm91cHNbZ3JvdXBLZXldKXtcbi8vIFx0XHR0aGlzLmNyZWF0ZUdyb3VwKGdyb3VwSUQsIDAsIG9sZEdyb3Vwcyk7XG4vLyBcdH1cblxuLy8gXHR0aGlzLmdyb3Vwc1tncm91cEtleV0uYWRkUm93KHJvdyk7XG4vLyB9O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLmFzc2lnblJvd1RvRXhpc3RpbmdHcm91cCA9IGZ1bmN0aW9uIChyb3csIG9sZEdyb3Vwcykge1xuXHR2YXIgZ3JvdXBJRCA9IHRoaXMuZ3JvdXBJRExvb2t1cHNbMF0uZnVuYyhyb3cuZ2V0RGF0YSgpKSxcblx0ICAgIGdyb3VwS2V5ID0gXCIwX1wiICsgZ3JvdXBJRDtcblxuXHRpZiAodGhpcy5ncm91cHNbZ3JvdXBLZXldKSB7XG5cdFx0dGhpcy5ncm91cHNbZ3JvdXBLZXldLmFkZFJvdyhyb3cpO1xuXHR9XG59O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLmFzc2lnblJvd1RvR3JvdXAgPSBmdW5jdGlvbiAocm93LCBvbGRHcm91cHMpIHtcblx0dmFyIGdyb3VwSUQgPSB0aGlzLmdyb3VwSURMb29rdXBzWzBdLmZ1bmMocm93LmdldERhdGEoKSksXG5cdCAgICBuZXdHcm91cE5lZWRlZCA9ICF0aGlzLmdyb3Vwc1tcIjBfXCIgKyBncm91cElEXTtcblxuXHRpZiAobmV3R3JvdXBOZWVkZWQpIHtcblx0XHR0aGlzLmNyZWF0ZUdyb3VwKGdyb3VwSUQsIDAsIG9sZEdyb3Vwcyk7XG5cdH1cblxuXHR0aGlzLmdyb3Vwc1tcIjBfXCIgKyBncm91cElEXS5hZGRSb3cocm93KTtcblxuXHRyZXR1cm4gIW5ld0dyb3VwTmVlZGVkO1xufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5yZWFzc2lnblJvd1RvR3JvdXAgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBvbGRSb3dHcm91cCA9IHJvdy5nZXRHcm91cCgpLFxuXHQgICAgb2xkR3JvdXBQYXRoID0gb2xkUm93R3JvdXAuZ2V0UGF0aCgpLFxuXHQgICAgbmV3R3JvdXBQYXRoID0gdGhpcy5nZXRFeHBlY3RlZFBhdGgocm93KSxcblx0ICAgIHNhbWVQYXRoID0gdHJ1ZTtcblx0Ly8gZmlndXJlIG91dCBpZiBuZXcgZ3JvdXAgcGF0aCBpcyB0aGUgc2FtZSBhcyBvbGQgZ3JvdXAgcGF0aFxuXHR2YXIgc2FtZVBhdGggPSBvbGRHcm91cFBhdGgubGVuZ3RoID09IG5ld0dyb3VwUGF0aC5sZW5ndGggJiYgb2xkR3JvdXBQYXRoLmV2ZXJ5KGZ1bmN0aW9uIChlbGVtZW50LCBpbmRleCkge1xuXHRcdHJldHVybiBlbGVtZW50ID09PSBuZXdHcm91cFBhdGhbaW5kZXhdO1xuXHR9KTtcblx0Ly8gcmVmcmVzaCBpZiB0aGV5IG5ldyBwYXRoIGFuZCBvbGQgcGF0aCBhcmVuJ3QgdGhlIHNhbWUgKGFrYSB0aGUgcm93J3MgZ3JvdXBpbmdzIGhhdmUgY2hhbmdlZClcblx0aWYgKCFzYW1lUGF0aCkge1xuXHRcdG9sZFJvd0dyb3VwLnJlbW92ZVJvdyhyb3cpO1xuXHRcdHRoaXMuYXNzaWduUm93VG9Hcm91cChyb3csIHNlbGYuZ3JvdXBzKTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVmcmVzaEFjdGl2ZURhdGEoXCJncm91cFwiLCBmYWxzZSwgdHJ1ZSk7XG5cdH1cbn07XG5cbkdyb3VwUm93cy5wcm90b3R5cGUuZ2V0RXhwZWN0ZWRQYXRoID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgZ3JvdXBQYXRoID0gW10sXG5cdCAgICByb3dEYXRhID0gcm93LmdldERhdGEoKTtcblx0dGhpcy5ncm91cElETG9va3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cElkKSB7XG5cdFx0Z3JvdXBQYXRoLnB1c2goZ3JvdXBJZC5mdW5jKHJvd0RhdGEpKTtcblx0fSk7XG5cdHJldHVybiBncm91cFBhdGg7XG59O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLnVwZGF0ZUdyb3VwUm93cyA9IGZ1bmN0aW9uIChmb3JjZSkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBvdXRwdXQgPSBbXSxcblx0ICAgIG9sZFJvd0NvdW50O1xuXG5cdHNlbGYuZ3JvdXBMaXN0LmZvckVhY2goZnVuY3Rpb24gKGdyb3VwKSB7XG5cdFx0b3V0cHV0ID0gb3V0cHV0LmNvbmNhdChncm91cC5nZXRIZWFkZXJzQW5kUm93cygpKTtcblx0fSk7XG5cblx0Ly9mb3JjZSB1cGRhdGUgb2YgdGFibGUgZGlzcGxheVxuXHRpZiAoZm9yY2UpIHtcblxuXHRcdHZhciBkaXNwbGF5SW5kZXggPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuc2V0RGlzcGxheVJvd3Mob3V0cHV0LCB0aGlzLmdldERpc3BsYXlJbmRleCgpKTtcblxuXHRcdGlmIChkaXNwbGF5SW5kZXggIT09IHRydWUpIHtcblx0XHRcdHRoaXMuc2V0RGlzcGxheUluZGV4KGRpc3BsYXlJbmRleCk7XG5cdFx0fVxuXG5cdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLnJlZnJlc2hBY3RpdmVEYXRhKFwiZ3JvdXBcIiwgdHJ1ZSwgdHJ1ZSk7XG5cdH1cblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuR3JvdXBSb3dzLnByb3RvdHlwZS5zY3JvbGxIZWFkZXJzID0gZnVuY3Rpb24gKGxlZnQpIHtcblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy52aXJ0dWFsRG9tSG96KSB7XG5cdFx0bGVmdCAtPSB0aGlzLnRhYmxlLnZkb21Ib3oudkRvbVBhZExlZnQ7XG5cdH1cblxuXHRsZWZ0ID0gbGVmdCArIFwicHhcIjtcblxuXHR0aGlzLmdyb3VwTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdGdyb3VwLnNjcm9sbEhlYWRlcihsZWZ0KTtcblx0fSk7XG59O1xuXG5Hcm91cFJvd3MucHJvdG90eXBlLnJlbW92ZUdyb3VwID0gZnVuY3Rpb24gKGdyb3VwKSB7XG5cdHZhciBncm91cEtleSA9IGdyb3VwLmxldmVsICsgXCJfXCIgKyBncm91cC5rZXksXG5cdCAgICBpbmRleDtcblxuXHRpZiAodGhpcy5ncm91cHNbZ3JvdXBLZXldKSB7XG5cdFx0ZGVsZXRlIHRoaXMuZ3JvdXBzW2dyb3VwS2V5XTtcblxuXHRcdGluZGV4ID0gdGhpcy5ncm91cExpc3QuaW5kZXhPZihncm91cCk7XG5cblx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0dGhpcy5ncm91cExpc3Quc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJncm91cFJvd3NcIiwgR3JvdXBSb3dzKTtcbnZhciBIaXN0b3J5ID0gZnVuY3Rpb24gSGlzdG9yeSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cblx0dGhpcy5oaXN0b3J5ID0gW107XG5cdHRoaXMuaW5kZXggPSAtMTtcbn07XG5cbkhpc3RvcnkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmhpc3RvcnkgPSBbXTtcblx0dGhpcy5pbmRleCA9IC0xO1xufTtcblxuSGlzdG9yeS5wcm90b3R5cGUuYWN0aW9uID0gZnVuY3Rpb24gKHR5cGUsIGNvbXBvbmVudCwgZGF0YSkge1xuXG5cdHRoaXMuaGlzdG9yeSA9IHRoaXMuaGlzdG9yeS5zbGljZSgwLCB0aGlzLmluZGV4ICsgMSk7XG5cblx0dGhpcy5oaXN0b3J5LnB1c2goe1xuXHRcdHR5cGU6IHR5cGUsXG5cdFx0Y29tcG9uZW50OiBjb21wb25lbnQsXG5cdFx0ZGF0YTogZGF0YVxuXHR9KTtcblxuXHR0aGlzLmluZGV4Kys7XG59O1xuXG5IaXN0b3J5LnByb3RvdHlwZS5nZXRIaXN0b3J5VW5kb1NpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLmluZGV4ICsgMTtcbn07XG5cbkhpc3RvcnkucHJvdG90eXBlLmdldEhpc3RvcnlSZWRvU2l6ZSA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuaGlzdG9yeS5sZW5ndGggLSAodGhpcy5pbmRleCArIDEpO1xufTtcblxuSGlzdG9yeS5wcm90b3R5cGUuY2xlYXJDb21wb25lbnRIaXN0b3J5ID0gZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuXHR2YXIgaW5kZXggPSB0aGlzLmhpc3RvcnkuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0cmV0dXJuIGl0ZW0uY29tcG9uZW50ID09PSBjb21wb25lbnQ7XG5cdH0pO1xuXG5cdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0dGhpcy5oaXN0b3J5LnNwbGljZShpbmRleCwgMSk7XG5cdFx0aWYgKGluZGV4IDw9IHRoaXMuaW5kZXgpIHtcblx0XHRcdHRoaXMuaW5kZXgtLTtcblx0XHR9XG5cblx0XHR0aGlzLmNsZWFyQ29tcG9uZW50SGlzdG9yeShjb21wb25lbnQpO1xuXHR9XG59O1xuXG5IaXN0b3J5LnByb3RvdHlwZS51bmRvID0gZnVuY3Rpb24gKCkge1xuXG5cdGlmICh0aGlzLmluZGV4ID4gLTEpIHtcblx0XHR2YXIgYWN0aW9uID0gdGhpcy5oaXN0b3J5W3RoaXMuaW5kZXhdO1xuXG5cdFx0dGhpcy51bmRvZXJzW2FjdGlvbi50eXBlXS5jYWxsKHRoaXMsIGFjdGlvbik7XG5cblx0XHR0aGlzLmluZGV4LS07XG5cblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuaGlzdG9yeVVuZG8uY2FsbCh0aGlzLnRhYmxlLCBhY3Rpb24udHlwZSwgYWN0aW9uLmNvbXBvbmVudC5nZXRDb21wb25lbnQoKSwgYWN0aW9uLmRhdGEpO1xuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiSGlzdG9yeSBVbmRvIEVycm9yIC0gTm8gbW9yZSBoaXN0b3J5IHRvIHVuZG9cIik7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5IaXN0b3J5LnByb3RvdHlwZS5yZWRvID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5oaXN0b3J5Lmxlbmd0aCAtIDEgPiB0aGlzLmluZGV4KSB7XG5cblx0XHR0aGlzLmluZGV4Kys7XG5cblx0XHR2YXIgYWN0aW9uID0gdGhpcy5oaXN0b3J5W3RoaXMuaW5kZXhdO1xuXG5cdFx0dGhpcy5yZWRvZXJzW2FjdGlvbi50eXBlXS5jYWxsKHRoaXMsIGFjdGlvbik7XG5cblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuaGlzdG9yeVJlZG8uY2FsbCh0aGlzLnRhYmxlLCBhY3Rpb24udHlwZSwgYWN0aW9uLmNvbXBvbmVudC5nZXRDb21wb25lbnQoKSwgYWN0aW9uLmRhdGEpO1xuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc29sZS53YXJuKFwiSGlzdG9yeSBSZWRvIEVycm9yIC0gTm8gbW9yZSBoaXN0b3J5IHRvIHJlZG9cIik7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5IaXN0b3J5LnByb3RvdHlwZS51bmRvZXJzID0ge1xuXHRjZWxsRWRpdDogZnVuY3Rpb24gY2VsbEVkaXQoYWN0aW9uKSB7XG5cdFx0YWN0aW9uLmNvbXBvbmVudC5zZXRWYWx1ZVByb2Nlc3NEYXRhKGFjdGlvbi5kYXRhLm9sZFZhbHVlKTtcblx0fSxcblxuXHRyb3dBZGQ6IGZ1bmN0aW9uIHJvd0FkZChhY3Rpb24pIHtcblx0XHRhY3Rpb24uY29tcG9uZW50LmRlbGV0ZUFjdHVhbCgpO1xuXHR9LFxuXG5cdHJvd0RlbGV0ZTogZnVuY3Rpb24gcm93RGVsZXRlKGFjdGlvbikge1xuXHRcdHZhciBuZXdSb3cgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93QWN0dWFsKGFjdGlvbi5kYXRhLmRhdGEsIGFjdGlvbi5kYXRhLnBvcywgYWN0aW9uLmRhdGEuaW5kZXgpO1xuXG5cdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5ICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZ3JvdXBSb3dzXCIpKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuZ3JvdXBSb3dzLnVwZGF0ZUdyb3VwUm93cyh0cnVlKTtcblx0XHR9XG5cblx0XHR0aGlzLl9yZWJpbmRSb3coYWN0aW9uLmNvbXBvbmVudCwgbmV3Um93KTtcblx0fSxcblxuXHRyb3dNb3ZlOiBmdW5jdGlvbiByb3dNb3ZlKGFjdGlvbikge1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5tb3ZlUm93QWN0dWFsKGFjdGlvbi5jb21wb25lbnQsIHRoaXMudGFibGUucm93TWFuYWdlci5yb3dzW2FjdGlvbi5kYXRhLnBvc0Zyb21dLCAhYWN0aW9uLmRhdGEuYWZ0ZXIpO1xuXHRcdHRoaXMudGFibGUucm93TWFuYWdlci5yZWRyYXcoKTtcblx0fVxufTtcblxuSGlzdG9yeS5wcm90b3R5cGUucmVkb2VycyA9IHtcblx0Y2VsbEVkaXQ6IGZ1bmN0aW9uIGNlbGxFZGl0KGFjdGlvbikge1xuXHRcdGFjdGlvbi5jb21wb25lbnQuc2V0VmFsdWVQcm9jZXNzRGF0YShhY3Rpb24uZGF0YS5uZXdWYWx1ZSk7XG5cdH0sXG5cblx0cm93QWRkOiBmdW5jdGlvbiByb3dBZGQoYWN0aW9uKSB7XG5cdFx0dmFyIG5ld1JvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwoYWN0aW9uLmRhdGEuZGF0YSwgYWN0aW9uLmRhdGEucG9zLCBhY3Rpb24uZGF0YS5pbmRleCk7XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJncm91cFJvd3NcIikpIHtcblx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5ncm91cFJvd3MudXBkYXRlR3JvdXBSb3dzKHRydWUpO1xuXHRcdH1cblxuXHRcdHRoaXMuX3JlYmluZFJvdyhhY3Rpb24uY29tcG9uZW50LCBuZXdSb3cpO1xuXHR9LFxuXG5cdHJvd0RlbGV0ZTogZnVuY3Rpb24gcm93RGVsZXRlKGFjdGlvbikge1xuXHRcdGFjdGlvbi5jb21wb25lbnQuZGVsZXRlQWN0dWFsKCk7XG5cdH0sXG5cblx0cm93TW92ZTogZnVuY3Rpb24gcm93TW92ZShhY3Rpb24pIHtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIubW92ZVJvd0FjdHVhbChhY3Rpb24uY29tcG9uZW50LCB0aGlzLnRhYmxlLnJvd01hbmFnZXIucm93c1thY3Rpb24uZGF0YS5wb3NUb10sIGFjdGlvbi5kYXRhLmFmdGVyKTtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucmVkcmF3KCk7XG5cdH1cbn07XG5cbi8vcmViaW5kIHJvd3MgdG8gbmV3IGVsZW1lbnQgYWZ0ZXIgZGVsZXRpb25cbkhpc3RvcnkucHJvdG90eXBlLl9yZWJpbmRSb3cgPSBmdW5jdGlvbiAob2xkUm93LCBuZXdSb3cpIHtcblx0dGhpcy5oaXN0b3J5LmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbikge1xuXHRcdGlmIChhY3Rpb24uY29tcG9uZW50IGluc3RhbmNlb2YgUm93KSB7XG5cdFx0XHRpZiAoYWN0aW9uLmNvbXBvbmVudCA9PT0gb2xkUm93KSB7XG5cdFx0XHRcdGFjdGlvbi5jb21wb25lbnQgPSBuZXdSb3c7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChhY3Rpb24uY29tcG9uZW50IGluc3RhbmNlb2YgQ2VsbCkge1xuXHRcdFx0aWYgKGFjdGlvbi5jb21wb25lbnQucm93ID09PSBvbGRSb3cpIHtcblx0XHRcdFx0dmFyIGZpZWxkID0gYWN0aW9uLmNvbXBvbmVudC5jb2x1bW4uZ2V0RmllbGQoKTtcblxuXHRcdFx0XHRpZiAoZmllbGQpIHtcblx0XHRcdFx0XHRhY3Rpb24uY29tcG9uZW50ID0gbmV3Um93LmdldENlbGwoZmllbGQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJoaXN0b3J5XCIsIEhpc3RvcnkpO1xudmFyIEh0bWxUYWJsZUltcG9ydCA9IGZ1bmN0aW9uIEh0bWxUYWJsZUltcG9ydCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuZmllbGRJbmRleCA9IFtdO1xuXHR0aGlzLmhhc0luZGV4ID0gZmFsc2U7XG59O1xuXG5IdG1sVGFibGVJbXBvcnQucHJvdG90eXBlLnBhcnNlVGFibGUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGVsZW1lbnQgPSBzZWxmLnRhYmxlLmVsZW1lbnQsXG5cdCAgICBvcHRpb25zID0gc2VsZi50YWJsZS5vcHRpb25zLFxuXHQgICAgY29sdW1ucyA9IG9wdGlvbnMuY29sdW1ucyxcblx0ICAgIGhlYWRlcnMgPSBlbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGhcIiksXG5cdCAgICByb3dzID0gZWxlbWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRib2R5XCIpWzBdLFxuXHQgICAgZGF0YSA9IFtdLFxuXHQgICAgbmV3VGFibGU7XG5cblx0c2VsZi5oYXNJbmRleCA9IGZhbHNlO1xuXG5cdHNlbGYudGFibGUub3B0aW9ucy5odG1sSW1wb3J0aW5nLmNhbGwodGhpcy50YWJsZSk7XG5cblx0cm93cyA9IHJvd3MgPyByb3dzLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidHJcIikgOiBbXTtcblxuXHQvL2NoZWNrIGZvciB0YWJsYXRvciBpbmxpbmUgb3B0aW9uc1xuXHRzZWxmLl9leHRyYWN0T3B0aW9ucyhlbGVtZW50LCBvcHRpb25zKTtcblxuXHRpZiAoaGVhZGVycy5sZW5ndGgpIHtcblx0XHRzZWxmLl9leHRyYWN0SGVhZGVycyhoZWFkZXJzLCByb3dzKTtcblx0fSBlbHNlIHtcblx0XHRzZWxmLl9nZW5lcmF0ZUJsYW5rSGVhZGVycyhoZWFkZXJzLCByb3dzKTtcblx0fVxuXG5cdC8vaXRlcmF0ZSB0aHJvdWdoIHRhYmxlIHJvd3MgYW5kIGJ1aWxkIGRhdGEgc2V0XG5cdGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCByb3dzLmxlbmd0aDsgaW5kZXgrKykge1xuXHRcdHZhciByb3cgPSByb3dzW2luZGV4XSxcblx0XHQgICAgY2VsbHMgPSByb3cuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0ZFwiKSxcblx0XHQgICAgaXRlbSA9IHt9O1xuXG5cdFx0Ly9jcmVhdGUgaW5kZXggaWYgdGhlIGRvbnQgZXhpc3QgaW4gdGFibGVcblx0XHRpZiAoIXNlbGYuaGFzSW5kZXgpIHtcblx0XHRcdGl0ZW1bb3B0aW9ucy5pbmRleF0gPSBpbmRleDtcblx0XHR9XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgY2VsbCA9IGNlbGxzW2ldO1xuXHRcdFx0aWYgKHR5cGVvZiB0aGlzLmZpZWxkSW5kZXhbaV0gIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0aXRlbVt0aGlzLmZpZWxkSW5kZXhbaV1dID0gY2VsbC5pbm5lckhUTUw7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9hZGQgcm93IGRhdGEgdG8gaXRlbVxuXHRcdGRhdGEucHVzaChpdGVtKTtcblx0fVxuXG5cdC8vY3JlYXRlIG5ldyBlbGVtZW50XG5cdHZhciBuZXdFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHQvL3RyYW5zZmVyIGF0dHJpYnV0ZXMgdG8gbmV3IGVsZW1lbnRcblx0dmFyIGF0dHJpYnV0ZXMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7XG5cblx0Ly8gbG9vcCB0aHJvdWdoIGF0dHJpYnV0ZXMgYW5kIGFwcGx5IHRoZW0gb24gZGl2XG5cblx0Zm9yICh2YXIgaSBpbiBhdHRyaWJ1dGVzKSB7XG5cdFx0aWYgKF90eXBlb2YoYXR0cmlidXRlc1tpXSkgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0bmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0cmlidXRlc1tpXS5uYW1lLCBhdHRyaWJ1dGVzW2ldLnZhbHVlKTtcblx0XHR9XG5cdH1cblxuXHQvLyByZXBsYWNlIHRhYmxlIHdpdGggZGl2IGVsZW1lbnRcblx0ZWxlbWVudC5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChuZXdFbGVtZW50LCBlbGVtZW50KTtcblxuXHRvcHRpb25zLmRhdGEgPSBkYXRhO1xuXG5cdHNlbGYudGFibGUub3B0aW9ucy5odG1sSW1wb3J0ZWQuY2FsbCh0aGlzLnRhYmxlKTtcblxuXHQvLyAvLyBuZXdFbGVtZW50LnRhYnVsYXRvcihvcHRpb25zKTtcblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQgPSBuZXdFbGVtZW50O1xufTtcblxuLy9leHRyYWN0IHRhYnVsYXRvciBhdHRyaWJ1dGUgb3B0aW9uc1xuSHRtbFRhYmxlSW1wb3J0LnByb3RvdHlwZS5fZXh0cmFjdE9wdGlvbnMgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucywgZGVmYXVsdE9wdGlvbnMpIHtcblx0dmFyIGF0dHJpYnV0ZXMgPSBlbGVtZW50LmF0dHJpYnV0ZXM7XG5cdHZhciBvcHRpb25zQXJyID0gZGVmYXVsdE9wdGlvbnMgPyBPYmplY3QuYXNzaWduKFtdLCBkZWZhdWx0T3B0aW9ucykgOiBPYmplY3Qua2V5cyhvcHRpb25zKTtcblx0dmFyIG9wdGlvbnNMaXN0ID0ge307XG5cblx0b3B0aW9uc0Fyci5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0b3B0aW9uc0xpc3RbaXRlbS50b0xvd2VyQ2FzZSgpXSA9IGl0ZW07XG5cdH0pO1xuXG5cdGZvciAodmFyIGluZGV4IGluIGF0dHJpYnV0ZXMpIHtcblx0XHR2YXIgYXR0cmliID0gYXR0cmlidXRlc1tpbmRleF07XG5cdFx0dmFyIG5hbWU7XG5cblx0XHRpZiAoYXR0cmliICYmICh0eXBlb2YgYXR0cmliID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihhdHRyaWIpKSA9PSBcIm9iamVjdFwiICYmIGF0dHJpYi5uYW1lICYmIGF0dHJpYi5uYW1lLmluZGV4T2YoXCJ0YWJ1bGF0b3ItXCIpID09PSAwKSB7XG5cdFx0XHRuYW1lID0gYXR0cmliLm5hbWUucmVwbGFjZShcInRhYnVsYXRvci1cIiwgXCJcIik7XG5cblx0XHRcdGlmICh0eXBlb2Ygb3B0aW9uc0xpc3RbbmFtZV0gIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0b3B0aW9uc1tvcHRpb25zTGlzdFtuYW1lXV0gPSB0aGlzLl9hdHRyaWJWYWx1ZShhdHRyaWIudmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuLy9nZXQgdmFsdWUgb2YgYXR0cmlidXRlXG5IdG1sVGFibGVJbXBvcnQucHJvdG90eXBlLl9hdHRyaWJWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRpZiAodmFsdWUgPT09IFwidHJ1ZVwiKSB7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRpZiAodmFsdWUgPT09IFwiZmFsc2VcIikge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHJldHVybiB2YWx1ZTtcbn07XG5cbi8vZmluZCBjb2x1bW4gaWYgaXQgaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkXG5IdG1sVGFibGVJbXBvcnQucHJvdG90eXBlLl9maW5kQ29sID0gZnVuY3Rpb24gKHRpdGxlKSB7XG5cdHZhciBtYXRjaCA9IHRoaXMudGFibGUub3B0aW9ucy5jb2x1bW5zLmZpbmQoZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdHJldHVybiBjb2x1bW4udGl0bGUgPT09IHRpdGxlO1xuXHR9KTtcblxuXHRyZXR1cm4gbWF0Y2ggfHwgZmFsc2U7XG59O1xuXG4vL2V4dHJhY3QgY29sdW1uIGZyb20gaGVhZGVyc1xuSHRtbFRhYmxlSW1wb3J0LnByb3RvdHlwZS5fZXh0cmFjdEhlYWRlcnMgPSBmdW5jdGlvbiAoaGVhZGVycywgcm93cykge1xuXHRmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgaGVhZGVycy5sZW5ndGg7IGluZGV4KyspIHtcblx0XHR2YXIgaGVhZGVyID0gaGVhZGVyc1tpbmRleF0sXG5cdFx0ICAgIGV4aXN0cyA9IGZhbHNlLFxuXHRcdCAgICBjb2wgPSB0aGlzLl9maW5kQ29sKGhlYWRlci50ZXh0Q29udGVudCksXG5cdFx0ICAgIHdpZHRoLFxuXHRcdCAgICBhdHRyaWJ1dGVzO1xuXG5cdFx0aWYgKGNvbCkge1xuXHRcdFx0ZXhpc3RzID0gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29sID0geyB0aXRsZTogaGVhZGVyLnRleHRDb250ZW50LnRyaW0oKSB9O1xuXHRcdH1cblxuXHRcdGlmICghY29sLmZpZWxkKSB7XG5cdFx0XHRjb2wuZmllbGQgPSBoZWFkZXIudGV4dENvbnRlbnQudHJpbSgpLnRvTG93ZXJDYXNlKCkucmVwbGFjZShcIiBcIiwgXCJfXCIpO1xuXHRcdH1cblxuXHRcdHdpZHRoID0gaGVhZGVyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpO1xuXG5cdFx0aWYgKHdpZHRoICYmICFjb2wud2lkdGgpIHtcblx0XHRcdGNvbC53aWR0aCA9IHdpZHRoO1xuXHRcdH1cblxuXHRcdC8vY2hlY2sgZm9yIHRhYmxhdG9yIGlubGluZSBvcHRpb25zXG5cdFx0YXR0cmlidXRlcyA9IGhlYWRlci5hdHRyaWJ1dGVzO1xuXG5cdFx0Ly8gLy9jaGVjayBmb3IgdGFibGF0b3IgaW5saW5lIG9wdGlvbnNcblx0XHR0aGlzLl9leHRyYWN0T3B0aW9ucyhoZWFkZXIsIGNvbCwgQ29sdW1uLnByb3RvdHlwZS5kZWZhdWx0T3B0aW9uTGlzdCk7XG5cblx0XHR0aGlzLmZpZWxkSW5kZXhbaW5kZXhdID0gY29sLmZpZWxkO1xuXG5cdFx0aWYgKGNvbC5maWVsZCA9PSB0aGlzLnRhYmxlLm9wdGlvbnMuaW5kZXgpIHtcblx0XHRcdHRoaXMuaGFzSW5kZXggPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICghZXhpc3RzKSB7XG5cdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucy5wdXNoKGNvbCk7XG5cdFx0fVxuXHR9XG59O1xuXG4vL2dlbmVyYXRlIGJsYW5rIGhlYWRlcnNcbkh0bWxUYWJsZUltcG9ydC5wcm90b3R5cGUuX2dlbmVyYXRlQmxhbmtIZWFkZXJzID0gZnVuY3Rpb24gKGhlYWRlcnMsIHJvd3MpIHtcblx0Zm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGhlYWRlcnMubGVuZ3RoOyBpbmRleCsrKSB7XG5cdFx0dmFyIGhlYWRlciA9IGhlYWRlcnNbaW5kZXhdLFxuXHRcdCAgICBjb2wgPSB7IHRpdGxlOiBcIlwiLCBmaWVsZDogXCJjb2xcIiArIGluZGV4IH07XG5cblx0XHR0aGlzLmZpZWxkSW5kZXhbaW5kZXhdID0gY29sLmZpZWxkO1xuXG5cdFx0dmFyIHdpZHRoID0gaGVhZGVyLmdldEF0dHJpYnV0ZShcIndpZHRoXCIpO1xuXG5cdFx0aWYgKHdpZHRoKSB7XG5cdFx0XHRjb2wud2lkdGggPSB3aWR0aDtcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucy5wdXNoKGNvbCk7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJodG1sVGFibGVJbXBvcnRcIiwgSHRtbFRhYmxlSW1wb3J0KTtcbnZhciBLZXliaW5kaW5ncyA9IGZ1bmN0aW9uIEtleWJpbmRpbmdzKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcblx0dGhpcy53YXRjaEtleXMgPSBudWxsO1xuXHR0aGlzLnByZXNzZWRLZXlzID0gbnVsbDtcblx0dGhpcy5rZXl1cEJpbmRpbmcgPSBmYWxzZTtcblx0dGhpcy5rZXlkb3duQmluZGluZyA9IGZhbHNlO1xufTtcblxuS2V5YmluZGluZ3MucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBiaW5kaW5ncyA9IHRoaXMudGFibGUub3B0aW9ucy5rZXliaW5kaW5ncyxcblx0ICAgIG1lcmdlZEJpbmRpbmdzID0ge307XG5cblx0dGhpcy53YXRjaEtleXMgPSB7fTtcblx0dGhpcy5wcmVzc2VkS2V5cyA9IFtdO1xuXG5cdGlmIChiaW5kaW5ncyAhPT0gZmFsc2UpIHtcblxuXHRcdGZvciAodmFyIGtleSBpbiB0aGlzLmJpbmRpbmdzKSB7XG5cdFx0XHRtZXJnZWRCaW5kaW5nc1trZXldID0gdGhpcy5iaW5kaW5nc1trZXldO1xuXHRcdH1cblxuXHRcdGlmIChPYmplY3Qua2V5cyhiaW5kaW5ncykubGVuZ3RoKSB7XG5cblx0XHRcdGZvciAodmFyIF9rZXkgaW4gYmluZGluZ3MpIHtcblx0XHRcdFx0bWVyZ2VkQmluZGluZ3NbX2tleV0gPSBiaW5kaW5nc1tfa2V5XTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLm1hcEJpbmRpbmdzKG1lcmdlZEJpbmRpbmdzKTtcblx0XHR0aGlzLmJpbmRFdmVudHMoKTtcblx0fVxufTtcblxuS2V5YmluZGluZ3MucHJvdG90eXBlLm1hcEJpbmRpbmdzID0gZnVuY3Rpb24gKGJpbmRpbmdzKSB7XG5cdHZhciBfdGhpczcwID0gdGhpcztcblxuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0dmFyIF9sb29wMiA9IGZ1bmN0aW9uIF9sb29wMihrZXkpIHtcblxuXHRcdGlmIChfdGhpczcwLmFjdGlvbnNba2V5XSkge1xuXG5cdFx0XHRpZiAoYmluZGluZ3Nba2V5XSkge1xuXG5cdFx0XHRcdGlmIChfdHlwZW9mKGJpbmRpbmdzW2tleV0pICE9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRcdFx0YmluZGluZ3Nba2V5XSA9IFtiaW5kaW5nc1trZXldXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGJpbmRpbmdzW2tleV0uZm9yRWFjaChmdW5jdGlvbiAoYmluZGluZykge1xuXHRcdFx0XHRcdHNlbGYubWFwQmluZGluZyhrZXksIGJpbmRpbmcpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiS2V5IEJpbmRpbmcgRXJyb3IgLSBubyBzdWNoIGFjdGlvbjpcIiwga2V5KTtcblx0XHR9XG5cdH07XG5cblx0Zm9yICh2YXIga2V5IGluIGJpbmRpbmdzKSB7XG5cdFx0X2xvb3AyKGtleSk7XG5cdH1cbn07XG5cbktleWJpbmRpbmdzLnByb3RvdHlwZS5tYXBCaW5kaW5nID0gZnVuY3Rpb24gKGFjdGlvbiwgc3ltYm9sc0xpc3QpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHZhciBiaW5kaW5nID0ge1xuXHRcdGFjdGlvbjogdGhpcy5hY3Rpb25zW2FjdGlvbl0sXG5cdFx0a2V5czogW10sXG5cdFx0Y3RybDogZmFsc2UsXG5cdFx0c2hpZnQ6IGZhbHNlLFxuXHRcdG1ldGE6IGZhbHNlXG5cdH07XG5cblx0dmFyIHN5bWJvbHMgPSBzeW1ib2xzTGlzdC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkuc3BsaXQoXCIgXCIpLmpvaW4oXCJcIikuc3BsaXQoXCIrXCIpO1xuXG5cdHN5bWJvbHMuZm9yRWFjaChmdW5jdGlvbiAoc3ltYm9sKSB7XG5cdFx0c3dpdGNoIChzeW1ib2wpIHtcblx0XHRcdGNhc2UgXCJjdHJsXCI6XG5cdFx0XHRcdGJpbmRpbmcuY3RybCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwic2hpZnRcIjpcblx0XHRcdFx0YmluZGluZy5zaGlmdCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwibWV0YVwiOlxuXHRcdFx0XHRiaW5kaW5nLm1ldGEgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0c3ltYm9sID0gcGFyc2VJbnQoc3ltYm9sKTtcblx0XHRcdFx0YmluZGluZy5rZXlzLnB1c2goc3ltYm9sKTtcblxuXHRcdFx0XHRpZiAoIXNlbGYud2F0Y2hLZXlzW3N5bWJvbF0pIHtcblx0XHRcdFx0XHRzZWxmLndhdGNoS2V5c1tzeW1ib2xdID0gW107XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZWxmLndhdGNoS2V5c1tzeW1ib2xdLnB1c2goYmluZGluZyk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbktleWJpbmRpbmdzLnByb3RvdHlwZS5iaW5kRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0dGhpcy5rZXl1cEJpbmRpbmcgPSBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBjb2RlID0gZS5rZXlDb2RlO1xuXHRcdHZhciBiaW5kaW5ncyA9IHNlbGYud2F0Y2hLZXlzW2NvZGVdO1xuXG5cdFx0aWYgKGJpbmRpbmdzKSB7XG5cblx0XHRcdHNlbGYucHJlc3NlZEtleXMucHVzaChjb2RlKTtcblxuXHRcdFx0YmluZGluZ3MuZm9yRWFjaChmdW5jdGlvbiAoYmluZGluZykge1xuXHRcdFx0XHRzZWxmLmNoZWNrQmluZGluZyhlLCBiaW5kaW5nKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcblxuXHR0aGlzLmtleWRvd25CaW5kaW5nID0gZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgY29kZSA9IGUua2V5Q29kZTtcblx0XHR2YXIgYmluZGluZ3MgPSBzZWxmLndhdGNoS2V5c1tjb2RlXTtcblxuXHRcdGlmIChiaW5kaW5ncykge1xuXG5cdFx0XHR2YXIgaW5kZXggPSBzZWxmLnByZXNzZWRLZXlzLmluZGV4T2YoY29kZSk7XG5cblx0XHRcdGlmIChpbmRleCA+IC0xKSB7XG5cdFx0XHRcdHNlbGYucHJlc3NlZEtleXMuc3BsaWNlKGluZGV4LCAxKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0dGhpcy50YWJsZS5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMua2V5dXBCaW5kaW5nKTtcblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMua2V5ZG93bkJpbmRpbmcpO1xufTtcblxuS2V5YmluZGluZ3MucHJvdG90eXBlLmNsZWFyQmluZGluZ3MgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICh0aGlzLmtleXVwQmluZGluZykge1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLmtleXVwQmluZGluZyk7XG5cdH1cblxuXHRpZiAodGhpcy5rZXlkb3duQmluZGluZykge1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5rZXlkb3duQmluZGluZyk7XG5cdH1cbn07XG5cbktleWJpbmRpbmdzLnByb3RvdHlwZS5jaGVja0JpbmRpbmcgPSBmdW5jdGlvbiAoZSwgYmluZGluZykge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBtYXRjaCA9IHRydWU7XG5cblx0aWYgKGUuY3RybEtleSA9PSBiaW5kaW5nLmN0cmwgJiYgZS5zaGlmdEtleSA9PSBiaW5kaW5nLnNoaWZ0ICYmIGUubWV0YUtleSA9PSBiaW5kaW5nLm1ldGEpIHtcblx0XHRiaW5kaW5nLmtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHR2YXIgaW5kZXggPSBzZWxmLnByZXNzZWRLZXlzLmluZGV4T2Yoa2V5KTtcblxuXHRcdFx0aWYgKGluZGV4ID09IC0xKSB7XG5cdFx0XHRcdG1hdGNoID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdGJpbmRpbmcuYWN0aW9uLmNhbGwoc2VsZiwgZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG4vL2RlZmF1bHQgYmluZGluZ3NcbktleWJpbmRpbmdzLnByb3RvdHlwZS5iaW5kaW5ncyA9IHtcblx0bmF2UHJldjogXCJzaGlmdCArIDlcIixcblx0bmF2TmV4dDogOSxcblx0bmF2VXA6IDM4LFxuXHRuYXZEb3duOiA0MCxcblx0c2Nyb2xsUGFnZVVwOiAzMyxcblx0c2Nyb2xsUGFnZURvd246IDM0LFxuXHRzY3JvbGxUb1N0YXJ0OiAzNixcblx0c2Nyb2xsVG9FbmQ6IDM1LFxuXHR1bmRvOiBcImN0cmwgKyA5MFwiLFxuXHRyZWRvOiBcImN0cmwgKyA4OVwiLFxuXHRjb3B5VG9DbGlwYm9hcmQ6IFwiY3RybCArIDY3XCJcbn07XG5cbi8vZGVmYXVsdCBhY3Rpb25zXG5LZXliaW5kaW5ncy5wcm90b3R5cGUuYWN0aW9ucyA9IHtcblx0a2V5QmxvY2s6IGZ1bmN0aW9uIGtleUJsb2NrKGUpIHtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0fSxcblx0c2Nyb2xsUGFnZVVwOiBmdW5jdGlvbiBzY3JvbGxQYWdlVXAoZSkge1xuXHRcdHZhciByb3dNYW5hZ2VyID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLFxuXHRcdCAgICBuZXdQb3MgPSByb3dNYW5hZ2VyLnNjcm9sbFRvcCAtIHJvd01hbmFnZXIuaGVpZ2h0LFxuXHRcdCAgICBzY3JvbGxNYXggPSByb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0aWYgKHJvd01hbmFnZXIuZGlzcGxheVJvd3NDb3VudCkge1xuXHRcdFx0aWYgKG5ld1BvcyA+PSAwKSB7XG5cdFx0XHRcdHJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3AgPSBuZXdQb3M7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyb3dNYW5hZ2VyLnNjcm9sbFRvUm93KHJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKVswXSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LmZvY3VzKCk7XG5cdH0sXG5cdHNjcm9sbFBhZ2VEb3duOiBmdW5jdGlvbiBzY3JvbGxQYWdlRG93bihlKSB7XG5cdFx0dmFyIHJvd01hbmFnZXIgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIsXG5cdFx0ICAgIG5ld1BvcyA9IHJvd01hbmFnZXIuc2Nyb2xsVG9wICsgcm93TWFuYWdlci5oZWlnaHQsXG5cdFx0ICAgIHNjcm9sbE1heCA9IHJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxIZWlnaHQ7XG5cblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRpZiAocm93TWFuYWdlci5kaXNwbGF5Um93c0NvdW50KSB7XG5cdFx0XHRpZiAobmV3UG9zIDw9IHNjcm9sbE1heCkge1xuXHRcdFx0XHRyb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wID0gbmV3UG9zO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cm93TWFuYWdlci5zY3JvbGxUb1Jvdyhyb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKClbcm93TWFuYWdlci5kaXNwbGF5Um93c0NvdW50IC0gMV0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5mb2N1cygpO1xuXHR9LFxuXHRzY3JvbGxUb1N0YXJ0OiBmdW5jdGlvbiBzY3JvbGxUb1N0YXJ0KGUpIHtcblx0XHR2YXIgcm93TWFuYWdlciA9IHRoaXMudGFibGUucm93TWFuYWdlcjtcblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGlmIChyb3dNYW5hZ2VyLmRpc3BsYXlSb3dzQ291bnQpIHtcblx0XHRcdHJvd01hbmFnZXIuc2Nyb2xsVG9Sb3cocm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpWzBdKTtcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuZm9jdXMoKTtcblx0fSxcblx0c2Nyb2xsVG9FbmQ6IGZ1bmN0aW9uIHNjcm9sbFRvRW5kKGUpIHtcblx0XHR2YXIgcm93TWFuYWdlciA9IHRoaXMudGFibGUucm93TWFuYWdlcjtcblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdGlmIChyb3dNYW5hZ2VyLmRpc3BsYXlSb3dzQ291bnQpIHtcblx0XHRcdHJvd01hbmFnZXIuc2Nyb2xsVG9Sb3cocm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpW3Jvd01hbmFnZXIuZGlzcGxheVJvd3NDb3VudCAtIDFdKTtcblx0XHR9XG5cblx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuZm9jdXMoKTtcblx0fSxcblx0bmF2UHJldjogZnVuY3Rpb24gbmF2UHJldihlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikpIHtcblx0XHRcdGNlbGwgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcblxuXHRcdFx0aWYgKGNlbGwpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRjZWxsLm5hdigpLnByZXYoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0bmF2TmV4dDogZnVuY3Rpb24gbmF2TmV4dChlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblx0XHR2YXIgbmV3Um93ID0gdGhpcy50YWJsZS5vcHRpb25zLnRhYkVuZE5ld1Jvdztcblx0XHR2YXIgbmF2O1xuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdFx0Y2VsbCA9IHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0XHRpZiAoY2VsbCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0bmF2ID0gY2VsbC5uYXYoKTtcblxuXHRcdFx0XHRpZiAoIW5hdi5uZXh0KCkpIHtcblx0XHRcdFx0XHRpZiAobmV3Um93KSB7XG5cblx0XHRcdFx0XHRcdGNlbGwuZ2V0RWxlbWVudCgpLmZpcnN0Q2hpbGQuYmx1cigpO1xuXG5cdFx0XHRcdFx0XHRpZiAobmV3Um93ID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdG5ld1JvdyA9IHRoaXMudGFibGUuYWRkUm93KHt9KTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgbmV3Um93ID09IFwiZnVuY3Rpb25cIikge1xuXHRcdFx0XHRcdFx0XHRcdG5ld1JvdyA9IHRoaXMudGFibGUuYWRkUm93KG5ld1JvdyhjZWxsLnJvdy5nZXRDb21wb25lbnQoKSkpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdG5ld1JvdyA9IHRoaXMudGFibGUuYWRkUm93KE9iamVjdC5hc3NpZ24oe30sIG5ld1JvdykpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdG5ld1Jvdy50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdFx0bmF2Lm5leHQoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0bmF2TGVmdDogZnVuY3Rpb24gbmF2TGVmdChlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikpIHtcblx0XHRcdGNlbGwgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcblxuXHRcdFx0aWYgKGNlbGwpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRjZWxsLm5hdigpLmxlZnQoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0bmF2UmlnaHQ6IGZ1bmN0aW9uIG5hdlJpZ2h0KGUpIHtcblx0XHR2YXIgY2VsbCA9IGZhbHNlO1xuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdFx0Y2VsbCA9IHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0XHRpZiAoY2VsbCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNlbGwubmF2KCkucmlnaHQoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0bmF2VXA6IGZ1bmN0aW9uIG5hdlVwKGUpIHtcblx0XHR2YXIgY2VsbCA9IGZhbHNlO1xuXG5cdFx0aWYgKHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXHRcdFx0Y2VsbCA9IHRoaXMudGFibGUubW9kdWxlcy5lZGl0LmN1cnJlbnRDZWxsO1xuXG5cdFx0XHRpZiAoY2VsbCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNlbGwubmF2KCkudXAoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0bmF2RG93bjogZnVuY3Rpb24gbmF2RG93bihlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImVkaXRcIikpIHtcblx0XHRcdGNlbGwgPSB0aGlzLnRhYmxlLm1vZHVsZXMuZWRpdC5jdXJyZW50Q2VsbDtcblxuXHRcdFx0aWYgKGNlbGwpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRjZWxsLm5hdigpLmRvd24oKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0dW5kbzogZnVuY3Rpb24gdW5kbyhlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmhpc3RvcnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJoaXN0b3J5XCIpICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXG5cdFx0XHRjZWxsID0gdGhpcy50YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGw7XG5cblx0XHRcdGlmICghY2VsbCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5oaXN0b3J5LnVuZG8oKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0cmVkbzogZnVuY3Rpb24gcmVkbyhlKSB7XG5cdFx0dmFyIGNlbGwgPSBmYWxzZTtcblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmhpc3RvcnkgJiYgdGhpcy50YWJsZS5tb2RFeGlzdHMoXCJoaXN0b3J5XCIpICYmIHRoaXMudGFibGUubW9kRXhpc3RzKFwiZWRpdFwiKSkge1xuXG5cdFx0XHRjZWxsID0gdGhpcy50YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGw7XG5cblx0XHRcdGlmICghY2VsbCkge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdHRoaXMudGFibGUubW9kdWxlcy5oaXN0b3J5LnJlZG8oKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Y29weVRvQ2xpcGJvYXJkOiBmdW5jdGlvbiBjb3B5VG9DbGlwYm9hcmQoZSkge1xuXHRcdGlmICghdGhpcy50YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpIHtcblx0XHRcdGlmICh0aGlzLnRhYmxlLm1vZEV4aXN0cyhcImNsaXBib2FyZFwiLCB0cnVlKSkge1xuXHRcdFx0XHR0aGlzLnRhYmxlLm1vZHVsZXMuY2xpcGJvYXJkLmNvcHkoZmFsc2UsIHRydWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcImtleWJpbmRpbmdzXCIsIEtleWJpbmRpbmdzKTtcbnZhciBNZW51ID0gZnVuY3Rpb24gTWVudSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMubWVudUVsZW1lbnRzID0gW107XG5cdHRoaXMuYmx1ckV2ZW50ID0gdGhpcy5oaWRlTWVudS5iaW5kKHRoaXMpO1xuXHR0aGlzLmVzY0V2ZW50ID0gdGhpcy5lc2NNZW51LmJpbmQodGhpcyk7XG5cdHRoaXMubmVzdGVkTWVudUJsb2NrID0gZmFsc2U7XG5cdHRoaXMucG9zaXRpb25SZXZlcnNlZFggPSBmYWxzZTtcbn07XG5cbk1lbnUucHJvdG90eXBlLmluaXRpYWxpemVDb2x1bW5IZWFkZXIgPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHZhciBfdGhpczcxID0gdGhpcztcblxuXHR2YXIgaGVhZGVyTWVudUVsO1xuXG5cdGlmIChjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJDb250ZXh0TWVudSkge1xuXHRcdGNvbHVtbi5nZXRFbGVtZW50KCkuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuTG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIGNvbHVtbiwgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyQ29udGV4dE1lbnUpKTtcblx0XHR0aGlzLnRhcEhvbGQoY29sdW1uLCBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJDb250ZXh0TWVudSk7XG5cdH1cblxuXHQvLyBpZihjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJDbGlja01lbnUpe1xuXHQvLyBcdGNvbHVtbi5nZXRFbGVtZW50KCkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuTG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIGNvbHVtbiwgY29sdW1uLmRlZmluaXRpb24uaGVhZGVyQ2xpY2tNZW51KSk7XG5cdC8vIH1cblxuXHRpZiAoY29sdW1uLmRlZmluaXRpb24uaGVhZGVyTWVudSkge1xuXG5cdFx0aGVhZGVyTWVudUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0aGVhZGVyTWVudUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItaGVhZGVyLW1lbnUtYnV0dG9uXCIpO1xuXHRcdGhlYWRlck1lbnVFbC5pbm5lckhUTUwgPSBcIiZ2ZWxsaXA7XCI7XG5cblx0XHRoZWFkZXJNZW51RWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0XHRfdGhpczcxLkxvYWRNZW51RXZlbnQoY29sdW1uLCBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJNZW51LCBlKTtcblx0XHR9KTtcblxuXHRcdGNvbHVtbi50aXRsZUVsZW1lbnQuaW5zZXJ0QmVmb3JlKGhlYWRlck1lbnVFbCwgY29sdW1uLnRpdGxlRWxlbWVudC5maXJzdENoaWxkKTtcblx0fVxufTtcblxuTWVudS5wcm90b3R5cGUuTG9hZE1lbnVFdmVudCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG1lbnUsIGUpIHtcblx0bWVudSA9IHR5cGVvZiBtZW51ID09IFwiZnVuY3Rpb25cIiA/IG1lbnUuY2FsbCh0aGlzLnRhYmxlLCBjb21wb25lbnQuZ2V0Q29tcG9uZW50KCksIGUpIDogbWVudTtcblxuXHQvLyBpZihjb21wb25lbnQgaW5zdGFuY2VvZiBDZWxsKXtcblx0Ly8gXHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXHQvLyB9XG5cblx0dGhpcy5sb2FkTWVudShlLCBjb21wb25lbnQsIG1lbnUpO1xufTtcblxuTWVudS5wcm90b3R5cGUudGFwSG9sZCA9IGZ1bmN0aW9uIChjb21wb25lbnQsIG1lbnUpIHtcblx0dmFyIF90aGlzNzIgPSB0aGlzO1xuXG5cdHZhciBlbGVtZW50ID0gY29tcG9uZW50LmdldEVsZW1lbnQoKSxcblx0ICAgIHRhcEhvbGQgPSBudWxsLFxuXHQgICAgbG9hZGVkID0gZmFsc2U7XG5cblx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHRsb2FkZWQgPSBmYWxzZTtcblxuXHRcdHRhcEhvbGQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHRcdHRhcEhvbGQgPSBudWxsO1xuXHRcdFx0bG9hZGVkID0gdHJ1ZTtcblxuXHRcdFx0X3RoaXM3Mi5Mb2FkTWVudUV2ZW50KGNvbXBvbmVudCwgbWVudSwgZSk7XG5cdFx0fSwgMTAwMCk7XG5cdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGNsZWFyVGltZW91dCh0YXBIb2xkKTtcblx0XHR0YXBIb2xkID0gbnVsbDtcblxuXHRcdGlmIChsb2FkZWQpIHtcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH0pO1xufTtcblxuTWVudS5wcm90b3R5cGUuaW5pdGlhbGl6ZUNlbGwgPSBmdW5jdGlvbiAoY2VsbCkge1xuXHRpZiAoY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5jb250ZXh0TWVudSkge1xuXHRcdGNlbGwuZ2V0RWxlbWVudCh0cnVlKS5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy5Mb2FkTWVudUV2ZW50LmJpbmQodGhpcywgY2VsbCwgY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5jb250ZXh0TWVudSkpO1xuXHRcdHRoaXMudGFwSG9sZChjZWxsLCBjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNvbnRleHRNZW51KTtcblx0fVxuXG5cdGlmIChjZWxsLmNvbHVtbi5kZWZpbml0aW9uLmNsaWNrTWVudSkge1xuXHRcdGNlbGwuZ2V0RWxlbWVudCh0cnVlKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5Mb2FkTWVudUV2ZW50LmJpbmQodGhpcywgY2VsbCwgY2VsbC5jb2x1bW4uZGVmaW5pdGlvbi5jbGlja01lbnUpKTtcblx0fVxufTtcblxuTWVudS5wcm90b3R5cGUuaW5pdGlhbGl6ZVJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5yb3dDb250ZXh0TWVudSkge1xuXHRcdHJvdy5nZXRFbGVtZW50KCkuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuTG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIHJvdywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NvbnRleHRNZW51KSk7XG5cdFx0dGhpcy50YXBIb2xkKHJvdywgdGhpcy50YWJsZS5vcHRpb25zLnJvd0NvbnRleHRNZW51KTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucm93Q2xpY2tNZW51KSB7XG5cdFx0cm93LmdldEVsZW1lbnQoKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5Mb2FkTWVudUV2ZW50LmJpbmQodGhpcywgcm93LCB0aGlzLnRhYmxlLm9wdGlvbnMucm93Q2xpY2tNZW51KSk7XG5cdH1cbn07XG5cbk1lbnUucHJvdG90eXBlLmluaXRpYWxpemVHcm91cCA9IGZ1bmN0aW9uIChncm91cCkge1xuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ29udGV4dE1lbnUpIHtcblx0XHRncm91cC5nZXRFbGVtZW50KCkuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuTG9hZE1lbnVFdmVudC5iaW5kKHRoaXMsIGdyb3VwLCB0aGlzLnRhYmxlLm9wdGlvbnMuZ3JvdXBDb250ZXh0TWVudSkpO1xuXHRcdHRoaXMudGFwSG9sZChncm91cCwgdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQ29udGV4dE1lbnUpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5ncm91cENsaWNrTWVudSkge1xuXHRcdGdyb3VwLmdldEVsZW1lbnQoKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5Mb2FkTWVudUV2ZW50LmJpbmQodGhpcywgZ3JvdXAsIHRoaXMudGFibGUub3B0aW9ucy5ncm91cENsaWNrTWVudSkpO1xuXHR9XG59O1xuXG5NZW51LnByb3RvdHlwZS5sb2FkTWVudSA9IGZ1bmN0aW9uIChlLCBjb21wb25lbnQsIG1lbnUsIHBhcmVudEVsKSB7XG5cdHZhciBfdGhpczczID0gdGhpcztcblxuXHR2YXIgdG91Y2ggPSAhKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KTtcblxuXHR2YXIgbWVudUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0bWVudUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbWVudVwiKTtcblxuXHRpZiAoIXRvdWNoKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9XG5cblx0Ly9hYm9ydCBpZiBubyBtZW51IHNldFxuXHRpZiAoIW1lbnUgfHwgIW1lbnUubGVuZ3RoKSB7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0aWYgKCFwYXJlbnRFbCkge1xuXHRcdGlmICh0aGlzLm5lc3RlZE1lbnVCbG9jaykge1xuXHRcdFx0Ly9hYm9ydCBpZiBjaGlsZCBtZW51IGFscmVhZHkgb3BlblxuXHRcdFx0aWYgKHRoaXMuaXNPcGVuKCkpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLm5lc3RlZE1lbnVCbG9jayA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRfdGhpczczLm5lc3RlZE1lbnVCbG9jayA9IGZhbHNlO1xuXHRcdFx0fSwgMTAwKTtcblx0XHR9XG5cblx0XHR0aGlzLmhpZGVNZW51KCk7XG5cdFx0dGhpcy5tZW51RWxlbWVudHMgPSBbXTtcblx0fVxuXG5cdG1lbnUuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdHZhciBpdGVtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuXHRcdCAgICBsYWJlbCA9IGl0ZW0ubGFiZWwsXG5cdFx0ICAgIGRpc2FibGVkID0gaXRlbS5kaXNhYmxlZDtcblxuXHRcdGlmIChpdGVtLnNlcGFyYXRvcikge1xuXHRcdFx0aXRlbUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbWVudS1zZXBhcmF0b3JcIik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGl0ZW1FbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1lbnUtaXRlbVwiKTtcblxuXHRcdFx0aWYgKHR5cGVvZiBsYWJlbCA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0bGFiZWwgPSBsYWJlbC5jYWxsKF90aGlzNzMudGFibGUsIGNvbXBvbmVudC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChsYWJlbCBpbnN0YW5jZW9mIE5vZGUpIHtcblx0XHRcdFx0aXRlbUVsLmFwcGVuZENoaWxkKGxhYmVsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW1FbC5pbm5lckhUTUwgPSBsYWJlbDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHR5cGVvZiBkaXNhYmxlZCA9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0ZGlzYWJsZWQgPSBkaXNhYmxlZC5jYWxsKF90aGlzNzMudGFibGUsIGNvbXBvbmVudC5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChkaXNhYmxlZCkge1xuXHRcdFx0XHRpdGVtRWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1tZW51LWl0ZW0tZGlzYWJsZWRcIik7XG5cdFx0XHRcdGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChpdGVtLm1lbnUgJiYgaXRlbS5tZW51Lmxlbmd0aCkge1xuXHRcdFx0XHRcdGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRfdGhpczczLmhpZGVPbGRTdWJNZW51cyhtZW51RWwpO1xuXHRcdFx0XHRcdFx0X3RoaXM3My5sb2FkTWVudShlLCBjb21wb25lbnQsIGl0ZW0ubWVudSwgaXRlbUVsKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoaXRlbS5hY3Rpb24pIHtcblx0XHRcdFx0XHRcdGl0ZW1FbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRcdFx0aXRlbS5hY3Rpb24oZSwgY29tcG9uZW50LmdldENvbXBvbmVudCgpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoaXRlbS5tZW51ICYmIGl0ZW0ubWVudS5sZW5ndGgpIHtcblx0XHRcdFx0aXRlbUVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbWVudS1pdGVtLXN1Ym1lbnVcIik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0bWVudUVsLmFwcGVuZENoaWxkKGl0ZW1FbCk7XG5cdH0pO1xuXG5cdG1lbnVFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRfdGhpczczLmhpZGVNZW51KCk7XG5cdH0pO1xuXG5cdHRoaXMubWVudUVsZW1lbnRzLnB1c2gobWVudUVsKTtcblx0dGhpcy5wb3NpdGlvbk1lbnUobWVudUVsLCBwYXJlbnRFbCwgdG91Y2gsIGUpO1xufTtcblxuTWVudS5wcm90b3R5cGUuaGlkZU9sZFN1Yk1lbnVzID0gZnVuY3Rpb24gKG1lbnVFbCkge1xuXHR2YXIgaW5kZXggPSB0aGlzLm1lbnVFbGVtZW50cy5pbmRleE9mKG1lbnVFbCk7XG5cblx0aWYgKGluZGV4ID4gLTEpIHtcblx0XHRmb3IgKHZhciBfaTEzID0gdGhpcy5tZW51RWxlbWVudHMubGVuZ3RoIC0gMTsgX2kxMyA+IGluZGV4OyBfaTEzLS0pIHtcblx0XHRcdHZhciBlbCA9IHRoaXMubWVudUVsZW1lbnRzW19pMTNdO1xuXG5cdFx0XHRpZiAoZWwucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5tZW51RWxlbWVudHMucG9wKCk7XG5cdFx0fVxuXHR9XG59O1xuXG5NZW51LnByb3RvdHlwZS5wb3NpdGlvbk1lbnUgPSBmdW5jdGlvbiAoZWxlbWVudCwgcGFyZW50RWwsIHRvdWNoLCBlKSB7XG5cdHZhciBfdGhpczc0ID0gdGhpcztcblxuXHR2YXIgZG9jSGVpZ2h0ID0gTWF0aC5tYXgoZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQsIHdpbmRvdy5pbm5lckhlaWdodCksXG5cdCAgICB4LFxuXHQgICAgeSxcblx0ICAgIHBhcmVudE9mZnNldDtcblxuXHRpZiAoIXBhcmVudEVsKSB7XG5cdFx0eCA9IHRvdWNoID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWDtcblx0XHR5ID0gdG91Y2ggPyBlLnRvdWNoZXNbMF0ucGFnZVkgOiBlLnBhZ2VZO1xuXG5cdFx0dGhpcy5wb3NpdGlvblJldmVyc2VkWCA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdHBhcmVudE9mZnNldCA9IFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChwYXJlbnRFbCk7XG5cdFx0eCA9IHBhcmVudE9mZnNldC5sZWZ0ICsgcGFyZW50RWwub2Zmc2V0V2lkdGg7XG5cdFx0eSA9IHBhcmVudE9mZnNldC50b3AgLSAxO1xuXHR9XG5cblx0ZWxlbWVudC5zdHlsZS50b3AgPSB5ICsgXCJweFwiO1xuXHRlbGVtZW50LnN0eWxlLmxlZnQgPSB4ICsgXCJweFwiO1xuXG5cdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdF90aGlzNzQudGFibGUucm93TWFuYWdlci5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgX3RoaXM3NC5ibHVyRXZlbnQpO1xuXHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIF90aGlzNzQuYmx1ckV2ZW50KTtcblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBfdGhpczc0LmJsdXJFdmVudCk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgX3RoaXM3NC5ibHVyRXZlbnQpO1xuXHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgX3RoaXM3NC5lc2NFdmVudCk7XG5cdH0sIDEwMCk7XG5cblx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcblxuXHQvL21vdmUgbWVudSB0byBzdGFydCBvbiBib3R0b20gZWRnZSBpZiBpdCBpcyB0b28gY2xvc2UgdG8gdGhlIGVkZ2Ugb2YgdGhlIHNjcmVlblxuXHRpZiAoeSArIGVsZW1lbnQub2Zmc2V0SGVpZ2h0ID49IGRvY0hlaWdodCkge1xuXHRcdGVsZW1lbnQuc3R5bGUudG9wID0gXCJcIjtcblxuXHRcdGlmIChwYXJlbnRFbCkge1xuXHRcdFx0ZWxlbWVudC5zdHlsZS5ib3R0b20gPSBkb2NIZWlnaHQgLSBwYXJlbnRPZmZzZXQudG9wIC0gcGFyZW50RWwub2Zmc2V0SGVpZ2h0IC0gMSArIFwicHhcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZWxlbWVudC5zdHlsZS5ib3R0b20gPSBkb2NIZWlnaHQgLSB5ICsgXCJweFwiO1xuXHRcdH1cblx0fVxuXG5cdC8vbW92ZSBtZW51IHRvIHN0YXJ0IG9uIHJpZ2h0IGVkZ2UgaWYgaXQgaXMgdG9vIGNsb3NlIHRvIHRoZSBlZGdlIG9mIHRoZSBzY3JlZW5cblx0aWYgKHggKyBlbGVtZW50Lm9mZnNldFdpZHRoID49IGRvY3VtZW50LmJvZHkub2Zmc2V0V2lkdGggfHwgdGhpcy5wb3NpdGlvblJldmVyc2VkWCkge1xuXHRcdGVsZW1lbnQuc3R5bGUubGVmdCA9IFwiXCI7XG5cblx0XHRpZiAocGFyZW50RWwpIHtcblx0XHRcdGVsZW1lbnQuc3R5bGUucmlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQub2Zmc2V0V2lkdGggLSBwYXJlbnRPZmZzZXQubGVmdCArIFwicHhcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZWxlbWVudC5zdHlsZS5yaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5vZmZzZXRXaWR0aCAtIHggKyBcInB4XCI7XG5cdFx0fVxuXG5cdFx0dGhpcy5wb3NpdGlvblJldmVyc2VkWCA9IHRydWU7XG5cdH1cbn07XG5cbk1lbnUucHJvdG90eXBlLmlzT3BlbiA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuICEhdGhpcy5tZW51RWxlbWVudHMubGVuZ3RoO1xufTtcblxuTWVudS5wcm90b3R5cGUuZXNjTWVudSA9IGZ1bmN0aW9uIChlKSB7XG5cdGlmIChlLmtleUNvZGUgPT0gMjcpIHtcblx0XHR0aGlzLmhpZGVNZW51KCk7XG5cdH1cbn07XG5cbk1lbnUucHJvdG90eXBlLmhpZGVNZW51ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLm1lbnVFbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChtZW51RWwpIHtcblx0XHRpZiAobWVudUVsLnBhcmVudE5vZGUpIHtcblx0XHRcdG1lbnVFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG1lbnVFbCk7XG5cdFx0fVxuXHR9KTtcblxuXHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuZXNjRXZlbnQpO1xuXHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmJsdXJFdmVudCk7XG5cdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuYmx1ckV2ZW50KTtcblx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5ibHVyRXZlbnQpO1xuXHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHRoaXMuYmx1ckV2ZW50KTtcbn07XG5cbi8vZGVmYXVsdCBhY2Nlc3NvcnNcbk1lbnUucHJvdG90eXBlLm1lbnVzID0ge307XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJtZW51XCIsIE1lbnUpO1xudmFyIE1vdmVDb2x1bW5zID0gZnVuY3Rpb24gTW92ZUNvbHVtbnModGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudCA9IHRoaXMuY3JlYXRlUGxhY2Vob2xkZXJFbGVtZW50KCk7XG5cdHRoaXMuaG92ZXJFbGVtZW50ID0gZmFsc2U7IC8vZmxvYXRpbmcgY29sdW1uIGhlYWRlciBlbGVtZW50XG5cdHRoaXMuY2hlY2tUaW1lb3V0ID0gZmFsc2U7IC8vY2xpY2sgY2hlY2sgdGltZW91dCBob2xkZXJcblx0dGhpcy5jaGVja1BlcmlvZCA9IDI1MDsgLy9wZXJpb2QgdG8gd2FpdCBvbiBtb3VzZWRvd24gdG8gY29uc2lkZXIgdGhpcyBhIG1vdmUgYW5kIG5vdCBhIGNsaWNrXG5cdHRoaXMubW92aW5nID0gZmFsc2U7IC8vY3VycmVudGx5IG1vdmluZyBjb2x1bW5cblx0dGhpcy50b0NvbCA9IGZhbHNlOyAvL2Rlc3RpbmF0aW9uIGNvbHVtblxuXHR0aGlzLnRvQ29sQWZ0ZXIgPSBmYWxzZTsgLy9wb3NpdGlvbiBvZiBtb3ZpbmcgY29sdW1uIHJlbGF0aXZlIHRvIHRoZSBkZXNpdG5hdGlvbiBjb2x1bW5cblx0dGhpcy5zdGFydFggPSAwOyAvL3N0YXJ0aW5nIHBvc2l0aW9uIHdpdGhpbiBoZWFkZXIgZWxlbWVudFxuXHR0aGlzLmF1dG9TY3JvbGxNYXJnaW4gPSA0MDsgLy9hdXRvIHNjcm9sbCBvbiBlZGdlIHdoZW4gd2l0aGluIG1hcmdpblxuXHR0aGlzLmF1dG9TY3JvbGxTdGVwID0gNTsgLy9hdXRvIHNjcm9sbCBkaXN0YW5jZSBpbiBwaXhlbHNcblx0dGhpcy5hdXRvU2Nyb2xsVGltZW91dCA9IGZhbHNlOyAvL2F1dG8gc2Nyb2xsIHRpbWVvdXRcblx0dGhpcy50b3VjaE1vdmUgPSBmYWxzZTtcblxuXHR0aGlzLm1vdmVIb3ZlciA9IHRoaXMubW92ZUhvdmVyLmJpbmQodGhpcyk7XG5cdHRoaXMuZW5kTW92ZSA9IHRoaXMuZW5kTW92ZS5iaW5kKHRoaXMpO1xufTtcblxuTW92ZUNvbHVtbnMucHJvdG90eXBlLmNyZWF0ZVBsYWNlaG9sZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNvbFwiKTtcblx0ZWwuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1jb2wtcGxhY2Vob2xkZXJcIik7XG5cblx0cmV0dXJuIGVsO1xufTtcblxuTW92ZUNvbHVtbnMucHJvdG90eXBlLmluaXRpYWxpemVDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGNvbmZpZyA9IHt9LFxuXHQgICAgY29sRWw7XG5cblx0aWYgKCFjb2x1bW4ubW9kdWxlcy5mcm96ZW4pIHtcblxuXHRcdGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKTtcblxuXHRcdGNvbmZpZy5tb3VzZW1vdmUgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGNvbHVtbi5wYXJlbnQgPT09IHNlbGYubW92aW5nLnBhcmVudCkge1xuXHRcdFx0XHRpZiAoKHNlbGYudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCkgLSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxPZmZzZXQoY29sRWwpLmxlZnQgKyBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIuZWxlbWVudC5zY3JvbGxMZWZ0ID4gY29sdW1uLmdldFdpZHRoKCkgLyAyKSB7XG5cdFx0XHRcdFx0aWYgKHNlbGYudG9Db2wgIT09IGNvbHVtbiB8fCAhc2VsZi50b0NvbEFmdGVyKSB7XG5cdFx0XHRcdFx0XHRjb2xFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgY29sRWwubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdFx0c2VsZi5tb3ZlQ29sdW1uKGNvbHVtbiwgdHJ1ZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGlmIChzZWxmLnRvQ29sICE9PSBjb2x1bW4gfHwgc2VsZi50b0NvbEFmdGVyKSB7XG5cdFx0XHRcdFx0XHRjb2xFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgY29sRWwpO1xuXHRcdFx0XHRcdFx0c2VsZi5tb3ZlQ29sdW1uKGNvbHVtbiwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0uYmluZChzZWxmKTtcblxuXHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYudG91Y2hNb3ZlID0gZmFsc2U7XG5cdFx0XHRpZiAoZS53aGljaCA9PT0gMSkge1xuXHRcdFx0XHRzZWxmLmNoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHNlbGYuc3RhcnRNb3ZlKGUsIGNvbHVtbik7XG5cdFx0XHRcdH0sIHNlbGYuY2hlY2tQZXJpb2QpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29sRWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdGlmIChlLndoaWNoID09PSAxKSB7XG5cdFx0XHRcdGlmIChzZWxmLmNoZWNrVGltZW91dCkge1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dChzZWxmLmNoZWNrVGltZW91dCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHNlbGYuYmluZFRvdWNoRXZlbnRzKGNvbHVtbik7XG5cdH1cblxuXHRjb2x1bW4ubW9kdWxlcy5tb3ZlQ29sdW1uID0gY29uZmlnO1xufTtcblxuTW92ZUNvbHVtbnMucHJvdG90eXBlLmJpbmRUb3VjaEV2ZW50cyA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29sRWwgPSBjb2x1bW4uZ2V0RWxlbWVudCgpLFxuXHQgICAgc3RhcnRYTW92ZSA9IGZhbHNlLFxuXHQgICAgLy9zaGlmdGluZyBjZW50ZXIgcG9zaXRpb24gb2YgdGhlIGNlbGxcblx0ZGlyID0gZmFsc2UsXG5cdCAgICBjdXJyZW50Q29sLFxuXHQgICAgbmV4dENvbCxcblx0ICAgIHByZXZDb2wsXG5cdCAgICBuZXh0Q29sV2lkdGgsXG5cdCAgICBwcmV2Q29sV2lkdGgsXG5cdCAgICBuZXh0Q29sV2lkdGhMYXN0LFxuXHQgICAgcHJldkNvbFdpZHRoTGFzdDtcblxuXHRjb2xFbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdHNlbGYuY2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRzZWxmLnRvdWNoTW92ZSA9IHRydWU7XG5cdFx0XHRjdXJyZW50Q29sID0gY29sdW1uO1xuXHRcdFx0bmV4dENvbCA9IGNvbHVtbi5uZXh0Q29sdW1uKCk7XG5cdFx0XHRuZXh0Q29sV2lkdGggPSBuZXh0Q29sID8gbmV4dENvbC5nZXRXaWR0aCgpIC8gMiA6IDA7XG5cdFx0XHRwcmV2Q29sID0gY29sdW1uLnByZXZDb2x1bW4oKTtcblx0XHRcdHByZXZDb2xXaWR0aCA9IHByZXZDb2wgPyBwcmV2Q29sLmdldFdpZHRoKCkgLyAyIDogMDtcblx0XHRcdG5leHRDb2xXaWR0aExhc3QgPSAwO1xuXHRcdFx0cHJldkNvbFdpZHRoTGFzdCA9IDA7XG5cdFx0XHRzdGFydFhNb3ZlID0gZmFsc2U7XG5cblx0XHRcdHNlbGYuc3RhcnRNb3ZlKGUsIGNvbHVtbik7XG5cdFx0fSwgc2VsZi5jaGVja1BlcmlvZCk7XG5cdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRjb2xFbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0dmFyIGhhbGZDb2wsIGRpZmYsIG1vdmVUb0NvbDtcblxuXHRcdGlmIChzZWxmLm1vdmluZykge1xuXHRcdFx0c2VsZi5tb3ZlSG92ZXIoZSk7XG5cblx0XHRcdGlmICghc3RhcnRYTW92ZSkge1xuXHRcdFx0XHRzdGFydFhNb3ZlID0gZS50b3VjaGVzWzBdLnBhZ2VYO1xuXHRcdFx0fVxuXG5cdFx0XHRkaWZmID0gZS50b3VjaGVzWzBdLnBhZ2VYIC0gc3RhcnRYTW92ZTtcblxuXHRcdFx0aWYgKGRpZmYgPiAwKSB7XG5cdFx0XHRcdGlmIChuZXh0Q29sICYmIGRpZmYgLSBuZXh0Q29sV2lkdGhMYXN0ID4gbmV4dENvbFdpZHRoKSB7XG5cdFx0XHRcdFx0bW92ZVRvQ29sID0gbmV4dENvbDtcblxuXHRcdFx0XHRcdGlmIChtb3ZlVG9Db2wgIT09IGNvbHVtbikge1xuXHRcdFx0XHRcdFx0c3RhcnRYTW92ZSA9IGUudG91Y2hlc1swXS5wYWdlWDtcblx0XHRcdFx0XHRcdG1vdmVUb0NvbC5nZXRFbGVtZW50KCkucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5wbGFjZWhvbGRlckVsZW1lbnQsIG1vdmVUb0NvbC5nZXRFbGVtZW50KCkubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdFx0c2VsZi5tb3ZlQ29sdW1uKG1vdmVUb0NvbCwgdHJ1ZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAocHJldkNvbCAmJiAtZGlmZiAtIHByZXZDb2xXaWR0aExhc3QgPiBwcmV2Q29sV2lkdGgpIHtcblx0XHRcdFx0XHRtb3ZlVG9Db2wgPSBwcmV2Q29sO1xuXG5cdFx0XHRcdFx0aWYgKG1vdmVUb0NvbCAhPT0gY29sdW1uKSB7XG5cdFx0XHRcdFx0XHRzdGFydFhNb3ZlID0gZS50b3VjaGVzWzBdLnBhZ2VYO1xuXHRcdFx0XHRcdFx0bW92ZVRvQ29sLmdldEVsZW1lbnQoKS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgbW92ZVRvQ29sLmdldEVsZW1lbnQoKSk7XG5cdFx0XHRcdFx0XHRzZWxmLm1vdmVDb2x1bW4obW92ZVRvQ29sLCBmYWxzZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChtb3ZlVG9Db2wpIHtcblx0XHRcdFx0Y3VycmVudENvbCA9IG1vdmVUb0NvbDtcblx0XHRcdFx0bmV4dENvbCA9IG1vdmVUb0NvbC5uZXh0Q29sdW1uKCk7XG5cdFx0XHRcdG5leHRDb2xXaWR0aExhc3QgPSBuZXh0Q29sV2lkdGg7XG5cdFx0XHRcdG5leHRDb2xXaWR0aCA9IG5leHRDb2wgPyBuZXh0Q29sLmdldFdpZHRoKCkgLyAyIDogMDtcblx0XHRcdFx0cHJldkNvbCA9IG1vdmVUb0NvbC5wcmV2Q29sdW1uKCk7XG5cdFx0XHRcdHByZXZDb2xXaWR0aExhc3QgPSBwcmV2Q29sV2lkdGg7XG5cdFx0XHRcdHByZXZDb2xXaWR0aCA9IHByZXZDb2wgPyBwcmV2Q29sLmdldFdpZHRoKCkgLyAyIDogMDtcblx0XHRcdH1cblx0XHR9XG5cdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRjb2xFbC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoc2VsZi5jaGVja1RpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dChzZWxmLmNoZWNrVGltZW91dCk7XG5cdFx0fVxuXHRcdGlmIChzZWxmLm1vdmluZykge1xuXHRcdFx0c2VsZi5lbmRNb3ZlKGUpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Nb3ZlQ29sdW1ucy5wcm90b3R5cGUuc3RhcnRNb3ZlID0gZnVuY3Rpb24gKGUsIGNvbHVtbikge1xuXHR2YXIgZWxlbWVudCA9IGNvbHVtbi5nZXRFbGVtZW50KCk7XG5cblx0dGhpcy5tb3ZpbmcgPSBjb2x1bW47XG5cdHRoaXMuc3RhcnRYID0gKHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCkgLSBUYWJ1bGF0b3IucHJvdG90eXBlLmhlbHBlcnMuZWxPZmZzZXQoZWxlbWVudCkubGVmdDtcblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0Ly9jcmVhdGUgcGxhY2Vob2xkZXJcblx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUud2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gY29sdW1uLmdldEhlaWdodCgpICsgXCJweFwiO1xuXG5cdGVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUodGhpcy5wbGFjZWhvbGRlckVsZW1lbnQsIGVsZW1lbnQpO1xuXHRlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG5cblx0Ly9jcmVhdGUgaG92ZXIgZWxlbWVudFxuXHR0aGlzLmhvdmVyRWxlbWVudCA9IGVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xuXHR0aGlzLmhvdmVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1vdmluZ1wiKTtcblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0RWxlbWVudCgpLmFwcGVuZENoaWxkKHRoaXMuaG92ZXJFbGVtZW50KTtcblxuXHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5sZWZ0ID0gXCIwXCI7XG5cdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLmJvdHRvbSA9IFwiMFwiO1xuXG5cdGlmICghdGhpcy50b3VjaE1vdmUpIHtcblx0XHR0aGlzLl9iaW5kTW91c2VNb3ZlKCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5tb3ZlSG92ZXIpO1xuXHRcdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy5lbmRNb3ZlKTtcblx0fVxuXG5cdHRoaXMubW92ZUhvdmVyKGUpO1xufTtcblxuTW92ZUNvbHVtbnMucHJvdG90eXBlLl9iaW5kTW91c2VNb3ZlID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLm1vdmVDb2x1bW4ubW91c2Vtb3ZlKSB7XG5cdFx0XHRjb2x1bW4uZ2V0RWxlbWVudCgpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgY29sdW1uLm1vZHVsZXMubW92ZUNvbHVtbi5tb3VzZW1vdmUpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Nb3ZlQ29sdW1ucy5wcm90b3R5cGUuX3VuYmluZE1vdXNlTW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmNvbHVtbnNCeUluZGV4LmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbikge1xuXHRcdGlmIChjb2x1bW4ubW9kdWxlcy5tb3ZlQ29sdW1uLm1vdXNlbW92ZSkge1xuXHRcdFx0Y29sdW1uLmdldEVsZW1lbnQoKS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIGNvbHVtbi5tb2R1bGVzLm1vdmVDb2x1bW4ubW91c2Vtb3ZlKTtcblx0XHR9XG5cdH0pO1xufTtcblxuTW92ZUNvbHVtbnMucHJvdG90eXBlLm1vdmVDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uLCBhZnRlcikge1xuXHR2YXIgbW92aW5nQ2VsbHMgPSB0aGlzLm1vdmluZy5nZXRDZWxscygpO1xuXG5cdHRoaXMudG9Db2wgPSBjb2x1bW47XG5cdHRoaXMudG9Db2xBZnRlciA9IGFmdGVyO1xuXG5cdGlmIChhZnRlcikge1xuXHRcdGNvbHVtbi5nZXRDZWxscygpLmZvckVhY2goZnVuY3Rpb24gKGNlbGwsIGkpIHtcblx0XHRcdHZhciBjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQodHJ1ZSk7XG5cdFx0XHRjZWxsRWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobW92aW5nQ2VsbHNbaV0uZ2V0RWxlbWVudCgpLCBjZWxsRWwubmV4dFNpYmxpbmcpO1xuXHRcdH0pO1xuXHR9IGVsc2Uge1xuXHRcdGNvbHVtbi5nZXRDZWxscygpLmZvckVhY2goZnVuY3Rpb24gKGNlbGwsIGkpIHtcblx0XHRcdHZhciBjZWxsRWwgPSBjZWxsLmdldEVsZW1lbnQodHJ1ZSk7XG5cdFx0XHRjZWxsRWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobW92aW5nQ2VsbHNbaV0uZ2V0RWxlbWVudCgpLCBjZWxsRWwpO1xuXHRcdH0pO1xuXHR9XG59O1xuXG5Nb3ZlQ29sdW1ucy5wcm90b3R5cGUuZW5kTW92ZSA9IGZ1bmN0aW9uIChlKSB7XG5cdGlmIChlLndoaWNoID09PSAxIHx8IHRoaXMudG91Y2hNb3ZlKSB7XG5cdFx0dGhpcy5fdW5iaW5kTW91c2VNb3ZlKCk7XG5cblx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLm1vdmluZy5nZXRFbGVtZW50KCksIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50Lm5leHRTaWJsaW5nKTtcblx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMucGxhY2Vob2xkZXJFbGVtZW50KTtcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuaG92ZXJFbGVtZW50KTtcblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdGlmICh0aGlzLnRvQ29sKSB7XG5cdFx0XHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIubW92ZUNvbHVtbkFjdHVhbCh0aGlzLm1vdmluZywgdGhpcy50b0NvbCwgdGhpcy50b0NvbEFmdGVyKTtcblx0XHR9XG5cblx0XHR0aGlzLm1vdmluZyA9IGZhbHNlO1xuXHRcdHRoaXMudG9Db2wgPSBmYWxzZTtcblx0XHR0aGlzLnRvQ29sQWZ0ZXIgPSBmYWxzZTtcblxuXHRcdGlmICghdGhpcy50b3VjaE1vdmUpIHtcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLm1vdmVIb3Zlcik7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuZW5kTW92ZSk7XG5cdFx0fVxuXHR9XG59O1xuXG5Nb3ZlQ29sdW1ucy5wcm90b3R5cGUubW92ZUhvdmVyID0gZnVuY3Rpb24gKGUpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29sdW1uSG9sZGVyID0gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldEVsZW1lbnQoKSxcblx0ICAgIHNjcm9sbExlZnQgPSBjb2x1bW5Ib2xkZXIuc2Nyb2xsTGVmdCxcblx0ICAgIHhQb3MgPSAoc2VsZi50b3VjaE1vdmUgPyBlLnRvdWNoZXNbMF0ucGFnZVggOiBlLnBhZ2VYKSAtIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChjb2x1bW5Ib2xkZXIpLmxlZnQgKyBzY3JvbGxMZWZ0LFxuXHQgICAgc2Nyb2xsUG9zO1xuXG5cdHNlbGYuaG92ZXJFbGVtZW50LnN0eWxlLmxlZnQgPSB4UG9zIC0gc2VsZi5zdGFydFggKyBcInB4XCI7XG5cblx0aWYgKHhQb3MgLSBzY3JvbGxMZWZ0IDwgc2VsZi5hdXRvU2Nyb2xsTWFyZ2luKSB7XG5cdFx0aWYgKCFzZWxmLmF1dG9TY3JvbGxUaW1lb3V0KSB7XG5cdFx0XHRzZWxmLmF1dG9TY3JvbGxUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHNjcm9sbFBvcyA9IE1hdGgubWF4KDAsIHNjcm9sbExlZnQgLSA1KTtcblx0XHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldEVsZW1lbnQoKS5zY3JvbGxMZWZ0ID0gc2Nyb2xsUG9zO1xuXHRcdFx0XHRzZWxmLmF1dG9TY3JvbGxUaW1lb3V0ID0gZmFsc2U7XG5cdFx0XHR9LCAxKTtcblx0XHR9XG5cdH1cblxuXHRpZiAoc2Nyb2xsTGVmdCArIGNvbHVtbkhvbGRlci5jbGllbnRXaWR0aCAtIHhQb3MgPCBzZWxmLmF1dG9TY3JvbGxNYXJnaW4pIHtcblx0XHRpZiAoIXNlbGYuYXV0b1Njcm9sbFRpbWVvdXQpIHtcblx0XHRcdHNlbGYuYXV0b1Njcm9sbFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0c2Nyb2xsUG9zID0gTWF0aC5taW4oY29sdW1uSG9sZGVyLmNsaWVudFdpZHRoLCBzY3JvbGxMZWZ0ICsgNSk7XG5cdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5nZXRFbGVtZW50KCkuc2Nyb2xsTGVmdCA9IHNjcm9sbFBvcztcblx0XHRcdFx0c2VsZi5hdXRvU2Nyb2xsVGltZW91dCA9IGZhbHNlO1xuXHRcdFx0fSwgMSk7XG5cdFx0fVxuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwibW92ZUNvbHVtblwiLCBNb3ZlQ29sdW1ucyk7XG5cbnZhciBNb3ZlUm93cyA9IGZ1bmN0aW9uIE1vdmVSb3dzKHRhYmxlKSB7XG5cblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudCA9IHRoaXMuY3JlYXRlUGxhY2Vob2xkZXJFbGVtZW50KCk7XG5cdHRoaXMuaG92ZXJFbGVtZW50ID0gZmFsc2U7IC8vZmxvYXRpbmcgcm93IGhlYWRlciBlbGVtZW50XG5cdHRoaXMuY2hlY2tUaW1lb3V0ID0gZmFsc2U7IC8vY2xpY2sgY2hlY2sgdGltZW91dCBob2xkZXJcblx0dGhpcy5jaGVja1BlcmlvZCA9IDE1MDsgLy9wZXJpb2QgdG8gd2FpdCBvbiBtb3VzZWRvd24gdG8gY29uc2lkZXIgdGhpcyBhIG1vdmUgYW5kIG5vdCBhIGNsaWNrXG5cdHRoaXMubW92aW5nID0gZmFsc2U7IC8vY3VycmVudGx5IG1vdmluZyByb3dcblx0dGhpcy50b1JvdyA9IGZhbHNlOyAvL2Rlc3RpbmF0aW9uIHJvd1xuXHR0aGlzLnRvUm93QWZ0ZXIgPSBmYWxzZTsgLy9wb3NpdGlvbiBvZiBtb3Zpbmcgcm93IHJlbGF0aXZlIHRvIHRoZSBkZXNpdG5hdGlvbiByb3dcblx0dGhpcy5oYXNIYW5kbGUgPSBmYWxzZTsgLy9yb3cgaGFzIGhhbmRsZSBpbnN0ZWFkIG9mIGZ1bGx5IG1vdmFibGUgcm93XG5cdHRoaXMuc3RhcnRZID0gMDsgLy9zdGFydGluZyBZIHBvc2l0aW9uIHdpdGhpbiBoZWFkZXIgZWxlbWVudFxuXHR0aGlzLnN0YXJ0WCA9IDA7IC8vc3RhcnRpbmcgWCBwb3NpdGlvbiB3aXRoaW4gaGVhZGVyIGVsZW1lbnRcblxuXHR0aGlzLm1vdmVIb3ZlciA9IHRoaXMubW92ZUhvdmVyLmJpbmQodGhpcyk7XG5cdHRoaXMuZW5kTW92ZSA9IHRoaXMuZW5kTW92ZS5iaW5kKHRoaXMpO1xuXHR0aGlzLnRhYmxlUm93RHJvcEV2ZW50ID0gZmFsc2U7XG5cblx0dGhpcy50b3VjaE1vdmUgPSBmYWxzZTtcblxuXHR0aGlzLmNvbm5lY3Rpb24gPSBmYWxzZTtcblx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzID0gZmFsc2U7XG5cdHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzID0gZmFsc2U7XG5cdHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzID0gW107XG5cdHRoaXMuY29ubmVjdGlvbnMgPSBbXTtcblxuXHR0aGlzLmNvbm5lY3RlZFRhYmxlID0gZmFsc2U7XG5cdHRoaXMuY29ubmVjdGVkUm93ID0gZmFsc2U7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuY3JlYXRlUGxhY2Vob2xkZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG5cdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93XCIpO1xuXHRlbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXJvdy1wbGFjZWhvbGRlclwiKTtcblxuXHRyZXR1cm4gZWw7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChoYW5kbGUpIHtcblx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzID0gdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzQ29ubmVjdGVkVGFibGVzO1xuXHR0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNFbGVtZW50cyA9IHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c0Nvbm5lY3RlZEVsZW1lbnRzO1xuXG5cdHRoaXMuY29ubmVjdGlvbiA9IHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc1RhYmxlcyB8fCB0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNFbGVtZW50cztcbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5zZXRIYW5kbGUgPSBmdW5jdGlvbiAoaGFuZGxlKSB7XG5cdHRoaXMuaGFzSGFuZGxlID0gaGFuZGxlO1xufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLmluaXRpYWxpemVHcm91cEhlYWRlciA9IGZ1bmN0aW9uIChncm91cCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBjb25maWcgPSB7fSxcblx0ICAgIHJvd0VsO1xuXG5cdC8vaW50ZXIgdGFibGUgZHJhZyBkcm9wXG5cdGNvbmZpZy5tb3VzZXVwID0gZnVuY3Rpb24gKGUpIHtcblx0XHRzZWxmLnRhYmxlUm93RHJvcChlLCByb3cpO1xuXHR9LmJpbmQoc2VsZik7XG5cblx0Ly9zYW1lIHRhYmxlIGRyYWcgZHJvcFxuXHRjb25maWcubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoZS5wYWdlWSAtIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChncm91cC5lbGVtZW50KS50b3AgKyBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5zY3JvbGxUb3AgPiBncm91cC5nZXRIZWlnaHQoKSAvIDIpIHtcblx0XHRcdGlmIChzZWxmLnRvUm93ICE9PSBncm91cCB8fCAhc2VsZi50b1Jvd0FmdGVyKSB7XG5cdFx0XHRcdHZhciByb3dFbCA9IGdyb3VwLmdldEVsZW1lbnQoKTtcblx0XHRcdFx0cm93RWwucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5wbGFjZWhvbGRlckVsZW1lbnQsIHJvd0VsLm5leHRTaWJsaW5nKTtcblx0XHRcdFx0c2VsZi5tb3ZlUm93KGdyb3VwLCB0cnVlKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHNlbGYudG9Sb3cgIT09IGdyb3VwIHx8IHNlbGYudG9Sb3dBZnRlcikge1xuXHRcdFx0XHR2YXIgcm93RWwgPSBncm91cC5nZXRFbGVtZW50KCk7XG5cdFx0XHRcdGlmIChyb3dFbC5wcmV2aW91c1NpYmxpbmcpIHtcblx0XHRcdFx0XHRyb3dFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgcm93RWwpO1xuXHRcdFx0XHRcdHNlbGYubW92ZVJvdyhncm91cCwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9LmJpbmQoc2VsZik7XG5cblx0Z3JvdXAubW9kdWxlcy5tb3ZlUm93ID0gY29uZmlnO1xufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGNvbmZpZyA9IHt9LFxuXHQgICAgcm93RWw7XG5cblx0Ly9pbnRlciB0YWJsZSBkcmFnIGRyb3Bcblx0Y29uZmlnLm1vdXNldXAgPSBmdW5jdGlvbiAoZSkge1xuXHRcdHNlbGYudGFibGVSb3dEcm9wKGUsIHJvdyk7XG5cdH0uYmluZChzZWxmKTtcblxuXHQvL3NhbWUgdGFibGUgZHJhZyBkcm9wXG5cdGNvbmZpZy5tb3VzZW1vdmUgPSBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciByb3dFbCA9IHJvdy5nZXRFbGVtZW50KCk7XG5cblx0XHRpZiAoZS5wYWdlWSAtIFRhYnVsYXRvci5wcm90b3R5cGUuaGVscGVycy5lbE9mZnNldChyb3dFbCkudG9wICsgc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmVsZW1lbnQuc2Nyb2xsVG9wID4gcm93LmdldEhlaWdodCgpIC8gMikge1xuXHRcdFx0aWYgKHNlbGYudG9Sb3cgIT09IHJvdyB8fCAhc2VsZi50b1Jvd0FmdGVyKSB7XG5cdFx0XHRcdHJvd0VsLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYucGxhY2Vob2xkZXJFbGVtZW50LCByb3dFbC5uZXh0U2libGluZyk7XG5cdFx0XHRcdHNlbGYubW92ZVJvdyhyb3csIHRydWUpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoc2VsZi50b1JvdyAhPT0gcm93IHx8IHNlbGYudG9Sb3dBZnRlcikge1xuXHRcdFx0XHRyb3dFbC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShzZWxmLnBsYWNlaG9sZGVyRWxlbWVudCwgcm93RWwpO1xuXHRcdFx0XHRzZWxmLm1vdmVSb3cocm93LCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LmJpbmQoc2VsZik7XG5cblx0aWYgKCF0aGlzLmhhc0hhbmRsZSkge1xuXG5cdFx0cm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdFx0cm93RWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGUud2hpY2ggPT09IDEpIHtcblx0XHRcdFx0c2VsZi5jaGVja1RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRzZWxmLnN0YXJ0TW92ZShlLCByb3cpO1xuXHRcdFx0XHR9LCBzZWxmLmNoZWNrUGVyaW9kKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJvd0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRpZiAoZS53aGljaCA9PT0gMSkge1xuXHRcdFx0XHRpZiAoc2VsZi5jaGVja1RpbWVvdXQpIHtcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQoc2VsZi5jaGVja1RpbWVvdXQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmJpbmRUb3VjaEV2ZW50cyhyb3csIHJvdy5nZXRFbGVtZW50KCkpO1xuXHR9XG5cblx0cm93Lm1vZHVsZXMubW92ZVJvdyA9IGNvbmZpZztcbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5pbml0aWFsaXplQ2VsbCA9IGZ1bmN0aW9uIChjZWxsKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGNlbGxFbCA9IGNlbGwuZ2V0RWxlbWVudCh0cnVlKTtcblxuXHRjZWxsRWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmIChlLndoaWNoID09PSAxKSB7XG5cdFx0XHRzZWxmLmNoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzZWxmLnN0YXJ0TW92ZShlLCBjZWxsLnJvdyk7XG5cdFx0XHR9LCBzZWxmLmNoZWNrUGVyaW9kKTtcblx0XHR9XG5cdH0pO1xuXG5cdGNlbGxFbC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmIChlLndoaWNoID09PSAxKSB7XG5cdFx0XHRpZiAoc2VsZi5jaGVja1RpbWVvdXQpIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHNlbGYuY2hlY2tUaW1lb3V0KTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdHRoaXMuYmluZFRvdWNoRXZlbnRzKGNlbGwucm93LCBjZWxsRWwpO1xufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLmJpbmRUb3VjaEV2ZW50cyA9IGZ1bmN0aW9uIChyb3csIGVsZW1lbnQpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgc3RhcnRZTW92ZSA9IGZhbHNlLFxuXHQgICAgLy9zaGlmdGluZyBjZW50ZXIgcG9zaXRpb24gb2YgdGhlIGNlbGxcblx0ZGlyID0gZmFsc2UsXG5cdCAgICBjdXJyZW50Um93LFxuXHQgICAgbmV4dFJvdyxcblx0ICAgIHByZXZSb3csXG5cdCAgICBuZXh0Um93SGVpZ2h0LFxuXHQgICAgcHJldlJvd0hlaWdodCxcblx0ICAgIG5leHRSb3dIZWlnaHRMYXN0LFxuXHQgICAgcHJldlJvd0hlaWdodExhc3Q7XG5cblx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdHNlbGYuY2hlY2tUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRzZWxmLnRvdWNoTW92ZSA9IHRydWU7XG5cdFx0XHRjdXJyZW50Um93ID0gcm93O1xuXHRcdFx0bmV4dFJvdyA9IHJvdy5uZXh0Um93KCk7XG5cdFx0XHRuZXh0Um93SGVpZ2h0ID0gbmV4dFJvdyA/IG5leHRSb3cuZ2V0SGVpZ2h0KCkgLyAyIDogMDtcblx0XHRcdHByZXZSb3cgPSByb3cucHJldlJvdygpO1xuXHRcdFx0cHJldlJvd0hlaWdodCA9IHByZXZSb3cgPyBwcmV2Um93LmdldEhlaWdodCgpIC8gMiA6IDA7XG5cdFx0XHRuZXh0Um93SGVpZ2h0TGFzdCA9IDA7XG5cdFx0XHRwcmV2Um93SGVpZ2h0TGFzdCA9IDA7XG5cdFx0XHRzdGFydFlNb3ZlID0gZmFsc2U7XG5cblx0XHRcdHNlbGYuc3RhcnRNb3ZlKGUsIHJvdyk7XG5cdFx0fSwgc2VsZi5jaGVja1BlcmlvZCk7XG5cdH0sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblx0dGhpcy5tb3ZpbmcsIHRoaXMudG9Sb3csIHRoaXMudG9Sb3dBZnRlcjtcblx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIGZ1bmN0aW9uIChlKSB7XG5cblx0XHR2YXIgaGFsZkNvbCwgZGlmZiwgbW92ZVRvUm93O1xuXG5cdFx0aWYgKHNlbGYubW92aW5nKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdHNlbGYubW92ZUhvdmVyKGUpO1xuXG5cdFx0XHRpZiAoIXN0YXJ0WU1vdmUpIHtcblx0XHRcdFx0c3RhcnRZTW92ZSA9IGUudG91Y2hlc1swXS5wYWdlWTtcblx0XHRcdH1cblxuXHRcdFx0ZGlmZiA9IGUudG91Y2hlc1swXS5wYWdlWSAtIHN0YXJ0WU1vdmU7XG5cblx0XHRcdGlmIChkaWZmID4gMCkge1xuXHRcdFx0XHRpZiAobmV4dFJvdyAmJiBkaWZmIC0gbmV4dFJvd0hlaWdodExhc3QgPiBuZXh0Um93SGVpZ2h0KSB7XG5cdFx0XHRcdFx0bW92ZVRvUm93ID0gbmV4dFJvdztcblxuXHRcdFx0XHRcdGlmIChtb3ZlVG9Sb3cgIT09IHJvdykge1xuXHRcdFx0XHRcdFx0c3RhcnRZTW92ZSA9IGUudG91Y2hlc1swXS5wYWdlWTtcblx0XHRcdFx0XHRcdG1vdmVUb1Jvdy5nZXRFbGVtZW50KCkucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoc2VsZi5wbGFjZWhvbGRlckVsZW1lbnQsIG1vdmVUb1Jvdy5nZXRFbGVtZW50KCkubmV4dFNpYmxpbmcpO1xuXHRcdFx0XHRcdFx0c2VsZi5tb3ZlUm93KG1vdmVUb1JvdywgdHJ1ZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAocHJldlJvdyAmJiAtZGlmZiAtIHByZXZSb3dIZWlnaHRMYXN0ID4gcHJldlJvd0hlaWdodCkge1xuXHRcdFx0XHRcdG1vdmVUb1JvdyA9IHByZXZSb3c7XG5cblx0XHRcdFx0XHRpZiAobW92ZVRvUm93ICE9PSByb3cpIHtcblx0XHRcdFx0XHRcdHN0YXJ0WU1vdmUgPSBlLnRvdWNoZXNbMF0ucGFnZVk7XG5cdFx0XHRcdFx0XHRtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHNlbGYucGxhY2Vob2xkZXJFbGVtZW50LCBtb3ZlVG9Sb3cuZ2V0RWxlbWVudCgpKTtcblx0XHRcdFx0XHRcdHNlbGYubW92ZVJvdyhtb3ZlVG9Sb3csIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKG1vdmVUb1Jvdykge1xuXHRcdFx0XHRjdXJyZW50Um93ID0gbW92ZVRvUm93O1xuXHRcdFx0XHRuZXh0Um93ID0gbW92ZVRvUm93Lm5leHRSb3coKTtcblx0XHRcdFx0bmV4dFJvd0hlaWdodExhc3QgPSBuZXh0Um93SGVpZ2h0O1xuXHRcdFx0XHRuZXh0Um93SGVpZ2h0ID0gbmV4dFJvdyA/IG5leHRSb3cuZ2V0SGVpZ2h0KCkgLyAyIDogMDtcblx0XHRcdFx0cHJldlJvdyA9IG1vdmVUb1Jvdy5wcmV2Um93KCk7XG5cdFx0XHRcdHByZXZSb3dIZWlnaHRMYXN0ID0gcHJldlJvd0hlaWdodDtcblx0XHRcdFx0cHJldlJvd0hlaWdodCA9IHByZXZSb3cgPyBwcmV2Um93LmdldEhlaWdodCgpIC8gMiA6IDA7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGlmIChzZWxmLmNoZWNrVGltZW91dCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHNlbGYuY2hlY2tUaW1lb3V0KTtcblx0XHR9XG5cdFx0aWYgKHNlbGYubW92aW5nKSB7XG5cdFx0XHRzZWxmLmVuZE1vdmUoZSk7XG5cdFx0XHRzZWxmLnRvdWNoTW92ZSA9IGZhbHNlO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuX2JpbmRNb3VzZU1vdmUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRpZiAoKHJvdy50eXBlID09PSBcInJvd1wiIHx8IHJvdy50eXBlID09PSBcImdyb3VwXCIpICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2Vtb3ZlKSB7XG5cdFx0XHRyb3cuZ2V0RWxlbWVudCgpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgcm93Lm1vZHVsZXMubW92ZVJvdy5tb3VzZW1vdmUpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuX3VuYmluZE1vdXNlTW92ZSA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXG5cdHNlbGYudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cygpLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdGlmICgocm93LnR5cGUgPT09IFwicm93XCIgfHwgcm93LnR5cGUgPT09IFwiZ3JvdXBcIikgJiYgcm93Lm1vZHVsZXMubW92ZVJvdy5tb3VzZW1vdmUpIHtcblx0XHRcdHJvdy5nZXRFbGVtZW50KCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCByb3cubW9kdWxlcy5tb3ZlUm93Lm1vdXNlbW92ZSk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5zdGFydE1vdmUgPSBmdW5jdGlvbiAoZSwgcm93KSB7XG5cdHZhciBlbGVtZW50ID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHR0aGlzLnNldFN0YXJ0UG9zaXRpb24oZSwgcm93KTtcblxuXHR0aGlzLm1vdmluZyA9IHJvdztcblxuXHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0Ly9jcmVhdGUgcGxhY2Vob2xkZXJcblx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUud2lkdGggPSByb3cuZ2V0V2lkdGgoKSArIFwicHhcIjtcblx0dGhpcy5wbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gcm93LmdldEhlaWdodCgpICsgXCJweFwiO1xuXG5cdGlmICghdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0ZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLnBsYWNlaG9sZGVyRWxlbWVudCwgZWxlbWVudCk7XG5cdFx0ZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1vdmluZ3Jvdy1zZW5kaW5nXCIpO1xuXHRcdHRoaXMuY29ubmVjdFRvVGFibGVzKHJvdyk7XG5cdH1cblxuXHQvL2NyZWF0ZSBob3ZlciBlbGVtZW50XG5cdHRoaXMuaG92ZXJFbGVtZW50ID0gZWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cdHRoaXMuaG92ZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItbW92aW5nXCIpO1xuXG5cdGlmICh0aGlzLmNvbm5lY3Rpb24pIHtcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuaG92ZXJFbGVtZW50KTtcblx0XHR0aGlzLmhvdmVyRWxlbWVudC5zdHlsZS5sZWZ0ID0gXCIwXCI7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUudG9wID0gXCIwXCI7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUud2lkdGggPSB0aGlzLnRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGggKyBcInB4XCI7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUud2hpdGVTcGFjZSA9IFwibm93cmFwXCI7XG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuXHRcdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcblx0fSBlbHNlIHtcblx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0VGFibGVFbGVtZW50KCkuYXBwZW5kQ2hpbGQodGhpcy5ob3ZlckVsZW1lbnQpO1xuXG5cdFx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUubGVmdCA9IFwiMFwiO1xuXHRcdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLnRvcCA9IFwiMFwiO1xuXG5cdFx0dGhpcy5fYmluZE1vdXNlTW92ZSgpO1xuXHR9XG5cblx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMubW92ZUhvdmVyKTtcblx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLmVuZE1vdmUpO1xuXG5cdHRoaXMubW92ZUhvdmVyKGUpO1xufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLnNldFN0YXJ0UG9zaXRpb24gPSBmdW5jdGlvbiAoZSwgcm93KSB7XG5cdHZhciBwYWdlWCA9IHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCxcblx0ICAgIHBhZ2VZID0gdGhpcy50b3VjaE1vdmUgPyBlLnRvdWNoZXNbMF0ucGFnZVkgOiBlLnBhZ2VZLFxuXHQgICAgZWxlbWVudCxcblx0ICAgIHBvc2l0aW9uO1xuXG5cdGVsZW1lbnQgPSByb3cuZ2V0RWxlbWVudCgpO1xuXHRpZiAodGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0cG9zaXRpb24gPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG5cdFx0dGhpcy5zdGFydFggPSBwb3NpdGlvbi5sZWZ0IC0gcGFnZVggKyB3aW5kb3cucGFnZVhPZmZzZXQ7XG5cdFx0dGhpcy5zdGFydFkgPSBwb3NpdGlvbi50b3AgLSBwYWdlWSArIHdpbmRvdy5wYWdlWU9mZnNldDtcblx0fSBlbHNlIHtcblx0XHR0aGlzLnN0YXJ0WSA9IHBhZ2VZIC0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7XG5cdH1cbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5lbmRNb3ZlID0gZnVuY3Rpb24gKGUpIHtcblx0aWYgKCFlIHx8IGUud2hpY2ggPT09IDEgfHwgdGhpcy50b3VjaE1vdmUpIHtcblx0XHR0aGlzLl91bmJpbmRNb3VzZU1vdmUoKTtcblxuXHRcdGlmICghdGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHR0aGlzLnBsYWNlaG9sZGVyRWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLm1vdmluZy5nZXRFbGVtZW50KCksIHRoaXMucGxhY2Vob2xkZXJFbGVtZW50Lm5leHRTaWJsaW5nKTtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXJFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5wbGFjZWhvbGRlckVsZW1lbnQpO1xuXHRcdH1cblxuXHRcdHRoaXMuaG92ZXJFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5ob3ZlckVsZW1lbnQpO1xuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItYmxvY2stc2VsZWN0XCIpO1xuXG5cdFx0aWYgKHRoaXMudG9Sb3cpIHtcblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5tb3ZlUm93KHRoaXMubW92aW5nLCB0aGlzLnRvUm93LCB0aGlzLnRvUm93QWZ0ZXIpO1xuXHRcdH1cblxuXHRcdHRoaXMubW92aW5nID0gZmFsc2U7XG5cdFx0dGhpcy50b1JvdyA9IGZhbHNlO1xuXHRcdHRoaXMudG9Sb3dBZnRlciA9IGZhbHNlO1xuXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMubW92ZUhvdmVyKTtcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuZW5kTW92ZSk7XG5cblx0XHRpZiAodGhpcy5jb25uZWN0aW9uKSB7XG5cdFx0XHR0aGlzLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci1tb3Zpbmdyb3ctc2VuZGluZ1wiKTtcblx0XHRcdHRoaXMuZGlzY29ubmVjdEZyb21UYWJsZXMoKTtcblx0XHR9XG5cdH1cbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5tb3ZlUm93ID0gZnVuY3Rpb24gKHJvdywgYWZ0ZXIpIHtcblx0dGhpcy50b1JvdyA9IHJvdztcblx0dGhpcy50b1Jvd0FmdGVyID0gYWZ0ZXI7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUubW92ZUhvdmVyID0gZnVuY3Rpb24gKGUpIHtcblx0aWYgKHRoaXMuY29ubmVjdGlvbikge1xuXHRcdHRoaXMubW92ZUhvdmVyQ29ubmVjdGlvbnMuY2FsbCh0aGlzLCBlKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLm1vdmVIb3ZlclRhYmxlLmNhbGwodGhpcywgZSk7XG5cdH1cbn07XG5cbk1vdmVSb3dzLnByb3RvdHlwZS5tb3ZlSG92ZXJUYWJsZSA9IGZ1bmN0aW9uIChlKSB7XG5cdHZhciByb3dIb2xkZXIgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RWxlbWVudCgpLFxuXHQgICAgc2Nyb2xsVG9wID0gcm93SG9sZGVyLnNjcm9sbFRvcCxcblx0ICAgIHlQb3MgPSAodGhpcy50b3VjaE1vdmUgPyBlLnRvdWNoZXNbMF0ucGFnZVkgOiBlLnBhZ2VZKSAtIHJvd0hvbGRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyBzY3JvbGxUb3AsXG5cdCAgICBzY3JvbGxQb3M7XG5cblx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUudG9wID0geVBvcyAtIHRoaXMuc3RhcnRZICsgXCJweFwiO1xufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLm1vdmVIb3ZlckNvbm5lY3Rpb25zID0gZnVuY3Rpb24gKGUpIHtcblx0dGhpcy5ob3ZlckVsZW1lbnQuc3R5bGUubGVmdCA9IHRoaXMuc3RhcnRYICsgKHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VYIDogZS5wYWdlWCkgKyBcInB4XCI7XG5cdHRoaXMuaG92ZXJFbGVtZW50LnN0eWxlLnRvcCA9IHRoaXMuc3RhcnRZICsgKHRoaXMudG91Y2hNb3ZlID8gZS50b3VjaGVzWzBdLnBhZ2VZIDogZS5wYWdlWSkgKyBcInB4XCI7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuZWxlbWVudFJvd0Ryb3AgPSBmdW5jdGlvbiAoZSwgZWxlbWVudCwgcm93KSB7XG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NFbGVtZW50RHJvcCkge1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c0VsZW1lbnREcm9wKGUsIGVsZW1lbnQsIHJvdyA/IHJvdy5nZXRDb21wb25lbnQoKSA6IGZhbHNlKTtcblx0fVxufTtcblxuLy9lc3RhYmxpc2ggY29ubmVjdGlvbiB3aXRoIG90aGVyIHRhYmxlc1xuTW92ZVJvd3MucHJvdG90eXBlLmNvbm5lY3RUb1RhYmxlcyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIF90aGlzNzUgPSB0aGlzO1xuXG5cdHZhciBjb25uZWN0aW9uVGFibGVzO1xuXG5cdGlmICh0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMpIHtcblx0XHRjb25uZWN0aW9uVGFibGVzID0gdGhpcy50YWJsZS5tb2R1bGVzLmNvbW1zLmdldENvbm5lY3Rpb25zKHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc1RhYmxlcyk7XG5cblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW5kaW5nU3RhcnQuY2FsbCh0aGlzLnRhYmxlLCBjb25uZWN0aW9uVGFibGVzKTtcblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5jb21tcy5zZW5kKHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc1RhYmxlcywgXCJtb3ZlUm93XCIsIFwiY29ubmVjdFwiLCB7XG5cdFx0XHRyb3c6IHJvd1xuXHRcdH0pO1xuXHR9XG5cblx0aWYgKHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzKSB7XG5cblx0XHR0aGlzLmNvbm5lY3Rpb25FbGVtZW50cyA9IFtdO1xuXG5cdFx0aWYgKCFBcnJheS5pc0FycmF5KHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzKSkge1xuXHRcdFx0dGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzRWxlbWVudHMgPSBbdGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzRWxlbWVudHNdO1xuXHRcdH1cblxuXHRcdHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc0VsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKHF1ZXJ5KSB7XG5cdFx0XHRpZiAodHlwZW9mIHF1ZXJ5ID09PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRcdF90aGlzNzUuY29ubmVjdGlvbkVsZW1lbnRzID0gX3RoaXM3NS5jb25uZWN0aW9uRWxlbWVudHMuY29uY2F0KEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfdGhpczc1LmNvbm5lY3Rpb25FbGVtZW50cy5wdXNoKHF1ZXJ5KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcblx0XHRcdHZhciBkcm9wRXZlbnQgPSBmdW5jdGlvbiBkcm9wRXZlbnQoZSkge1xuXHRcdFx0XHRfdGhpczc1LmVsZW1lbnRSb3dEcm9wKGUsIGVsZW1lbnQsIF90aGlzNzUubW92aW5nKTtcblx0XHRcdH07XG5cblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgZHJvcEV2ZW50KTtcblx0XHRcdGVsZW1lbnQudGFidWxhdG9yRWxlbWVudERyb3BFdmVudCA9IGRyb3BFdmVudDtcblxuXHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1vdmluZ3Jvdy1yZWNlaXZpbmdcIik7XG5cdFx0fSk7XG5cdH1cbn07XG5cbi8vZGlzY29ubmVjdCBmcm9tIG90aGVyIHRhYmxlc1xuTW92ZVJvd3MucHJvdG90eXBlLmRpc2Nvbm5lY3RGcm9tVGFibGVzID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgY29ubmVjdGlvblRhYmxlcztcblxuXHRpZiAodGhpcy5jb25uZWN0aW9uU2VsZWN0b3JzVGFibGVzKSB7XG5cdFx0Y29ubmVjdGlvblRhYmxlcyA9IHRoaXMudGFibGUubW9kdWxlcy5jb21tcy5nZXRDb25uZWN0aW9ucyh0aGlzLmNvbm5lY3Rpb25TZWxlY3RvcnNUYWJsZXMpO1xuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzU2VuZGluZ1N0b3AuY2FsbCh0aGlzLnRhYmxlLCBjb25uZWN0aW9uVGFibGVzKTtcblxuXHRcdHRoaXMudGFibGUubW9kdWxlcy5jb21tcy5zZW5kKHRoaXMuY29ubmVjdGlvblNlbGVjdG9yc1RhYmxlcywgXCJtb3ZlUm93XCIsIFwiZGlzY29ubmVjdFwiKTtcblx0fVxuXG5cdHRoaXMuY29ubmVjdGlvbkVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItbW92aW5ncm93LXJlY2VpdmluZ1wiKTtcblx0XHRlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGVsZW1lbnQudGFidWxhdG9yRWxlbWVudERyb3BFdmVudCk7XG5cdFx0ZGVsZXRlIGVsZW1lbnQudGFidWxhdG9yRWxlbWVudERyb3BFdmVudDtcblx0fSk7XG59O1xuXG4vL2FjY2VwdCBpbmNvbW1pbmcgY29ubmVjdGlvblxuTW92ZVJvd3MucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAodGFibGUsIHJvdykge1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdGlmICghdGhpcy5jb25uZWN0ZWRUYWJsZSkge1xuXHRcdHRoaXMuY29ubmVjdGVkVGFibGUgPSB0YWJsZTtcblx0XHR0aGlzLmNvbm5lY3RlZFJvdyA9IHJvdztcblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLW1vdmluZ3Jvdy1yZWNlaXZpbmdcIik7XG5cblx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdGlmIChyb3cudHlwZSA9PT0gXCJyb3dcIiAmJiByb3cubW9kdWxlcy5tb3ZlUm93ICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCkge1xuXHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRzZWxmLnRhYmxlUm93RHJvcEV2ZW50ID0gc2VsZi50YWJsZVJvd0Ryb3AuYmluZChzZWxmKTtcblxuXHRcdHNlbGYudGFibGUuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBzZWxmLnRhYmxlUm93RHJvcEV2ZW50KTtcblxuXHRcdHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1JlY2VpdmluZ1N0YXJ0LmNhbGwodGhpcy50YWJsZSwgcm93LCB0YWJsZSk7XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJNb3ZlIFJvdyBFcnJvciAtIFRhYmxlIGNhbm5vdCBhY2NlcHQgY29ubmVjdGlvbiwgYWxyZWFkeSBjb25uZWN0ZWQgdG8gdGFibGU6XCIsIHRoaXMuY29ubmVjdGVkVGFibGUpO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuLy9jbG9zZSBpbmNvbW1pbmcgY29ubmVjdGlvblxuTW92ZVJvd3MucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbiAodGFibGUpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXHRpZiAodGFibGUgPT09IHRoaXMuY29ubmVjdGVkVGFibGUpIHtcblx0XHR0aGlzLmNvbm5lY3RlZFRhYmxlID0gZmFsc2U7XG5cdFx0dGhpcy5jb25uZWN0ZWRSb3cgPSBmYWxzZTtcblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLW1vdmluZ3Jvdy1yZWNlaXZpbmdcIik7XG5cblx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdGlmIChyb3cudHlwZSA9PT0gXCJyb3dcIiAmJiByb3cubW9kdWxlcy5tb3ZlUm93ICYmIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCkge1xuXHRcdFx0XHRyb3cuZ2V0RWxlbWVudCgpLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHJvdy5tb2R1bGVzLm1vdmVSb3cubW91c2V1cCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRzZWxmLnRhYmxlLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgc2VsZi50YWJsZVJvd0Ryb3BFdmVudCk7XG5cblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NSZWNlaXZpbmdTdG9wLmNhbGwodGhpcy50YWJsZSwgdGFibGUpO1xuXHR9IGVsc2Uge1xuXHRcdGNvbnNvbGUud2FybihcIk1vdmUgUm93IEVycm9yIC0gdHJ5aW5nIHRvIGRpc2Nvbm5lY3QgZnJvbSBub24gY29ubmVjdGVkIHRhYmxlXCIpO1xuXHR9XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuZHJvcENvbXBsZXRlID0gZnVuY3Rpb24gKHRhYmxlLCByb3csIHN1Y2Nlc3MpIHtcblx0dmFyIHNlbmRlciA9IGZhbHNlO1xuXG5cdGlmIChzdWNjZXNzKSB7XG5cblx0XHRzd2l0Y2ggKF90eXBlb2YodGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzU2VuZGVyKSkge1xuXHRcdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0XHRzZW5kZXIgPSB0aGlzLnNlbmRlcnNbdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzU2VuZGVyXTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRzZW5kZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW5kZXI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblxuXHRcdGlmIChzZW5kZXIpIHtcblx0XHRcdHNlbmRlci5jYWxsKHRoaXMsIHRoaXMubW92aW5nLmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRhYmxlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1NlbmRlcikge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJNb3ZlciBSb3cgRXJyb3IgLSBubyBtYXRjaGluZyBzZW5kZXIgZm91bmQ6XCIsIHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1NlbmRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzU2VudC5jYWxsKHRoaXMudGFibGUsIHRoaXMubW92aW5nLmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRhYmxlKTtcblx0fSBlbHNlIHtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NTZW50RmFpbGVkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5tb3ZpbmcuZ2V0Q29tcG9uZW50KCksIHJvdyA/IHJvdy5nZXRDb21wb25lbnQoKSA6IHVuZGVmaW5lZCwgdGFibGUpO1xuXHR9XG5cblx0dGhpcy5lbmRNb3ZlKCk7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUudGFibGVSb3dEcm9wID0gZnVuY3Rpb24gKGUsIHJvdykge1xuXHR2YXIgcmVjZWl2ZXIgPSBmYWxzZSxcblx0ICAgIHN1Y2Nlc3MgPSBmYWxzZTtcblxuXHRlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG5cdHN3aXRjaCAoX3R5cGVvZih0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NSZWNlaXZlcikpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRyZWNlaXZlciA9IHRoaXMucmVjZWl2ZXJzW3RoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1JlY2VpdmVyXTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRyZWNlaXZlciA9IHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1JlY2VpdmVyO1xuXHRcdFx0YnJlYWs7XG5cdH1cblxuXHRpZiAocmVjZWl2ZXIpIHtcblx0XHRzdWNjZXNzID0gcmVjZWl2ZXIuY2FsbCh0aGlzLCB0aGlzLmNvbm5lY3RlZFJvdy5nZXRDb21wb25lbnQoKSwgcm93ID8gcm93LmdldENvbXBvbmVudCgpIDogdW5kZWZpbmVkLCB0aGlzLmNvbm5lY3RlZFRhYmxlKTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJNb3ZlciBSb3cgRXJyb3IgLSBubyBtYXRjaGluZyByZWNlaXZlciBmb3VuZDpcIiwgdGhpcy50YWJsZS5vcHRpb25zLm1vdmFibGVSb3dzUmVjZWl2ZXIpO1xuXHR9XG5cblx0aWYgKHN1Y2Nlc3MpIHtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMubW92YWJsZVJvd3NSZWNlaXZlZC5jYWxsKHRoaXMudGFibGUsIHRoaXMuY29ubmVjdGVkUm93LmdldENvbXBvbmVudCgpLCByb3cgPyByb3cuZ2V0Q29tcG9uZW50KCkgOiB1bmRlZmluZWQsIHRoaXMuY29ubmVjdGVkVGFibGUpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5tb3ZhYmxlUm93c1JlY2VpdmVkRmFpbGVkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5jb25uZWN0ZWRSb3cuZ2V0Q29tcG9uZW50KCksIHJvdyA/IHJvdy5nZXRDb21wb25lbnQoKSA6IHVuZGVmaW5lZCwgdGhpcy5jb25uZWN0ZWRUYWJsZSk7XG5cdH1cblxuXHR0aGlzLnRhYmxlLm1vZHVsZXMuY29tbXMuc2VuZCh0aGlzLmNvbm5lY3RlZFRhYmxlLCBcIm1vdmVSb3dcIiwgXCJkcm9wY29tcGxldGVcIiwge1xuXHRcdHJvdzogcm93LFxuXHRcdHN1Y2Nlc3M6IHN1Y2Nlc3Ncblx0fSk7XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUucmVjZWl2ZXJzID0ge1xuXHRpbnNlcnQ6IGZ1bmN0aW9uIGluc2VydChmcm9tUm93LCB0b1JvdywgZnJvbVRhYmxlKSB7XG5cdFx0dGhpcy50YWJsZS5hZGRSb3coZnJvbVJvdy5nZXREYXRhKCksIHVuZGVmaW5lZCwgdG9Sb3cpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdGFkZDogZnVuY3Rpb24gYWRkKGZyb21Sb3csIHRvUm93LCBmcm9tVGFibGUpIHtcblx0XHR0aGlzLnRhYmxlLmFkZFJvdyhmcm9tUm93LmdldERhdGEoKSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0sXG5cblx0dXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoZnJvbVJvdywgdG9Sb3csIGZyb21UYWJsZSkge1xuXHRcdGlmICh0b1Jvdykge1xuXHRcdFx0dG9Sb3cudXBkYXRlKGZyb21Sb3cuZ2V0RGF0YSgpKTtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHRyZXBsYWNlOiBmdW5jdGlvbiByZXBsYWNlKGZyb21Sb3csIHRvUm93LCBmcm9tVGFibGUpIHtcblx0XHRpZiAodG9Sb3cpIHtcblx0XHRcdHRoaXMudGFibGUuYWRkUm93KGZyb21Sb3cuZ2V0RGF0YSgpLCB1bmRlZmluZWQsIHRvUm93KTtcblx0XHRcdHRvUm93LmRlbGV0ZSgpO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5Nb3ZlUm93cy5wcm90b3R5cGUuc2VuZGVycyA9IHtcblx0ZGVsZXRlOiBmdW5jdGlvbiBfZGVsZXRlKGZyb21Sb3csIHRvUm93LCB0b1RhYmxlKSB7XG5cdFx0ZnJvbVJvdy5kZWxldGUoKTtcblx0fVxufTtcblxuTW92ZVJvd3MucHJvdG90eXBlLmNvbW1zUmVjZWl2ZWQgPSBmdW5jdGlvbiAodGFibGUsIGFjdGlvbiwgZGF0YSkge1xuXHRzd2l0Y2ggKGFjdGlvbikge1xuXHRcdGNhc2UgXCJjb25uZWN0XCI6XG5cdFx0XHRyZXR1cm4gdGhpcy5jb25uZWN0KHRhYmxlLCBkYXRhLnJvdyk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJkaXNjb25uZWN0XCI6XG5cdFx0XHRyZXR1cm4gdGhpcy5kaXNjb25uZWN0KHRhYmxlKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcImRyb3Bjb21wbGV0ZVwiOlxuXHRcdFx0cmV0dXJuIHRoaXMuZHJvcENvbXBsZXRlKHRhYmxlLCBkYXRhLnJvdywgZGF0YS5zdWNjZXNzKTtcblx0XHRcdGJyZWFrO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwibW92ZVJvd1wiLCBNb3ZlUm93cyk7XG52YXIgTXV0YXRvciA9IGZ1bmN0aW9uIE11dGF0b3IodGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLmFsbG93ZWRUeXBlcyA9IFtcIlwiLCBcImRhdGFcIiwgXCJlZGl0XCIsIFwiY2xpcGJvYXJkXCJdOyAvL2xpc3Qgb2YgbXVhdGF0aW9uIHR5cGVzXG5cdHRoaXMuZW5hYmxlZCA9IHRydWU7XG59O1xuXG4vL2luaXRpYWxpemUgY29sdW1uIG11dGF0b3Jcbk11dGF0b3IucHJvdG90eXBlLmluaXRpYWxpemVDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIG1hdGNoID0gZmFsc2UsXG5cdCAgICBjb25maWcgPSB7fTtcblxuXHR0aGlzLmFsbG93ZWRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uICh0eXBlKSB7XG5cdFx0dmFyIGtleSA9IFwibXV0YXRvclwiICsgKHR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eXBlLnNsaWNlKDEpKSxcblx0XHQgICAgbXV0YXRvcjtcblxuXHRcdGlmIChjb2x1bW4uZGVmaW5pdGlvbltrZXldKSB7XG5cdFx0XHRtdXRhdG9yID0gc2VsZi5sb29rdXBNdXRhdG9yKGNvbHVtbi5kZWZpbml0aW9uW2tleV0pO1xuXG5cdFx0XHRpZiAobXV0YXRvcikge1xuXHRcdFx0XHRtYXRjaCA9IHRydWU7XG5cblx0XHRcdFx0Y29uZmlnW2tleV0gPSB7XG5cdFx0XHRcdFx0bXV0YXRvcjogbXV0YXRvcixcblx0XHRcdFx0XHRwYXJhbXM6IGNvbHVtbi5kZWZpbml0aW9uW2tleSArIFwiUGFyYW1zXCJdIHx8IHt9XG5cdFx0XHRcdH07XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRpZiAobWF0Y2gpIHtcblx0XHRjb2x1bW4ubW9kdWxlcy5tdXRhdGUgPSBjb25maWc7XG5cdH1cbn07XG5cbk11dGF0b3IucHJvdG90eXBlLmxvb2t1cE11dGF0b3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0dmFyIG11dGF0b3IgPSBmYWxzZTtcblxuXHQvL3NldCBjb2x1bW4gbXV0YXRvclxuXHRzd2l0Y2ggKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodmFsdWUpKSB7XG5cdFx0Y2FzZSBcInN0cmluZ1wiOlxuXHRcdFx0aWYgKHRoaXMubXV0YXRvcnNbdmFsdWVdKSB7XG5cdFx0XHRcdG11dGF0b3IgPSB0aGlzLm11dGF0b3JzW3ZhbHVlXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIk11dGF0b3IgRXJyb3IgLSBObyBzdWNoIG11dGF0b3IgZm91bmQsIGlnbm9yaW5nOiBcIiwgdmFsdWUpO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdG11dGF0b3IgPSB2YWx1ZTtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0cmV0dXJuIG11dGF0b3I7XG59O1xuXG4vL2FwcGx5IG11dGF0b3IgdG8gcm93XG5NdXRhdG9yLnByb3RvdHlwZS50cmFuc2Zvcm1Sb3cgPSBmdW5jdGlvbiAoZGF0YSwgdHlwZSwgdXBkYXRlZERhdGEpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAga2V5ID0gXCJtdXRhdG9yXCIgKyAodHlwZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHR5cGUuc2xpY2UoMSkpLFxuXHQgICAgdmFsdWU7XG5cblx0aWYgKHRoaXMuZW5hYmxlZCkge1xuXG5cdFx0c2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLnRyYXZlcnNlKGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0XHRcdHZhciBtdXRhdG9yLCBwYXJhbXMsIGNvbXBvbmVudDtcblxuXHRcdFx0aWYgKGNvbHVtbi5tb2R1bGVzLm11dGF0ZSkge1xuXHRcdFx0XHRtdXRhdG9yID0gY29sdW1uLm1vZHVsZXMubXV0YXRlW2tleV0gfHwgY29sdW1uLm1vZHVsZXMubXV0YXRlLm11dGF0b3IgfHwgZmFsc2U7XG5cblx0XHRcdFx0aWYgKG11dGF0b3IpIHtcblx0XHRcdFx0XHR2YWx1ZSA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKHR5cGVvZiB1cGRhdGVkRGF0YSAhPT0gXCJ1bmRlZmluZWRcIiA/IHVwZGF0ZWREYXRhIDogZGF0YSk7XG5cblx0XHRcdFx0XHRpZiAodHlwZSA9PSBcImRhdGFcIiB8fCB0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdFx0XHRcdGNvbXBvbmVudCA9IGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHRcdHBhcmFtcyA9IHR5cGVvZiBtdXRhdG9yLnBhcmFtcyA9PT0gXCJmdW5jdGlvblwiID8gbXV0YXRvci5wYXJhbXModmFsdWUsIGRhdGEsIHR5cGUsIGNvbXBvbmVudCkgOiBtdXRhdG9yLnBhcmFtcztcblx0XHRcdFx0XHRcdGNvbHVtbi5zZXRGaWVsZFZhbHVlKGRhdGEsIG11dGF0b3IubXV0YXRvcih2YWx1ZSwgZGF0YSwgdHlwZSwgcGFyYW1zLCBjb21wb25lbnQpKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdHJldHVybiBkYXRhO1xufTtcblxuLy9hcHBseSBtdXRhdG9yIHRvIG5ldyBjZWxsIHZhbHVlXG5NdXRhdG9yLnByb3RvdHlwZS50cmFuc2Zvcm1DZWxsID0gZnVuY3Rpb24gKGNlbGwsIHZhbHVlKSB7XG5cdHZhciBtdXRhdG9yID0gY2VsbC5jb2x1bW4ubW9kdWxlcy5tdXRhdGUubXV0YXRvckVkaXQgfHwgY2VsbC5jb2x1bW4ubW9kdWxlcy5tdXRhdGUubXV0YXRvciB8fCBmYWxzZSxcblx0ICAgIHRlbXBEYXRhID0ge307XG5cblx0aWYgKG11dGF0b3IpIHtcblx0XHR0ZW1wRGF0YSA9IE9iamVjdC5hc3NpZ24odGVtcERhdGEsIGNlbGwucm93LmdldERhdGEoKSk7XG5cdFx0Y2VsbC5jb2x1bW4uc2V0RmllbGRWYWx1ZSh0ZW1wRGF0YSwgdmFsdWUpO1xuXHRcdHJldHVybiBtdXRhdG9yLm11dGF0b3IodmFsdWUsIHRlbXBEYXRhLCBcImVkaXRcIiwgbXV0YXRvci5wYXJhbXMsIGNlbGwuZ2V0Q29tcG9uZW50KCkpO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiB2YWx1ZTtcblx0fVxufTtcblxuTXV0YXRvci5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmVuYWJsZWQgPSB0cnVlO1xufTtcblxuTXV0YXRvci5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5lbmFibGVkID0gZmFsc2U7XG59O1xuXG4vL2RlZmF1bHQgbXV0YXRvcnNcbk11dGF0b3IucHJvdG90eXBlLm11dGF0b3JzID0ge307XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJtdXRhdG9yXCIsIE11dGF0b3IpO1xudmFyIFBhZ2UgPSBmdW5jdGlvbiBQYWdlKHRhYmxlKSB7XG5cblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXG5cdHRoaXMubW9kZSA9IFwibG9jYWxcIjtcblx0dGhpcy5wcm9ncmVzc2l2ZUxvYWQgPSBmYWxzZTtcblxuXHR0aGlzLnNpemUgPSAwO1xuXHR0aGlzLnBhZ2UgPSAxO1xuXHR0aGlzLmNvdW50ID0gNTtcblx0dGhpcy5tYXggPSAxO1xuXG5cdHRoaXMuZGlzcGxheUluZGV4ID0gMDsgLy9pbmRleCBpbiBkaXNwbGF5IHBpcGVsaW5lXG5cblx0dGhpcy5pbml0aWFsTG9hZCA9IHRydWU7XG5cblx0dGhpcy5wYWdlU2l6ZXMgPSBbXTtcblxuXHR0aGlzLmRhdGFSZWNlaXZlZE5hbWVzID0ge307XG5cdHRoaXMuZGF0YVNlbnROYW1lcyA9IHt9O1xuXG5cdHRoaXMuY3JlYXRlRWxlbWVudHMoKTtcbn07XG5cblBhZ2UucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuXG5cdHZhciBidXR0b247XG5cblx0dGhpcy5lbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2luYXRvclwiKTtcblxuXHR0aGlzLnBhZ2VzRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHR0aGlzLnBhZ2VzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2VzXCIpO1xuXG5cdGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2VcIik7XG5cdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiYnV0dG9uXCIpO1xuXHRidXR0b24uc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImJ1dHRvblwiKTtcblx0YnV0dG9uLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJcIik7XG5cdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCBcIlwiKTtcblxuXHR0aGlzLmZpcnN0QnV0ID0gYnV0dG9uLmNsb25lTm9kZSh0cnVlKTtcblx0dGhpcy5maXJzdEJ1dC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXBhZ2VcIiwgXCJmaXJzdFwiKTtcblxuXHR0aGlzLnByZXZCdXQgPSBidXR0b24uY2xvbmVOb2RlKHRydWUpO1xuXHR0aGlzLnByZXZCdXQuc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIFwicHJldlwiKTtcblxuXHR0aGlzLm5leHRCdXQgPSBidXR0b24uY2xvbmVOb2RlKHRydWUpO1xuXHR0aGlzLm5leHRCdXQuc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIFwibmV4dFwiKTtcblxuXHR0aGlzLmxhc3RCdXQgPSBidXR0b24uY2xvbmVOb2RlKHRydWUpO1xuXHR0aGlzLmxhc3RCdXQuc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIFwibGFzdFwiKTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplU2VsZWN0b3IpIHtcblx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcblx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcGFnZS1zaXplXCIpO1xuXHR9XG59O1xuXG5QYWdlLnByb3RvdHlwZS5nZW5lcmF0ZVBhZ2VTaXplU2VsZWN0TGlzdCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIF90aGlzNzYgPSB0aGlzO1xuXG5cdHZhciBwYWdlU2l6ZXMgPSBbXTtcblxuXHRpZiAodGhpcy5wYWdlU2l6ZVNlbGVjdCkge1xuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkodGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplU2VsZWN0b3IpKSB7XG5cdFx0XHRwYWdlU2l6ZXMgPSB0aGlzLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvblNpemVTZWxlY3Rvcjtcblx0XHRcdHRoaXMucGFnZVNpemVzID0gcGFnZVNpemVzO1xuXG5cdFx0XHRpZiAodGhpcy5wYWdlU2l6ZXMuaW5kZXhPZih0aGlzLnNpemUpID09IC0xKSB7XG5cdFx0XHRcdHBhZ2VTaXplcy51bnNoaWZ0KHRoaXMuc2l6ZSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0aWYgKHRoaXMucGFnZVNpemVzLmluZGV4T2YodGhpcy5zaXplKSA9PSAtMSkge1xuXHRcdFx0XHRwYWdlU2l6ZXMgPSBbXTtcblxuXHRcdFx0XHRmb3IgKHZhciBfaTE0ID0gMTsgX2kxNCA8IDU7IF9pMTQrKykge1xuXHRcdFx0XHRcdHBhZ2VTaXplcy5wdXNoKHRoaXMuc2l6ZSAqIF9pMTQpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5wYWdlU2l6ZXMgPSBwYWdlU2l6ZXM7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwYWdlU2l6ZXMgPSB0aGlzLnBhZ2VTaXplcztcblx0XHRcdH1cblx0XHR9XG5cblx0XHR3aGlsZSAodGhpcy5wYWdlU2l6ZVNlbGVjdC5maXJzdENoaWxkKSB7XG5cdFx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0LnJlbW92ZUNoaWxkKHRoaXMucGFnZVNpemVTZWxlY3QuZmlyc3RDaGlsZCk7XG5cdFx0fXBhZ2VTaXplcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHR2YXIgaXRlbUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcblx0XHRcdGl0ZW1FbC52YWx1ZSA9IGl0ZW07XG5cblx0XHRcdGlmIChpdGVtID09PSB0cnVlKSB7XG5cdFx0XHRcdF90aGlzNzYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxhbGxcIiwgZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRcdFx0aXRlbUVsLmlubmVySFRNTCA9IHZhbHVlO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGl0ZW1FbC5pbm5lckhUTUwgPSBpdGVtO1xuXHRcdFx0fVxuXG5cdFx0XHRfdGhpczc2LnBhZ2VTaXplU2VsZWN0LmFwcGVuZENoaWxkKGl0ZW1FbCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnBhZ2VTaXplU2VsZWN0LnZhbHVlID0gdGhpcy5zaXplO1xuXHR9XG59O1xuXG4vL3NldHVwIHBhZ2VpbmF0aW9uXG5QYWdlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKGhpZGRlbikge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBwYWdlU2VsZWN0TGFiZWwsXG5cdCAgICB0ZXN0RWxSb3csXG5cdCAgICB0ZXN0RWxDZWxsO1xuXG5cdC8vdXBkYXRlIHBhcmFtIG5hbWVzXG5cdHRoaXMuZGF0YVNlbnROYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMucGFnaW5hdGlvbkRhdGFTZW50TmFtZXMpO1xuXHR0aGlzLmRhdGFTZW50TmFtZXMgPSBPYmplY3QuYXNzaWduKHRoaXMuZGF0YVNlbnROYW1lcywgdGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25EYXRhU2VudCk7XG5cblx0dGhpcy5kYXRhUmVjZWl2ZWROYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMucGFnaW5hdGlvbkRhdGFSZWNlaXZlZE5hbWVzKTtcblx0dGhpcy5kYXRhUmVjZWl2ZWROYW1lcyA9IE9iamVjdC5hc3NpZ24odGhpcy5kYXRhUmVjZWl2ZWROYW1lcywgdGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25EYXRhUmVjZWl2ZWQpO1xuXG5cdC8vYnVpbGQgcGFnaW5hdGlvbiBlbGVtZW50XG5cblx0Ly9iaW5kIGxvY2FsaXphdGlvbnNcblx0c2VsZi50YWJsZS5tb2R1bGVzLmxvY2FsaXplLmJpbmQoXCJwYWdpbmF0aW9ufGZpcnN0XCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdHNlbGYuZmlyc3RCdXQuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXG5cdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxmaXJzdF90aXRsZVwiLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRzZWxmLmZpcnN0QnV0LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUpO1xuXHRcdHNlbGYuZmlyc3RCdXQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHR9KTtcblxuXHRzZWxmLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcInBhZ2luYXRpb258cHJldlwiLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRzZWxmLnByZXZCdXQuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXG5cdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxwcmV2X3RpdGxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdHNlbGYucHJldkJ1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblx0XHRzZWxmLnByZXZCdXQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHR9KTtcblxuXHRzZWxmLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcInBhZ2luYXRpb258bmV4dFwiLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRzZWxmLm5leHRCdXQuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXG5cdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxuZXh0X3RpdGxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdHNlbGYubmV4dEJ1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblx0XHRzZWxmLm5leHRCdXQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHR9KTtcblxuXHRzZWxmLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcInBhZ2luYXRpb258bGFzdFwiLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0XHRzZWxmLmxhc3RCdXQuaW5uZXJIVE1MID0gdmFsdWU7XG5cdH0pO1xuXG5cdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxsYXN0X3RpdGxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdHNlbGYubGFzdEJ1dC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlKTtcblx0XHRzZWxmLmxhc3RCdXQuc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUpO1xuXHR9KTtcblxuXHQvL2NsaWNrIGJpbmRpbmdzXG5cdHNlbGYuZmlyc3RCdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRzZWxmLnNldFBhZ2UoMSkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge30pO1xuXHR9KTtcblxuXHRzZWxmLnByZXZCdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcblx0XHRzZWxmLnByZXZpb3VzUGFnZSgpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTtcblx0fSk7XG5cblx0c2VsZi5uZXh0QnV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG5cdFx0c2VsZi5uZXh0UGFnZSgpLnRoZW4oZnVuY3Rpb24gKCkge30pLmNhdGNoKGZ1bmN0aW9uICgpIHt9KTtcblx0fSk7XG5cblx0c2VsZi5sYXN0QnV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG5cdFx0c2VsZi5zZXRQYWdlKHNlbGYubWF4KS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdH0pO1xuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkVsZW1lbnQpIHtcblx0XHRzZWxmLmVsZW1lbnQgPSBzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkVsZW1lbnQ7XG5cdH1cblxuXHRpZiAodGhpcy5wYWdlU2l6ZVNlbGVjdCkge1xuXHRcdHBhZ2VTZWxlY3RMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcblxuXHRcdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxwYWdlX3NpemVcIiwgZnVuY3Rpb24gKHZhbHVlKSB7XG5cdFx0XHRzZWxmLnBhZ2VTaXplU2VsZWN0LnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgdmFsdWUpO1xuXHRcdFx0c2VsZi5wYWdlU2l6ZVNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJ0aXRsZVwiLCB2YWx1ZSk7XG5cdFx0XHRwYWdlU2VsZWN0TGFiZWwuaW5uZXJIVE1MID0gdmFsdWU7XG5cdFx0fSk7XG5cblx0XHRzZWxmLmVsZW1lbnQuYXBwZW5kQ2hpbGQocGFnZVNlbGVjdExhYmVsKTtcblx0XHRzZWxmLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc2VsZi5wYWdlU2l6ZVNlbGVjdCk7XG5cblx0XHRzZWxmLnBhZ2VTaXplU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdHNlbGYuc2V0UGFnZVNpemUoc2VsZi5wYWdlU2l6ZVNlbGVjdC52YWx1ZSA9PSBcInRydWVcIiA/IHRydWUgOiBzZWxmLnBhZ2VTaXplU2VsZWN0LnZhbHVlKTtcblx0XHRcdHNlbGYuc2V0UGFnZSgxKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvL2FwcGVuZCB0byBET01cblx0c2VsZi5lbGVtZW50LmFwcGVuZENoaWxkKHNlbGYuZmlyc3RCdXQpO1xuXHRzZWxmLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc2VsZi5wcmV2QnV0KTtcblx0c2VsZi5lbGVtZW50LmFwcGVuZENoaWxkKHNlbGYucGFnZXNFbGVtZW50KTtcblx0c2VsZi5lbGVtZW50LmFwcGVuZENoaWxkKHNlbGYubmV4dEJ1dCk7XG5cdHNlbGYuZWxlbWVudC5hcHBlbmRDaGlsZChzZWxmLmxhc3RCdXQpO1xuXG5cdGlmICghc2VsZi50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25FbGVtZW50ICYmICFoaWRkZW4pIHtcblx0XHRzZWxmLnRhYmxlLmZvb3Rlck1hbmFnZXIuYXBwZW5kKHNlbGYuZWxlbWVudCwgc2VsZik7XG5cdH1cblxuXHQvL3NldCBkZWZhdWx0IHZhbHVlc1xuXHRzZWxmLm1vZGUgPSBzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbjtcblxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplKSB7XG5cdFx0c2VsZi5zaXplID0gc2VsZi50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplO1xuXHR9IGVsc2Uge1xuXHRcdHRlc3RFbFJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGVzdEVsUm93LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itcm93XCIpO1xuXHRcdHRlc3RFbFJvdy5zdHlsZS52aXNpYmlsaXR5ID0gaGlkZGVuO1xuXG5cdFx0dGVzdEVsQ2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGVzdEVsQ2VsbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLWNlbGxcIik7XG5cdFx0dGVzdEVsQ2VsbC5pbm5lckhUTUwgPSBcIlBhZ2UgUm93IFRlc3RcIjtcblxuXHRcdHRlc3RFbFJvdy5hcHBlbmRDaGlsZCh0ZXN0RWxDZWxsKTtcblxuXHRcdHNlbGYudGFibGUucm93TWFuYWdlci5nZXRUYWJsZUVsZW1lbnQoKS5hcHBlbmRDaGlsZCh0ZXN0RWxSb3cpO1xuXG5cdFx0c2VsZi5zaXplID0gTWF0aC5mbG9vcihzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RWxlbWVudCgpLmNsaWVudEhlaWdodCAvIHRlc3RFbFJvdy5vZmZzZXRIZWlnaHQpO1xuXG5cdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldFRhYmxlRWxlbWVudCgpLnJlbW92ZUNoaWxkKHRlc3RFbFJvdyk7XG5cdH1cblxuXHQvLyBzZWxmLnBhZ2UgPSBzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkluaXRpYWxQYWdlIHx8IDE7XG5cdHNlbGYuY291bnQgPSBzZWxmLnRhYmxlLm9wdGlvbnMucGFnaW5hdGlvbkJ1dHRvbkNvdW50O1xuXG5cdHNlbGYuZ2VuZXJhdGVQYWdlU2l6ZVNlbGVjdExpc3QoKTtcbn07XG5cblBhZ2UucHJvdG90eXBlLmluaXRpYWxpemVQcm9ncmVzc2l2ZSA9IGZ1bmN0aW9uIChtb2RlKSB7XG5cdHRoaXMuaW5pdGlhbGl6ZSh0cnVlKTtcblx0dGhpcy5tb2RlID0gXCJwcm9ncmVzc2l2ZV9cIiArIG1vZGU7XG5cdHRoaXMucHJvZ3Jlc3NpdmVMb2FkID0gdHJ1ZTtcbn07XG5cblBhZ2UucHJvdG90eXBlLnNldERpc3BsYXlJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHR0aGlzLmRpc3BsYXlJbmRleCA9IGluZGV4O1xufTtcblxuUGFnZS5wcm90b3R5cGUuZ2V0RGlzcGxheUluZGV4ID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gdGhpcy5kaXNwbGF5SW5kZXg7XG59O1xuXG4vL2NhbGN1bGF0ZSBtYXhpbXVtIHBhZ2UgZnJvbSBudW1iZXIgb2Ygcm93c1xuUGFnZS5wcm90b3R5cGUuc2V0TWF4Um93cyA9IGZ1bmN0aW9uIChyb3dDb3VudCkge1xuXHRpZiAoIXJvd0NvdW50KSB7XG5cdFx0dGhpcy5tYXggPSAxO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMubWF4ID0gdGhpcy5zaXplID09PSB0cnVlID8gMSA6IE1hdGguY2VpbChyb3dDb3VudCAvIHRoaXMuc2l6ZSk7XG5cdH1cblxuXHRpZiAodGhpcy5wYWdlID4gdGhpcy5tYXgpIHtcblx0XHR0aGlzLnBhZ2UgPSB0aGlzLm1heDtcblx0fVxufTtcblxuLy9yZXNldCB0byBmaXJzdCBwYWdlIHdpdGhvdXQgdHJpZ2dlcmluZyBhY3Rpb25cblBhZ2UucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKGZvcmNlLCBjb2x1bW5zQ2hhbmdlZCkge1xuXHRpZiAodGhpcy5tb2RlID09IFwibG9jYWxcIiB8fCBmb3JjZSkge1xuXHRcdHRoaXMucGFnZSA9IDE7XG5cdH1cblxuXHRpZiAoY29sdW1uc0NoYW5nZWQpIHtcblx0XHR0aGlzLmluaXRpYWxMb2FkID0gdHJ1ZTtcblx0fVxuXG5cdHJldHVybiB0cnVlO1xufTtcblxuLy9zZXQgdGhlIG1heG11bSBwYWdlXG5QYWdlLnByb3RvdHlwZS5zZXRNYXhQYWdlID0gZnVuY3Rpb24gKG1heCkge1xuXG5cdG1heCA9IHBhcnNlSW50KG1heCk7XG5cblx0dGhpcy5tYXggPSBtYXggfHwgMTtcblxuXHRpZiAodGhpcy5wYWdlID4gdGhpcy5tYXgpIHtcblx0XHR0aGlzLnBhZ2UgPSB0aGlzLm1heDtcblx0XHR0aGlzLnRyaWdnZXIoKTtcblx0fVxufTtcblxuLy9zZXQgY3VycmVudCBwYWdlIG51bWJlclxuUGFnZS5wcm90b3R5cGUuc2V0UGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG5cdHZhciBfdGhpczc3ID0gdGhpcztcblxuXHR2YXIgc2VsZiA9IHRoaXM7XG5cblx0c3dpdGNoIChwYWdlKSB7XG5cdFx0Y2FzZSBcImZpcnN0XCI6XG5cdFx0XHRyZXR1cm4gdGhpcy5zZXRQYWdlKDEpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwicHJldlwiOlxuXHRcdFx0cmV0dXJuIHRoaXMucHJldmlvdXNQYWdlKCk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJuZXh0XCI6XG5cdFx0XHRyZXR1cm4gdGhpcy5uZXh0UGFnZSgpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwibGFzdFwiOlxuXHRcdFx0cmV0dXJuIHRoaXMuc2V0UGFnZSh0aGlzLm1heCk7XG5cdFx0XHRicmVhaztcblx0fVxuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblx0XHRwYWdlID0gcGFyc2VJbnQocGFnZSk7XG5cblx0XHRpZiAocGFnZSA+IDAgJiYgcGFnZSA8PSBfdGhpczc3Lm1heCB8fCBfdGhpczc3Lm1vZGUgIT09IFwibG9jYWxcIikge1xuXHRcdFx0X3RoaXM3Ny5wYWdlID0gcGFnZTtcblx0XHRcdF90aGlzNzcudHJpZ2dlcigpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJlamVjdCgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgJiYgc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiBzZWxmLnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2UuY29uZmlnLnBhZ2UpIHtcblx0XHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJwYWdlXCIpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gUmVxdWVzdGVkIHBhZ2UgaXMgb3V0IG9mIHJhbmdlIG9mIDEgLSBcIiArIF90aGlzNzcubWF4ICsgXCI6XCIsIHBhZ2UpO1xuXHRcdFx0cmVqZWN0KCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cblBhZ2UucHJvdG90eXBlLnNldFBhZ2VUb1JvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIF90aGlzNzggPSB0aGlzO1xuXG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblx0XHR2YXIgcm93cyA9IF90aGlzNzgudGFibGUucm93TWFuYWdlci5nZXREaXNwbGF5Um93cyhfdGhpczc4LmRpc3BsYXlJbmRleCAtIDEpO1xuXHRcdHZhciBpbmRleCA9IHJvd3MuaW5kZXhPZihyb3cpO1xuXG5cdFx0aWYgKGluZGV4ID4gLTEpIHtcblx0XHRcdHZhciBwYWdlID0gX3RoaXM3OC5zaXplID09PSB0cnVlID8gMSA6IE1hdGguY2VpbCgoaW5kZXggKyAxKSAvIF90aGlzNzguc2l6ZSk7XG5cblx0XHRcdF90aGlzNzguc2V0UGFnZShwYWdlKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZWplY3QoKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gUmVxdWVzdGVkIHJvdyBpcyBub3QgdmlzaWJsZVwiKTtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5QYWdlLnByb3RvdHlwZS5zZXRQYWdlU2l6ZSA9IGZ1bmN0aW9uIChzaXplKSB7XG5cdGlmIChzaXplICE9PSB0cnVlKSB7XG5cdFx0c2l6ZSA9IHBhcnNlSW50KHNpemUpO1xuXHR9XG5cblx0aWYgKHNpemUgPiAwKSB7XG5cdFx0dGhpcy5zaXplID0gc2l6ZTtcblx0fVxuXG5cdGlmICh0aGlzLnBhZ2VTaXplU2VsZWN0KSB7XG5cdFx0Ly8gdGhpcy5wYWdlU2l6ZVNlbGVjdC52YWx1ZSA9IHNpemU7XG5cdFx0dGhpcy5nZW5lcmF0ZVBhZ2VTaXplU2VsZWN0TGlzdCgpO1xuXHR9XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcucGFnZSkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5zYXZlKFwicGFnZVwiKTtcblx0fVxufTtcblxuLy9zZXR1cCB0aGUgcGFnaW5hdGlvbiBidXR0b25zXG5QYWdlLnByb3RvdHlwZS5fc2V0UGFnZUJ1dHRvbnMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHR2YXIgbGVmdFNpemUgPSBNYXRoLmZsb29yKCh0aGlzLmNvdW50IC0gMSkgLyAyKTtcblx0dmFyIHJpZ2h0U2l6ZSA9IE1hdGguY2VpbCgodGhpcy5jb3VudCAtIDEpIC8gMik7XG5cdHZhciBtaW4gPSB0aGlzLm1heCAtIHRoaXMucGFnZSArIGxlZnRTaXplICsgMSA8IHRoaXMuY291bnQgPyB0aGlzLm1heCAtIHRoaXMuY291bnQgKyAxIDogTWF0aC5tYXgodGhpcy5wYWdlIC0gbGVmdFNpemUsIDEpO1xuXHR2YXIgbWF4ID0gdGhpcy5wYWdlIDw9IHJpZ2h0U2l6ZSA/IE1hdGgubWluKHRoaXMuY291bnQsIHRoaXMubWF4KSA6IE1hdGgubWluKHRoaXMucGFnZSArIHJpZ2h0U2l6ZSwgdGhpcy5tYXgpO1xuXG5cdHdoaWxlIChzZWxmLnBhZ2VzRWxlbWVudC5maXJzdENoaWxkKSB7XG5cdFx0c2VsZi5wYWdlc0VsZW1lbnQucmVtb3ZlQ2hpbGQoc2VsZi5wYWdlc0VsZW1lbnQuZmlyc3RDaGlsZCk7XG5cdH1pZiAoc2VsZi5wYWdlID09IDEpIHtcblx0XHRzZWxmLmZpcnN0QnV0LmRpc2FibGVkID0gdHJ1ZTtcblx0XHRzZWxmLnByZXZCdXQuZGlzYWJsZWQgPSB0cnVlO1xuXHR9IGVsc2Uge1xuXHRcdHNlbGYuZmlyc3RCdXQuZGlzYWJsZWQgPSBmYWxzZTtcblx0XHRzZWxmLnByZXZCdXQuZGlzYWJsZWQgPSBmYWxzZTtcblx0fVxuXG5cdGlmIChzZWxmLnBhZ2UgPT0gc2VsZi5tYXgpIHtcblx0XHRzZWxmLmxhc3RCdXQuZGlzYWJsZWQgPSB0cnVlO1xuXHRcdHNlbGYubmV4dEJ1dC5kaXNhYmxlZCA9IHRydWU7XG5cdH0gZWxzZSB7XG5cdFx0c2VsZi5sYXN0QnV0LmRpc2FibGVkID0gZmFsc2U7XG5cdFx0c2VsZi5uZXh0QnV0LmRpc2FibGVkID0gZmFsc2U7XG5cdH1cblxuXHRmb3IgKHZhciBfaTE1ID0gbWluOyBfaTE1IDw9IG1heDsgX2kxNSsrKSB7XG5cdFx0aWYgKF9pMTUgPiAwICYmIF9pMTUgPD0gc2VsZi5tYXgpIHtcblx0XHRcdHNlbGYucGFnZXNFbGVtZW50LmFwcGVuZENoaWxkKHNlbGYuX2dlbmVyYXRlUGFnZUJ1dHRvbihfaTE1KSk7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5mb290ZXJSZWRyYXcoKTtcbn07XG5cblBhZ2UucHJvdG90eXBlLl9nZW5lcmF0ZVBhZ2VCdXR0b24gPSBmdW5jdGlvbiAocGFnZSkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuXG5cdGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXBhZ2VcIik7XG5cdGlmIChwYWdlID09IHNlbGYucGFnZSkge1xuXHRcdGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuXHR9XG5cblx0YnV0dG9uLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJidXR0b25cIik7XG5cdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYnV0dG9uXCIpO1xuXG5cdHNlbGYudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5iaW5kKFwicGFnaW5hdGlvbnxwYWdlX3RpdGxlXCIsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHRcdGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIHZhbHVlICsgXCIgXCIgKyBwYWdlKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwidGl0bGVcIiwgdmFsdWUgKyBcIiBcIiArIHBhZ2UpO1xuXHR9KTtcblxuXHRidXR0b24uc2V0QXR0cmlidXRlKFwiZGF0YS1wYWdlXCIsIHBhZ2UpO1xuXHRidXR0b24udGV4dENvbnRlbnQgPSBwYWdlO1xuXG5cdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRzZWxmLnNldFBhZ2UocGFnZSkudGhlbihmdW5jdGlvbiAoKSB7fSkuY2F0Y2goZnVuY3Rpb24gKCkge30pO1xuXHR9KTtcblxuXHRyZXR1cm4gYnV0dG9uO1xufTtcblxuLy9wcmV2aW91cyBwYWdlXG5QYWdlLnByb3RvdHlwZS5wcmV2aW91c1BhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczc5ID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmIChfdGhpczc5LnBhZ2UgPiAxKSB7XG5cdFx0XHRfdGhpczc5LnBhZ2UtLTtcblx0XHRcdF90aGlzNzkudHJpZ2dlcigpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9KS5jYXRjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdHJlamVjdCgpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGlmIChfdGhpczc5LnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UgJiYgX3RoaXM3OS50YWJsZS5tb2RFeGlzdHMoXCJwZXJzaXN0ZW5jZVwiLCB0cnVlKSAmJiBfdGhpczc5LnRhYmxlLm1vZHVsZXMucGVyc2lzdGVuY2UuY29uZmlnLnBhZ2UpIHtcblx0XHRcdFx0X3RoaXM3OS50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJwYWdlXCIpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gUHJldmlvdXMgcGFnZSB3b3VsZCBiZSBsZXNzIHRoYW4gcGFnZSAxOlwiLCAwKTtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vL25leHQgcGFnZVxuUGFnZS5wcm90b3R5cGUubmV4dFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBfdGhpczgwID0gdGhpcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmIChfdGhpczgwLnBhZ2UgPCBfdGhpczgwLm1heCkge1xuXHRcdFx0X3RoaXM4MC5wYWdlKys7XG5cdFx0XHRfdGhpczgwLnRyaWdnZXIoKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRyZWplY3QoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHRpZiAoX3RoaXM4MC50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlICYmIF90aGlzODAudGFibGUubW9kRXhpc3RzKFwicGVyc2lzdGVuY2VcIiwgdHJ1ZSkgJiYgX3RoaXM4MC50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLmNvbmZpZy5wYWdlKSB7XG5cdFx0XHRcdF90aGlzODAudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5zYXZlKFwicGFnZVwiKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCFfdGhpczgwLnByb2dyZXNzaXZlTG9hZCkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJQYWdpbmF0aW9uIEVycm9yIC0gTmV4dCBwYWdlIHdvdWxkIGJlIGdyZWF0ZXIgdGhhbiBtYXhpbXVtIHBhZ2Ugb2YgXCIgKyBfdGhpczgwLm1heCArIFwiOlwiLCBfdGhpczgwLm1heCArIDEpO1xuXHRcdFx0fVxuXHRcdFx0cmVqZWN0KCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8vcmV0dXJuIGN1cnJlbnQgcGFnZSBudW1iZXJcblBhZ2UucHJvdG90eXBlLmdldFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLnBhZ2U7XG59O1xuXG4vL3JldHVybiBtYXggcGFnZSBudW1iZXJcblBhZ2UucHJvdG90eXBlLmdldFBhZ2VNYXggPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLm1heDtcbn07XG5cblBhZ2UucHJvdG90eXBlLmdldFBhZ2VTaXplID0gZnVuY3Rpb24gKHNpemUpIHtcblx0cmV0dXJuIHRoaXMuc2l6ZTtcbn07XG5cblBhZ2UucHJvdG90eXBlLmdldE1vZGUgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB0aGlzLm1vZGU7XG59O1xuXG4vL3JldHVybiBhcHByb3ByaWF0ZSByb3dzIGZvciBjdXJyZW50IHBhZ2VcblBhZ2UucHJvdG90eXBlLmdldFJvd3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHR2YXIgb3V0cHV0LCBzdGFydCwgZW5kO1xuXG5cdGlmICh0aGlzLm1vZGUgPT0gXCJsb2NhbFwiKSB7XG5cdFx0b3V0cHV0ID0gW107XG5cblx0XHRpZiAodGhpcy5zaXplID09PSB0cnVlKSB7XG5cdFx0XHRzdGFydCA9IDA7XG5cdFx0XHRlbmQgPSBkYXRhLmxlbmd0aDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3RhcnQgPSB0aGlzLnNpemUgKiAodGhpcy5wYWdlIC0gMSk7XG5cdFx0XHRlbmQgPSBzdGFydCArIHBhcnNlSW50KHRoaXMuc2l6ZSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5fc2V0UGFnZUJ1dHRvbnMoKTtcblxuXHRcdGZvciAodmFyIF9pMTYgPSBzdGFydDsgX2kxNiA8IGVuZDsgX2kxNisrKSB7XG5cdFx0XHRpZiAoZGF0YVtfaTE2XSkge1xuXHRcdFx0XHRvdXRwdXQucHVzaChkYXRhW19pMTZdKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gb3V0cHV0O1xuXHR9IGVsc2Uge1xuXG5cdFx0dGhpcy5fc2V0UGFnZUJ1dHRvbnMoKTtcblxuXHRcdHJldHVybiBkYXRhLnNsaWNlKDApO1xuXHR9XG59O1xuXG5QYWdlLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXM4MSA9IHRoaXM7XG5cblx0dmFyIGxlZnQ7XG5cblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuXHRcdHN3aXRjaCAoX3RoaXM4MS5tb2RlKSB7XG5cdFx0XHRjYXNlIFwibG9jYWxcIjpcblx0XHRcdFx0bGVmdCA9IF90aGlzODEudGFibGUucm93TWFuYWdlci5zY3JvbGxMZWZ0O1xuXG5cdFx0XHRcdF90aGlzODEudGFibGUucm93TWFuYWdlci5yZWZyZXNoQWN0aXZlRGF0YShcInBhZ2VcIik7XG5cdFx0XHRcdF90aGlzODEudGFibGUucm93TWFuYWdlci5zY3JvbGxIb3Jpem9udGFsKGxlZnQpO1xuXG5cdFx0XHRcdF90aGlzODEudGFibGUub3B0aW9ucy5wYWdlTG9hZGVkLmNhbGwoX3RoaXM4MS50YWJsZSwgX3RoaXM4MS5nZXRQYWdlKCkpO1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwicmVtb3RlXCI6XG5cdFx0XHRjYXNlIFwicHJvZ3Jlc3NpdmVfbG9hZFwiOlxuXHRcdFx0Y2FzZSBcInByb2dyZXNzaXZlX3Njcm9sbFwiOlxuXHRcdFx0XHRfdGhpczgxLnRhYmxlLm1vZHVsZXMuYWpheC5ibG9ja0FjdGl2ZVJlcXVlc3QoKTtcblx0XHRcdFx0X3RoaXM4MS5fZ2V0UmVtb3RlUGFnZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHJlc29sdmUoKTtcblx0XHRcdFx0fSkuY2F0Y2goZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdHJlamVjdCgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIlBhZ2luYXRpb24gRXJyb3IgLSBubyBzdWNoIHBhZ2luYXRpb24gbW9kZTpcIiwgX3RoaXM4MS5tb2RlKTtcblx0XHRcdFx0cmVqZWN0KCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cblBhZ2UucHJvdG90eXBlLl9nZXRSZW1vdGVQYWdlID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgX3RoaXM4MiA9IHRoaXM7XG5cblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb2xkUGFyYW1zLFxuXHQgICAgcGFnZVBhcmFtcztcblxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG5cdFx0aWYgKCFzZWxmLnRhYmxlLm1vZEV4aXN0cyhcImFqYXhcIiwgdHJ1ZSkpIHtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH1cblxuXHRcdC8vcmVjb3JkIG9sZCBwYXJhbXMgYW5kIHJlc3RvcmUgYWZ0ZXIgcmVxdWVzdCBoYXMgYmVlbiBtYWRlXG5cdFx0b2xkUGFyYW1zID0gVGFidWxhdG9yLnByb3RvdHlwZS5oZWxwZXJzLmRlZXBDbG9uZShzZWxmLnRhYmxlLm1vZHVsZXMuYWpheC5nZXRQYXJhbXMoKSB8fCB7fSk7XG5cdFx0cGFnZVBhcmFtcyA9IHNlbGYudGFibGUubW9kdWxlcy5hamF4LmdldFBhcmFtcygpO1xuXG5cdFx0Ly9jb25maWd1cmUgcmVxdWVzdCBwYXJhbXNcblx0XHRwYWdlUGFyYW1zW190aGlzODIuZGF0YVNlbnROYW1lcy5wYWdlXSA9IHNlbGYucGFnZTtcblxuXHRcdC8vc2V0IHBhZ2Ugc2l6ZSBpZiBkZWZpbmVkXG5cdFx0aWYgKF90aGlzODIuc2l6ZSkge1xuXHRcdFx0cGFnZVBhcmFtc1tfdGhpczgyLmRhdGFTZW50TmFtZXMuc2l6ZV0gPSBfdGhpczgyLnNpemU7XG5cdFx0fVxuXG5cdFx0Ly9zZXQgc29ydCBkYXRhIGlmIGRlZmluZWRcblx0XHRpZiAoX3RoaXM4Mi50YWJsZS5vcHRpb25zLmFqYXhTb3J0aW5nICYmIF90aGlzODIudGFibGUubW9kRXhpc3RzKFwic29ydFwiKSkge1xuXHRcdFx0dmFyIHNvcnRlcnMgPSBzZWxmLnRhYmxlLm1vZHVsZXMuc29ydC5nZXRTb3J0KCk7XG5cblx0XHRcdHNvcnRlcnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdFx0XHRkZWxldGUgaXRlbS5jb2x1bW47XG5cdFx0XHR9KTtcblxuXHRcdFx0cGFnZVBhcmFtc1tfdGhpczgyLmRhdGFTZW50TmFtZXMuc29ydGVyc10gPSBzb3J0ZXJzO1xuXHRcdH1cblxuXHRcdC8vc2V0IGZpbHRlciBkYXRhIGlmIGRlZmluZWRcblx0XHRpZiAoX3RoaXM4Mi50YWJsZS5vcHRpb25zLmFqYXhGaWx0ZXJpbmcgJiYgX3RoaXM4Mi50YWJsZS5tb2RFeGlzdHMoXCJmaWx0ZXJcIikpIHtcblx0XHRcdHZhciBmaWx0ZXJzID0gc2VsZi50YWJsZS5tb2R1bGVzLmZpbHRlci5nZXRGaWx0ZXJzKHRydWUsIHRydWUpO1xuXHRcdFx0cGFnZVBhcmFtc1tfdGhpczgyLmRhdGFTZW50TmFtZXMuZmlsdGVyc10gPSBmaWx0ZXJzO1xuXHRcdH1cblxuXHRcdHNlbGYudGFibGUubW9kdWxlcy5hamF4LnNldFBhcmFtcyhwYWdlUGFyYW1zKTtcblxuXHRcdHNlbGYudGFibGUubW9kdWxlcy5hamF4LnNlbmRSZXF1ZXN0KF90aGlzODIucHJvZ3Jlc3NpdmVMb2FkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRzZWxmLl9wYXJzZVJlbW90ZURhdGEoZGF0YSk7XG5cdFx0XHRyZXNvbHZlKCk7XG5cdFx0fSkuY2F0Y2goZnVuY3Rpb24gKGUpIHtcblx0XHRcdHJlamVjdCgpO1xuXHRcdH0pO1xuXG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLmFqYXguc2V0UGFyYW1zKG9sZFBhcmFtcyk7XG5cdH0pO1xufTtcblxuUGFnZS5wcm90b3R5cGUuX3BhcnNlUmVtb3RlRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGxlZnQsXG5cdCAgICBkYXRhLFxuXHQgICAgbWFyZ2luO1xuXG5cdGlmICh0eXBlb2YgZGF0YVt0aGlzLmRhdGFSZWNlaXZlZE5hbWVzLmxhc3RfcGFnZV0gPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRjb25zb2xlLndhcm4oXCJSZW1vdGUgUGFnaW5hdGlvbiBFcnJvciAtIFNlcnZlciByZXNwb25zZSBtaXNzaW5nICdcIiArIHRoaXMuZGF0YVJlY2VpdmVkTmFtZXMubGFzdF9wYWdlICsgXCInIHByb3BlcnR5XCIpO1xuXHR9XG5cblx0aWYgKGRhdGFbdGhpcy5kYXRhUmVjZWl2ZWROYW1lcy5kYXRhXSkge1xuXHRcdHRoaXMubWF4ID0gcGFyc2VJbnQoZGF0YVt0aGlzLmRhdGFSZWNlaXZlZE5hbWVzLmxhc3RfcGFnZV0pIHx8IDE7XG5cblx0XHRpZiAodGhpcy5wcm9ncmVzc2l2ZUxvYWQpIHtcblx0XHRcdHN3aXRjaCAodGhpcy5tb2RlKSB7XG5cdFx0XHRcdGNhc2UgXCJwcm9ncmVzc2l2ZV9sb2FkXCI6XG5cblx0XHRcdFx0XHRpZiAodGhpcy5wYWdlID09IDEpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zZXREYXRhKGRhdGFbdGhpcy5kYXRhUmVjZWl2ZWROYW1lcy5kYXRhXSwgZmFsc2UsIHRoaXMuaW5pdGlhbExvYWQgJiYgdGhpcy5wYWdlID09IDEpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93cyhkYXRhW3RoaXMuZGF0YVJlY2VpdmVkTmFtZXMuZGF0YV0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh0aGlzLnBhZ2UgPCB0aGlzLm1heCkge1xuXHRcdFx0XHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYubmV4dFBhZ2UoKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdFx0XHRcdFx0XHR9LCBzZWxmLnRhYmxlLm9wdGlvbnMuYWpheFByb2dyZXNzaXZlTG9hZERlbGF5KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSBcInByb2dyZXNzaXZlX3Njcm9sbFwiOlxuXHRcdFx0XHRcdGRhdGEgPSB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGF0YSgpLmNvbmNhdChkYXRhW3RoaXMuZGF0YVJlY2VpdmVkTmFtZXMuZGF0YV0pO1xuXG5cdFx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNldERhdGEoZGF0YSwgdHJ1ZSwgdGhpcy5pbml0aWFsTG9hZCAmJiB0aGlzLnBhZ2UgPT0gMSk7XG5cblx0XHRcdFx0XHRtYXJnaW4gPSB0aGlzLnRhYmxlLm9wdGlvbnMuYWpheFByb2dyZXNzaXZlTG9hZFNjcm9sbE1hcmdpbiB8fCB0aGlzLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRIZWlnaHQgKiAyO1xuXG5cdFx0XHRcdFx0aWYgKHNlbGYudGFibGUucm93TWFuYWdlci5lbGVtZW50LnNjcm9sbEhlaWdodCA8PSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZWxlbWVudC5jbGllbnRIZWlnaHQgKyBtYXJnaW4pIHtcblx0XHRcdFx0XHRcdHNlbGYubmV4dFBhZ2UoKS50aGVuKGZ1bmN0aW9uICgpIHt9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZWZ0ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLnNjcm9sbExlZnQ7XG5cblx0XHRcdHRoaXMudGFibGUucm93TWFuYWdlci5zZXREYXRhKGRhdGFbdGhpcy5kYXRhUmVjZWl2ZWROYW1lcy5kYXRhXSwgZmFsc2UsIHRoaXMuaW5pdGlhbExvYWQgJiYgdGhpcy5wYWdlID09IDEpO1xuXG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIuc2Nyb2xsSG9yaXpvbnRhbChsZWZ0KTtcblxuXHRcdFx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLnNjcm9sbEhvcml6b250YWwobGVmdCk7XG5cblx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wYWdlTG9hZGVkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5nZXRQYWdlKCkpO1xuXHRcdH1cblxuXHRcdHRoaXMuaW5pdGlhbExvYWQgPSBmYWxzZTtcblx0fSBlbHNlIHtcblx0XHRjb25zb2xlLndhcm4oXCJSZW1vdGUgUGFnaW5hdGlvbiBFcnJvciAtIFNlcnZlciByZXNwb25zZSBtaXNzaW5nICdcIiArIHRoaXMuZGF0YVJlY2VpdmVkTmFtZXMuZGF0YSArIFwiJyBwcm9wZXJ0eVwiKTtcblx0fVxufTtcblxuLy9oYW5kbGUgdGhlIGZvb3RlciBlbGVtZW50IGJlaW5nIHJlZHJhd25cblBhZ2UucHJvdG90eXBlLmZvb3RlclJlZHJhdyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGZvb3RlciA9IHRoaXMudGFibGUuZm9vdGVyTWFuYWdlci5lbGVtZW50O1xuXG5cdGlmIChNYXRoLmNlaWwoZm9vdGVyLmNsaWVudFdpZHRoKSAtIGZvb3Rlci5zY3JvbGxXaWR0aCA8IDApIHtcblx0XHR0aGlzLnBhZ2VzRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMucGFnZXNFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnJztcblxuXHRcdGlmIChNYXRoLmNlaWwoZm9vdGVyLmNsaWVudFdpZHRoKSAtIGZvb3Rlci5zY3JvbGxXaWR0aCA8IDApIHtcblx0XHRcdHRoaXMucGFnZXNFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cdFx0fVxuXHR9XG59O1xuXG4vL3NldCB0aGUgcGFyYW10ZXIgbmFtZXMgZm9yIHBhZ2luYXRpb24gcmVxdWVzdHNcblBhZ2UucHJvdG90eXBlLnBhZ2luYXRpb25EYXRhU2VudE5hbWVzID0ge1xuXHRcInBhZ2VcIjogXCJwYWdlXCIsXG5cdFwic2l6ZVwiOiBcInNpemVcIixcblx0XCJzb3J0ZXJzXCI6IFwic29ydGVyc1wiLFxuXHQvLyBcInNvcnRfZGlyXCI6XCJzb3J0X2RpclwiLFxuXHRcImZpbHRlcnNcIjogXCJmaWx0ZXJzXCJcblx0Ly8gXCJmaWx0ZXJfdmFsdWVcIjpcImZpbHRlcl92YWx1ZVwiLFxuXHQvLyBcImZpbHRlcl90eXBlXCI6XCJmaWx0ZXJfdHlwZVwiLFxufTtcblxuLy9zZXQgdGhlIHByb3BlcnR5IG5hbWVzIGZvciBwYWdpbmF0aW9uIHJlc3BvbnNlc1xuUGFnZS5wcm90b3R5cGUucGFnaW5hdGlvbkRhdGFSZWNlaXZlZE5hbWVzID0ge1xuXHRcImN1cnJlbnRfcGFnZVwiOiBcImN1cnJlbnRfcGFnZVwiLFxuXHRcImxhc3RfcGFnZVwiOiBcImxhc3RfcGFnZVwiLFxuXHRcImRhdGFcIjogXCJkYXRhXCJcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJwYWdlXCIsIFBhZ2UpO1xuXG52YXIgUGVyc2lzdGVuY2UgPSBmdW5jdGlvbiBQZXJzaXN0ZW5jZSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMubW9kZSA9IFwiXCI7XG5cdHRoaXMuaWQgPSBcIlwiO1xuXHQvLyB0aGlzLnBlcnNpc3RQcm9wcyA9IFtcImZpZWxkXCIsIFwid2lkdGhcIiwgXCJ2aXNpYmxlXCJdO1xuXHR0aGlzLmRlZldhdGNoZXJCbG9jayA9IGZhbHNlO1xuXHR0aGlzLmNvbmZpZyA9IHt9O1xuXHR0aGlzLnJlYWRGdW5jID0gZmFsc2U7XG5cdHRoaXMud3JpdGVGdW5jID0gZmFsc2U7XG59O1xuXG4vLyBUZXN0IGZvciB3aGV0aGVyIGxvY2FsU3RvcmFnZSBpcyBhdmFpbGFibGUgZm9yIHVzZS5cblBlcnNpc3RlbmNlLnByb3RvdHlwZS5sb2NhbFN0b3JhZ2VUZXN0ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgdGVzdEtleSA9IFwiX3RhYnVsYXRvcl90ZXN0XCI7XG5cblx0dHJ5IHtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0odGVzdEtleSwgdGVzdEtleSk7XG5cdFx0d2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRlc3RLZXkpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG4vL3NldHVwIHBhcmFtZXRlcnNcblBlcnNpc3RlbmNlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHQvL2RldGVybWluZSBwZXJzaXN0ZW50IGxheW91dCBzdG9yYWdlIHR5cGVcblxuXHR2YXIgbW9kZSA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZU1vZGUsXG5cdCAgICBpZCA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZUlELFxuXHQgICAgcmV0cmVpdmVkRGF0YTtcblxuXHR0aGlzLm1vZGUgPSBtb2RlICE9PSB0cnVlID8gbW9kZSA6IHRoaXMubG9jYWxTdG9yYWdlVGVzdCgpID8gXCJsb2NhbFwiIDogXCJjb29raWVcIjtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuYykge1xuXHRcdGlmICh0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHR0aGlzLnJlYWRGdW5jID0gdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlUmVhZGVyRnVuYztcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMucmVhZGVyc1t0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VSZWFkZXJGdW5jXSkge1xuXHRcdFx0XHR0aGlzLnJlYWRGdW5jID0gdGhpcy5yZWFkZXJzW3RoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVJlYWRlckZ1bmNdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiUGVyc2lzdGVuY2UgUmVhZCBFcnJvciAtIGludmFsaWQgcmVhZGVyIHNldFwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VSZWFkZXJGdW5jKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0aWYgKHRoaXMucmVhZGVyc1t0aGlzLm1vZGVdKSB7XG5cdFx0XHR0aGlzLnJlYWRGdW5jID0gdGhpcy5yZWFkZXJzW3RoaXMubW9kZV07XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlBlcnNpc3RlbmNlIFJlYWQgRXJyb3IgLSBpbnZhbGlkIHJlYWRlciBzZXRcIiwgdGhpcy5tb2RlKTtcblx0XHR9XG5cdH1cblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlV3JpdGVyRnVuYykge1xuXHRcdGlmICh0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlV3JpdGVyRnVuYyA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0XHR0aGlzLndyaXRlRnVuYyA9IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZVdyaXRlckZ1bmM7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0aGlzLnJlYWRlcnNbdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlV3JpdGVyRnVuY10pIHtcblx0XHRcdFx0dGhpcy53cml0ZUZ1bmMgPSB0aGlzLnJlYWRlcnNbdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlV3JpdGVyRnVuY107XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJQZXJzaXN0ZW5jZSBXcml0ZSBFcnJvciAtIGludmFsaWQgcmVhZGVyIHNldFwiLCB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2VXcml0ZXJGdW5jKTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0aWYgKHRoaXMud3JpdGVyc1t0aGlzLm1vZGVdKSB7XG5cdFx0XHR0aGlzLndyaXRlRnVuYyA9IHRoaXMud3JpdGVyc1t0aGlzLm1vZGVdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJQZXJzaXN0ZW5jZSBXcml0ZSBFcnJvciAtIGludmFsaWQgd3JpdGVyIHNldFwiLCB0aGlzLm1vZGUpO1xuXHRcdH1cblx0fVxuXG5cdC8vc2V0IHN0b3JhZ2UgdGFnXG5cdHRoaXMuaWQgPSBcInRhYnVsYXRvci1cIiArIChpZCB8fCB0aGlzLnRhYmxlLmVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiaWRcIikgfHwgXCJcIik7XG5cblx0dGhpcy5jb25maWcgPSB7XG5cdFx0c29ydDogdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5zb3J0LFxuXHRcdGZpbHRlcjogdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5maWx0ZXIsXG5cdFx0Z3JvdXA6IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSA9PT0gdHJ1ZSB8fCB0aGlzLnRhYmxlLm9wdGlvbnMucGVyc2lzdGVuY2UuZ3JvdXAsXG5cdFx0cGFnZTogdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlID09PSB0cnVlIHx8IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZS5wYWdlLFxuXHRcdGNvbHVtbnM6IHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSA9PT0gdHJ1ZSA/IFtcInRpdGxlXCIsIFwid2lkdGhcIiwgXCJ2aXNpYmxlXCJdIDogdGhpcy50YWJsZS5vcHRpb25zLnBlcnNpc3RlbmNlLmNvbHVtbnNcblx0fTtcblxuXHQvL2xvYWQgcGFnaW5hdGlvbiBkYXRhIGlmIG5lZWRlZFxuXHRpZiAodGhpcy5jb25maWcucGFnZSkge1xuXHRcdHJldHJlaXZlZERhdGEgPSB0aGlzLnJldHJlaXZlRGF0YShcInBhZ2VcIik7XG5cblx0XHRpZiAocmV0cmVpdmVkRGF0YSkge1xuXHRcdFx0aWYgKHR5cGVvZiByZXRyZWl2ZWREYXRhLnBhZ2luYXRpb25TaXplICE9PSBcInVuZGVmaW5lZFwiICYmICh0aGlzLmNvbmZpZy5wYWdlID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLnBhZ2Uuc2l6ZSkpIHtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLnBhZ2luYXRpb25TaXplID0gcmV0cmVpdmVkRGF0YS5wYWdpbmF0aW9uU2l6ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHR5cGVvZiByZXRyZWl2ZWREYXRhLnBhZ2luYXRpb25Jbml0aWFsUGFnZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiAodGhpcy5jb25maWcucGFnZSA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5wYWdlLnBhZ2UpKSB7XG5cdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5wYWdpbmF0aW9uSW5pdGlhbFBhZ2UgPSByZXRyZWl2ZWREYXRhLnBhZ2luYXRpb25Jbml0aWFsUGFnZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvL2xvYWQgZ3JvdXAgZGF0YSBpZiBuZWVkZWRcblx0aWYgKHRoaXMuY29uZmlnLmdyb3VwKSB7XG5cdFx0cmV0cmVpdmVkRGF0YSA9IHRoaXMucmV0cmVpdmVEYXRhKFwiZ3JvdXBcIik7XG5cblx0XHRpZiAocmV0cmVpdmVkRGF0YSkge1xuXHRcdFx0aWYgKHR5cGVvZiByZXRyZWl2ZWREYXRhLmdyb3VwQnkgIT09IFwidW5kZWZpbmVkXCIgJiYgKHRoaXMuY29uZmlnLmdyb3VwID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmdyb3VwLmdyb3VwQnkpKSB7XG5cdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5ncm91cEJ5ID0gcmV0cmVpdmVkRGF0YS5ncm91cEJ5O1xuXHRcdFx0fVxuXHRcdFx0aWYgKHR5cGVvZiByZXRyZWl2ZWREYXRhLmdyb3VwU3RhcnRPcGVuICE9PSBcInVuZGVmaW5lZFwiICYmICh0aGlzLmNvbmZpZy5ncm91cCA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5ncm91cC5ncm91cFN0YXJ0T3BlbikpIHtcblx0XHRcdFx0dGhpcy50YWJsZS5vcHRpb25zLmdyb3VwU3RhcnRPcGVuID0gcmV0cmVpdmVkRGF0YS5ncm91cFN0YXJ0T3Blbjtcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgcmV0cmVpdmVkRGF0YS5ncm91cEhlYWRlciAhPT0gXCJ1bmRlZmluZWRcIiAmJiAodGhpcy5jb25maWcuZ3JvdXAgPT09IHRydWUgfHwgdGhpcy5jb25maWcuZ3JvdXAuZ3JvdXBIZWFkZXIpKSB7XG5cdFx0XHRcdHRoaXMudGFibGUub3B0aW9ucy5ncm91cEhlYWRlciA9IHJldHJlaXZlZERhdGEuZ3JvdXBIZWFkZXI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRoaXMuY29uZmlnLmNvbHVtbnMpIHtcblx0XHR0aGlzLnRhYmxlLm9wdGlvbnMuY29sdW1ucyA9IHRoaXMubG9hZChcImNvbHVtbnNcIiwgdGhpcy50YWJsZS5vcHRpb25zLmNvbHVtbnMpO1xuXHR9XG59O1xuXG5QZXJzaXN0ZW5jZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUNvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZGVmLFxuXHQgICAga2V5cztcblxuXHRpZiAodGhpcy5jb25maWcuY29sdW1ucykge1xuXHRcdHRoaXMuZGVmV2F0Y2hlckJsb2NrID0gdHJ1ZTtcblxuXHRcdGRlZiA9IGNvbHVtbi5nZXREZWZpbml0aW9uKCk7XG5cblx0XHRrZXlzID0gdGhpcy5jb25maWcuY29sdW1ucyA9PT0gdHJ1ZSA/IE9iamVjdC5rZXlzKGRlZikgOiB0aGlzLmNvbmZpZy5jb2x1bW5zO1xuXG5cdFx0a2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblx0XHRcdHZhciBwcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZGVmLCBrZXkpO1xuXHRcdFx0dmFyIHZhbHVlID0gZGVmW2tleV07XG5cdFx0XHRpZiAocHJvcHMpIHtcblx0XHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGRlZiwga2V5LCB7XG5cdFx0XHRcdFx0c2V0OiBmdW5jdGlvbiBzZXQobmV3VmFsdWUpIHtcblx0XHRcdFx0XHRcdHZhbHVlID0gbmV3VmFsdWU7XG5cblx0XHRcdFx0XHRcdGlmICghc2VsZi5kZWZXYXRjaGVyQmxvY2spIHtcblx0XHRcdFx0XHRcdFx0c2VsZi5zYXZlKFwiY29sdW1uc1wiKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aWYgKHByb3BzLnNldCkge1xuXHRcdFx0XHRcdFx0XHRwcm9wcy5zZXQobmV3VmFsdWUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Z2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdFx0XHRcdFx0XHRpZiAocHJvcHMuZ2V0KSB7XG5cdFx0XHRcdFx0XHRcdHByb3BzLmdldCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmRlZldhdGNoZXJCbG9jayA9IGZhbHNlO1xuXHR9XG59O1xuXG4vL2xvYWQgc2F2ZWQgZGVmaW5pdGlvbnNcblBlcnNpc3RlbmNlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKHR5cGUsIGN1cnJlbnQpIHtcblx0dmFyIGRhdGEgPSB0aGlzLnJldHJlaXZlRGF0YSh0eXBlKTtcblxuXHRpZiAoY3VycmVudCkge1xuXHRcdGRhdGEgPSBkYXRhID8gdGhpcy5tZXJnZURlZmluaXRpb24oY3VycmVudCwgZGF0YSkgOiBjdXJyZW50O1xuXHR9XG5cblx0cmV0dXJuIGRhdGE7XG59O1xuXG4vL3JldHJlaXZlIGRhdGEgZnJvbSBtZW1vcnlcblBlcnNpc3RlbmNlLnByb3RvdHlwZS5yZXRyZWl2ZURhdGEgPSBmdW5jdGlvbiAodHlwZSkge1xuXHRyZXR1cm4gdGhpcy5yZWFkRnVuYyA/IHRoaXMucmVhZEZ1bmModGhpcy5pZCwgdHlwZSkgOiBmYWxzZTtcbn07XG5cbi8vbWVyZ2Ugb2xkIGFuZCBuZXcgY29sdW1uIGRlZmluaXRpb25zXG5QZXJzaXN0ZW5jZS5wcm90b3R5cGUubWVyZ2VEZWZpbml0aW9uID0gZnVuY3Rpb24gKG9sZENvbHMsIG5ld0NvbHMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgb3V0cHV0ID0gW107XG5cblx0Ly8gb2xkQ29scyA9IG9sZENvbHMgfHwgW107XG5cdG5ld0NvbHMgPSBuZXdDb2xzIHx8IFtdO1xuXG5cdG5ld0NvbHMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uLCB0bykge1xuXG5cdFx0dmFyIGZyb20gPSBzZWxmLl9maW5kQ29sdW1uKG9sZENvbHMsIGNvbHVtbiksXG5cdFx0ICAgIGtleXM7XG5cblx0XHRpZiAoZnJvbSkge1xuXG5cdFx0XHRpZiAoc2VsZi5jb25maWcuY29sdW1ucyA9PT0gdHJ1ZSB8fCBzZWxmLmNvbmZpZy5jb2x1bW5zID09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRrZXlzID0gT2JqZWN0LmtleXMoZnJvbSk7XG5cdFx0XHRcdGtleXMucHVzaChcIndpZHRoXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0a2V5cyA9IHNlbGYuY29uZmlnLmNvbHVtbnM7XG5cdFx0XHR9XG5cblx0XHRcdGtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdFx0XHRcdGlmIChrZXkgIT09IFwiY29sdW1uc1wiICYmIHR5cGVvZiBjb2x1bW5ba2V5XSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0XHRcdGZyb21ba2V5XSA9IGNvbHVtbltrZXldO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdFx0aWYgKGZyb20uY29sdW1ucykge1xuXHRcdFx0XHRmcm9tLmNvbHVtbnMgPSBzZWxmLm1lcmdlRGVmaW5pdGlvbihmcm9tLmNvbHVtbnMsIGNvbHVtbi5jb2x1bW5zKTtcblx0XHRcdH1cblxuXHRcdFx0b3V0cHV0LnB1c2goZnJvbSk7XG5cdFx0fVxuXHR9KTtcblxuXHRvbGRDb2xzLmZvckVhY2goZnVuY3Rpb24gKGNvbHVtbiwgaSkge1xuXHRcdHZhciBmcm9tID0gc2VsZi5fZmluZENvbHVtbihuZXdDb2xzLCBjb2x1bW4pO1xuXHRcdGlmICghZnJvbSkge1xuXHRcdFx0aWYgKG91dHB1dC5sZW5ndGggPiBpKSB7XG5cdFx0XHRcdG91dHB1dC5zcGxpY2UoaSwgMCwgY29sdW1uKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG91dHB1dC5wdXNoKGNvbHVtbik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb3V0cHV0O1xufTtcblxuLy9maW5kIG1hdGNoaW5nIGNvbHVtbnNcblBlcnNpc3RlbmNlLnByb3RvdHlwZS5fZmluZENvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW5zLCBzdWJqZWN0KSB7XG5cdHZhciB0eXBlID0gc3ViamVjdC5jb2x1bW5zID8gXCJncm91cFwiIDogc3ViamVjdC5maWVsZCA/IFwiZmllbGRcIiA6IFwib2JqZWN0XCI7XG5cblx0cmV0dXJuIGNvbHVtbnMuZmluZChmdW5jdGlvbiAoY29sKSB7XG5cdFx0c3dpdGNoICh0eXBlKSB7XG5cdFx0XHRjYXNlIFwiZ3JvdXBcIjpcblx0XHRcdFx0cmV0dXJuIGNvbC50aXRsZSA9PT0gc3ViamVjdC50aXRsZSAmJiBjb2wuY29sdW1ucy5sZW5ndGggPT09IHN1YmplY3QuY29sdW1ucy5sZW5ndGg7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwiZmllbGRcIjpcblx0XHRcdFx0cmV0dXJuIGNvbC5maWVsZCA9PT0gc3ViamVjdC5maWVsZDtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJvYmplY3RcIjpcblx0XHRcdFx0cmV0dXJuIGNvbCA9PT0gc3ViamVjdDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8vc2F2ZSBkYXRhXG5QZXJzaXN0ZW5jZS5wcm90b3R5cGUuc2F2ZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG5cdHZhciBkYXRhID0ge307XG5cblx0c3dpdGNoICh0eXBlKSB7XG5cdFx0Y2FzZSBcImNvbHVtbnNcIjpcblx0XHRcdGRhdGEgPSB0aGlzLnBhcnNlQ29sdW1ucyh0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0Q29sdW1ucygpKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcImZpbHRlclwiOlxuXHRcdFx0ZGF0YSA9IHRoaXMudGFibGUubW9kdWxlcy5maWx0ZXIuZ2V0RmlsdGVycygpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwic29ydFwiOlxuXHRcdFx0ZGF0YSA9IHRoaXMudmFsaWRhdGVTb3J0ZXJzKHRoaXMudGFibGUubW9kdWxlcy5zb3J0LmdldFNvcnQoKSk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJncm91cFwiOlxuXHRcdFx0ZGF0YSA9IHRoaXMuZ2V0R3JvdXBDb25maWcoKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcInBhZ2VcIjpcblx0XHRcdGRhdGEgPSB0aGlzLmdldFBhZ2VDb25maWcoKTtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0aWYgKHRoaXMud3JpdGVGdW5jKSB7XG5cdFx0dGhpcy53cml0ZUZ1bmModGhpcy5pZCwgdHlwZSwgZGF0YSk7XG5cdH1cbn07XG5cbi8vZW5zdXJlIHNvcnRlcnMgY29udGFpbiBubyBmdW5jdGlvbiBkYXRhXG5QZXJzaXN0ZW5jZS5wcm90b3R5cGUudmFsaWRhdGVTb3J0ZXJzID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0aXRlbS5jb2x1bW4gPSBpdGVtLmZpZWxkO1xuXHRcdGRlbGV0ZSBpdGVtLmZpZWxkO1xuXHR9KTtcblxuXHRyZXR1cm4gZGF0YTtcbn07XG5cblBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRHcm91cENvbmZpZyA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGRhdGEgPSB7fTtcblxuXHRpZiAodGhpcy5jb25maWcuZ3JvdXApIHtcblx0XHRpZiAodGhpcy5jb25maWcuZ3JvdXAgPT09IHRydWUgfHwgdGhpcy5jb25maWcuZ3JvdXAuZ3JvdXBCeSkge1xuXHRcdFx0ZGF0YS5ncm91cEJ5ID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwQnk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuY29uZmlnLmdyb3VwID09PSB0cnVlIHx8IHRoaXMuY29uZmlnLmdyb3VwLmdyb3VwU3RhcnRPcGVuKSB7XG5cdFx0XHRkYXRhLmdyb3VwU3RhcnRPcGVuID0gdGhpcy50YWJsZS5vcHRpb25zLmdyb3VwU3RhcnRPcGVuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmNvbmZpZy5ncm91cCA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5ncm91cC5ncm91cEhlYWRlcikge1xuXHRcdFx0ZGF0YS5ncm91cEhlYWRlciA9IHRoaXMudGFibGUub3B0aW9ucy5ncm91cEhlYWRlcjtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gZGF0YTtcbn07XG5cblBlcnNpc3RlbmNlLnByb3RvdHlwZS5nZXRQYWdlQ29uZmlnID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgZGF0YSA9IHt9O1xuXG5cdGlmICh0aGlzLmNvbmZpZy5wYWdlKSB7XG5cdFx0aWYgKHRoaXMuY29uZmlnLnBhZ2UgPT09IHRydWUgfHwgdGhpcy5jb25maWcucGFnZS5zaXplKSB7XG5cdFx0XHRkYXRhLnBhZ2luYXRpb25TaXplID0gdGhpcy50YWJsZS5tb2R1bGVzLnBhZ2UuZ2V0UGFnZVNpemUoKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5jb25maWcucGFnZSA9PT0gdHJ1ZSB8fCB0aGlzLmNvbmZpZy5wYWdlLnBhZ2UpIHtcblx0XHRcdGRhdGEucGFnaW5hdGlvbkluaXRpYWxQYWdlID0gdGhpcy50YWJsZS5tb2R1bGVzLnBhZ2UuZ2V0UGFnZSgpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiBkYXRhO1xufTtcblxuLy9wYXJzZSBjb2x1bW5zIGZvciBkYXRhIHRvIHN0b3JlXG5QZXJzaXN0ZW5jZS5wcm90b3R5cGUucGFyc2VDb2x1bW5zID0gZnVuY3Rpb24gKGNvbHVtbnMpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgZGVmaW5pdGlvbnMgPSBbXSxcblx0ICAgIGV4Y2x1ZGVkS2V5cyA9IFtcImhlYWRlckNvbnRleHRNZW51XCIsIFwiaGVhZGVyTWVudVwiLCBcImNvbnRleHRNZW51XCIsIFwiY2xpY2tNZW51XCJdO1xuXG5cdGNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0dmFyIGRlZlN0b3JlID0ge30sXG5cdFx0ICAgIGNvbERlZiA9IGNvbHVtbi5nZXREZWZpbml0aW9uKCksXG5cdFx0ICAgIGtleXM7XG5cblx0XHRpZiAoY29sdW1uLmlzR3JvdXApIHtcblx0XHRcdGRlZlN0b3JlLnRpdGxlID0gY29sRGVmLnRpdGxlO1xuXHRcdFx0ZGVmU3RvcmUuY29sdW1ucyA9IHNlbGYucGFyc2VDb2x1bW5zKGNvbHVtbi5nZXRDb2x1bW5zKCkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkZWZTdG9yZS5maWVsZCA9IGNvbHVtbi5nZXRGaWVsZCgpO1xuXG5cdFx0XHRpZiAoc2VsZi5jb25maWcuY29sdW1ucyA9PT0gdHJ1ZSB8fCBzZWxmLmNvbmZpZy5jb2x1bW5zID09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRrZXlzID0gT2JqZWN0LmtleXMoY29sRGVmKTtcblx0XHRcdFx0a2V5cy5wdXNoKFwid2lkdGhcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRrZXlzID0gc2VsZi5jb25maWcuY29sdW1ucztcblx0XHRcdH1cblxuXHRcdFx0a2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblxuXHRcdFx0XHRzd2l0Y2ggKGtleSkge1xuXHRcdFx0XHRcdGNhc2UgXCJ3aWR0aFwiOlxuXHRcdFx0XHRcdFx0ZGVmU3RvcmUud2lkdGggPSBjb2x1bW4uZ2V0V2lkdGgoKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJ2aXNpYmxlXCI6XG5cdFx0XHRcdFx0XHRkZWZTdG9yZS52aXNpYmxlID0gY29sdW1uLnZpc2libGU7XG5cdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRpZiAodHlwZW9mIGNvbERlZltrZXldICE9PSBcImZ1bmN0aW9uXCIgJiYgZXhjbHVkZWRLZXlzLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcblx0XHRcdFx0XHRcdFx0ZGVmU3RvcmVba2V5XSA9IGNvbERlZltrZXldO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRkZWZpbml0aW9ucy5wdXNoKGRlZlN0b3JlKTtcblx0fSk7XG5cblx0cmV0dXJuIGRlZmluaXRpb25zO1xufTtcblxuLy8gcmVhZCBwZXJpc3RlbmNlIGluZm9ybWF0aW9uIGZyb20gc3RvcmFnZVxuUGVyc2lzdGVuY2UucHJvdG90eXBlLnJlYWRlcnMgPSB7XG5cdGxvY2FsOiBmdW5jdGlvbiBsb2NhbChpZCwgdHlwZSkge1xuXHRcdHZhciBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oaWQgKyBcIi1cIiArIHR5cGUpO1xuXG5cdFx0cmV0dXJuIGRhdGEgPyBKU09OLnBhcnNlKGRhdGEpIDogZmFsc2U7XG5cdH0sXG5cdGNvb2tpZTogZnVuY3Rpb24gY29va2llKGlkLCB0eXBlKSB7XG5cdFx0dmFyIGNvb2tpZSA9IGRvY3VtZW50LmNvb2tpZSxcblx0XHQgICAga2V5ID0gaWQgKyBcIi1cIiArIHR5cGUsXG5cdFx0ICAgIGNvb2tpZVBvcyA9IGNvb2tpZS5pbmRleE9mKGtleSArIFwiPVwiKSxcblx0XHQgICAgZW5kLFxuXHRcdCAgICBkYXRhO1xuXG5cdFx0Ly9pZiBjb29raWUgZXhpc3RzLCBkZWNvZGUgYW5kIGxvYWQgY29sdW1uIGRhdGEgaW50byB0YWJ1bGF0b3Jcblx0XHRpZiAoY29va2llUG9zID4gLTEpIHtcblx0XHRcdGNvb2tpZSA9IGNvb2tpZS5zdWJzdHIoY29va2llUG9zKTtcblxuXHRcdFx0ZW5kID0gY29va2llLmluZGV4T2YoXCI7XCIpO1xuXG5cdFx0XHRpZiAoZW5kID4gLTEpIHtcblx0XHRcdFx0Y29va2llID0gY29va2llLnN1YnN0cigwLCBlbmQpO1xuXHRcdFx0fVxuXG5cdFx0XHRkYXRhID0gY29va2llLnJlcGxhY2Uoa2V5ICsgXCI9XCIsIFwiXCIpO1xuXHRcdH1cblxuXHRcdHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IGZhbHNlO1xuXHR9XG59O1xuXG4vL3dyaXRlIHBlcnNpc3RlbmNlIGluZm9ybWF0aW9uIHRvIHN0b3JhZ2VcblBlcnNpc3RlbmNlLnByb3RvdHlwZS53cml0ZXJzID0ge1xuXHRsb2NhbDogZnVuY3Rpb24gbG9jYWwoaWQsIHR5cGUsIGRhdGEpIHtcblx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZCArIFwiLVwiICsgdHlwZSwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuXHR9LFxuXHRjb29raWU6IGZ1bmN0aW9uIGNvb2tpZShpZCwgdHlwZSwgZGF0YSkge1xuXHRcdHZhciBleHBpcmVEYXRlID0gbmV3IERhdGUoKTtcblxuXHRcdGV4cGlyZURhdGUuc2V0RGF0ZShleHBpcmVEYXRlLmdldERhdGUoKSArIDEwMDAwKTtcblxuXHRcdGRvY3VtZW50LmNvb2tpZSA9IGlkICsgXCItXCIgKyB0eXBlICsgXCI9XCIgKyBKU09OLnN0cmluZ2lmeShkYXRhKSArIFwiOyBleHBpcmVzPVwiICsgZXhwaXJlRGF0ZS50b1VUQ1N0cmluZygpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwicGVyc2lzdGVuY2VcIiwgUGVyc2lzdGVuY2UpO1xuXG52YXIgUHJpbnQgPSBmdW5jdGlvbiBQcmludCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuZWxlbWVudCA9IGZhbHNlO1xuXHR0aGlzLm1hbnVhbEJsb2NrID0gZmFsc2U7XG59O1xuXG5QcmludC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJiZWZvcmVwcmludFwiLCB0aGlzLnJlcGxhY2VUYWJsZS5iaW5kKHRoaXMpKTtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJhZnRlcnByaW50XCIsIHRoaXMuY2xlYW51cC5iaW5kKHRoaXMpKTtcbn07XG5cblByaW50LnByb3RvdHlwZS5yZXBsYWNlVGFibGUgPSBmdW5jdGlvbiAoKSB7XG5cdGlmICghdGhpcy5tYW51YWxCbG9jaykge1xuXHRcdHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtdGFibGVcIik7XG5cblx0XHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy50YWJsZS5tb2R1bGVzLmV4cG9ydC5nZW5lcmVhdGVUYWJsZSh0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRDb25maWcsIHRoaXMudGFibGUub3B0aW9ucy5wcmludFN0eWxlZCwgdGhpcy50YWJsZS5vcHRpb25zLnByaW50Um93UmFuZ2UsIFwicHJpbnRcIikpO1xuXG5cdFx0dGhpcy50YWJsZS5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuXHRcdHRoaXMudGFibGUuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmVsZW1lbnQsIHRoaXMudGFibGUuZWxlbWVudCk7XG5cdH1cbn07XG5cblByaW50LnByb3RvdHlwZS5jbGVhbnVwID0gZnVuY3Rpb24gKCkge1xuXHRkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItcHJpbnQtZnVsbHNjcmVlbi1oaWRlXCIpO1xuXG5cdGlmICh0aGlzLmVsZW1lbnQgJiYgdGhpcy5lbGVtZW50LnBhcmVudE5vZGUpIHtcblx0XHR0aGlzLmVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsZW1lbnQpO1xuXHRcdHRoaXMudGFibGUuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcblx0fVxufTtcblxuUHJpbnQucHJvdG90eXBlLnByaW50RnVsbHNjcmVlbiA9IGZ1bmN0aW9uICh2aXNpYmxlLCBzdHlsZSwgY29uZmlnKSB7XG5cdHZhciBzY3JvbGxYID0gd2luZG93LnNjcm9sbFgsXG5cdCAgICBzY3JvbGxZID0gd2luZG93LnNjcm9sbFksXG5cdCAgICBoZWFkZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdCAgICBmb290ZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdCAgICB0YWJsZUVsID0gdGhpcy50YWJsZS5tb2R1bGVzLmV4cG9ydC5nZW5lcmVhdGVUYWJsZSh0eXBlb2YgY29uZmlnICE9IFwidW5kZWZpbmVkXCIgPyBjb25maWcgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRDb25maWcsIHR5cGVvZiBzdHlsZSAhPSBcInVuZGVmaW5lZFwiID8gc3R5bGUgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRTdHlsZWQsIHZpc2libGUsIFwicHJpbnRcIiksXG5cdCAgICBoZWFkZXJDb250ZW50LFxuXHQgICAgZm9vdGVyQ29udGVudDtcblxuXHR0aGlzLm1hbnVhbEJsb2NrID0gdHJ1ZTtcblxuXHR0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHR0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC1mdWxsc2NyZWVuXCIpO1xuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRIZWFkZXIpIHtcblx0XHRoZWFkZXJFbC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXByaW50LWhlYWRlclwiKTtcblxuXHRcdGhlYWRlckNvbnRlbnQgPSB0eXBlb2YgdGhpcy50YWJsZS5vcHRpb25zLnByaW50SGVhZGVyID09IFwiZnVuY3Rpb25cIiA/IHRoaXMudGFibGUub3B0aW9ucy5wcmludEhlYWRlci5jYWxsKHRoaXMudGFibGUpIDogdGhpcy50YWJsZS5vcHRpb25zLnByaW50SGVhZGVyO1xuXG5cdFx0aWYgKHR5cGVvZiBoZWFkZXJDb250ZW50ID09IFwic3RyaW5nXCIpIHtcblx0XHRcdGhlYWRlckVsLmlubmVySFRNTCA9IGhlYWRlckNvbnRlbnQ7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGhlYWRlckVsLmFwcGVuZENoaWxkKGhlYWRlckNvbnRlbnQpO1xuXHRcdH1cblxuXHRcdHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChoZWFkZXJFbCk7XG5cdH1cblxuXHR0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGFibGVFbCk7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wcmludEZvb3Rlcikge1xuXHRcdGZvb3RlckVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcHJpbnQtZm9vdGVyXCIpO1xuXG5cdFx0Zm9vdGVyQ29udGVudCA9IHR5cGVvZiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRGb290ZXIgPT0gXCJmdW5jdGlvblwiID8gdGhpcy50YWJsZS5vcHRpb25zLnByaW50Rm9vdGVyLmNhbGwodGhpcy50YWJsZSkgOiB0aGlzLnRhYmxlLm9wdGlvbnMucHJpbnRGb290ZXI7XG5cblx0XHRpZiAodHlwZW9mIGZvb3RlckNvbnRlbnQgPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0Zm9vdGVyRWwuaW5uZXJIVE1MID0gZm9vdGVyQ29udGVudDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm9vdGVyRWwuYXBwZW5kQ2hpbGQoZm9vdGVyQ29udGVudCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGZvb3RlckVsKTtcblx0fVxuXG5cdGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1wcmludC1mdWxsc2NyZWVuLWhpZGVcIik7XG5cdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5lbGVtZW50KTtcblxuXHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnByaW50Rm9ybWF0dGVyKSB7XG5cdFx0dGhpcy50YWJsZS5vcHRpb25zLnByaW50Rm9ybWF0dGVyKHRoaXMuZWxlbWVudCwgdGFibGVFbCk7XG5cdH1cblxuXHR3aW5kb3cucHJpbnQoKTtcblxuXHR0aGlzLmNsZWFudXAoKTtcblxuXHR3aW5kb3cuc2Nyb2xsVG8oc2Nyb2xsWCwgc2Nyb2xsWSk7XG5cblx0dGhpcy5tYW51YWxCbG9jayA9IGZhbHNlO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcInByaW50XCIsIFByaW50KTtcbnZhciBSZWFjdGl2ZURhdGEgPSBmdW5jdGlvbiBSZWFjdGl2ZURhdGEodGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLmRhdGEgPSBmYWxzZTtcblx0dGhpcy5ibG9ja2VkID0gZmFsc2U7IC8vYmxvY2sgcmVhY3Rpdml0eSB3aGlsZSBwZXJmb3JtaW5nIHVwZGF0ZVxuXHR0aGlzLm9yaWdGdW5jcyA9IHt9OyAvLyBob2xkIG9yaWdpbmFsIGRhdGEgYXJyYXkgZnVuY3Rpb25zIHRvIGFsbG93IHJlcGxhY2VtZW50IGFmdGVyIGRhdGEgaXMgZG9uZSB3aXRoXG5cdHRoaXMuY3VycmVudFZlcnNpb24gPSAwO1xufTtcblxuUmVhY3RpdmVEYXRhLnByb3RvdHlwZS53YXRjaERhdGEgPSBmdW5jdGlvbiAoZGF0YSkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBwdXNoRnVuYyxcblx0ICAgIHZlcnNpb247XG5cblx0dGhpcy5jdXJyZW50VmVyc2lvbisrO1xuXG5cdHZlcnNpb24gPSB0aGlzLmN1cnJlbnRWZXJzaW9uO1xuXG5cdHNlbGYudW53YXRjaERhdGEoKTtcblxuXHRzZWxmLmRhdGEgPSBkYXRhO1xuXG5cdC8vb3ZlcnJpZGUgYXJyYXkgcHVzaCBmdW5jdGlvblxuXHRzZWxmLm9yaWdGdW5jcy5wdXNoID0gZGF0YS5wdXNoO1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmRhdGEsIFwicHVzaFwiLCB7XG5cdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcblx0XHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpO1xuXG5cdFx0XHRpZiAoIXNlbGYuYmxvY2tlZCAmJiB2ZXJzaW9uID09PSBzZWxmLmN1cnJlbnRWZXJzaW9uKSB7XG5cdFx0XHRcdGFyZ3MuZm9yRWFjaChmdW5jdGlvbiAoYXJnKSB7XG5cdFx0XHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLmFkZFJvd0FjdHVhbChhcmcsIGZhbHNlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBzZWxmLm9yaWdGdW5jcy5wdXNoLmFwcGx5KGRhdGEsIGFyZ3VtZW50cyk7XG5cdFx0fVxuXHR9KTtcblxuXHQvL292ZXJyaWRlIGFycmF5IHVuc2hpZnQgZnVuY3Rpb25cblx0c2VsZi5vcmlnRnVuY3MudW5zaGlmdCA9IGRhdGEudW5zaGlmdDtcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5kYXRhLCBcInVuc2hpZnRcIiwge1xuXHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHR2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7XG5cdFx0XHR2YXIgYXJncyA9IEFycmF5LmZyb20oYXJndW1lbnRzKTtcblxuXHRcdFx0aWYgKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbikge1xuXHRcdFx0XHRhcmdzLmZvckVhY2goZnVuY3Rpb24gKGFyZykge1xuXHRcdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwoYXJnLCB0cnVlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBzZWxmLm9yaWdGdW5jcy51bnNoaWZ0LmFwcGx5KGRhdGEsIGFyZ3VtZW50cyk7XG5cdFx0fVxuXHR9KTtcblxuXHQvL292ZXJyaWRlIGFycmF5IHNoaWZ0IGZ1bmN0aW9uXG5cdHNlbGYub3JpZ0Z1bmNzLnNoaWZ0ID0gZGF0YS5zaGlmdDtcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5kYXRhLCBcInNoaWZ0XCIsIHtcblx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcblx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkge1xuXHRcdFx0dmFyIHJvdztcblxuXHRcdFx0aWYgKCFzZWxmLmJsb2NrZWQgJiYgdmVyc2lvbiA9PT0gc2VsZi5jdXJyZW50VmVyc2lvbikge1xuXHRcdFx0XHRpZiAoc2VsZi5kYXRhLmxlbmd0aCkge1xuXHRcdFx0XHRcdHJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5nZXRSb3dGcm9tRGF0YU9iamVjdChzZWxmLmRhdGFbMF0pO1xuXG5cdFx0XHRcdFx0aWYgKHJvdykge1xuXHRcdFx0XHRcdFx0cm93LmRlbGV0ZUFjdHVhbCgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gc2VsZi5vcmlnRnVuY3Muc2hpZnQuY2FsbChkYXRhKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vb3ZlcnJpZGUgYXJyYXkgcG9wIGZ1bmN0aW9uXG5cdHNlbGYub3JpZ0Z1bmNzLnBvcCA9IGRhdGEucG9wO1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzZWxmLmRhdGEsIFwicG9wXCIsIHtcblx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcblx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0dmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkge1xuXHRcdFx0dmFyIHJvdztcblx0XHRcdGlmICghc2VsZi5ibG9ja2VkICYmIHZlcnNpb24gPT09IHNlbGYuY3VycmVudFZlcnNpb24pIHtcblx0XHRcdFx0aWYgKHNlbGYuZGF0YS5sZW5ndGgpIHtcblx0XHRcdFx0XHRyb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93RnJvbURhdGFPYmplY3Qoc2VsZi5kYXRhW3NlbGYuZGF0YS5sZW5ndGggLSAxXSk7XG5cblx0XHRcdFx0XHRpZiAocm93KSB7XG5cdFx0XHRcdFx0XHRyb3cuZGVsZXRlQWN0dWFsKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gc2VsZi5vcmlnRnVuY3MucG9wLmNhbGwoZGF0YSk7XG5cdFx0fVxuXHR9KTtcblxuXHQvL292ZXJyaWRlIGFycmF5IHNwbGljZSBmdW5jdGlvblxuXHRzZWxmLm9yaWdGdW5jcy5zcGxpY2UgPSBkYXRhLnNwbGljZTtcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoc2VsZi5kYXRhLCBcInNwbGljZVwiLCB7XG5cdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcblx0XHRcdHZhciBhcmdzID0gQXJyYXkuZnJvbShhcmd1bWVudHMpLFxuXHRcdFx0ICAgIHN0YXJ0ID0gYXJnc1swXSA8IDAgPyBkYXRhLmxlbmd0aCArIGFyZ3NbMF0gOiBhcmdzWzBdLFxuXHRcdFx0ICAgIGVuZCA9IGFyZ3NbMV0sXG5cdFx0XHQgICAgbmV3Um93cyA9IGFyZ3NbMl0gPyBhcmdzLnNsaWNlKDIpIDogZmFsc2UsXG5cdFx0XHQgICAgc3RhcnRSb3c7XG5cblx0XHRcdGlmICghc2VsZi5ibG9ja2VkICYmIHZlcnNpb24gPT09IHNlbGYuY3VycmVudFZlcnNpb24pIHtcblxuXHRcdFx0XHQvL2FkZCBuZXcgcm93c1xuXHRcdFx0XHRpZiAobmV3Um93cykge1xuXHRcdFx0XHRcdHN0YXJ0Um93ID0gZGF0YVtzdGFydF0gPyBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0Um93RnJvbURhdGFPYmplY3QoZGF0YVtzdGFydF0pIDogZmFsc2U7XG5cblx0XHRcdFx0XHRpZiAoc3RhcnRSb3cpIHtcblx0XHRcdFx0XHRcdG5ld1Jvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93RGF0YSkge1xuXHRcdFx0XHRcdFx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIuYWRkUm93QWN0dWFsKHJvd0RhdGEsIHRydWUsIHN0YXJ0Um93LCB0cnVlKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRuZXdSb3dzID0gbmV3Um93cy5zbGljZSgpLnJldmVyc2UoKTtcblxuXHRcdFx0XHRcdFx0bmV3Um93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3dEYXRhKSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5hZGRSb3dBY3R1YWwocm93RGF0YSwgdHJ1ZSwgZmFsc2UsIHRydWUpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9kZWxldGUgcmVtb3ZlZCByb3dzXG5cdFx0XHRcdGlmIChlbmQgIT09IDApIHtcblx0XHRcdFx0XHR2YXIgb2xkUm93cyA9IGRhdGEuc2xpY2Uoc3RhcnQsIHR5cGVvZiBhcmdzWzFdID09PSBcInVuZGVmaW5lZFwiID8gYXJnc1sxXSA6IHN0YXJ0ICsgZW5kKTtcblxuXHRcdFx0XHRcdG9sZFJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93RGF0YSwgaSkge1xuXHRcdFx0XHRcdFx0dmFyIHJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5nZXRSb3dGcm9tRGF0YU9iamVjdChyb3dEYXRhKTtcblxuXHRcdFx0XHRcdFx0aWYgKHJvdykge1xuXHRcdFx0XHRcdFx0XHRyb3cuZGVsZXRlQWN0dWFsKGkgIT09IG9sZFJvd3MubGVuZ3RoIC0gMSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAobmV3Um93cyB8fCBlbmQgIT09IDApIHtcblx0XHRcdFx0XHRzZWxmLnRhYmxlLnJvd01hbmFnZXIucmVSZW5kZXJJblBvc2l0aW9uKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHNlbGYub3JpZ0Z1bmNzLnNwbGljZS5hcHBseShkYXRhLCBhcmd1bWVudHMpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5SZWFjdGl2ZURhdGEucHJvdG90eXBlLnVud2F0Y2hEYXRhID0gZnVuY3Rpb24gKCkge1xuXHRpZiAodGhpcy5kYXRhICE9PSBmYWxzZSkge1xuXHRcdGZvciAodmFyIGtleSBpbiB0aGlzLm9yaWdGdW5jcykge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMuZGF0YSwga2V5LCB7XG5cdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXG5cdFx0XHRcdHZhbHVlOiB0aGlzLm9yaWdGdW5jcy5rZXlcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxufTtcblxuUmVhY3RpdmVEYXRhLnByb3RvdHlwZS53YXRjaFJvdyA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGRhdGEgPSByb3cuZ2V0RGF0YSgpO1xuXG5cdHRoaXMuYmxvY2tlZCA9IHRydWU7XG5cblx0Zm9yICh2YXIga2V5IGluIGRhdGEpIHtcblx0XHR0aGlzLndhdGNoS2V5KHJvdywgZGF0YSwga2V5KTtcblx0fVxuXG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWUpIHtcblx0XHR0aGlzLndhdGNoVHJlZUNoaWxkcmVuKHJvdyk7XG5cdH1cblxuXHR0aGlzLmJsb2NrZWQgPSBmYWxzZTtcbn07XG5cblJlYWN0aXZlRGF0YS5wcm90b3R5cGUud2F0Y2hUcmVlQ2hpbGRyZW4gPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGNoaWxkRmllbGQgPSByb3cuZ2V0RGF0YSgpW3RoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZUNoaWxkRmllbGRdLFxuXHQgICAgb3JpZ0Z1bmNzID0ge307XG5cblx0ZnVuY3Rpb24gcmVidWlsZFRyZWUoKSB7XG5cdFx0c2VsZi50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmluaXRpYWxpemVSb3cocm93KTtcblx0XHRzZWxmLnRhYmxlLm1vZHVsZXMuZGF0YVRyZWUubGF5b3V0Um93KHJvdyk7XG5cdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLnJlZnJlc2hBY3RpdmVEYXRhKFwidHJlZVwiLCBmYWxzZSwgdHJ1ZSk7XG5cdH1cblxuXHRpZiAoY2hpbGRGaWVsZCkge1xuXG5cdFx0b3JpZ0Z1bmNzLnB1c2ggPSBjaGlsZEZpZWxkLnB1c2g7XG5cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY2hpbGRGaWVsZCwgXCJwdXNoXCIsIHtcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxuXHRcdFx0Y29uZmlndXJhYmxlOiB0cnVlLFxuXHRcdFx0dmFsdWU6IGZ1bmN0aW9uIHZhbHVlKCkge1xuXHRcdFx0XHR2YXIgcmVzdWx0ID0gb3JpZ0Z1bmNzLnB1c2guYXBwbHkoY2hpbGRGaWVsZCwgYXJndW1lbnRzKTtcblxuXHRcdFx0XHRyZWJ1aWxkVHJlZSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvcmlnRnVuY3MudW5zaGlmdCA9IGNoaWxkRmllbGQudW5zaGlmdDtcblxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjaGlsZEZpZWxkLCBcInVuc2hpZnRcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7XG5cdFx0XHRcdHZhciByZXN1bHQgPSBvcmlnRnVuY3MudW5zaGlmdC5hcHBseShjaGlsZEZpZWxkLCBhcmd1bWVudHMpO1xuXG5cdFx0XHRcdHJlYnVpbGRUcmVlKCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG9yaWdGdW5jcy5zaGlmdCA9IGNoaWxkRmllbGQuc2hpZnQ7XG5cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY2hpbGRGaWVsZCwgXCJzaGlmdFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcblx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IG9yaWdGdW5jcy5zaGlmdC5jYWxsKGNoaWxkRmllbGQpO1xuXG5cdFx0XHRcdHJlYnVpbGRUcmVlKCk7XG5cblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdG9yaWdGdW5jcy5wb3AgPSBjaGlsZEZpZWxkLnBvcDtcblxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjaGlsZEZpZWxkLCBcInBvcFwiLCB7XG5cdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcblx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiB2YWx1ZSgpIHtcblx0XHRcdFx0dmFyIHJlc3VsdCA9IG9yaWdGdW5jcy5wb3AuY2FsbChjaGlsZEZpZWxkKTtcblxuXHRcdFx0XHRyZWJ1aWxkVHJlZSgpO1xuXG5cdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRvcmlnRnVuY3Muc3BsaWNlID0gY2hpbGRGaWVsZC5zcGxpY2U7XG5cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY2hpbGRGaWVsZCwgXCJzcGxpY2VcIiwge1xuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXG5cdFx0XHRjb25maWd1cmFibGU6IHRydWUsXG5cdFx0XHR2YWx1ZTogZnVuY3Rpb24gdmFsdWUoKSB7XG5cdFx0XHRcdHZhciByZXN1bHQgPSBvcmlnRnVuY3Muc3BsaWNlLmFwcGx5KGNoaWxkRmllbGQsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0cmVidWlsZFRyZWUoKTtcblxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG59O1xuXG5SZWFjdGl2ZURhdGEucHJvdG90eXBlLndhdGNoS2V5ID0gZnVuY3Rpb24gKHJvdywgZGF0YSwga2V5KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHByb3BzID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihkYXRhLCBrZXkpLFxuXHQgICAgdmFsdWUgPSBkYXRhW2tleV0sXG5cdCAgICB2ZXJzaW9uID0gdGhpcy5jdXJyZW50VmVyc2lvbjtcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwga2V5LCB7XG5cdFx0c2V0OiBmdW5jdGlvbiBzZXQobmV3VmFsdWUpIHtcblx0XHRcdHZhbHVlID0gbmV3VmFsdWU7XG5cdFx0XHRpZiAoIXNlbGYuYmxvY2tlZCAmJiB2ZXJzaW9uID09PSBzZWxmLmN1cnJlbnRWZXJzaW9uKSB7XG5cdFx0XHRcdHZhciB1cGRhdGUgPSB7fTtcblx0XHRcdFx0dXBkYXRlW2tleV0gPSBuZXdWYWx1ZTtcblx0XHRcdFx0cm93LnVwZGF0ZURhdGEodXBkYXRlKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHByb3BzLnNldCkge1xuXHRcdFx0XHRwcm9wcy5zZXQobmV3VmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Z2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cblx0XHRcdGlmIChwcm9wcy5nZXQpIHtcblx0XHRcdFx0cHJvcHMuZ2V0KCk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHR9XG5cdH0pO1xufTtcblxuUmVhY3RpdmVEYXRhLnByb3RvdHlwZS51bndhdGNoUm93ID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgZGF0YSA9IHJvdy5nZXREYXRhKCk7XG5cblx0Zm9yICh2YXIga2V5IGluIGRhdGEpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwga2V5LCB7XG5cdFx0XHR2YWx1ZTogZGF0YVtrZXldXG5cdFx0fSk7XG5cdH1cbn07XG5cblJlYWN0aXZlRGF0YS5wcm90b3R5cGUuYmxvY2sgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuYmxvY2tlZCA9IHRydWU7XG59O1xuXG5SZWFjdGl2ZURhdGEucHJvdG90eXBlLnVuYmxvY2sgPSBmdW5jdGlvbiAoKSB7XG5cdHRoaXMuYmxvY2tlZCA9IGZhbHNlO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcInJlYWN0aXZlRGF0YVwiLCBSZWFjdGl2ZURhdGEpO1xuXG52YXIgUmVzaXplQ29sdW1ucyA9IGZ1bmN0aW9uIFJlc2l6ZUNvbHVtbnModGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLnN0YXJ0Q29sdW1uID0gZmFsc2U7XG5cdHRoaXMuc3RhcnRYID0gZmFsc2U7XG5cdHRoaXMuc3RhcnRXaWR0aCA9IGZhbHNlO1xuXHR0aGlzLmhhbmRsZSA9IG51bGw7XG5cdHRoaXMucHJldkhhbmRsZSA9IG51bGw7XG59O1xuXG5SZXNpemVDb2x1bW5zLnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKHR5cGUsIGNvbHVtbiwgZWxlbWVudCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICB2YXJpYWJsZUhlaWdodCA9IGZhbHNlLFxuXHQgICAgbW9kZSA9IHRoaXMudGFibGUub3B0aW9ucy5yZXNpemFibGVDb2x1bW5zO1xuXG5cdC8vc2V0IGNvbHVtbiByZXNpemUgbW9kZVxuXHRpZiAodHlwZSA9PT0gXCJoZWFkZXJcIikge1xuXHRcdHZhcmlhYmxlSGVpZ2h0ID0gY29sdW1uLmRlZmluaXRpb24uZm9ybWF0dGVyID09IFwidGV4dGFyZWFcIiB8fCBjb2x1bW4uZGVmaW5pdGlvbi52YXJpYWJsZUhlaWdodDtcblx0XHRjb2x1bW4ubW9kdWxlcy5yZXNpemUgPSB7IHZhcmlhYmxlSGVpZ2h0OiB2YXJpYWJsZUhlaWdodCB9O1xuXHR9XG5cblx0aWYgKG1vZGUgPT09IHRydWUgfHwgbW9kZSA9PSB0eXBlKSB7XG5cblx0XHR2YXIgaGFuZGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0aGFuZGxlLmNsYXNzTmFtZSA9IFwidGFidWxhdG9yLWNvbC1yZXNpemUtaGFuZGxlXCI7XG5cblx0XHR2YXIgcHJldkhhbmRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdHByZXZIYW5kbGUuY2xhc3NOYW1lID0gXCJ0YWJ1bGF0b3ItY29sLXJlc2l6ZS1oYW5kbGUgcHJldlwiO1xuXG5cdFx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblxuXHRcdHZhciBoYW5kbGVEb3duID0gZnVuY3Rpb24gaGFuZGxlRG93bihlKSB7XG5cdFx0XHR2YXIgbmVhcmVzdENvbHVtbiA9IGNvbHVtbi5nZXRMYXN0Q29sdW1uKCk7XG5cblx0XHRcdGlmIChuZWFyZXN0Q29sdW1uICYmIHNlbGYuX2NoZWNrUmVzaXphYmlsaXR5KG5lYXJlc3RDb2x1bW4pKSB7XG5cdFx0XHRcdHNlbGYuc3RhcnRDb2x1bW4gPSBjb2x1bW47XG5cdFx0XHRcdHNlbGYuX21vdXNlRG93bihlLCBuZWFyZXN0Q29sdW1uLCBoYW5kbGUpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVEb3duKTtcblx0XHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgaGFuZGxlRG93biwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0Ly9yZXN6aWUgY29sdW1uIG9uICBkb3VibGUgY2xpY2tcblx0XHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgY29sID0gY29sdW1uLmdldExhc3RDb2x1bW4oKTtcblxuXHRcdFx0aWYgKGNvbCAmJiBzZWxmLl9jaGVja1Jlc2l6YWJpbGl0eShjb2wpKSB7XG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGNvbC5yZWluaXRpYWxpemVXaWR0aCh0cnVlKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHByZXZIYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH0pO1xuXG5cdFx0dmFyIHByZXZIYW5kbGVEb3duID0gZnVuY3Rpb24gcHJldkhhbmRsZURvd24oZSkge1xuXHRcdFx0dmFyIG5lYXJlc3RDb2x1bW4sIGNvbEluZGV4LCBwcmV2Q29sdW1uO1xuXG5cdFx0XHRuZWFyZXN0Q29sdW1uID0gY29sdW1uLmdldEZpcnN0Q29sdW1uKCk7XG5cblx0XHRcdGlmIChuZWFyZXN0Q29sdW1uKSB7XG5cdFx0XHRcdGNvbEluZGV4ID0gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmZpbmRDb2x1bW5JbmRleChuZWFyZXN0Q29sdW1uKTtcblx0XHRcdFx0cHJldkNvbHVtbiA9IGNvbEluZGV4ID4gMCA/IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5nZXRDb2x1bW5CeUluZGV4KGNvbEluZGV4IC0gMSkgOiBmYWxzZTtcblxuXHRcdFx0XHRpZiAocHJldkNvbHVtbiAmJiBzZWxmLl9jaGVja1Jlc2l6YWJpbGl0eShwcmV2Q29sdW1uKSkge1xuXHRcdFx0XHRcdHNlbGYuc3RhcnRDb2x1bW4gPSBjb2x1bW47XG5cdFx0XHRcdFx0c2VsZi5fbW91c2VEb3duKGUsIHByZXZDb2x1bW4sIHByZXZIYW5kbGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHByZXZIYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBwcmV2SGFuZGxlRG93bik7XG5cdFx0cHJldkhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBwcmV2SGFuZGxlRG93biwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG5cdFx0Ly9yZXNpemUgY29sdW1uIG9uIGRvdWJsZSBjbGlja1xuXHRcdHByZXZIYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIGZ1bmN0aW9uIChlKSB7XG5cdFx0XHR2YXIgbmVhcmVzdENvbHVtbiwgY29sSW5kZXgsIHByZXZDb2x1bW47XG5cblx0XHRcdG5lYXJlc3RDb2x1bW4gPSBjb2x1bW4uZ2V0Rmlyc3RDb2x1bW4oKTtcblxuXHRcdFx0aWYgKG5lYXJlc3RDb2x1bW4pIHtcblx0XHRcdFx0Y29sSW5kZXggPSBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIuZmluZENvbHVtbkluZGV4KG5lYXJlc3RDb2x1bW4pO1xuXHRcdFx0XHRwcmV2Q29sdW1uID0gY29sSW5kZXggPiAwID8gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldENvbHVtbkJ5SW5kZXgoY29sSW5kZXggLSAxKSA6IGZhbHNlO1xuXG5cdFx0XHRcdGlmIChwcmV2Q29sdW1uICYmIHNlbGYuX2NoZWNrUmVzaXphYmlsaXR5KHByZXZDb2x1bW4pKSB7XG5cdFx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XHRwcmV2Q29sdW1uLnJlaW5pdGlhbGl6ZVdpZHRoKHRydWUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRlbGVtZW50LmFwcGVuZENoaWxkKGhhbmRsZSk7XG5cdFx0ZWxlbWVudC5hcHBlbmRDaGlsZChwcmV2SGFuZGxlKTtcblx0fVxufTtcblxuUmVzaXplQ29sdW1ucy5wcm90b3R5cGUuX2NoZWNrUmVzaXphYmlsaXR5ID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHRyZXR1cm4gdHlwZW9mIGNvbHVtbi5kZWZpbml0aW9uLnJlc2l6YWJsZSAhPSBcInVuZGVmaW5lZFwiID8gY29sdW1uLmRlZmluaXRpb24ucmVzaXphYmxlIDogdGhpcy50YWJsZS5vcHRpb25zLnJlc2l6YWJsZUNvbHVtbnM7XG59O1xuXG5SZXNpemVDb2x1bW5zLnByb3RvdHlwZS5fbW91c2VEb3duID0gZnVuY3Rpb24gKGUsIGNvbHVtbiwgaGFuZGxlKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRzZWxmLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0ZnVuY3Rpb24gbW91c2VNb3ZlKGUpIHtcblx0XHQvLyBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIudGVtcFNjcm9sbEJsb2NrKCk7XG5cblx0XHRpZiAoc2VsZi50YWJsZS5ydGwpIHtcblx0XHRcdGNvbHVtbi5zZXRXaWR0aChzZWxmLnN0YXJ0V2lkdGggLSAoKHR5cGVvZiBlLnNjcmVlblggPT09IFwidW5kZWZpbmVkXCIgPyBlLnRvdWNoZXNbMF0uc2NyZWVuWCA6IGUuc2NyZWVuWCkgLSBzZWxmLnN0YXJ0WCkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb2x1bW4uc2V0V2lkdGgoc2VsZi5zdGFydFdpZHRoICsgKCh0eXBlb2YgZS5zY3JlZW5YID09PSBcInVuZGVmaW5lZFwiID8gZS50b3VjaGVzWzBdLnNjcmVlblggOiBlLnNjcmVlblgpIC0gc2VsZi5zdGFydFgpKTtcblx0XHR9XG5cblx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnZpcnR1YWxEb21Ib3opIHtcblx0XHRcdHNlbGYudGFibGUudmRvbUhvei5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdFx0fVxuXG5cdFx0aWYgKCFzZWxmLnRhYmxlLmJyb3dzZXJTbG93ICYmIGNvbHVtbi5tb2R1bGVzLnJlc2l6ZSAmJiBjb2x1bW4ubW9kdWxlcy5yZXNpemUudmFyaWFibGVIZWlnaHQpIHtcblx0XHRcdGNvbHVtbi5jaGVja0NlbGxIZWlnaHRzKCk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gbW91c2VVcChlKSB7XG5cblx0XHQvL2Jsb2NrIGVkaXRvciBmcm9tIHRha2luZyBhY3Rpb24gd2hpbGUgcmVzaXppbmcgaXMgdGFraW5nIHBsYWNlXG5cdFx0aWYgKHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0KSB7XG5cdFx0XHRzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdC5ibG9ja2VkID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0aWYgKHNlbGYudGFibGUuYnJvd3NlclNsb3cgJiYgY29sdW1uLm1vZHVsZXMucmVzaXplICYmIGNvbHVtbi5tb2R1bGVzLnJlc2l6ZS52YXJpYWJsZUhlaWdodCkge1xuXHRcdFx0Y29sdW1uLmNoZWNrQ2VsbEhlaWdodHMoKTtcblx0XHR9XG5cblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlVXApO1xuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZU1vdmUpO1xuXG5cdFx0aGFuZGxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaG1vdmVcIiwgbW91c2VNb3ZlKTtcblx0XHRoYW5kbGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIG1vdXNlVXApO1xuXG5cdFx0c2VsZi50YWJsZS5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3ItYmxvY2stc2VsZWN0XCIpO1xuXG5cdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiBzZWxmLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHNlbGYudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuY29sdW1ucykge1xuXHRcdFx0c2VsZi50YWJsZS5tb2R1bGVzLnBlcnNpc3RlbmNlLnNhdmUoXCJjb2x1bW5zXCIpO1xuXHRcdH1cblxuXHRcdHNlbGYudGFibGUub3B0aW9ucy5jb2x1bW5SZXNpemVkLmNhbGwoc2VsZi50YWJsZSwgY29sdW1uLmdldENvbXBvbmVudCgpKTtcblx0fVxuXG5cdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8vcHJldmVudCByZXNpemUgZnJvbSBpbnRlcmZlcmVpbmcgd2l0aCBtb3ZhYmxlIGNvbHVtbnNcblxuXHQvL2Jsb2NrIGVkaXRvciBmcm9tIHRha2luZyBhY3Rpb24gd2hpbGUgcmVzaXppbmcgaXMgdGFraW5nIHBsYWNlXG5cdGlmIChzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdCkge1xuXHRcdHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0LmJsb2NrZWQgPSB0cnVlO1xuXHR9XG5cblx0c2VsZi5zdGFydFggPSB0eXBlb2YgZS5zY3JlZW5YID09PSBcInVuZGVmaW5lZFwiID8gZS50b3VjaGVzWzBdLnNjcmVlblggOiBlLnNjcmVlblg7XG5cdHNlbGYuc3RhcnRXaWR0aCA9IGNvbHVtbi5nZXRXaWR0aCgpO1xuXG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZU1vdmUpO1xuXHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlVXApO1xuXHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCBtb3VzZU1vdmUsIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBtb3VzZVVwKTtcbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJyZXNpemVDb2x1bW5zXCIsIFJlc2l6ZUNvbHVtbnMpO1xudmFyIFJlc2l6ZVJvd3MgPSBmdW5jdGlvbiBSZXNpemVSb3dzKHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcblx0dGhpcy5zdGFydENvbHVtbiA9IGZhbHNlO1xuXHR0aGlzLnN0YXJ0WSA9IGZhbHNlO1xuXHR0aGlzLnN0YXJ0SGVpZ2h0ID0gZmFsc2U7XG5cdHRoaXMuaGFuZGxlID0gbnVsbDtcblx0dGhpcy5wcmV2SGFuZGxlID0gbnVsbDtcbn07XG5cblJlc2l6ZVJvd3MucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHJvd0VsID0gcm93LmdldEVsZW1lbnQoKTtcblxuXHR2YXIgaGFuZGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdGhhbmRsZS5jbGFzc05hbWUgPSBcInRhYnVsYXRvci1yb3ctcmVzaXplLWhhbmRsZVwiO1xuXG5cdHZhciBwcmV2SGFuZGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdHByZXZIYW5kbGUuY2xhc3NOYW1lID0gXCJ0YWJ1bGF0b3Itcm93LXJlc2l6ZS1oYW5kbGUgcHJldlwiO1xuXG5cdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHR9KTtcblxuXHR2YXIgaGFuZGxlRG93biA9IGZ1bmN0aW9uIGhhbmRsZURvd24oZSkge1xuXHRcdHNlbGYuc3RhcnRSb3cgPSByb3c7XG5cdFx0c2VsZi5fbW91c2VEb3duKGUsIHJvdywgaGFuZGxlKTtcblx0fTtcblxuXHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVEb3duKTtcblx0aGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIGhhbmRsZURvd24sIHsgcGFzc2l2ZTogdHJ1ZSB9KTtcblxuXHRwcmV2SGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdH0pO1xuXG5cdHZhciBwcmV2SGFuZGxlRG93biA9IGZ1bmN0aW9uIHByZXZIYW5kbGVEb3duKGUpIHtcblx0XHR2YXIgcHJldlJvdyA9IHNlbGYudGFibGUucm93TWFuYWdlci5wcmV2RGlzcGxheVJvdyhyb3cpO1xuXG5cdFx0aWYgKHByZXZSb3cpIHtcblx0XHRcdHNlbGYuc3RhcnRSb3cgPSBwcmV2Um93O1xuXHRcdFx0c2VsZi5fbW91c2VEb3duKGUsIHByZXZSb3csIHByZXZIYW5kbGUpO1xuXHRcdH1cblx0fTtcblxuXHRwcmV2SGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgcHJldkhhbmRsZURvd24pO1xuXHRwcmV2SGFuZGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIHByZXZIYW5kbGVEb3duLCB7IHBhc3NpdmU6IHRydWUgfSk7XG5cblx0cm93RWwuYXBwZW5kQ2hpbGQoaGFuZGxlKTtcblx0cm93RWwuYXBwZW5kQ2hpbGQocHJldkhhbmRsZSk7XG59O1xuXG5SZXNpemVSb3dzLnByb3RvdHlwZS5fbW91c2VEb3duID0gZnVuY3Rpb24gKGUsIHJvdywgaGFuZGxlKSB7XG5cdHZhciBzZWxmID0gdGhpcztcblxuXHRzZWxmLnRhYmxlLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1ibG9jay1zZWxlY3RcIik7XG5cblx0ZnVuY3Rpb24gbW91c2VNb3ZlKGUpIHtcblx0XHRyb3cuc2V0SGVpZ2h0KHNlbGYuc3RhcnRIZWlnaHQgKyAoKHR5cGVvZiBlLnNjcmVlblkgPT09IFwidW5kZWZpbmVkXCIgPyBlLnRvdWNoZXNbMF0uc2NyZWVuWSA6IGUuc2NyZWVuWSkgLSBzZWxmLnN0YXJ0WSkpO1xuXHR9XG5cblx0ZnVuY3Rpb24gbW91c2VVcChlKSB7XG5cblx0XHQvLyAvL2Jsb2NrIGVkaXRvciBmcm9tIHRha2luZyBhY3Rpb24gd2hpbGUgcmVzaXppbmcgaXMgdGFraW5nIHBsYWNlXG5cdFx0Ly8gaWYoc2VsZi5zdGFydENvbHVtbi5tb2R1bGVzLmVkaXQpe1xuXHRcdC8vIFx0c2VsZi5zdGFydENvbHVtbi5tb2R1bGVzLmVkaXQuYmxvY2tlZCA9IGZhbHNlO1xuXHRcdC8vIH1cblxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgbW91c2VNb3ZlKTtcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgbW91c2VNb3ZlKTtcblxuXHRcdGhhbmRsZS5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIG1vdXNlTW92ZSk7XG5cdFx0aGFuZGxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBtb3VzZVVwKTtcblxuXHRcdHNlbGYudGFibGUuZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLWJsb2NrLXNlbGVjdFwiKTtcblxuXHRcdHNlbGYudGFibGUub3B0aW9ucy5yb3dSZXNpemVkLmNhbGwodGhpcy50YWJsZSwgcm93LmdldENvbXBvbmVudCgpKTtcblx0fVxuXG5cdGUuc3RvcFByb3BhZ2F0aW9uKCk7IC8vcHJldmVudCByZXNpemUgZnJvbSBpbnRlcmZlcmVpbmcgd2l0aCBtb3ZhYmxlIGNvbHVtbnNcblxuXHQvL2Jsb2NrIGVkaXRvciBmcm9tIHRha2luZyBhY3Rpb24gd2hpbGUgcmVzaXppbmcgaXMgdGFraW5nIHBsYWNlXG5cdC8vIGlmKHNlbGYuc3RhcnRDb2x1bW4ubW9kdWxlcy5lZGl0KXtcblx0Ly8gXHRzZWxmLnN0YXJ0Q29sdW1uLm1vZHVsZXMuZWRpdC5ibG9ja2VkID0gdHJ1ZTtcblx0Ly8gfVxuXG5cdHNlbGYuc3RhcnRZID0gdHlwZW9mIGUuc2NyZWVuWSA9PT0gXCJ1bmRlZmluZWRcIiA/IGUudG91Y2hlc1swXS5zY3JlZW5ZIDogZS5zY3JlZW5ZO1xuXHRzZWxmLnN0YXJ0SGVpZ2h0ID0gcm93LmdldEhlaWdodCgpO1xuXG5cdGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBtb3VzZU1vdmUpO1xuXHRkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG1vdXNlVXApO1xuXG5cdGhhbmRsZS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2htb3ZlXCIsIG1vdXNlTW92ZSwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXHRoYW5kbGUuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIG1vdXNlVXApO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcInJlc2l6ZVJvd3NcIiwgUmVzaXplUm93cyk7XG52YXIgUmVzaXplVGFibGUgPSBmdW5jdGlvbiBSZXNpemVUYWJsZSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuYmluZGluZyA9IGZhbHNlO1xuXHR0aGlzLm9ic2VydmVyID0gZmFsc2U7XG5cdHRoaXMuY29udGFpbmVyT2JzZXJ2ZXIgPSBmYWxzZTtcblxuXHR0aGlzLnRhYmxlSGVpZ2h0ID0gMDtcblx0dGhpcy50YWJsZVdpZHRoID0gMDtcblx0dGhpcy5jb250YWluZXJIZWlnaHQgPSAwO1xuXHR0aGlzLmNvbnRhaW5lcldpZHRoID0gMDtcblxuXHR0aGlzLmF1dG9SZXNpemUgPSBmYWxzZTtcbn07XG5cblJlc2l6ZVRhYmxlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgX3RoaXM4MyA9IHRoaXM7XG5cblx0dmFyIHRhYmxlID0gdGhpcy50YWJsZSxcblx0ICAgIHRhYmxlU3R5bGU7XG5cblx0dGhpcy50YWJsZUhlaWdodCA9IHRhYmxlLmVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuXHR0aGlzLnRhYmxlV2lkdGggPSB0YWJsZS5lbGVtZW50LmNsaWVudFdpZHRoO1xuXG5cdGlmICh0YWJsZS5lbGVtZW50LnBhcmVudE5vZGUpIHtcblx0XHR0aGlzLmNvbnRhaW5lckhlaWdodCA9IHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5jbGllbnRIZWlnaHQ7XG5cdFx0dGhpcy5jb250YWluZXJXaWR0aCA9IHRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZS5jbGllbnRXaWR0aDtcblx0fVxuXG5cdGlmICh0eXBlb2YgUmVzaXplT2JzZXJ2ZXIgIT09IFwidW5kZWZpbmVkXCIgJiYgdGFibGUucm93TWFuYWdlci5nZXRSZW5kZXJNb2RlKCkgPT09IFwidmlydHVhbFwiKSB7XG5cblx0XHR0aGlzLmF1dG9SZXNpemUgPSB0cnVlO1xuXG5cdFx0dGhpcy5vYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihmdW5jdGlvbiAoZW50cnkpIHtcblx0XHRcdGlmICghdGFibGUuYnJvd3Nlck1vYmlsZSB8fCB0YWJsZS5icm93c2VyTW9iaWxlICYmICF0YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpIHtcblxuXHRcdFx0XHR2YXIgbm9kZUhlaWdodCA9IE1hdGguZmxvb3IoZW50cnlbMF0uY29udGVudFJlY3QuaGVpZ2h0KTtcblx0XHRcdFx0dmFyIG5vZGVXaWR0aCA9IE1hdGguZmxvb3IoZW50cnlbMF0uY29udGVudFJlY3Qud2lkdGgpO1xuXG5cdFx0XHRcdGlmIChfdGhpczgzLnRhYmxlSGVpZ2h0ICE9IG5vZGVIZWlnaHQgfHwgX3RoaXM4My50YWJsZVdpZHRoICE9IG5vZGVXaWR0aCkge1xuXHRcdFx0XHRcdF90aGlzODMudGFibGVIZWlnaHQgPSBub2RlSGVpZ2h0O1xuXHRcdFx0XHRcdF90aGlzODMudGFibGVXaWR0aCA9IG5vZGVXaWR0aDtcblxuXHRcdFx0XHRcdGlmICh0YWJsZS5lbGVtZW50LnBhcmVudE5vZGUpIHtcblx0XHRcdFx0XHRcdF90aGlzODMuY29udGFpbmVySGVpZ2h0ID0gdGFibGUuZWxlbWVudC5wYXJlbnROb2RlLmNsaWVudEhlaWdodDtcblx0XHRcdFx0XHRcdF90aGlzODMuY29udGFpbmVyV2lkdGggPSB0YWJsZS5lbGVtZW50LnBhcmVudE5vZGUuY2xpZW50V2lkdGg7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveikge1xuXHRcdFx0XHRcdFx0dGFibGUudmRvbUhvei5yZWluaXRpYWxpemUodHJ1ZSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0dGFibGUucmVkcmF3KCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZSh0YWJsZS5lbGVtZW50KTtcblxuXHRcdHRhYmxlU3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0YWJsZS5lbGVtZW50KTtcblxuXHRcdGlmICh0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSAmJiAhdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpeGVkSGVpZ2h0ICYmICh0YWJsZVN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJtYXgtaGVpZ2h0XCIpIHx8IHRhYmxlU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShcIm1pbi1oZWlnaHRcIikpKSB7XG5cblx0XHRcdHRoaXMuY29udGFpbmVyT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoZnVuY3Rpb24gKGVudHJ5KSB7XG5cdFx0XHRcdGlmICghdGFibGUuYnJvd3Nlck1vYmlsZSB8fCB0YWJsZS5icm93c2VyTW9iaWxlICYmICF0YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpIHtcblxuXHRcdFx0XHRcdHZhciBub2RlSGVpZ2h0ID0gTWF0aC5mbG9vcihlbnRyeVswXS5jb250ZW50UmVjdC5oZWlnaHQpO1xuXHRcdFx0XHRcdHZhciBub2RlV2lkdGggPSBNYXRoLmZsb29yKGVudHJ5WzBdLmNvbnRlbnRSZWN0LndpZHRoKTtcblxuXHRcdFx0XHRcdGlmIChfdGhpczgzLmNvbnRhaW5lckhlaWdodCAhPSBub2RlSGVpZ2h0IHx8IF90aGlzODMuY29udGFpbmVyV2lkdGggIT0gbm9kZVdpZHRoKSB7XG5cdFx0XHRcdFx0XHRfdGhpczgzLmNvbnRhaW5lckhlaWdodCA9IG5vZGVIZWlnaHQ7XG5cdFx0XHRcdFx0XHRfdGhpczgzLmNvbnRhaW5lcldpZHRoID0gbm9kZVdpZHRoO1xuXHRcdFx0XHRcdFx0X3RoaXM4My50YWJsZUhlaWdodCA9IHRhYmxlLmVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuXHRcdFx0XHRcdFx0X3RoaXM4My50YWJsZVdpZHRoID0gdGFibGUuZWxlbWVudC5jbGllbnRXaWR0aDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAodGFibGUub3B0aW9ucy52aXJ0dWFsRG9tSG96KSB7XG5cdFx0XHRcdFx0XHR0YWJsZS52ZG9tSG96LnJlaW5pdGlhbGl6ZSh0cnVlKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR0YWJsZS5yZWRyYXcoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMuY29udGFpbmVyT2JzZXJ2ZXIub2JzZXJ2ZSh0aGlzLnRhYmxlLmVsZW1lbnQucGFyZW50Tm9kZSk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMuYmluZGluZyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdGlmICghdGFibGUuYnJvd3Nlck1vYmlsZSB8fCB0YWJsZS5icm93c2VyTW9iaWxlICYmICF0YWJsZS5tb2R1bGVzLmVkaXQuY3VycmVudENlbGwpIHtcblx0XHRcdFx0aWYgKHRhYmxlLm9wdGlvbnMudmlydHVhbERvbUhveikge1xuXHRcdFx0XHRcdHRhYmxlLnZkb21Ib3oucmVpbml0aWFsaXplKHRydWUpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGFibGUucmVkcmF3KCk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuYmluZGluZyk7XG5cdH1cbn07XG5cblJlc2l6ZVRhYmxlLnByb3RvdHlwZS5jbGVhckJpbmRpbmdzID0gZnVuY3Rpb24gKHJvdykge1xuXHRpZiAodGhpcy5iaW5kaW5nKSB7XG5cdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5iaW5kaW5nKTtcblx0fVxuXG5cdGlmICh0aGlzLm9ic2VydmVyKSB7XG5cdFx0dGhpcy5vYnNlcnZlci51bm9ic2VydmUodGhpcy50YWJsZS5lbGVtZW50KTtcblx0fVxuXG5cdGlmICh0aGlzLmNvbnRhaW5lck9ic2VydmVyKSB7XG5cdFx0dGhpcy5jb250YWluZXJPYnNlcnZlci51bm9ic2VydmUodGhpcy50YWJsZS5lbGVtZW50LnBhcmVudE5vZGUpO1xuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwicmVzaXplVGFibGVcIiwgUmVzaXplVGFibGUpO1xudmFyIFJlc3BvbnNpdmVMYXlvdXQgPSBmdW5jdGlvbiBSZXNwb25zaXZlTGF5b3V0KHRhYmxlKSB7XG5cdHRoaXMudGFibGUgPSB0YWJsZTsgLy9ob2xkIFRhYnVsYXRvciBvYmplY3Rcblx0dGhpcy5jb2x1bW5zID0gW107XG5cdHRoaXMuaGlkZGVuQ29sdW1ucyA9IFtdO1xuXHR0aGlzLm1vZGUgPSBcIlwiO1xuXHR0aGlzLmluZGV4ID0gMDtcblx0dGhpcy5jb2xsYXBzZUZvcm1hdHRlciA9IFtdO1xuXHR0aGlzLmNvbGxhcHNlU3RhcnRPcGVuID0gdHJ1ZTtcblx0dGhpcy5jb2xsYXBzZUhhbmRsZUNvbHVtbiA9IGZhbHNlO1xufTtcblxuLy9nZW5lcmF0ZSByZXNwb3NpdmUgY29sdW1ucyBsaXN0XG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICBjb2x1bW5zID0gW107XG5cblx0dGhpcy5tb2RlID0gdGhpcy50YWJsZS5vcHRpb25zLnJlc3BvbnNpdmVMYXlvdXQ7XG5cdHRoaXMuY29sbGFwc2VGb3JtYXR0ZXIgPSB0aGlzLnRhYmxlLm9wdGlvbnMucmVzcG9uc2l2ZUxheW91dENvbGxhcHNlRm9ybWF0dGVyIHx8IHRoaXMuZm9ybWF0Q29sbGFwc2VkRGF0YTtcblx0dGhpcy5jb2xsYXBzZVN0YXJ0T3BlbiA9IHRoaXMudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0Q29sbGFwc2VTdGFydE9wZW47XG5cdHRoaXMuaGlkZGVuQ29sdW1ucyA9IFtdO1xuXG5cdC8vZGV0ZW1pbmUgbGV2ZWwgb2YgcmVzcG9uc2l2aXR5IGZvciBlYWNoIGNvbHVtblxuXHR0aGlzLnRhYmxlLmNvbHVtbk1hbmFnZXIuY29sdW1uc0J5SW5kZXguZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uLCBpKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUpIHtcblx0XHRcdGlmIChjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlLm9yZGVyICYmIGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUudmlzaWJsZSkge1xuXHRcdFx0XHRjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlLmluZGV4ID0gaTtcblx0XHRcdFx0Y29sdW1ucy5wdXNoKGNvbHVtbik7XG5cblx0XHRcdFx0aWYgKCFjb2x1bW4udmlzaWJsZSAmJiBzZWxmLm1vZGUgPT09IFwiY29sbGFwc2VcIikge1xuXHRcdFx0XHRcdHNlbGYuaGlkZGVuQ29sdW1ucy5wdXNoKGNvbHVtbik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8vc29ydCBsaXN0IGJ5IHJlc3BvbnNpdml0eVxuXHRjb2x1bW5zID0gY29sdW1ucy5yZXZlcnNlKCk7XG5cdGNvbHVtbnMgPSBjb2x1bW5zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0XHR2YXIgZGlmZiA9IGIubW9kdWxlcy5yZXNwb25zaXZlLm9yZGVyIC0gYS5tb2R1bGVzLnJlc3BvbnNpdmUub3JkZXI7XG5cdFx0cmV0dXJuIGRpZmYgfHwgYi5tb2R1bGVzLnJlc3BvbnNpdmUuaW5kZXggLSBhLm1vZHVsZXMucmVzcG9uc2l2ZS5pbmRleDtcblx0fSk7XG5cblx0dGhpcy5jb2x1bW5zID0gY29sdW1ucztcblxuXHRpZiAodGhpcy5tb2RlID09PSBcImNvbGxhcHNlXCIpIHtcblx0XHR0aGlzLmdlbmVyYXRlQ29sbGFwc2VkQ29udGVudCgpO1xuXHR9XG5cblx0Ly9hc3NpZ24gY29sbGFwc2UgY29sdW1uXG5cdGZvciAodmFyIF9pdGVyYXRvciA9IHRoaXMudGFibGUuY29sdW1uTWFuYWdlci5jb2x1bW5zQnlJbmRleCwgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5KF9pdGVyYXRvciksIF9pMTcgPSAwLCBfaXRlcmF0b3IgPSBfaXNBcnJheSA/IF9pdGVyYXRvciA6IF9pdGVyYXRvcltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuXHRcdHZhciBfcmVmO1xuXG5cdFx0aWYgKF9pc0FycmF5KSB7XG5cdFx0XHRpZiAoX2kxNyA+PSBfaXRlcmF0b3IubGVuZ3RoKSBicmVhaztcblx0XHRcdF9yZWYgPSBfaXRlcmF0b3JbX2kxNysrXTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0X2kxNyA9IF9pdGVyYXRvci5uZXh0KCk7XG5cdFx0XHRpZiAoX2kxNy5kb25lKSBicmVhaztcblx0XHRcdF9yZWYgPSBfaTE3LnZhbHVlO1xuXHRcdH1cblxuXHRcdHZhciBjb2wgPSBfcmVmO1xuXG5cdFx0aWYgKGNvbC5kZWZpbml0aW9uLmZvcm1hdHRlciA9PSBcInJlc3BvbnNpdmVDb2xsYXBzZVwiKSB7XG5cdFx0XHR0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uID0gY29sO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4pIHtcblx0XHRpZiAodGhpcy5oaWRkZW5Db2x1bW5zLmxlbmd0aCkge1xuXHRcdFx0dGhpcy5jb2xsYXBzZUhhbmRsZUNvbHVtbi5zaG93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29sbGFwc2VIYW5kbGVDb2x1bW4uaGlkZSgpO1xuXHRcdH1cblx0fVxufTtcblxuLy9kZWZpbmUgbGF5b3V0IGluZm9ybWF0aW9uXG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS5pbml0aWFsaXplQ29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgZGVmID0gY29sdW1uLmdldERlZmluaXRpb24oKTtcblxuXHRjb2x1bW4ubW9kdWxlcy5yZXNwb25zaXZlID0geyBvcmRlcjogdHlwZW9mIGRlZi5yZXNwb25zaXZlID09PSBcInVuZGVmaW5lZFwiID8gMSA6IGRlZi5yZXNwb25zaXZlLCB2aXNpYmxlOiBkZWYudmlzaWJsZSA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWUgfTtcbn07XG5cblJlc3BvbnNpdmVMYXlvdXQucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBlbDtcblxuXHRpZiAocm93LnR5cGUgIT09IFwiY2FsY1wiKSB7XG5cdFx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItcmVzcG9uc2l2ZS1jb2xsYXBzZVwiKTtcblxuXHRcdHJvdy5tb2R1bGVzLnJlc3BvbnNpdmVMYXlvdXQgPSB7XG5cdFx0XHRlbGVtZW50OiBlbCxcblx0XHRcdG9wZW46IHRoaXMuY29sbGFwc2VTdGFydE9wZW5cblx0XHR9O1xuXG5cdFx0aWYgKCF0aGlzLmNvbGxhcHNlU3RhcnRPcGVuKSB7XG5cdFx0XHRlbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXHRcdH1cblx0fVxufTtcblxuUmVzcG9uc2l2ZUxheW91dC5wcm90b3R5cGUubGF5b3V0Um93ID0gZnVuY3Rpb24gKHJvdykge1xuXHR2YXIgcm93RWwgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdGlmIChyb3cubW9kdWxlcy5yZXNwb25zaXZlTGF5b3V0KSB7XG5cdFx0cm93RWwuYXBwZW5kQ2hpbGQocm93Lm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC5lbGVtZW50KTtcblx0XHR0aGlzLmdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudChyb3cpO1xuXHR9XG59O1xuXG4vL3VwZGF0ZSBjb2x1bW4gdmlzaWJpbGl0eVxuUmVzcG9uc2l2ZUxheW91dC5wcm90b3R5cGUudXBkYXRlQ29sdW1uVmlzaWJpbGl0eSA9IGZ1bmN0aW9uIChjb2x1bW4sIHZpc2libGUpIHtcblx0dmFyIGluZGV4O1xuXHRpZiAoY29sdW1uLm1vZHVsZXMucmVzcG9uc2l2ZSkge1xuXHRcdGNvbHVtbi5tb2R1bGVzLnJlc3BvbnNpdmUudmlzaWJsZSA9IHZpc2libGU7XG5cdFx0dGhpcy5pbml0aWFsaXplKCk7XG5cdH1cbn07XG5cblJlc3BvbnNpdmVMYXlvdXQucHJvdG90eXBlLmhpZGVDb2x1bW4gPSBmdW5jdGlvbiAoY29sdW1uKSB7XG5cdHZhciBjb2xDb3VudCA9IHRoaXMuaGlkZGVuQ29sdW1ucy5sZW5ndGg7XG5cblx0Y29sdW1uLmhpZGUoZmFsc2UsIHRydWUpO1xuXG5cdGlmICh0aGlzLm1vZGUgPT09IFwiY29sbGFwc2VcIikge1xuXHRcdHRoaXMuaGlkZGVuQ29sdW1ucy51bnNoaWZ0KGNvbHVtbik7XG5cdFx0dGhpcy5nZW5lcmF0ZUNvbGxhcHNlZENvbnRlbnQoKTtcblxuXHRcdGlmICh0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uICYmICFjb2xDb3VudCkge1xuXHRcdFx0dGhpcy5jb2xsYXBzZUhhbmRsZUNvbHVtbi5zaG93KCk7XG5cdFx0fVxuXHR9XG59O1xuXG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS5zaG93Q29sdW1uID0gZnVuY3Rpb24gKGNvbHVtbikge1xuXHR2YXIgaW5kZXg7XG5cblx0Y29sdW1uLnNob3coZmFsc2UsIHRydWUpO1xuXHQvL3NldCBjb2x1bW4gd2lkdGggdG8gcHJldmVudCBjYWxjdWxhdGlvbiBsb29wcyBvbiB1bmluaXRpYWxpemVkIGNvbHVtbnNcblx0Y29sdW1uLnNldFdpZHRoKGNvbHVtbi5nZXRXaWR0aCgpKTtcblxuXHRpZiAodGhpcy5tb2RlID09PSBcImNvbGxhcHNlXCIpIHtcblx0XHRpbmRleCA9IHRoaXMuaGlkZGVuQ29sdW1ucy5pbmRleE9mKGNvbHVtbik7XG5cblx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0dGhpcy5oaWRkZW5Db2x1bW5zLnNwbGljZShpbmRleCwgMSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5nZW5lcmF0ZUNvbGxhcHNlZENvbnRlbnQoKTtcblxuXHRcdGlmICh0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uICYmICF0aGlzLmhpZGRlbkNvbHVtbnMubGVuZ3RoKSB7XG5cdFx0XHR0aGlzLmNvbGxhcHNlSGFuZGxlQ29sdW1uLmhpZGUoKTtcblx0XHR9XG5cdH1cbn07XG5cbi8vcmVkcmF3IGNvbHVtbnMgdG8gZml0IHNwYWNlXG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHdvcmtpbmcgPSB0cnVlO1xuXG5cdHdoaWxlICh3b3JraW5nKSB7XG5cblx0XHR2YXIgd2lkdGggPSBzZWxmLnRhYmxlLm1vZHVsZXMubGF5b3V0LmdldE1vZGUoKSA9PSBcImZpdENvbHVtbnNcIiA/IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5nZXRGbGV4QmFzZVdpZHRoKCkgOiBzZWxmLnRhYmxlLmNvbHVtbk1hbmFnZXIuZ2V0V2lkdGgoKTtcblxuXHRcdHZhciBkaWZmID0gKHNlbGYudGFibGUub3B0aW9ucy5oZWFkZXJWaXNpYmxlID8gc2VsZi50YWJsZS5jb2x1bW5NYW5hZ2VyLmVsZW1lbnQuY2xpZW50V2lkdGggOiBzZWxmLnRhYmxlLmVsZW1lbnQuY2xpZW50V2lkdGgpIC0gd2lkdGg7XG5cblx0XHRpZiAoZGlmZiA8IDApIHtcblx0XHRcdC8vdGFibGUgaXMgdG9vIHdpZGVcblx0XHRcdHZhciBjb2x1bW4gPSBzZWxmLmNvbHVtbnNbc2VsZi5pbmRleF07XG5cblx0XHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdFx0c2VsZi5oaWRlQ29sdW1uKGNvbHVtbik7XG5cdFx0XHRcdHNlbGYuaW5kZXgrKztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvL3RhYmxlIGhhcyBzcGFyZSBzcGFjZVxuXHRcdFx0dmFyIF9jb2x1bW4gPSBzZWxmLmNvbHVtbnNbc2VsZi5pbmRleCAtIDFdO1xuXG5cdFx0XHRpZiAoX2NvbHVtbikge1xuXHRcdFx0XHRpZiAoZGlmZiA+IDApIHtcblx0XHRcdFx0XHRpZiAoZGlmZiA+PSBfY29sdW1uLmdldFdpZHRoKCkpIHtcblx0XHRcdFx0XHRcdHNlbGYuc2hvd0NvbHVtbihfY29sdW1uKTtcblx0XHRcdFx0XHRcdHNlbGYuaW5kZXgtLTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0d29ya2luZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR3b3JraW5nID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdvcmtpbmcgPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoIXNlbGYudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzQ291bnQpIHtcblx0XHRcdHNlbGYudGFibGUucm93TWFuYWdlci5yZW5kZXJFbXB0eVNjcm9sbCgpO1xuXHRcdH1cblx0fVxufTtcblxuUmVzcG9uc2l2ZUxheW91dC5wcm90b3R5cGUuZ2VuZXJhdGVDb2xsYXBzZWRDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICByb3dzID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dzKCk7XG5cblx0cm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRzZWxmLmdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudChyb3cpO1xuXHR9KTtcbn07XG5cblJlc3BvbnNpdmVMYXlvdXQucHJvdG90eXBlLmdlbmVyYXRlQ29sbGFwc2VkUm93Q29udGVudCA9IGZ1bmN0aW9uIChyb3cpIHtcblx0dmFyIGVsLCBjb250ZW50cztcblxuXHRpZiAocm93Lm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dCkge1xuXHRcdGVsID0gcm93Lm1vZHVsZXMucmVzcG9uc2l2ZUxheW91dC5lbGVtZW50O1xuXG5cdFx0d2hpbGUgKGVsLmZpcnN0Q2hpbGQpIHtcblx0XHRcdGVsLnJlbW92ZUNoaWxkKGVsLmZpcnN0Q2hpbGQpO1xuXHRcdH1jb250ZW50cyA9IHRoaXMuY29sbGFwc2VGb3JtYXR0ZXIodGhpcy5nZW5lcmF0ZUNvbGxhcHNlZFJvd0RhdGEocm93KSk7XG5cdFx0aWYgKGNvbnRlbnRzKSB7XG5cdFx0XHRlbC5hcHBlbmRDaGlsZChjb250ZW50cyk7XG5cdFx0fVxuXHR9XG59O1xuXG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS5nZW5lcmF0ZUNvbGxhcHNlZFJvd0RhdGEgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGRhdGEgPSByb3cuZ2V0RGF0YSgpLFxuXHQgICAgb3V0cHV0ID0gW10sXG5cdCAgICBtb2NrQ2VsbENvbXBvbmVudDtcblxuXHR0aGlzLmhpZGRlbkNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0dmFyIHZhbHVlID0gY29sdW1uLmdldEZpZWxkVmFsdWUoZGF0YSk7XG5cblx0XHRpZiAoY29sdW1uLmRlZmluaXRpb24udGl0bGUgJiYgY29sdW1uLmZpZWxkKSB7XG5cdFx0XHRpZiAoY29sdW1uLm1vZHVsZXMuZm9ybWF0ICYmIHNlbGYudGFibGUub3B0aW9ucy5yZXNwb25zaXZlTGF5b3V0Q29sbGFwc2VVc2VGb3JtYXR0ZXJzKSB7XG5cblx0XHRcdFx0bW9ja0NlbGxDb21wb25lbnQgPSB7XG5cdFx0XHRcdFx0dmFsdWU6IGZhbHNlLFxuXHRcdFx0XHRcdGRhdGE6IHt9LFxuXHRcdFx0XHRcdGdldFZhbHVlOiBmdW5jdGlvbiBnZXRWYWx1ZSgpIHtcblx0XHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldERhdGE6IGZ1bmN0aW9uIGdldERhdGEoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldEVsZW1lbnQ6IGZ1bmN0aW9uIGdldEVsZW1lbnQoKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldFJvdzogZnVuY3Rpb24gZ2V0Um93KCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJvdy5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGdldENvbHVtbjogZnVuY3Rpb24gZ2V0Q29sdW1uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNvbHVtbi5nZXRDb21wb25lbnQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0b3V0cHV0LnB1c2goe1xuXHRcdFx0XHRcdGZpZWxkOiBjb2x1bW4uZmllbGQsXG5cdFx0XHRcdFx0dGl0bGU6IGNvbHVtbi5kZWZpbml0aW9uLnRpdGxlLFxuXHRcdFx0XHRcdHZhbHVlOiBjb2x1bW4ubW9kdWxlcy5mb3JtYXQuZm9ybWF0dGVyLmNhbGwoc2VsZi50YWJsZS5tb2R1bGVzLmZvcm1hdCwgbW9ja0NlbGxDb21wb25lbnQsIGNvbHVtbi5tb2R1bGVzLmZvcm1hdC5wYXJhbXMpXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0b3V0cHV0LnB1c2goe1xuXHRcdFx0XHRcdGZpZWxkOiBjb2x1bW4uZmllbGQsXG5cdFx0XHRcdFx0dGl0bGU6IGNvbHVtbi5kZWZpbml0aW9uLnRpdGxlLFxuXHRcdFx0XHRcdHZhbHVlOiB2YWx1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5SZXNwb25zaXZlTGF5b3V0LnByb3RvdHlwZS5mb3JtYXRDb2xsYXBzZWREYXRhID0gZnVuY3Rpb24gKGRhdGEpIHtcblx0dmFyIGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XG5cblx0ZGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0dmFyIHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcblx0XHR2YXIgdGl0bGVEYXRhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xuXHRcdHZhciB2YWx1ZURhdGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XG5cdFx0dmFyIG5vZGVfY29udGVudDtcblxuXHRcdHZhciB0aXRsZUhpZ2hsaWdodCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHJvbmdcIik7XG5cdFx0dGl0bGVEYXRhLmFwcGVuZENoaWxkKHRpdGxlSGlnaGxpZ2h0KTtcblx0XHR0aGlzLnRhYmxlLm1vZHVsZXMubG9jYWxpemUuYmluZChcImNvbHVtbnN8XCIgKyBpdGVtLmZpZWxkLCBmdW5jdGlvbiAodGV4dCkge1xuXHRcdFx0dGl0bGVIaWdobGlnaHQuaW5uZXJUZXh0ID0gdGV4dCB8fCBpdGVtLnRpdGxlO1xuXHRcdH0pO1xuXG5cdFx0aWYgKGl0ZW0udmFsdWUgaW5zdGFuY2VvZiBOb2RlKSB7XG5cdFx0XHRub2RlX2NvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0bm9kZV9jb250ZW50LmFwcGVuZENoaWxkKGl0ZW0udmFsdWUpO1xuXHRcdFx0dmFsdWVEYXRhLmFwcGVuZENoaWxkKG5vZGVfY29udGVudCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhbHVlRGF0YS5pbm5lckhUTUwgPSBpdGVtLnZhbHVlO1xuXHRcdH1cblxuXHRcdHJvdy5hcHBlbmRDaGlsZCh0aXRsZURhdGEpO1xuXHRcdHJvdy5hcHBlbmRDaGlsZCh2YWx1ZURhdGEpO1xuXHRcdGxpc3QuYXBwZW5kQ2hpbGQocm93KTtcblx0fSwgdGhpcyk7XG5cblx0cmV0dXJuIE9iamVjdC5rZXlzKGRhdGEpLmxlbmd0aCA/IGxpc3QgOiBcIlwiO1xufTtcblxuVGFidWxhdG9yLnByb3RvdHlwZS5yZWdpc3Rlck1vZHVsZShcInJlc3BvbnNpdmVMYXlvdXRcIiwgUmVzcG9uc2l2ZUxheW91dCk7XG5cbnZhciBTZWxlY3RSb3cgPSBmdW5jdGlvbiBTZWxlY3RSb3codGFibGUpIHtcblx0dGhpcy50YWJsZSA9IHRhYmxlOyAvL2hvbGQgVGFidWxhdG9yIG9iamVjdFxuXHR0aGlzLnNlbGVjdGluZyA9IGZhbHNlOyAvL2ZsYWcgc2VsZWN0aW5nIGluIHByb2dyZXNzXG5cdHRoaXMubGFzdENsaWNrZWRSb3cgPSBmYWxzZTsgLy9sYXN0IGNsaWNrZWQgcm93XG5cdHRoaXMuc2VsZWN0UHJldiA9IFtdOyAvL2hvbGQgcHJldmlvdXNseSBzZWxlY3RlZCBlbGVtZW50IGZvciBkcmFnIGRyb3Agc2VsZWN0aW9uXG5cdHRoaXMuc2VsZWN0ZWRSb3dzID0gW107IC8vaG9sZCBzZWxlY3RlZCByb3dzXG5cdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50ID0gbnVsbDsgLy8gaG9sZCBoZWFkZXIgc2VsZWN0IGVsZW1lbnRcbn07XG5cblNlbGVjdFJvdy5wcm90b3R5cGUuY2xlYXJTZWxlY3Rpb25EYXRhID0gZnVuY3Rpb24gKHNpbGVudCkge1xuXHR0aGlzLnNlbGVjdGluZyA9IGZhbHNlO1xuXHR0aGlzLmxhc3RDbGlja2VkUm93ID0gZmFsc2U7XG5cdHRoaXMuc2VsZWN0UHJldiA9IFtdO1xuXHR0aGlzLnNlbGVjdGVkUm93cyA9IFtdO1xuXG5cdGlmICghc2lsZW50KSB7XG5cdFx0dGhpcy5fcm93U2VsZWN0aW9uQ2hhbmdlZCgpO1xuXHR9XG59O1xuXG5TZWxlY3RSb3cucHJvdG90eXBlLmluaXRpYWxpemVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIGVsZW1lbnQgPSByb3cuZ2V0RWxlbWVudCgpO1xuXG5cdC8vIHRyaWdnZXIgZW5kIG9mIHJvdyBzZWxlY3Rpb25cblx0dmFyIGVuZFNlbGVjdCA9IGZ1bmN0aW9uIGVuZFNlbGVjdCgpIHtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0c2VsZi5zZWxlY3RpbmcgPSBmYWxzZTtcblx0XHR9LCA1MCk7XG5cblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGVuZFNlbGVjdCk7XG5cdH07XG5cblx0cm93Lm1vZHVsZXMuc2VsZWN0ID0geyBzZWxlY3RlZDogZmFsc2UgfTtcblxuXHQvL3NldCByb3cgc2VsZWN0aW9uIGNsYXNzXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuc2VsZWN0YWJsZUNoZWNrLmNhbGwodGhpcy50YWJsZSwgcm93LmdldENvbXBvbmVudCgpKSkge1xuXHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1zZWxlY3RhYmxlXCIpO1xuXHRcdGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci11bnNlbGVjdGFibGVcIik7XG5cblx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLnNlbGVjdGFibGUgJiYgc2VsZi50YWJsZS5vcHRpb25zLnNlbGVjdGFibGUgIT0gXCJoaWdobGlnaHRcIikge1xuXHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlUmFuZ2VNb2RlID09PSBcImNsaWNrXCIpIHtcblx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRpZiAoZS5zaGlmdEtleSkge1xuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0XHRcdHNlbGYubGFzdENsaWNrZWRSb3cgPSBzZWxmLmxhc3RDbGlja2VkUm93IHx8IHJvdztcblxuXHRcdFx0XHRcdFx0dmFyIGxhc3RDbGlja2VkUm93SWR4ID0gc2VsZi50YWJsZS5yb3dNYW5hZ2VyLmdldERpc3BsYXlSb3dJbmRleChzZWxmLmxhc3RDbGlja2VkUm93KTtcblx0XHRcdFx0XHRcdHZhciByb3dJZHggPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd0luZGV4KHJvdyk7XG5cblx0XHRcdFx0XHRcdHZhciBmcm9tUm93SWR4ID0gbGFzdENsaWNrZWRSb3dJZHggPD0gcm93SWR4ID8gbGFzdENsaWNrZWRSb3dJZHggOiByb3dJZHg7XG5cdFx0XHRcdFx0XHR2YXIgdG9Sb3dJZHggPSBsYXN0Q2xpY2tlZFJvd0lkeCA+PSByb3dJZHggPyBsYXN0Q2xpY2tlZFJvd0lkeCA6IHJvd0lkeDtcblxuXHRcdFx0XHRcdFx0dmFyIHJvd3MgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZ2V0RGlzcGxheVJvd3MoKS5zbGljZSgwKTtcblx0XHRcdFx0XHRcdHZhciB0b2dnbGVkUm93cyA9IHJvd3Muc3BsaWNlKGZyb21Sb3dJZHgsIHRvUm93SWR4IC0gZnJvbVJvd0lkeCArIDEpO1xuXG5cdFx0XHRcdFx0XHRpZiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkge1xuXHRcdFx0XHRcdFx0XHR0b2dnbGVkUm93cy5mb3JFYWNoKGZ1bmN0aW9uICh0b2dnbGVkUm93KSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRvZ2dsZWRSb3cgIT09IHNlbGYubGFzdENsaWNrZWRSb3cpIHtcblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlICE9PSB0cnVlICYmICFzZWxmLmlzUm93U2VsZWN0ZWQocm93KSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5zZWxlY3RlZFJvd3MubGVuZ3RoIDwgc2VsZi50YWJsZS5vcHRpb25zLnNlbGVjdGFibGUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZWxmLnRvZ2dsZVJvdyh0b2dnbGVkUm93KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2VsZi50b2dnbGVSb3codG9nZ2xlZFJvdyk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0c2VsZi5sYXN0Q2xpY2tlZFJvdyA9IHJvdztcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYuZGVzZWxlY3RSb3dzKHVuZGVmaW5lZCwgdHJ1ZSk7XG5cblx0XHRcdFx0XHRcdFx0aWYgKHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlICE9PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRvZ2dsZWRSb3dzLmxlbmd0aCA+IHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0b2dnbGVkUm93cyA9IHRvZ2dsZWRSb3dzLnNsaWNlKDAsIHNlbGYudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRzZWxmLnNlbGVjdFJvd3ModG9nZ2xlZFJvd3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpIHtcblx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlUm93KHJvdyk7XG5cdFx0XHRcdFx0XHRzZWxmLmxhc3RDbGlja2VkUm93ID0gcm93O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRzZWxmLmRlc2VsZWN0Um93cyh1bmRlZmluZWQsIHRydWUpO1xuXHRcdFx0XHRcdFx0c2VsZi5zZWxlY3RSb3dzKHJvdyk7XG5cdFx0XHRcdFx0XHRzZWxmLmxhc3RDbGlja2VkUm93ID0gcm93O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdGlmICghc2VsZi50YWJsZS5tb2RFeGlzdHMoXCJlZGl0XCIpIHx8ICFzZWxmLnRhYmxlLm1vZHVsZXMuZWRpdC5nZXRDdXJyZW50Q2VsbCgpKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnRhYmxlLl9jbGVhclNlbGVjdGlvbigpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICghc2VsZi5zZWxlY3RpbmcpIHtcblx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlUm93KHJvdyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0XHRpZiAoZS5zaGlmdEtleSkge1xuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblxuXHRcdFx0XHRcdFx0c2VsZi5zZWxlY3RpbmcgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHRzZWxmLnNlbGVjdFByZXYgPSBbXTtcblxuXHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBlbmRTZWxlY3QpO1xuXHRcdFx0XHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZW5kU2VsZWN0KTtcblxuXHRcdFx0XHRcdFx0c2VsZi50b2dnbGVSb3cocm93KTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0ZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdGlmIChzZWxmLnNlbGVjdGluZykge1xuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlUm93KHJvdyk7XG5cblx0XHRcdFx0XHRcdGlmIChzZWxmLnNlbGVjdFByZXZbMV0gPT0gcm93KSB7XG5cdFx0XHRcdFx0XHRcdHNlbGYudG9nZ2xlUm93KHNlbGYuc2VsZWN0UHJldlswXSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0XHRcdGlmIChzZWxmLnNlbGVjdGluZykge1xuXHRcdFx0XHRcdFx0c2VsZi50YWJsZS5fY2xlYXJTZWxlY3Rpb24oKTtcblx0XHRcdFx0XHRcdHNlbGYuc2VsZWN0UHJldi51bnNoaWZ0KHJvdyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0ZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXVuc2VsZWN0YWJsZVwiKTtcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itc2VsZWN0YWJsZVwiKTtcblx0fVxufTtcblxuLy90b2dnbGUgcm93IHNlbGVjdGlvblxuU2VsZWN0Um93LnByb3RvdHlwZS50b2dnbGVSb3cgPSBmdW5jdGlvbiAocm93KSB7XG5cdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuc2VsZWN0YWJsZUNoZWNrLmNhbGwodGhpcy50YWJsZSwgcm93LmdldENvbXBvbmVudCgpKSkge1xuXHRcdGlmIChyb3cubW9kdWxlcy5zZWxlY3QgJiYgcm93Lm1vZHVsZXMuc2VsZWN0LnNlbGVjdGVkKSB7XG5cdFx0XHR0aGlzLl9kZXNlbGVjdFJvdyhyb3cpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZWxlY3RSb3cocm93KTtcblx0XHR9XG5cdH1cbn07XG5cbi8vc2VsZWN0IGEgbnVtYmVyIG9mIHJvd3NcblNlbGVjdFJvdy5wcm90b3R5cGUuc2VsZWN0Um93cyA9IGZ1bmN0aW9uIChyb3dzKSB7XG5cdHZhciBfdGhpczg0ID0gdGhpcztcblxuXHR2YXIgcm93TWF0Y2g7XG5cblx0c3dpdGNoICh0eXBlb2Ygcm93cyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2Yocm93cykpIHtcblx0XHRjYXNlIFwidW5kZWZpbmVkXCI6XG5cdFx0XHR0aGlzLnRhYmxlLnJvd01hbmFnZXIucm93cy5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHtcblx0XHRcdFx0X3RoaXM4NC5fc2VsZWN0Um93KHJvdywgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5fcm93U2VsZWN0aW9uQ2hhbmdlZCgpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cblx0XHRcdHJvd01hdGNoID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93cyk7XG5cblx0XHRcdGlmIChyb3dNYXRjaCkge1xuXHRcdFx0XHR0aGlzLl9zZWxlY3RSb3cocm93TWF0Y2gsIHRydWUsIHRydWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLmdldFJvd3Mocm93cykuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRcdFx0X3RoaXM4NC5fc2VsZWN0Um93KHJvdywgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKCk7XG5cdFx0XHRicmVhaztcblxuXHRcdGRlZmF1bHQ6XG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheShyb3dzKSkge1xuXHRcdFx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRcdF90aGlzODQuX3NlbGVjdFJvdyhyb3csIHRydWUsIHRydWUpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9zZWxlY3RSb3cocm93cywgZmFsc2UsIHRydWUpO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdH1cbn07XG5cbi8vc2VsZWN0IGFuIGluZGl2aWR1YWwgcm93XG5TZWxlY3RSb3cucHJvdG90eXBlLl9zZWxlY3RSb3cgPSBmdW5jdGlvbiAocm93SW5mbywgc2lsZW50LCBmb3JjZSkge1xuXHR2YXIgaW5kZXg7XG5cblx0Ly9oYW5kbGUgbWF4IHJvdyBjb3VudFxuXHRpZiAoIWlzTmFOKHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlKSAmJiB0aGlzLnRhYmxlLm9wdGlvbnMuc2VsZWN0YWJsZSAhPT0gdHJ1ZSAmJiAhZm9yY2UpIHtcblx0XHRpZiAodGhpcy5zZWxlY3RlZFJvd3MubGVuZ3RoID49IHRoaXMudGFibGUub3B0aW9ucy5zZWxlY3RhYmxlKSB7XG5cdFx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnNlbGVjdGFibGVSb2xsaW5nU2VsZWN0aW9uKSB7XG5cdFx0XHRcdHRoaXMuX2Rlc2VsZWN0Um93KHRoaXMuc2VsZWN0ZWRSb3dzWzBdKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHR2YXIgcm93ID0gdGhpcy50YWJsZS5yb3dNYW5hZ2VyLmZpbmRSb3cocm93SW5mbyk7XG5cblx0aWYgKHJvdykge1xuXHRcdGlmICh0aGlzLnNlbGVjdGVkUm93cy5pbmRleE9mKHJvdykgPT0gLTEpIHtcblx0XHRcdHJvdy5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LmFkZChcInRhYnVsYXRvci1zZWxlY3RlZFwiKTtcblx0XHRcdGlmICghcm93Lm1vZHVsZXMuc2VsZWN0KSB7XG5cdFx0XHRcdHJvdy5tb2R1bGVzLnNlbGVjdCA9IHt9O1xuXHRcdFx0fVxuXG5cdFx0XHRyb3cubW9kdWxlcy5zZWxlY3Quc2VsZWN0ZWQgPSB0cnVlO1xuXHRcdFx0aWYgKHJvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsKSB7XG5cdFx0XHRcdHJvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsLmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnNlbGVjdGVkUm93cy5wdXNoKHJvdyk7XG5cblx0XHRcdGlmICh0aGlzLnRhYmxlLm9wdGlvbnMuZGF0YVRyZWVTZWxlY3RQcm9wYWdhdGUpIHtcblx0XHRcdFx0dGhpcy5jaGlsZFJvd1NlbGVjdGlvbihyb3csIHRydWUpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXNpbGVudCkge1xuXHRcdFx0XHR0aGlzLnRhYmxlLm9wdGlvbnMucm93U2VsZWN0ZWQuY2FsbCh0aGlzLnRhYmxlLCByb3cuZ2V0Q29tcG9uZW50KCkpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9yb3dTZWxlY3Rpb25DaGFuZ2VkKHNpbGVudCk7XG5cdFx0fVxuXHR9IGVsc2Uge1xuXHRcdGlmICghc2lsZW50KSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJTZWxlY3Rpb24gRXJyb3IgLSBObyBzdWNoIHJvdyBmb3VuZCwgaWdub3Jpbmcgc2VsZWN0aW9uOlwiICsgcm93SW5mbyk7XG5cdFx0fVxuXHR9XG59O1xuXG5TZWxlY3RSb3cucHJvdG90eXBlLmlzUm93U2VsZWN0ZWQgPSBmdW5jdGlvbiAocm93KSB7XG5cdHJldHVybiB0aGlzLnNlbGVjdGVkUm93cy5pbmRleE9mKHJvdykgIT09IC0xO1xufTtcblxuLy9kZXNlbGVjdCBhIG51bWJlciBvZiByb3dzXG5TZWxlY3RSb3cucHJvdG90eXBlLmRlc2VsZWN0Um93cyA9IGZ1bmN0aW9uIChyb3dzLCBzaWxlbnQpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgcm93Q291bnQ7XG5cblx0aWYgKHR5cGVvZiByb3dzID09IFwidW5kZWZpbmVkXCIpIHtcblxuXHRcdHJvd0NvdW50ID0gc2VsZi5zZWxlY3RlZFJvd3MubGVuZ3RoO1xuXG5cdFx0Zm9yICh2YXIgX2kxOCA9IDA7IF9pMTggPCByb3dDb3VudDsgX2kxOCsrKSB7XG5cdFx0XHRzZWxmLl9kZXNlbGVjdFJvdyhzZWxmLnNlbGVjdGVkUm93c1swXSwgdHJ1ZSk7XG5cdFx0fVxuXG5cdFx0c2VsZi5fcm93U2VsZWN0aW9uQ2hhbmdlZChzaWxlbnQpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChBcnJheS5pc0FycmF5KHJvd3MpKSB7XG5cdFx0XHRyb3dzLmZvckVhY2goZnVuY3Rpb24gKHJvdykge1xuXHRcdFx0XHRzZWxmLl9kZXNlbGVjdFJvdyhyb3csIHRydWUpO1xuXHRcdFx0fSk7XG5cblx0XHRcdHNlbGYuX3Jvd1NlbGVjdGlvbkNoYW5nZWQoc2lsZW50KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c2VsZi5fZGVzZWxlY3RSb3cocm93cywgc2lsZW50KTtcblx0XHR9XG5cdH1cbn07XG5cbi8vZGVzZWxlY3QgYW4gaW5kaXZpZHVhbCByb3dcblNlbGVjdFJvdy5wcm90b3R5cGUuX2Rlc2VsZWN0Um93ID0gZnVuY3Rpb24gKHJvd0luZm8sIHNpbGVudCkge1xuXHR2YXIgc2VsZiA9IHRoaXMsXG5cdCAgICByb3cgPSBzZWxmLnRhYmxlLnJvd01hbmFnZXIuZmluZFJvdyhyb3dJbmZvKSxcblx0ICAgIGluZGV4O1xuXG5cdGlmIChyb3cpIHtcblx0XHRpbmRleCA9IHNlbGYuc2VsZWN0ZWRSb3dzLmZpbmRJbmRleChmdW5jdGlvbiAoc2VsZWN0ZWRSb3cpIHtcblx0XHRcdHJldHVybiBzZWxlY3RlZFJvdyA9PSByb3c7XG5cdFx0fSk7XG5cblx0XHRpZiAoaW5kZXggPiAtMSkge1xuXG5cdFx0XHRyb3cuZ2V0RWxlbWVudCgpLmNsYXNzTGlzdC5yZW1vdmUoXCJ0YWJ1bGF0b3Itc2VsZWN0ZWRcIik7XG5cdFx0XHRpZiAoIXJvdy5tb2R1bGVzLnNlbGVjdCkge1xuXHRcdFx0XHRyb3cubW9kdWxlcy5zZWxlY3QgPSB7fTtcblx0XHRcdH1cblxuXHRcdFx0cm93Lm1vZHVsZXMuc2VsZWN0LnNlbGVjdGVkID0gZmFsc2U7XG5cdFx0XHRpZiAocm93Lm1vZHVsZXMuc2VsZWN0LmNoZWNrYm94RWwpIHtcblx0XHRcdFx0cm93Lm1vZHVsZXMuc2VsZWN0LmNoZWNrYm94RWwuY2hlY2tlZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0c2VsZi5zZWxlY3RlZFJvd3Muc3BsaWNlKGluZGV4LCAxKTtcblxuXHRcdFx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5kYXRhVHJlZVNlbGVjdFByb3BhZ2F0ZSkge1xuXHRcdFx0XHR0aGlzLmNoaWxkUm93U2VsZWN0aW9uKHJvdywgZmFsc2UpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIXNpbGVudCkge1xuXHRcdFx0XHRzZWxmLnRhYmxlLm9wdGlvbnMucm93RGVzZWxlY3RlZC5jYWxsKHRoaXMudGFibGUsIHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdFx0XHR9XG5cblx0XHRcdHNlbGYuX3Jvd1NlbGVjdGlvbkNoYW5nZWQoc2lsZW50KTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0aWYgKCFzaWxlbnQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkRlc2VsZWN0aW9uIEVycm9yIC0gTm8gc3VjaCByb3cgZm91bmQsIGlnbm9yaW5nIHNlbGVjdGlvbjpcIiArIHJvd0luZm8pO1xuXHRcdH1cblx0fVxufTtcblxuU2VsZWN0Um93LnByb3RvdHlwZS5nZXRTZWxlY3RlZERhdGEgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBkYXRhID0gW107XG5cblx0dGhpcy5zZWxlY3RlZFJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0ZGF0YS5wdXNoKHJvdy5nZXREYXRhKCkpO1xuXHR9KTtcblxuXHRyZXR1cm4gZGF0YTtcbn07XG5cblNlbGVjdFJvdy5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRSb3dzID0gZnVuY3Rpb24gKCkge1xuXG5cdHZhciByb3dzID0gW107XG5cblx0dGhpcy5zZWxlY3RlZFJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0cm93cy5wdXNoKHJvdy5nZXRDb21wb25lbnQoKSk7XG5cdH0pO1xuXG5cdHJldHVybiByb3dzO1xufTtcblxuU2VsZWN0Um93LnByb3RvdHlwZS5fcm93U2VsZWN0aW9uQ2hhbmdlZCA9IGZ1bmN0aW9uIChzaWxlbnQpIHtcblx0aWYgKHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50KSB7XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWRSb3dzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5oZWFkZXJDaGVja2JveEVsZW1lbnQuY2hlY2tlZCA9IGZhbHNlO1xuXHRcdFx0dGhpcy5oZWFkZXJDaGVja2JveEVsZW1lbnQuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuXHRcdH0gZWxzZSBpZiAodGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MubGVuZ3RoID09PSB0aGlzLnNlbGVjdGVkUm93cy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50LmNoZWNrZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5oZWFkZXJDaGVja2JveEVsZW1lbnQuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmhlYWRlckNoZWNrYm94RWxlbWVudC5pbmRldGVybWluYXRlID0gdHJ1ZTtcblx0XHRcdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50LmNoZWNrZWQgPSBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRpZiAoIXNpbGVudCkge1xuXHRcdHRoaXMudGFibGUub3B0aW9ucy5yb3dTZWxlY3Rpb25DaGFuZ2VkLmNhbGwodGhpcy50YWJsZSwgdGhpcy5nZXRTZWxlY3RlZERhdGEoKSwgdGhpcy5nZXRTZWxlY3RlZFJvd3MoKSk7XG5cdH1cbn07XG5cblNlbGVjdFJvdy5wcm90b3R5cGUucmVnaXN0ZXJSb3dTZWxlY3RDaGVja2JveCA9IGZ1bmN0aW9uIChyb3csIGVsZW1lbnQpIHtcblx0aWYgKCFyb3cuX3Jvdy5tb2R1bGVzLnNlbGVjdCkge1xuXHRcdHJvdy5fcm93Lm1vZHVsZXMuc2VsZWN0ID0ge307XG5cdH1cblxuXHRyb3cuX3Jvdy5tb2R1bGVzLnNlbGVjdC5jaGVja2JveEVsID0gZWxlbWVudDtcbn07XG5cblNlbGVjdFJvdy5wcm90b3R5cGUucmVnaXN0ZXJIZWFkZXJTZWxlY3RDaGVja2JveCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG5cdHRoaXMuaGVhZGVyQ2hlY2tib3hFbGVtZW50ID0gZWxlbWVudDtcbn07XG5cblNlbGVjdFJvdy5wcm90b3R5cGUuY2hpbGRSb3dTZWxlY3Rpb24gPSBmdW5jdGlvbiAocm93LCBzZWxlY3QpIHtcblx0dmFyIGNoaWxkcmVuID0gdGhpcy50YWJsZS5tb2R1bGVzLmRhdGFUcmVlLmdldENoaWxkcmVuKHJvdywgdHJ1ZSk7XG5cblx0aWYgKHNlbGVjdCkge1xuXHRcdGZvciAodmFyIF9pdGVyYXRvcjIgPSBjaGlsZHJlbiwgX2lzQXJyYXkyID0gQXJyYXkuaXNBcnJheShfaXRlcmF0b3IyKSwgX2kxOSA9IDAsIF9pdGVyYXRvcjIgPSBfaXNBcnJheTIgPyBfaXRlcmF0b3IyIDogX2l0ZXJhdG9yMltTeW1ib2wuaXRlcmF0b3JdKCk7Oykge1xuXHRcdFx0dmFyIF9yZWYyO1xuXG5cdFx0XHRpZiAoX2lzQXJyYXkyKSB7XG5cdFx0XHRcdGlmIChfaTE5ID49IF9pdGVyYXRvcjIubGVuZ3RoKSBicmVhaztcblx0XHRcdFx0X3JlZjIgPSBfaXRlcmF0b3IyW19pMTkrK107XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRfaTE5ID0gX2l0ZXJhdG9yMi5uZXh0KCk7XG5cdFx0XHRcdGlmIChfaTE5LmRvbmUpIGJyZWFrO1xuXHRcdFx0XHRfcmVmMiA9IF9pMTkudmFsdWU7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBjaGlsZCA9IF9yZWYyO1xuXG5cdFx0XHR0aGlzLl9zZWxlY3RSb3coY2hpbGQsIHRydWUpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRmb3IgKHZhciBfaXRlcmF0b3IzID0gY2hpbGRyZW4sIF9pc0FycmF5MyA9IEFycmF5LmlzQXJyYXkoX2l0ZXJhdG9yMyksIF9pMjAgPSAwLCBfaXRlcmF0b3IzID0gX2lzQXJyYXkzID8gX2l0ZXJhdG9yMyA6IF9pdGVyYXRvcjNbU3ltYm9sLml0ZXJhdG9yXSgpOzspIHtcblx0XHRcdHZhciBfcmVmMztcblxuXHRcdFx0aWYgKF9pc0FycmF5Mykge1xuXHRcdFx0XHRpZiAoX2kyMCA+PSBfaXRlcmF0b3IzLmxlbmd0aCkgYnJlYWs7XG5cdFx0XHRcdF9yZWYzID0gX2l0ZXJhdG9yM1tfaTIwKytdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0X2kyMCA9IF9pdGVyYXRvcjMubmV4dCgpO1xuXHRcdFx0XHRpZiAoX2kyMC5kb25lKSBicmVhaztcblx0XHRcdFx0X3JlZjMgPSBfaTIwLnZhbHVlO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgX2NoaWxkID0gX3JlZjM7XG5cblx0XHRcdHRoaXMuX2Rlc2VsZWN0Um93KF9jaGlsZCwgdHJ1ZSk7XG5cdFx0fVxuXHR9XG59O1xuXG5UYWJ1bGF0b3IucHJvdG90eXBlLnJlZ2lzdGVyTW9kdWxlKFwic2VsZWN0Um93XCIsIFNlbGVjdFJvdyk7XG5cbnZhciBTb3J0ID0gZnVuY3Rpb24gU29ydCh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7IC8vaG9sZCBUYWJ1bGF0b3Igb2JqZWN0XG5cdHRoaXMuc29ydExpc3QgPSBbXTsgLy9ob2xkZXIgY3VycmVudCBzb3J0XG5cdHRoaXMuY2hhbmdlZCA9IGZhbHNlOyAvL2hhcyB0aGUgc29ydCBjaGFuZ2VkIHNpbmNlIGxhc3QgcmVuZGVyXG59O1xuXG4vL2luaXRpYWxpemUgY29sdW1uIGhlYWRlciBmb3Igc29ydGluZ1xuU29ydC5wcm90b3R5cGUuaW5pdGlhbGl6ZUNvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4sIGNvbnRlbnQpIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgc29ydGVyID0gZmFsc2UsXG5cdCAgICBjb2xFbCxcblx0ICAgIGFycm93RWw7XG5cblx0c3dpdGNoIChfdHlwZW9mKGNvbHVtbi5kZWZpbml0aW9uLnNvcnRlcikpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRpZiAoc2VsZi5zb3J0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLnNvcnRlcl0pIHtcblx0XHRcdFx0c29ydGVyID0gc2VsZi5zb3J0ZXJzW2NvbHVtbi5kZWZpbml0aW9uLnNvcnRlcl07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJTb3J0IEVycm9yIC0gTm8gc3VjaCBzb3J0ZXIgZm91bmQ6IFwiLCBjb2x1bW4uZGVmaW5pdGlvbi5zb3J0ZXIpO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cblx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdHNvcnRlciA9IGNvbHVtbi5kZWZpbml0aW9uLnNvcnRlcjtcblx0XHRcdGJyZWFrO1xuXHR9XG5cblx0Y29sdW1uLm1vZHVsZXMuc29ydCA9IHtcblx0XHRzb3J0ZXI6IHNvcnRlciwgZGlyOiBcIm5vbmVcIixcblx0XHRwYXJhbXM6IGNvbHVtbi5kZWZpbml0aW9uLnNvcnRlclBhcmFtcyB8fCB7fSxcblx0XHRzdGFydGluZ0RpcjogY29sdW1uLmRlZmluaXRpb24uaGVhZGVyU29ydFN0YXJ0aW5nRGlyIHx8IFwiYXNjXCIsXG5cdFx0dHJpc3RhdGU6IHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0VHJpc3RhdGUgIT09IFwidW5kZWZpbmVkXCIgPyBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0VHJpc3RhdGUgOiB0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydFRyaXN0YXRlXG5cdH07XG5cblx0aWYgKHR5cGVvZiBjb2x1bW4uZGVmaW5pdGlvbi5oZWFkZXJTb3J0ID09PSBcInVuZGVmaW5lZFwiID8gdGhpcy50YWJsZS5vcHRpb25zLmhlYWRlclNvcnQgIT09IGZhbHNlIDogY29sdW1uLmRlZmluaXRpb24uaGVhZGVyU29ydCAhPT0gZmFsc2UpIHtcblxuXHRcdGNvbEVsID0gY29sdW1uLmdldEVsZW1lbnQoKTtcblxuXHRcdGNvbEVsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3Itc29ydGFibGVcIik7XG5cblx0XHRhcnJvd0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRhcnJvd0VsLmNsYXNzTGlzdC5hZGQoXCJ0YWJ1bGF0b3ItY29sLXNvcnRlclwiKTtcblxuXHRcdGlmIChfdHlwZW9mKHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJTb3J0RWxlbWVudCkgPT0gXCJvYmplY3RcIikge1xuXHRcdFx0YXJyb3dFbC5hcHBlbmRDaGlsZCh0aGlzLnRhYmxlLm9wdGlvbnMuaGVhZGVyU29ydEVsZW1lbnQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhcnJvd0VsLmlubmVySFRNTCA9IHRoaXMudGFibGUub3B0aW9ucy5oZWFkZXJTb3J0RWxlbWVudDtcblx0XHR9XG5cblx0XHQvL2NyZWF0ZSBzb3J0ZXIgYXJyb3dcblx0XHRjb250ZW50LmFwcGVuZENoaWxkKGFycm93RWwpO1xuXG5cdFx0Y29sdW1uLm1vZHVsZXMuc29ydC5lbGVtZW50ID0gYXJyb3dFbDtcblxuXHRcdC8vc29ydCBvbiBjbGlja1xuXHRcdGNvbEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xuXHRcdFx0dmFyIGRpciA9IFwiXCIsXG5cdFx0XHQgICAgc29ydGVycyA9IFtdLFxuXHRcdFx0ICAgIG1hdGNoID0gZmFsc2U7XG5cblx0XHRcdGlmIChjb2x1bW4ubW9kdWxlcy5zb3J0KSB7XG5cdFx0XHRcdGlmIChjb2x1bW4ubW9kdWxlcy5zb3J0LnRyaXN0YXRlKSB7XG5cdFx0XHRcdFx0aWYgKGNvbHVtbi5tb2R1bGVzLnNvcnQuZGlyID09IFwibm9uZVwiKSB7XG5cdFx0XHRcdFx0XHRkaXIgPSBjb2x1bW4ubW9kdWxlcy5zb3J0LnN0YXJ0aW5nRGlyO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoY29sdW1uLm1vZHVsZXMuc29ydC5kaXIgPT0gY29sdW1uLm1vZHVsZXMuc29ydC5zdGFydGluZ0Rpcikge1xuXHRcdFx0XHRcdFx0XHRkaXIgPSBjb2x1bW4ubW9kdWxlcy5zb3J0LmRpciA9PSBcImFzY1wiID8gXCJkZXNjXCIgOiBcImFzY1wiO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0ZGlyID0gXCJub25lXCI7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHN3aXRjaCAoY29sdW1uLm1vZHVsZXMuc29ydC5kaXIpIHtcblx0XHRcdFx0XHRcdGNhc2UgXCJhc2NcIjpcblx0XHRcdFx0XHRcdFx0ZGlyID0gXCJkZXNjXCI7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdFx0XHRjYXNlIFwiZGVzY1wiOlxuXHRcdFx0XHRcdFx0XHRkaXIgPSBcImFzY1wiO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0ZGlyID0gY29sdW1uLm1vZHVsZXMuc29ydC5zdGFydGluZ0Rpcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmNvbHVtbkhlYWRlclNvcnRNdWx0aSAmJiAoZS5zaGlmdEtleSB8fCBlLmN0cmxLZXkpKSB7XG5cdFx0XHRcdFx0c29ydGVycyA9IHNlbGYuZ2V0U29ydCgpO1xuXG5cdFx0XHRcdFx0bWF0Y2ggPSBzb3J0ZXJzLmZpbmRJbmRleChmdW5jdGlvbiAoc29ydGVyKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gc29ydGVyLmZpZWxkID09PSBjb2x1bW4uZ2V0RmllbGQoKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChtYXRjaCA+IC0xKSB7XG5cdFx0XHRcdFx0XHRzb3J0ZXJzW21hdGNoXS5kaXIgPSBkaXI7XG5cblx0XHRcdFx0XHRcdGlmIChtYXRjaCAhPSBzb3J0ZXJzLmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0XHRcdFx0bWF0Y2ggPSBzb3J0ZXJzLnNwbGljZShtYXRjaCwgMSlbMF07XG5cdFx0XHRcdFx0XHRcdGlmIChkaXIgIT0gXCJub25lXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRzb3J0ZXJzLnB1c2gobWF0Y2gpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChkaXIgIT0gXCJub25lXCIpIHtcblx0XHRcdFx0XHRcdFx0c29ydGVycy5wdXNoKHsgY29sdW1uOiBjb2x1bW4sIGRpcjogZGlyIH0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vYWRkIHRvIGV4aXN0aW5nIHNvcnRcblx0XHRcdFx0XHRzZWxmLnNldFNvcnQoc29ydGVycyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKGRpciA9PSBcIm5vbmVcIikge1xuXHRcdFx0XHRcdFx0c2VsZi5jbGVhcigpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvL3NvcnQgYnkgY29sdW1uIG9ubHlcblx0XHRcdFx0XHRcdHNlbGYuc2V0U29ydChjb2x1bW4sIGRpcik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2VsZi50YWJsZS5yb3dNYW5hZ2VyLnNvcnRlclJlZnJlc2goIXNlbGYuc29ydExpc3QubGVuZ3RoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxufTtcblxuLy9jaGVjayBpZiB0aGUgc29ydGVycyBoYXZlIGNoYW5nZWQgc2luY2UgbGFzdCB1c2VcblNvcnQucHJvdG90eXBlLmhhc0NoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBjaGFuZ2VkID0gdGhpcy5jaGFuZ2VkO1xuXHR0aGlzLmNoYW5nZWQgPSBmYWxzZTtcblx0cmV0dXJuIGNoYW5nZWQ7XG59O1xuXG4vL3JldHVybiBjdXJyZW50IHNvcnRlcnNcblNvcnQucHJvdG90eXBlLmdldFNvcnQgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHNvcnRlcnMgPSBbXTtcblxuXHRzZWxmLnNvcnRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRpZiAoaXRlbS5jb2x1bW4pIHtcblx0XHRcdHNvcnRlcnMucHVzaCh7IGNvbHVtbjogaXRlbS5jb2x1bW4uZ2V0Q29tcG9uZW50KCksIGZpZWxkOiBpdGVtLmNvbHVtbi5nZXRGaWVsZCgpLCBkaXI6IGl0ZW0uZGlyIH0pO1xuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIHNvcnRlcnM7XG59O1xuXG4vL2NoYW5nZSBzb3J0IGxpc3QgYW5kIHRyaWdnZXIgc29ydFxuU29ydC5wcm90b3R5cGUuc2V0U29ydCA9IGZ1bmN0aW9uIChzb3J0TGlzdCwgZGlyKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIG5ld1NvcnRMaXN0ID0gW107XG5cblx0aWYgKCFBcnJheS5pc0FycmF5KHNvcnRMaXN0KSkge1xuXHRcdHNvcnRMaXN0ID0gW3sgY29sdW1uOiBzb3J0TGlzdCwgZGlyOiBkaXIgfV07XG5cdH1cblxuXHRzb3J0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0dmFyIGNvbHVtbjtcblxuXHRcdGNvbHVtbiA9IHNlbGYudGFibGUuY29sdW1uTWFuYWdlci5maW5kQ29sdW1uKGl0ZW0uY29sdW1uKTtcblxuXHRcdGlmIChjb2x1bW4pIHtcblx0XHRcdGl0ZW0uY29sdW1uID0gY29sdW1uO1xuXHRcdFx0bmV3U29ydExpc3QucHVzaChpdGVtKTtcblx0XHRcdHNlbGYuY2hhbmdlZCA9IHRydWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlNvcnQgV2FybmluZyAtIFNvcnQgZmllbGQgZG9lcyBub3QgZXhpc3QgYW5kIGlzIGJlaW5nIGlnbm9yZWQ6IFwiLCBpdGVtLmNvbHVtbik7XG5cdFx0fVxuXHR9KTtcblxuXHRzZWxmLnNvcnRMaXN0ID0gbmV3U29ydExpc3Q7XG5cblx0aWYgKHRoaXMudGFibGUub3B0aW9ucy5wZXJzaXN0ZW5jZSAmJiB0aGlzLnRhYmxlLm1vZEV4aXN0cyhcInBlcnNpc3RlbmNlXCIsIHRydWUpICYmIHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5jb25maWcuc29ydCkge1xuXHRcdHRoaXMudGFibGUubW9kdWxlcy5wZXJzaXN0ZW5jZS5zYXZlKFwic29ydFwiKTtcblx0fVxufTtcblxuLy9jbGVhciBzb3J0ZXJzXG5Tb3J0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5zZXRTb3J0KFtdKTtcbn07XG5cbi8vZmluZCBhcHByb3ByaWF0ZSBzb3J0ZXIgZm9yIGNvbHVtblxuU29ydC5wcm90b3R5cGUuZmluZFNvcnRlciA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHJvdyA9IHRoaXMudGFibGUucm93TWFuYWdlci5hY3RpdmVSb3dzWzBdLFxuXHQgICAgc29ydGVyID0gXCJzdHJpbmdcIixcblx0ICAgIGZpZWxkLFxuXHQgICAgdmFsdWU7XG5cblx0aWYgKHJvdykge1xuXHRcdHJvdyA9IHJvdy5nZXREYXRhKCk7XG5cdFx0ZmllbGQgPSBjb2x1bW4uZ2V0RmllbGQoKTtcblxuXHRcdGlmIChmaWVsZCkge1xuXG5cdFx0XHR2YWx1ZSA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKHJvdyk7XG5cblx0XHRcdHN3aXRjaCAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpIHtcblx0XHRcdFx0Y2FzZSBcInVuZGVmaW5lZFwiOlxuXHRcdFx0XHRcdHNvcnRlciA9IFwic3RyaW5nXCI7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdFx0Y2FzZSBcImJvb2xlYW5cIjpcblx0XHRcdFx0XHRzb3J0ZXIgPSBcImJvb2xlYW5cIjtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdGlmICghaXNOYU4odmFsdWUpICYmIHZhbHVlICE9PSBcIlwiKSB7XG5cdFx0XHRcdFx0XHRzb3J0ZXIgPSBcIm51bWJlclwiO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUubWF0Y2goLygoXlswLTldK1thLXpdKyl8KF5bYS16XStbMC05XSspKSskL2kpKSB7XG5cdFx0XHRcdFx0XHRcdHNvcnRlciA9IFwiYWxwaGFudW1cIjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoaXMuc29ydGVyc1tzb3J0ZXJdO1xufTtcblxuLy93b3JrIHRocm91Z2ggc29ydCBsaXN0IHNvcnRpbmcgZGF0YVxuU29ydC5wcm90b3R5cGUuc29ydCA9IGZ1bmN0aW9uIChkYXRhKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHNvcnRMaXN0ID0gdGhpcy50YWJsZS5vcHRpb25zLnNvcnRPcmRlclJldmVyc2UgPyBzZWxmLnNvcnRMaXN0LnNsaWNlKCkucmV2ZXJzZSgpIDogc2VsZi5zb3J0TGlzdCxcblx0ICAgIHNvcnRMaXN0QWN0dWFsID0gW10sXG5cdCAgICByb3dDb21wb25lbnRzID0gW10sXG5cdCAgICBsYXN0U29ydDtcblxuXHRpZiAoc2VsZi50YWJsZS5vcHRpb25zLmRhdGFTb3J0aW5nKSB7XG5cdFx0c2VsZi50YWJsZS5vcHRpb25zLmRhdGFTb3J0aW5nLmNhbGwoc2VsZi50YWJsZSwgc2VsZi5nZXRTb3J0KCkpO1xuXHR9XG5cblx0c2VsZi5jbGVhckNvbHVtbkhlYWRlcnMoKTtcblxuXHRpZiAoIXNlbGYudGFibGUub3B0aW9ucy5hamF4U29ydGluZykge1xuXG5cdFx0Ly9idWlsZCBsaXN0IG9mIHZhbGlkIHNvcnRlcnMgYW5kIHRyaWdnZXIgY29sdW1uIHNwZWNpZmljIGNhbGxiYWNrcyBiZWZvcmUgc29ydCBiZWdpbnNcblx0XHRzb3J0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpKSB7XG5cdFx0XHR2YXIgc29ydE9iaiA9IGl0ZW0uY29sdW1uLm1vZHVsZXMuc29ydDtcblxuXHRcdFx0aWYgKGl0ZW0uY29sdW1uICYmIHNvcnRPYmopIHtcblxuXHRcdFx0XHQvL2lmIG5vIHNvcnRlciBoYXMgYmVlbiBkZWZpbmVkLCB0YWtlIGEgZ3Vlc3Ncblx0XHRcdFx0aWYgKCFzb3J0T2JqLnNvcnRlcikge1xuXHRcdFx0XHRcdHNvcnRPYmouc29ydGVyID0gc2VsZi5maW5kU29ydGVyKGl0ZW0uY29sdW1uKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGl0ZW0ucGFyYW1zID0gdHlwZW9mIHNvcnRPYmoucGFyYW1zID09PSBcImZ1bmN0aW9uXCIgPyBzb3J0T2JqLnBhcmFtcyhpdGVtLmNvbHVtbi5nZXRDb21wb25lbnQoKSwgaXRlbS5kaXIpIDogc29ydE9iai5wYXJhbXM7XG5cblx0XHRcdFx0c29ydExpc3RBY3R1YWwucHVzaChpdGVtKTtcblx0XHRcdH1cblxuXHRcdFx0c2VsZi5zZXRDb2x1bW5IZWFkZXIoaXRlbS5jb2x1bW4sIGl0ZW0uZGlyKTtcblx0XHR9KTtcblxuXHRcdC8vc29ydCBkYXRhXG5cdFx0aWYgKHNvcnRMaXN0QWN0dWFsLmxlbmd0aCkge1xuXHRcdFx0c2VsZi5fc29ydEl0ZW1zKGRhdGEsIHNvcnRMaXN0QWN0dWFsKTtcblx0XHR9XG5cdH0gZWxzZSB7XG5cdFx0c29ydExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaSkge1xuXHRcdFx0c2VsZi5zZXRDb2x1bW5IZWFkZXIoaXRlbS5jb2x1bW4sIGl0ZW0uZGlyKTtcblx0XHR9KTtcblx0fVxuXG5cdGlmIChzZWxmLnRhYmxlLm9wdGlvbnMuZGF0YVNvcnRlZCkge1xuXHRcdGRhdGEuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHRyb3dDb21wb25lbnRzLnB1c2gocm93LmdldENvbXBvbmVudCgpKTtcblx0XHR9KTtcblxuXHRcdHNlbGYudGFibGUub3B0aW9ucy5kYXRhU29ydGVkLmNhbGwoc2VsZi50YWJsZSwgc2VsZi5nZXRTb3J0KCksIHJvd0NvbXBvbmVudHMpO1xuXHR9XG59O1xuXG4vL2NsZWFyIHNvcnQgYXJyb3dzIG9uIGNvbHVtbnNcblNvcnQucHJvdG90eXBlLmNsZWFyQ29sdW1uSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy50YWJsZS5jb2x1bW5NYW5hZ2VyLmdldFJlYWxDb2x1bW5zKCkuZm9yRWFjaChmdW5jdGlvbiAoY29sdW1uKSB7XG5cdFx0aWYgKGNvbHVtbi5tb2R1bGVzLnNvcnQpIHtcblx0XHRcdGNvbHVtbi5tb2R1bGVzLnNvcnQuZGlyID0gXCJub25lXCI7XG5cdFx0XHRjb2x1bW4uZ2V0RWxlbWVudCgpLnNldEF0dHJpYnV0ZShcImFyaWEtc29ydFwiLCBcIm5vbmVcIik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8vc2V0IHRoZSBjb2x1bW4gaGVhZGVyIHNvcnQgZGlyZWN0aW9uXG5Tb3J0LnByb3RvdHlwZS5zZXRDb2x1bW5IZWFkZXIgPSBmdW5jdGlvbiAoY29sdW1uLCBkaXIpIHtcblx0Y29sdW1uLm1vZHVsZXMuc29ydC5kaXIgPSBkaXI7XG5cdGNvbHVtbi5nZXRFbGVtZW50KCkuc2V0QXR0cmlidXRlKFwiYXJpYS1zb3J0XCIsIGRpcik7XG59O1xuXG4vL3NvcnQgZWFjaCBpdGVtIGluIHNvcnQgbGlzdFxuU29ydC5wcm90b3R5cGUuX3NvcnRJdGVtcyA9IGZ1bmN0aW9uIChkYXRhLCBzb3J0TGlzdCkge1xuXHR2YXIgX3RoaXM4NSA9IHRoaXM7XG5cblx0dmFyIHNvcnRlckNvdW50ID0gc29ydExpc3QubGVuZ3RoIC0gMTtcblxuXHRkYXRhLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0XHR2YXIgcmVzdWx0O1xuXG5cdFx0Zm9yICh2YXIgaSA9IHNvcnRlckNvdW50OyBpID49IDA7IGktLSkge1xuXHRcdFx0dmFyIHNvcnRJdGVtID0gc29ydExpc3RbaV07XG5cblx0XHRcdHJlc3VsdCA9IF90aGlzODUuX3NvcnRSb3coYSwgYiwgc29ydEl0ZW0uY29sdW1uLCBzb3J0SXRlbS5kaXIsIHNvcnRJdGVtLnBhcmFtcyk7XG5cblx0XHRcdGlmIChyZXN1bHQgIT09IDApIHtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSk7XG59O1xuXG4vL3Byb2Nlc3MgaW5kaXZpZHVhbCByb3dzIGZvciBhIHNvcnQgZnVuY3Rpb24gb24gYWN0aXZlIGRhdGFcblNvcnQucHJvdG90eXBlLl9zb3J0Um93ID0gZnVuY3Rpb24gKGEsIGIsIGNvbHVtbiwgZGlyLCBwYXJhbXMpIHtcblx0dmFyIGVsMUNvbXAsIGVsMkNvbXAsIGNvbENvbXA7XG5cblx0Ly9zd2l0Y2ggZWxlbWVudHMgZGVwZW5kaW5nIG9uIHNlYXJjaCBkaXJlY3Rpb25cblx0dmFyIGVsMSA9IGRpciA9PSBcImFzY1wiID8gYSA6IGI7XG5cdHZhciBlbDIgPSBkaXIgPT0gXCJhc2NcIiA/IGIgOiBhO1xuXG5cdGEgPSBjb2x1bW4uZ2V0RmllbGRWYWx1ZShlbDEuZ2V0RGF0YSgpKTtcblx0YiA9IGNvbHVtbi5nZXRGaWVsZFZhbHVlKGVsMi5nZXREYXRhKCkpO1xuXG5cdGEgPSB0eXBlb2YgYSAhPT0gXCJ1bmRlZmluZWRcIiA/IGEgOiBcIlwiO1xuXHRiID0gdHlwZW9mIGIgIT09IFwidW5kZWZpbmVkXCIgPyBiIDogXCJcIjtcblxuXHRlbDFDb21wID0gZWwxLmdldENvbXBvbmVudCgpO1xuXHRlbDJDb21wID0gZWwyLmdldENvbXBvbmVudCgpO1xuXG5cdHJldHVybiBjb2x1bW4ubW9kdWxlcy5zb3J0LnNvcnRlci5jYWxsKHRoaXMsIGEsIGIsIGVsMUNvbXAsIGVsMkNvbXAsIGNvbHVtbi5nZXRDb21wb25lbnQoKSwgZGlyLCBwYXJhbXMpO1xufTtcblxuLy9kZWZhdWx0IGRhdGEgc29ydGVyc1xuU29ydC5wcm90b3R5cGUuc29ydGVycyA9IHtcblxuXHQvL3NvcnQgbnVtYmVyc1xuXHRudW1iZXI6IGZ1bmN0aW9uIG51bWJlcihhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKSB7XG5cdFx0dmFyIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcztcblx0XHR2YXIgZGVjaW1hbCA9IHBhcmFtcy5kZWNpbWFsU2VwYXJhdG9yO1xuXHRcdHZhciB0aG91c2FuZCA9IHBhcmFtcy50aG91c2FuZFNlcGFyYXRvcjtcblx0XHR2YXIgZW1wdHlBbGlnbiA9IDA7XG5cblx0XHRhID0gU3RyaW5nKGEpO1xuXHRcdGIgPSBTdHJpbmcoYik7XG5cblx0XHRpZiAodGhvdXNhbmQpIHtcblx0XHRcdGEgPSBhLnNwbGl0KHRob3VzYW5kKS5qb2luKFwiXCIpO1xuXHRcdFx0YiA9IGIuc3BsaXQodGhvdXNhbmQpLmpvaW4oXCJcIik7XG5cdFx0fVxuXG5cdFx0aWYgKGRlY2ltYWwpIHtcblx0XHRcdGEgPSBhLnNwbGl0KGRlY2ltYWwpLmpvaW4oXCIuXCIpO1xuXHRcdFx0YiA9IGIuc3BsaXQoZGVjaW1hbCkuam9pbihcIi5cIik7XG5cdFx0fVxuXG5cdFx0YSA9IHBhcnNlRmxvYXQoYSk7XG5cdFx0YiA9IHBhcnNlRmxvYXQoYik7XG5cblx0XHQvL2hhbmRsZSBub24gbnVtZXJpYyB2YWx1ZXNcblx0XHRpZiAoaXNOYU4oYSkpIHtcblx0XHRcdGVtcHR5QWxpZ24gPSBpc05hTihiKSA/IDAgOiAtMTtcblx0XHR9IGVsc2UgaWYgKGlzTmFOKGIpKSB7XG5cdFx0XHRlbXB0eUFsaWduID0gMTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9jb21wYXJlIHZhbGlkIHZhbHVlc1xuXHRcdFx0cmV0dXJuIGEgLSBiO1xuXHRcdH1cblxuXHRcdC8vZml4IGVtcHR5IHZhbHVlcyBpbiBwb3NpdGlvblxuXHRcdGlmIChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIgfHwgYWxpZ25FbXB0eVZhbHVlcyA9PT0gXCJib3R0b21cIiAmJiBkaXIgPT09IFwiYXNjXCIpIHtcblx0XHRcdGVtcHR5QWxpZ24gKj0gLTE7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGVtcHR5QWxpZ247XG5cdH0sXG5cblx0Ly9zb3J0IHN0cmluZ3Ncblx0c3RyaW5nOiBmdW5jdGlvbiBzdHJpbmcoYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcykge1xuXHRcdHZhciBhbGlnbkVtcHR5VmFsdWVzID0gcGFyYW1zLmFsaWduRW1wdHlWYWx1ZXM7XG5cdFx0dmFyIGVtcHR5QWxpZ24gPSAwO1xuXHRcdHZhciBsb2NhbGU7XG5cblx0XHQvL2hhbmRsZSBlbXB0eSB2YWx1ZXNcblx0XHRpZiAoIWEpIHtcblx0XHRcdGVtcHR5QWxpZ24gPSAhYiA/IDAgOiAtMTtcblx0XHR9IGVsc2UgaWYgKCFiKSB7XG5cdFx0XHRlbXB0eUFsaWduID0gMTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9jb21wYXJlIHZhbGlkIHZhbHVlc1xuXHRcdFx0c3dpdGNoIChfdHlwZW9mKHBhcmFtcy5sb2NhbGUpKSB7XG5cdFx0XHRcdGNhc2UgXCJib29sZWFuXCI6XG5cdFx0XHRcdFx0aWYgKHBhcmFtcy5sb2NhbGUpIHtcblx0XHRcdFx0XHRcdGxvY2FsZSA9IHRoaXMudGFibGUubW9kdWxlcy5sb2NhbGl6ZS5nZXRMb2NhbGUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJzdHJpbmdcIjpcblx0XHRcdFx0XHRsb2NhbGUgPSBwYXJhbXMubG9jYWxlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gU3RyaW5nKGEpLnRvTG93ZXJDYXNlKCkubG9jYWxlQ29tcGFyZShTdHJpbmcoYikudG9Mb3dlckNhc2UoKSwgbG9jYWxlKTtcblx0XHR9XG5cblx0XHQvL2ZpeCBlbXB0eSB2YWx1ZXMgaW4gcG9zaXRpb25cblx0XHRpZiAoYWxpZ25FbXB0eVZhbHVlcyA9PT0gXCJ0b3BcIiAmJiBkaXIgPT09IFwiZGVzY1wiIHx8IGFsaWduRW1wdHlWYWx1ZXMgPT09IFwiYm90dG9tXCIgJiYgZGlyID09PSBcImFzY1wiKSB7XG5cdFx0XHRlbXB0eUFsaWduICo9IC0xO1xuXHRcdH1cblxuXHRcdHJldHVybiBlbXB0eUFsaWduO1xuXHR9LFxuXG5cdC8vc29ydCBkYXRlXG5cdGRhdGU6IGZ1bmN0aW9uIGRhdGUoYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcykge1xuXHRcdGlmICghcGFyYW1zLmZvcm1hdCkge1xuXHRcdFx0cGFyYW1zLmZvcm1hdCA9IFwiREQvTU0vWVlZWVwiO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLnNvcnRlcnMuZGF0ZXRpbWUuY2FsbCh0aGlzLCBhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKTtcblx0fSxcblxuXHQvL3NvcnQgSEg6bW0gZm9ybWF0dGVkIHRpbWVzXG5cdHRpbWU6IGZ1bmN0aW9uIHRpbWUoYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcykge1xuXHRcdGlmICghcGFyYW1zLmZvcm1hdCkge1xuXHRcdFx0cGFyYW1zLmZvcm1hdCA9IFwiSEg6bW1cIjtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcy5zb3J0ZXJzLmRhdGV0aW1lLmNhbGwodGhpcywgYSwgYiwgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcyk7XG5cdH0sXG5cblx0Ly9zb3J0IGRhdGV0aW1lXG5cdGRhdGV0aW1lOiBmdW5jdGlvbiBkYXRldGltZShhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKSB7XG5cdFx0dmFyIGZvcm1hdCA9IHBhcmFtcy5mb3JtYXQgfHwgXCJERC9NTS9ZWVlZIEhIOm1tOnNzXCIsXG5cdFx0ICAgIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcyxcblx0XHQgICAgZW1wdHlBbGlnbiA9IDA7XG5cblx0XHRpZiAodHlwZW9mIG1vbWVudCAhPSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRhID0gbW9tZW50KGEsIGZvcm1hdCk7XG5cdFx0XHRiID0gbW9tZW50KGIsIGZvcm1hdCk7XG5cblx0XHRcdGlmICghYS5pc1ZhbGlkKCkpIHtcblx0XHRcdFx0ZW1wdHlBbGlnbiA9ICFiLmlzVmFsaWQoKSA/IDAgOiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoIWIuaXNWYWxpZCgpKSB7XG5cdFx0XHRcdGVtcHR5QWxpZ24gPSAxO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9jb21wYXJlIHZhbGlkIHZhbHVlc1xuXHRcdFx0XHRyZXR1cm4gYSAtIGI7XG5cdFx0XHR9XG5cblx0XHRcdC8vZml4IGVtcHR5IHZhbHVlcyBpbiBwb3NpdGlvblxuXHRcdFx0aWYgKGFsaWduRW1wdHlWYWx1ZXMgPT09IFwidG9wXCIgJiYgZGlyID09PSBcImRlc2NcIiB8fCBhbGlnbkVtcHR5VmFsdWVzID09PSBcImJvdHRvbVwiICYmIGRpciA9PT0gXCJhc2NcIikge1xuXHRcdFx0XHRlbXB0eUFsaWduICo9IC0xO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZW1wdHlBbGlnbjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5lcnJvcihcIlNvcnQgRXJyb3IgLSAnZGF0ZXRpbWUnIHNvcnRlciBpcyBkZXBlbmRhbnQgb24gbW9tZW50LmpzXCIpO1xuXHRcdH1cblx0fSxcblxuXHQvL3NvcnQgYm9vbGVhbnNcblx0Ym9vbGVhbjogZnVuY3Rpb24gYm9vbGVhbihhLCBiLCBhUm93LCBiUm93LCBjb2x1bW4sIGRpciwgcGFyYW1zKSB7XG5cdFx0dmFyIGVsMSA9IGEgPT09IHRydWUgfHwgYSA9PT0gXCJ0cnVlXCIgfHwgYSA9PT0gXCJUcnVlXCIgfHwgYSA9PT0gMSA/IDEgOiAwO1xuXHRcdHZhciBlbDIgPSBiID09PSB0cnVlIHx8IGIgPT09IFwidHJ1ZVwiIHx8IGIgPT09IFwiVHJ1ZVwiIHx8IGIgPT09IDEgPyAxIDogMDtcblxuXHRcdHJldHVybiBlbDEgLSBlbDI7XG5cdH0sXG5cblx0Ly9zb3J0IGlmIGVsZW1lbnQgY29udGFpbnMgYW55IGRhdGFcblx0YXJyYXk6IGZ1bmN0aW9uIGFycmF5KGEsIGIsIGFSb3csIGJSb3csIGNvbHVtbiwgZGlyLCBwYXJhbXMpIHtcblx0XHR2YXIgZWwxID0gMDtcblx0XHR2YXIgZWwyID0gMDtcblx0XHR2YXIgdHlwZSA9IHBhcmFtcy50eXBlIHx8IFwibGVuZ3RoXCI7XG5cdFx0dmFyIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcztcblx0XHR2YXIgZW1wdHlBbGlnbiA9IDA7XG5cblx0XHRmdW5jdGlvbiBjYWxjKHZhbHVlKSB7XG5cblx0XHRcdHN3aXRjaCAodHlwZSkge1xuXHRcdFx0XHRjYXNlIFwibGVuZ3RoXCI6XG5cdFx0XHRcdFx0cmV0dXJuIHZhbHVlLmxlbmd0aDtcblx0XHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlIFwic3VtXCI6XG5cdFx0XHRcdFx0cmV0dXJuIHZhbHVlLnJlZHVjZShmdW5jdGlvbiAoYywgZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGMgKyBkO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJtYXhcIjpcblx0XHRcdFx0XHRyZXR1cm4gTWF0aC5tYXguYXBwbHkobnVsbCwgdmFsdWUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJtaW5cIjpcblx0XHRcdFx0XHRyZXR1cm4gTWF0aC5taW4uYXBwbHkobnVsbCwgdmFsdWUpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgXCJhdmdcIjpcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWUucmVkdWNlKGZ1bmN0aW9uIChjLCBkKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gYyArIGQ7XG5cdFx0XHRcdFx0fSkgLyB2YWx1ZS5sZW5ndGg7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9oYW5kbGUgbm9uIGFycmF5IHZhbHVlc1xuXHRcdGlmICghQXJyYXkuaXNBcnJheShhKSkge1xuXHRcdFx0YWxpZ25FbXB0eVZhbHVlcyA9ICFBcnJheS5pc0FycmF5KGIpID8gMCA6IC0xO1xuXHRcdH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoYikpIHtcblx0XHRcdGFsaWduRW1wdHlWYWx1ZXMgPSAxO1xuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vY29tcGFyZSB2YWxpZCB2YWx1ZXNcblx0XHRcdGVsMSA9IGEgPyBjYWxjKGEpIDogMDtcblx0XHRcdGVsMiA9IGIgPyBjYWxjKGIpIDogMDtcblxuXHRcdFx0cmV0dXJuIGVsMSAtIGVsMjtcblx0XHR9XG5cblx0XHQvL2ZpeCBlbXB0eSB2YWx1ZXMgaW4gcG9zaXRpb25cblx0XHRpZiAoYWxpZ25FbXB0eVZhbHVlcyA9PT0gXCJ0b3BcIiAmJiBkaXIgPT09IFwiZGVzY1wiIHx8IGFsaWduRW1wdHlWYWx1ZXMgPT09IFwiYm90dG9tXCIgJiYgZGlyID09PSBcImFzY1wiKSB7XG5cdFx0XHRlbXB0eUFsaWduICo9IC0xO1xuXHRcdH1cblxuXHRcdHJldHVybiBlbXB0eUFsaWduO1xuXHR9LFxuXG5cdC8vc29ydCBpZiBlbGVtZW50IGNvbnRhaW5zIGFueSBkYXRhXG5cdGV4aXN0czogZnVuY3Rpb24gZXhpc3RzKGEsIGIsIGFSb3csIGJSb3csIGNvbHVtbiwgZGlyLCBwYXJhbXMpIHtcblx0XHR2YXIgZWwxID0gdHlwZW9mIGEgPT0gXCJ1bmRlZmluZWRcIiA/IDAgOiAxO1xuXHRcdHZhciBlbDIgPSB0eXBlb2YgYiA9PSBcInVuZGVmaW5lZFwiID8gMCA6IDE7XG5cblx0XHRyZXR1cm4gZWwxIC0gZWwyO1xuXHR9LFxuXG5cdC8vc29ydCBhbHBoYSBudW1lcmljIHN0cmluZ3Ncblx0YWxwaGFudW06IGZ1bmN0aW9uIGFscGhhbnVtKGFzLCBicywgYVJvdywgYlJvdywgY29sdW1uLCBkaXIsIHBhcmFtcykge1xuXHRcdHZhciBhLFxuXHRcdCAgICBiLFxuXHRcdCAgICBhMSxcblx0XHQgICAgYjEsXG5cdFx0ICAgIGkgPSAwLFxuXHRcdCAgICBMLFxuXHRcdCAgICByeCA9IC8oXFxkKyl8KFxcRCspL2csXG5cdFx0ICAgIHJkID0gL1xcZC87XG5cdFx0dmFyIGFsaWduRW1wdHlWYWx1ZXMgPSBwYXJhbXMuYWxpZ25FbXB0eVZhbHVlcztcblx0XHR2YXIgZW1wdHlBbGlnbiA9IDA7XG5cblx0XHQvL2hhbmRsZSBlbXB0eSB2YWx1ZXNcblx0XHRpZiAoIWFzICYmIGFzICE9PSAwKSB7XG5cdFx0XHRlbXB0eUFsaWduID0gIWJzICYmIGJzICE9PSAwID8gMCA6IC0xO1xuXHRcdH0gZWxzZSBpZiAoIWJzICYmIGJzICE9PSAwKSB7XG5cdFx0XHRlbXB0eUFsaWduID0gMTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoaXNGaW5pdGUoYXMpICYmIGlzRmluaXRlKGJzKSkgcmV0dXJuIGFzIC0gYnM7XG5cdFx0XHRhID0gU3RyaW5nKGFzKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0YiA9IFN0cmluZyhicykudG9Mb3dlckNhc2UoKTtcblx0XHRcdGlmIChhID09PSBiKSByZXR1cm4gMDtcblx0XHRcdGlmICghKHJkLnRlc3QoYSkgJiYgcmQudGVzdChiKSkpIHJldHVybiBhID4gYiA/IDEgOiAtMTtcblx0XHRcdGEgPSBhLm1hdGNoKHJ4KTtcblx0XHRcdGIgPSBiLm1hdGNoKHJ4KTtcblx0XHRcdEwgPSBhLmxlbmd0aCA+IGIubGVuZ3RoID8gYi5sZW5ndGggOiBhLmxlbmd0aDtcblx0XHRcdHdoaWxlIChpIDwgTCkge1xuXHRcdFx0XHRhMSA9IGFbaV07XG5cdFx0XHRcdGIxID0gYltpKytdO1xuXHRcdFx0XHRpZiAoYTEgIT09IGIxKSB7XG5cdFx0XHRcdFx0aWYgKGlzRmluaXRlKGExKSAmJiBpc0Zpbml0ZShiMSkpIHtcblx0XHRcdFx0XHRcdGlmIChhMS5jaGFyQXQoMCkgPT09IFwiMFwiKSBhMSA9IFwiLlwiICsgYTE7XG5cdFx0XHRcdFx0XHRpZiAoYjEuY2hhckF0KDApID09PSBcIjBcIikgYjEgPSBcIi5cIiArIGIxO1xuXHRcdFx0XHRcdFx0cmV0dXJuIGExIC0gYjE7XG5cdFx0XHRcdFx0fSBlbHNlIHJldHVybiBhMSA+IGIxID8gMSA6IC0xO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBhLmxlbmd0aCA+IGIubGVuZ3RoO1xuXHRcdH1cblxuXHRcdC8vZml4IGVtcHR5IHZhbHVlcyBpbiBwb3NpdGlvblxuXHRcdGlmIChhbGlnbkVtcHR5VmFsdWVzID09PSBcInRvcFwiICYmIGRpciA9PT0gXCJkZXNjXCIgfHwgYWxpZ25FbXB0eVZhbHVlcyA9PT0gXCJib3R0b21cIiAmJiBkaXIgPT09IFwiYXNjXCIpIHtcblx0XHRcdGVtcHR5QWxpZ24gKj0gLTE7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGVtcHR5QWxpZ247XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJzb3J0XCIsIFNvcnQpO1xuXG52YXIgVmFsaWRhdGUgPSBmdW5jdGlvbiBWYWxpZGF0ZSh0YWJsZSkge1xuXHR0aGlzLnRhYmxlID0gdGFibGU7XG5cdHRoaXMuaW52YWxpZENlbGxzID0gW107XG59O1xuXG4vL3ZhbGlkYXRlXG5WYWxpZGF0ZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUNvbHVtbiA9IGZ1bmN0aW9uIChjb2x1bW4pIHtcblx0dmFyIHNlbGYgPSB0aGlzLFxuXHQgICAgY29uZmlnID0gW10sXG5cdCAgICB2YWxpZGF0b3I7XG5cblx0aWYgKGNvbHVtbi5kZWZpbml0aW9uLnZhbGlkYXRvcikge1xuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoY29sdW1uLmRlZmluaXRpb24udmFsaWRhdG9yKSkge1xuXHRcdFx0Y29sdW1uLmRlZmluaXRpb24udmFsaWRhdG9yLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRcdFx0dmFsaWRhdG9yID0gc2VsZi5fZXh0cmFjdFZhbGlkYXRvcihpdGVtKTtcblxuXHRcdFx0XHRpZiAodmFsaWRhdG9yKSB7XG5cdFx0XHRcdFx0Y29uZmlnLnB1c2godmFsaWRhdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhbGlkYXRvciA9IHRoaXMuX2V4dHJhY3RWYWxpZGF0b3IoY29sdW1uLmRlZmluaXRpb24udmFsaWRhdG9yKTtcblxuXHRcdFx0aWYgKHZhbGlkYXRvcikge1xuXHRcdFx0XHRjb25maWcucHVzaCh2YWxpZGF0b3IpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbHVtbi5tb2R1bGVzLnZhbGlkYXRlID0gY29uZmlnLmxlbmd0aCA/IGNvbmZpZyA6IGZhbHNlO1xuXHR9XG59O1xuXG5WYWxpZGF0ZS5wcm90b3R5cGUuX2V4dHJhY3RWYWxpZGF0b3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0dmFyIHR5cGUsIHBhcmFtcywgcG9zO1xuXG5cdHN3aXRjaCAodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih2YWx1ZSkpIHtcblx0XHRjYXNlIFwic3RyaW5nXCI6XG5cdFx0XHRwb3MgPSB2YWx1ZS5pbmRleE9mKCc6Jyk7XG5cblx0XHRcdGlmIChwb3MgPiAtMSkge1xuXHRcdFx0XHR0eXBlID0gdmFsdWUuc3Vic3RyaW5nKDAsIHBvcyk7XG5cdFx0XHRcdHBhcmFtcyA9IHZhbHVlLnN1YnN0cmluZyhwb3MgKyAxKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHR5cGUgPSB2YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIHRoaXMuX2J1aWxkVmFsaWRhdG9yKHR5cGUsIHBhcmFtcyk7XG5cdFx0XHRicmVhaztcblxuXHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0cmV0dXJuIHRoaXMuX2J1aWxkVmFsaWRhdG9yKHZhbHVlKTtcblx0XHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSBcIm9iamVjdFwiOlxuXHRcdFx0cmV0dXJuIHRoaXMuX2J1aWxkVmFsaWRhdG9yKHZhbHVlLnR5cGUsIHZhbHVlLnBhcmFtZXRlcnMpO1xuXHRcdFx0YnJlYWs7XG5cdH1cbn07XG5cblZhbGlkYXRlLnByb3RvdHlwZS5fYnVpbGRWYWxpZGF0b3IgPSBmdW5jdGlvbiAodHlwZSwgcGFyYW1zKSB7XG5cblx0dmFyIGZ1bmMgPSB0eXBlb2YgdHlwZSA9PSBcImZ1bmN0aW9uXCIgPyB0eXBlIDogdGhpcy52YWxpZGF0b3JzW3R5cGVdO1xuXG5cdGlmICghZnVuYykge1xuXHRcdGNvbnNvbGUud2FybihcIlZhbGlkYXRvciBTZXR1cCBFcnJvciAtIE5vIG1hdGNoaW5nIHZhbGlkYXRvciBmb3VuZDpcIiwgdHlwZSk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiB7XG5cdFx0XHR0eXBlOiB0eXBlb2YgdHlwZSA9PSBcImZ1bmN0aW9uXCIgPyBcImZ1bmN0aW9uXCIgOiB0eXBlLFxuXHRcdFx0ZnVuYzogZnVuYyxcblx0XHRcdHBhcmFtczogcGFyYW1zXG5cdFx0fTtcblx0fVxufTtcblxuVmFsaWRhdGUucHJvdG90eXBlLnZhbGlkYXRlID0gZnVuY3Rpb24gKHZhbGlkYXRvcnMsIGNlbGwsIHZhbHVlKSB7XG5cdHZhciBzZWxmID0gdGhpcyxcblx0ICAgIHZhbGlkID0gW10sXG5cdCAgICBpbnZhbGlkSW5kZXggPSB0aGlzLmludmFsaWRDZWxscy5pbmRleE9mKGNlbGwpO1xuXG5cdGlmICh2YWxpZGF0b3JzKSB7XG5cdFx0dmFsaWRhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG5cdFx0XHRpZiAoIWl0ZW0uZnVuYy5jYWxsKHNlbGYsIGNlbGwuZ2V0Q29tcG9uZW50KCksIHZhbHVlLCBpdGVtLnBhcmFtcykpIHtcblx0XHRcdFx0dmFsaWQucHVzaCh7XG5cdFx0XHRcdFx0dHlwZTogaXRlbS50eXBlLFxuXHRcdFx0XHRcdHBhcmFtZXRlcnM6IGl0ZW0ucGFyYW1zXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0dmFsaWQgPSB2YWxpZC5sZW5ndGggPyB2YWxpZCA6IHRydWU7XG5cblx0aWYgKCFjZWxsLm1vZHVsZXMudmFsaWRhdGUpIHtcblx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUgPSB7fTtcblx0fVxuXG5cdGlmICh2YWxpZCA9PT0gdHJ1ZSkge1xuXHRcdGNlbGwubW9kdWxlcy52YWxpZGF0ZS5pbnZhbGlkID0gZmFsc2U7XG5cdFx0Y2VsbC5nZXRFbGVtZW50KCkuY2xhc3NMaXN0LnJlbW92ZShcInRhYnVsYXRvci12YWxpZGF0aW9uLWZhaWxcIik7XG5cblx0XHRpZiAoaW52YWxpZEluZGV4ID4gLTEpIHtcblx0XHRcdHRoaXMuaW52YWxpZENlbGxzLnNwbGljZShpbnZhbGlkSW5kZXgsIDEpO1xuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA9IHRydWU7XG5cblx0XHRpZiAodGhpcy50YWJsZS5vcHRpb25zLnZhbGlkYXRpb25Nb2RlICE9PSBcIm1hbnVhbFwiKSB7XG5cdFx0XHRjZWxsLmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuYWRkKFwidGFidWxhdG9yLXZhbGlkYXRpb24tZmFpbFwiKTtcblx0XHR9XG5cblx0XHRpZiAoaW52YWxpZEluZGV4ID09IC0xKSB7XG5cdFx0XHR0aGlzLmludmFsaWRDZWxscy5wdXNoKGNlbGwpO1xuXHRcdH1cblx0fVxuXG5cdHJldHVybiB2YWxpZDtcbn07XG5cblZhbGlkYXRlLnByb3RvdHlwZS5nZXRJbnZhbGlkQ2VsbHMgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBvdXRwdXQgPSBbXTtcblxuXHR0aGlzLmludmFsaWRDZWxscy5mb3JFYWNoKGZ1bmN0aW9uIChjZWxsKSB7XG5cdFx0b3V0cHV0LnB1c2goY2VsbC5nZXRDb21wb25lbnQoKSk7XG5cdH0pO1xuXG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5WYWxpZGF0ZS5wcm90b3R5cGUuY2xlYXJWYWxpZGF0aW9uID0gZnVuY3Rpb24gKGNlbGwpIHtcblx0dmFyIGludmFsaWRJbmRleDtcblxuXHRpZiAoY2VsbC5tb2R1bGVzLnZhbGlkYXRlICYmIGNlbGwubW9kdWxlcy52YWxpZGF0ZS5pbnZhbGlkKSB7XG5cblx0XHRjZWxsLmdldEVsZW1lbnQoKS5jbGFzc0xpc3QucmVtb3ZlKFwidGFidWxhdG9yLXZhbGlkYXRpb24tZmFpbFwiKTtcblx0XHRjZWxsLm1vZHVsZXMudmFsaWRhdGUuaW52YWxpZCA9IGZhbHNlO1xuXG5cdFx0aW52YWxpZEluZGV4ID0gdGhpcy5pbnZhbGlkQ2VsbHMuaW5kZXhPZihjZWxsKTtcblxuXHRcdGlmIChpbnZhbGlkSW5kZXggPiAtMSkge1xuXHRcdFx0dGhpcy5pbnZhbGlkQ2VsbHMuc3BsaWNlKGludmFsaWRJbmRleCwgMSk7XG5cdFx0fVxuXHR9XG59O1xuXG5WYWxpZGF0ZS5wcm90b3R5cGUudmFsaWRhdG9ycyA9IHtcblxuXHQvL2lzIGludGVnZXJcblx0aW50ZWdlcjogZnVuY3Rpb24gaW50ZWdlcihjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycykge1xuXHRcdGlmICh2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cdFx0cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUodmFsdWUpICYmIE1hdGguZmxvb3IodmFsdWUpID09PSB2YWx1ZTtcblx0fSxcblxuXHQvL2lzIGZsb2F0XG5cdGZsb2F0OiBmdW5jdGlvbiBmbG9hdChjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycykge1xuXHRcdGlmICh2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cdFx0cmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgaXNGaW5pdGUodmFsdWUpICYmIHZhbHVlICUgMSAhPT0gMDtcblx0fSxcblxuXHQvL211c3QgYmUgYSBudW1iZXJcblx0bnVtZXJpYzogZnVuY3Rpb24gbnVtZXJpYyhjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycykge1xuXHRcdGlmICh2YWx1ZSA9PT0gXCJcIiB8fCB2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gIWlzTmFOKHZhbHVlKTtcblx0fSxcblxuXHQvL211c3QgYmUgYSBzdHJpbmdcblx0c3RyaW5nOiBmdW5jdGlvbiBzdHJpbmcoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIGlzTmFOKHZhbHVlKTtcblx0fSxcblxuXHQvL21heGltdW0gdmFsdWVcblx0bWF4OiBmdW5jdGlvbiBtYXgoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIHBhcnNlRmxvYXQodmFsdWUpIDw9IHBhcmFtZXRlcnM7XG5cdH0sXG5cblx0Ly9taW5pbXVtIHZhbHVlXG5cdG1pbjogZnVuY3Rpb24gbWluKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKSB7XG5cdFx0aWYgKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBwYXJzZUZsb2F0KHZhbHVlKSA+PSBwYXJhbWV0ZXJzO1xuXHR9LFxuXG5cdC8vc3RhcnRzIHdpdGggIHZhbHVlXG5cdHN0YXJ0czogZnVuY3Rpb24gc3RhcnRzKGNlbGwsIHZhbHVlLCBwYXJhbWV0ZXJzKSB7XG5cdFx0aWYgKHZhbHVlID09PSBcIlwiIHx8IHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aChTdHJpbmcocGFyYW1ldGVycykudG9Mb3dlckNhc2UoKSk7XG5cdH0sXG5cblx0Ly9lbmRzIHdpdGggIHZhbHVlXG5cdGVuZHM6IGZ1bmN0aW9uIGVuZHMoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIFN0cmluZyh2YWx1ZSkudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChTdHJpbmcocGFyYW1ldGVycykudG9Mb3dlckNhc2UoKSk7XG5cdH0sXG5cblx0Ly9taW5pbXVtIHN0cmluZyBsZW5ndGhcblx0bWluTGVuZ3RoOiBmdW5jdGlvbiBtaW5MZW5ndGgoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIFN0cmluZyh2YWx1ZSkubGVuZ3RoID49IHBhcmFtZXRlcnM7XG5cdH0sXG5cblx0Ly9tYXhpbXVtIHN0cmluZyBsZW5ndGhcblx0bWF4TGVuZ3RoOiBmdW5jdGlvbiBtYXhMZW5ndGgoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIFN0cmluZyh2YWx1ZSkubGVuZ3RoIDw9IHBhcmFtZXRlcnM7XG5cdH0sXG5cblx0Ly9pbiBwcm92aWRlZCB2YWx1ZSBsaXN0XG5cdGluOiBmdW5jdGlvbiBfaW4oY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiBwYXJhbWV0ZXJzID09IFwic3RyaW5nXCIpIHtcblx0XHRcdHBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzLnNwbGl0KFwifFwiKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdmFsdWUgPT09IFwiXCIgfHwgcGFyYW1ldGVycy5pbmRleE9mKHZhbHVlKSA+IC0xO1xuXHR9LFxuXG5cdC8vbXVzdCBtYXRjaCBwcm92aWRlZCByZWdleFxuXHRyZWdleDogZnVuY3Rpb24gcmVnZXgoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0dmFyIHJlZyA9IG5ldyBSZWdFeHAocGFyYW1ldGVycyk7XG5cblx0XHRyZXR1cm4gcmVnLnRlc3QodmFsdWUpO1xuXHR9LFxuXG5cdC8vdmFsdWUgbXVzdCBiZSB1bmlxdWUgaW4gdGhpcyBjb2x1bW5cblx0dW5pcXVlOiBmdW5jdGlvbiB1bmlxdWUoY2VsbCwgdmFsdWUsIHBhcmFtZXRlcnMpIHtcblx0XHRpZiAodmFsdWUgPT09IFwiXCIgfHwgdmFsdWUgPT09IG51bGwgfHwgdHlwZW9mIHZhbHVlID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0dmFyIHVuaXF1ZSA9IHRydWU7XG5cblx0XHR2YXIgY2VsbERhdGEgPSBjZWxsLmdldERhdGEoKTtcblx0XHR2YXIgY29sdW1uID0gY2VsbC5nZXRDb2x1bW4oKS5fZ2V0U2VsZigpO1xuXG5cdFx0dGhpcy50YWJsZS5yb3dNYW5hZ2VyLnJvd3MuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7XG5cdFx0XHR2YXIgZGF0YSA9IHJvdy5nZXREYXRhKCk7XG5cblx0XHRcdGlmIChkYXRhICE9PSBjZWxsRGF0YSkge1xuXHRcdFx0XHRpZiAodmFsdWUgPT0gY29sdW1uLmdldEZpZWxkVmFsdWUoZGF0YSkpIHtcblx0XHRcdFx0XHR1bmlxdWUgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHVuaXF1ZTtcblx0fSxcblxuXHQvL211c3QgaGF2ZSBhIHZhbHVlXG5cdHJlcXVpcmVkOiBmdW5jdGlvbiByZXF1aXJlZChjZWxsLCB2YWx1ZSwgcGFyYW1ldGVycykge1xuXHRcdHJldHVybiB2YWx1ZSAhPT0gXCJcIiAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCI7XG5cdH1cbn07XG5cblRhYnVsYXRvci5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGUoXCJ2YWxpZGF0ZVwiLCBWYWxpZGF0ZSk7XG5cbmV4cG9ydCBkZWZhdWx0IFRhYnVsYXRvcjsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/tabulator-tables/dist/js/tabulator.es2015.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
(() => {
/*!*************************************************************************!*\
  !*** ./vendor/feiron/fe_roles/src/resources/js/roleManagementOutlet.js ***!
  \*************************************************************************/
eval("window.usrRoleManager = __webpack_require__(/*! ./roleManagementControl */ \"./vendor/feiron/fe_roles/src/resources/js/roleManagementControl.js\").default;\nwindow.ready(function () {\n  window.usrRoleManager.InitUsrRoleDtable('pr_dt_table');\n  window.usrRoleManager.InitUsrAbilityList(document.getElementById('role_abilities'), document.getElementById('pr_dt_table').getAttribute('data_target'));\n  document.getElementById('control_CRUD').addEventListener('hidden.bs.modal', function () {\n    document.querySelectorAll('#control_CRUD .modal-body,#control_CRUD .modal-content').forEach(function (elm) {\n      elm.classList.remove('overflow-visible');\n    });\n  });\n  document.querySelector('#pr_management .ra_addNew').addEventListener('click', function () {\n    window.usrRoleManager.abilityList.removeActiveItems();\n    document.querySelector('#Role_Management_CRUD select[name=\"ra_type\"]').value = document.querySelector('#pr_management input[type=\"radio\"][name=\"ListType\"]:checked').value || 'Ability';\n    document.querySelector('#Role_Management_CRUD input[type=\"radio\"][value=\"false\"]').checked = true;\n    showModal();\n  });\n  document.getElementById('ra_type').addEventListener('change', function (e) {\n    document.querySelectorAll('#Role_Management_CRUD .roleCtrl').forEach(function (r) {\n      if ((e.target.value || 'Ability') == 'Role') {\n        r.classList.remove('d-none');\n      } else {\n        r.classList.add('d-none');\n      }\n    });\n  });\n  document.querySelectorAll('#pr_management input[type=\"radio\"][name=\"ListType\"]').forEach(function (elm) {\n    elm.addEventListener('change', function () {\n      window.usrRoleManager.UsrRoleTable.setData();\n    });\n    elm.addEventListener('click', function () {\n      document.querySelectorAll('#Role_Management_CRUD .roleCtrl').forEach(function (r) {\n        if (elm.value == 'Ability') {\n          r.classList.add('d-none');\n        } else {\n          r.classList.remove('d-none');\n        }\n      });\n    });\n  });\n  document.getElementById('Role_Management').addEventListener('click', function (e) {\n    if (e.target.classList.contains('btn-edit')) {\n      showModal();\n      document.querySelector('#control_CRUD .loading').classList.add('show');\n      window.usrRoleManager.pr_load(e.target.getAttribute('data-source'), document.querySelector('#pr_management input[type=\"radio\"][name=\"ListType\"]:checked').value || 'Ability', function (data) {\n        document.querySelector('#Role_Management_CRUD input[name=\"RID\"]').value = data.id;\n        document.querySelector('#Role_Management_CRUD input[name=\"name\"]').value = data.name;\n        document.querySelector('#Role_Management_CRUD textarea[name=\"description\"]').value = data.description;\n        document.querySelector('#Role_Management_CRUD select[name=\"ra_type\"]').value = data.type;\n        document.querySelector('#Role_Management_CRUD input[name=\"disabled\"][value=\"' + (data.disabled ? 'true' : 'false') + '\"]').checked = true;\n\n        if (data.type == 'Role') {\n          document.querySelectorAll('#Role_Management_CRUD .roleCtrl').forEach(function (r) {\n            if (data.type == 'Role') {\n              r.classList.remove('d-none');\n            } else {\n              r.classList.add('d-none');\n            }\n          });\n          document.querySelector('#Role_Management_CRUD input[name=\"rank\"]').value = data.rank;\n        }\n\n        document.querySelector('#control_CRUD .loading').classList.remove('show');\n      });\n    } else if (e.target.classList.contains('btn-remove')) {\n      window.usrRoleManager.pr_remove(e.target.getAttribute('data-source'), document.querySelector('#pr_management input[type=\"radio\"][name=\"ListType\"]:checked').value || 'Ability', function (data) {\n        if (data) {\n          if (window.frameUtil) window.frameUtil.Notify(data);\n\n          if (data.status == 'success') {\n            window.usrRoleManager.UsrRoleTable.setData();\n          }\n        }\n      });\n    }\n  });\n  document.getElementById('control_CRUD').addEventListener('click', function (e) {\n    if (e.target.classList.contains('ra_SaveChange')) {\n      var data = {};\n      var type = document.querySelector('#pr_management input[type=\"radio\"][name=\"ListType\"]:checked').value || 'Ability';\n      document.querySelectorAll('#Role_Management_CRUD .form-control:not([type=\"radio\"]):not(.role-control)').forEach(function (elm) {\n        data[elm['name']] = elm['value'];\n      });\n      data['disabled'] = document.querySelector('#Role_Management_CRUD input[type=\"radio\"]:checked').value == 'true';\n\n      if (type == 'Role') {\n        data['rank'] = document.querySelector('#Role_Management_CRUD input[name=\"rank\"]').value;\n        data['Abilities'] = window.usrRoleManager.abilityList.getValue(true);\n      }\n\n      window.usrRoleManager.pr_saveChange(type, data, function (data) {\n        if (window.frameUtil) window.frameUtil.Notify(data);\n\n        if (data.status == 'success') {\n          window.controlUtil.hideCRUD(function () {\n            window.usrRoleManager.UsrRoleTable.setData();\n          });\n        }\n      });\n    }\n  });\n  document.querySelector('#Role_Management_CRUD .prev-list').addEventListener('list-updated', function (e) {\n    if (e.detail && e.detail.prevType == 'Ability') {\n      window.usrRoleManager.fetchAbilities();\n    }\n  });\n});\n\nfunction showModal() {\n  document.querySelector('#control_CRUD .buttonSlot').innerHTML = '<button class=\"btn btn-success ra_SaveChange\" id=\"ra_SaveChange\">Save Changes</button>';\n  document.querySelectorAll('#control_CRUD .modal-body,#control_CRUD .modal-content').forEach(function (elm) {\n    elm.classList.add('overflow-visible');\n  });\n  window.controlUtil.showCRUD('Role_Management');\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi92ZW5kb3IvZmVpcm9uL2ZlX3JvbGVzL3NyYy9yZXNvdXJjZXMvanMvcm9sZU1hbmFnZW1lbnRPdXRsZXQuanM/NzhmOCJdLCJuYW1lcyI6WyJ3aW5kb3ciLCJ1c3JSb2xlTWFuYWdlciIsInJlcXVpcmUiLCJyZWFkeSIsIkluaXRVc3JSb2xlRHRhYmxlIiwiSW5pdFVzckFiaWxpdHlMaXN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImdldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVsbSIsImNsYXNzTGlzdCIsInJlbW92ZSIsInF1ZXJ5U2VsZWN0b3IiLCJhYmlsaXR5TGlzdCIsInJlbW92ZUFjdGl2ZUl0ZW1zIiwidmFsdWUiLCJjaGVja2VkIiwic2hvd01vZGFsIiwiZSIsInIiLCJ0YXJnZXQiLCJhZGQiLCJVc3JSb2xlVGFibGUiLCJzZXREYXRhIiwiY29udGFpbnMiLCJwcl9sb2FkIiwiZGF0YSIsImlkIiwibmFtZSIsImRlc2NyaXB0aW9uIiwidHlwZSIsImRpc2FibGVkIiwicmFuayIsInByX3JlbW92ZSIsImZyYW1lVXRpbCIsIk5vdGlmeSIsInN0YXR1cyIsImdldFZhbHVlIiwicHJfc2F2ZUNoYW5nZSIsImNvbnRyb2xVdGlsIiwiaGlkZUNSVUQiLCJkZXRhaWwiLCJwcmV2VHlwZSIsImZldGNoQWJpbGl0aWVzIiwiaW5uZXJIVE1MIiwic2hvd0NSVUQiXSwibWFwcGluZ3MiOiJBQUFBQSxNQUFNLENBQUNDLGNBQVAsR0FBd0JDLGdJQUF4QjtBQUVBRixNQUFNLENBQUNHLEtBQVAsQ0FBYSxZQUFJO0FBQ2JILFFBQU0sQ0FBQ0MsY0FBUCxDQUFzQkcsaUJBQXRCLENBQXdDLGFBQXhDO0FBQ0FKLFFBQU0sQ0FBQ0MsY0FBUCxDQUFzQkksa0JBQXRCLENBQXlDQyxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsZ0JBQXhCLENBQXpDLEVBQW1GRCxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsYUFBeEIsRUFBdUNDLFlBQXZDLENBQW9ELGFBQXBELENBQW5GO0FBQ0FGLFVBQVEsQ0FBQ0MsY0FBVCxDQUF3QixjQUF4QixFQUF3Q0UsZ0JBQXhDLENBQXlELGlCQUF6RCxFQUEyRSxZQUFVO0FBQ2pGSCxZQUFRLENBQUNJLGdCQUFULENBQTBCLHdEQUExQixFQUFvRkMsT0FBcEYsQ0FBNEYsVUFBQ0MsR0FBRCxFQUFPO0FBQy9GQSxTQUFHLENBQUNDLFNBQUosQ0FBY0MsTUFBZCxDQUFxQixrQkFBckI7QUFDSCxLQUZEO0FBR0gsR0FKRDtBQU1BUixVQUFRLENBQUNTLGFBQVQsQ0FBdUIsMkJBQXZCLEVBQW9ETixnQkFBcEQsQ0FBcUUsT0FBckUsRUFBNkUsWUFBSTtBQUM3RVQsVUFBTSxDQUFDQyxjQUFQLENBQXNCZSxXQUF0QixDQUFrQ0MsaUJBQWxDO0FBQ0FYLFlBQVEsQ0FBQ1MsYUFBVCxDQUF1Qiw4Q0FBdkIsRUFBdUVHLEtBQXZFLEdBQThFWixRQUFRLENBQUNTLGFBQVQsQ0FBdUIsNkRBQXZCLEVBQXNGRyxLQUF0RixJQUE2RixTQUEzSztBQUNBWixZQUFRLENBQUNTLGFBQVQsQ0FBdUIsMERBQXZCLEVBQW1GSSxPQUFuRixHQUEyRixJQUEzRjtBQUNBQyxhQUFTO0FBQ1osR0FMRDtBQU9BZCxVQUFRLENBQUNDLGNBQVQsQ0FBd0IsU0FBeEIsRUFBbUNFLGdCQUFuQyxDQUFvRCxRQUFwRCxFQUE2RCxVQUFDWSxDQUFELEVBQUs7QUFDOURmLFlBQVEsQ0FBQ0ksZ0JBQVQsQ0FBMEIsaUNBQTFCLEVBQTZEQyxPQUE3RCxDQUFxRSxVQUFDVyxDQUFELEVBQUs7QUFDdEUsVUFBRyxDQUFDRCxDQUFDLENBQUNFLE1BQUYsQ0FBU0wsS0FBVCxJQUFnQixTQUFqQixLQUE2QixNQUFoQyxFQUF1QztBQUNuQ0ksU0FBQyxDQUFDVCxTQUFGLENBQVlDLE1BQVosQ0FBbUIsUUFBbkI7QUFDSCxPQUZELE1BRUs7QUFDRFEsU0FBQyxDQUFDVCxTQUFGLENBQVlXLEdBQVosQ0FBZ0IsUUFBaEI7QUFDSDtBQUNKLEtBTkQ7QUFPSCxHQVJEO0FBVUFsQixVQUFRLENBQUNJLGdCQUFULENBQTBCLHFEQUExQixFQUFpRkMsT0FBakYsQ0FBeUYsVUFBQ0MsR0FBRCxFQUFPO0FBQzVGQSxPQUFHLENBQUNILGdCQUFKLENBQXFCLFFBQXJCLEVBQThCLFlBQUk7QUFDOUJULFlBQU0sQ0FBQ0MsY0FBUCxDQUFzQndCLFlBQXRCLENBQW1DQyxPQUFuQztBQUNILEtBRkQ7QUFHQWQsT0FBRyxDQUFDSCxnQkFBSixDQUFxQixPQUFyQixFQUE2QixZQUFJO0FBQzdCSCxjQUFRLENBQUNJLGdCQUFULENBQTBCLGlDQUExQixFQUE2REMsT0FBN0QsQ0FBcUUsVUFBQ1csQ0FBRCxFQUFLO0FBQ3RFLFlBQUdWLEdBQUcsQ0FBQ00sS0FBSixJQUFhLFNBQWhCLEVBQTBCO0FBQ3RCSSxXQUFDLENBQUNULFNBQUYsQ0FBWVcsR0FBWixDQUFnQixRQUFoQjtBQUNILFNBRkQsTUFFSztBQUNERixXQUFDLENBQUNULFNBQUYsQ0FBWUMsTUFBWixDQUFtQixRQUFuQjtBQUNIO0FBQ0osT0FORDtBQU9ILEtBUkQ7QUFTSCxHQWJEO0FBZUFSLFVBQVEsQ0FBQ0MsY0FBVCxDQUF3QixpQkFBeEIsRUFBMkNFLGdCQUEzQyxDQUE0RCxPQUE1RCxFQUFvRSxVQUFDWSxDQUFELEVBQUs7QUFDckUsUUFBSUEsQ0FBQyxDQUFDRSxNQUFGLENBQVNWLFNBQVQsQ0FBbUJjLFFBQW5CLENBQTRCLFVBQTVCLENBQUosRUFBNkM7QUFDekNQLGVBQVM7QUFDVGQsY0FBUSxDQUFDUyxhQUFULENBQXVCLHdCQUF2QixFQUFpREYsU0FBakQsQ0FBMkRXLEdBQTNELENBQStELE1BQS9EO0FBQ0F4QixZQUFNLENBQUNDLGNBQVAsQ0FBc0IyQixPQUF0QixDQUE4QlAsQ0FBQyxDQUFDRSxNQUFGLENBQVNmLFlBQVQsQ0FBc0IsYUFBdEIsQ0FBOUIsRUFBb0VGLFFBQVEsQ0FBQ1MsYUFBVCxDQUF1Qiw2REFBdkIsRUFBc0ZHLEtBQXRGLElBQTZGLFNBQWpLLEVBQTZLLFVBQVNXLElBQVQsRUFBYztBQUN2THZCLGdCQUFRLENBQUNTLGFBQVQsQ0FBdUIseUNBQXZCLEVBQWtFRyxLQUFsRSxHQUF3RVcsSUFBSSxDQUFDQyxFQUE3RTtBQUNBeEIsZ0JBQVEsQ0FBQ1MsYUFBVCxDQUF1QiwwQ0FBdkIsRUFBbUVHLEtBQW5FLEdBQXlFVyxJQUFJLENBQUNFLElBQTlFO0FBQ0F6QixnQkFBUSxDQUFDUyxhQUFULENBQXVCLG9EQUF2QixFQUE2RUcsS0FBN0UsR0FBbUZXLElBQUksQ0FBQ0csV0FBeEY7QUFDQTFCLGdCQUFRLENBQUNTLGFBQVQsQ0FBdUIsOENBQXZCLEVBQXVFRyxLQUF2RSxHQUE2RVcsSUFBSSxDQUFDSSxJQUFsRjtBQUNBM0IsZ0JBQVEsQ0FBQ1MsYUFBVCxDQUF1QiwwREFBMERjLElBQUksQ0FBQ0ssUUFBTCxHQUFnQixNQUFoQixHQUF5QixPQUFuRixJQUE4RixJQUFySCxFQUEySGYsT0FBM0gsR0FBbUksSUFBbkk7O0FBQ0EsWUFBSVUsSUFBSSxDQUFDSSxJQUFMLElBQWEsTUFBakIsRUFBeUI7QUFDckIzQixrQkFBUSxDQUFDSSxnQkFBVCxDQUEwQixpQ0FBMUIsRUFBNkRDLE9BQTdELENBQXFFLFVBQUNXLENBQUQsRUFBSztBQUN0RSxnQkFBR08sSUFBSSxDQUFDSSxJQUFMLElBQVcsTUFBZCxFQUFxQjtBQUNqQlgsZUFBQyxDQUFDVCxTQUFGLENBQVlDLE1BQVosQ0FBbUIsUUFBbkI7QUFDSCxhQUZELE1BRUs7QUFDRFEsZUFBQyxDQUFDVCxTQUFGLENBQVlXLEdBQVosQ0FBZ0IsUUFBaEI7QUFDSDtBQUNKLFdBTkQ7QUFPQWxCLGtCQUFRLENBQUNTLGFBQVQsQ0FBdUIsMENBQXZCLEVBQW1FRyxLQUFuRSxHQUF5RVcsSUFBSSxDQUFDTSxJQUE5RTtBQUNIOztBQUNEN0IsZ0JBQVEsQ0FBQ1MsYUFBVCxDQUF1Qix3QkFBdkIsRUFBaURGLFNBQWpELENBQTJEQyxNQUEzRCxDQUFrRSxNQUFsRTtBQUNILE9BakJEO0FBa0JILEtBckJELE1BcUJNLElBQUlPLENBQUMsQ0FBQ0UsTUFBRixDQUFTVixTQUFULENBQW1CYyxRQUFuQixDQUE0QixZQUE1QixDQUFKLEVBQStDO0FBQ2pEM0IsWUFBTSxDQUFDQyxjQUFQLENBQXNCbUMsU0FBdEIsQ0FBZ0NmLENBQUMsQ0FBQ0UsTUFBRixDQUFTZixZQUFULENBQXNCLGFBQXRCLENBQWhDLEVBQXNFRixRQUFRLENBQUNTLGFBQVQsQ0FBdUIsNkRBQXZCLEVBQXNGRyxLQUF0RixJQUE2RixTQUFuSyxFQUErSyxVQUFTVyxJQUFULEVBQWM7QUFDekwsWUFBSUEsSUFBSixFQUFVO0FBQ04sY0FBRzdCLE1BQU0sQ0FBQ3FDLFNBQVYsRUFBcUJyQyxNQUFNLENBQUNxQyxTQUFQLENBQWlCQyxNQUFqQixDQUF3QlQsSUFBeEI7O0FBQ3JCLGNBQUlBLElBQUksQ0FBQ1UsTUFBTCxJQUFlLFNBQW5CLEVBQThCO0FBQzFCdkMsa0JBQU0sQ0FBQ0MsY0FBUCxDQUFzQndCLFlBQXRCLENBQW1DQyxPQUFuQztBQUNIO0FBQ0o7QUFDSixPQVBEO0FBUUg7QUFDSixHQWhDRDtBQWlDQXBCLFVBQVEsQ0FBQ0MsY0FBVCxDQUF3QixjQUF4QixFQUF3Q0UsZ0JBQXhDLENBQXlELE9BQXpELEVBQWlFLFVBQVNZLENBQVQsRUFBVztBQUN4RSxRQUFJQSxDQUFDLENBQUNFLE1BQUYsQ0FBU1YsU0FBVCxDQUFtQmMsUUFBbkIsQ0FBNEIsZUFBNUIsQ0FBSixFQUFrRDtBQUM5QyxVQUFJRSxJQUFJLEdBQUcsRUFBWDtBQUNBLFVBQUlJLElBQUksR0FBRzNCLFFBQVEsQ0FBQ1MsYUFBVCxDQUF1Qiw2REFBdkIsRUFBc0ZHLEtBQXRGLElBQTZGLFNBQXhHO0FBQ0FaLGNBQVEsQ0FBQ0ksZ0JBQVQsQ0FBMEIsNEVBQTFCLEVBQXdHQyxPQUF4RyxDQUFnSCxVQUFDQyxHQUFELEVBQU87QUFDbkhpQixZQUFJLENBQUNqQixHQUFHLENBQUMsTUFBRCxDQUFKLENBQUosR0FBb0JBLEdBQUcsQ0FBQyxPQUFELENBQXZCO0FBQ0gsT0FGRDtBQUdBaUIsVUFBSSxDQUFDLFVBQUQsQ0FBSixHQUFrQnZCLFFBQVEsQ0FBQ1MsYUFBVCxDQUF1QixtREFBdkIsRUFBNEVHLEtBQTVFLElBQW1GLE1BQXJHOztBQUNBLFVBQUdlLElBQUksSUFBRSxNQUFULEVBQWdCO0FBQ1pKLFlBQUksQ0FBQyxNQUFELENBQUosR0FBZXZCLFFBQVEsQ0FBQ1MsYUFBVCxDQUF1QiwwQ0FBdkIsRUFBbUVHLEtBQWxGO0FBQ0FXLFlBQUksQ0FBQyxXQUFELENBQUosR0FBa0I3QixNQUFNLENBQUNDLGNBQVAsQ0FBc0JlLFdBQXRCLENBQWtDd0IsUUFBbEMsQ0FBMkMsSUFBM0MsQ0FBbEI7QUFDSDs7QUFDRHhDLFlBQU0sQ0FBQ0MsY0FBUCxDQUFzQndDLGFBQXRCLENBQW9DUixJQUFwQyxFQUEwQ0osSUFBMUMsRUFBZ0QsVUFBU0EsSUFBVCxFQUFjO0FBQzFELFlBQUc3QixNQUFNLENBQUNxQyxTQUFWLEVBQXFCckMsTUFBTSxDQUFDcUMsU0FBUCxDQUFpQkMsTUFBakIsQ0FBd0JULElBQXhCOztBQUNyQixZQUFHQSxJQUFJLENBQUNVLE1BQUwsSUFBYSxTQUFoQixFQUEwQjtBQUN0QnZDLGdCQUFNLENBQUMwQyxXQUFQLENBQW1CQyxRQUFuQixDQUE0QixZQUFVO0FBQ2xDM0Msa0JBQU0sQ0FBQ0MsY0FBUCxDQUFzQndCLFlBQXRCLENBQW1DQyxPQUFuQztBQUNILFdBRkQ7QUFHSDtBQUNKLE9BUEQ7QUFRSDtBQUNKLEdBckJEO0FBc0JBcEIsVUFBUSxDQUFDUyxhQUFULENBQXVCLGtDQUF2QixFQUEyRE4sZ0JBQTNELENBQTRFLGNBQTVFLEVBQTJGLFVBQUNZLENBQUQsRUFBSztBQUM1RixRQUFHQSxDQUFDLENBQUN1QixNQUFGLElBQVl2QixDQUFDLENBQUN1QixNQUFGLENBQVNDLFFBQVQsSUFBbUIsU0FBbEMsRUFBNEM7QUFDeEM3QyxZQUFNLENBQUNDLGNBQVAsQ0FBc0I2QyxjQUF0QjtBQUNIO0FBQ0osR0FKRDtBQUtILENBckdEOztBQXVHQSxTQUFTMUIsU0FBVCxHQUFvQjtBQUNoQmQsVUFBUSxDQUFDUyxhQUFULENBQXVCLDJCQUF2QixFQUFvRGdDLFNBQXBELEdBQThELHdGQUE5RDtBQUNBekMsVUFBUSxDQUFDSSxnQkFBVCxDQUEwQix3REFBMUIsRUFBb0ZDLE9BQXBGLENBQTRGLFVBQUNDLEdBQUQsRUFBTztBQUMvRkEsT0FBRyxDQUFDQyxTQUFKLENBQWNXLEdBQWQsQ0FBa0Isa0JBQWxCO0FBQ0gsR0FGRDtBQUdBeEIsUUFBTSxDQUFDMEMsV0FBUCxDQUFtQk0sUUFBbkIsQ0FBNEIsaUJBQTVCO0FBQ0giLCJmaWxlIjoiLi92ZW5kb3IvZmVpcm9uL2ZlX3JvbGVzL3NyYy9yZXNvdXJjZXMvanMvcm9sZU1hbmFnZW1lbnRPdXRsZXQuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3aW5kb3cudXNyUm9sZU1hbmFnZXIgPSByZXF1aXJlKCcuL3JvbGVNYW5hZ2VtZW50Q29udHJvbCcpLmRlZmF1bHQ7XHJcblxyXG53aW5kb3cucmVhZHkoKCk9PntcclxuICAgIHdpbmRvdy51c3JSb2xlTWFuYWdlci5Jbml0VXNyUm9sZUR0YWJsZSgncHJfZHRfdGFibGUnKTtcclxuICAgIHdpbmRvdy51c3JSb2xlTWFuYWdlci5Jbml0VXNyQWJpbGl0eUxpc3QoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JvbGVfYWJpbGl0aWVzJyksZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByX2R0X3RhYmxlJykuZ2V0QXR0cmlidXRlKCdkYXRhX3RhcmdldCcpKTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250cm9sX0NSVUQnKS5hZGRFdmVudExpc3RlbmVyKCdoaWRkZW4uYnMubW9kYWwnLGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2NvbnRyb2xfQ1JVRCAubW9kYWwtYm9keSwjY29udHJvbF9DUlVEIC5tb2RhbC1jb250ZW50JykuZm9yRWFjaCgoZWxtKT0+e1xyXG4gICAgICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZSgnb3ZlcmZsb3ctdmlzaWJsZScpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJfbWFuYWdlbWVudCAucmFfYWRkTmV3JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57XHJcbiAgICAgICAgd2luZG93LnVzclJvbGVNYW5hZ2VyLmFiaWxpdHlMaXN0LnJlbW92ZUFjdGl2ZUl0ZW1zKCk7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI1JvbGVfTWFuYWdlbWVudF9DUlVEIHNlbGVjdFtuYW1lPVwicmFfdHlwZVwiXScpLnZhbHVlPShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJfbWFuYWdlbWVudCBpbnB1dFt0eXBlPVwicmFkaW9cIl1bbmFtZT1cIkxpc3RUeXBlXCJdOmNoZWNrZWQnKS52YWx1ZXx8J0FiaWxpdHknKTtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjUm9sZV9NYW5hZ2VtZW50X0NSVUQgaW5wdXRbdHlwZT1cInJhZGlvXCJdW3ZhbHVlPVwiZmFsc2VcIl0nKS5jaGVja2VkPXRydWU7XHJcbiAgICAgICAgc2hvd01vZGFsKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFfdHlwZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsKGUpPT57XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI1JvbGVfTWFuYWdlbWVudF9DUlVEIC5yb2xlQ3RybCcpLmZvckVhY2goKHIpPT57XHJcbiAgICAgICAgICAgIGlmKChlLnRhcmdldC52YWx1ZXx8J0FiaWxpdHknKT09J1JvbGUnKXtcclxuICAgICAgICAgICAgICAgIHIuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJyk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgci5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3ByX21hbmFnZW1lbnQgaW5wdXRbdHlwZT1cInJhZGlvXCJdW25hbWU9XCJMaXN0VHlwZVwiXScpLmZvckVhY2goKGVsbSk9PntcclxuICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywoKT0+e1xyXG4gICAgICAgICAgICB3aW5kb3cudXNyUm9sZU1hbmFnZXIuVXNyUm9sZVRhYmxlLnNldERhdGEoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCAucm9sZUN0cmwnKS5mb3JFYWNoKChyKT0+e1xyXG4gICAgICAgICAgICAgICAgaWYoZWxtLnZhbHVlID09ICdBYmlsaXR5Jyl7XHJcbiAgICAgICAgICAgICAgICAgICAgci5jbGFzc0xpc3QuYWRkKCdkLW5vbmUnKTtcclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHIuY2xhc3NMaXN0LnJlbW92ZSgnZC1ub25lJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ1JvbGVfTWFuYWdlbWVudCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoZSk9PntcclxuICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdidG4tZWRpdCcpKSB7XHJcbiAgICAgICAgICAgIHNob3dNb2RhbCgpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY29udHJvbF9DUlVEIC5sb2FkaW5nJykuY2xhc3NMaXN0LmFkZCgnc2hvdycpO1xyXG4gICAgICAgICAgICB3aW5kb3cudXNyUm9sZU1hbmFnZXIucHJfbG9hZChlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc291cmNlJyksKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcl9tYW5hZ2VtZW50IGlucHV0W3R5cGU9XCJyYWRpb1wiXVtuYW1lPVwiTGlzdFR5cGVcIl06Y2hlY2tlZCcpLnZhbHVlfHwnQWJpbGl0eScpLCBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCBpbnB1dFtuYW1lPVwiUklEXCJdJykudmFsdWU9ZGF0YS5pZDtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCBpbnB1dFtuYW1lPVwibmFtZVwiXScpLnZhbHVlPWRhdGEubmFtZTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCB0ZXh0YXJlYVtuYW1lPVwiZGVzY3JpcHRpb25cIl0nKS52YWx1ZT1kYXRhLmRlc2NyaXB0aW9uO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI1JvbGVfTWFuYWdlbWVudF9DUlVEIHNlbGVjdFtuYW1lPVwicmFfdHlwZVwiXScpLnZhbHVlPWRhdGEudHlwZTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCBpbnB1dFtuYW1lPVwiZGlzYWJsZWRcIl1bdmFsdWU9XCInICsgKGRhdGEuZGlzYWJsZWQgPyAndHJ1ZScgOiAnZmFsc2UnKSArICdcIl0nKS5jaGVja2VkPXRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS50eXBlID09ICdSb2xlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCAucm9sZUN0cmwnKS5mb3JFYWNoKChyKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnR5cGU9PSdSb2xlJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmNsYXNzTGlzdC5yZW1vdmUoJ2Qtbm9uZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuY2xhc3NMaXN0LmFkZCgnZC1ub25lJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjUm9sZV9NYW5hZ2VtZW50X0NSVUQgaW5wdXRbbmFtZT1cInJhbmtcIl0nKS52YWx1ZT1kYXRhLnJhbms7XHJcbiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbnRyb2xfQ1JVRCAubG9hZGluZycpLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfWVsc2UgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnYnRuLXJlbW92ZScpKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy51c3JSb2xlTWFuYWdlci5wcl9yZW1vdmUoZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXNvdXJjZScpLChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJfbWFuYWdlbWVudCBpbnB1dFt0eXBlPVwicmFkaW9cIl1bbmFtZT1cIkxpc3RUeXBlXCJdOmNoZWNrZWQnKS52YWx1ZXx8J0FiaWxpdHknKSwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5mcmFtZVV0aWwpIHdpbmRvdy5mcmFtZVV0aWwuTm90aWZ5KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PSAnc3VjY2VzcycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnVzclJvbGVNYW5hZ2VyLlVzclJvbGVUYWJsZS5zZXREYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250cm9sX0NSVUQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncmFfU2F2ZUNoYW5nZScpKSB7XHJcbiAgICAgICAgICAgIGxldCBkYXRhID0ge307XHJcbiAgICAgICAgICAgIGxldCB0eXBlID0oZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3ByX21hbmFnZW1lbnQgaW5wdXRbdHlwZT1cInJhZGlvXCJdW25hbWU9XCJMaXN0VHlwZVwiXTpjaGVja2VkJykudmFsdWV8fCdBYmlsaXR5Jyk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCAuZm9ybS1jb250cm9sOm5vdChbdHlwZT1cInJhZGlvXCJdKTpub3QoLnJvbGUtY29udHJvbCknKS5mb3JFYWNoKChlbG0pPT57XHJcbiAgICAgICAgICAgICAgICBkYXRhW2VsbVsnbmFtZSddXSA9IGVsbVsndmFsdWUnXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRhdGFbJ2Rpc2FibGVkJ109KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNSb2xlX01hbmFnZW1lbnRfQ1JVRCBpbnB1dFt0eXBlPVwicmFkaW9cIl06Y2hlY2tlZCcpLnZhbHVlPT0ndHJ1ZScpO1xyXG4gICAgICAgICAgICBpZih0eXBlPT0nUm9sZScpe1xyXG4gICAgICAgICAgICAgICAgZGF0YVsncmFuayddID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI1JvbGVfTWFuYWdlbWVudF9DUlVEIGlucHV0W25hbWU9XCJyYW5rXCJdJykudmFsdWU7XHJcbiAgICAgICAgICAgICAgICBkYXRhWydBYmlsaXRpZXMnXT13aW5kb3cudXNyUm9sZU1hbmFnZXIuYWJpbGl0eUxpc3QuZ2V0VmFsdWUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgd2luZG93LnVzclJvbGVNYW5hZ2VyLnByX3NhdmVDaGFuZ2UodHlwZSwgZGF0YSwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICBpZih3aW5kb3cuZnJhbWVVdGlsKSB3aW5kb3cuZnJhbWVVdGlsLk5vdGlmeShkYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmKGRhdGEuc3RhdHVzPT0nc3VjY2Vzcycpe1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jb250cm9sVXRpbC5oaWRlQ1JVRChmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cudXNyUm9sZU1hbmFnZXIuVXNyUm9sZVRhYmxlLnNldERhdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjUm9sZV9NYW5hZ2VtZW50X0NSVUQgLnByZXYtbGlzdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2xpc3QtdXBkYXRlZCcsKGUpPT57XHJcbiAgICAgICAgaWYoZS5kZXRhaWwgJiYgZS5kZXRhaWwucHJldlR5cGU9PSdBYmlsaXR5Jyl7XHJcbiAgICAgICAgICAgIHdpbmRvdy51c3JSb2xlTWFuYWdlci5mZXRjaEFiaWxpdGllcygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHNob3dNb2RhbCgpe1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbnRyb2xfQ1JVRCAuYnV0dG9uU2xvdCcpLmlubmVySFRNTD0nPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc3VjY2VzcyByYV9TYXZlQ2hhbmdlXCIgaWQ9XCJyYV9TYXZlQ2hhbmdlXCI+U2F2ZSBDaGFuZ2VzPC9idXR0b24+JztcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNjb250cm9sX0NSVUQgLm1vZGFsLWJvZHksI2NvbnRyb2xfQ1JVRCAubW9kYWwtY29udGVudCcpLmZvckVhY2goKGVsbSk9PntcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LmFkZCgnb3ZlcmZsb3ctdmlzaWJsZScpO1xyXG4gICAgfSlcclxuICAgIHdpbmRvdy5jb250cm9sVXRpbC5zaG93Q1JVRCgnUm9sZV9NYW5hZ2VtZW50Jyk7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./vendor/feiron/fe_roles/src/resources/js/roleManagementOutlet.js\n");
})();

/******/ })()
;